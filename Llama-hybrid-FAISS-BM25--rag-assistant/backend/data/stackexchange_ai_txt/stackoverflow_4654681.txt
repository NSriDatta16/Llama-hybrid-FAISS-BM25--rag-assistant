[site]: stackoverflow
[post_id]: 4654681
[parent_id]: 4652710
[tags]: 
You could also use a kernel extension to implement a network socket filter. Developing a kext is more difficult but your program would not depend on the libpcap library. Apple has a code sample at http://developer.apple.com/library/mac/#samplecode/tcplognke/Introduction/Intro.html#//apple_ref/doc/uid/DTS10003669
