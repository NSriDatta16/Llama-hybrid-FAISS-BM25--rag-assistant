[site]: stackoverflow
[post_id]: 415283
[parent_id]: 414896
[tags]: 
If your own code is examining one character at a time, you want to use a sentinel to mark the end of a buffer or the end of file, so that you have just one test in your inner loop . In your case that one test will be for end of line, so you'll want to temporarily stick a newline at the end of each buffer, for example. The Wikipedia article on sentinels is not helpful at all; it doesn't describe this case. You can find a description in any of Robert Sedgewick's algorithms textbooks. You might also want to look at re2c , which can generate very fast code for scanning text data. It generates C code but you may be able to adapt it, and you can certainly learn the techniques by reading their paper about re2c .
