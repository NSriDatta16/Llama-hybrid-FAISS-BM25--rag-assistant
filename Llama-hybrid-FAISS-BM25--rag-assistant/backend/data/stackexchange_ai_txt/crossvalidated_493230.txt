[site]: crossvalidated
[post_id]: 493230
[parent_id]: 492743
[tags]: 
Although it is difficult to determine general behavior from one dataset, it looks like these data would be amenable to a simple, robust analysis that looks for sudden drops followed a little later by a sudden rise. (I adopt the language of time series analysis in which row numbers are viewed as succeeding points in time.) To find a drop, predict the data in a robust way. A moving (windowed) median will do nicely, perhaps of width 5 through 50. Sufficiently large negative discrepancies between actual and predicted values (the "residuals") will indicate drops. The rises can be discovered by reversing the series and looking for its drops, obviating any need to code two algorithms. The main challenge to automating this lies in estimating how large a "sufficiently large" drop must be. In this case, because the signal is discrete (all values are multiplies of 1/3), a tabulation of the residuals reveals a few extreme values that appear only a few times: those are the candidates for further examination. These candidates must be post-processed to combine quick successions of drops into the first drop in each sequence and to eliminate the "false" drops and rises created by rapid decreases or increases (respectively) in the valid part of the signal. Here is a plot of the data with the drops marked in red, the rises in blue, and the data in between each such pair (corresponding to the invalid signal) in gray. No tuning or manual intervention was performed. The window width was 41 rows, but any window larger than 4 yet smaller than the durations of the bad signals will work fine with this dataset. Whether this approach works with your other datasets will depend on whether I have guessed correctly at the nature of the signal dropouts. For further details, consult this R code used to produce the figure. It references the data as a data frame X having fields X and Y . It adds a third field Y.hat equal to the good data and otherwise containing NA (missing) values for the signal dropouts it detected. # # Plot the data. # with(X, plot(X, Y, type="l", ylim=c(0,100), bty="n", col="#00000040", xlab="X", ylab="Y", main="Data and Gaps")) # # Find the sudden drops in both directions. # drops 1)) thresholds 0]) # # Return the indexes where those extreme drops occur. # which(r >= upper) } w $Y, w) j Y), w)) # # Look for drop/rise pairs. # if (min(j) max(j)) j 1 i.rises 1 abline(v=X $X[i.drops], col="Red") abline(v=X$ X[i.rises], col="Blue") # # Remove the intervals between drop/rise pairs from the data and plot them in gray. # X $Y.hat Y for (k in seq_along(i.drops)) X$Y.hat[i.drops[k]:i.rises[k]] $X, X$ Y.hat)
