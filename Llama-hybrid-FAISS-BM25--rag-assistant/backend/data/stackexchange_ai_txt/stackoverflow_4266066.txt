[site]: stackoverflow
[post_id]: 4266066
[parent_id]: 
[tags]: 
Overwriting / Overloading a controller class in Magento

I'm trying to overload / overwrite the CategoryController class in Magento, but am coming up against a 404 error every time. I've followed many guidelines that I've found on the net but still seem to be coming up short. etc/config.xml 0.1.0 categorylanding/catalog_category/ --> LHM_CategoryLanding_Catalog standard LHM_CategoryLanding categorylanding --> controller/Catalog/CategoryController.php $this)); $categoryId = (int) $this->getRequest()->getParam('id', false); if (!$categoryId) { return false; } $category = Mage::getModel('catalog/category') ->setStoreId(Mage::app()->getStore()->getId()) ->load($categoryId); if (!Mage::helper('catalog/category')->canShow($category)) { return false; } Mage::getSingleton('catalog/session')->setLastVisitedCategoryId($category->getId()); Mage::register('current_category', $category); try { Mage::dispatchEvent('catalog_controller_category_init_after', array('category'=>$category, 'controller_action'=>$this)); } catch (Mage_Core_Exception $e) { Mage::logException($e); return false; } return $category; } /** * Category view action */ public function viewAction() { if ($category = $this->_initCatagory()) { Mage::getModel('catalog/design')->applyDesign($category, Mage_Catalog_Model_Design::APPLY_FOR_CATEGORY); Mage::getSingleton('catalog/session')->setLastViewedCategoryId($category->getId()); $update = $this->getLayout()->getUpdate(); $update->addHandle('default'); if (!$category->hasChildren()) { $update->addHandle('catalog_category_layered_nochildren'); } $this->addActionLayoutHandles(); $update->addHandle($category->getLayoutUpdateHandle()); $update->addHandle('CATEGORY_'.$category->getId()); if ($category->getPageLayout()) { $this->getLayout()->helper('page/layout') ->applyHandle($category->getPageLayout()); } $this->loadLayoutUpdates(); $update->addUpdate($category->getCustomLayoutUpdate()); $this->generateLayoutXml()->generateLayoutBlocks(); if ($category->getPageLayout()) { $this->getLayout()->helper('page/layout') ->applyTemplate($category->getPageLayout()); } if ($root = $this->getLayout()->getBlock('root')) { $root->addBodyClass('categorypath-'.$category->getUrlPath()) ->addBodyClass('category-'.$category->getUrlKey()); } $this->_initLayoutMessages('catalog/session'); $this->_initLayoutMessages('checkout/session'); /* START ===== Pete T additional code. Need to put this in override!! */ if($category->getLevel()==2){ $category->setDisplayMode('PAGE'); } /* END ======= */ $this->renderLayout(); } elseif (!$this->getResponse()->isRedirect()) { $this->_forward('noRoute'); } } protected function _getRealModuleName() { return "LHM_CategoryLanding"; } } This is the first time I've tried to overload a controller so I'm not even sure if I'm doing it right. The last thing I want to be doing is adding code to the core... Thanks in advance.
