[site]: stackoverflow
[post_id]: 5003917
[parent_id]: 4994538
[tags]: 
The solution here involves a fair degree of string manipulation. Essentially, in the group footers for the companies (when the year is 2010), you build up a string of company names and sales figures. When the year is 2011, you process the string instead to extract the data relevant to 2011 (for the given company and month), and use that for your comparison. So, for a string formula called ProcessJan, you might have (using pipes as a splitting character) : Global StringVar JanGlobal; Local NumberVar NumberToCompare := 0; If Year(Sales) = 2010 Then JanGlobal := '||' + {CompanyName} + '|' + ToText({SalesFigure}); //append current value to Jan's formula Else ( If UBound(SalesSearch) > 0 ( Local NumberVar Searching := 1; For Searching = 1 to UBound(SalesSearch) If SalesSearch[Searching] StartsWith ({CompanyName} + '|') Then ( Local StringVar Array Matched := Split(SalesSearch[Searching], '|') NumberToCompare := ToNumber(Matched[2]); ) Next ) //do whatever you want with the 2011 sales figure and the value of NumberToCompare //(which should be either zero or Jan 2010's sales figure for the company) here ) With a bit of work you could adapt this method to have one formula and global variable managing all months and companies.
