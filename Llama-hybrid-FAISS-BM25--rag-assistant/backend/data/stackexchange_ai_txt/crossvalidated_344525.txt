[site]: crossvalidated
[post_id]: 344525
[parent_id]: 
[tags]: 
Average for year if some stores stop selling product

I am trying to calculate yearly sales averages per product across a number of stores. The average should only include those stores which carry a product. So if I have stores A, B, and C and products X, Y, and Z, I want the average sales of products X, Y, and Z across all 3 stores, but if store C does not carry product X, store C should not be included in the average for product X. This is all simple but what if store C carried product X at the beginning of the year but stopped selling it half way through the year? The product X sales for store C should be incorporated in the average for the duration in which they sold the product but the rest of the year during which they stopped selling the product would throw off the average. So how would the average sales for the year of product X be represented?
