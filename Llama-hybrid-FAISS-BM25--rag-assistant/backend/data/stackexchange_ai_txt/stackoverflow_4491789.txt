[site]: stackoverflow
[post_id]: 4491789
[parent_id]: 
[tags]: 
SqlCommandBuilder not assigning ConnectionString

I'm using a devexpress XtraGrid in layout view to edit a recently created database row. This is the code I use to load data: Public Function SetData(ByVal connString As String, ByVal tabla As String) As Boolean Dim d As New DataTable Dim cmd As New SqlCommand Try Using conn As New SqlConnection(connString) conn.Open() cmd.Connection = conn m_Tabla = tabla If (m_Id = "") Then cmd.CommandText = "SELECT * FROM " & m_Tabla Else cmd.CommandText = "SELECT * FROM " & m_Tabla & " WHERE IdCaptura = '" & m_Id & "'" End If m_Adapter = New SqlDataAdapter(cmd) m_DataSet = New DataSet() m_Adapter.Fill(m_DataSet, m_Tabla) grdMetadata.DataSource = m_DataSet.Tables(m_Tabla) Return True End Using Catch ex As Exception Return False End Try End Function The database can be different from client to client, so AFAIK I can't write the update command; I've been investigating the issue and my conclusion was that I need to use a SqlCommandBuilder to get it automatically generated. When the user ends editing data, I use the following snippet to update the database: Private Sub btnAceptar_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAceptar.Click Try Dim builder As New SqlCommandBuilder(m_Adapter) grdLayoutView.CloseEditor() grdLayoutView.UpdateCurrentRow() m_Adapter.Update(m_DataSet, m_Tabla) * Catch ex As Exception lblEstado.Text = ex.Message End Try End Sub In the line marked with *, I get a "The ConnectionString Property has not been initialized" exception. The table has a Primary Key column (IdCaptura), and I can see that the DataAdapter.UpdateCommand is set to nothing if I put a breakpoint in said line. Any idea about what's wrong here?
