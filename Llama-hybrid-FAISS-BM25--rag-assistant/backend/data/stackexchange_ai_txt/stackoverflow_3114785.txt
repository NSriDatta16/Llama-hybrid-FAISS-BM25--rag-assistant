[site]: stackoverflow
[post_id]: 3114785
[parent_id]: 
[tags]: 
Transmit a Word file to a database or FTP at the click of a button?

I would like to be able to send the contents of a merged word document to a database, either on a button click on the menu bar, or when closed (if saved). I've found some working code but have a problem trying to modify it (VBA noob) 'Written: June 11, 2008 'Author: Leith Ross 'Open the Internet object Private Declare Function InternetOpen _ Lib "wininet.dll" _ Alias "InternetOpenA" _ (ByVal sAgent As String, _ ByVal lAccessType As Long, _ ByVal sProxyName As String, _ ByVal sProxyBypass As String, _ ByVal lFlags As Long) As Long 'Connect to the network Private Declare Function InternetConnect _ Lib "wininet.dll" _ Alias "InternetConnectA" _ (ByVal hInternetSession As Long, _ ByVal sServerName As String, _ ByVal nServerPort As Integer, _ ByVal sUsername As String, _ ByVal sPassword As String, _ ByVal lService As Long, _ ByVal lFlags As Long, _ ByVal lContext As Long) As Long 'Get a file using FTP Private Declare Function FtpGetFile _ Lib "wininet.dll" _ Alias "FtpGetFileA" _ (ByVal hFtpSession As Long, _ ByVal lpszRemoteFile As String, _ ByVal lpszNewFile As String, _ ByVal fFailIfExists As Boolean, _ ByVal dwFlagsAndAttributes As Long, _ ByVal dwFlags As Long, _ ByVal dwContext As Long) As Boolean 'Send a file using FTP Private Declare Function FtpPutFile _ Lib "wininet.dll" _ Alias "FtpPutFileA" _ (ByVal hFtpSession As Long, _ ByVal lpszLocalFile As String, _ ByVal lpszRemoteFile As String, _ ByVal dwFlags As Long, _ ByVal dwContext As Long) As Boolean 'Close the Internet object Private Declare Function InternetCloseHandle _ Lib "wininet.dll" _ (ByVal hInet As Long) As Integer Sub AutoClose() Dim INet As Long Dim INetConn As Long Dim hostFile As String Dim localFile As String Dim Password As String Dim RetVal As Long Dim ServerName As String Dim Success As Long Dim UserName As String Const ASCII_TRANSFER = 1 Const BINARY_TRANSFER = 2 ServerName = "ftp.myserver.com" UserName = "myusername" Password = "password" 'This fails if I use localFile = ActiveDocument.FullName 'but is OK if localFile is hardcoded localFile = "f:\My Documents\Test.Txt" hostFile = ActiveDocument.Name If Len(ActiveDocument.Path) = 0 Then MsgBox "The document must be saved first." Exit Sub End If RetVal = False INet = InternetOpen("MyFTP Control", 1&, vbNullString, vbNullString, 0&) If INet > 0 Then INetConn = InternetConnect(INet, ServerName, 0&, UserName, Password, 1&, 0&, 0&) If INetConn > 0 Then Success = FtpPutFile(INetConn, localFile, hostFile, BINARY_TRANSFER, 0&) RetVal = InternetCloseHandle(INetConn) End If RetVal = InternetCloseHandle(INet) End If If Success <> 0 Then MsgBox ("Upload process completed") Else MsgBox "FTP File Error!" End If End Sub I want the localFile variable to be dynamic and reflect this current document, but it only works if hardcoded. Where am I going wrong?
