[site]: stackoverflow
[post_id]: 208182
[parent_id]: 208051
[tags]: 
This worked. It's old (checking for Netscape), was written before all the Ajax tools came out. You do have to handle different browsers -- basically, IE does it one way, and everybody else does it the other way. // javascript global variables var soapHeader = ' ' + ' ' + ' ' + ' '; var soapFooter = ' ' + ' '; var destinationURI = '/webservices/websalm'; var actionURI = ''; function callWebService(nsCallback,ieCallback,parms) { try { // Create XmlHttpRequest obj for current browser = Netscape or IE if (navigator.userAgent.indexOf('Netscape') != -1) { SOAPObject = new XMLHttpRequest(); SOAPObject.onload = nsCallback; } else { //IE SOAPObject = new ActiveXObject('Microsoft.XMLHTTP'); SOAPObject.onreadystatechange = ieCallback; } SOAPObject.open('POST', destinationURI, true); // Set 2 Request headers, based on browser if (actionURI == '') { SOAPObject.setRequestHeader('SOAPAction', '\"\"'); } else { SOAPObject.setRequestHeader('SOAPAction', actionURI); } SOAPObject.setRequestHeader('Content-Type', 'text/xml'); // Compose the Request body from input parameter + global variables var requestBody = soapHeader + parms + soapFooter // Send, based on browser if (navigator.userAgent.indexOf('Netscape') != -1) { SOAPObject.send(new DOMParser().parseFromString(requestBody,'text/xml')); } else { SOAPObject.send(requestBody); } } catch (E) { alert('callWebService exception: ' + E); } }
