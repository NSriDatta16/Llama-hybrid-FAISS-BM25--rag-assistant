[site]: crossvalidated
[post_id]: 469342
[parent_id]: 
[tags]: 
How to calculate correlation in lagged parameters in multivariate time series and multiple entities?

Consider time series of multiple parameters for multiple entities, for instance, the advertisement spending and sales of several companies over time. | Time | Company | Marketing Spending | Sales | |------+---------+--------------------+-------| | t1 | A | 10 | 5 | | t2 | A | 20 | 7 | | t3 | A | 23 | 13 | | t1 | B | 25 | 10 | | t2 | B | 10 | 15 | | t3 | B | 10 | 12 | I want to calculate the correlation between marketing spending and sales, as well as the lag in the correlation, that is how much time it takes for marketing spending to influence sales (Assumed causality). To do so, I shifted the Sales to simulate the lag. For instance, for a lag of t+1 : | Time | Company | Marketing Spending | Sales at t+1 | |------+---------+--------------------+--------------| | t1 | A | 10 | 7 | | t2 | A | 20 | 13 | | t1 | B | 25 | 15 | | t2 | B | 10 | 12 | Then, I calculate the correlation between Marketing Spending and Sales at t+1 (without controlling for Company , because I want to know at the population level - I am not treating it like Panel data). Finally, after calculating correlation between Marketing Spending and Sales at t+k with k=1,...,K I pick the k with the highest correlation. Is this the correct approach? I feel like this approach ignores the auto-correlation in Marketing Spending (you are likely to spend as much or near what you spent before). To address this, I could do a ARIMA model where: $y_t = y_{t-1} + x_{t+1} + \epsilon$ But I am not sure this is correct. Can I do an ARIMA with multiple entities (e.g., companies?). I know that panel data analysis does differentiate entities, but here I don't care about the fixed and random effect.
