[site]: stackoverflow
[post_id]: 1188689
[parent_id]: 1169573
[tags]: 
Maybe the most efficient replacement for your function would simply be: fn which is twice as fast as taking difference of iid normal variates. More generally though, if your goal is to run simple simulations, vector/array preallocation and calls to native functions speed up the process greatly. If you want to perform monte-carlo simulations for statistical estimations (e.g., MCMC), R has a number of native packages. For general stochastic simulation, I am not aware of R packages but you may want to try Simpy ( http://simpy.sourceforge.net/ ), which is excellent.
