[site]: crossvalidated
[post_id]: 79053
[parent_id]: 78440
[tags]: 
Given that I've already seen k successes on n samples of a Bernoulli distribution with unknown parameter p, what is the probability that, if I keep sampling from the same distribution, after N observations (say N=100), I'll see at least K successes (say K=10). A Bayesian answer to this question is: $$ \Theta\sim\mathrm{U}[0,1], \qquad X\mid\Theta\sim\mathrm{Bin}(n,\Theta), \qquad Y\mid\Theta\sim\mathrm{Bin}(N,\Theta) \, . $$ $$ \begin{eqnarray} P(Y\geq K&\mid& X=k) = \sum_{m=K}^N P(Y=m\mid X=k) \\ &=& \sum_{m=K}^N \int_0^1 f_{Y\mid\Theta}(m\mid\theta) f_{\Theta\mid X}(\theta\mid k)\,d\theta \qquad\qquad\qquad\qquad\qquad (*) \\ &=& \frac{\Gamma(n+2)}{\Gamma(k+1)\Gamma(n-k+1)} \sum_{m=K}^N {N \choose m} \int_0^1 \theta^{m+k}(1-\theta)^{N+n-m-k} \, d\theta \\ &=& \frac{(n+1)!}{k!(n-k)!} \sum_{m=K}^N \left( {N \choose m} \frac{\Gamma(m+k+1)\Gamma(N+n-m-k+1)}{\Gamma(N+n+2)} \right) \\ &=& \frac{(n+1)!}{k!(n-k)!(N+n+1)!} \sum_{m=K}^N \left( {N \choose m} (m+k)!(N+n-m-k)! \right)\, . \end{eqnarray} $$ The $(*)$ equality follows from the theorem of total probability, the product rule, and the conditional independence of $Y$ and $X$, given $\Theta$: $$ \begin{eqnarray} f_{Y\mid X}(m\mid k) &=& \int f_{Y,\Theta\mid X}(m,\theta\mid k) \,d\theta \\ &=& \int f_{Y\mid\Theta, X}(m\mid\theta,k) f_{\Theta\mid X}(\theta\mid k) \,d\theta \\ &=& \int f_{Y\mid\Theta}(m\mid\theta) f_{\Theta\mid X}(\theta\mid k) \,d\theta \, . \end{eqnarray} $$
