[site]: stackoverflow
[post_id]: 357749
[parent_id]: 356830
[tags]: 
I think the problem is, that SSH tries to open PTY and it does not work on anything else than PTY for security reasons. This won't work well with pexpect. I have another ssh client: http://www.digmia.com/index.php?option=com_content&view=article&id=54:Digmia%20Enterprise%20SSH&Itemid=56 It's open-source, you can use it. What you are trying to do would be more commands, but you don't need expect at all. First install it accordingly to manual, then do something like this: Run dssh-agent, add the password you need like this: dssh-add -l or if it is a secure machine, i.e. no one else can log in there, this is very important, otherwise this would be a huge security hole: echo "name-of-server;22;root;password;" | dssh-add -l password file would be something like: name-of-server;22;root;password; And the do something like (replace CONTENTS OF ... with actual content of that file): dssh root@name-of-server -- echo "CONTENTS OF ~/.ssh/identity.pub" > .ssh/authorized_keys \; chmod og-w .ssh .ssh/authorized_keys You can (optionally) do dssh-add -f passwords (make sure no one else is doing all this stuff, otherwise you would have a race condition). Also, pexpect should probably work with dssh itself (so you don't need to use dssh-agent). But using dssh-agent is simpler and safer. Installation manual for DSSH is contained in the tarball. I don't know any simpler way of doing this, OpenSSH ssh-copy-id is very picky about where the password comes from...
