[site]: crossvalidated
[post_id]: 18576
[parent_id]: 
[tags]: 
Time dependent coefficients in R - how to do it?

Update : Sorry for another update but I've found some possible solutions with fractional polynomials and the competing risk-package that I need some help with. The problem I can't find an easy way to do a time dependent coefficient analysis is in R. I want to be able to take my variables coefficient and do it into a time dependent coefficient (not variable) and then plot the variation against time: $\beta_{my\_variable}=\beta_0+\beta_1*t+\beta_2*t^2...$ Possible solutions 1) Splitting the dataset I've looked at this example (Se part 2 of the lab session) but the creation of a separate dataset seems complicated, computationally costly and not very intuitive... 2) Reduced Rank models - The coxvc package The coxvc package provides an elegant way of dealing with the problem - here's a manual . The problem is that the author is no longer developing the package (last version is since 05/23/2007), after some e-mail conversation I've gotten the package to work but one run took 5 hours on my dataset (140 000 entries) and gives extreme estimates at the end of the period. You can find a slightly updated package here - I've mostly just updated the plot function. It might be just a question of tweaking but since the software doesn't easily provide confidence intervals and the process is so time consuming I'm looking right now at other solutions. 3) The timereg package The impressive timereg package also addresses the problem but I'm not certain of how to use it and it doesn't give me a smooth plot. 4) Fractional Polynomial Time (FPT) model I found Anika Buchholz' excellent dissertation on "Assessment of time–varying long–term effects of therapies and prognostic factors" that does an excellent job covering different models. She concludes that Sauerbrei et al's proposed FPT seems to be the most appropriate for time-dependent coefficients: FPT is very good at detecting time-varying effects, while the Reduced Rank approach results in far too complex models, as it does not include selection of time-varying effects. The research seems very complete but it's slightly out of reach for me. I'm also a little wondering since she happens to work with Sauerbrei. It seems sound though and I guess the analysis could be done with the mfp package but I'm not sure how. 5) The cmprsk package I've been thinking of doing my competing risk analysis but the calculations have been to time-consuming so I switched to the regular cox regression. The crr has thoug an option for time dependent covariates: .... cov2 matrix of covariates that will be multiplied by functions of time; if used, often these covariates would also appear in cov1 to give a prop hazards effect plus a time interaction .... There is the quadratic example but I'm don't quite follow where the time actually appears and I'm not sure of how to display it. I've also looked at the test.R file but the example there is basically the same... My example code Here's an example that I use to test the different possibilities library("survival") library("timereg") data(sTRACE) # Basic cox regression surv The code results in these graphs: Comparison of different settings for coxvc and of the coxvc and the timecox plots. I guess the results are ok but I don't think I'll be able to explain the timecox graph - it seems to complex... My (current) questions How do I do the FPT analysis in R? How do I use the time covariate in cmprsk? How do I plot the result (preferably with confidence intervals)?
