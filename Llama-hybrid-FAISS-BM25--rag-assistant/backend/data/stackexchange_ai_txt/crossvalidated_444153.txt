[site]: crossvalidated
[post_id]: 444153
[parent_id]: 48107
[tags]: 
You can use mcp for this kind of models. Time series often exhibit autocorrelation, so let's just to an AR(1) model with three linear segments. First, let's specify the model: model = list( y ~ 1 + x + ar(1), # Linear segment. Initiate AR(1) ~ 1 + x, # linear ~ 1 + x ) Now fit it: library(mcp) fit = mcp(model, df) As an extra trick, if the slope is identical between segments, you can set this identity using a prior. This fits one slope parameter instead of three: prior = list(x_2 = "x_1", x_3 = "x_1") fit = mcp(model, data = df, prior = prior) Read more on the mcp website . Disclaimer: I am the developer.
