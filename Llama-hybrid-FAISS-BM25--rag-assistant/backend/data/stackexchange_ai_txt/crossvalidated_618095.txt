[site]: crossvalidated
[post_id]: 618095
[parent_id]: 
[tags]: 
PISA scores wrong when computed by regions

I am testing a script in R to work with the PISA data for Spain. I calculate the average maths score as the weighted average with the weights (w_fstuwt) of each of the 5 plausible values and then taking the average of those 5 values. Comparing with the official PISA results ( https://pisadataexplorer.oecd.org/ide/idepisa ) I get the same results when I calculate it for Spain as a whole, but if I calculate it by regions (Andalusia, Aragon, etc.) the data do not match. For example, the average score in Mathematics in Andalusia, using R, I get 468.43, SPSS returns the same, while PISA Reports returns 467.40. Some regions overestimate and others underestimate. If I do the calculations with the instvy package, the average for Andalusia gives a value of 471.92, which does not match the PISA Report data either. I'm a bit lost here. Could it be due to the weights?
