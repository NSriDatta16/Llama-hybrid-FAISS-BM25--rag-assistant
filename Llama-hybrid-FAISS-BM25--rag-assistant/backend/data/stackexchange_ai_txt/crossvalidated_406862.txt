[site]: crossvalidated
[post_id]: 406862
[parent_id]: 
[tags]: 
lme4 mixed model unbalanced error factors + singular fit

I am studying the effects of 5 treatments (CT,CCM,CCI,F, S) on grape yield. My experimental design consists in: 5 treatments and 2 farms (SG, MT) which I use as block. I created an additional variable as interaction between farm and treatment which I called plot . In each farm the treated vine rows are divided in 3 ps.replicates Rep which reflect the altitude (coded as 1,2,3; 1= uphill,2= middle, 3=bottom of the field). I had problem with the soil variability so I carried out an extensive survey and found 2 soil types soil_cluster in each farm (coded as : 1,2,3,4) This is the model I have implemented m5=glmer(yield~ Farm+Treat+(1|plot/soil_cluster)+(1|Farm:Rep),family=gaussian(link="log"),data=YIELB However: I am not sure about structure of the error since farms and treatments have a different number of soil cluster. I get singular fit. What do you think? How would you proceed? EDIT: Thanks for your answer. As requested, I am reporting summary(YIELB) and str(YIELB) below. Soil cluster refers to the cluster of soils obtained through k-mediods clustering. The YIELB dataset also presents other dependent variable such as ncluster which is the no. of bunch of grapes per plant and cluster_weight which is the average bunch weight per plant. > summary(YIELB) Farm Treat Rep Plant code ncluster yield cluster_weight soil_cluster plot Length:300 Length:300 1:100 Min. : 1.0 Min. : 2.00 Min. : 206.0 Min. : 22.89 1: 40 MT.CCI : 30 Class :character Class :character 2:100 1st Qu.: 3.0 1st Qu.: 5.00 1st Qu.: 810.8 1st Qu.:142.62 2:110 SG.CCI : 30 Mode :character Mode :character 3:100 Median : 5.5 Median : 8.00 Median :1463.5 Median :186.72 5:110 MT.CCM : 30 Mean : 5.5 Mean : 8.15 Mean :1646.7 Mean :193.23 6: 40 SG.CCM : 30 3rd Qu.: 8.0 3rd Qu.:11.00 3rd Qu.:2249.5 3rd Qu.:231.25 MT.CT : 30 Max. :10.0 Max. :14.00 Max. :5285.0 Max. :468.00 SG.CT : 30 (Other):120 > str(YIELB) Classes ‘tbl_df’, ‘tbl’ and 'data.frame': 300 obs. of 9 variables: $ Farm : chr "MT" "MT" "MT" "MT" ... $ Treat : chr "CCI" "CCI" "CCI" "CCI" ... $ Rep : Factor w/ 3 levels "1","2","3": 1 1 1 1 1 1 1 1 1 1 ... $ Plant code : num 1 2 3 4 5 6 7 8 9 10 ... $ ncluster : num 3 3 9 6 9 5 7 5 7 6 ... $ yield : num 330 379 1230 1182 1416 ... $ cluster_weight: num 110 126 137 197 157 ... $ soil_cluster : Factor w/ 4 levels "1","2","5","6": 2 2 2 2 2 2 2 2 2 2 ... $ plot : Factor w/ 10 levels "MT.CCI","SG.CCI",..: 1 1 1 1 1 1 1 1 1 1 ...
