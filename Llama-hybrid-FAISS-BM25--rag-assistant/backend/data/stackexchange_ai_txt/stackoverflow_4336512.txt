[site]: stackoverflow
[post_id]: 4336512
[parent_id]: 
[tags]: 
Determine in code whether to allow a dragdrop drop using the Silverlight Toolkit

I'm using the SilverLight Toolkit to implement some drag/drop functionality in a Silverlight 4 web application. My drag source is a listbox, and I've got eighteen potential drop targets. I need to allow/disallow dropping based on a string value on the dragged object. I have no problem doing the comparison and determining whether or not the item is allowed to be dropped on the target, however, I'm having trouble figuring out what the best event is to handle, and how to make it not accept the drop. I've looked at the DragEnter event, and that looks like the best place to handle this, but I'm not quite sure what I need to do to make it not drop. Here's a snippet of some of the code that I've tried, but it doesn't prevent the drop: lbDragDrop.DragEnter += (src, e) => { VaultSocketViewModel vm = this.DataContext as VaultSocketViewModel; ListBoxDragDropTarget target = src as ListBoxDragDropTarget; ObservableCollection listBoxBinding = vm.Slots[target.Name]; object data = e.Data.GetData(e.Data.GetFormats()[0]); ItemDragEventArgs eventArgs = data as ItemDragEventArgs; SelectionCollection coll = eventArgs.Data as SelectionCollection; ItemModel newItem = coll.Select(t => t.Item).OfType ().FirstOrDefault(); if (!target.Name.StartsWith(newItem.ItemSlot)) // don't allow drop { e.Effects = Microsoft.Windows.DragDropEffects.None; e.Handled = true; } else { } };
