[site]: stackoverflow
[post_id]: 4659663
[parent_id]: 
[tags]: 
Internet Explorer quirk - Frameset rows & cols properties when dragging/resizing frames

Salut all, I'll try and keep this brief: In one of the visually gnarlier areas of the web app I'm responsible for I've written a couple of simple JS functions to store and recall the positions of frames within a frameset. The screen is highly user specific and consists of nested framesets (I know, I know but this is legacy code and we presently don't have the resource available to refactor it) and it's nice for them to drag frames around so they can see the elements they need, these positions are written to a cookie so that when they next enter this area of functionality it's presented much as they left it. This works beautifully in Firefox which I mostly use to develop with but has failed testing under IE8 which we need to support. I think I've identified the properties that are responsible: var cols = new Array(); var rows = new Array(); var framesets=parent.document.getElementsByTagName('frameset'); for (var i = 0; i These arrays are written to a cookie but it's the position values obtained that seem to be at fault. It doesn't matter which variant I use e.g. cols[i]=framesets[i].cols; cols[i]= parent.document.getElementsByTagName('frameset')[i].cols; cols[i]= parent.document.getElementsByTagName('frameset').item(i).cols; cols[i]= parent.document.getElementsByTagName('frameset')[i].getAttribute("cols"); the rows and cols properties are never updated in IE after the frames have been dragged to their new position. Every other aspect is working as intended - the cookies are created as the frameset unloads and on loading the frame properties are written to. Ironically IE has no problem writing to these properties if I supply hard-coded values, the frames will then resize like a charm but it seems I'm unable to record their values after the frames have been manually repositioned. Futhermore, I can see the properties changing under Firefox's Firebug when I manually drag the frames around to resize them but not with IE's developer tools - the frames' rows and cols properties remain as ther initial/default values, even after refreshing the output. Values of rows and cols after dragging frames: IE8 Developer Tools Firebug I would love to get this working, has anyone encountered anything similar or perhaps there is another approach or way of accessing these properties I could use to store the frame positions? This should be fairly standard stuff - I'm struggling to believe that IE doesn't update the frame properties after they have been repositioned. Edit: I think this is a feature of nested framesets in IE - a test of simple frames inside a single frameset looks as if the rows and cols properties will update when the divider is moved, not so with nested framesets. Any help hugely appreciated. Thanks! Chris
