[site]: crossvalidated
[post_id]: 592092
[parent_id]: 
[tags]: 
Expected Improvement (EI) in Bayesian Optimization failed to converge

I am not sure if "converge" is a proper description of my problem. I'll state it in detail below. I'm working on a CFD problem which means each sample is expensive. The framework I choose to work with is Gaussian Process (surrogate model) + Bayesian Optimization (promise minimal steps in optimization) using Expected Improvement to find the next sample location. The initial 30 sample locations were drawn by means of Latin Hypercube (LHS). Using these 30 samples a Gaussian Process Regression model was built. Extra simulations were ran based on the locations EI suggested that could have the maximum improvement. The score I used to evaluate the fitness is RMSE. The problem is that the RMSE keeps decreasing for the first 15 extra samples. Then the RMSE increases for more extra samples. In contrary to my expectation that the RMSE would decrease monotonically. One reason I think about is overfitting. For for a 12x12 domain with grid size 0.01, 30 initial samples + 15 extra samples shouldn't already lead to overfit the model. Another possibility might be that two sample locations are too close which caused an ill-conditioned covariance matrix that might ruin the predictions. I then checked the locations of all samples, see below some of the "closest" samples... I'm not sure if it is considered "too close"? sample 101 and 114 are the closest with a difference in b of 0.48. And the evaluation of the RMSE likes : ... (keeps optimizing) ... Opt hyperparams: 172**2 * RBF(length_scale=4.66) RMSE of GP predition is: 0.5197 EI_max is : 2.3225 next location is: [10.5306 12. ] Opt hyperparams: 169**2 * RBF(length_scale=4.64) RMSE of GP predition is: 0.4832 EI_max is : 1.4661 next location is: [1.4694 0. ] Opt hyperparams: 163**2 * RBF(length_scale=4.55) RMSE of GP predition is: 0.4304 EI_max is : 0.4505 next location is: [ 6.6122 12. ] **Opt hyperparams: 168**2 * RBF(length_scale=4.47) RMSE of GP predition is: 0.2987 As shown above, EI keeps improving the surrogate model until one point, then the approximation is worse taking any extra sample. I also tried to fix the hyperparameters (constant for magnitude and length scale), but it didn't help. What is the root for this behavior? Thank you.
