[site]: stackoverflow
[post_id]: 5484434
[parent_id]: 
[tags]: 
Linear filter (FIR) in Hadoop (Hadoop in Action exercise)

Exercise 4, Chapter 4 in Hadoop in Action is about implementing a linear filter computing the moving average of a time series. That is, given N and a series of timestamped values a(t), compute y, where y(t) = a(t)*1/N + a(t-1)*1/N + ... + a(t-N)*1/N. I'm having trouble implementing this in Mapreduce. A reducer needs to receive the N records required to compute an element in y together. Even if the records are ordered chronologically, these N records might be split across two mappers. What kind of key to emit in the mapper would guarantee that the same reducer receives these N records? Their timestamps are all different and are thus not useful as keys. Or am I completely off in my approach? I'd be thankful for hints.
