[site]: datascience
[post_id]: 94793
[parent_id]: 94788
[tags]: 
You could use pandas pivot_table() to transform your data frame into a count matrix, and then apply sklearn TfidfTransformer() to the count matrix in order to obtain the tf-idfs. import pandas as pd from sklearn.feature_extraction.text import TfidfTransformer # input data df = pd.DataFrame({ 'RepID': [1, 1, 1, 2, 2, 5684, 5684, 5684], 'Word': ['Doctor', 'diabetes', 'patient', 'patient', 'arm', 'cough', 'Xray', 'Covid'], 'BOW': [3, 4, 1, 2, 7, 9, 3, 5] }) # count matrix df = pd.pivot_table(df, index='RepID', columns='Word', values='BOW', aggfunc='sum') df = df.fillna(value=0) print(df) # Word Covid Doctor Xray arm cough diabetes patient # RepID # 1 0.0 3.0 0.0 0.0 0.0 4.0 1.0 # 2 0.0 0.0 0.0 7.0 0.0 0.0 2.0 # 5684 5.0 0.0 3.0 0.0 9.0 0.0 0.0 # tf-idf transform X = TfidfTransformer().fit(df.values) print(X.idf_) # [1.69314718 1.69314718 1.69314718 1.69314718 1.69314718 1.69314718 1.28768207]
