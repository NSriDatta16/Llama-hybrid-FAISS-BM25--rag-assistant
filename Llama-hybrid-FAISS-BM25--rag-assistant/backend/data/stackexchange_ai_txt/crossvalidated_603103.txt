[site]: crossvalidated
[post_id]: 603103
[parent_id]: 603065
[tags]: 
You can easily test this by doing multinomial regression. To fit the null hypothesis of a first order Markov chain you would include the previous state as a covariate in the model. You then estimate 6 parameters which translates into an estimate of the $3\times3$ transition matrix. To fit the alternative hypothesis that you have a 2. order Markov chain, you instead include both the state at time $t-1$ and $t-2$ and an interaction between those as covariates. You then estimate 18 parameters which translates into an estimate of $27$ transition probabilities (from each of the $3\times 3=9$ second order states the chain can transition only to three possible states). You can then test the null against the alternative using a likelihood ratio test in the usual way. The following shows an R implementation of the above as well as the test of conditional independence proposed by @Ben via log-linear models. The resulting identical LRT-statistics suggest that the tests are equivalent. # Simulate some data n Loading required package: stats4 #> Loading required package: splines mod0 1 2 3 #> 1 0.4166667 0.3055556 0.2777778 #> 2 0.3636364 0.3636364 0.2727273 #> 3 0.3103448 0.3448276 0.3448276 # Fit the alternative mod1 1 2 3 #> 1 0.2000000 0.46666667 0.3333333 #> 2 0.3636364 0.18181818 0.4545455 #> 3 0.3333333 0.33333333 0.3333333 #> 4 0.7500000 0.08333333 0.1666667 #> 5 0.3333333 0.50000000 0.1666667 #> 6 0.4444444 0.33333333 0.2222222 #> 7 0.3333333 0.33333333 0.3333333 #> 8 0.4000000 0.40000000 0.2000000 #> 9 0.1818182 0.36363636 0.4545455 # Test the null against the alternative anova(mod0, mod1, test="LRT", type = "I") #> Analysis of Deviance Table #> #> Model 1: y ~ xlag1 #> Model 2: y ~ xlag1 + xlag2 + xlag1:xlag2 #> Resid. Df Resid. Dev Df Deviance Pr(>Chi) #> 1 190 213.56 #> 2 178 198.24 12 15.322 0.2243 # Testing conditional independence as suggested Ben via log-linear models tables , , xlag1 = 1 #> #> xlag2 #> y 1 2 3 #> 1 3 9 3 #> 2 7 1 3 #> 3 5 2 3 #> #> , , xlag1 = 2 #> #> xlag2 #> y 1 2 3 #> 1 4 4 4 #> 2 2 6 4 #> 3 5 2 2 #> #> , , xlag1 = 3 #> #> xlag2 #> y 1 2 3 #> 1 3 4 2 #> 2 3 3 4 #> 3 3 2 5 library(MASS) loglin(tables, list(c(1,3),c(2,3))) #> 2 iterations: deviation 0 #> $lrt #> [1] 15.32195 #> #> $ pearson #> [1] 14.73557 #> #> $df #> [1] 12 #> #> $ margin #> $margin[[1]] #> [1] "y" "xlag1" #> #> $ margin[[2]] #> [1] "xlag2" "xlag1" ```
