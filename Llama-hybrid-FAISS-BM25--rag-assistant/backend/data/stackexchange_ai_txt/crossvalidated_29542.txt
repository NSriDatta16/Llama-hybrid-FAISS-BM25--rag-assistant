[site]: crossvalidated
[post_id]: 29542
[parent_id]: 
[tags]: 
Estimating Diversity of operon types using HMMs across metagenomes: Mann-Whitney? Kruskal-Wallis? or other?

Question that seems complex but probably isn't. I'm comparing 10 metagenomes (http://en.wikipedia.org/wiki/Metagenomics), that are supposedly unrelated (they are 10 geographically separate locations), for a specific group of operons (http://en.wikipedia.org/wiki/Operon). I'm using Hidden Markov Model protein profiles (HMMs) to find the specific genes in each of my metagenomes. The results are counts (hits) of the fragments of the operon to the HMM, which I assume to be representative of the protein. Some Proteins have more than 1 HMM. So, I have a list of HMM's and counts per Location. ** * ** you can start reading from here if metagenomics is a mystery to you as Statistics is a mystery to me * ** * ** To simplify : I'm comparing mug factories, there are Y different types of mugs, some mugs have 10 colours some have 5 some have 3 etc. I can detect the Chips of broken mugs, one chip at a time. each chip is of a different colour. I want to compare the diversity of mugs at each factory, to say one factory shows more diversity in mugs than the rest... or two of them show tendencies towards preferring 5 coloured mugs etc (A mug that has 5 colours). The snag is I'm not seeing the mugs as a whole, I'm only able to detect 1 chip at a time. So my counts are the chips. For example: for the three coloured mugs each chip is of a different colour, one 5 coloured mug has 5 different colours, another 5 coloured mug has 5 colours, 4 of which are the same as the first 5 coloured mug (so 6 possible colours for the 5 coloured mug) all different from the three coloured mug. The 10 coloured mug has 13 possible colours (also different from the last two mugs), etc (there are many types of mugs in any one of these factories- about 130 of them). So ... The way I've attempted to approach it is as follows: for each theoretical mug I grouped the colours took counts and averaged them according to the possible number of colours. For each factory I calculated the Shannon index H using the average (ignoring any whole mugs that gave me zeros) Compared the H's to each other...... (probably not correct to do so) After some reading, I came across the Mann-Whitney-U-test, In theory I can compare each 2 factories to each other, but instead of averaging them I use the colours as separate sample units (the colours become n s), and rank them? , So to compare the 10 factories I have to do the test for factory 1 to 2, 1 to 3, 1 to 4, etc... (Problem is some of my colour observations have less than 2 counts, many are 1 or 0) I could use the Kruskal-Wallis test (But I'm not sure about how there are different n's for each location), this will tell me that the factories are different, but not which is more different from the other(?right What approach do you guys think I should take? Is there a better alternative I've not found? I'm not a statistician, and I'm doing all this in Excel, NOT familiar with R at ALL. Hope my question isn't too convoluted. Thanks.
