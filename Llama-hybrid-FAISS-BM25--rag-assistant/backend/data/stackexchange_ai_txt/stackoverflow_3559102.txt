[site]: stackoverflow
[post_id]: 3559102
[parent_id]: 3558988
[tags]: 
lag() works with time series, whereas you are trying to use bare matrices. This old question suggests using embed instead, like so: lagmatrix for instance > x [1] 8 2 3 9 8 5 6 8 5 8 > lagmatrix(x, 1) [,1] [,2] [1,] 8 NA [2,] 2 8 [3,] 3 2 [4,] 9 3 [5,] 8 9 [6,] 5 8 [7,] 6 5 [8,] 8 6 [9,] 5 8 [10,] 8 5
