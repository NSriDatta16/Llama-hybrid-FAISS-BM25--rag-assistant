[site]: stackoverflow
[post_id]: 5538564
[parent_id]: 
[tags]: 
Configuring Integration Tests using Spring/Jetty (or Tomcat)/Maven for REST tests

I would like to test our REST service with HTTP requests (kinda blackbox testing). However, after a couple of hours googling and trying different configs, I am still not able to start Jetty correctly. Here is the my current configuration (I tried multiple different versions): pom.xml ... org.apache.maven.plugins maven-surefire-plugin 2.8 junit:junit **/*_Roo_* **/*Util* **/*IT* once -javaagent:'${settings.localRepository}/org/springframework/spring-instrument/${org.springframework-version}/spring-instrument-${org.springframework-version}.jar' -javaagent:'${settings.localRepository}/org/aspectj/aspectjweaver/${org.aspectj-version}/aspectjweaver-${org.aspectj-version}.jar' true org.apache.maven.plugins maven-failsafe-plugin 2.8 once -javaagent:'${settings.localRepository}/org/springframework/spring-instrument/${org.springframework-version}/spring-instrument-${org.springframework-version}.jar' -javaagent:'${settings.localRepository}/org/aspectj/aspectjweaver/${org.aspectj-version}/aspectjweaver-${org.aspectj-version}.jar' false integration-test integration-test verify verify org.mortbay.jetty maven-jetty-plugin 6.1.10 10 foo 9999 /${project.artifactId} 9090 start-jetty pre-integration-test run 0 true stop-jetty post-integration-test stop ... orm.xml --> Right now, I am getting the exception: java.lang.IllegalStateException: ClassLoader [org.mortbay.jetty.webapp.WebAppClassLoader] does NOT provide an 'addTransformer(ClassFileTransformer)' method. Specify a custom LoadTimeWeaver or start your Java virtual machine with Spring's agent: -javaagent:org.springframework.instrument.jar I understand the exception, but I wasn't able to fix it. I also tried a couple of other approaches, like giving the javaagent via MAVEN_OPTS or trying to set VM args to Jetty. The problem is Google gives back a bunch of 'solutions' for different versions and none was working. I am currently pretty frustrated that a common scenario like doing REST services tests, is so hard to achieve in Spring. So if you are clever enough to find the right configuration, please share it with me in a way that even a monkey could configure it and I promise if we ever met the beers are on me. Here are the versions I use: 1.6 3.0.5.RELEASE 1.6.9 1.5.10 1.0.0.BUILD-SNAPSHOT 3.6.0.Final 2.3.1 Maven 2.21 I happily provide more information if needed. Like I said every help appreciated.
