[site]: crossvalidated
[post_id]: 374879
[parent_id]: 374799
[tags]: 
Model 1, Logistic regression without random effect: $$\mathrm{Logit}(\Pr(Y=1)) = X\beta$$ We know MLE $\hat \beta$ is asymptotically unbiased. But $$\hat Pr(Y=1) = \mathrm{Logit}^{-1}(X\hat\beta)$$ is biased estimate of $\Pr(Y=1)$ , because the non-linearity of the logit function. But asymptotically it is unbiased. So for model 1, $\hat Pr(Y=1) = \mathrm{Logit}^{-1}(X\hat\beta)$ is acceptable. Model 2, Logistic regression with random intercept: $$\mathrm{Logit}(\Pr(Y_{ij}=1)) = X_{ij}\beta + \gamma_i$$ $$\gamma \sim N(0,\sigma^2)$$ In this situation, the common mistake is $$\Pr(Y=1|X) = \mathrm{E}(Y|X) = \mathrm{E}(\mathrm{Logit}^{-1}(X\beta + \gamma_i)) =\mathrm{Logit}^{-1}( \mathrm{E}(X\beta + \gamma_i)) = \mathrm{Logit}^{-1}(X\beta) $$ In this process the non-linearity of the logit function is totally igored. So the following output is very misleading. It gives a idear that for group 1 student, Probability of correction is 4.5%. student_type prob SE df asymp.LCL asymp.UCL student_group_1 0.04491007 0.004626728 NA 0.03666574 0.0549025 student_group_2 0.06503249 0.015117905 NA 0.04097546 0.1017156 The mistake above cannot be contributed to mixed effect logistic regression, should come from the misinterpretation of the results. Let look how to correctly derived the marginal mean of $Y$ . $$\Pr(Y=1|X) = \mathrm{E}(Y|X) = \mathrm{E}(\mathrm{Logit}^{-1}(X\beta + \gamma_i)) =\int_{-\infty}^{\infty} \mathrm{Logit}^{-1}(z)\phi(z)dz$$ where $z=X\beta + \gamma_i$ and $\phi$ is pdf of $N(X\beta, \sigma^2)$ For Group 1 student, the results indicate that $X\beta= -3.0571$ , $\sigma = 1.881$ . Using Gaussâ€“Hermite quadrature method with 20 points, I got $\Pr(Y=1|X=0) = 0.1172$ . similarly, $\Pr(Y=1|X=0) = 0.1492$ .
