[site]: stackoverflow
[post_id]: 226621
[parent_id]: 226505
[tags]: 
You can surround the prefix part in brackets and match 0 or 1 occurrences (((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\))+)? So the whole regex will become (((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\))+)?[\w\d:#@%/;$()~_?\+-=\\\.&]*) The problem with that is it's going to match more or less any word. For example "test" would also be a match. Where are you going to use that regex? Are you trying to validate a hostname or are you trying to find hostnames inside a paragraph?
