[site]: datascience
[post_id]: 103791
[parent_id]: 
[tags]: 
Error when trying to predict BERT model and obtaining classification report

I am following this tutorial about multi-label, multi-class classification using BERT. I am trying to get the predicted classification for y_pred , but when running it I got an error. # Ready test data test_y_kriteria = to_categorical(data_test['Kriteria']) test_y_sentiment = to_categorical(data_test['Sentiment']) test_x = tokenizer( text=data_test['Review Text'].to_list(), add_special_tokens=True, max_length=max_length, truncation=True, padding=True, return_tensors='tf', return_token_type_ids = False, return_attention_mask = False, verbose = True) # Run evaluation model_eval = model.evaluate( x={'input_ids': test_x['input_ids']}, y={'kriteria': test_y_kriteria, 'sentiment': test_y_sentiment} #Predict pred = model.predict(test_x) The error is ValueError: Unsupported value type BatchEncoding returned by IteratorSpec._serialize . I tried changing test_x into a list # Ready test data test_y_kriteria = to_categorical(data_test['Kriteria']) test_y_sentiment = to_categorical(data_test['Sentiment']) tokenized_test_x = [ tokenizer.tokenize( text=txt, add_special_tokens=True, max_length=max_length, truncation=True, padding=True, return_tensors='tf', return_token_type_ids = False, return_attention_mask = False, verbose = True) for txt in data_test['Review Text'].to_list()] # Run evaluation model_eval = model.evaluate( x={'input_ids': test_x['input_ids']}, y={'kriteria': test_y_kriteria, 'sentiment': test_y_sentiment} ) #Predict pred = model.predict(tokenized_test_x) and I got this error instead ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type list). . I tried to look for solution for this, and most solutions suggested to use asarray() , so I ran arr_token = np.asarray(tokenized_test_x, dtype=object) and tried to predict using arr_token but it still returned the same error. How do I solve this?
