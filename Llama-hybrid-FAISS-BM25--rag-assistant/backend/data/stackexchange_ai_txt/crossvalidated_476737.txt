[site]: crossvalidated
[post_id]: 476737
[parent_id]: 469349
[tags]: 
The cox.zph() function* has a terms parameter setting. If that is set to TRUE, all levels of a categorical factor variable are considered together; if set to FALSE, you get separate analysis of each level versus the reference level. The default is now TRUE but my sense is that it might once have been FALSE. See whether that explains your splitting of factor variables. The bigger problem is that your attempt to solve the proportional hazards (PH) problem by adding combinations of predictor variables is unlikely to work. It's more likely that there are problems with the model assumptions that need to be dealt with. One possible problem is mis-specification of the model. For example, if the form of the association between a predictor and outcome is incorrectly specified (that is, the log hazard is not linearly related to the predictor value), then that can show up as a violation of PH. See this page for an example. Log transformations of things like gene-expression values, or flexible modeling of continuous predictors with restricted cubic splines, might improve both the model and the PH results. There's no a priori reason why PH must hold. Another approach is to use a parametric survival model that does not assume PH, like a log-normal model . That replaces a PH test with corresponding tests of parametric model adequacy. It's also possible that you truly have time-dependent hazards associated with certain phenotypic variables and that you will need to deal with them directly. For example, the association of some variables with outcome might be very important at early times but insignificant at later times. The survival package vignette called "Using Time Dependent Covariates" goes into ways to deal with time-dependent hazard ratios in Section 4. It's also possible, particularly with large data sets, that you may get a "statistically significant" violation of PH that is of minimal practical importance. Look at the curves showing the residuals versus time provided by cox.zph() and apply your knowledge of the subject matter. Without proportional hazards a hazard ratio is a type of rough average, characterized in this answer as "a ratio of average hazards," so some deviations from the ideal PH might be acceptable. *You evidently used cox.zph() in a version of survival prior to 3.0, as your output includes a rho column, the correlation of the scaled Schoenfeld residuals with (transformed) time. In version 3.0 and later, the test is the score test that the earlier correlation test approximated. You will get different results wth later versions of the package, so be warned.
