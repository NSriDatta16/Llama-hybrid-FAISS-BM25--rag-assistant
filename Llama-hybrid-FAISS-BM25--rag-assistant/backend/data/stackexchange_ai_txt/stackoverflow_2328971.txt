[site]: stackoverflow
[post_id]: 2328971
[parent_id]: 2328836
[tags]: 
This looks quite similar to F# How to Percentile Rank An Array of Doubles? . Here's a variation of my answer to that question: let rank arr (ranks:float[]) = let rev = Array.rev arr let len = Array.length arr let first x = Array.findIndex (fun y -> y = x) arr let last x = len - (Array.findIndex (fun y -> y = x) rev) - 1 let avgR x = ranks.[(first x) .. (last x)] |> Array.average Array.map avgR arr This assumes that arr is sorted and that the elements in arr support equality comparisons.
