[site]: stackoverflow
[post_id]: 3340068
[parent_id]: 3340021
[tags]: 
Use: SELECT yt.qty, x.cat_avg, yt.sales/yt.qty AS avg_price, NULL AS weighted_average FROM YOUR_TABLE yt JOIN (SELECT t.category, AVG(t.qty) AS cat_avg FROM YOUR_TABLE t GROUP BY t.category) x ON x.category = yt.category WHERE yt.seller = 'Ash' I'll fill in the weighted average when you supply the equation, if possible.
