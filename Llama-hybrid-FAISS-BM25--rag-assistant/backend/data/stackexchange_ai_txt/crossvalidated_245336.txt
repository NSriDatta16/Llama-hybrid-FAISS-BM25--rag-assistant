[site]: crossvalidated
[post_id]: 245336
[parent_id]: 245334
[tags]: 
The Schur Complement, is the goto for this kind of computation. Let $Y \sim \mathcal{N}(0,\Sigma)$, where $Y$ and $\Sigma$ are organized such that the last element and row/column belong to the variable you wish to condition on. Then, $Y_{-k}|Y_k$ is distributed, $\mathcal{N}\left(\mu_{-k}, \Sigma_{-k}\right)$, where $Y_{-k}$ consists of the elements of $Y$ not including $k$; $\Sigma = \left( \begin{array}{rr} A & B\\ B^{T} & C\\ \end{array} \right)$ in slightly R'ish parlance $A = \Sigma[-k,-k]$, $B=\Sigma[-k,k]$, and $C = \Sigma[k,k]$; $\Sigma_{-k} = A - BC^{-1}B^T$; and $\mu_{-k} = BC^{-1}Y$. The covariance of $Y_i$ and $Y_j$ given $Y_k$ can then be retrieved from $\Sigma_{-k}$. A fast way to calculate this numerically is through the sweep function (Dempster 1969). Dempster, A.P. (1969). Elements of continuous multivariate analysis. Reading, MA: Addison- Wesley.
