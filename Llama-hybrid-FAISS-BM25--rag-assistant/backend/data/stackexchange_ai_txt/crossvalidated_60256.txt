[site]: crossvalidated
[post_id]: 60256
[parent_id]: 
[tags]: 
Standard deviation of binned observations

I have a dataset of sample observations, stored as counts within range bins. e.g.: min/max count 40/44 1 45/49 2 50/54 3 55/59 4 70/74 1 Now, finding an estimate of the average from this is pretty straight forward. Simply use the mean (or median) of each range bin as the observation and the count as a weight and find the weighted average: $$\bar{x}^* = \frac{1}{\sum_{i=1}^N w_i} \sum_{i=1}^N w_ix_i$$ For my test case, this gives me 53.82. My question now is, what's the correct method of finding the standard deviation (or variance)? Through my searching, I've found several answers, but I'm unsure which, if any, is actually appropriate for my dataset. I was able to find the following formula both on another question here and a random NIST document . $$s^{2*} = \frac{ \sum_{i=1}^N w_i (x_i - \bar{x}^*)^2 }{ \frac{(M-1)}{M} \sum_{i=1}^N w_i }$$ Which gives a standard deviation of 8.35 for my test case. However, the Wikipedia article on weighted means gives both the formula: $$s^{2*} = \frac{ \sum_{i=1}^N w_i}{(\sum_{i=1}^N w_i)^2 - \sum_{i=1}^N w_i^2} \sum_{i=1}^N w_i(x_i-\bar{x}^*)^2$$ and $$s^{2*} = \frac{1}{(\sum_{i=1}^N w_i) - 1} \sum_{i=1}^N w_i(x_i-\bar{x}^*)^2$$ Which give standard deviations of 8.66 and 7.83, respectively, for my test case. Update Thanks to @whuber who suggested looking into Sheppard's Corrections, and your helpful comments related to them. Unfortunately, I'm having a difficult time understanding the resources I can find about it (and I can't find any good examples). To recap though, I understand that the following is a biased estimate of variance: $$s^{2*} = \frac{1}{\sum_{i=1}^N w_i} \sum_{i=1}^N w_i(x_i-\bar{x}^*)^2$$ I also understand that most standard corrections for the bias are for direct random samples of a normal distribution. Therefore, I see two potential issues for me: These are binned random samples (which, I'm pretty sure, is where Sheppard's Corrections come in.) It's unknown whether or not the data is for a normal distribution (thus I'm assuming not, which, I'm pretty sure, invalidates Sheppard's Corrections.) So, my updated question is; What's the appropriate method for handling the bias imposed by the "simple" weighted standard deviation/variance formula on a non-normal distribution? Most specifically with regards to binned data. Note: I'm using the following terms: $s^{2*}$ is the weighted variance $N$ is the number of observations. (i.e. the number of bins) $M$ is the number of nonzero weights. (i.e. the number of bins with counts) $w_i$ are the weights (i.e. the counts) $x_i$ are the observations. (i.e. the bin means) $\bar{x}^*$ is the weighted mean.
