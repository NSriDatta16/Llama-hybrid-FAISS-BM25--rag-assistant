[site]: crossvalidated
[post_id]: 243328
[parent_id]: 243324
[tags]: 
As noted by ocram , next you need to calculate the proportion of intervals containing the true value mean(waldL where p is the true probability of success. Notice that the value of n (in rbinom(nsamples, n, p) ) limits the number of distinct pHat values to the set (1:n)/n , so with n equal to 40 you should not expect exact $100\alpha\%$ coverage, but it should get closer as n grows. A coding side-note: don't use x^(1/2) for square root, use sqrt instead. In all (or at least majority) of the programming languages sqrt is more computationally efficient then ^(1/2) , for example a quick benchmark in R shows that it is approximately six times faster: test replications elapsed relative user.self sys.self user.child sys.child 1 sqrt(x) 500 0.48 1.000 0.37 0.08 NA NA 2 x^(1/2) 500 2.87 5.979 2.72 0.12 NA NA
