[site]: crossvalidated
[post_id]: 141544
[parent_id]: 
[tags]: 
Am I coding and interpreting multiple Heaviside Functions correctly in a Cox model

This is a long example, so be prepared.... I am wondering if I am coding multiple Heaviside Functions correctly in a cox model using R. There are plenty examples of Using 2 heaviside functions but i cannot find good examples of 3 or more HS functions. First off, we study seed germination, which means that "death" is actually germination of a seed and "survival" is a seed remaining un germinated. The experimental design revolves around incubators going through a temperature change every 4 days starting at 32C and ending at 4C, and then there is a 8 day storage time at 20C. We have two treatments, 30-day and 60-day storage at 27.5C. I wish to derive a hazard rate at each Temperature and compare the 30-day treatment to the control, and the 60-day treatment to the control. Obviously the control will be our baseline. below I describe our current attempt. Data can be found in link below [ https://www.dropbox.com/s/5etn1pbvifbfke1/S.O.testcode?dl=0][1] subsequent code references data file as Pop0 We measured germination every two days therefore we have interval data coded by Day1 and Day2. For example, on Day2 (our first observation) Day1=0 and Day2=2. The last observation was Day1=32 Day2=40. Since temperatures were changed every 4 days, we wish to compare rates every 4 days. Therefore we create a new time variable that is measured every 4 days. However, for the last point, we wish to include 8 days not 4 for (i in 1:length(Pop0$Temp)){ ifelse(Pop0$Day1[i]==0,Pop0$NDay1[i] Now we create cut points for our Heaviside Functions pops.cph30=survSplit(Pop0,cut=c(4,8,12,16,20,24,28,32),end="Day2",event="Event",start="Day1") pops.cph30$hv1TD3032=pops.cph30$TD30C*(pops.cph30$Day1 2&pops.cph30$Day1 6&pops.cph30$Day1 10&pops.cph30$Day1 14&pops.cph30$Day1 18&pops.cph30$Day1 22&pops.cph30$Day1 26&pops.cph30$Day1 30) Define Surv object and Cox model Y30=Surv(pops.cph30$Day1,pops.cph30$Day2, pops.cph30$Event) k Print Summary with all Heaviside Functions Call: coxph(formula = Y30 ~ hv1TD3032 + hv2TD3028 + hv3TD3024 + hv4TD3020 + hv5TD3016 + hv6TD3012 + hv7TD308 + hv8TD304 + hv9TD3020 + cluster(Rep), data = pops.cph30) n= 5328, number of events= 160 coef exp(coef) se(coef) robust se z Pr(>|z|) hv1TD3032 NA NA 0.0000 0.0000 NA NA hv2TD3028 NA NA 0.0000 0.0000 NA NA hv3TD3024 NA NA 0.0000 0.0000 NA NA hv4TD3020 0.8981 2.4548 0.6455 0.6230 1.442 0.1494 hv5TD3016 0.4108 1.5081 0.4454 0.4871 0.844 0.3989 hv6TD3012 0.4367 1.5475 0.4454 0.4379 0.997 0.3187 hv7TD308 0.3216 1.3793 0.5774 0.2828 1.137 0.2556 hv8TD304 -0.2008 0.8181 0.6325 0.2663 -0.754 0.4507 hv9TD3020 0.5899 1.8039 0.2720 0.2656 2.221 0.0263 * Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 exp(coef) exp(-coef) lower .95 upper .95 hv1TD3032 NA NA NA NA hv2TD3028 NA NA NA NA hv3TD3024 NA NA NA NA hv4TD3020 2.4548 0.4074 0.7240 8.324 hv5TD3016 1.5081 0.6631 0.5806 3.917 hv6TD3012 1.5475 0.6462 0.6559 3.651 hv7TD308 1.3793 0.7250 0.7923 2.401 hv8TD304 0.8181 1.2224 0.4854 1.379 hv9TD3020 1.8039 0.5544 1.0719 3.036 Concordance= 0.547 (se = 0.018 ) Rsquare= 0.002 (max possible= 0.284 ) Likelihood ratio test= 8.16 on 6 df, p=0.2268 Wald test = 17.12 on 6 df, p=0.008842 Score (logrank) test = 9.17 on 6 df, p=0.1645, Robust = 3.74 p=0.7111 (Note: the likelihood ratio and score tests assume independence of observations within a cluster, the Wald and robust score tests do not). My questions is about the interpretation of the hazard ratios in the output for a particular Heaviside function. Would I be correct in interpreting that the Proportional hazard assumption is violated for Heaviside function 9 (hv9TD3020? Therefore I could conclude that the germination rates at that temperature (20C) after 30 days is larger than that of the control (baseline). All other heaviside functions are also larger for 30 day stored seeds, except for at temp 4C (hv8TD304), However the differences are not statistically different. here is a plot of the data surv.time Is there a way for me to improve my question? I assume the heaviside functions are not used frequently. I base my code on the published work of Kleinbaum and Klein. The "Backmatter" has good examples of code. -Michael
