[site]: stackoverflow
[post_id]: 2333477
[parent_id]: 
[tags]: 
mod_rewrite with location-based ACL in apache?

There is a CGI-script that provides some API for our customers. Call syntax is: script.cgi?module= &func= [&other-options] The task is to make different authentiction rules for different modules. Optionally, it will be great to have nice URLs. My config: DocumentRoot /var/www/example ServerName example.com # Global policy is to deny all Order deny,allow Deny from all # doesn't work :( Order deny,allow Deny from all Allow from 127.0.0.1 RewriteEngine On # The only allowed type of requests: RewriteRule /api/(.+?)/(.+) /cgi-bin/api.cgi?module=$1&func=$2 [PT] # All others are forbidden: RewriteRule /(.*) - [F] RewriteLog /var/log/apache2/rewrite.log RewriteLogLevel 5 ScriptAlias /cgi-bin /var/www/example Options -Indexes AddHandler cgi-script .cgi Well, I know that problem is order of processing that directives. s will be processed after mod_rewrite has done its work. But I believe there is a way to change it. :) Using of standard Order deny,allow + Allow from directives is preferable because it's commonly used in other places like this. Thank you for your attention. :)
