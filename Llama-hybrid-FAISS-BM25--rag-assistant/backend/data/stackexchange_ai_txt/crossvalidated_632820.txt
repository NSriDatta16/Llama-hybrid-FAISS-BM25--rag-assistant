[site]: crossvalidated
[post_id]: 632820
[parent_id]: 
[tags]: 
What is the probability of selecting couples from a waiting room?

Given a waiting room, filled with $N / 2$ couples ( $N$ an even number: the total number of people present in the waiting room), a doctor calls $n$ individuals from the waiting room at random. What is the probability of $K (0 \le K \le min(N/2,n/2))$ couples being among the group called? Inversely, what is the probability of $I (0 \le I \le min(N/2,n))$ individuals being among the group called? What I've Tried So Far My intuition was to first think of how many ways there are to pick K couples: $P_{N/2}^K$ . Then, how many ways are there to pick remaining individuals that will fill in the gaps among $n$ , i.e. after the couples are picked: $[N - 2K]\cdot[N-2K-2]\cdot[\ldots]\cdot[N-2K-2(n-2K-1)]$ . I reformulated the above into a piece of notation I just learned about (the double factorial): $\frac{(N-2K)!!}{[N-2K-2(n-2K)]!!}$ Rewritten: $\frac{[2(\frac{N}{2}-K)]!!}{[2(\frac{N}{2}-K-(n-2K))]!!}$ Because the above numerator and denominator are even, the double factorial can be replaced with a form I have more information about: $\frac{2^{\frac{N}{2}-K}(\frac{N}{2}-K)!}{2^{\frac{N}{2}-K-(n-2K)}[\frac{N}{2}-K-(n-2K)]!}$ Reformulated: $\frac{2^{n-2K}(\frac{N}{2}-K)!}{[\frac{N}{2}-K-(n-2K)]!}$ Reformulated again: $2^{n-2K}\left(P_{\frac{N}{2}-K}^{n-2K}\right)$ Then, almost there, I multiple the two probabilities (i.e. couples picked first, then individuals picked in order to fill the remaining slots), and divide it by the number of ways there are to re-organise the lineup: $\frac{2^{n-2K} \left(P_{\frac{N}{2}-K}^{n-2K}\right)\left(P^K_{N/2}\right)}{n!}$ Reformulated: $\frac{2^n\left(P_{\frac{N}{2}-K}^{n-2K}\right)\left(P^K_{N/2}\right)}{2^{2K} n!}$ The above, I believe, is the number of $n$ -selections where K couples are included and the remaining $n-2K$ selections are individuals without their partner. Assuming I haven't made a mistake, I would assume that dividing this sum by the total number of possible selections, ${N\choose{n}}$ , would give the probability I'm interested in, i.e. $p = \frac{2^n\left(P_{\frac{N}{2}-K}^{n-2K}\right)\left(P^K_{N/2}\right)}{2^{2K} n!{N\choose{n}}}$ Reformulated: $p = \frac{2^n\left(P_{\frac{N}{2}-K}^{n-2K}\right)\left(P^K_{N/2}\right)}{2^{2K} \left(P_N^n\right)}$ However, There appears to be a mistake aboveâ€¦ I tested the above in Python: >>> from math import perm >>> def f(N,n,K): ... n,d = 2**n*perm(N//2,K)*perm(N//2-K,n-2*K),2**(2*K)*perm(N,n) ... return n, d, n/d ... >>> for i in range(3): ... print(i, f(10,5,i)) ... 0 (3840, 30240, 0.12698412698412698) 1 (3840, 120960, 0.031746031746031744) 2 (1920, 483840, 0.003968253968253968) I must have made a mistake in my assumptions somewhere along the way, because the probabilities above appear off. E.g. the calculation states that the probability of selecting 2 couples, while choosing 5 from a group of 10, is lower than the probability of choosing 0 couples. This is clearly false. Using simulation, the expected probabilities for 0, 1 and 2 couples in the set of 5 are as follows: {1: 0.634806, 2: 0.2380557, 0: 0.1271383} N = sorted(list(range(5)) * 2) for _ in range(10000000): shuffle(N) couples = 5-len(set(N[:5])) results[couples] = results.get(couples,0)+1 print({k:v/sum(results.values()) for k, v in results.items()}) Any insights would be greatly appreciated.
