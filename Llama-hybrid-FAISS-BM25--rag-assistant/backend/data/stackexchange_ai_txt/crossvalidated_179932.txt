[site]: crossvalidated
[post_id]: 179932
[parent_id]: 
[tags]: 
Defining the likelihood function in survival analysis using SAS

I use proc lifereg procedure in SAS for survival analysis. In order to understand the process behind this procedure, I am trying to code the likelihood function and minimize it using proc nlp . Assume this is my dataset: data data; input age year nodes failure; cards; 30 6.4 1 1 30 6.2 3 1 30 6.5 0 1 31 5.9 2 1 31 6.5 4 1 33 5.8 10 1 33 6.0 0 1 34 5.9 0 2 34 6.6 9 2 34 5.8 30 1 34 6.0 1 1 34 6.1 10 1 34 6.7 7 1 34 6.0 0 1 35 6.4 13 1 35 6.3 0 1 36 6.0 1 1 36 6.9 0 1 37 6.0 0 1 37 6.3 0 1 37 5.8 0 1 37 5.9 6 1 37 6.0 15 1 37 6.3 0 1 38 6.9 21 2 38 5.9 2 1 38 6.0 0 1 38 6.0 0 1 38 6.2 3 1 38 6.4 1 1 38 6.6 0 1 38 6.6 11 1 38 6.0 1 1 38 6.7 5 1 39 6.6 0 2 ; run; And this is how I fit an exponential baseline hazard to the data: proc lifereg data=data; model year*failure(1)=/dist=exponential; run; Now, to form the likelihood function, I need to define failure (f) and survival (S) functions. I had a look at SAS support group , but I did not completely understand how f and S are defined. Anyhow, I coded the likelihood function as follows. data parameter(type=est); *Initializing the parameters; Keep _type_ Shape scale constant; _type_='parms'; Shape=1; scale=40; constant=1; output; run; proc nlp data=data NOMISS tech=tr inest=parameter Pcov phes; max LL; Parms Shape scale constant; mu=constant; *Vector of covariates ; w=log(year/scale); *This is my interpretation for w (It might be wrong); f = exp(w-mu)*exp(-exp(w-mu)); S = exp(-exp(w-mu)); likelihood = (f**(failure-1)) * (S**(2-failure)); LL = log(likelihood); run; Now the problem is the values of parameters from minimizing my likelihood function are different from the outputs of proc lifereg .
