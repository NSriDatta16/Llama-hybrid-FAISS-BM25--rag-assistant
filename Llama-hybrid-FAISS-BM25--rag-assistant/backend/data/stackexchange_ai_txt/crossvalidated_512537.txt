[site]: crossvalidated
[post_id]: 512537
[parent_id]: 
[tags]: 
Subject level variation in repeat measurement designs - representing treatment effects

Consider an experimental situation where each of $n$ participants are randomised to one of two treatments (e.g. active versus placebo). Our measuring device is known to have some variability in the results it gives so we take a series of (repeat) measurements from each participant. We want to examine the treatment effect and, to do so, we resist the urge to average each subject's measurements and instead fit a varying effects model. My go-to approach in this situation would be to consider a subject level random intercept model that accounts for the repeat measures. What I am wondering is whether it could make any sense to include a subject level slope for treatment? This would seem at least somewhat reasonable if the participants were given both the placebo and the treatment and data were collected under both conditions. Under that setting, there clearly would be within-subject variation in the responses under the placebo and active treatments. However, at least superficially, this idea seems to not fit when a participant is only ever allocated to either the active treatment or the placebo. Is my intuition correct or is it misguided? I have reviewed several questions, but am yet to find one that addresses this specific question. library(lmerTest) library(mvtnorm) library(data.table) library(ggplot2) getdat $trt, subject = d$ id) # wrong lm1 The call to lmer results in a warning indicating that it did not converge, but does return parameter estimates. bb $id)), ui = ranef(lm3)$ id[, 1], us = ranef(lm3) $id[, 2]) re[, mu0 := bb[1] + ui] re[, mu1 := bb[1] + ui + bb[2] + us] re id)))] ggplot(re, aes(x = trt, y = value, group = id)) + geom_line() + theme_bw() + scale_x_continuous(breaks = 0:1) Yielding Below is code that reallocate participants to both groups and then fits the model on the same data. Note that I need to check this again as it is not doing what I anticipated it would. So, I will update if/when I can figure it out. # realloc patients to both trts d[, trt := rbinom(.N, 1, prob = 0.5)] table(treatment = d $trt, subject = d$ id) d[, y := b1 + u1 + (b2 + u2) * trt + e] # seems more reasonable # equivalent to treatment by id interaction? lm4
