[site]: stackoverflow
[post_id]: 1603649
[parent_id]: 
[tags]: 
SQL Agent and Web.Config. WAS: SSRS Forms Authentication, Running subscriptions

I have successfully implemented Forms Authentication in SSRS, so it now uses both Roles and Users from my website, using the ordinary asp.net membership framework. I can log in to the portal and run any report, as long as I have the correct role from my original app. All good. However, if I create a subscription, then, when the subscription runs, I don't get my report, but rather this message in the log: subscription!WindowsService_0!161a0!10/21/2009-22:42:05:: i INFO: Microsoft.ReportingServices.Diagnostics.Utilities.InternalCatalogException: An internal error occurred on the report server. See the error log for more details. ---> System.Configuration.Provider.ProviderException: The Role Manager feature has not been enabled. at System.Web.Security.Roles.EnsureEnabled() at System.Web.Security.Roles.GetRolesForUser(String username) at MyApp.ReportServer.Security.Module.Authorization.CheckAccess(String userName, IntPtr userToken, Byte[] secDesc, ReportOperation requiredOperation) at Microsoft.ReportingServices.Library.Security.CheckAccess(ItemType catItemType, Byte[] secDesc, ReportOperation rptOper, String reportPath) at Microsoft.ReportingServices.Library.SecurityRequirements.CheckAccess(ItemType itemType, Byte[] securityDescriptor, String itemPath) at Microsoft.ReportingServices.Library.DefinitionLoader.GetParameterDefinition(CatalogItemContext itemContext, String historyId, Boolean forRendering, SecurityRequirements requirements) at Microsoft.ReportingServices.Library.RSService.GetReportParameters(ClientRequest session, CatalogItemContext reportContext, Boolean forRendering) at Microsoft.ReportingServices.Library.RSServiceDataProvider.GetParameters(ClientRequest session, CatalogItemContext reportContext) at Microsoft.ReportingServices.Library.RenderForNewSession.GetReportParameters() at Microsoft.ReportingServices.Library.RenderForNewSession.GetReportMetadata() at Microsoft.ReportingServices.Library.RenderForNewSession.get_ExecuteExistingSnapshot() at Microsoft.ReportingServices.Library.RenderForNewSession.GetExecutionStrategy() at Microsoft.ReportingServices.Library.ReportExecutionBase.InternalExecuteReport() at Microsoft.ReportingServices.Library.ReportExecutionBase.Execute() at Microsoft.ReportingServices.Diagnostics.CancelablePhaseBase.ExecuteWrapper() --- End of inner exception stack trace --- The MyApp line is my custom security extension. I have the RoleManager and membership provider setup in web.config in the /ReportServer directory. Does the subscription runner circumvent the website settings somehow? UPDATE: Ok, so I found out, that apparently it is running with whatever is values is set in MACHINE.CONFIG when a subscription is being evaluated/triggered by sql agent. Any clues why it doesn't use the web.config settings, but goes straight to machine.config?
