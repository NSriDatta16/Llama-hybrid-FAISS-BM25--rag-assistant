[site]: crossvalidated
[post_id]: 512254
[parent_id]: 512037
[tags]: 
This not a complete answer, but my hunch is that you are jumping from the (correct) fact that population autocorrelations are zero for an $MA(h)$ beyond its order $h$ to the joint asymptotic distribution of the sample autocorrelations also being multivariate normal with identity covariance matrix (which is of course what gives us the chi-square limiting distribution). The latter property is correct when testing the null of white noise against autocorrelation with the LB test, but no more when the actual process is $MA(h)$ . Essentially, neighboring sample autocorrelations are (partially) based on the same observations when the process has dependence, so that the sample autocorrelations are also not uncorrelated under dependence. Here is an excerpt from the relevant theorem in Brockwell and Davis, Time Series: Theory and Methods , where $W$ does indeed simplify to the identity matrix when the process is white noise. This formula can be shown to imply $$ w_{ii}=1+2\rho_1^2+2\rho_2^2+\ldots+2\rho_h^2 $$ for $i>h$ for an $MA(h)$ . So if we set s in your simulation so that we do not need to worry about covariances and consider an $MA(1)$ process for simplicity, we have $$ Q_{MA1} = T\hat\rho_{2}^2/(1+2\hat\rho_{1}^2) $$ should behave like a $\chi^2_1$ (where, by Slutzky's theorem, replacing the true variance of the second sample autocorrelation with a consistent estimator does not alter the asymptotic distribution). Here is an example for an $MA(1)$ where we work with the second sample autocorrelation. T If you wanted to work out a statistic that uses $\hat\rho_{2}$ and $\hat\rho_{3}$ with a $\chi_2^2$ limiting distribution, we would require $w_{23}$ . For an MA(1), similar calculations as above show this to be $2\rho_1$ , so that a LB-type statistic would read $$ Q_{MA1,2} = T(\hat\rho_{2}\;\; \hat\rho_{3})\begin{pmatrix}1+2\hat\rho_{1}^2&2\hat\rho_{1}\\2\hat\rho_{1}&1+2\hat\rho_{1}^2\end{pmatrix}^{-1}\begin{pmatrix}\hat\rho_{2}\\ \hat\rho_{3}\end{pmatrix} $$ Very good agreement with the asymptotic distribution may then be checked by modifying the above code with something like vcovacfs
