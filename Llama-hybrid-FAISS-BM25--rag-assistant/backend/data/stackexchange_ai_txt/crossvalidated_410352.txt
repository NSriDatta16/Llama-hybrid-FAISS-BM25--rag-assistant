[site]: crossvalidated
[post_id]: 410352
[parent_id]: 
[tags]: 
Analysis of variance with not normally distributed residuals : how important is normality?

I am using gls and anova to analyse my data. I use gls to aply weights. I have one factor (tree genotype) and I analyse its influence on soil content. Here is an exemple of my data with one variable (potassium) : > my_data If you look at homogeneity of variance for this data here's what you get : model1 > bartlett.test(resid(model1, type = "normalized") ~ fitted(model1, type = "normalized")) Bartlett test of homogeneity of variances data: resid(model1, type = "normalized") by fitted(model1, type = "normalized") Bartlett's K-squared = 27.957, df = 9, p-value = 0.0009697 > shapiro.test(resid(model1, type = "normalized")) Shapiro-Wilk normality test data: resid(model1, type = "normalized") W = 0.92237, p-value = 0.03503 And if you add weights in the gls you solve the problem for homogeneity but it makes it worse for normality : model2 > bartlett.test(resid(model2, type = "normalized") ~ fitted(model2, type = "normalized")) Bartlett test of homogeneity of variances data: resid(model2, type = "normalized") by fitted(model2, type = "normalized") Bartlett's K-squared = 3.5453e-12, df = 9, p-value = 1 > shapiro.test(resid(model2, type = "normalized")) Shapiro-Wilk normality test data: resid(model2, type = "normalized") W = 0.89024, p-value = 0.005766 Also, if I compare AIC, it proves my model with weights has a much better fit : > AIC(model1) [1] 21.60778 > AIC(model2) [1] 6.010106 > anova(model1,model2) Model df AIC BIC logLik Test L.Ratio p-value model1 1 11 21.607779 31.99661 0.196111 model2 2 20 6.010106 24.89889 16.994947 1 vs 2 33.59767 1e-04 All this considered, I choose to do my anova with my model 2 as follows : > anova(model2) Denom. DF: 19 numDF F-value p-value (Intercept) 1 390068270 Considering normality isn't met, are the results for my last anova trust-worty? A fellow coworker pointed this out to me and told me I should use PERMANOVA when normality isn't met because this test does not require normality. So I decided to give it a shot : > adonis(K~Genotype, data=my_data, method="bray", permutations=999) Call: adonis(formula = K ~ Genotype, data = my_data, permutations = 999, method = "bray") Permutation: free Number of permutations: 999 Terms added sequentially (first to last) Df SumsOfSqs MeanSqs F.Model R2 Pr(>F) Genotype 9 0.45880 0.050977 1.2793 0.37732 0.1 Residuals 19 0.75712 0.039849 0.62268 Total 28 1.21592 1.00000 So here it seems like I have oposite results from my two analysis. Also, because I'm doing an univariate analysis with adonis, homogeneity should be met, but as previously demonstrated, it is not the case. I also tried putting a transformation in my gls (I tried sqrt, transformTukey and rank) but none of them gives normality. What should I do? EDIT Here's the results for the betadisper: > betadisper(d=vegdist(my_data $K),group=my_data$ Genotype) Homogeneity of multivariate dispersions Call: betadisper(d = vegdist(my_data $K), group = my_data$ Genotype) No. of Positive Eigenvalues: 6 No. of Negative Eigenvalues: 0 Average distance to median: PB08 PB09 PB10 PB13 PB16 PB21 PB23 PB25 PB29 PB33 4.070e-01 3.501e-02 2.236e-02 1.212e-02 2.532e-05 7.915e-02 1.722e-02 3.373e-02 4.573e-02 8.436e-02 Eigenvalues for PCoA axes: PCoA1 PCoA2 PCoA3 PCoA4 PCoA5 PCoA6 9.296e-01 2.774e-01 8.741e-03 1.759e-04 2.239e-06 1.571e-08 I found that to interpret those results (with a p-value) you can either do an anova or a permutest : > modk $K),group=my_data$ Genotype) > permutest(modK, permutations = 999) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(>F) Groups 9 0.38476 0.042751 2.0854 999 0.039 * Residuals 19 0.38951 0.020501 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 > anova(modK) Analysis of Variance Table Response: Distances Df Sum Sq Mean Sq F value Pr(>F) Groups 9 0.38476 0.042751 2.0854 0.085 . Residuals 19 0.38951 0.020501 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 It seems to me like the permutest tells me that I don't have homogeneity of variances and the anova sais the opposite... SECOND EDIT Since I'm not sure about homogeneity I tried transforming my data and it seemed to have solve the problem : > my_data $K)) > bd K_sqrt),group=my_data$Genotype) > permutest(bd, permutations = 999) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(>F) Groups 9 0.23187 0.025764 1.5013 999 0.118 Residuals 19 0.32606 0.017161 > anova(bd) Analysis of Variance Table Response: Distances Df Sum Sq Mean Sq F value Pr(>F) Groups 9 0.23187 0.025764 1.5013 0.2176 Residuals 19 0.32606 0.017161 Is this ok? Still I'd like to know wich one is better : anova or permutest? And what's the difference?
