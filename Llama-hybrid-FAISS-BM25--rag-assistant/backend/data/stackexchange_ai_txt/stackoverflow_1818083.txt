[site]: stackoverflow
[post_id]: 1818083
[parent_id]: 1818078
[tags]: 
That's because you need to put: foreach (string s in fileEntries) { int start = s.LastIndexOf(@"\"); int end = s.LastIndexOf(@"."); availObjectsListBox.Items.Add(s.Substring(start + 1, end - start - 1)); } in a function. Maybe you can do something like: private void Transformer_Load(object sender, EventArgs e) { int selFile = 0; string currentDir = Directory.GetCurrentDirectory(); string[] fileEntries = Directory.GetFiles(currentDir+@"\Objects"); foreach (string s in fileEntries) { int start = s.LastIndexOf(@"\"); int end = s.LastIndexOf(@"."); availObjectsListBox.Items.Add(s.Substring(start + 1, end - start - 1)); } // end foreach } Note that you put the foreach loop inside the Transformer_Load function; of course, you can put it in any other function. And note that there is no modifier ( private ) in front of selFile , currentDir and fileEntries variable.
