[site]: crossvalidated
[post_id]: 643012
[parent_id]: 642947
[tags]: 
As you can see from Gavin's reply, this can be done with your { gratia } outputs. Hwer I briefly show how you can tackle this question with { marginaleffects }. I first compute the average (marginal) contrast for the two levels of treatment on the link scale (aggregated across values of conc ). I then show how you can do this for a sequence of conc values to effectively ask whether one treatment consistently gives larger linear predictor values than another. Hopefully that gets at what your're interested in, but if not there are many other types of comparisons you can make, including specific hypothesis tests. See the {'marginaleffects'} hypothesis vignette for details . library(tidyverse) library(mgcv) library(marginaleffects) library(ggplot2) # Data data(CO2, package = "datasets") plant as_tibble() |> rename(plant = Plant, type = Type, treatment = Treatment) |> mutate(plant = factor(plant, ordered = FALSE), uptake = ifelse(treatment == "chilled" & type == "Quebec", uptake+10, uptake)) # GAM m_plant # Average difference (again on the link scale) between # treatments (aggregating over 'type' and 'conc' values) avg_comparisons(m_plant, variables = "treatment", by = "type", type = 'link') #> #> Term Contrast type Estimate Std. Error #> treatment mean(chilled) - mean(nonchilled) Quebec 0.186 0.0939 #> treatment mean(chilled) - mean(nonchilled) Mississippi -0.477 0.0939 #> z Pr(>|z|) S 2.5 % 97.5 % #> 1.98 0.0479 4.4 0.00168 0.370 #> -5.07 #> Columns: term, contrast, type, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted_lo, predicted_hi, predicted #> Type: link # Our estimand of interest: average differencea (again on the link scale) between # treatments, aggregated over 'type' values for a sequence # of 'conc' values avg_comparisons(m_plant, variables = "treatment", by = c("conc", "type"), type = 'link') #> #> Term Contrast conc type Estimate #> treatment mean(chilled) - mean(nonchilled) 95 Quebec 0.448 #> treatment mean(chilled) - mean(nonchilled) 95 Mississippi -0.215 #> treatment mean(chilled) - mean(nonchilled) 175 Quebec 0.241 #> treatment mean(chilled) - mean(nonchilled) 175 Mississippi -0.422 #> treatment mean(chilled) - mean(nonchilled) 250 Quebec 0.131 #> treatment mean(chilled) - mean(nonchilled) 250 Mississippi -0.532 #> treatment mean(chilled) - mean(nonchilled) 350 Quebec 0.102 #> treatment mean(chilled) - mean(nonchilled) 350 Mississippi -0.560 #> treatment mean(chilled) - mean(nonchilled) 500 Quebec 0.101 #> treatment mean(chilled) - mean(nonchilled) 500 Mississippi -0.562 #> treatment mean(chilled) - mean(nonchilled) 675 Quebec 0.134 #> treatment mean(chilled) - mean(nonchilled) 675 Mississippi -0.529 #> treatment mean(chilled) - mean(nonchilled) 1000 Quebec 0.145 #> treatment mean(chilled) - mean(nonchilled) 1000 Mississippi -0.517 #> Std. Error z Pr(>|z|) S 2.5 % 97.5 % #> 0.1004 4.46 0.1004 -2.14 0.0324 4.9 -0.4115 -0.018 #> 0.0974 2.47 0.0134 6.2 0.0500 0.432 #> 0.0974 -4.33 0.0971 1.35 0.1785 2.5 -0.0597 0.321 #> 0.0971 -5.47 0.0996 1.02 0.3062 1.7 -0.0933 0.297 #> 0.0996 -5.62 0.1005 1.00 0.3169 1.7 -0.0964 0.297 #> 0.1005 -5.59 0.1007 1.33 0.1847 2.4 -0.0638 0.331 #> 0.1007 -5.25 0.1008 1.44 0.1492 2.7 -0.0522 0.343 #> 0.1008 -5.13 #> Columns: term, contrast, conc, type, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted_lo, predicted_hi, predicted #> Type: link # Plot these differences and add some labels plot_comparisons(m_plant, variables = "treatment", by = c("conc", "type"), type = 'link') + geom_hline(yintercept = 0, linetype = 'dashed') + labs(y = "Estimated difference", title = "Difference between treatment levels", subtitle = "Chilled - nonchilled, per type") + theme_bw() Created on 2024-03-22 with reprex v2.1.0
