[site]: crossvalidated
[post_id]: 622791
[parent_id]: 
[tags]: 
Calculation of an optimal variational distribution for covariance parameters in a Bayesian graphical lasso model

Context : I am considering here a variational Bayesian framework where I need to calculate the optimal variational distribution for some covariance parameters. Formally the model can be expressed as: $$P(W|X,\beta, \Sigma^{-1})P(\Sigma^{-1}|\lambda)$$ where $W$ is a matrix of outcomes of size $NJ$ where $N$ is the sample size and $J$ the number of outcomes. $X$ a matrix of $(K+1)$ covariates for the same $N$ individuals. $\beta$ is a $(K+1)J$ matrix of covariate effects. Finally we want to estimate the posterior for $\Sigma$ the precision matrix accross the $J$ outcomes. Since we are in a Bayesian graphical lasso model, we assume $P(W|X,\beta, \Sigma^{-1}) \sim N(X\beta, \Sigma^{-1})$ and the covariance parameters (off diagonal elements of $\Sigma^{-1}$ ) $s_{jj'} \sim Laplace(0, \lambda^{-1}), \forall j'\neq j$ . Using standard results from variational inference we can determine the optimal variational distribution for covariance parameters with: $$ q^*(s_{jj'}) = E_{-s_{jj'}}(\log(P(W|X,\beta, \Sigma^{-1})P(\Sigma^{-1}|\lambda))) $$ where $E_{-s_{jj'}}$ is the expectation taking over all parameters except $s{jj'}$ . What I did : Following https://www.math.wustl.edu/~sawyer/handouts/multivar.pdf the model for $P(W|X,\beta, \Sigma^{-1})$ was rewritten as a sum over individuals (i), covariates (k) and outcomes (j & j'). Also, using the correspondence between a centered Laplace distribution and the exponential we obtain: $$\prod_j \prod_{j'} \lambda \exp\{ -\lambda s_{jj'}\} \prod_i \prod_j \prod_{j'} \prod_k \frac{s_{jj'}}{\sqrt(2\pi)} \exp\{-\frac{1}{2}s_{jj'}(W_{ij} - X_{ik}\beta_{kj})(W_{ij'} - X_{ik}\beta_{kj'})\} $$ Applying the log while keeping only terms involving $s_{jj'}$ and taking the expectation the optimal $q^*(s_{jj'})$ is equal to: $$ -s_{jj'}(E(\lambda) + \frac{1}{2} \sum_i \sum_k (W_{ij} - X_{ik}E(\beta_{kj}))(W_{ij'} - X_{ik}E(\beta_{kj'}))) $$ which is proportional to a centered Laplace with scale parameter $\delta = \frac{1}{E(\lambda) + 0.5*\sum_i\sum_k(W_{ij} - X_{ik}E(\beta_{kj}))(W_{ij'} - X_{ik}E(\beta_{kj'}))}$ IMPORTANT : This result is expected since the prior over covariance parameters is from the exponential family. Indeed, assuming a "mean-field" factorization we know that the optimal q is from the same distribution as the prior. My Problem : However my problem here is that, due to the cross product between $j\&j'$ , $\delta$ may be negative. Leading to errors when computing the ELBO. Are my calculations correct or I did something wrong? Any insights are welcome.
