[site]: stackoverflow
[post_id]: 5613776
[parent_id]: 5613728
[tags]: 
SQL Server requires that you define a table alias for a derived table/inline view: SELECT x.period, x.pcc, SUM(x.BasicHits), SUM(x.FareHits), SUM(x.SearchHits) FROM (SELECT AAAPeriod AS Period, AAAFromPCC AS PCC, - SUM(AAABasic) AS BasicHits, - SUM(AAAFare) AS FareHits, - SUM(AAASearch) AS SearchHits FROM HitsAaa WHERE AAAPeriod = N'2010-10' GROUP BY aaaperiod, aaafrompcc UNION ALL SELECT AAAPeriod, AAAtoPCC, SUM(AAABasic), SUM(AAAFare), SUM(AAASearch) FROM HitsAaa WHERE AAAPeriod = N'2010-10' GROUP BY aaaperiod, aaafrompcc UNION ALL SELECT AgtPeriod, AgtPcc, SUM(AgtBasic), SUM(AgtFare), SUM(AgtSearch) FROM HitsAgent WHERE AgtPeriod = N'2010-10' GROUP BY agtperiod, agtpcc) AS x GROUP BY x.period, x.pcc
