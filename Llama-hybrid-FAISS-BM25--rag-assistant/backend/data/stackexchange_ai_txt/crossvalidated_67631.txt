[site]: crossvalidated
[post_id]: 67631
[parent_id]: 66334
[tags]: 
nsprcomp computes the scores matrix Z ( rst$x in your example) as $Z=XW$, where $X$ is the data matrix ( prod in your example) and $W$ is the matrix of principal axes ( rst$rotation in your example). This is in accordance with standard PCA and the predict.prcomp interface. However, non-negative sparse PCA usually results in principal axes which are not pairwise orthogonal, and therefore a reconstruction $\hat{X} = ZW^t = XWW^t$ doesn't recover $X$ even if $W$ has full rank, because $W$ is not an orthogonal matrix. If you reconstruct using the pseudo-inverse $W^\dagger=(W^tW)^{-1}W^t$ instead, $\hat{X}_2 = ZW^\dagger = XW(W^tW)^{-1}W^t$ corresponds to an orthogonal projection of $X$ onto the principal subspace spanned by $W$, and recovers $X$ if $W$ has full rank: library(MASS) recon2 = predict(rst) %*% ginv(rst$rotation) + matrix(1,5,1) %*% rst$center abs(prod - recon2) [,1] [,2] [,3] [,4] [,5] [1,] 4.440892e-16 4.440892e-16 2.220446e-16 8.881784e-16 2.220446e-16 [2,] 4.440892e-16 1.332268e-15 0.000000e+00 1.998401e-15 4.440892e-16 [3,] 1.110223e-16 4.440892e-16 2.220446e-16 4.440892e-16 2.220446e-16 [4,] 3.330669e-16 4.440892e-16 2.220446e-16 2.220446e-16 0.000000e+00 [5,] 1.110223e-16 4.440892e-16 2.220446e-16 4.440892e-16 2.220446e-16 I will amend the documentation accordingly. @Marc: nneg=TRUE enforces non-negative loadings, i.e. the principal axes are constrained to the non-negative orthant.
