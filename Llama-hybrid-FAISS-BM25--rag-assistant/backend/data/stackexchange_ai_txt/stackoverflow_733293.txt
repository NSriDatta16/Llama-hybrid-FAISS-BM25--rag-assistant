[site]: stackoverflow
[post_id]: 733293
[parent_id]: 716421
[tags]: 
You might want to have a peek at HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR . It tells you which USB storage devices are known. The entries all contain a ParentIdPrefix. If the drive is currently present, that can be found in the data part of a HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices value.
