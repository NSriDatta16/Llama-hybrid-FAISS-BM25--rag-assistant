[site]: stackoverflow
[post_id]: 3067154
[parent_id]: 3067038
[tags]: 
Most complex ISQL forms and reports are fairly tightly tied to a specific operational database and are not of much interest outside the particular niche where they are used. Another problem is that complex reports and forms are fairly bit. This is one of the largest, and one of the latest I've written. The system is not in use any more. It was for tracking Feature Requests etc for Informix. It will fit within the limit of what SO accepts, but not with all that much to spare (443 lines, about 20KB with no tabs). It generates a reasonably complex report with HTML formatting. (The schema produced by DB-Schema is too big for a single answer at over 40 KB, but mainly because it included a number of moderately complex stored procedures invoked by triggers.) -- @(#)$Id: frdbhtml95.ace,v 4.14 2003/02/12 19:55:00 jleffler Exp $ -- @(#)Project: Servers 9.Next Feature Prioritization -- @(#)Feature Prioritization Report - HTML Output -- @(#)Author: JL DATABASE frdb@smartpts END DEFINE PARAM[1] list_num INTEGER VARIABLE asd_url CHAR(70) VARIABLE pts_url CHAR(70) VARIABLE version CHAR(45) VARIABLE c CHAR(1) -- HTML metacharacter mapping VARIABLE i INTEGER -- HTML metacharacter mapping VARIABLE j INTEGER -- HTML metacharacter mapping VARIABLE map VARCHAR(5) -- HTML metacharacter mapping VARIABLE pad INTEGER -- HTML metacharacter mapping VARIABLE sd CHAR(350) -- Copy of short description VARIABLE theme_count INTEGER VARIABLE disp_count INTEGER VARIABLE gr_disp_count INTEGER -- Count of groups of dispositions VARIABLE gr_fgrp_count INTEGER -- Count of feature groups within theme VARIABLE ov_fgrp_count INTEGER -- Count of feature groups overall VARIABLE ov_fnum_count INTEGER -- Count of feature numbers overall END OUTPUT PAGE LENGTH 90 TOP MARGIN 0 BOTTOM MARGIN 0 LEFT MARGIN 0 RIGHT MARGIN 80 END -- Create temp table x8 with fr_grp numbers, and fr_num as members of group. -- Group leaders are tagged 'A'; group members are tagged 'B'. SELECT f9.fr_num as fr_grp, f9.fr_num as fr_num, 'A' AS fr_type FROM fr_list_items f9 WHERE f9.fr_num NOT IN (SELECT member FROM fr_bug_group WHERE fr_list_num = $list_num) AND f9.abc_category != 'X' AND f9.fr_status != 'D' AND f9.fr_list_num = $list_num UNION SELECT f9.fr_num as fr_grp, grp.member as fr_num, 'B' AS fr_type FROM fr_list_items f9, fr_bug_group grp WHERE f9.fr_num = grp.master AND f9.abc_category != 'X' AND f9.fr_list_num = $list_num AND grp.fr_list_num = $list_num INTO TEMP x8; -- Create temp table with fr_grp number and number of rows in the group. SELECT fr_grp, COUNT(*) AS grp_size FROM x8 GROUP BY fr_grp INTO TEMP x9; SELECT f8.theme AS theme, -- defined by group master f8.disposition AS disposition, -- defined by group master f8.abc_category AS category, -- defined by group master f8.priority AS fe_priority, -- defined by group master x8.fr_grp, -- sequencing x8.fr_type, -- sequencing x8.fr_num, -- PTS FR number th.priority AS th_priority, -- sequencing bug.short_description, -- FR Description th.description AS theme_name, -- sequencing di.description AS disp_name, -- sequencing di.priority AS di_priority, -- sequencing l.title, -- list title o.owner_name AS owner, -- list owner l.updated, -- last time list modified p.project_id, -- project number p.codename, -- project code name p.description, -- project description p.projname, -- project name f8.risk, -- defined by group master f8.effort, -- defined by group master f8.benefit, -- defined by group master f8.impacts_csdk, -- defined by group master f8.req_user AS req_who, -- who it was requested by f8.req_why, -- why it was requested x9.grp_size -- for ROWSPAN information. FROM x8, x9, fr_list_items f8, themes th, dispositions di, pts_bug bug, fr_lists l, projects p, owners o WHERE f8.theme = th.theme AND f8.disposition = di.code AND x8.fr_grp = f8.fr_num AND x8.fr_grp = x9.fr_grp AND x8.fr_num = bug.bug_num AND f8.fr_list_num = $list_num AND f8.fr_list_num = l.fr_list_num AND l.owner_id = o.owner_id AND l.project_id = p.project_id AND th.project_id = p.project_id AND di.project_id = p.project_id ORDER BY th_priority DESC, theme_name, di_priority DESC, disposition, category, fe_priority DESC, fr_grp, fr_type, fr_num END FORMAT FIRST PAGE HEADER LET pts_url = "http://lxptsws1.lenexa.ibm.com/Reporter/buginfo.cgi?bug=" LET asd_url = "http://rose.oak.informix.com/projects/falcon/FalconDocs3.html" PRINT " " PRINT " " PRINT " Feature List: Themes and Prioritization " PRINT " " PRINT " " PRINT " &nbsp; " PRINT " Feature List: Themes and Prioritization " PRINT " ", CURRENT YEAR TO SECOND, " " PRINT " " PRINT " " PRINT " ", " Project Number ", project_id, " " PRINT " ", codename CLIPPED, " ", projname CLIPPED, " " PRINT " ", description, " " PRINT " " PRINT " " PRINT " " PRINT " ", " Feature List Number ", list_num, " " PRINT " ", title, " " PRINT " ", " Owner ", owner, " ", " Last Modified ", updated, " " PRINT " " PRINT " " PRINT " " PRINT " Categories: A (must fix), B (might fix), C (won't fix) " PRINT " Priorities: -1 unassigned, 0 (won't happen) to 9 (very important)" PRINT " " PRINT " Risk: H(igh), M(edium), L(ow) " PRINT " Cost: H(igh), M(edium), L(ow) " PRINT " Benefit: H(igh), M(edium), L(ow) " PRINT " "; PRINT "[CSDK] Items tagged with [CSDK] on a green background impact CSDK."; PRINT " " PRINT " "; PRINT "Items with a white background should not impact CSDK." PRINT " " PRINT " " PRINT " " PRINT "Themes:" -- FOREACH SELECT theme, description, priority, COUNT(*) -- INTO x_theme, x_desc, x_priority -- FROM themes -- GROUP BY theme, description, priority -- HAVING COUNT(*) > 0 -- ORDER BY priority DESC, description -- PRINT "[ ", x_desc CLIPPED, " ]" -- END FOREACH LET theme_count = COUNT WHERE theme = "*no theme*" IF theme_count > 0 THEN PRINT "[ No specific theme designated ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "api" IF theme_count > 0 THEN PRINT "[ Application Development & Standards Compliance ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "bug" IF theme_count > 0 THEN PRINT "[ Defect Reduction ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "cms" IF theme_count > 0 THEN PRINT "[ Content Management Support ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "harp" IF theme_count > 0 THEN PRINT "[ High Availability, Replication, Performance ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "hk" IF theme_count > 0 THEN PRINT "[ Housekeeping ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "istar" IF theme_count > 0 THEN PRINT "[ Distributed Database ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "isv" IF theme_count > 0 THEN PRINT "[ Partner Interoperability/Compatibility ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "os" IF theme_count > 0 THEN PRINT "[ Platforms and Operating Systems ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "ras" IF theme_count > 0 THEN PRINT "[ RAS Improvements ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "security" IF theme_count > 0 THEN PRINT "[ Security, Authentication, Encryption ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "smart" IF theme_count > 0 THEN PRINT "[ SMART Initiative / Ease of Use ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "smv" IF theme_count > 0 THEN PRINT "[ Storage Management Vendors ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "swg" IF theme_count > 0 THEN PRINT "[ SWG Initiatives ]" ELSE PRINT "" LET theme_count = COUNT WHERE theme = "xb" IF theme_count > 0 THEN PRINT "[ IBM Cross-Brand Integration/Interoperability ]" ELSE PRINT "" LET ov_fgrp_count = 0 LET ov_fnum_count = 0 BEFORE GROUP OF theme_name PRINT " " PRINT " &nbsp; " PRINT " " PRINT " Theme: ", " ", theme_name CLIPPED, " ", " " PRINT " ", " ", "PTS No", " ", " ", "Category, Priority, ", "Risk, Cost, Benefit", " ", " ", "Description", " ", " " LET gr_disp_count = 0 LET gr_fgrp_count = 0 BEFORE GROUP OF disposition SKIP 1 LINE PRINT " ", disp_name, " " PRINT " " LET gr_disp_count = gr_disp_count + 1 BEFORE GROUP OF fr_grp LET gr_fgrp_count = gr_fgrp_count + 1 LET ov_fgrp_count = ov_fgrp_count + 1 IF impacts_csdk = 'Y' THEN PRINT " " ELSE PRINT " " PRINT " "; PRINT " ", fr_grp USING "&&&&&&", " ", " " IF (disposition = 'pre-fixed' OR disposition = 'rejected' OR disposition = 'nfp' OR disposition = 'sep') THEN PRINT " &nbsp; " ELSE BEGIN PRINT " ", category, " " PRINT " ", fe_priority USING "-&", " " PRINT " ", risk, " " PRINT " ", effort, " " PRINT " ", benefit, " " END PRINT " " IF impacts_csdk = 'Y' THEN PRINT "[CSDK] "; # Map HTML characters out of the way LET i = 150 # length(short_description) - except that isn't in ACE! LET sd = "" LET pad = 0 FOR j = 1 TO i DO BEGIN LET c = short_description[j] IF c = " " THEN LET map = "&gt;" ELSE IF c = "&" THEN LET map = "&amp;" ELSE LET map = c IF pad != 0 THEN LET sd = sd CLIPPED, " ", map ELSE LET sd = sd CLIPPED, map IF c = " " OR c IS NULL THEN LET pad = 1 ELSE LET pad = 0 END PRINT sd CLIPPED WORDWRAP PRINT " " IF req_who != "no-one" OR req_why != "no reason" THEN BEGIN PRINT " ", "Requested by ", req_who, " because: " PRINT req_why CLIPPED WORDWRAP PRINT " " END IF grp_size > 1 THEN BEGIN PRINT " " PRINT "Related feature requests include: " END ON EVERY ROW IF fr_type = 'B' THEN PRINT " ", fr_num USING "&&&&&&", " " AFTER GROUP OF fr_grp PRINT " " SKIP 1 LINE AFTER GROUP OF disposition SKIP 1 LINE AFTER GROUP OF theme_name PRINT " " PRINT " " PRINT " Top " PRINT GROUP COUNT USING " ", theme_name CLIPPED, " " PRINT " " ON LAST ROW PRINT " " PRINT " " PRINT COUNT USING " " PRINT " " PRINT " " PRINT "NB: These statistics are not guaranteed accurate." PRINT "But they are much more reliable than those in previous" PRINT "versions of this report." PRINT " " PRINT " " PRINT " " PRINT " " PRINT " Summary by Categories " PRINT " Category A (must fix) ", (COUNT WHERE category = 'A') USING "###&", " " PRINT " Category B (may fix) ", (COUNT WHERE category = 'B') USING "###&", " " PRINT " Category C (won't fix) ", (COUNT WHERE category = 'C') USING "###&", " " PRINT " " SKIP 1 LINE PRINT " " PRINT " " PRINT " Summary by Priorities " PRINT " Priority -1 (no decision) ", (COUNT WHERE fe_priority = -1) USING "###&", " " PRINT " Priority 0 (rejected) ", (COUNT WHERE fe_priority = 0) USING "###&", " " PRINT " Priority 1 (low) ", (COUNT WHERE fe_priority = 1) USING "###&", " " PRINT " Priority 2 ", (COUNT WHERE fe_priority = 2) USING "###&", " " PRINT " Priority 3 ", (COUNT WHERE fe_priority = 3) USING "###&", " " PRINT " Priority 4 ", (COUNT WHERE fe_priority = 4) USING "###&", " " PRINT " Priority 5 (medium) ", (COUNT WHERE fe_priority = 5) USING "###&", " " PRINT " Priority 6 ", (COUNT WHERE fe_priority = 6) USING "###&", " " PRINT " Priority 7 ", (COUNT WHERE fe_priority = 7) USING "###&", " " PRINT " Priority 8 ", (COUNT WHERE fe_priority = 8) USING "###&", " " PRINT " Priority 9 (high) ", (COUNT WHERE fe_priority = 9) USING "###&" PRINT " " PRINT " " PRINT " " PRINT " Summary by Dispositions " LET disp_count = (COUNT WHERE disposition = "8.33") IF disp_count > 0 THEN PRINT " Scheduled for XPS 8.33 release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "8.40") IF disp_count > 0 THEN PRINT " Scheduled for XPS 8.40 Release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "8.40-fp") IF disp_count > 0 THEN PRINT " Scheduled for XPS 8.40 Fix Pack ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "8.50") IF disp_count > 0 THEN PRINT " Scheduled for XPS 8.50 Release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.30-fp") IF disp_count > 0 THEN PRINT " Scheduled for IDS 9.30 Fix Pack ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.31") IF disp_count > 0 THEN PRINT " Scheduled for IDS 9.31 release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.40") IF disp_count > 0 THEN PRINT " Scheduled for IDS 9.40 release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.40-fp") IF disp_count > 0 THEN PRINT " Scheduled for IDS 9.40 Fix Pack ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.50") IF disp_count > 0 THEN PRINT " Scheduled for IDS 9.50 release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.50-fp") IF disp_count > 0 THEN PRINT " Scheduled for IDS 9.50 Fix Pack ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.60") IF disp_count > 0 THEN PRINT " Possibility for IDS 9.60 Release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "9.70") IF disp_count > 0 THEN PRINT " Possibility for IDS 9.70 Release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "deferred") IF disp_count > 0 THEN PRINT " Deferred until after 9.60 ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "dup") IF disp_count > 0 THEN PRINT " Duplicate of another feature request ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "nfi") IF disp_count > 0 THEN PRINT " No fix planned in the foreseeable future ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "nfp") IF disp_count > 0 THEN PRINT " No fix possible - not enough information ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "pre-fixed") IF disp_count > 0 THEN PRINT " Fixed in a previous release ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "rejected") IF disp_count > 0 THEN PRINT " Feature request is rejected completely ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "sep") IF disp_count > 0 THEN PRINT " Someone else's problem (not IDS 9.x R&D) ", disp_count USING "###&", " " LET disp_count = (COUNT WHERE disposition = "techsupp") IF disp_count > 0 THEN PRINT " Tool to be provided by Technical Support ", disp_count USING "###&", " " PRINT " " PRINT " " LET version = "$Id: frdbhtml95.ace,v 4.14 2003/02/12 19:55:00 jleffler Exp $" LET version = version[6,45] PRINT " Report produced by ISQL ACE and ", version CLIPPED, " " PRINT " End of Report " PRINT " " PRINT " " END
