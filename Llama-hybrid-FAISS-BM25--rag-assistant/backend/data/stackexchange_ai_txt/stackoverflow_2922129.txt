[site]: stackoverflow
[post_id]: 2922129
[parent_id]: 2921846
[tags]: 
Something a bit like this is better SELECT product_master.product_id, ( SELECT COUNT(listing_id) FROM ebay_archive_product_listing_assoc '.$listingCountJoin.' WHERE ebay_archive_product_listing_assoc.product_id = product_master.product_id) as listing_count, sku, type_id, average_bid_price, average_buyout_price, lowest_bid_price, highest_bid_price, lowest_buyout_price, highest_buyout_price, round((( SELECT COUNT(ebay_archive_listing.id) FROM ebay_archive_listing INNER JOIN ebay_archive_product_listing_assoc ON ( ebay_archive_product_listing_assoc.listing_id = ebay_archive_listing.id AND ebay_archive_product_listing_assoc.product_id = product_master.product_id ) WHERE '.$whereSql.' AND ebay_archive_listing.status_id = 2 ) / ( SELECT COUNT(listing_id) FROM ebay_archive_product_listing_assoc '.$listingCountJoin.' WHERE ebay_archive_product_listing_assoc.product_id = product_master.product_id ) * 100), 1) as sold_percent FROM product_master LEFT OUTER JOIN ( SELECT ebay_archive_product_listing_assoc.product_id , AVG(ebay_archive_listing.current_price) average_bid_price, AVG(ebay_archive_listing.buy_it_now_price) average_buyout_price, MIN(ebay_archive_listing.current_price) lowest_bid_price, MAX(ebay_archive_listing.current_price) highest_bid_price, MIN(ebay_archive_listing.buy_it_now_price) lowest_buyout_price, MAX(ebay_archive_listing.buy_it_now_price) highest_buyout_price FROM ebay_archive_listing INNER JOIN ebay_archive_product_listing_assoc ON ( ebay_archive_product_listing_assoc.listing_id = ebay_archive_listing.id ) WHERE '.$whereSql.' AND ebay_archive_listing.current_price > 0 GROUP BY ebay_archive_product_listing_assoc.product_id ) eal ON eal.product_id = product_master.product_id '.$joinSql.' WHERE product_master.product_id IN ( SELECT product_id FROM ebay_archive_product_listing_assoc INNER JOIN ebay_archive_listing ON ( ebay_archive_listing.id = ebay_archive_product_listing_assoc.listing_id AND '.$whereSql.' ) ) But a lot more can be done, what are the values of whereSql and joinSql ?
