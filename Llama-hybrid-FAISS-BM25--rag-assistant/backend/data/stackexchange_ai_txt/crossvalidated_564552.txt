[site]: crossvalidated
[post_id]: 564552
[parent_id]: 
[tags]: 
Tried rectifying Heteroscedasticity and I don't know why I did not succeed

I am doing a regression on the influence on interest rates on marketing spending. I tried many different approaches to get my regression working. I have panel data and time series. I got a data set of information about one year for companies (data example below). Because I could not get the regression working I thought that maybe a website would help checking every assumption possible. I therefore found the following website http://r-statistics.co/Assumptions-of-Linear-Regression.html I found it by searching here on stack overflow for information to get Heteroscedasticity rectified. The code I used: #Setting up regression #[2] lm.03.1.2 Then I checked for variance in the variable and transformed them if necessary. Result: lm.03.2.2 =>s_sale_py_at_py = sale_py_at_py^2 Afterwards I checked for autocorrelation with lmtest::dwtest Results: #=> DW = 1.7803, p-value = 0.09555 #=> alternative hypothesis: true autocorrelation is greater than 0 #=> p-value high therefore can not reject h0 #=> assumption is satisfied Then I checked for correlation with stats::cor.test of residuals and found none Next I checked with Vif() (car package)for multicollinearity and excluded because of it new_txt . Therefore the regression looks like this: lm.03.3.2 Afterwards I filtered outliners out with the following function and deleted all values that had at least 2 *: unnecessary_data1.1_2 Then I checked for Heteroscedasticity with Breusch Pagan (lmtest package) and white_lm(skedastic package): Breusch_Pagan_Result01_2 # 79.2 0.000000497 27 White's Test greater #Test also indicates heteroskedasticity because p Both indicated Heteroscedasticity and therefore I tried rectifying it: library(car) boxCox1_2 $x[which(bc1_2$ y==max(bc1_2$y))] #Regression looks now like this: lm.03.4.2 I checked afterwards for it again: Breusch_Pagan_Result02_2 # 71.0 0.00000804 27 White's Test greater #Test also indicates heteroskedasticity because p Because it still shows me Heteroscedasticity it tried a different approach: install.packages("AER") library(AER) # OLS standard error OLS.se_2 And still in the end it seems like that I did not fix Heteroscedasticity and I don't know why and what I could do next/different? Data set: structure(list(marketingspending = c(862060, 1205400, 785300, 1047880, 3010800, 3276250, 1879560, 1648210, 921920, 884890, 2932350, 2365650, 1037490, 1733000, 1290040, 517850, 772450, 794720, 649890, 1495120, 1526640, 691120, 1089460, 1472020, 1788780, 877720, 644380, 1571520, 1474009.264, 1063930, 1645000, 1260450, 1491439.404, 1313659.338, 1774000, 555960, 1146610, 891160, 1367510, 1560549.131, 904740, 1065049.444, 1397729.627, 748730, 892310, 1032490, 1162049.631, 744250, 920580, 891610, 998740, 1285669.109, 741650, 1018570, 1333829.847, 1823000, 803740, 1219849.388, 951720, 853290, 427010, 1364020, 1162170, 1850000, 1794000, 462570, 944200, 1786000, 1626000, 16050000, 16010000, 15780000, 16270000, 15610000, 16220000, 11700000, 13550000, 1729810, 1746270, 1662500, 693660, 1236330, 785320, 2513440, 1079800, 1516950, 1459260, 1833720, 1733860, 1044870, 1235190, 1697230, 1021920, 997280, 1033450, 1110270, 1198200, 626810, 871520, 424219.986, 344789.978, 461229.742, 477139.6, 474009.5, 498229.8, 502239.8, 538919.77, 1573700), intr = c(0.0493689738565328, 0.0208894586683532, 0.0308175020800798, 0.0510369696131376, 0.00311577207122915, 0.030149149762732, 0.0108321331508963, 0.0127055304495851, 0.0493689738565328, 0.0162438498826709, 0.052708106869066, 0.0258174249159815, 0.0208894586683532, 0.0510369696131376, 0.0620765356568187, 0.0309833866356222, 0.0162369410103302, 0.0112492274409901, 0.0360243492488446, 0.0507746610704847, 0.0193678180545793, 0.0308175020800798, 0.0308175020800798, 0.0493689738565328, 0.00124999999999931, 0.0129105930520432, 0.0170823919380676, 0.00124999999999931, 0.0493689738565328, 0.0493689738565328, 0.00124999999999931, 0.00124999999999931, 0.0208894586683532, 0.0308175020800798, 0.00124999999999931, 0.0112492274409901, 0.00124999999999931, 0.0112492274409901, 0.0208894586683532, 0.0510369696131376, 0.00124999999999931, 0.040764079248051, 0.00124999999999931, 0.0129105930520432, 0.00124999999999931, 0.0510369696131376, 0.0170823919380676, 0.040764079248051, 0.00124999999999931, 0.00124999999999931, 0.0308175020800798, 0.0129105930520432, 0.00124999999999931, 0.0208894586683532, 0.00124999999999931, 0.00124999999999931, 0.0170823919380676, 0.0112492274409901, 0.0493689738565328, 0.0308175020800798, 0.040764079248051, 0.00124999999999931, 0.0510369696131376, 0.0216626658595116, 0.00374999999999859, 0.0170823919380676, 0.0129105930520432, 0.0162438498826709, 0.00124999999999931, 0.00124999999999931, 0.00124999999999931, 0.00374999999999859, 0.0216626658595116, 0.00124999999999931, 0.0162438498826709, 0.040764079248051, 0.00124999999999931, 0.00374999999999859, 0.00937287007419663, 0.00124999999999931, 0.040764079248051, 0.0510369696131376, 0.0170823919380676, 0.0216626658595116, 0.0493689738565328, 0.00124999999999931, 0.00124999999999931, 0.0162438498826709, 0.00124999999999931, 0.0162438498826709, 0.00124999999999931, 0.00124999999999931, 0.0308175020800798, 0.0129105930520432, 0.00374999999999859, 0.00124999999999931, 0.0208894586683532, 0.00124999999999931, 0.0112492274409901, 0.00124999999999931, 0.00124999999999931, 0.00124999999999931, 0.0162438498826709, 0.00937287007419663, 0.00374999999999859, 0.0216626658595116, 0.00124999999999931, 0.040764079248051 ), sale_py_at_py = c(0.671212771628248, 0.577842299322336, 0.64891239917142, 0.633120219686926, 1.01960838105431, 1.01849269979802, 0.769170880957603, 0.763928479304937, 0.730575772167572, 1.47834085566706, 1.13090064749185, 0.780918817032228, 0.758360246261007, 1.08419022046011, 0.602518487926767, 0.481910762632577, 0.43088790452705, 0.714640119298982, 0.492980842880065, 0.871252660016928, 1.12499099662682, 0.693898480907212, 0.842906904892538, 1.0186038296335, 0.945263622714828, 0.79459233032464, 0.933769444971673, 1.06688207755543, 0.823667374068966, 0.861225820567792, 1.08236327696025, 1.18664481989847, 0.822392461449323, 0.746911520757671, 0.836256013114894, 1.34731864327317, 0.7701123005444, 0.836425422585531, 1.14136098358343, 0.880299438921075, 0.846272588043703, 0.824093005524484, 0.699119407011108, 1.40648512039323, 0.830274218144319, 0.887843174724505, 0.772303086425303, 0.838822402704568, 0.898082169688336, 0.896904172264165, 0.799779548394582, 0.734499867601851, 1.30251426940219, 0.954670637518348, 0.525611068869253, 0.53460191526947, 0.807278753494297, 0.749353340447105, 1.45422476928546, 1.36458884443678, 0.812729867852714, 0.95774929861357, 1.19625839162481, 0.585533348450002, 0.603221476510067, 1.40216981612591, 0.801296957991309, 0.564132776730407, 1.11147016635616, 3.00597033298455, 3.16739628097514, 1.75370522848909, 2.0526131634194, 4.21496841082132, 1.64241967225175, 1.76328129309869, 3.4549331225428, 1.07591686809732, 1.07895200772223, 1.31975610937809, 1.42202688123469, 1.28840008730154, 1.4040363935288, 1.22243593808346, 1.27722706667269, 1.3515383139375, 1.21056226776139, 1.13564945729693, 1.15075894856099, 2.14623268191202, 1.13305610696889, 1.24865187812636, 1.23331373713807, 1.183906565929, 1.13380297804874, 1.50903515212524, 1.36724312051903, 2.02217437960195, 1.28366018573072, 1.70097244899855, 0.585578517650814, 2.04733109579978, 1.16303466949726, 1.10601100198214, 1.15416549882116, 1.17928998165728, 1.01817187882901, 0.231908637103858 ), R_at_py = c(0.0000000196554324077197, 0.0000000161080138979944, 0.000000023834430789699, 0.000000017657449713349, 0.0000000187902534203898, 0.0000000212079541704594, 0.0000000358943084907628, 0.000000040943837338323, 0.000000137579968356607, 0.0000000958666150265167, 0.0000000258913887312391, 0.000000030023953109791, 0.000000077188129083252, 0.000000121171877461304, 0.0000000742785326127325, 0.0000000827958502719844, 0.0000000951380643589978, 0.00000022801793133012, 0.000000103787625608974, 0.0000000560150971889944, 0.0000000503685212859889, 0.000000196468286089259, 0.000000182278517929826, 0.000000160571635020674, 0.0000000883158173628897, 0.000000199471400787912, 0.00000026000296403379, 0.000000125141879606003, 0.0000000410961831508937, 0.0000000864825223146528, 0.000000109817702613661, 0.000000134303902871417, 0.0000000372605312233937, 0.0000000424474882123325, 0.0000000821323530015679, 0.000000450799718700976, 0.0000000779161481996305, 0.000000111126298371889, 0.000000153339896280894, 0.0000000398975271911622, 0.0000000932715751143976, 0.0000000543053557571008, 0.0000000329760705846196, 0.0000003864331064971, 0.0000000825634975218566, 0.0000000838135851763941, 0.0000000449523056037544, 0.000000125026255513658, 0.0000000895973049130682, 0.0000000858402255881128, 0.0000000865874333926169, 0.0000000429167419497848, 0.000000147145163117771, 0.0000000885823545721339, 0.0000000308710291752835, 0.0000000309914153779403, 0.000000117950955992498, 0.000000044276586983569, 0.000000271349066152189, 0.00000029722805119456, 0.000000267288200829663, 0.000000136191539781549, 0.000000195608969844921, 0.0000000323928606135208, 0.0000000335570469798658, 0.000000509346508429685, 0.0000000965717044905843, 0.000000033665499596014, 0.000000117765933141924, 0.00000000205166081943333, 0.00000000200811277561348, 0.00000000205846027171676, 0.0000000018415527973187, 0.00000000231422554442156, 0.00000000183921575840062, 0.00000000551663264743201, 0.00000000208016974185093, 0.000000145876154062724, 0.000000144502823585173, 0.000000186346746572152, 0.000000531459760524232, 0.000000279812637457958, 0.00000055921218187817, 0.000000140911556861336, 0.000000301209355562584, 0.00000019781571883265, 0.000000222504060699108, 0.000000138479988256897, 0.000000150257089880786, 0.0000000994435140951237, 0.000000250959291893262, 0.000000171190079192531, 0.000000307793642830101, 0.000000348011289486231, 0.0000000817247184583449, 0.000000259444425706791, 0.000000250595791494278, 0.000000134979179461568, 0.0000004675999962592, 0.000000206420929430877, 0.000000270531296413026, 0.00000020170074064512, 0.00000031780637328901, 0.000000318160270054437, 0.000000329744612797388, 0.000000287503378164693, 0.000000628349890352944, 0.0000000102698326643735), txt = c(1124300, 2399340, 643390, 1361370, 281960, 2587810, 1596960, 874950, 542090, 42700, 3592080, 2003050, 57400, 851930, 722370, 75130, 526870, 120570, 16080, 1799220, 861990, 188780, 312940, 710190, 456790, 125480, 101880, 207860, 1066400, 245880, 110000, 55100, 718220, 725340, 308000, 99460, 774130, 191160, 151670, 1160730, 289630, 530770, 273750, 46870, 345150, 112660, 464550, 211480, 274860, 307770, 232890, 565430, 452190, 240790, 292170, 228000, 202200, 410470, 104250, 116450, 61550, 186560, 166460, 228000, 353000, 69160, 242990, 344000, 233000, 17640000, 16540000, 5470000, 8010000, 25000000, 15720000, 13910000, 18440000, 232260, 416530, 204890, 44730, 66680, 77820, 20840, 62240, 155750, 142560, 250500, 177850, 58710, 126160, 235390, 33360, 54990, 42680, 70650, 49770, 35720, 74880, 14540, 29820, 49350, 54510, 59230, 28110, 32430, 36720, 3452610), dt = c(5522630, 4907520, 4429960, 5072080, 5022100, 5062200, 4985210, 4937540, 3365480, 3512390, 5018420, 793090, 4068400, 1500000, 2298000, 4528600, 2601900, 1777250, 2356370, 797110, 4893180, 1572700, 1650000, 1500000, 3537480, 1808050, 1473050, 2614080, 7059920, 1154140, 2500000, 2075000, 13553670, 7106820, 14558000, 98500, 12526390, 1013340, 2569960, 11249320, 926210, 8018750, 12496110, 342950, 832000, 1182160, 7448600, 885340, 940010, 854550, 940040, 7146310, 12621460, 1012210, 10307590, 12584000, 903510, 7181410, 1124480, 348380, 132450, 2368050, 1643760, 8816000, 10767000, 181730, 987280, 9111000, 2498000, 88870000, 86840000, 101380000, 130240000, 69740000, 111600000, 83340000, 61550000, 664760, 668040, 177710, 222380, 802420, 194470, 9632190, 869260, 306010, 473370, 366040, 821010, 1824270, 746680, 757310, 681400, 184190, 2116050, 646880, 857270, 2529290, 188440, 370440, 815520, 341800, 290460, 287440, 634540, 1184890, 272150, 129728850), re = c(2248240, 5490020, 1469470, 3472520, 37676050, 37178170, 13574070, 10171850, 2829870, 306960, 32355660, 17635280, 3375780, 3621010, 7187090, 4465820, 3469200, 357740, 1950010, 6864950, 8188990, 1740650, 1038350, 2207450, 5102400, 545520, 132670, 2995590, 11060330, 8462640, 3328000, 3073740, 9427450, 9326870, 10789000, 1339990, 4843700, 7287500, 2577320, 8946240, 8956210, 5847070, 9836140, 1692710, 10749870, 8474610, 6353690, 5717190, 9177990, 9816710, 8227120, 7863290, 3231930, 8319670, 10285000, 11118000, 6437060, 6939490, 2363480, 1927690, 883300, 3121250, 2914120, 16153000, 11980000, 1033270, 8150210, 15354000, 3560000, 116950000, 87780000, 116130000, 212760000, 23990000, 197970000, 16430000, 56590000, 2770070, 3008360, 2239200, 798780, 1101420, 833700, 3348090, 954390, 1735350, 1461120, 3244100, 2534240, 4255880, 1306110, 2451180, 926070, 1106410, 2082560, 1127010, 898520, 3210720, 1019020, 539700, 402260, 2382810, 558190, 413590, 122270, 641820, 19670, 9694260)), row.names = c(NA, -108L), class = c("tbl_df", "tbl", "data.frame"))
