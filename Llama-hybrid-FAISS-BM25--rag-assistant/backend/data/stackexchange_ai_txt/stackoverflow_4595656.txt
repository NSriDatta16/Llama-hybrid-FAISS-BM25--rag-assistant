[site]: stackoverflow
[post_id]: 4595656
[parent_id]: 4595628
[tags]: 
Looking at the first part of the code... private static void device_OnPacketArrival(object sender, CaptureEventArgs packet) { if(packet is TCPPacket) { packet seems to be of type CaptureEventArgs, not TCPPacket. Probably there's some property of the event args which is your actual packet. If that is correct, then the "'SharpPcap.CaptureEventArgs' does not contain a definition for 'Timeval' and no extension method 'Timeval' accepting a first argument of type 'SharpPcap.CaptureEventArgs' could be found" Is probably true for that reason; the CaptureEventArgs and the Packet are not the same thing. EDIT: I would try something like: private static void device_OnPacketArrival(object sender, CaptureEventArgs packet) { if(packet.packet is TCPPacket) { TCPPacket tcpPack = (TCPPacket)(packet.packet); DateTime time = tcpPack.Timeval.Date; int len = tcpPack.PcapHeader.len; string srcIp = tcpPack.SourceAddress; string dstIp = tcpPack.DestinationAddress; int srcPort = tcpPack.SourcePort; int dstPort = tcpPack.DestinationPort; Console.WriteLine("{0}:{1}:{2}, {3} Len={4} {5}:{6} -> {7}:{8}", time.Hour, time.Minute, time.Second, time.Millisecond, len, srcIp, srcPort, dstIp, dstPort); } }
