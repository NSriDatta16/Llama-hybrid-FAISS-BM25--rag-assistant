[site]: stackoverflow
[post_id]: 415884
[parent_id]: 415862
[tags]: 
The question is slightly ambiguous because you're making the assumption or requiring that the hours are going to start at a set point, i.e. a natural query would also indicate that there's a result record of (1,2) for all the visits between the hour of 08:58 and 09:58. You would have to "tell" your query that the start times are for some determinable reason visits 1 and 4, or you'd get the natural result set: visitor_id | count -------------------- 1 | 3 1 | 2 That extra logic is going to be expensive and too complicated for my fragile mind this morning, somebody better than me at postgres can probably solve this. I would normally want to solve this by having a sessionkey column in the table I could cheaply group by for perforamnce reasons, but there's also a logical problem I think. Deriving session info from timings seems dangerous to me because I don't believe that the user will be definitely logged out after an hours activity . Most session systems work by expiring the session after a period of inactivity , i.e. it's very likely that a visit after 9:45 is going to be in the same session because your hourly period is going to be reset at 9:08.
