[site]: stackoverflow
[post_id]: 824165
[parent_id]: 823717
[tags]: 
The error is probably caused by this line: oBook.Sheets("MasterFormat").Copy After:=Sheets(j) The Sheets(j) will refer to whichever workbook the code module resides in, which may not be the intended workbook. The following works for me: Sub GenerateSheets() Dim oBook As Workbook Dim i As Long Dim j As Long Dim SheetName As String Dim ws As Worksheet Const PairingCount = 63 Dim Pairings(1 To PairingCount, 1 To 2) As String On Error Resume Next Set oBook = Workbooks("SSReport.xls") On Error GoTo 0 If oBook Is Nothing Then Set oBook = Application.Workbooks.Open("SSReport.xls") End If With oBook For i = 1 To PairingCount Pairings(i, 1) = .Sheets("SSPairings").Rows(i + 1).Cells(1) Pairings(i, 2) = .Sheets("SSPairings").Rows(i + 1).Cells(2) Next i For i = 1 To PairingCount If i Mod 5 = 0 Then '//Save in case of corruption/error?' .Save End If j = .Worksheets.Count SheetName = "P" & Pairings(i, 1) & Pairings(i, 2) On Error Resume Next Set ws = .Sheets(SheetName) On Error GoTo 0 If ws Is Nothing Then .Sheets("MasterFormat").Copy After:=.Sheets(j) .Sheets("MasterFormat (2)").Name = SheetName End If .Sheets(SheetName).Cells(1, 2) = Pairings(i, 1) .Sheets(SheetName).Cells(1, 5) = Pairings(i, 2) .Sheets(SheetName).Cells(1, 8) = "P" Next i End With End Sub I took the liberty of replacing the the close/reopen with a simple Save as this should achieve the same result?
