[site]: stackoverflow
[post_id]: 693628
[parent_id]: 
[tags]: 
Is this C# extension method impure and if so, bad code?

I'm learning a bit about function programming, and I'm wondering: 1) If my ForEach extension method is pure? The way I'm calling it seems violate the "don't mess with the object getting passed in", right? public static void ForEach (this IEnumerable source, Action action) { foreach ( var item in source ) action(item); } static void Main(string[] args) { List cats = new List () { new Cat{ Purring=true,Name="Marcus",Age=10}, new Cat{ Purring=false, Name="Fuzzbucket",Age=25 }, new Cat{ Purring=false, Name="Beanhead",Age=9 }, new Cat{Purring=true,Name="Doofus",Age=3} }; cats.Where(x=>x.Purring==true).ForEach(x => { Console.WriteLine("{0} is a purring cat... purr!", x.Name); }); // ************************************************* // Does this code make the extension method impure? // ************************************************* cats.Where(x => x.Purring == false).ForEach(x => { x.Purring = true; // purr,baby }); // all the cats now purr cats.Where(x=>x.Purring==true).ForEach(x => { Console.WriteLine("{0} is a purring cat... purr!", x.Name); }); } public class Cat { public bool Purring; public string Name; public int Age; } 2) If it is impure, is it bad code? I personally think it makes cleaner looking code than the old foreach ( var item in items) { blah; } , but I worry that since it might be impure, it could make a mess. 3) Would it be bad code if it returned IEnumerable instead of void ? I'd say as long as it is impure, yes it would be very bad code as it would encourage chaining something that would modify the chain. For example, is this bad code? // possibly bad extension public static IEnumerable ForEach (this IEnumerable source, Action action) { foreach ( var item in source ) action(item); return source; }
