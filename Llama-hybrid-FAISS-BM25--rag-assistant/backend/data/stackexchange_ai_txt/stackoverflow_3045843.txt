[site]: stackoverflow
[post_id]: 3045843
[parent_id]: 
[tags]: 
Display Image from Byte Array in WPF - Memory Issues

I've developed an application to capture and save images to a database, but I'm having an issue with memory usage. On my domain object I have 3 properties: Image - Byte array, contents are a jpg RealImageThumb - The byte array converted to a BitmapImage and shrunk, displayed to the user in a gridview with other thumbnails RealImage - Has no setter, the byte array converted to a bitmap source, this is shown in a tooltip when the user hovers over it. The issue I have is that if a user hovers over each image in turn the memory usage spirals. I realise that as a user hovers over bitmap sources are generated and the memory isn't freed up, I've tried giving RealImage a backing property and assigning this to null after but again the memory isn't freed up (waiting for the garbage collector?). edit: Is this what you meant Ray? I'm not getting anything shown in the tooltip as below, but if I try and define a WeakReference , I get the System.WeakReference does not have type parameters error. private WeakReference _realImage; public virtual BitmapImage RealImage { get { if (_realImage == null || _realImage.Target == null) { if (Image == null) return null; var newBitmapImage = new BitmapImage(); newBitmapImage.BeginInit(); newBitmapImage.CacheOption = BitmapCacheOption.None; newBitmapImage.CreateOptions = BitmapCreateOptions.IgnoreImageCache; newBitmapImage.StreamSource = new MemoryStream(Image); newBitmapImage.EndInit(); _realImage = new WeakReference(newBitmapImage); } return (BitmapImage)_realImage.Target; } }
