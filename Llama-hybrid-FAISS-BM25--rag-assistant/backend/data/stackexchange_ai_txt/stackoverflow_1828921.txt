[site]: stackoverflow
[post_id]: 1828921
[parent_id]: 
[tags]: 
powershell and console app output

Im trying to automate video conversion with powershell and ffmpeg tool. Ffmpeg have detailed output about video if called without all nessesary parameters. Usually it reports about error and display input file info if one specified. Ex I interactively executed such command: d:\video.Enc\ffmpeg.exe -i d:\video.Enc\1.wmv this is powershell console output ffmpeg.exe : FFmpeg version SVN-r20428, Copyright (c) 2000-2009 Fabrice Bellard, et al. row:1 char:24 + d:\video.Enc\ffmpeg.exe 15.00 (15/1) Input #0, asf, from 'd:\video.Enc\1.wmv': Duration: 00:12:0 2.00, start: 5.000000, bitrate: 197 kb/s Stream #0.0(eng): Audio: wmav2, 44100 Hz, 1 channels, s16, 48 k b/s Stream #0.1(eng): Video: wmv3, yuv420p, 1024x768, 137 kb/s, 15 tbr, 1k tbn, 1k tbc Metadata title : Silverlight 2.0 Hello World Application author : Sergey Pugachev copyright : comment : WMFSDKVersion : 11.0.6001.7000 WMFSDKNeeded : 0.0.0.0000 IsVBR : 1 ASFLeakyBucketPairs: VBR Peak : 715351 Buffer Average : 127036 At least one output file must be specified But I cant figure how to script this and capture output to any kind of posh objects. I tried direct script, wher ps1 file contained exact expression "d:\video.Enc\ffmpeg.exe -i d:\video.Enc\1.wmv" - it didnt work. Also i tried to do that with invoke-command and invoke expression. First one returns an exact string with command, second one - dump error to output console but not to -ErrorVariable i specified ( I did set all out variables, not only error one - all of them were empty). Can anyone point to correct syntax for invoking console applications in posh and capturing output ? Second one question will be about parsing that output - I'll need video resolution data to calculate correct aspect ratio for conversion. So it will be cool if anyone point how to work with captured error output and parse string like Stream #0.1(eng): Video: wmv3, yuv420p, 1024x768 ,
