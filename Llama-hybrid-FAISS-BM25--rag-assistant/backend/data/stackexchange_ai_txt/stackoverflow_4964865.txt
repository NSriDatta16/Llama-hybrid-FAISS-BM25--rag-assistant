[site]: stackoverflow
[post_id]: 4964865
[parent_id]: 
[tags]: 
Need help with MySQL query getting results to average for year y and y+1

I have a MySQL query: SELECT px.player, px.pos, px.year, px.age, px.gp, px.goals, px.assists , 1000 - ABS(p1.gp - px.gp) - ABS(p1.goals - px.goals) - ABS(p1.assists - px.assists) sim FROM hockey p1 JOIN hockey px ON px.player <> p1.player WHERE p1.player = 'John Smith' AND p1.year = 2010 HAVING sim >= 900 ORDER BY sim DESC This gets me a table of results, something like this: player pos year age gp goals assists sim Player1 LW 2002 25 75 29 32 961 Player2 LW 2000 27 82 29 27 956 Player3 RW 2000 27 78 29 33 955 Player4 LW 2009 26 82 30 30 940 Player5 RW 2001 25 79 33 24 938 Player6 LW 2008 25 82 23 24 936 Player7 LW 2006 27 79 26 33 932 Instead, I would like it to do two things. Average the data and add a player count, so I get something like: players age gp goals assists sim 7 26 79 28 29 945 I tried avg(px.age), avg(px.gp), avg(px.goals)...etc but I am running into errors with my "sim" formula. Second issue is that underneath that, I would like to have the average of the data for the FOLLOWING year. In other words data from Player1 in 2003, data from Player2 in 2001, etc. I am stuck as to HOW to get the data to average AND to get it for the following year. Can anyone help me with either or both of these issues?
