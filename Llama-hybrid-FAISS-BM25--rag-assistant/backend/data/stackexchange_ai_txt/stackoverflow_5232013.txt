[site]: stackoverflow
[post_id]: 5232013
[parent_id]: 5231807
[tags]: 
The code down there creates a file with SQL instructions based on what's in your xls. You just have to add a Macro, paste it, and change a few things (add a while to fill the ColFields Collection with the title line where the column names must match the table field names, declare what's not, give a value to fileName...). Then execute the Macro and you'll have a file with all the insert you want, then you'll just have to execute this file on your base. Sub Macro1() Dim NbOfLines = Worksheets(Sheet1).Range("A65536").End(xlUp).Row - 5 'Not the 5 last lines Dim ColFields As New Collection 'Do a while on the title line to fill the collection with wanted columns titles (do not add ignored columns) Dim StartSql As String StartSql = "INSERT INTO " + TableName + "(" For Each loopField In ColFields StartSql = StartSql + loopField + "," Next StartSql = Left(StartSql, Len(StartSql) - 1) StartSql = StartSql + ") SELECT " Dim Value As String For i = 1 To NbOfLines Sql = "" j = 1 For Each loopField In ColFields Value = Worksheets(SheetName).Cells(i, j).Value Sql = Sql + IIf(Value = "", "NULL", "'" + Replace(Value, "'", "''") + "'") + "," j = j + 1 Next Sql = Left(Sql, Len(Sql) - 1) Sql = StartSql + Sql + vbCrLf Call WriteLine(Sql, FileName) Next End Sub Public Sub WriteLine(Ligne As String, FileName As String) Open FileName For Append As #1 Print #1, Ligne Close End Sub edit : I know it's not the best method (nor the most beautiful one), I gave it to you cos' I used it a few weeks ago to import data from a DB to another (but I needed to do it only once, not everyday). I also know there is a way to do it with an OpenRowSet you're right about it, but I just don't know how (I'll go often on this page wishing someone'll teach me). Finally, I encourage you to read this page : A Blog Page With A Solution (You'll find the great procedure 'uftReadfileAsTable' here : The Procedure Code ) Good Luck!
