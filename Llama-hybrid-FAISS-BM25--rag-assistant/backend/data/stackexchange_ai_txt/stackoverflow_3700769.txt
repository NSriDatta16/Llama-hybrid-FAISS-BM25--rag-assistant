[site]: stackoverflow
[post_id]: 3700769
[parent_id]: 3700725
[tags]: 
As event is already a parameter to prepForDrag , its scope is local to the function . But your if condition is wrong: if(event= "undefined") This assigns "undefined" to event and evaluates to true . You probably should use if (typeof event == "undefined") or (as I think what you want is) function prepForDrag(event) { event = event || window.event; if (event.altKey) { showShiftEditable(objCurrentEditRow, nCurrentEditableShift, lCurrentEditableBreak, true); var thisForm = eval('document.${formName}'); ................................ enableDragState(obj); disableClickEditHandler(obj); // remove 'normal' line sched click handling in dd mode } } BTW, why are you eval ing document.${formName} ?
