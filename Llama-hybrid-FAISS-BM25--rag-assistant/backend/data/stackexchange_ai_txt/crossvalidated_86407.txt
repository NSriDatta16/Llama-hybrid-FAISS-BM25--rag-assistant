[site]: crossvalidated
[post_id]: 86407
[parent_id]: 86248
[tags]: 
Unobserved Components Model (UCM) is a state space modeling approach to time series forecasting and regression analysis. It is a very flexible modeling approach, easy to interpret method. I'm not trained in statistics. UCM is a very intuitive method that a non statistician like me could easily adopt and focus on solving the problem as opposed to spending time on model building. UCM is also a very general model and every sensible ARIMA has an UCM equivalent, however not all the UCM have an equivalent ARIMA model. I used SAS to model the UCM. Hovwever, there are other tools such as Stata, Oxmetrics that also have UCM. I don't think there is an easy to use UCM package in R. There is an excellent text An Introduction to State Space Time Series Analysis by Jacques J.F. Commandeur (Author), Siem Jan Koopman (Author) that you could refer to. Below is the code, that I used to model, I also regressed lag value of price, becuase it is reasonable to assume that current months price can have an effect on future months demand. data demandm; set demand; weather_1 = lag(weather); *lag 1; price_1 = lag(price); *lag 1; weather_2 = lag2(weather); *lag 2; price_2 = lag2(price); *lag 2; if weather_2 = . then delete; if price_2 = . then delete; run; ods graphics on ; proc ucm data = demandm; id date interval = month; model demand =weather price price_1; irregular p = 1; season length = 12 variance = 0 noest plot = smooth; estimate back=5 plot=(normal acf); forecast lead=5 back=5 plot=decomp; run ; ods graphics off ; About the code: I created a dataset with lag1 and lag2 variable for weather and price and deleted the first 2 observations because it does not include 2 lags. I used a basic structural model in Proc UCM with only irregular component and seasonal component. In addition, I regressed demand on weather, current months price and past months price. All other variable were not significant. I also held out last 5 months to see how well this model predicts the unknown future data. You could forecast the data by simply changing the forecast statement within proc ucm, however you need to supply the independent variables weather and price for future values. Below is the output: Irregular Error Variance 2.416887E12 3.6646E11 6.60 Since the analysis of residuals showed some pattern left, I modeled irregular component as an autoregressive order = 1. See the code in the irregular component where I have put p = 1 . Price at lag2 and weather at both lags are not significant. With regards to significant individual variables, Each unit change in weather has an increase of ~98,000 units in demand. Current months price has an increase of ~496,000 units of demand. Current months increase in price has a ~770,000 unit decrease in next months demand. The model also automatically identified 2 outliers in July 2012 and August 2007 which can be corrected by changing the SAS code using a dummy code variables. Below are some nice graphical outputs (read in clockwise): the most important plot is the residual auto correlation which shows that there is no pattern left. The season plot where you you can see there is an increase in demand during summer and winder and low demand in spring and fall. Seems intuitive, but the great strength of UCM is that it gives you an interpretable components such as this. Final plot is the model with fitted data. is the out of sample forecast, where you have 5 values that have been held out and the model applied as you can visually see, the current model fits the out of sample data very well, you could use this to compare other class of models. Hope this is helpful.
