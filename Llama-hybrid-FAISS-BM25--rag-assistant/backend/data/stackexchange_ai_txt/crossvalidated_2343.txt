[site]: crossvalidated
[post_id]: 2343
[parent_id]: 
[tags]: 
Trees generated by multi-type branching processes in n steps

I am trying to develop some algorithm to compute probabilities in multi-type branching trees, and I doubt I am doing this right... Let us consider a multi-type branching process with two types, denoted by 0 and 1. The process starts in state 0 with probability 1, so that the root vertex of any tree generated by this process has state 0. A vertex in state 0 generates two vertices in state 1 with probability 1. A vertex in state 1 generates either two vertices in state 0 (with probability 0.5) or one vertex in state 0 and one vertex in state 1 (with probability 0.5). We denote those three possible transitions by: A: 0 -> 1 1 (1.) B: 1 -> 0 0 (0.5) C: 1 -> 0 1 (0.5) (their probabilities are between brackets). In the sequel, a "tree" will refer to an unordered tree, i.e. two isomorphic ordered trees such that the tree isomorphism preserves the labels will be considered as a same mathematical object (following the principle in Chi (2004), p. 1993, paragraph 3 - see link at the end of the post). Now let us consider the particular labeled tree of height three, composed by one root vertex in state 0 with one first child in state 1 that itself has one child in state 0 and one child in state 1 one second child in state 1 that itself has two children in state 0 This tree should be depicted in some file I am not allowed to post, so I should draw it in ascii mode with limited guarantee on the result: 0 | ------------- | | 1 1 | | --------- --------- | | | | 0 1 0 0 I would like to compute the probability that this tree was generated by the above multi-type branching process after 2 generation steps (the generation of the root vertex does not count as a step). Using equation 2 p. 1994 in Chi (2004), this probability should be 0.25, since each transition A, B and C is applied once. However, each possible tree of height 3 among the three trees generated by this process has probability 0.25, and the sum of the probabilities is 0.75 instead of 1. Another possibility is to consider that in this given tree, the set of children (0, 0) of vertex 1 may have been generated by any vertex in state 1 (and same principle for the set of children (0, 1)), so that the tree probability is in fact 0.25+0.25 = 0.5. Finally, how to compute the probability that a given tree t of height n was generated by a multi-type branching process after n-1 generation steps ? Can equation 2 p. 1994 in Chi (2004) be used ? Or do we have to compute the number of trees that are isomorphic to t in some sense ? Or do we have to give up the idea that isomorphic trees are equivalent representations of same object ? Thanks for your help ! JB Ref. Z. Chi. Limit laws of estimators for critical multi-type Galtonâ€“Watson processes. Ann. Appl. Probab. Volume 14, Number 4 (2004), 1992-2015. As a beginning of answer to the suggestion of Aniko, I think the following equivalence relation could lead to equivalence classes of trees such that formula (2) could be applied. It consists in adding constraints to the usual notion of isomorphism (by "isomorphism", I mean "an isomorphism preserving labels"). I denote by $I(v)$ the label of vertex $v$ , and $t_v$ the complete subtree rooted in $v$ . A complete subtree rooted in $v$ is the subgraph induced by the descendants of $v$ . The property $P(t)$ is defined inductively by: $P(t)$ is satisfied iif $t$ has a single vertex, or if for every pair $\{v, v'\}$ of children of the root of $t$ such that $I(v)$ = $I(v')$ , $t_v$ and $t_{v'}$ are isomorphic and they satisfy $P(t_{v'})$ and $P(t_{v})$ . The two trees $t$ and $t'$ are in the same equivalence class iif [they are isomorphic, and property $P$ is satisfied for $t$ and $t'$ ] or [ $t=t'$ ].
