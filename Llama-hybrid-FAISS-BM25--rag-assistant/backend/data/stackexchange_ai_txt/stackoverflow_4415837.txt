[site]: stackoverflow
[post_id]: 4415837
[parent_id]: 
[tags]: 
WHERE Something IN (CASE WHEN statement)?

I want to write a "select clause" according to conditional condition! bu I have error: Msg 512, Level 16, State 1, Line 2 Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, , >= or when the subquery is used as an expression. How can I fix it?? here is my simplified code: SELECT UnitsAllocation.UnitID , OrganizationUnits.Title AS UnitTitle , 'Title' AS ExpenseTitle1 , SUM(UnitsAllocationDetails1.ExpenseAmount1) AS ExpenseAmount1 FROM [bdg_UnitsAllocation] UnitsAllocation LEFT OUTER JOIN ( SELECT UnitsAllocationDetails.UnitsAllocationID , SUM(UnitsAllocationDetails.Amount) / 1 AS ExpenseAmount1 FROM [bdg_UnitsAllocationDetails] UnitsAllocationDetails WHERE UnitsAllocationDetails.ExpenseID IN ( CASE 1 WHEN 1 THEN ( SELECT Id FROM bdg_Expenses WHERE ParentId = 1 ) ELSE ( SELECT Id FROM bdg_Expenses WHERE Id = 1 ) END ) GROUP BY UnitsAllocationDetails.UnitsAllocationID ) UnitsAllocationDetails1 ON UnitsAllocationDetails1.UnitsAllocationID = UnitsAllocation.ID LEFT OUTER JOIN [bdg_OrganizationUnits] OrganizationUnits ON UnitsAllocation.UnitID = OrganizationUnits.ID GROUP BY UnitsAllocation.UnitID, OrganizationUnits.Title please look at "CASE" and "IN" statement.
