[site]: crossvalidated
[post_id]: 518333
[parent_id]: 
[tags]: 
Finding changepoints in a GAM?

I'm using generalized additive modeling to investigate the relationship between two variables, X and Y. I want to find changepoints--i.e., X values at which the slope changes direction. I can get point estimates from the fitted model, but the shape of the function and the number of inflection points aren't consistent across posterior simulations--so it doesn't seem straightforward to develop Bayesian credible intervals. I know how to get confidence intervals for the slopes and identify periods where the slopes are significant. Am I limited to saying "Direction changes may occur within intervals in X where the slope is not significantly different from zero"? What other statements can I make about changepoints or shapes of the functions? Minimal example of what I'm talking about with the different numbers of inflection points is below. (My actual data are messier and there's a lot more variability in shapes.) Generate data and estimate model. library(mgcv) library(tidyverse) set.seed(2) ## simulate data dat Get predicted values and derivatives x2 Get changepoints (i.e., slope passes through zero) find_changepoints Plot smooth with changepoints marked results % ggplot(aes(x2, pred)) + geom_line() + geom_point(data = . %>% filter(change == 1)) Simulate smooths and slopes from posterior distribution and find changepoints for each rep. nreps Plot smooths with changepoints marked. Panel by number of changepoints detected in a rep. sim_result % group_by(rep) %>% mutate(nchange = sum(change)) %>% group_by(rep, change) %>% mutate(change_order = rank(x2)) sim_result %>% ggplot(aes( x = x2, y = pred, group = rep, col = factor(change_order))) + geom_line(alpha = 0.5, color = "gray") + geom_point(data = . %>% filter(change == 1)) + facet_wrap(. ~ nchange) + labs(col = "Changepoint Index") + theme(legend.position = "bottom")
