[site]: crossvalidated
[post_id]: 236120
[parent_id]: 
[tags]: 
PCA with nested/hierarchical data

I have data collected on trees. The nature of the study was hierarchical - we took data on 5 leaves per branch, two branches per tree, and whole tree measurements as well. There were a number of measurements conducted at each level of that hierarchy. So, let's say for example we have leaf area and nitrogen for each leaf, wood density for each branch, and crown size for each tree. (This is a gross simplification, but hope it will serve for the discussion). Thus, if we think of a data frame or spreadsheet of data with one row for each observation of the lowest level (leaf in this case), some data will be repeated. For example, branch wood density will be repeated for each leaf associated with that branch, while leaf area and nitrogen will vary within that branch. And so on. The question is: what are the implications of running a PCA on data when some data are being repeated across rows? If this is not "legit", I can aggregate data up to the highest level (tree in this case), taking means of lower-level data. But if there's a way to avoid throwing away variation like this, I'd prefer to keep it in there. Thanks for any thoughts! a quick illustration of example data: treenum branchnum leafnum crown wood area n 1 1 1 .5 .2 .8 1.2 1 1 2 .5 .2 .6 0.7 1 2 1 .5 .4 .6 0.2 1 2 2 .5 .4 .2 0.6 2 1 1 .8 .5 .2 0.1 2 1 2 .8 .5 .4 0.5 2 2 1 .8 .9 .3 0.7 2 2 2 .8 .9 .5 0.1
