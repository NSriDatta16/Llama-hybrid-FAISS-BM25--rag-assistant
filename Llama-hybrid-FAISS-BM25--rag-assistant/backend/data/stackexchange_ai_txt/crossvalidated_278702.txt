[site]: crossvalidated
[post_id]: 278702
[parent_id]: 278636
[tags]: 
CNN + RNN possible. To understand let me try to post commented code. CNN running of chars of sentences and output of CNN merged with word embedding is feed to LSTM N - number of batches M - number of examples L - number of sentence length W - max length of characters in any word coz - cnn char output size Consider x = [N, M, L] - Word level Consider cnnx = [N, M, L, W] - character level Aim is to use character and word embedding in LSTM CNNx = tf.nn.embedding_lookup(emb_mat, cnnx) [N, M, L, W, dc] filter_sizes = [100] heights = [5] outs = [] for filter_size, height in zip(filter_sizes, heights): num_channels = 3 filter_ = [1, height, num_channels, filter_size] strides = [1, 1, 1, 1] xxc = tf.nn.conv2d(Acx, filter_, strides, "VALID") # [N*M, L, W/stride, d] out = tf.reduce_max(tf.nn.relu(xxc), 2) # [-1, L, d] outs.append(xxc) concat_out = tf.concat(2, outs) xx = tf.reshape(concat_out, [-1, M, L, coz]) Ax = tf.nn.embedding_lookup(emb_mat, x) xx = tf.concat(3, [xx, Ax]) # [N, M, L, di] This xx we can feed to RNN with LSTM
