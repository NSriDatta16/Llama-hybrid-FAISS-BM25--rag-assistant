[site]: crossvalidated
[post_id]: 494710
[parent_id]: 
[tags]: 
Prediction in pcr object via pls package

I have a data.txt data, which shows x1 x2 x3 x4 y 82.9 92 17.1 94 8.4 88.0 93 21.3 96 9.6 99.9 96 25.1 97 10.4 105.3 94 29.0 97 11.4 117.7 100 34.0 100 12.2 131.0 101 40.0 101 14.2 148.2 105 44.0 104 15.8 161.8 112 49.0 109 17.9 174.2 112 51.0 111 19.6 184.7 112 53.0 111 20.8 Then I try the principal component regression procedure with library(pls) on this data as d = read.table("data.txt", head=T) X = within(d, rm(y)) y = d$y pca = prcomp(X,center=T,scale=T) summary(pca) k = 1 library(pls) pcr1 = pcr(y~., scale=T, ncomp=k, data=d) betahat = coef(pcr1, ncomp=k, intercept=T) betahat yhat1 = predict(pcr1, ncomp=k) yhat1 yhat2 = as.matrix(cbind(1,X)) %*% betahat yhat2 data.frame(y,yhat1,yhat2) which gives y y.1.comps yhat2 8.4 8.376161 287.2186 9.6 9.352910 300.5820 10.4 10.597365 322.0072 11.4 10.817749 329.9397 12.2 12.917760 358.6413 14.2 14.120754 381.8006 15.8 16.013497 412.4796 17.9 18.622375 445.7503 19.6 19.499989 463.6031 20.8 19.981440 477.2098 Obviously, there must be something wrong with yhat2 . Did I have missing something?
