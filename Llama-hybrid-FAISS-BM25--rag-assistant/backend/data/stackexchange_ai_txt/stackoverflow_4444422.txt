[site]: stackoverflow
[post_id]: 4444422
[parent_id]: 
[tags]: 
SQL Server 2008 and Almost-Progressive Sum and Average?

I have a table with several million rows, with an ID column and a DateTimeOffset column. The table simply tracks elapsed time for some operations. Without touching a cursor or doing RBAR, how can I get the difference between each row, and then the average time among all rows? For example, if row 1 is 12:00 and row 2 is 12:01 and row 3 is 12:03 then my result set would have row 1 with 0, row 2 with 1, and row 3 with 2. Then my next result set would have a value of 1.5. Help? Thanks.
