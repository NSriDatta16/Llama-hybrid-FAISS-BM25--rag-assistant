[site]: crossvalidated
[post_id]: 573464
[parent_id]: 573420
[tags]: 
You made an error in your simulation. The difference in means estimator is unbiased for the ATE. The error you made is in simulating t (i.e., $\tau$ ). The question states "The average treatment effect on all the students, $\tau$ , equals 5". You programmed it so that the ATT is 5 and the ATC is 0. You need to set t = 5 in your simulation. Then, the SATE and ATE both line up with $\tau$ . set.seed(18) n = 1000 x = rnorm(n, 65, 3 ) z = sample(c(1,0), 1000, replace = TRUE) t = 5 y0 = 10 +1.1*x +rnorm(n, 0, 1) y1 = 10 +1.1*x + t + rnorm(n, 0, 1) data = data.frame(x,z,y0,y1, yi = ifelse(z == 1 , y1, y0)) #SATE (SATE = mean(data $y1 - data$ y0)) #> [1] 4.9505 #difference in means - ATE (ATE = mean(data[data $z == 1 ,]$ yi - mean(data[data $z==0,]$ yi))) #> [1] 4.836275 They differ only due to sampling error. The treatment effect is constant; there is no heterogeneous treatment effect.
