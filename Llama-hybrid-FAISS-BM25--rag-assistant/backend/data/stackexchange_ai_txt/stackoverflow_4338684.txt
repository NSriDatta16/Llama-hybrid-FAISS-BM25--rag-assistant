[site]: stackoverflow
[post_id]: 4338684
[parent_id]: 
[tags]: 
Average of Sum minus Minimum

I have an SQL statement that grabs the grades of different activity types (Homework, Quiz, etc), and if there's a drop lowest for that type, it drops, else, it remains. The errors are below as well as the SQL Code. SELECT Student.firstName, Student.lastName, 'Grades' = CASE WHEN Grades.activityType = 'Homework' THEN CASE WHEN Policy.drop_hw = 1 THEN (AVG(SUM(Grades.grade) - MIN(Grades.grade))) * (Policy.homework / 100) ELSE (AVG(Grades.grade) * (Policy.homework / 100)) END END, Course.courseNum, Course.sectNum, Grades.activityType FROM ... Here are the errors I'm getting: - Cannot perform an aggregate function on an expression containing an aggregate or a subquery. - Column 'Policy.drop_hw' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.
