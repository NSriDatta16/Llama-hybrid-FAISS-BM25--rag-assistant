[site]: stackoverflow
[post_id]: 467082
[parent_id]: 426483
[tags]: 
I figured out a workaround. This is for IIS running on a Win 2k3 Server--older versions will be much easier. First I created a subdirectory off the main site (for security purposes) and attached a new application pool to that directory. The new application pool needs to run as Local System. I couldn't get fop.bat to work, even running as local system, but I could call java, so I put the entire fop commandline into my asp script, similar to this snippet: Dim shell, foppath, workpath Set shell = Server.CreateObject("WScript.Shell") foppath = Server.MapPath("/fop/") workpath = Server.MapPath("/tmp/") shell.CurrentDirectory = foppath Dim commandline commandline = "java -Denv.windir=C:\WINDOWS -cp """ 'set classpath commandline = commandline & foppath & "\build\fop.jar;" commandline = commandline & foppath & "\build\fop-sandbox.jar;" commandline = commandline & foppath & "\build\fop-hyph.jar;" commandline = commandline & foppath & "\lib\xml-apis-1.3.04.jar;" commandline = commandline & foppath & "\lib\xml-apis-ext-1.3.04.jar;" commandline = commandline & foppath & "\lib\xercesImpl-2.7.1.jar;" commandline = commandline & foppath & "\lib\xalan-2.7.0.jar;" commandline = commandline & foppath & "\lib\serializer-2.7.0.jar;" commandline = commandline & foppath & "\lib\batik-all-1.7.jar;" commandline = commandline & foppath & "\lib\xmlgraphics-commons-1.3.1.jar;" commandline = commandline & foppath & "\lib\avalon-framework-4.2.0.jar;" commandline = commandline & foppath & "\lib\commons-io-1.3.1.jar;" commandline = commandline & foppath & "\lib\commons-logging-1.0.4.jar;" commandline = commandline & foppath & "\lib\jai_imageio.jar;" commandline = commandline & foppath & "\lib\fop-hyph.jar;" commandline = commandline & """ org.apache.fop.cli.Main " commandline = commandline & workpath & "/file.fo " commandline = commandline & workpath & "/file.pdf " Dim ResultCode ResultCode = Shell.Run(commandline,,True) ' True = Wait for FOP to finish Afterwards, I make sure I cleanup my temp files, etc. Perhaps not the most elegant solution, but given the need, I'm sure it will work for a long time.
