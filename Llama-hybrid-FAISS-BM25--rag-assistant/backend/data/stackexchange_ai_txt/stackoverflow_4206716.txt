[site]: stackoverflow
[post_id]: 4206716
[parent_id]: 4206482
[tags]: 
Here's a more readable version: SELECT COUNT(a.int_re_usu) AS qtd, b.txt_marca, (SELECT CASE WHEN a.txt_resposta IS NULL THEN CASE WHEN a.bit_opcao = 1 THEN 'Sim' ELSE 'N達o' END ELSE a.txt_resposta END) AS answer, a.txt_resposta FROM tb_questionario_voar_resposta a INNER JOIN tb_questionario_voar b ON a.int_id_questionario = b.int_id_questionario GROUP BY b.txt_marca, answer The first problem is that the GROUP BY doesn't include txt_resposta. The second problem is that you can't "GROUP BY answer" because answer is not in the source tables, but calculated. As suggested above, you'd be better off splitting the subquery into a separate WITH clause, but if you really want to do it in one fell swoop, it would be something (rather ugly) like this: SELECT COUNT(a.int_re_usu) AS qtd, b.txt_marca, (SELECT CASE WHEN a.txt_resposta IS NULL THEN CASE WHEN a.bit_opcao = 1 THEN 'Sim' ELSE 'N達o' END ELSE a.txt_resposta END) AS answer, a.txt_resposta FROM tb_questionario_voar_resposta a INNER JOIN tb_questionario_voar b ON a.int_id_questionario = b.int_id_questionario GROUP BY b.txt_marca, (SELECT CASE WHEN a.txt_resposta IS NULL THEN CASE WHEN a.bit_opcao = 1 THEN 'Sim' ELSE 'N達o' END ELSE a.txt_resposta END), a.txt_resposta or a little more readably, with a WITH clause: WITH temp(usu, txt_marca, answer, txt_resposta) AS ( SELECT a.int_re_usu, b.txt_marca, (SELECT CASE WHEN a.txt_resposta IS NULL THEN CASE WHEN a.bit_opcao = 1 THEN 'Sim' ELSE 'N達o' END ELSE a.txt_resposta END), a.txt_resposta ) SELECT COUNT(usu) as qtd, txt_marca, answer, txt_resposta FROM temp GROUP BY txt_marca, answer, txt_resposta
