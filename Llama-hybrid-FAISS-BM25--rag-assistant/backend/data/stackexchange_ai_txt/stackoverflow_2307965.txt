[site]: stackoverflow
[post_id]: 2307965
[parent_id]: 
[tags]: 
LibGD library is not working: crash when saving image

I've been seeking for JPG saving library for long time for c++, but i cant seem to get anything to work. Now i am trying use LibGD: What im doing wrong ? It seems to work, but the saving crashes. Code: ... #pragma comment(lib, "bgd.lib") #include ... void save_test(){ gdImagePtr im; FILE *jpegout; int black; int white; im = gdImageCreateTrueColor(64, 64); black = gdImageColorAllocate(im, 0, 0, 0); white = gdImageColorAllocate(im, 255, 255, 255); gdImageLine(im, 0, 0, 63, 63, white); if(jpegout = fopen("test.jpg", "wb")){ if(im){ gdImageJpeg(im, jpegout, -1); // crash here! } fclose(jpegout); } gdImageDestroy(im); } I downloaded the library from: http://www.libgd.org/releases/gd-latest-win32.zip I have the library / include / bgd.dll files in correct directories etc. Edit: Answer below includes this code that fixed my problem: int size; char* data = (char*)gdImagePngPtr(im, &size); fwrite(data, sizeof(char), size, out); gdFree(data);
