[site]: stackoverflow
[post_id]: 4218763
[parent_id]: 4211070
[tags]: 
Just as a sidetalk: The usual way to program in Mathematica is functional, rather than procedural. Variables are defined only when you need to inspect something, or preserve results for future work. Also, loops are discouraged. An equivalent form of your program (just a quick draft), in these lines may be something like: x = {{1, a1, b1, c1, 2010, 11, 12}, {1, a2, b2, c2, 2011, 12, 13}}; Export["c:\data.csv", #, "CSV"] & [Flatten[ {#[[1 ;; 7]], {#, If[# > 90, "Y", "N"]} &@ DateDifference[#[[5 ;; 7]], DateList[][[1 ;; 3]]]} ] & /@ x]
