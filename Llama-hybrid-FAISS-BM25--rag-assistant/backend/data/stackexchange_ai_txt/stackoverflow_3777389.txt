[site]: stackoverflow
[post_id]: 3777389
[parent_id]: 3777321
[tags]: 
Using sql server 2005+ you can try DECLARE @StudentMarks TABLE( StudentID INT, SubjectName VARCHAR(50), SubjectMark FLOAT ) INSERT INTO @StudentMarks SELECT 1, 'A', 80 INSERT INTO @StudentMarks SELECT 1, 'B', 80 INSERT INTO @StudentMarks SELECT 1, 'C', 80 INSERT INTO @StudentMarks SELECT 2, 'A', 60 INSERT INTO @StudentMarks SELECT 2, 'B', 60 INSERT INTO @StudentMarks SELECT 2, 'C', 60 ;WITH Marks AS ( SELECT StudentID, SUM(SubjectMark) TotalSubjectMarks, AVG(SubjectMark) MarksAverage FROM @StudentMarks GROUP BY StudentID ) SELECT *, ROW_NUMBER() OVER(ORDER BY MarksAverage DESC) Position FROM Marks
