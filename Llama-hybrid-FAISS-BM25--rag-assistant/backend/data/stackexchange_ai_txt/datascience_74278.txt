[site]: datascience
[post_id]: 74278
[parent_id]: 74277
[tags]: 
This is a programming question rather than a data science question. You need to use apply with a lambda function. So if your DataFrame is called movies : In apply you must add axis=1 which means that you apply the function to rows and not to columns. def get_genre(row, genre_index): array_genres = row['genres'].split('|') if len(array_genres) == 0: return '' elif len(array_genres) == 1 and genre_index == 1: return array_genres[0] else: return array_genres[genre_index] movies['genre_1'] = movies.apply(lambda row: get_genre(row, 0), axis=1) movies['genre_2'] = movies.apply(lambda row: get_genre(row, 1), axis=1)
