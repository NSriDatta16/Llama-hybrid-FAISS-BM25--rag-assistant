[site]: stackoverflow
[post_id]: 2755458
[parent_id]: 
[tags]: 
Retrieving virtual disk file name from disk number

When I list virtual disks within diskpart: DISKPART> list vdisk VDisk ### Disk ### State Type File --------- -------- -------------------- --------- ---- VDisk 0 Disk 2 Attached not open Fixed C:\Disk.vhd Interesting part for me here is file name. I tried to find equivalent of function that would give me file name (under File column) if I know disk number. Ideally, I would give " \\?\PhysicalDrive2 " and I would get " C:\Disk.vhd " as result. I already tried: Using diskpart and parsing output - since it is undocumented format, it can change at any time. This is not something I would rely on. General VHD API - no function takes disk number as parameter. Microsoft.Storage.Vds.dll - There are enumerations that go through each drive (e.g. Service.Providers) but there is no property/function that will give me name of source file. While I can now be sure that e.g. drive D: is virtual drive, I still cannot know which .vhd file was attached. Any idea which function that might be?
