[site]: crossvalidated
[post_id]: 517815
[parent_id]: 
[tags]: 
Applying a Hessian matrix to a logistic function in R

I'm using the following code to implement the logistic regression function so I may get the result for that of a Hessian matrix. I start with the function defined as $\frac{1}{(1+e^{-x})}$ called "logitregress" and I plug this function into a newly created function called "logitfunct" which is meant to handle the calculation of my $X$ matrix which contains a set of 768 observations with 5 predictors and a column of 1's for the intercept values. I also create initial values for my covariates(coefficients of my predictors) as my $\beta$ matrix. From the "numDeriv" package, I plug my "logitfunct" which is the function that I want the Hessian matrix to be built off of along with my $\beta$ matrix to get the estimates of the covariates using the "hessian" command. The resulting matrix is a 5x5 matrix that provides unique results to be used for further analysis. My question is, is there any way for me to reproduce the results to get the Hessian matrix output as provided below? I have provided all the R code that is needed to reproduce the matrix using the Hessian matrix as I would like to get that matrix without using that function package directly. Thank you # Package setup install.packages("faraway") install.packages("numDeriv") install.packages("MASS") require(faraway) require(numDeriv) require(MASS) pima # Parameter Setup x=matrix(cbind(pima $glucose, pima$ diastolic, pima $bmi, pima$ age), ncol=4) y=pima$test n=length(y) X=cbind(rep(1,n),x) beta=rep(0,5) # logistic regression function logitregress=function(x){ 1/(1+exp(-x))} # Derivable logistic function logitfunct=function(beta, X, y){ L=(-1/n)*sum(y*log(logitregress(X%*%beta)) + (1-y)*log(1-logitregress(X%*%beta))) return(L)} # Hessian Matrix from NumDeriv H=hessian(logitfunct, beta, method = "complex", X = X, y = y) H Which returns the following Hessian matrix,
