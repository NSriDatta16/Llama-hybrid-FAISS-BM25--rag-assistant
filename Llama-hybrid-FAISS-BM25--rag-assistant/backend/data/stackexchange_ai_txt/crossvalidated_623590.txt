[site]: crossvalidated
[post_id]: 623590
[parent_id]: 
[tags]: 
When, why and how to use random slopes with three-way cross-level interactions in multilevel models?

I am trying to estimate a hierarchical (random/fixed/mixed?) model with cross-level interactions and I can't wrap my head around if, how and where and why I should include random intercepts and slopes. To make things more complicated, the model is also some kind of "interrupted time series" model, i.e. I am interested in the effect of a specific event taking place. To start with, a basic linear regression of my (simplified) model would basically look something like this. I am aware that the notation is not perfectly correct, but I hope you get the idea of the model: $$ y = \beta_0 + \beta_1 time\_var + \beta_2 time\_since + \beta_3 incident\_happened + \beta_4 incident\_type + \beta_5 group\_characteristic + \beta_6 incident\_happened*incident\_type + \beta_7 incident\_happened*incident\_type*group\_characteristic $$ Now, it is clear that the basic linear regression is not appropriate , because the data is crossed (not nested). I identified the levels/variables like this: Level-1 variables (time specific variables): time_var : a consecutive variable where 1 is the first occurence and 100 the last. time_since : a variable incident_happened : a dummy indicating if the incident happened. This is actually the main effect I am interested in. Level-2 variables (incident specific variables): incident_type : a dummy indicating if incident type is 0 or 1. Level-3 variables (group specific variables): group_characteristic : a continous variable As I said, the variable incident_happened is the effect I am interested in, but I assume that the effect is moderated by incident_type as well as the specific group_characteristic variable. Therefore, I am also interested in $\beta_6$ and $\beta_7$ . I am using the lme4 package to estimate this model. My first intuition was to only allow for random intercepts like in this model: random_intercept_model This was the only way it would make sense to me because I thought: if I use my group_characteristic variable as a moderator, where is the sense in allowing the slope of e.g. incident_happened to vary by group? Because not every group can have the same characteristics (also, in my acutal model I have different group-characteristic variables included and the combination of these characteristics is not endless). So I assume, if there is a moderating effect of group_characteristic , then, allowing for random slopes by group will diminish or completely eliminate any significant coefficients in the model. However, I just stumbled over this paper where the authors state that it doesn't make any sense to use cross-level interactions withouth including a random slope. Therefore, I should actually include a random slope for incident_happened and incident_type (or maybe even for the interaction terms). I am now going to try to formulate my questions: 1. Question: Do I really need random slopes in my model? If so, do I only need random slopes for incident_happened and incident_type or do I even need to allow for random slopes in the interaction terms? 2. Question: What is the appropriate way to implement this in R with the lmer function? My guess would be to allow for random slopes for incident_happened and incident_type for both, the second and third level and I guess the implementation would look something like this: random_slope_model I am totally sorry for this awkward long text, but I am new to the hierarchical model game and also don't really understand what the different is to mixed models (I guess there are none?). Actually, at first the whole thing seemed to me like including interactions in a linear regression (but with different estimations to get robust standard errors), but the implementation in R confused me a lot. Thanks for any answers! EDIT: Here is some example data: structure(list(group_id = c("group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_1", "group_2", "group_2", "group_2", "group_2", "group_2", "group_2", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3", "group_3"), incident_id = c("incident_A", "incident_A", "incident_A", "incident_A", "incident_A", "incident_A", "incident_B", "incident_B", "incident_B", "incident_B", "incident_B", "incident_B", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_A", "incident_A", "incident_A", "incident_A", "incident_A", "incident_A", "incident_B", "incident_B", "incident_B", "incident_B", "incident_B", "incident_B", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C", "incident_C"), y = c(4, 4, 3, 5, 1, 3, 1, 2, 1, 0, 2, 2, 25, 10, 26, 25, 27, 26, 1, 4, 4, 6, 4, 8, 3, 0, 0, 2, 1, 1, 4, 1, 0, 0, 4, 1, 2, 1, 1, 0, 1, 1), time_var = c(1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L), time_since = c(0, 0, 0, 1, 2, 3, 0, 0, 0, 1, 2, 3, 0, 0, 0, 1, 2, 3, 0, 0, 0, 1, 2, 3, 0, 0, 0, 1, 2, 3, 0, 0, 0, 1, 2, 3, 0, 0, 0, 1, 2, 3), incident_happened = structure(c(1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L), levels = c("0", "1"), labels = c(`Pre Incident` = 0, `After Incident` = 1), class = "factor"), incident_type = c(0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), group_characteristic_1 = c(56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 56, 61, 61, 61, 61, 61, 61, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54), group_characteristic_2 = c(49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 38, 38, 38, 38, 38, 38, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65), group_characteristic_3 = c(86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 51, 51, 51, 51, 51, 51, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94)), row.names = c(NA, -42L), class = c("tbl_df", "tbl", "data.frame"))
