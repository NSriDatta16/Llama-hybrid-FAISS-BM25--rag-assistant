[site]: crossvalidated
[post_id]: 111771
[parent_id]: 
[tags]: 
Restriction matrix for a VAR

In New Introduction to Multiple Time Series Analysis by Luetkepohl (2005), section 5.2.1, it says that one can specify linear restraints for a VAR, $Y = \beta X + U$, in the form $$ \operatorname{vec}{\beta} = R\gamma + r $$ where $\beta$ is a $K(Kp+1)$-vector of parameters, $R$ is a $K(Kp+1) \times M$ matrix, $\gamma$ is an $M$-vector of "unrestricted parameters," and $r$ is a $K(Kp+1)$-vector of specified constants. He then derives an equivalence with the "standard" form of the restriction, $C\operatorname{vec}{\beta}=c$. Suppose I have a VAR like $$ \left(\matrix{w_t\\x_t\\y_t\\z_t}\right) = \left(\matrix{\beta^{ww}_{t-1}&\beta^{xw}_{t-1}&\beta^{yw}_{t-1}&\beta^{zw}_{t-1}\\\beta^{wx}_{t-1}&\beta^{xx}_{t-1}&\beta^{yx}_{t-1}&\beta^{zx}_{t-1}\\\beta^{wy}_{t-1}&\beta^{xy}_{t-1}&\beta^{yy}_{t-1}&\beta^{zy}_{t-1}\\\beta^{wz}_{t-1}&\beta^{xz}_{t-1}&\beta^{yz}_{t-1}&\beta^{zz}_{t-1}\\}\right) \left(\matrix{w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}\\w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}\\w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}\\w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}}\right) + \left(\matrix{u^w_t\\u^x_t\\u^y_t\\u^z_t}\right). $$ How would I specify $R$, $\gamma$, and $r$, and/or the equivalent $C$ and $c$ (both is better), to obtain $$ \left(\matrix{w_t\\x_t\\y_t\\z_t}\right) = \left(\matrix{\beta^{ww}_{t-1}&\beta^{xw}_{t-1}&0&0\\\beta^{wx}_{t-1}&\beta^{xx}_{t-1}&0&0\\0&0&\beta^{yy}_{t-1}&\beta^{zy}_{t-1}\\0&0&\beta^{yz}_{t-1}&\beta^{zz}_{t-1}\\}\right) \left(\matrix{w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}\\w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}\\w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}\\w_{t-1}&x_{t-1}&y_{t-1}&z_{t-1}}\right) + \left(\matrix{u^w_t\\u^x_t\\u^y_t\\u^z_t}\right)? $$ And how would I extend it to the case with more than one lag, e.g. $$ \left[\matrix{\tilde{\beta}_{t-1} & \tilde{\beta}_{t-2}}\right] = \left(\matrix{\beta^{ww}_{t-1}&\beta^{xw}_{t-1}&0&0&\beta^{ww}_{t-2}&\beta^{xw}_{t-2}&0&0\\\beta^{wx}_{t-1}&\beta^{xx}_{t-1}&0&0&\beta^{xw}_{t-2}&\beta^{xx}_{t-2}&0&0\\0&0&\beta^{yy}_{t-1}&\beta^{zy}_{t-1}&0&0&\beta^{yy}_{t-2}&\beta^{zy}_{t-2}\\0&0&\beta^{yz}_{t-1}&\beta^{zz}_{t-1}&0&0&\beta^{zy}_{t-2}&\beta^{zz}_{t-2}\\}\right)? $$ In particular, I'm interested in testing $$ H_0: \beta = \beta_0 = \left[\matrix{\tilde{\beta}_{t-1} & 0}\right], \quad H_A: \beta = \beta_A = \left[\matrix{\tilde{\beta}_{t-1} & \tilde{\beta}_{t-2}}\right] $$ by fitting the model with $$ \hat{\gamma} = (R'(ZZ' \otimes \widehat{\Sigma_U}^{-1})R)^{-1}R'(Z' \otimes \widehat{\Sigma_U}^{-1})(\operatorname{vec}{Y} - (Z' \otimes I_k )r) $$ (equation 5.2.9), and computing the test statistic $$ \frac{(C_0\hat{\gamma}-c)'(C_0((ZZ')^{-1}\otimes\widehat{\Sigma_U})C_0')^{-1}(C_0\hat{\gamma}-c)}{N} \sim F_{N,\,T-Kp-1} $$ where $Z$ is the matrix of lags of $Y=(w, x, y, z)$, and $C_0$ is the matrix that restricts $\beta_A$ to $\beta_0$. And yes, I know this is equivalent to fitting many separate VARs, but I want to test for lag length simultaneously. I am using the Wald test rather than AIC, etc. at the suggestion of Toda & Yamamoto (1995), who find that its asymptotic distribution is a standard $\chi^2$ as long as the lag order is greater than or equal to the largest order of integration among all components of $Y$. And I'm assuming that none of these variables has more than one unit root, since it's a) implausible in this data and b) I don't have enough data points to distinguish a feature as complicated as an $I(2)$ structure from, say, a time-varying trend. update: I think I'm I just looking for a matrix operator that maps $\mathbb{R}^k$ to $\mathbb{R}^l$ where $l
