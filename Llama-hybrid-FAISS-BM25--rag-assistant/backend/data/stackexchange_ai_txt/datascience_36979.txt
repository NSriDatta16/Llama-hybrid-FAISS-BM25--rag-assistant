[site]: datascience
[post_id]: 36979
[parent_id]: 
[tags]: 
Invalid Argument Error when running simple Convolutional Neural Network

I am running a convolutional neural network with CSV files as training and test input. I am getting a strange error that I cannot solve. Traceback (most recent call last): File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py", line 1350, in _do_call return fn(*args) File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py", line 1320, in _run_fn self._extend_graph() File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py", line 1381, in _extend_graph self._session, graph_def.SerializeToString(), status) File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/errors_impl.py", line 473, in __exit__ c_api.TF_GetCode(self.status.status)) tensorflow.python.framework.errors_impl.InvalidArgumentError: No OpKernel was registered to support Op 'Switch' with these attrs. Registered devices: [CPU], Registered kernels: device='CPU'; T in [DT_BOOL] device='CPU'; T in [DT_FLOAT] device='CPU'; T in [DT_INT32] device='GPU'; T in [DT_STRING] device='GPU'; T in [DT_BOOL] device='GPU'; T in [DT_INT32] device='GPU'; T in [DT_FLOAT] [[Node: remove_squeezable_dimensions/cond/Switch_1 = Switch[T=DT_INT64, _class=["loc:@ArgMax"]](ArgMax, remove_squeezable_dimensions/cond/pred_id)]] During handling of the above exception, another exception occurred: Traceback (most recent call last): File "/home/pi/Desktop/CNN.py", line 151, in sess.run(init) File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py", line 895, in run run_metadata_ptr) File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py", line 1128, in _run feed_dict_tensor, options, run_metadata) File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py", line 1344, in _do_run options, run_metadata) File "/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py", line 1363, in _do_call raise type(e)(node_def, op, message) I am running Tensorflow 1.5 on a RaspberryPi 3. Here is the neural network below. import tensorflow as tf import numpy as np import csv import pandas as pd import os image_height = 60 image_width = 1 image1_height = 15 image2_height = 1 model_name = "TensorflowCNN" #Training Data Configuration train_data = np.asarray(pd.read_csv("/media/pi/DISK_IMG/TrainingInput.csv", usecols=[1])) lis = train_data.tolist() lis = lis[0:60] lis = [x[0].strip('[]\n,') for x in lis] nlis = [] for i in lis: nlis.append(i.split()) for i in range(len(nlis)): nlis[i] = [float(x) for x in nlis[i] if x != "...,"] nlis = [np.mean(x) for x in nlis] train_data = np.asarray(nlis) #Training Labels Configuration train_labels = np.asarray(pd.read_csv("/media/pi/DISK_IMG/TrainingInput.csv", usecols=[2])) mylist = train_labels.tolist() mylist = mylist[0:60] mylist = [x[0] for x in mylist] index = 0 while index 0: current_acc = sess.run(cnn.accuracy) print("Accuracy at step " + str(step) + ":" + str(current_acc)) saver.save(sess, path + model_name, step) print("Saving final checkpoint for training session.") saver.save(sess, path + model_name, step) I would appreciate it if someone could point me in the right direction. _________________________________UPDATE___________________________________ Based on an answer given earlier to this question, I updated my version of tensorflow. I now get this error: 2018-08-15 17:16:42.551134: F ./tensorflow/core/util/bcast.h:111] Check failed: vec.size() == NDIMS (1 vs. 2) Aborted How should I fix this?
