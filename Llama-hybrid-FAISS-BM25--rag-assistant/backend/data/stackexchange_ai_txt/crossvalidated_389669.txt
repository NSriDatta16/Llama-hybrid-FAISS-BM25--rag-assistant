[site]: crossvalidated
[post_id]: 389669
[parent_id]: 389545
[tags]: 
The statistical approach is very similar to two of the answer above, but it deals a bit more with how to pick the number of latent classes if you lack prior knowledge. You can use information criteria or parsimony as a guide in choosing number of latent classes. Here is a Stata example using a sequence of finite mixture models (FMMs) with 2-4 latent classes/components. The first table is the coefficients for the latent class membership. These are a bit difficult to interpret, but they can be converted to probabilities later with estat lcprob . For each class, you also get an intercept and a ph slope parameter, followed by latent class marginal probabilities, and two in-sample ICs. These coefficient estimates are interpreted just as the coefficients from a linear regression model. Here the smallest in-sample BIC tells you to pick the two component model as the best one. AIC strangely selects the 3 component model. You can also use out-of-sample ICs to pick or use cross validation. Another way to gauge that you are pushing the data too far is if the last class share is very small, since an additional components may simply reflect the presence of outliers in the data. In that case, parsimony favors simplifying the model and removing components. However, if you think that small classes are possible in your setting, this may not be the canary in the coal mine. Here parsimony favors the 2 component model since the third class only contains $.0143313 \cdot 300 \approx 4$ observations. The FMM approach will not always work this well in practice if the classes are less stark. You may run into computational difficulties with too many latent classes, especially if you don't have enough data, or the likelihood function has multiple local maxima. . clear . /* Fake Data */ . set seed 10011979 . set obs 300 number of observations (_N) was 0, now 300 . gen ph = runiform(5.1, 7.8) in 1/150 (150 missing values generated) . replace ph = runiform(5.3, 8) in 151/300 (150 real changes made) . gen y = 41.55 + 5.185*ph + rnormal(0, .25) in 1/150 (150 missing values generated) . replace y = 65.14 + 1.48148*ph + rnormal(0, 0.25) in 151/300 (150 real changes made) . . /* 2 Component FMM */ . fmm 2, nolog: regress y ph Finite mixture model Number of obs = 300 Log likelihood = -194.5215 ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- 1.Class | (base outcome) -------------+---------------------------------------------------------------- 2.Class | _cons | .0034359 .1220066 0.03 0.978 -.2356927 .2425645 ------------------------------------------------------------------------------ Class : 1 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 5.173137 .0251922 205.35 0.000 5.123761 5.222513 _cons | 41.654 .1622011 256.80 0.000 41.3361 41.97191 -------------+---------------------------------------------------------------- var(e.y)| .0619599 .0076322 .0486698 .078879 ------------------------------------------------------------------------------ Class : 2 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 1.486062 .026488 56.10 0.000 1.434147 1.537978 _cons | 65.10664 .1789922 363.74 0.000 64.75582 65.45746 -------------+---------------------------------------------------------------- var(e.y)| .0630583 .0075271 .0499042 .0796797 ------------------------------------------------------------------------------ . estat lcprob Latent class marginal probabilities Number of obs = 300 -------------------------------------------------------------- | Delta-method | Margin Std. Err. [95% Conf. Interval] -------------+------------------------------------------------ Class | 1 | .499141 .0305016 .4396545 .5586519 2 | .500859 .0305016 .4413481 .5603455 -------------------------------------------------------------- . estat ic Akaike's information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 300 . -194.5215 7 403.043 428.9695 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note. . . /* 3 Component FMM */ . fmm 3, nolog: regress y ph Finite mixture model Number of obs = 300 Log likelihood = -187.4824 ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- 1.Class | (base outcome) -------------+---------------------------------------------------------------- 2.Class | _cons | -.0312504 .123099 -0.25 0.800 -.2725199 .2100192 -------------+---------------------------------------------------------------- 3.Class | _cons | -3.553227 .5246159 -6.77 0.000 -4.581456 -2.524999 ------------------------------------------------------------------------------ Class : 1 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 5.173077 .0252246 205.08 0.000 5.123637 5.222516 _cons | 41.65412 .16241 256.48 0.000 41.3358 41.97243 -------------+---------------------------------------------------------------- var(e.y)| .0621157 .0076595 .0487797 .0790975 ------------------------------------------------------------------------------ Class : 2 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 1.476049 .0257958 57.22 0.000 1.42549 1.526608 _cons | 65.18698 .1745018 373.56 0.000 64.84496 65.52899 -------------+---------------------------------------------------------------- var(e.y)| .0578413 .0070774 .0455078 .0735173 ------------------------------------------------------------------------------ Class : 3 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 1.776746 .0020074 885.09 0.000 1.772811 1.78068 _cons | 62.76633 .0134072 4681.54 0.000 62.74005 62.79261 -------------+---------------------------------------------------------------- var(e.y)| 9.36e-06 6.85e-06 2.23e-06 .0000392 ------------------------------------------------------------------------------ . estat lcprob Latent class marginal probabilities Number of obs = 300 -------------------------------------------------------------- | Delta-method | Margin Std. Err. [95% Conf. Interval] -------------+------------------------------------------------ Class | 1 | .5005343 .0304855 .4410591 .5599944 2 | .4851343 .0306119 .4256343 .5450587 3 | .0143313 .0073775 .0051968 .038894 -------------------------------------------------------------- . estat ic Akaike's information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 300 . -187.4824 11 396.9648 437.7064 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note. . . /* 4 Component FMM */ . fmm 4, nolog: regress y ph Finite mixture model Number of obs = 300 Log likelihood = -188.06042 ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- 1.Class | (base outcome) -------------+---------------------------------------------------------------- 2.Class | _cons | -.6450345 .5853396 -1.10 0.270 -1.792279 .50221 -------------+---------------------------------------------------------------- 3.Class | _cons | -.8026907 .6794755 -1.18 0.237 -2.134438 .5290568 -------------+---------------------------------------------------------------- 4.Class | _cons | -3.484714 .5548643 -6.28 0.000 -4.572229 -2.3972 ------------------------------------------------------------------------------ Class : 1 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 5.173031 .0251474 205.71 0.000 5.123743 5.222319 _cons | 41.65574 .161938 257.23 0.000 41.33835 41.97313 -------------+---------------------------------------------------------------- var(e.y)| .0617238 .0076596 .0483975 .0787195 ------------------------------------------------------------------------------ Class : 2 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 1.503764 .0371216 40.51 0.000 1.431007 1.576521 _cons | 65.13498 .2666049 244.31 0.000 64.61244 65.65751 -------------+---------------------------------------------------------------- var(e.y)| .0387473 .0188853 .0149062 .1007195 ------------------------------------------------------------------------------ Class : 3 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 1.441334 .0443892 32.47 0.000 1.354333 1.528335 _cons | 65.26791 .2765801 235.98 0.000 64.72582 65.81 -------------+---------------------------------------------------------------- var(e.y)| .0307352 .010982 .0152578 .0619127 ------------------------------------------------------------------------------ Class : 4 Response : y Model : regress ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- y | ph | 1.665207 .0079194 210.27 0.000 1.649685 1.680728 _cons | 63.42577 .0510052 1243.52 0.000 63.3258 63.52573 -------------+---------------------------------------------------------------- var(e.y)| .000096 .0000769 .00002 .0004611 ------------------------------------------------------------------------------ . estat lcprob Latent class marginal probabilities Number of obs = 300 -------------------------------------------------------------- | Delta-method | Margin Std. Err. [95% Conf. Interval] -------------+------------------------------------------------ Class | 1 | .4991443 .0304808 .4396979 .558615 2 | .2618733 .1506066 .0715338 .6203076 3 | .2236773 .150279 .0501835 .6110804 4 | .015305 .008329 .005234 .0438994 -------------------------------------------------------------- . estat ic Akaike's information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 300 . -188.0604 15 406.1208 461.6776 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note.
