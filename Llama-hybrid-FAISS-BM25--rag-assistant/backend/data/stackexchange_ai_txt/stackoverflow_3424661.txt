[site]: stackoverflow
[post_id]: 3424661
[parent_id]: 3294314
[tags]: 
The problem you are having is that you are expecting an NSApplicationWillTerminateNotification that is not getting sent in 4.0 because NSApplicationDidEnterBackgroundNotification is getting sent instead. I have had the same problem. Register both notifications for your storage function and it will work again. You don't need conditional code since even if you register for a notification that does not exist in 3.0, it will never get called there so there will be no crash. If you are not using notifications you can also override applicationDidEnterBackground : as noted in the above comment.
