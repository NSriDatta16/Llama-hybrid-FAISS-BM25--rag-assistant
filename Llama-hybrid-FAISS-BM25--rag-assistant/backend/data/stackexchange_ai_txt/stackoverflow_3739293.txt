[site]: stackoverflow
[post_id]: 3739293
[parent_id]: 3130450
[tags]: 
A simple query to solve this: SELECT SUM(CASE C1 WHEN 'A' THEN C2 ELSE 0 END) AS 'A', SUM(CASE C1 WHEN 'B' THEN C2 ELSE 0 END) AS 'B', SUM(CASE C1 WHEN 'C' THEN C2 ELSE 0 END) AS 'C', SUM(CASE C1 WHEN 'D' THEN C2 ELSE 0 END) AS 'D' FROM T1 An organic query: DECLARE @C1 CHAR(1), @SQL VARCHAR(500) DECLARE array CURSOR FOR SELECT C1 FROM T1 ORDER BY C1 OPEN array FETCH NEXT FROM array INTO @C1; SET @SQL = 'SELECT SUM(CASE C1 WHEN ''' + @C1 + ''' THEN C2 ELSE 0 END) AS ''' + @C1 + '''' FETCH NEXT FROM array INTO @C1; WHILE (@@FETCH_STATUS = 0) BEGIN SET @SQL = @SQL + ', SUM(CASE C1 WHEN ''' + @C1 + ''' THEN C2 ELSE 0 END) AS ''' + @C1 + '''' FETCH NEXT FROM array INTO @C1 END SET @SQL = @SQL + 'FROM T1' CLOSE array DEALLOCATE array EXEC(@SQL)
