[site]: stackoverflow
[post_id]: 1813965
[parent_id]: 1813889
[tags]: 
When growing the exportlines (I assume it is a string), it doubles the amount of memory taken (original + new value with apppended value). A StringBuilder will suffer from the same problem, only not on every string added, just when the buffer is full. If you want a record of the strings written to the stream, you could create a List and add every line to the list. So you are not doubling (at least), the needed storage. But if the amount of strings is that high, what extra information could you possibly get from it? It is just too much. Also, why do you flush the stream every time?
