[site]: stackoverflow
[post_id]: 3855836
[parent_id]: 3855067
[tags]: 
This replaces only one key, but i want to replace all with the above occurrences. What is the wrong thing i am going with? Normally I'd expect your code to give ConcurrentModificationException . The problem is that you are modifying the map while you are iterating it. The javadoc for HashMap says this: "The iterators returned by all of this class's "collection view methods" are fail-fast: if the map is structurally modified at any time after the iterator is created, in any way except through the iterator's own remove method, the iterator will throw a ConcurrentModificationException . Thus, in the face of concurrent modification, the iterator fails quickly and cleanly, rather than risking arbitrary, non-deterministic behavior at an undetermined time in the future." "Note that the fail-fast behavior of an iterator cannot be guaranteed as it is, generally speaking, impossible to make any hard guarantees in the presence of unsynchronized concurrent modification. Fail-fast iterators throw ConcurrentModificationException on a best-effort basis. Therefore, it would be wrong to write a program that depended on this exception for its correctness: the fail-fast behavior of iterators should be used only to detect bugs." If you look at both my solution and @Colin Herbert's solution in the answers to your previous question , you will see that we carefully record what needs to be changed in separate data structures. Only when the iteration is complete do we make the changes to the original Map. This is critical. Without it the solutions don't work.
