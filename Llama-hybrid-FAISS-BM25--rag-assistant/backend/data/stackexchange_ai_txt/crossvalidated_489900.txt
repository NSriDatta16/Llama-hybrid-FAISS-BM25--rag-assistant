[site]: crossvalidated
[post_id]: 489900
[parent_id]: 489896
[tags]: 
There is a tiny mistake in this line of code: for index in range(0,len(message),3): You don't want to look every 3 bits of the original message, you want to look every 3 bits of the redundant version. So, to get the correct answer we replace this line by: for index in range(0,len(redundancy), 3): The failure rate becomes 0.00532. Now, is this the correct result? We can use the info you provided in the first paragraph to calculate the expected error rate: $$\epsilon = 0.60\cdot0.05+0.40\cdot0.03\approx4.2\%$$ Now, what is the chance that a bit is flipped and is not corrected (that is, the actual failure rate)? $$p=P(\text{2 errors})+P(\text{3 errors})=\binom32\epsilon^2+\epsilon^3\approx0.00537$$ That is pretty close to the simulation answer, so we can be confident that now the simulation works correctly.
