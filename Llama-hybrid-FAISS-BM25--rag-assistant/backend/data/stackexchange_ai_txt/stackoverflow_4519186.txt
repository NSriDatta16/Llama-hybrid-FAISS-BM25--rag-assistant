[site]: stackoverflow
[post_id]: 4519186
[parent_id]: 4515905
[tags]: 
Windows Installer and Custom Actions are hosted via the Service Control Manager which has a long history of not respecting broadcast messages that are sent announcing Environment changes. So even if you fix the immeadiate / deferred problem that Yan mentions you'll find that your custom action still doesn't have the environment variable. Why don't just just pass "[APPLICATIONPATH]myapp" to your .bat file and fetch it in as %2? BTW I also don't reccomend calling batch files from an installer. It's fragile and embarrassing to see installs that run popping up little black windows.
