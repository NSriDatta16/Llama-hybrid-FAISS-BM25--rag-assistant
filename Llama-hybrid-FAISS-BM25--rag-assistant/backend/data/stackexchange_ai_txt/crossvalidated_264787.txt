[site]: crossvalidated
[post_id]: 264787
[parent_id]: 264627
[tags]: 
SAS allows direct access to an adaptive quadrature integration routine from within PROC MCMC via CALL QUAD (if I recall correctly from SAS/STAT version 14.1 or 14.2 onwards) and there are, I believe, presentations online that show an example. Alternatively, you can hand-code some quadrature algorithm (it is really not so bad, if the software allows you to do it). One option is one with a fixed number of intervals, e.g. a composite Simpson's rule, if you can analytically derive some limits on the quality of the approximation (you may have to find a maximum of the fourth derivative over the integration range). Another option is an adaptive quadrature one, which should be fine with most MCMC samplers. An exception may be that this may not work with MCMC samplers that rely on automatically generating derivatives of the posterior (e.g. Stan's NUTS - perhaps I am wrong about that though), while with most other samplers should be fine. Some of these algorithms may require you to remove any singularities from your integral before you apply them, while some automatic integration routines may even do that for you. If a package has an ordinary differential equation solver, then you can try to use that to get solutions to definite integrals. E.g. Stan has two different ODE solvers and I have used them to do numerical integration. I assume some other MCMC software may have an ODE solver, too.
