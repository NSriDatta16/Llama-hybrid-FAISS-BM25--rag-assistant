[site]: crossvalidated
[post_id]: 532957
[parent_id]: 
[tags]: 
Machine Learning Method to Predict Continuous Target Variable with Text Data Using R

Purpose I have a surgery dataset with surgery id (i.e., oid ), the procedure names ( o3.name.procedure ), and the actual duration (i.e. d1.case ). There could be multiple procedures in one surgery, so one surgery id can be associated with multiple procedures names. My goal is to predict the expected case duration using text analysis of procedure names. I am following a tutorial : https://www.pluralsight.com/guides/machine-learning-text-data-using-r . But I have a continuous target variable (duration) instead of indicator target variable (0 or 1) . Below dataset followed the data preparation steps in the above tutorial, but I was wondering what method I can use to predict the continuous target variable after preparing the text data. The following code 'Example Dataset' generates the text data and processes them following the tutorial. In the original dataset, there are 58K unique procedure names for total 155K observations associated with 77K surgeries. Each surgery may contain 1 to 10 procedures. Each procedure name may contain main procedure name and additional details associated with the particular surgery. The main procedure name is not separated and is not identified in the dataset. Example Dataset procedures 250 GRAMS**LAPAROSCOPIC MYOMECTOMY**", "EXPLORATORY LAPAROTOMY, EXPLORATORY CELIOTOMY WITH OR WITHOUT BIOPSY - WASHOUT **Exploratory laparotomy with abdominal washout, opening of the vaginal cuff with placement of 30' mushroom drain to vagina**", "LUMBAR LAMINOTOMY W/PARTL FACETECTOMY/FORAMINOTOMY/HERNIATED DISKECTOMY, RE-EXPLORE, 1 INTERSPACE;(C-ARM) (REVISION RIGHT L5-S1 MICRODISCECTOMY)", "PERCUTANEOUS SKELETAL FIXATION OF POSTERIOR PELVIC BONE FX/DISLOCATION,FOR FX PATTERNS/DISRUPT PELVIC RING", "LAPAROSCOPY; W/FULGURATION OF OVIDUCTS (W/WO TRANSECTION)(TUBAL LIGATION) **LAPAROSCOPIC BILATERAL TUBAL LIGATION **", "THROMBECTOMY, OPEN, ARTERIOVENOUS FISTULA W/O REVISION, AUTOGENOUS/NONAUTOGENOUS DIALYSIS GRAFT (C-ARM) **RIGHT THIGH ARTERIOVENOUS GRAFT DECLOT WITH VENOGRAM**BALLON ANGIOPLASTY REVISION**", "CORONOIDECTOMY (MANDIBLE)", "LAMINECTOMY W/DECOMPRESSION, SINGLE VERTEBRAL SEGMENT; LUMBAR**L4-5 AND L5-S1 OPEN DECOMPRESSION, FROM THE LEFT**", "PELVIC EXAM UNDER ANESTHESIA (OTHER THAN LOCAL)**PELVIC EXAM UNDER ANESTHESIA; POSSIBLE CERVICAL BIOPSY**", "LAMINOTOMY(HEMILAMINECTOMY) W/DECOMPRESSION OF NERVE ROOT(S),INCLUD PART FACETECTOMY, 1 INTERSPACE LUMBAR (REVISION RIGHT L4-5 MICRODISCECTOMY)", "DESTRUCTION BY NEUROLYTIC AGENT,PARAVERTEBRAL FACET JOINT NERVE W/FLURO; LUMBAR OR SACRAL, EACH ADD`L LEVEL (64636 X 2)", "CYSTOURETHROSCOPY, W/FULGURATION/RESECTION OF; MEDIUM BLADDER TUMOR(S)(2.0-5.0 CM)*CYSTOSCOPY,TRANSURETHRAL RESECTION OF BLADDER TUMOR,POSSIBLE LEFT URETERAL STENT PLACEMENT*", "TREATMENT OF MISSED ABORTION SECOND TRIMESTER", "UNLISTED PROCEDURE, DENTOALVEOLAR STRUCTURES*DENTAL RESTORATION*", "REVASCULARIZATION,ENDOVASCULAR,OPEN OR PERCUTANEOUS,FEMORAL,POPLITEAL ARTERY(S),UNILATERAL,WITH TRANSLUMINAL STENT PLACEMENT(S),INCLUDES ANGIOPLASTY WITHIN THE SAME VESSEL,WHEN PERFORMED**RIGHT LEG INTERVENTION**", "EXPLORATION OF PENETRATING WOUND; NECK*left neck exploration*", "OPEN TREATMENT OF CLAVICULAR FRACTURE, INCLUDES INTERNAL FIXATION,WHEN PERFORMED**OPEN REDUCTION AND INTERNAL FIXATION OF RIGHT CLAVICLE**", "INSERTION OF INFLATABLE URETHRAL/BLADDER NECK SPHINCTER, INCLUDING PUMP, RESERVOIR AND CUFF **PLACEMENT OF ARTIFICIAL URINARY SPHINCTER**", "Surgical fixation of left humerus", "COLPOCLEISIS (LE FORT TYPE)**CYSTOSCOPY, COLPOCLEISIS (LEFORT TYPE)**" ) set.seed(10002) procedure % rename( oid = case, o3.name.procedure = procedure, d1.case = duration ) %>% group_by(oid) %>% # I collapse the procedures names by each surgery id summarise( word = paste0(o3.name.procedure, collapse = "|"), no = length(o3.name.procedure), d1.case = mean(d1.case) ) %>% filter(!is.na(d1.case)) ## Preparing Data for Modeling # Step 1 - Create the Text Corpus corpus = Corpus(VectorSource(df $word)) corpus[[1]][1] df$ d1.case[1] # Step 2 - Conversion to Lowercase corpus = tm_map(corpus, PlainTextDocument) corpus = tm_map(corpus, tolower) corpus[[1]][1] # Step 3 - Removing Punctuation corpus = tm_map(corpus, removePunctuation) corpus[[1]][1] # Step 4 - Removing Stopwords corpus = tm_map(corpus, removeWords, c("w", "wo", "wwo", stopwords("english"))) corpus[[1]][1] # Step 5 - Stemming corpus = tm_map(corpus, stemDocument) corpus[[1]][1] ## Create Document Term Matrix frequencies = DocumentTermMatrix(corpus) sparse = removeSparseTerms(frequencies, 0.995) ### The final data preparation step is to convert the matrix into a data frame, ### a format widely used in 'R' for predictive modeling. tSparse = as.data.frame(as.matrix(sparse)) colnames(tSparse) = make.names(colnames(tSparse)) tSparse $duration = df$ d1.case # adding the dependent variable ## Now we are ready for building the predictive model. ## set the baseline accuracy --- note: it works for 0 and 1 indicator dependent variable prop.table(table(tSparse$duration)) ## Creating Training and Test Data for Machine Learning set.seed(100) split = sample.split(tSparse$duration, SplitRatio = 0.7) # keeps 70% of the data for training the model. trainSparse = subset(tSparse, split==TRUE) testSparse = subset(tSparse, split==FALSE) } The post has been migrated from https://stackoverflow.com/questions/68211593/machine-learning-method-to-predict-continuous-target-variable-with-text-data-usi?noredirect=1#comment120555438_68211593
