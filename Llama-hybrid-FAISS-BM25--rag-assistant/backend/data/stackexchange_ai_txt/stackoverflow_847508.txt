[site]: stackoverflow
[post_id]: 847508
[parent_id]: 847469
[tags]: 
Depends on which OS etc. etc. but in most cases what you can do is copy to a temporary file name and as the last final step rename the files to the correct name. This means the (WOOPS) Window of Opertunity Of Potential S****p is confined to the interval when the renames take place. If the OS supports a nice directory structure and you lay out the files intelligently you can further refine this by copying the new files to a temp directory and renaming the directory so the WOOPS becomes the interval between "rename target to save" and "rename temp to target". This gets even better if the OS supports Soft link directories then you can "ln -s target temp". On most OSes replacing a softlink will be an "atomic" operation which will work or not work without any messy halfway states. All these options depend on having enough storage to keep a complete old and new copy on the file system.
