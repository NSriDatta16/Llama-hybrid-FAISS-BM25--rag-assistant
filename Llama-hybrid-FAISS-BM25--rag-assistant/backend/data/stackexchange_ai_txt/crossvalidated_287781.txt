[site]: crossvalidated
[post_id]: 287781
[parent_id]: 
[tags]: 
Calculating $P(C=F|B=F, G=-2.9)$ in a Bayesian network

I have a network of the following form: $$ [B:{\rm Binary}]\rightarrow [C:{\rm Binary}]\rightarrow [G:{\rm Gaussian}] $$ $[]$ is a node and the arrows show dependency. In this situation, the Gaussian node is a mixture of two Gaussian's since it has a binary parent. I have some training data and use it to learn the parameters of the model. I can do this by hand, and also using a toolbox in MATLAB. The results I get with both are the exact same. Probability tables: \begin{align} \newcommand{\mean}{{\rm mean}} \newcommand{\cov}{{\rm cov}} B({\rm True}) &= 0.5 \\ C(T|B=T) &= 0, &C(T|B=F) &= 1 \\ C(F|B=T) &= 0.5, &C(F|B=F) &= 0.5 \\ G(C=F) &= \mean + \cov = 0.5667 + -7.8789 \\ G(C=T) &= \mean + \cov = -3.2 + -0.01 \end{align} However when I'm performing inference, the MATLAB toolbox gives me a different result than what I do by hand. I'm trying to calculate $P(C=F|B=F,\ G=-2.9)$. I use the following: (Bayes' law) $$P(C=F|B=F, G=-2.9) = \frac{P(B,G|C)P(C)}{P(B,G)}$$ (Marginalization over $C$) $$\ldots= \frac{P(B,G|C)P(C)}{\sum C(P(B,G|C))}$$ $$\ldots= \frac{P(B,G|C)P(C)}{(P(B,G|C)P(C)+P(B,G|\neg C)P(\neg C))}$$ (Conditional Independence between $F$ and $G$ given $C$) $$\ldots= \frac{P(B|C)P(G|C)P(C)}{(P(B|C)P(G|C)P(C)+P(B|\neg C)P(G|\neg C)P(\neg C))}$$ (due to the direction of dependence in the graph, therefore it cancels out of the equation) $$\ldots\ P(B|C) = P(B)$$ $$\ldots = \frac{P(G|C)P(C)}{(P(G|C)P(C)+P(G|\neg C)P(\neg C))}$$ We can calculate $P(G|C)$ from the specific PDF, and $P(C)$ from marginalization using $\sum F(P(C|B))$. \begin{align} P(C=F) &= 0.75, &P(C=T) &= 0.25 \\ P(G=-2.9|C=F) &= 0.0663, &P(G=-2.9|C=T) &= 0.0443 \end{align} My final solution is: $0.0663\times 0.75/(0.0663\times 0.75 + 0.0443\times 0.25) = 0.8178$ The solution that the MATLAB program is giving me is: $0.5993$. The MATLAB program is the BNET toolbox, so I'm more inclined to think I'm doing something wrong in my calculation. But I just can't figure out what it is.
