[site]: crossvalidated
[post_id]: 200109
[parent_id]: 
[tags]: 
predicted vs expected values using lmer in R

I am running a multilevel model with several interactions and a binary treatment. To summarize the model I would like to compute the first differences between treatment (1) and control group (0) using simulations (to get a good approximation to the confidence intervals). Using the distinction pointed out by King et al. 2000 (Making the most of statistical analysis: improving interpretation and presentation) between predicted values (they contained both fundamental and estimation uncertainty), and expected value (averages over the fundamental variability leaving only the estimation uncertainty caused by not having an infinite number of observations. Thus, the predicted values have a larger variability than the expected values. Moreover, a first difference is the difference between two expected rather than predicted values. I am trying to get first differences using R and lme4 . Here an example to predict and get expected values: # create data set.seed (1) J I am trying to get the expected values (and confidence intervals) when x = 2. I would like to take into account the uncertainty of the random effect, but I am not sure if that is possible or appropriate, and if sampling groups is the best way to deal with the estimation of random effects. First, I use the simulate function (I don't exactly the difference betwen simulate and bootmer ): # simulate pred1 The difference between methods are big. Using the bootmer function: pred2 The histogram of expected values looks weird when using bootmer : I am getting the same values several times... Any suggestions, comments, ideas?
