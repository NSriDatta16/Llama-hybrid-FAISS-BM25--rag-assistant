[site]: stackoverflow
[post_id]: 2884718
[parent_id]: 
[tags]: 
T-SQL Question - Counting and Average

I have a set of data that consists of a filenbr, open date and close date. I need to produce a summary table similar to the below, i need to count how many files belong to each day period, but i need those greater than 20 grouped together. I know how to get the datediff, what i'm stumbling on is how to get the 20+ and the % column 1 day - 30 files - 30% 3 days - 25 files - 25% 10 days - 5 files - 5% 13 days - 20 files - 20% >= 20 days - 20 files - 20%
