[site]: crossvalidated
[post_id]: 543434
[parent_id]: 
[tags]: 
Test for difference at each time point in panel data of long time series?

The easiest way to describe my question is perhaps with plots: In this hypothetical data, each group has 9 subjects, and each subject's response is measured from time = 1… to 5. Is there a way to test whether the two group differ in response at each time point in such a longitudinal data (the actual data is much longer though ---more than 1000 time points for each group)? Initial thought was to use linear mixed effects model, and treat "time" as discrete dummies (shown in the R command at the end) so that the difference of the two group can be tested at each time point, like this post . But in the actual data, the model with individual time dummies (interacting with the group indicator) do not fit the data well (*); distribution of residuals is unimodal and symmetric, but far from normally distributed --- it looks like a "cathedral" where a lot of residuals clustering in the middle, but not like a bell curve. Are there any methods that you'd recommend to test difference at each time point in panel data with long time series? For example, ignoring the within-subject correlation of each group for the moment, and then test the difference between control and experiment at each time point, and then come up with a way to adjust the p-value to account for the fact that response at time (n+1) is not independent from time (n) within each group? The aforementioned post used linear mixed model to compare response at each time point, but it has 1000). I've also searched for "linear mixed model time series" but somehow unable to find posts on exactly the same question. (*) In addition to the poor fit of the mixed model with time dummy variables, multiplicity is another big issue. There are more than 1000 time points, implying 1000+ tests to be conducted at the same time…. I am not too familiar with method for correcting multiple testing, but I am afraid that most of the tests will be shown as not statistically significant, even though there is genuine difference. Reproducible codes for this simulation data set are shown below. Thanks so much for your input. # Data generation process for the control group f1 1000) x % map_dbl(f1), id = (10 +1:9 %>% map(.f= ~rep(.x,5)) %>% unlist()), group = "control") # Assuming there are 9 subjects in experiment group g2 % map_dbl(f2), id = (20 +1:9 %>% map(.f= ~rep(.x,5)) %>% unlist()), group = "experiment") fig1 % ggplot(aes(x = time, y = response, color = as.factor(id))) + geom_line() + ggtitle("control") fig2 % ggplot(aes(x = time, y = response, color = as.factor(id))) + geom_line() + ggtitle("experiment") cowplot::plot_grid(fig1, fig2) dat_sim
