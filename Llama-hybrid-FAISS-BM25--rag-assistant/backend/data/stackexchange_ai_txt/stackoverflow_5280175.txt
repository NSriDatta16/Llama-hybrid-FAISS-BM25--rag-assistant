[site]: stackoverflow
[post_id]: 5280175
[parent_id]: 
[tags]: 
How to use ruby ffi for calling custom c code in a ruby gem

I want to create a ruby gem that calls a c function I have written. For example: int func(int x) { return x * 2; } This would be in a c file in my rubygem. I would then want to be able to call it in ruby, by wrapping it with the ffi interface: module TestModule extend FFI::Library ffi_lib 'MyLib' attach_function 'func', [:int], :int end However I'm not sure how to set this up, so that when the gem is installed the c file would compile into a library (with the name 'MyLib'), and the ffi will detect the library and use it in the code above. Does anyone know how to do this, or is there a better way of going about this? Note that I would rather not use the standard way of extending ruby (as described in the The Pragmatic Programmer's Guide Extending Ruby section ) since that only will work with the standard ruby interpretor (I believe). I have been using jeweler for building my gems, if that matters for this question.
