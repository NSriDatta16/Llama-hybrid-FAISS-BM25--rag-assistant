[site]: crossvalidated
[post_id]: 386227
[parent_id]: 
[tags]: 
Random effect implicitly nested in a fixed effect

In a very lucid and informative answer to a question about nested versus crossed random effect Crossed vs nested random effects: how do they differ and how are they specified correctly in lme4? (posted on 8 August 2016) Robert Long used a classes within schools example to illustrate the syntax to use in lmer() when the data are coded so that the nesting is "implicit". In this example school , as well as class is a random effect. I need to deal with an example analogous to that in which school gets treated as a fixed effect. I think I have the syntax correct, but I would like to have this confirmed (if someone would be so kind). First, to get the data that Robert Long used: dt Now create (as Robert Long did) an "explicitly nested" class factor: dt $classID school, dt$class, sep=".") Now I'd like to fit simple examples in which school is the only fixed effect predictor. fit.expl Is the latter fit the correct way of dealing with implicit nesting of random effect within a fixed effect? The two fits seem to agree. The extractors fixef() , ranef() and logLik() seem to give the same results from the two fits (modulo some differences in labelling). Are there any Traps for Young Players lurking around that I have failed to take into account?
