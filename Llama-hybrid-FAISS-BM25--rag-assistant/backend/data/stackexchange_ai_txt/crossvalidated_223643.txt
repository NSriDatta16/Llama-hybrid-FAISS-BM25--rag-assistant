[site]: crossvalidated
[post_id]: 223643
[parent_id]: 
[tags]: 
Variance structure with GLMMPQL

I want to know the influence of different climate variables on the abundance of berries. I have an average number of berries per plot and a number of plot per site (unbalanced design) for a number of years. Noted that the climate variables are the same for each site. After doing a backward selection with different climate variables, I created my final model as follow. The theta was found using glm.nb PQL However, when I plot the fitted values against the residual I obtain the following graph where residuals variance increase with fitted values. To correct for heteroscedasticity, I would like to modify the variance structure so that it increases with increasing fitted values, I thus specify the argument weight with: VS My new formula is than: PQL but I get the following error code: Error in negative.binomial(theta = 3.222, link = log, weight = VS1) : unused argument (weights = VS1) Why is it not using the argument weight? Is it a problem with my database or one with the formula? Thanks for your help! EDIT: Here is a reproducible example with a subset of my database. I am using R version 3.3.1 (2016-06-21) Platform: x86_64-apple-darwin13.4.0 (64-bit), Running under: OS X 10.11.5 (El Capitan) library(nlme) library(MASS) #The dataset ENIG
