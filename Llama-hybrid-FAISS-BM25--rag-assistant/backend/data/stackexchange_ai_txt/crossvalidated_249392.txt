[site]: crossvalidated
[post_id]: 249392
[parent_id]: 
[tags]: 
How to calculate causal inference in bayesian networks

As beginner I am reading this Bayesian Networks example . I have also read this question . It calculates $P(S=1,W=1)$, the result is $0.2781$. I tried to expand the equation, but getting incorrect result: $P(W,S) = P(W|S) \cdot P(S)$ $P(W,S) = ( P(W|S,R) \cdot P(R) + P(W|S,\bar{R}) \cdot P(\bar{R}) ) \cdot P(S)$ $P(R) = P(R|C) \cdot P(C) + P(R|\bar{C}) \cdot P(\bar{C})$ $P(R) = 0.8 \cdot 0.5 + 0.2 \cdot 0.5 = 0.5$ $P(\bar{R}) = 1 - 0.5 = 0.5$ $P(S) = P(S|C) \cdot P(C) + P(S|\bar{C}) \cdot P(\bar{C})$ $P(S) = 0.1 \cdot 0.5 + 0.5 \cdot 0.5 = 0.3$ $P(W|S,R) = 0.99$ $P(W|S,\bar{R}) = 0.9$ $P(W,S) = (0.99 \cdot 0.5 + 0.9 \cdot 0.5) \cdot 0.3 = 0.2835 \neq 0.2781$ What is wrong with my calculation? May I start with $P(W,S)$ for the $P(S=1,W=1)$? Then how to solve $P(W=1) = 0.6471$?
