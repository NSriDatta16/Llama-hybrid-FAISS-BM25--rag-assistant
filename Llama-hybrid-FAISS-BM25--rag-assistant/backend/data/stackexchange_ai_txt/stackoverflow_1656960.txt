[site]: stackoverflow
[post_id]: 1656960
[parent_id]: 1655560
[tags]: 
What you are trying to do, is split your data into "batches". For example, you are operating on "batches" whenever you read "lines" off a file. What defines a "line"? It's a sequence of bytes terminated by '\n'. Another example is: you read 64KiB "chunks" off a file. What defines a "chunk"? You do, since you read 65536 bytes every time. You want a variable length "chunk"? You just prefix your "chunk" with its size, then read the "chunk". "aiff" files (whose implementations are also the .wav and .avi files of MS Windows) and "mov" files are organized like that. These three methods are the most fundamental methods to organize a stream of bytes, whatever the medium: record separators fixed size records records prefixed with their size. They can be mixed and/or modified. For example, you could have "variable record separators", like an XML reader: read bytes from first ' ', add a slash after first ' Choose a method, and implement it in both the writer and reader. If you also document your choices, you've just defined your first protocol.
