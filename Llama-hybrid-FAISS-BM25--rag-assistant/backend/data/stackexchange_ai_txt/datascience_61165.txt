[site]: datascience
[post_id]: 61165
[parent_id]: 
[tags]: 
How do I use Cohen's Kappa as a metric in a keras model for continuous output?

I am using keras to train a CNN on a dataset. The output should be a value from 0 to 4 and my training y values are integers in that range. I want to create a custom metric that rounds and clips my conintuous output to an integer value in that range and calculates a cohen kappa value. custom_metrics.py def cohen_kappa_integerized(y_true, y_pred, num_classes=5, weights=None, metrics_collections=None, updates_collections=None, name=None): kappa, update_op = tensorflow.contrib.metrics.cohen_kappa( y_true, clip(rint(y_pred), 0, 4), num_classes, weights, metrics_collections, updates_collections, name ) K.get_session().run(tensorflow.local_variables_initializer()) with tensorflow.control_dependencies([update_op]): kappa = tensorflow.identity(kappa) return kappa My code returns a value that does not match up to my accuracy metric very well so it "seems" to not be working. I pieced this together from a few sources and have never written a custom metric before, so a basic mistake is likely. Here are the metrics from my run. cohen kappa mean squared error
