[site]: stackoverflow
[post_id]: 5393384
[parent_id]: 5393200
[tags]: 
You could first group the data by group and then, in a nested query, by animal to calculate the average of the deltas: var result = from data in Data.AsEnumerable() group data by data.Field ("group") into g select new { gp = g.Key, average = ( from item in g group item by data.Field ("animal") into f select f.Max(c => double.Parse(c.Field ("numbers"))) - f.Min(c => double.Parse(c.Field ("numbers"))) ).Average() };
