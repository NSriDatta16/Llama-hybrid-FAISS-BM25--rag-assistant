[site]: stackoverflow
[post_id]: 4234057
[parent_id]: 
[tags]: 
Optimize an ORDER BY query

I'm at a loss. I have a table with about 100K rows. When querying this table results are usually snappy, about 2ms or so. But whenever I use an ORDER BY performance drops like a rock to about 120ms. I read the MySQL ORDER BY Optimization page but I can't say I understand everything. Especially the indexes are unclear to me. Ultimately I would like to run the following query: SELECT * FROM `affiliate_new_contracts` WHERE phone_brand IN ('Apple','Blackberry','HTC','LG','Motorola','Nokia', 'Samsung','Sony Ericsson') AND contract_length IN ('12','24') AND (addon IS NULL OR addon IN('Telfort Sms 300','Surf & Mail')) AND (plan_name = 'Telfort 100' AND credible_shop = 1 ) ORDER BY average_price_per_month ASC, phone_price_guestimate DESC, contract_length ASC; But I would be happy if I understood the underlying principles. Removing the ORDER BY clause in the previous query makes it run in 20ms in stead of 120ms. I have an index on the average_price_per_month field but simplifying the ORDER BY clause to ORDER BY average_price_per_month yielded no performance increase. That I don't understand. I'm also in the dark about the so called multi column indexes which should be able to help me with the ultimate query. Any help would be appreciated. How do I make this bad boy perform? Or is that quest utopian? The CREATE TABLE syntax is as follows: $ show create table affiliate_new_contracts; CREATE TABLE `affiliate_new_contracts` ( `id` int(11) NOT NULL AUTO_INCREMENT, `plan_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `contract_length` int(11) DEFAULT NULL, `phone_brand` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `price` float DEFAULT NULL, `average_price_per_month` float DEFAULT NULL, `phone_price_guestimate` float DEFAULT NULL, `credible_shop` tinyint(1) DEFAULT '0', `addon` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `addon_price` float DEFAULT NULL, PRIMARY KEY (`id`), KEY `index_affiliate_new_contracts_on_plan_name` (`plan_name`), KEY `index_affiliate_new_contracts_on_average_price_per_month` (`average_price_per_month`), KEY `index_affiliate_new_contracts_on_price` (`price`) ) ENGINE=InnoDB AUTO_INCREMENT=2472311 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci BTW This table is recreated weekly and is not updated in the meanwhile.
