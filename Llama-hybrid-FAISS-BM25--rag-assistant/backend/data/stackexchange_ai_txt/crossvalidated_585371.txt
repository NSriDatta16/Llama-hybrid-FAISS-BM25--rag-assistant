[site]: crossvalidated
[post_id]: 585371
[parent_id]: 
[tags]: 
Is it valid to move a logarithm inside of an expectation?

I have the following derivation for a latent variable model . $$ \newcommand{\d}[1]{\mathrm{d}#1} $$ $$ \begin{align*} \mathbb{E}_{q(x_0)}\left[-\log p_\theta(x_0)\right]\\ &=^{1.} \mathbb{E}_{q(x_0)}\left[-\log \int p_\theta(x_{0:T}) \d{x}_{1:T}\right]\\ &= \mathbb{E}_{q(x_0)}\left[-\log \int \frac{q(x_{1:T})}{q(x_{1:T})}p_\theta(x_{0:T}) \d{x}_{1:T}\right]\\ &= \mathbb{E}_{q(x_0)}\left[-\log \mathbb{E}_{q(x_{1:T})}\left[\frac{p_\theta(x_{0:T})}{q(x_{1:T})}\right] \right]\\ \end{align*} $$ Pull in the latent variables by marginalizing $p_\theta(x_0)$ with respect to $x_{1:T}$ I'm wondering, is it a valid move to do the following: $$ \mathbb{E}_{q(x_0)}\left[-\mathbb{E}_{q(x_{1:T})}\left[\log \frac{p_\theta(x_{0:T}}{q(x_{1:T})}\right]\right] $$ I.e., I want to move the log inside of the expectation. It seems invalid because log(average(1, 2, 3)) != average(log(1), log(2), log(3)) But in the linked paper, the final equation is so, I suspect it must be possible.
