[site]: crossvalidated
[post_id]: 548980
[parent_id]: 
[tags]: 
Parameter Optimization in RF and rpart

I am using rpart and random forest in R to predict GPA (regression tree). On what basis do I decide the value of cp, minsplit, and minbucket? And on what basis do I decide the values of mtry and ntree for the random forest? My dataset is 3000x10 which means there are 3000 observations, 9 independent variables, and 1 dependent variable (GPA). I also ran the following code: minsplit $minsplit[i] maxdepth maxdepth[i] # train a model and store in the list girls_models[[i]] $cptable[, "xerror"]) cp cptable[min, "CP"] } # function to get minimum error get_min_error $cptable[, "xerror"]) xerror cptable[min, "xerror"] } hyperparam_grid % mutate( cp = purrr::map_dbl(girls_models, get_cp), error = purrr::map_dbl(girls_models, get_min_error) ) %>% arrange(error) %>% top_n(-5, wt = error) #Check model: optimal_girls Sample data: dput(head(df,20)) structure(list(Gender = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), WJ10 = structure(c(98, 97.9222255459168, 97.9222255459168, 92, 102, 97.9222255459168, 117, 97.9222255459168, 82, 97.9222255459168, 96, 78, 106, 122, 98, 103, 98, 86, 97, 103), label = "Woodcock Johnson Test 10 standard score", format.stata = "%18.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1), class = c("haven_labelled", "vctrs_vctr", "double")), Grit = c(3, 3.42277664630007, 3.42277664630007, 3.75, 3.75, 3.42277664630007, 3.5, 3.42277664630007, 2, 4, 4, 4, 4, 3.75, 3.5, 4, 2.5, 3.25, 4, 3.25), Selfcontrol = c(3.8, 2.9086858882956, 2.9086858882956, 2.9086858882956, 3, 2.9086858882956, 2.7, 2.9086858882956, 1.1, 2.9086858882956, 2.8, 2.9086858882956, 2.9086858882956, 3, 1.78847016599372, 2.5, 2.6, 2.9086858882956, 3.3, 2.9086858882956 ), Attention = c(3, 2.6345624411902, 2.6345624411902, 2.5, 2.8, 2.6345624411902, 2.7, 2.6345624411902, 1.3, 2.6345624411902, 2.7, 2.9, 2.8, 3, 3, 2.9, 2.9, 2.4, 3, 2.9), PCG_Income = structure(c(1e+05, 60643.8736017897, 60643.8736017897, 10000, 24000, 60643.8736017897, 3e+05, 60643.8736017897, 165000, 90000, 7923, 26000, 24000, 68000, 65000, 2e+05, 33308, 80000, 2856, 27600), label = "Constructed - PCG's household income (with imputed values)", format.stata = "%15.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1), class = c("haven_labelled", "vctrs_vctr", "double")), PCG_Education = structure(c(2, 2.63777089783282, 2.63777089783282, 2, 1, 2.63777089783282, 4, 2.63777089783282, 3, 3, 3, 1, 1, 4, 2, 4, 3, 1, 2, 3), label = "Constructed - PCG's education: year 15", format.stata = "%18.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1, `1 less HS` = 1, `2 HS or equiv` = 2, `3 Some coll, tech` = 3, `4 coll or grad` = 4), class = c("haven_labelled", "vctrs_vctr", "double")), IPC = c(NA, 0.00864548759285601, 0.00864548759285601, NA, NA, 0.00864548759285601, NA, 0.00864548759285601, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), P_AI = c(3.5, 2.89188260698861, 2.89188260698861, 3, 3, 2.89188260698861, 3.5, 2.89188260698861, 3.33333333333333, 3.5, 4, 2.5, 3, 3, 3, 2.66666666666667, 2, 2, 4, 2.66666666666667), PW = c(4, 2.87519700551615, 2.87519700551615, 3, 4, 2.87519700551615, 3, 2.87519700551615, 3, 4, 4, 2, 3, 2.5, 2.5, 2.33333333333333, 2.5, 3, 3.5, 3), PCG_CC = c(1, 1.5, 1.5, 1.5, 1.5, 1.5, 1, 1.5, 1, 1.5, 1.5, 1.5, 1, 2, 2, 1, 1.5, 1.5, 2.5, 2.5), AM = c(1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0), GPA = c(3.5, 3, 3, 3.25, 3.5, 3, 3.5, 3, 3.25, 3.5, 3, 2.75, 2.75, 4, 2.75, 3.25, 3.25, 3.25, 3.25, 2.75)), row.names = c(NA, -20L), groups = structure(list(.rows = structure(list(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L), ptype = integer(0), class = c("vctrs_list_of", "vctrs_vctr", "list"))), row.names = c(NA, -20L), class = c("tbl_df", "tbl", "data.frame")), class = c("rowwise_df", "tbl_df", "tbl", "data.frame")) > dput(head(ffc.girl1,20)) structure(list(Gender = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), WJ10 = structure(c(97.9222255459168, 114, 97.9222255459168, 95, 97.9222255459168, 97.9222255459168, 97.9222255459168, 117, 112, 89, 114, 97.9222255459168, 85, 88, 97.9222255459168, 97.9222255459168, 97.9222255459168, 76, 88, 86), label = "Woodcock Johnson Test 10 standard score", format.stata = "%18.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1), class = c("haven_labelled", "vctrs_vctr", "double")), Grit = c(2.75, 4, 3.42277664630007, 4, 4, 3.42277664630007, 3.42277664630007, 3, 4, 3.5, 3.25, 3.42277664630007, 3.25, 3.5, 3.5, 3.42277664630007, 4, 3.75, 3.75, 3.75), Selfcontrol = c(2.9086858882956, 3.7, 2.9086858882956, 2.9, 2.9086858882956, 2.9086858882956, 2.9086858882956, 3.2, 2.4, 2.5, 2.9086858882956, 2.9086858882956, 2.9086858882956, 2.9086858882956, 2.1, 2.9086858882956, 2.9086858882956, 2.9086858882956, 2.9086858882956, 2.1), Attention = c(2.6345624411902, 2.2, 2.6345624411902, 2.9, 2.6345624411902, 2.6345624411902, 2.6345624411902, 2.9, 3, 2.4, 2.9, 2.6345624411902, 2.9, 2.9, 3, 2.6345624411902, 2.6345624411902, 2.9, 2.5, 3), PCG_Income = structure(c(106285, 49000, 60643.8736017897, 28505, 120000, 60643.8736017897, 60643.8736017897, 105000, 120236, 14000, 40000, 60643.8736017897, 14449, 42000, 26000, 60643.8736017897, 56000, 14020, 29000, 2989), label = "Constructed - PCG's household income (with imputed values)", format.stata = "%15.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1), class = c("haven_labelled", "vctrs_vctr", "double")), PCG_Education = structure(c(3, 2, 2.63777089783282, 3, 4, 2.63777089783282, 2.63777089783282, 3, 3, 3, 4, 2.63777089783282, 2, 2, 3, 2.63777089783282, 4, 3, 3, 3), label = "Constructed - PCG's education: year 15", format.stata = "%18.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1, `1 less HS` = 1, `2 HS or equiv` = 2, `3 Some coll, tech` = 3, `4 coll or grad` = 4), class = c("haven_labelled", "vctrs_vctr", "double")), IPC = c(0.00864548759285601, NA, 0.00864548759285601, NA, 0.00864548759285601, 0.00864548759285601, 0.00864548759285601, NA, NA, NA, NA, 0.00864548759285601, NA, NA, NA, 0.00864548759285601, 0.00864548759285601, NA, NA, NA), P_AI = c(2, 2, 2.89188260698861, 4, 3, 2.89188260698861, 2.89188260698861, 3, 2, 2.5, 3, 2.89188260698861, 2.5, 2, 2, 2.89188260698861, 2, 2.5, 3, 2.5), PW = c(1.33333333333333, 4, 2.87519700551615, 4, 3, 2.87519700551615, 2.87519700551615, 4, 1, 3.5, 2.5, 2.87519700551615, 2.5, 1, 2, 2.87519700551615, 2.5, 3.5, 3, 2.5), PCG_CC = c(2, 1, 1.5, 1, 1.5, 1.5, 1.5, 1, 1, 2, 1.5, 1.5, 2, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5), AM = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), GPA = c(3, 4, 3, 3.25, 3.75, 3, 3, 1.75, 3.25, 3.25, 4, 3, 2.5, 2.25, 2.75, 3, 3.25, 2.25, 1.5, 2)), row.names = c(NA, -20L), groups = structure(list( .rows = structure(list(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L), ptype = integer(0), class = c("vctrs_list_of", "vctrs_vctr", "list"))), row.names = c(NA, -20L), class = c("tbl_df", "tbl", "data.frame")), class = c("rowwise_df", "tbl_df", "tbl", "data.frame")) > dput(head(ffc.girl1_train, 20)) structure(list(Gender = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), WJ10 = structure(c(98, 97.9222255459168, 97.9222255459168, 92, 102, 97.9222255459168, 117, 97.9222255459168, 82, 97.9222255459168, 96, 78, 106, 122, 98, 103, 98, 86, 97, 103), label = "Woodcock Johnson Test 10 standard score", format.stata = "%18.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1), class = c("haven_labelled", "vctrs_vctr", "double")), Grit = c(3, 3.42277664630007, 3.42277664630007, 3.75, 3.75, 3.42277664630007, 3.5, 3.42277664630007, 2, 4, 4, 4, 4, 3.75, 3.5, 4, 2.5, 3.25, 4, 3.25), Selfcontrol = c(3.8, 2.9086858882956, 2.9086858882956, 2.9086858882956, 3, 2.9086858882956, 2.7, 2.9086858882956, 1.1, 2.9086858882956, 2.8, 2.9086858882956, 2.9086858882956, 3, 1.78847016599372, 2.5, 2.6, 2.9086858882956, 3.3, 2.9086858882956 ), Attention = c(3, 2.6345624411902, 2.6345624411902, 2.5, 2.8, 2.6345624411902, 2.7, 2.6345624411902, 1.3, 2.6345624411902, 2.7, 2.9, 2.8, 3, 3, 2.9, 2.9, 2.4, 3, 2.9), PCG_Income = structure(c(1e+05, 60643.8736017897, 60643.8736017897, 10000, 24000, 60643.8736017897, 3e+05, 60643.8736017897, 165000, 90000, 7923, 26000, 24000, 68000, 65000, 2e+05, 33308, 80000, 2856, 27600), label = "Constructed - PCG's household income (with imputed values)", format.stata = "%15.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1), class = c("haven_labelled", "vctrs_vctr", "double")), PCG_Education = structure(c(2, 2.63777089783282, 2.63777089783282, 2, 1, 2.63777089783282, 4, 2.63777089783282, 3, 3, 3, 1, 1, 4, 2, 4, 3, 1, 2, 3), label = "Constructed - PCG's education: year 15", format.stata = "%18.0g", labels = c(`-9 Not in wave` = -9, `-8 Out of range` = -8, `-7 N/A` = -7, `-6 Skip` = -6, `-5 Not asked` = -5, `-4 Multiple ans` = -4, `-3 Missing` = -3, `-2 Don't know` = -2, `-1 Refuse` = -1, `1 less HS` = 1, `2 HS or equiv` = 2, `3 Some coll, tech` = 3, `4 coll or grad` = 4), class = c("haven_labelled", "vctrs_vctr", "double")), IPC = c(NA, 0.00864548759285601, 0.00864548759285601, NA, NA, 0.00864548759285601, NA, 0.00864548759285601, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), P_AI = c(3.5, 2.89188260698861, 2.89188260698861, 3, 3, 2.89188260698861, 3.5, 2.89188260698861, 3.33333333333333, 3.5, 4, 2.5, 3, 3, 3, 2.66666666666667, 2, 2, 4, 2.66666666666667), PW = c(4, 2.87519700551615, 2.87519700551615, 3, 4, 2.87519700551615, 3, 2.87519700551615, 3, 4, 4, 2, 3, 2.5, 2.5, 2.33333333333333, 2.5, 3, 3.5, 3), PCG_CC = c(1, 1.5, 1.5, 1.5, 1.5, 1.5, 1, 1.5, 1, 1.5, 1.5, 1.5, 1, 2, 2, 1, 1.5, 1.5, 2.5, 2.5), AM = c(1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0), GPA = c(3.5, 3, 3, 3.25, 3.5, 3, 3.5, 3, 3.25, 3.5, 3, 2.75, 2.75, 4, 2.75, 3.25, 3.25, 3.25, 3.25, 2.75)), row.names = c(NA, -20L), groups = structure(list(.rows = structure(list(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L), ptype = integer(0), class = c("vctrs_list_of", "vctrs_vctr", "list"))), row.names = c(NA, -20L), class = c("tbl_df", "tbl", "data.frame")), class = c("rowwise_df", "tbl_df", "tbl", "data.frame"))
