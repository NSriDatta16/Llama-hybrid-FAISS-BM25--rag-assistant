[site]: crossvalidated
[post_id]: 625658
[parent_id]: 625262
[tags]: 
Sointu's answer is already correct, but I wanted to contextualize his answer. Below is some code for a simulated model which shows a bivariate relationship with a clustered mean by year. #### Load Libraries #### #### library(tidyverse) library(lmerTest) library(lattice) #### Simulate Data #### set.seed(123) x % ggplot(aes(x=factor(year),y=y))+ geom_boxplot()+ labs(x="Year", y="Y", title = "Average Value of Y by Year")+ theme_classic() #### Plot Bivariate Relationship by Year #### df %>% ggplot(aes(x,y))+ geom_point(color="gray", alpha = .2)+ geom_smooth(aes(x,y,group=year), se=F, color="steelblue", method = "lm")+ theme_classic()+ labs(x="X", y="Y", title = "Simulated By-Year Regressions") #### Fit Model #### fit If we assume your time points are years for this simulated case, the reason why it works is because your $y$ value here exists across every time point, but the time points are technically clustered by year into these bins, where their means and variance are freely observed: As such, you can simply enter this by-year factor variable in as a random intercept in a Gaussian mixed model, wherein: $$ \begin{aligned} \operatorname{y}_{i} &\sim N \left(\alpha_{ij} + \beta_{1}(\operatorname{x}), \sigma^2 \right) \\ \alpha_{j} &\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right) \text{, for year j = 1,} \dots \text{,J} \end{aligned} $$ so that your dependent variable $y$ is estimated by a conditional mean $a$ which is predicted by $i$ individuals and $j$ years and has a fixed variance $\sigma^2$ . What this means is that each year technically has its own conditional mean value of $y$ called $a_j$ , or the random intercept . An example is below, where the simulated data encompasses a single bivariate relationship that varies by year. You can clearly see that in general the trend is positive, but the baseline conditional mean for each year varies a lot (though the random slopes do not vary at all). Now visualizing our single vector of $x$ values and our single vector of $y$ values regressed on by each year, we get a relationship like this (in the example I have simulated here): Here you can see in general the relationship between our two variables is universally positive, but the conditional mean/intercept varies a lot. Year 10, for example, has much higher values of y on average and thus the regression line is at the top of our scatterplot. Mixed models allow you to directly observe these clusters either through the ranef command or through the use of caterpillar plots. As an example with this data: > ranef(fit) $year (Intercept) 1 -4.4466178 2 -3.4817729 3 -2.5182757 4 -1.4839000 5 -0.5300438 6 0.4787734 7 1.5254932 8 2.5065977 9 3.4858812 10 4.4638646 We can see that the conditional mean of Year 10 is indeed the highest, where the opposite is true for Year 1, as $$\begin{align} a_1 &= -4.4466178, \\ a_{10} &=\quad 4.4638646.\end{align} $$ The positive values represent random intercepts which are greater than the fixed intercept, and the negative values are lower than the fixed intercept or the grand mean . A caterpillar plot will showcase this visually. Now of course this is a highly unrealistic example, as its probably not likely that each year will have almost exactly the same slopes and variance around the mean, but this hopefully shows what the other answerer was explaining. Edit To further clarify the questions in the comments, I have another simulated example here which makes the specification of the single predictor value and multiple outcome values as so, where $y$ has a different association with $x$ at each time point: #### Load Library and Random Seed #### library(tidyverse) set.seed(123) #### Simulate Data #### n % pivot_longer(cols = contains("y"), names_to = "time", values_to = "value") long #### Fit Data #### library(lmerTest) fit One can see this fit is also legal.
