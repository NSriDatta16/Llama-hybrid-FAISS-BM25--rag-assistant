[site]: stackoverflow
[post_id]: 3316388
[parent_id]: 3316261
[tags]: 
Aggregated buckets. We pick a bucket size that's comfortably less than squareRoot(MAXINT). To keep it simple, let's pick 10. Each new value is added to the current bucket, and the moving average can be computed as you describe. When the bucket is full start a new bucket, remembering the average of the full bucket. We can safely calculate the overall average by combining the averages of the full buckets and the current, partial bucket. When we get to 10 full buckets, we create a bigger bucket, capacity 100. To compute the total average we first compute the average of the "10s" and then combine that with the "100s". This pattern repeats for "1,000s" "10,000s" and so on. At each stage we only need to consider two levels one 10 x bigger than the previous one.
