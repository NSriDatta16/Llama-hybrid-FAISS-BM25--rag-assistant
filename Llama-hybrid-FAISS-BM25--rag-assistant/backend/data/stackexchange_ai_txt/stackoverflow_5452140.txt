[site]: stackoverflow
[post_id]: 5452140
[parent_id]: 5451660
[tags]: 
A 10 game moving average means that if you had less than 10 games, there is no meaningful average (not enough games). If you had 12 games, the average is taken between 1-10 (avg) 2-11 (avg) 3-12 (avg) max / min across the 3 averages The most efficient way to do this in MySQL would be to select .. (involving 13 @variables to rownumber and rotate the last 10 values into the variables, keeping track of @player, @year, @rownumber) order by player, year, gameid This will pass through the data only once, building the averages. An outer query will simply take min/max from this derived table. I'm not up for fleshing this out at the moment though.
