[site]: stackoverflow
[post_id]: 4277007
[parent_id]: 4266935
[tags]: 
Copying a whole sub-tree is a bit of a problem because when you copy your sub-tree you are either denormalizing data or using it as a template of some sorts. In either case you are dragging data through inconsistent state at some point - which indicates some problems with your design (for example do your records need to have multiple parents or not? if yes, then you should consider redesigning). So, you should update the answer with a more complete example of what you are trying to do. One solution would be to have a temporary table, selecting for the insert should not be a problem, it is just updating the referenced IDs that would be a problem. So WITH INSERT into temporary table UPDATE the IDs INSERT into original table DELETE temp records The procedure needs to go like this because it would be hard to change the IDs (both record IDs and ID referring to parent) in initial WITH INSERT. However it might be possible, if there was a nice function that depended only on max_id or only on old IDs.
