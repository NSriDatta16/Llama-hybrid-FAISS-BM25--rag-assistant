[site]: crossvalidated
[post_id]: 195224
[parent_id]: 195207
[tags]: 
Edit: Sorry about my confusion in the beginning... But I read over the article, which luckily is in open access if anyone want to chip in on this. So I first have some general comments regarding the code that you provided, then some questions regarding the modelling. In the article they state the following: When testing for an age dependence of the HR, the model with a constant HR was compared to one where the HR was a continuous, piecewise linear function of age which was constant before age 40 years, linear between ages 40 and 60 years and constant after age 60 years. So when I plot the hr column in your data frame I get the following: So, this is not continuous! So there is something that needs to be fixed here. I think that the code that you would want to use for that is the following: hr = rep(NA, 51) #hazard ratio age = c(20:70) young = 50) hr[i] = old else hr[i] = hr[i-1] + (1/20)*(old-young) } breast.hr = as.data.frame(cbind(age = 20:70, hr, cumhr= cumsum(hr), cumrr = 1 - exp(-cumsum(hr)))) plot(breast.hr$age,breast.hr$hr) title("hr column") That provides the following plot: So now this is piecewise linear and continuous as stated in the article. Now the cumulative HR should look like the thick black line in Figure 3 of the article. Now to continue I need to know exactly what the model is that they are using to be able to perform a parametric bootstrap. In the section Statistical Methods for Penetrance Analyses they state which model they use: A mixed model was employed which incorporates an unmeasured polygenic factor to model the effect on breast cancer risk of a large number of unmeasured genes in addition to the measured major gene.[29] The polygenic part of this model was implemented via a hypergeometric polygenic model with four loci[30] and postulates a normally distributed random variable G for each person so that these variables are correlated within families (see section 8.9 of Lange et al.[31]). A woman's age at breast cancer diagnosis was modeled as a random variable whose HR was, for noncarriers, exp(G) times the Australian breast cancer incidence rate for 1992â€“2002[32] or, for carriers, the product of this HR multiplied by the age-specific HR. As in Antoniou et al.,[33] the variance of G was chosen to be 1.67, and the mean was chosen so that the average HR for noncarriers equaled the population incidence. I think that we need more information about the data to be able to do a parametric bootstrap. If you think can fully specify the model, then I can try to help you! **EDIT: ** So here I have changed the code to be able to plot the quantiles around the mean curve. You can see that it does not look exactly like Figure 3 in the paper, but that is probably because the inc variable is not continuous in age. boot.sampling.dist = 50) { hr[i] = exp(b) inc[i] = hr[i]*279.0873/100000 } else { hr[i] = exp(a) + (age[i] - 30)*(exp(b)-exp(a))/20 inc[i] = hr[i]*75.91559/100000 } } cum.inc = cumsum(inc) cum.risk = 1 - exp(-cum.inc) boot.sampling.dist[j,]
