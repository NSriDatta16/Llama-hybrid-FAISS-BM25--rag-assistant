[site]: stackoverflow
[post_id]: 4317521
[parent_id]: 
[tags]: 
Why the image is not displayed in the imageItem?

I used the Nokia sample codes for Google Map. It has retrieveStaticImage method which loads and returns an Image. I them loaded the image to an ImageItem but I get an exception everytime.. Here are my codes... Codes for GoogleMaps class import java.io.ByteArrayOutputStream; import java.io.DataOutputStream; import java.io.IOException; import java.io.InputStream; import java.util.Vector; import javax.microedition.io.Connector; import javax.microedition.io.HttpConnection; import javax.microedition.lcdui.Image; import javax.microedition.lcdui.ImageItem; public class GoogleMaps implements Runnable{ private static final String URL_UNRESERVED = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" + "abcdefghijklmnopqrstuvwxyz" + "0123456789-_.~"; private static final char[] HEX = "0123456789ABCDEF".toCharArray(); Image image; int width; int height; double lat; double lng; int zoom; String format; ImageItem imagecmpt; // these 2 properties will be used with map scrolling methods. You can remove them if not needed public static final int offset = 268435456; public static final double radius = offset / Math.PI; private String apiKey = null; public GoogleMaps(String key,int width, int height, double lat, double lng, int zoom, String format,ImageItem img) { this.width=width; this.height=height; this.lat=lat; this.lng=lng; this.zoom=zoom; this.format=format; apiKey = key; } public double[] geocodeAddress(String address) throws Exception { byte[] res = loadHttpFile(getGeocodeUrl(address)); String[] data = split(new String(res), ','); if (!data[0].equals("200")) { int errorCode = Integer.parseInt(data[0]); throw new Exception("Google Maps Exception: " + getGeocodeError(errorCode)); } return new double[] { Double.parseDouble(data[2]), Double.parseDouble(data[3]) }; } public Image retrieveStaticImage() throws IOException { byte[] imageData = loadHttpFile(getMapUrl(width, height, lng, lat, zoom, format)); System.out.println("Address is "+getMapUrl(width, height, lng, lat, zoom, format)); for (int i=0;i = 0) { buf.append((char) b); } else { buf.append('%').append(HEX[(b >> 4) & 0x0f]).append(HEX[b & 0x0f]); } } return buf.toString(); } private static byte[] loadHttpFile(String url) throws IOException { byte[] byteBuffer; HttpConnection hc = (HttpConnection) Connector.open(url); try { hc.setRequestMethod(HttpConnection.GET); InputStream is = hc.openInputStream(); try { int len = (int) hc.getLength(); if (len > 0) { byteBuffer = new byte[len]; int done = 0; while (done = 0 ) { bos.write(buffer, 0, count); } byteBuffer = bos.toByteArray(); } } finally { is.close(); } } finally { hc.close(); } return byteBuffer; } private static String[] split(String s, int chr) { Vector res = new Vector(); int curr; int prev = 0; while ( (curr = s.indexOf(chr, prev)) >= 0 ) { res.addElement(s.substring(prev, curr)); prev = curr + 1; } res.addElement(s.substring(prev)); String[] splitted = new String[res.size()]; res.copyInto(splitted); return splitted; } public void run() { try{ //throw new UnsupportedOperationException("Not supported yet."); imagecmpt.setImage(retrieveStaticImage()); } catch(Exception e){ System.out.println("Error ......."+e); } } } code for midlet public void commandAction(Command command, Displayable displayable) { // write pre-action user code here if (displayable == form) { if (command == exitCommand) { // write pre-action user code here exitMIDlet(); // write post-action user code here } else if (command == okCommand) { // write pre-action user code here // write post-action user code here GoogleMaps cMz=new GoogleMaps("ABQIAAAADEQoVqbqS5pT4ahHSLALyBT8PMUw5z7_OLJoE1lh2VQyfb-WOxTwS9t9mrSq_flhdPeVGOQrxXuCFQ",10, 10, 10, 10, 1, "roadmap", imageItem); Thread th=new Thread(cMz); th.run(); Display display=getDisplay (); } } // write post-action user code here } My output::: Starting emulator in execution mode Running with storage root DefaultColorPhone Running with locale: English_United States.1252 Running in the identified_third_party security domain Warning: To avoid potential deadlock, operations that may block, such as networking, should be performed in a different thread than the commandAction() handler. I have used an external thread but yet it keeps telling me to use another thread.. How can I sort this out?
