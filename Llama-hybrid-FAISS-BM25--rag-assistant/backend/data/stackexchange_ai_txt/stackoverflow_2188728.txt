[site]: stackoverflow
[post_id]: 2188728
[parent_id]: 2175191
[tags]: 
Here's a function I wrote to get the Application Data folder in C++Builder. If you're using older versions of C++Builder, you might find you have to change this to use AnsiStrings instead of Unicode (replace the " UnicodeString "s with " AnsiString "s, and change the call to " SHGetSpecialFolderPathW " to read " SHGetSpecialFolderPath "). GetAppDataFolder.h: #ifndef GetAppDataFolderH #define GetAppDataFolderH UnicodeString GetAppDataFolder(bool roaming = true); #endif GetAppDataFolder.cpp: // Helper function to get the location of the current user's Application Data folder (used for // storing per-user application settings). #include #pragma hdrstop /* roaming: True for application data that can be accessed by the same user on different machines. If you have per-user settings that are only relevant to a particular computer, e.g., screen resolution, set 'roaming' to false. */ UnicodeString GetAppDataFolder(bool roaming /* = true */) { UnicodeString retVal; int csidl = roaming ? CSIDL_APPDATA : CSIDL_LOCAL_APPDATA; wchar_t thePath[MAX_PATH]; if (SHGetSpecialFolderPathW(NULL, thePath, csidl, 0) == TRUE) { retVal = thePath; } return retVal; }
