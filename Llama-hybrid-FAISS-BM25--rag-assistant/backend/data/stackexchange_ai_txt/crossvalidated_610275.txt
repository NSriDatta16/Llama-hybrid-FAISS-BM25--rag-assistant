[site]: crossvalidated
[post_id]: 610275
[parent_id]: 
[tags]: 
Is there a function in R to give the lack of fit and pure error of an ANOVA completed on a half 2^k factorial with centre points?

I have a half fraction factorial experiment for four factors, meaning I have eight experiments that I conduct. I expect that some of the responses are quadratic and not linear, thus I included centre points in my experiments, which introduces a ninth (zeroth) experiment. Indeed, quadratic responses seem possible from boxplots. Five repeats for all experiments were run, with the eight experiments in random order. The zeroth experiment, the centre points, have five repeats at the start of the runs, five repeats in the middle and five repeats at the end. This is to observe variation trends in operator skill or machine conditions during the whole experiment. I am trying to run ANOVA in R to interpret the results. As far as I understand from a theoretical point of view, I should be able to run ANOVA on the eight experiments sorted by factor, but also on the lack of fit based on the centre points. A lack of fit would indicate that I have to do response surface modelling to find the optimum, and perhaps include a few more experiments in order to get the additional regression coefficients. I however have no idea how to implement this in R. The textbook I use (Montgomery, Design and analysis of experiments) give a rudimentary test for lack of fit, where the average of the factorial point responses are compared with the average of the centre point responses. Mine is off by almost 10 %. They also give an explanation of how the lack of fit can be calculated by hand. This explanation is attached here as a pdf. I can run the ANOVA on the four factors with no problem. summary(aov(t_σ[16:55] ~ A[16:55] + B[16:55] + C[16:55] + D[16:55], data)) which yields Df Sum Sq Mean Sq F value Pr(>F) A[16:55] 1 66.3 66.3 2.733 0.1072 B[16:55] 1 1.5 1.5 0.062 0.8044 C[16:55] 1 692.6 692.6 28.544 5.68e-06 *** D[16:55] 1 89.1 89.1 3.674 0.0635 . Residuals 35 849.2 24.3 --- Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 indicating that only Factor C has a significant effect. However, I have no idea how to add the lack of fit as an additional row in the ANOVA table based on the centre points. Is this possible, and can anyone advise on how I should do this? If not, is there another way to get the lack of fit in a separate operation? Attached is my raw data. 'ekspnr' indicates the experiment number, where 0 indicates the centre point experiment. The data frame has been sorted according to experiment number, so that all the centre points are from 0 to 15, and the rest are from 16 to 55. 't_σ' is the response, and the A, B, C and D refers to the factors. ekspnr t_σ A B C D 0 0.0 27.951699 0.30 205.0 50.0 6.0 1 0.0 28.009995 0.30 205.0 50.0 6.0 2 0.0 27.939666 0.30 205.0 50.0 6.0 3 0.0 24.949808 0.30 205.0 50.0 6.0 4 0.0 25.536769 0.30 205.0 50.0 6.0 5 0.0 23.334088 0.30 205.0 50.0 6.0 6 0.0 24.637399 0.30 205.0 50.0 6.0 7 0.0 22.460906 0.30 205.0 50.0 6.0 8 0.0 20.429309 0.30 205.0 50.0 6.0 9 0.0 25.034200 0.30 205.0 50.0 6.0 10 0.0 21.047813 0.30 205.0 50.0 6.0 11 0.0 22.043904 0.30 205.0 50.0 6.0 12 0.0 22.177695 0.30 205.0 50.0 6.0 13 0.0 21.854369 0.30 205.0 50.0 6.0 14 0.0 19.923816 0.30 205.0 50.0 6.0 15 1.0 20.746215 0.18 190.0 10.0 2.0 16 1.0 18.999751 0.18 190.0 10.0 2.0 17 1.0 18.619490 0.18 190.0 10.0 2.0 18 1.0 18.820066 0.18 190.0 10.0 2.0 19 1.0 19.194736 0.18 190.0 10.0 2.0 20 2.0 19.088337 0.42 190.0 10.0 10.0 21 2.0 18.797644 0.42 190.0 10.0 10.0 22 2.0 18.377256 0.42 190.0 10.0 10.0 23 2.0 19.097554 0.42 190.0 10.0 10.0 24 2.0 17.815757 0.42 190.0 10.0 10.0 25 3.0 10.011159 0.18 220.0 10.0 10.0 26 3.0 13.538536 0.18 220.0 10.0 10.0 27 3.0 12.768532 0.18 220.0 10.0 10.0 28 3.0 13.711670 0.18 220.0 10.0 10.0 29 3.0 10.657853 0.18 220.0 10.0 10.0 30 4.0 22.674432 0.42 220.0 10.0 2.0 31 4.0 16.326696 0.42 220.0 10.0 2.0 32 4.0 21.479866 0.42 220.0 10.0 2.0 33 4.0 25.216749 0.42 220.0 10.0 2.0 34 4.0 21.089515 0.42 220.0 10.0 2.0 35 5.0 24.565803 0.18 190.0 90.0 10.0 36 5.0 29.021329 0.18 190.0 90.0 10.0 37 5.0 32.300469 0.18 190.0 90.0 10.0 38 5.0 32.673953 0.18 190.0 90.0 10.0 39 5.0 25.842299 0.18 190.0 90.0 10.0 40 6.0 20.402979 0.42 190.0 90.0 2.0 41 6.0 21.260363 0.42 190.0 90.0 2.0 42 6.0 21.916816 0.42 190.0 90.0 2.0 43 6.0 23.040326 0.42 190.0 90.0 2.0 44 6.0 15.786039 0.42 190.0 90.0 2.0 45 7.0 40.205180 0.18 220.0 90.0 2.0 46 7.0 31.956339 0.18 220.0 90.0 2.0 47 7.0 31.159483 0.18 220.0 90.0 2.0 48 7.0 32.386282 0.18 220.0 90.0 2.0 49 7.0 28.827811 0.18 220.0 90.0 2.0 50 8.0 23.726401 0.42 220.0 90.0 10.0 51 8.0 20.733421 0.42 220.0 90.0 10.0 52 8.0 28.205647 0.42 220.0 90.0 10.0 53 8.0 18.459101 0.42 220.0 90.0 10.0 54 8.0 21.004829 0.42 220.0 90.0 10.0 The only function I could find was pureErrorAnova() from the package alr3. However, when completing an example from my textbook (Montgomery, Design and analysis of experiments), this function does not yield the correct answers. The LoF and pure error has the wrong degrees of freedom, and their values are vastly different from the textbook. Moreover, the LoF is larger than the pure error in the table produced by the table, whereas it should be the other way around according to the textbook. The example refers to an earlier one. I attach them as pdfs here and here . Note how the LoF is different than simply blocking the centre points as a separate block in a normal anova table.
