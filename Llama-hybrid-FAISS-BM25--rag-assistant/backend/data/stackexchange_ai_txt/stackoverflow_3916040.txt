[site]: stackoverflow
[post_id]: 3916040
[parent_id]: 3911777
[tags]: 
AFAIK, all defragment tools which try to defrag pagefile.sys work in offline mode (outside Windows). I think they write a kernel driver for that purpose, and use ZwCreateFile() to get the handle of pagefile.sys file. They are likely also utilyzing ZwDeviceIoControlFile() to access files in sector based.
