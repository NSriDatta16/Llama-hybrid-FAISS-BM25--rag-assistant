[site]: stackoverflow
[post_id]: 3831644
[parent_id]: 
[tags]: 
Why does a database query only go slow in the application?

I have a webpage that takes 10 minutes to run one query against a database, but the same query returns in less than a second when run from SQL Server Management Studio. The webpage is just firing SQL at the database that is executing a stored procedure, which in turn is performing a pretty simple select over four tables. Again the code is basic ADO, setting the CommandText on an SqlCommand and then performing an ExecuteReader to get the data. The webpage normally works quickly, but when it slows down the only way to get it speeded up is to defragment the indexes on the tables being queried (different ones different times), which doesn't seem to make sense when the same query executes so quickly manually. I have had a look at this question but it doesn't apply as the webpage is literally just firing text at the database. Does anyone have any good ideas why this is going slow one way and not the other? Thanks
