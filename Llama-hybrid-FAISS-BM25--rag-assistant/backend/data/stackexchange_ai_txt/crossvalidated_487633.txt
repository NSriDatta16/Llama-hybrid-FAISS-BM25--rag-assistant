[site]: crossvalidated
[post_id]: 487633
[parent_id]: 
[tags]: 
Generating the correct model.matrix input for Lasso Regression

I am trying to make a Lasso logistic regression to predict Y a bi-categorical variable, with 24 candidate quantitative predictors. I have 108 observations. This is how my data frame looks like for the first 3 rows: > data.detect[1:2,] CONVENTIONAL_HUmin CONVENTIONAL_HUmean CONVENTIONAL_HUstd CONVENTIONAL_HUmax 1 37.9400539686119 63.4903779286635 11.7592095845857 85.2375439991287 2 23.8400539686119 80.5903779286635 15.0592095845857 125.837543999129 CONVENTIONAL_HUQ1 CONVENTIONAL_HUQ2 CONVENTIONAL_HUQ3 HISTO_Skewness HISTO_Kurtosis 1 54.9938390994964 65.4873070322704 72.8863025473031 -0.203420585259268 2.25208159159488 2 70.8938390994964 80.3873070322704 91.4863025473031 -0.117420585259268 2.91208159159488 HISTO_ExcessKurtosis HISTO_Entropy_log10 HISTO_Entropy_log2 HISTO_Energy...Uniformity. 1 -0.751917020142877 0.701345471328916 2.32782599847774 0.219781577333287 2 -0.0887170201428774 0.793345471328916 2.63782599847774 0.184781577333287 GLZLM_SZE GLZLM_LZE GLZLM_LGZE GLZLM_HGZE GLZLM_SZLGE 1 0.366581916604228 35.7249100350856 8.7285612359045e-05 11497.6407737833 3.22615226279017e-05 2 0.693581916604228 984.424910035086 8.5685612359045e-05 11697.6407737833 5.98615226279017e-05 GLZLM_SZHGE GLZLM_LZLGE GLZLM_LZHGE GLZLM_GLNU GLZLM_ZLNU 1 4164.91570215061 0.00314512237564268 405585.990838764 2.66964898745512 2.47759091065361 2 8064.91570215061 0.0835651223756427 11581585.9908388 12.9796489874551 38.5375909106536 GLZLM_ZP Y 1 0.219643444043173 1 2 0.112643444043173 0 I created a model matrix and response vector: x=model.matrix(Y~.,data=data.detect) y=data.detect$Y But when running Lasso fit.lasso As you see, I have much more than 24 predictors(299 in the x axe above) When choosing the best lambda via cross validation cv.lasso Same thing ! And when trying to extract the non zero coefficients from the best lambda model: coef(cv.lasso) 2266 x 1 sparse Matrix of class "dgCMatrix" 1 (Intercept) 1.098612 (Intercept) . CONVENTIONAL_HUmin-10.5599460313881 . CONVENTIONAL_HUmin-117.359946031388 . CONVENTIONAL_HUmin-13.0599460313881 . CONVENTIONAL_HUmin-154.359946031388 . CONVENTIONAL_HUmin-17.6599460313881 . CONVENTIONAL_HUmin-18.3599460313881 . CONVENTIONAL_HUmin-9.08171050452898 . I looked to my model.matrix and and I think that's where the problem comes from For example, for the predictor CONVENTIONAL_HUmax, it's duplicated about hundred times ! CONVENTIONAL_HUmax104.046018889744 CONVENTIONAL_HUmax104.837543999129 CONVENTIONAL_HUmax105.682510733322 CONVENTIONAL_HUmax105.837543999129 CONVENTIONAL_HUmax106.837543999129 CONVENTIONAL_HUmax107.173812970536 CONVENTIONAL_HUmax107.837543999129 CONVENTIONAL_HUmax108.046018889744 CONVENTIONAL_HUmax108.837543999129 CONVENTIONAL_HUmax109.837543999129 If you have any suggestion to fix this problem I will appreciate !
