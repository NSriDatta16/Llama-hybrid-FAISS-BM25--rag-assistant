[site]: crossvalidated
[post_id]: 197774
[parent_id]: 197669
[tags]: 
With out sample data it's hard to test what you are looking for given your code, but I would suggest using the rms package. It is a great package and has what you are looking for. In particular, lrm : Fit binary and proportional odds ordinal logistic regression models using maximum likelihood estimation or penalized maximum likelihood estimation robcov : Uses the Huber-White method to adjust the variance-covariance matrix of a fit from maximum likelihood or least squares, to correct for heteroscedasticity and for correlated responses from cluster samples Here is an example using your data provided with a very simple model: Sample data df Regression w/o clustering: library(rms) d chi2) 0.2760 gr 1.790 gamma 0.714 max |deriv| 1e-09 gp 0.083 tau-a 0.083 Brier 0.099 Coef S.E. Wald Z Pr(>|Z|) Intercept -2.4849 1.0408 -2.39 0.0170 eds 1.7918 1.6073 1.11 0.2649 Cluster around c_id: robcov(mod, df$c_id, method = c('huber')) Logistic Regression Model lrm(formula = qualified ~ eds, data = df, x = TRUE, y = TRUE) Model Likelihood Discrimination Rank Discrim. Ratio Test Indexes Indexes Obs 16 LR chi2 1.19 R2 0.135 C 0.679 0 14 d.f. 1 g 0.582 Dxy 0.357 1 2 Pr(> chi2) 0.2760 gr 1.790 gamma 0.714 Cluster on df$c_id gp 0.083 tau-a 0.083 Clusters 3 Brier 0.099 max |deriv| 1e-09 Coef S.E. Wald Z Pr(>|Z|) Intercept -2.4849 0.8250 -3.01 0.0026 eds 1.7918 0.8250 2.17 0.0299
