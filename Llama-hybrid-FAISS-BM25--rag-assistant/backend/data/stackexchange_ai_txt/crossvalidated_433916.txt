[site]: crossvalidated
[post_id]: 433916
[parent_id]: 
[tags]: 
Simulating survival data for a Cox model with a dichotomous time-varying covariate in R

I am interested in simulating non-proportional data following the formulation in Section 3.1 of the article: [Generating survival times to simulate Cox proportional hazards models with time‚Äêvarying covariates] [1]. The problem is that the estimates for bt are not consistent with the true value of 1 and thus resulting in very low coverage probability. Can someone please help me, I've been working on this for a while now and I don't know what I'm doing wrong. sim.50=function(n,b,bt,lambda,lambdac,alpha,theta){ #Generate covariates: x (time invariant), z (time-varying) x=rnorm(n,0,1) z=rbinom(n,1,0.5) #Uniform random variable u=runif(n,0,1) t=(-log(u))/(lambda*exp(b*x)) t0=lambdac t.e=ifelse(-log(u) $coef cox[i,3:4]=sqrt(diag(fit.cox$ var)) cox[i,5:6]=cox[i,1:2]+ qnorm(.025) * cox[i,3:4] cox[i,7:8]=cox[i,1:2] + qnorm(.975) * cox[i,3:4] cox[i,9:10]=as.integer ((cox[i,5:6] =1)) } #Estimates Estimates=colMeans(cox[,1:2]) Estimates #Bias true_values=c(1,1) Bias=Estimates-true_values Bias #Estimated standard error Est_Se=colMeans(cox[,3:4]) Est_Se #Empirical standard error Emp_Se=sqrt(diag(var(cox[,1:2]))) Emp_Se #MSE s=sum((cox[,1:2]-true_values)^2) s MSE=s/runs MSE #Coverage probability cp=colMeans(cox[,9:10]) cp [1]: https://onlinelibrary.wiley.com/doi/full/10.1002/sim.5452
