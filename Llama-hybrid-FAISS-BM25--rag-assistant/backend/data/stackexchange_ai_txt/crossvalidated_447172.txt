[site]: crossvalidated
[post_id]: 447172
[parent_id]: 
[tags]: 
Hierarchical modelling for a circular distribution

Suppose we want to estimate the distribution of a random variable defined over time of day and day of the week given a sample. In addition: We cannot assume that the distribution is the product of independent distributions over time and weekdays, but it might be close to one which should let us smooth out our estimate. Our model should take advantage of the topology of the space. 11:59 PM on Monday is close to 00:01 AM on Tuesday, and Tuesday is close to Monday than it is to Friday. The distribution can be assumed to be smooth over that space. How might such a model be specified? Edit to clarify: One potential model would be a mixture of Von Mises distributions with the form $$\frac{1}{Z}\left(\sum_{i=1}^n a_i e^{\kappa_i \cos (x - \phi_i)} + \sum_{i=1}^{m} b_i e^{\lambda_i \cos (7 (x - \theta_i))}\right)$$ Where x = (datetime mod (1 week)) * $2 \pi$ / (1 week). What might be a reasonable family of prior for $n, m, a_i, b_i, \phi_i, \theta_i, \kappa_i, \lambda_i$ though? I could use a Dirichlet process to represent the two mixtures, and perhaps a U(0,1) draw to represent the relative importance of each... I can probably come up with something relatively reasonable but I'm sure someone's modeled this kind of thing before, has tried several approaches, and might share what worked. The above also involves some rather heavy artillery to fit, a simpler approach would be welcome. Another potential model would be to treat the sample as the realization of a Poisson process with a varying rate, modeling he rate as the exponential of a gaussian process, and placing a covariance structure on the gaussian process where the distance takes into account the circular distance across the week as well as the circular distance modulo one day... fit the gaussian process with maximum likelihood and fit the kernel using LCOV. Another potential model would be to take the whole sample modulo one day, call this the average for a day, and shrink the sample for every day of the week towards that daily average using a parameter found by LCOV. Not super principled, but dead simple. Another potential model: your answer here...
