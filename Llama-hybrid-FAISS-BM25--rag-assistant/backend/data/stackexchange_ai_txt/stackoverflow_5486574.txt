[site]: stackoverflow
[post_id]: 5486574
[parent_id]: 
[tags]: 
Android - filled ListActivity Database Search - HowTo?

I got an ListActivity which gets filled with data from the database. This activity is also allowed to search for data in the database. DatabaseHelper dbHelper; SimpleCursorAdapter adapter; Cursor c; @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); requestWindowFeature(Window.FEATURE_NO_TITLE); final Intent queryIntent = getIntent(); final String queryAction = queryIntent.getAction(); if (Intent.ACTION_SEARCH.equals(queryAction)) { String searchKeywords = queryIntent.getStringExtra(SearchManager.QUERY); doSearch(searchKeywords); } } @Override public void onStart() { try { super.onStart(); dbHelper=new DatabaseHelper(this); c = dbHelper.getAllMagazines(); startManagingCursor(c); adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_2, c, new String[] {"editionName", "magazineName"}, new int[] {android.R.id.text1, android.R.id.text2}); /** Adapter setzen**/ this.setListAdapter(adapter); } catch(Exception ex) { } } Its shows me the data from the database in the ListView. So no problem here. When I do the search, the following function gets called: private void doSearch(String search) { dbHelper=new DatabaseHelper(this); c = dbHelper.searchEditions(getIntent().getStringExtra("search")); startManagingCursor(c); adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_2, c, new String[] {"editionName", "magazineName"}, new int[] {android.R.id.text1, android.R.id.text2}); this.setListAdapter(adapter); } I set the ListAdapter to the new Adapter with the Searchresults. But in the ResultView of the Search it still shows me all data from the database I get in onStart(). If I disable the setListAdapter in onStart(), everything works fine and it shows me the searchresulst. How can i tell the ListView to show the searchresults when the ListView is already filled with data? FULL CODE: public class MagazineViewController extends ListActivity { DatabaseHelper dbHelper; SimpleCursorAdapter adapter; Cursor c; @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); requestWindowFeature(Window.FEATURE_NO_TITLE); final Intent queryIntent = getIntent(); final String queryAction = queryIntent.getAction(); if (Intent.ACTION_SEARCH.equals(queryAction)) { String searchKeywords = queryIntent.getStringExtra(SearchManager.QUERY); doSearch(searchKeywords); } } @Override public void onStart() { try { super.onStart(); dbHelper=new DatabaseHelper(this); c = dbHelper.getAllMagazines(); startManagingCursor(c); Log.d("CURSOR COUNT", ""+c.getCount()); adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_2, c, new String[] {"editionName", "magazineName"}, new int[] {android.R.id.text1, android.R.id.text2}); this.setListAdapter(adapter); } catch(Exception ex) { } } private void doSearch(String search) { dbHelper=new DatabaseHelper(this); /** Daten aus der Datenbank abfragen**/ Cursor cur = dbHelper.searchEditions(getIntent().getStringExtra("search")); startManagingCursor(cur); Log.d("CURSOR COUNT", ""+cur.getCount()); final ListView view = getListView(); final SimpleCursorAdapter cursorAdapter = ((SimpleCursorAdapter) view.getAdapter()); cursorAdapter.changeCursor(cur); } @Override public boolean onCreateOptionsMenu(Menu menu) { MenuInflater inflater = getMenuInflater(); inflater.inflate(R.menu.magazinemenu, menu); return true; } @Override public boolean onOptionsItemSelected(MenuItem item) { switch (item.getItemId()) { case R.id.preferences: startActivity (new Intent (this, PreferencesViewController.class)); break; } return true; } } LogCat: 03-30 16:29:43.381: ERROR/AndroidRuntime(546): FATAL EXCEPTION: main 03-30 16:29:43.381: ERROR/AndroidRuntime(546): java.lang.RuntimeException: Unable to start activity ComponentInfo{package/package.MagazineViewController}: java.lang.NullPointerException 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.app.ActivityThread.access$2300(ActivityThread.java:125) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.os.Handler.dispatchMessage(Handler.java:99) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.os.Looper.loop(Looper.java:123) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.app.ActivityThread.main(ActivityThread.java:4627) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at java.lang.reflect.Method.invokeNative(Native Method) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at java.lang.reflect.Method.invoke(Method.java:521) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at dalvik.system.NativeStart.main(Native Method) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): Caused by: java.lang.NullPointerException 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at package.MagazineViewController.doSearch(MagazineViewController.java:111) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at package.MagazineViewController.onCreate(MagazineViewController.java:40) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 03-30 16:29:43.381: ERROR/AndroidRuntime(546): ... 11 more Error Code in line 111, which is cursorAdapter.changeCursor(cur);
