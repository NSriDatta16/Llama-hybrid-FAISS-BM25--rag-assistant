[site]: stackoverflow
[post_id]: 4199666
[parent_id]: 
[tags]: 
NServiceBus: Custom ISubscriptionStorage implementation with no generic-host

I am unable to use my custom ISubscriptionStorage implementation when I use something other than the generic host. I'm not really sure why. I am getting an exception of "Cannot publish on this endpoint - no subscription storage has been configured. Add either 'MsmqSubscriptionStorage()' or 'DbSubscriptionStorage()' after 'NServiceBus.Configure.With()'." Only I don't want to use these options because I want to use my custom option. Here's what I have that's failing: public class Program { static void Main() { var bus = Configure.With() .CustomConfigurationSource(new UserConfigurationSource() .Register(() => new MsmqTransportConfig()) .Register(() => new UnicastBusConfig())) .DefaultBuilder() .XmlSerializer() .MsmqTransport() .IsTransactional(true) .UnicastBus() .CreateBus() .Start(); Configure.Instance.Configurer.ConfigureComponent (ComponentCallModelEnum.Singleton); Console.WriteLine("This will publish IEvent and EventMessage alternately."); Console.WriteLine("Press 'Enter' to publish a message.To exit, Ctrl + C"); bool publishIEvent = true; while (Console.ReadLine() != null) { var eventMessage = publishIEvent ? bus.CreateInstance () : new EventMessage(); eventMessage.EventId = Guid.NewGuid(); eventMessage.Time = DateTime.Now.Second > 30 ? (DateTime?)DateTime.Now : null; eventMessage.Duration = TimeSpan.FromSeconds(99999D); bus.Publish(eventMessage); Console.WriteLine("Published event."); publishIEvent = !publishIEvent; } } }
