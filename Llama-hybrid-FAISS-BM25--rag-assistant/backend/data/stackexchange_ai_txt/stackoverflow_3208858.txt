[site]: stackoverflow
[post_id]: 3208858
[parent_id]: 3206869
[tags]: 
I can think of two solutions here: 1) Use a monad transformer library. I can't improve on Shimuuar's reply, except in some details on the libraries. Transformers by itself doesn't provide the necessary instances; you would need to use transformers and either monads-tf or monads-fd, which offer implementations based on type families and fundeps, respectively. I prefer monads-tf if you go this route. The api is almost identical to that of mtl. I don't have experience with MonadLib, but it looks quite good also. 2) Write your main loop in IO, and for each loop iteration call runState to evaluate the state monad. Something like the following: loop path state = do op This should work, but it's far less idiomatic than using monad transformers.
