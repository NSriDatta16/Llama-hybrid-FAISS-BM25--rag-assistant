[site]: datascience
[post_id]: 121548
[parent_id]: 
[tags]: 
How to make an RNN model in PyTorch that has a custom hidden layer(s) and that is compatible with PackedSequence

I want to make an RNN that has for example more hidden layers or layer normalization. I know that is it possible to make a custom RNN by subclassing nn.module, but with this approach is it not possible to do efficient batch processing with a PackedSequence object (with variable length sequences) the same way and with the same efficiency as torch.nn.RNN. I thought maybe the solution could be to subclass nn.RNN, but I don't know how to do that.
