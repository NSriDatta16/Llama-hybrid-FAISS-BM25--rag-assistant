[site]: stackoverflow
[post_id]: 2259704
[parent_id]: 2259694
[tags]: 
Don't use regular expressions to parse HTML -- use an HTML parser, such as BeautifulSoup . Specifically, your situation is basically one of having to deal with "nested parentheses" (where an open "parens" is an opening tag and the corresponding closed parens is the matching ) -- exactly the kind of parsing tasks that regular expressions can't perform well. Lots of the work in parsing HTML is exactly connected with this "matched parentheses" issue, which makes regular expressions a perfectly horrible choice for the purpose. You mention in a comment to another answer that you've had unspecified problems with BS -- I suspect you were trying the latest, 3.1 release (which has gone downhill) instead of the right one; try 3.0.8 instead, as BS's own docs recommend, and you could be better off. If you've made some kind of pact with Evil never to use the right tool for the job, your task might not be totally impossible if you don't need to deal with nesting (just matching), i.e., there is never a table inside another table. In this case you can identify one table with r' (with suitable flags such as re.DOTALL and re.I ); loop over all such matches with the finditer method of regular expressions; and in the loop's body check whether BGCOLOR (in a case-insensitive sense) happens to be inside the body of the current match. It's still going to be more fragile, and more work, than using an HTML parser, but while definitely an inferior choice it needs not be a desperate situation. If you do have nested tables to contend with, then it is a desperate situation.
