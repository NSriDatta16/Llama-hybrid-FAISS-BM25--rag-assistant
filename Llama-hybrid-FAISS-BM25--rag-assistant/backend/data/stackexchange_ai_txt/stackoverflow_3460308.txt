[site]: stackoverflow
[post_id]: 3460308
[parent_id]: 
[tags]: 
Parse HTML links from a google query

First the revised code which throws javax.swing.text.ChangedCharSetException : import java.io.*; import java.net.*; public class Main { public static void main(String[] args) throws IOException, Exception { String query = "#pragma"; Socket s = new Socket("google.com",80); PrintStream p = new PrintStream(s.getOutputStream()); p.print("GET /search?q="+query+" HTTP/1.0\r\n"); p.print("User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\n"); p.print("Connection: close\r\n\r\n"); InputStreamReader in = new InputStreamReader(s.getInputStream()); BufferedReader buffer = new BufferedReader(in); // String line; // // while ((line = buffer.readLine()) != null) // { System.out.println(line); } HTMLUtils.ParseLinks (buffer); in.close(); } } import java.io.BufferedReader; import java.io.IOException; //import java.io.FileReader; import java.io.Reader; import java.util.List; import java.util.ArrayList; import javax.swing.text.html.parser.ParserDelegator; import javax.swing.text.html.HTMLEditorKit.ParserCallback; import javax.swing.text.html.HTML.Tag; import javax.swing.text.html.HTML.Attribute; import javax.swing.text.MutableAttributeSet; public class HTMLUtils { private HTMLUtils() {} public static List extractLinks(Reader reader) throws IOException { final ArrayList list = new ArrayList (); ParserDelegator parserDelegator = new ParserDelegator(); ParserCallback parserCallback = new ParserCallback() { public void handleText(final char[] data, final int pos) { } public void handleStartTag(Tag tag, MutableAttributeSet attribute, int pos) { if (tag == Tag.A) { String address = (String) attribute.getAttribute(Attribute.HREF); list.add(address); } } public void handleEndTag(Tag t, final int pos) { } public void handleSimpleTag(Tag t, MutableAttributeSet a, final int pos) { } public void handleComment(final char[] data, final int pos) { } public void handleError(final java.lang.String errMsg, final int pos) { } }; parserDelegator.parse(reader, parserCallback, false); return list; } public static void ParseLinks(BufferedReader buffer) throws Exception{ //FileReader reader = new FileReader("buffer"); List links = HTMLUtils.extractLinks(buffer); for (String link : links) { System.out.println(link); } } } Notice that the user agent is for IE in this example. Now I Have 3 problems: How/can I pass the HTMLUtils.ParseLinks method a "raw buffer" instead of an HTML file she's expecting (I can write the buffer to a file but I guess that is unnecessary) I don't know how to enter inverted commas (" ") inside the query statment in order to get the whole string i.e.: query=" "New York Yankees" " Is it so complicated to get the User-Agent string from the host machine ??? link text I have to say that it is imported class that I use and I don't really understand whats going on there. I'll try to understand when it will work [-8 THNX
