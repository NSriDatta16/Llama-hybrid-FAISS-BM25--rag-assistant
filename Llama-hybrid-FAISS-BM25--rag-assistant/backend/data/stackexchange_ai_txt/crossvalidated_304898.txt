[site]: crossvalidated
[post_id]: 304898
[parent_id]: 304730
[tags]: 
Suppose an urn of $n$ balls begins with $s$ successes. What are the chances it will end up with $t$ successes ($0 \le t \le s$) after $d$ draws? Ignoring the trivial case $s=0$, this is a Markov chain on the numbers of successes $s$. The chance of a transition from $s$ to $s-1$ is $p(s,s-1)=s/n$; otherwise, the state stays the same: $p(s,s)=1-s/n$. The $n+1\times n+1$ transition matrix $\mathbb{P} = p(s,t)$ (indexing from $0$ through $n$) readily decomposes as $$\mathbb P = \mathbb{V}\operatorname{Diagonal}\left(\frac{n}{n}, \frac{n-1}{n}, \ldots, \frac{1}{n}, \frac{0}{n}\right) \mathbb{V}^{-1}$$ where $$\mathbb{V} = (v_{ij}, i=0,\ldots,n; j=0,\ldots, n) = \left(\binom{i}{j}\right)$$ is Pascal's Triangle and $$\mathbb{V}^{-1} = (v^{-1}_{ij}) = \left((-1)^{i+j}\binom{i}{j}\right)$$ contains the same values but with alternating signs. The chance of a transition from $s$ to $t$ after $d$ steps, $p_n(s,t)$, is found from the $s,t$ entry in $\mathbb{P}^n$ (again indexing from $0$ through $n$). But we easily compute $$\mathbb{P}^n= \mathbb{V}\operatorname{Diagonal}\left(\frac{n^d}{n^d}, \frac{(n-1)^d}{n^d}, \ldots, \frac{1^d}{n^d}, \frac{0^d}{n^d}\right)\mathbb{V}^{-1}.$$ Consequently, omitting all terms obviously zero, $$p_d(s,t) = n^{-d}\sum_{j=t}^s \binom{s}{j} (n-j)^d (-1)^{j+t}\binom{j}{t}.$$ These figures plot the chance of reaching an urn with $t$ successes starting with $s=100$ successes in $n=100$ total. The numbers of draws are 10,50,150,and 250. As they increase, the distribution moves to the left more and more slowly, first spreading and then contracting to zero. In terms of $t$, these are generalized hypergeometric distributions .
