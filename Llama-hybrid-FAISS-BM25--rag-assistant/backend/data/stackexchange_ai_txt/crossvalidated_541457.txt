[site]: crossvalidated
[post_id]: 541457
[parent_id]: 
[tags]: 
How is marginalisation being used in the proof of margin-based generalisation error bounds on AdaBoost in Freund & Schapire (2012)?

I am having difficulty in making explicit the use of a standard marginalisation identity in the proof of a lemma relating to a margin-based generalisation error bound on the AdaBoost algorithm. This is lemma 5.3 on p101 of Boosting: Foundations and Algorithms by Freund and Schapire (2012). Context. Prior to the part of the proof that I am struggling with, the authors state the following marginalisation identity, Below, $\mathbb{P}_{P}(\cdot)$ and $\mathbb{E}_{P}(\cdot)$ denote probability and expectation over the random choice of $(x, y)$ from $P$ , respectively. The proof uses marginalization , the principle that if $X$ and $Y$ are random variables, then the probability of any event $a$ can be computed as the expected probability of the event when one of the variables is held fixed: $$\mathbb{P}_{X, Y}(a) = \mathbb{E}_{X}[\mathbb{P}_{Y \, \vert \, X}(a | X)]$$ This is applied in the proof in the following way: Lemma 5.3 Suppose $P$ is any distribution over pairs $(x, y)$ . Then, for $\theta > 0$ and $n \geq 1$ , $$\mathbb{P}_{P, \tilde{f}} \left( \left \vert yf(x) - y \tilde{f}(x) \right \vert \geq \frac{\theta}{2} \right) \leq \beta_{n, \theta}.$$ Proof. Using marginalization and lemma 5.2, we have that $$\begin{aligned} \mathbb{P}_{P, \tilde{f}} \left( \left \vert yf(x) - y\tilde{f}(x) \right \vert \geq \frac{\theta}{2}\right) &= \mathbb{P}_{P, \tilde{f}} \left( \left \vert f(x) - \tilde{f}(x) \right \vert \geq \frac{\theta}{2} \right) \\ &= \mathbb{E}_{P} \left[ \mathbb{P}_{\tilde{f}} \left( \left \vert f(x) - \tilde{f}(x) \right \vert \geq \frac{\theta}{2} \right) \right] \\ &\leq \mathbb{E}_{P}[\beta_{n, \theta}] \\ &= \beta_{n, \theta}. \end{aligned}$$ Here, $(x, y)$ are input-label pairs drawn from a true, unknown joint distribution $P$ , so that $(x, y) \sim P$ . $\tilde{f}$ can be viewed as a function randomly drawn from a distribution $Q(\tilde{f} ; b)$ . In more detail, $\tilde{f}(x)$ is constructed as follows. The authors state that when $x \in \mathbb{R}$ is fixed, then $\tilde{f}(x)$ is given by $$\tilde{f}(x) = \sum^n_{i=1} \frac{1}{n} \tilde{h}_i(x), \quad \tilde{h}_1, \dots, \tilde{h}_n \sim D(\tilde{h}; a).$$ That is, $\tilde{f}(x)$ is an unweighted average of $n$ i.i.d. copies of a function $\tilde{h}$ drawn randomly from $D$ , each evaluated at a fixed $x \in \mathbb{R}$ . Furthermore, when $x$ is fixed, $\tilde{h}_i(x) \in \{-1, 1\}$ are random variables and so $\tilde{f}(x) \in -\{-1, 1\}$ is also a random variable. They then write: We assume throughout this proof that $\tilde{f}$ is selected in this random manner, denoting probability and expectations with respect to its random selection by $\mathbb{P}_{\tilde{f}}$ and $\mathbb{E}_{\tilde{f}}[\cdot]$ . The particular choice of $n$ will come later. Question. In going from the 1st equality of the proof below to the 2nd equality, can someone assist in making the decomposition of the joint distribution more explicit? In particular, does $\mathbb{P}_{\tilde{f}}$ within $\mathbb{E}_{P}[\cdot]$ refer to a conditional probability, or a marginal probability? While there is an implication that $\mathbb{P}_{\tilde{f}}$ is a conditional probability, no conditioning explicitly appears in $\mathbb{P}_{\tilde{f}}$ . On whether it is a marginal or conditional probability, I have reasoned that the two distinct sources of stochasticity are $(x, y) \sim P$ and $\tilde{f} \sim D$ , and it would seem that $(x, y)$ and $\tilde{f}$ are independent -- I can imagine drawing $(x, y)$ and $\tilde{f}$ 'out of separate bags'. But then I get confused as to whether there is dependence through $x$ in $\tilde{f}(x)$ . Related question. I previously asked this question about the identity only, not applied to the proof context, and received an answer by Ben , who suggested more context would be useful in this case. Alternative peer reviewed source. The marginalisation argument, together with the notation being used here is also in the original paper, "Schapire, R. E., Freund, Y., Bartlett, P., & Lee, W. S. (1998). Boosting the margin: A new explanation for the effectiveness of voting methods. The Annals of Statistics , 26(5), 1651â€“1686. https://doi.org/10.1214/aos/1024691352"
