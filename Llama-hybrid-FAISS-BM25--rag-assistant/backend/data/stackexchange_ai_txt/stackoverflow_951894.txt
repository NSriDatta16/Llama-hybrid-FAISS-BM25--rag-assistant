[site]: stackoverflow
[post_id]: 951894
[parent_id]: 951311
[tags]: 
Here's how you do it: SELECT astats.AQTORStatsID , astats.ServerName , astats.Remarks , astats.StatsBeginDateTime , astats.StatsEndDateTime , QtCPU_Average = max(case when asi.AQTORStatName = 'QtCPU_Average' then asi.AQTORStatValue end) , QtCPU_TopQuintile = max(case when asi.AQTORStatName = 'QtCPU_TopQuintile' then asi.AQTORStatValue end) , QtCPU_TopOnePercent = max(case when asi.AQTORStatName = 'QtCPU_TopOnePercent' then asi.AQTORStatValue end) , QtCl_Average = max(case when asi.AQTORStatName = 'QtCl_Average' then asi.AQTORStatValue end) , QtCl_TopQuintile = max(case when asi.AQTORStatName = 'QtCl_TopQuintile' then asi.AQTORStatValue end) , QtCl_TopOnePercent = max(case when asi.AQTORStatName = 'QtCl_TopOnePercent' then asi.AQTORStatValue end) , UpdPrcStd_Average = max(case when asi.AQTORStatName = 'UpdPrcStd_Average' then asi.AQTORStatValue end) , UpdPrcStd_TopQuintile = max(case when asi.AQTORStatName = 'UpdPrcStd_TopQuintile' then asi.AQTORStatValue end) , UpdPrcStd_TopOnePercent = max(case when asi.AQTORStatName = 'UpdPrcStd_TopOnePercent' then asi.AQTORStatValue end) , RcRsUPr_Average = max(case when asi.AQTORStatName = 'RcRsUPr_Average' then asi.AQTORStatValue end) , RcRsUPr_TopQuintile = max(case when asi.AQTORStatName = 'RcRsUPr_TopQuintile' then asi.AQTORStatValue end) , RcRsUPr_TopOnePercent = max(case when asi.AQTORStatName = 'RcRsUPr_TopOnePercent' then asi.AQTORStatValue end) from tb_dAQTORStats astats join tb_rAQTORStatsItem asi on asi.AQTORStatsID = astats.AQTORStatsID group by astats.AQTORStatsID , astats.ServerName , astats.Remarks , astats.StatsBeginDateTime , astats.StatsEndDateTime Notes: A good text editor with column mode or rectangular edit really helps with this kind of thing. UltraEdit or Emacs come to mind. I created the above in UltraEdit in about a minute. Your original query with the INNER JOINs would have dropped all readings for a given server if one type of reading was missing. Not good. This query will return one row per server for any server with at least one reading. If you want to return all servers, regardless of whether there are any readings, change the INNER JOIN to LEFT JOIN. You don't need a separate table for your stat names, unless you need to enforce data integrity through a foreign key.
