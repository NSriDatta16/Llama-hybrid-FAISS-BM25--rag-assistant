[site]: datascience
[post_id]: 110046
[parent_id]: 110021
[tags]: 
Since this is more of a programming question than a data science question it would be better suited for the stackoverflow stackexchange page, but this can done relatively easily using some of the functions from the tidyr library: library(tidyr) df % # count number of rows for each combination of server_id and protocol group_by(server_id, protocol) %>% tally() %>% # pivot the protocol names over the columns pivot_wider(names_from=protocol, values_from=n) %>% # replace NA values in all columns with 0 mutate(across(everything(), .fns=~replace_na(., 0))) Which returns the following dataframe: server_id A B C s1 1 1 2 s2 2 1 1 s3 1 2 0
