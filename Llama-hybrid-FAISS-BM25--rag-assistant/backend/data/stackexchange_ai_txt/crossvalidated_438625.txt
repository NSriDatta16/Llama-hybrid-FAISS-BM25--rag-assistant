[site]: crossvalidated
[post_id]: 438625
[parent_id]: 
[tags]: 
How to compare four conditions with nested subgroups of measurements in python?

I'd like to ask for some advice on what statistical inference I should run on my data with the following design: There are 4 conditions. Each subject was tested for each condition (->within subject factor). Furthermore, there were multiple measurements within a subject for each condition. With exact values: for each subject, there are 4x20 measurements, where 4 indicates the number of conditions. There are 40 subjects in total. There are no missing datapoints. My intention is to compare all possible pairs of the four conditions. I've been spending a long time on figuring out how to do this, but I still don't know. Now I got to the point where I'd rather seek help from the community. Can anyone suggest a proper procedure for statistical inference? I feel like this is a fairly common design which has to have a well-established method. I found some related questions with good answers, but I'd prefer a solution that can be implemented in python. Part of the reason I thought this could be a separate question. Let me explain my thought process: I could certainly take the average of the 20 measurements for the conditions within a subject, which would lead to 4x40 datapoints, on which I could simply run a one-way repeated measures ANOVA with four levels (if the assumptions are true), then follow-up with posthoc paired t-tests while adjusting for multiple comparisons. However, I don't want to waste the information contained by the individual measurements within a condition, by simply taking their averages. I'd rather want a model that considers those individual measurements. Instead, I thought let's just throw in all those measurements from all subjects into one hat within a condition, which would result in 40x20 datapoints for each condition. Then again, perform the same procedure I explained above, starting with the a one-way repeated measures ANOVA. This approach is clearly wrong, as measurements within a subject are not completely independent, since they are coming from the same subject. And so I started looking into more sophisticated models and I found multilevel linear regression models. I thought of using a random intercept two-level linear model, where the fixed effect is my four conditions and the random effect is the subject, in which can be found the individual datapoints. Using random intercepts, I could account for both the random effects of the subgroups (=subjects) and the within subject design (using the same the random intercept component for all conditions within a subject), while comparing the four conditions. I'm assuming the slope is not affected by the subject, just the offset. This seems a valid approach to me, but I'm having trouble with figuring out [1.] what if 3 conditions are the same and just one condition is an outlier, can a linear model handle this reliably? [2.] How can I perform post hoc pairwise comparisons of the conditions, while accounting for the within subject design? If I'm on the right path, can someone explain the solution to these two questions? If this is not the right approach, can you recommend a proper way that can be implemented in python? Thank you!
