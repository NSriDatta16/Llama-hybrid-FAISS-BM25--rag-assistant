[site]: crossvalidated
[post_id]: 96946
[parent_id]: 
[tags]: 
Understanding an Implementation of normal conjugate in R

I am reading a code for a Bayesian clustering method. Both prior and the likelihood are normally distributed. If I understood correctly, such cases are called "conjugate priors" My question is about calculating the posterior mean and variance. So it is implemented in the code as following d = nrow (data.i)##number of attributes n = ncol (data.i)##number of replication for each attribute Smatrix = matrix (1, nrow=d, ncol=d)##correlation of attributes Imatrix = Smatrix - 1 diag (Imatrix) = 1 prior.precision = solve (sdWICluster^2 * Smatrix + sdTSampling^2 * Imatrix) #inverting the prior correlation matrix (prior.precision) prior.mean = cluster.mean # mean of each clusters sample.precision = sdResidual^(-2) * Imatrix sample.mean = apply (data.i, 1, mean)#mean for each cluster post.cov = solve (as.matrix(prior.precision + n*sample.precision)) # posterior covariance matrix post.mean = as.vector (post.cov %*% (prior.precision %*% prior.mean + n*sample.precision %*% sample.mean)) # posterior of the mean it seems the code has take the following formula, $\mu_{po} = C_{po}\times((\mu_{pr} \times \tau_{pr})+(n\times\tau_{li}\times\mu_{li}))$ $C_{po} = \tau_{pr} + n\times\tau_{li}$ As I said, this is the case of conjugates of normal distributions with unknown mean but variance known; however, it does not fit to the formula I have from here . (or may be it does by my eye is not able to catch). I appreciate if someone make some comments about the code and the formula
