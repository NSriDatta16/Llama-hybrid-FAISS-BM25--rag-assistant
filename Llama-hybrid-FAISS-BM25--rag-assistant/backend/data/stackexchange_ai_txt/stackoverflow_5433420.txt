[site]: stackoverflow
[post_id]: 5433420
[parent_id]: 5433262
[tags]: 
You really want to use a proper HTML filtering library, such as HTMLPurifier , especially since you're planning to use the submitted content for displaying styles. HTMLPurifier considers both attributes, css and other inline styles to avoid XSS, and will also attempt to make sense (by using Tidy as already suggested) of your HTML and clean up any missing tags (to ensure that the resulting fragment is XHTML compliant). I don't think that Tidy will attempt to remove any evil XSS segments.
