[site]: crossvalidated
[post_id]: 610669
[parent_id]: 
[tags]: 
Question on Gibbs sampler, estimate the density function

I am reading the paper Explaining the Gibbs Sampler(Casella, George, and Edward I. George. "Explaining the Gibbs sampler." The American Statistician 46.3 (1992): 167-174). I am stuck with example 2, Figure 2, as how the solid line was created from the equation $(2.9)$ . The paper can be downloaded here: http://www2.stat.duke.edu/~scs/Courses/Stat376/Papers/Basic/CasellaGeorge1992.pdf The figure is here : The paper says' Gibbs sampling can be used to estimate the density itself by averaging the final conditional densities from each Gibbs Sequence. I know how to create the final Gibbs sequence for example 2. Here is an excellent example of how to create these sequences ( Gibbs sampler for conditionals that are exponential: Example from Casella & George paper ). I know I can use the Kernel density method to estimate the density function using the 500 final sample points. However, this was not the method the paper used. Here is the code to produce 500 final sample points, which I copied from the above URL. set.seed(1010) X = rep(0, 500) Y = rep(0, 500) k = 15 for (i in 1:500) { x = rep(1, k) y = rep(1, k) for (j in 2:k) { temp_x = 6 while(temp_x>5) { x[j] = rexp(1,y[j-1]) temp_x = x[j] } temp_y = 6 while(temp_y>5) { y[j] = rexp(1,x[j]) temp_y = y[j] } } X[i] = x[k] Y[i] = y[k] } From these values, we can calculate the density by equation $(2.8a)$ . In the equation $(2.9)$ we have a fixed $x$ value, such as if we let $x=\xi $ then equation $(2.9)$ becomes $$\hat{f}(\xi)=\frac{1}{m}\left[f(\xi|y_1)+f(\xi|y_2)+f(\xi|y_3)+...+f(\xi|y_m)\right]$$ I think the Gibbs Sampler did not produce a fixed last value (15th) $\xi$ for the 500 sequences. I am stuck here. I hope you can help me. Anyway, overall the question is how the solid line in figure 2 was produced.
