[site]: crossvalidated
[post_id]: 575161
[parent_id]: 
[tags]: 
MCMC simulations in R for a simple poisson model

I would like to put together my own R function for MCMC simulations rather than using a R package or Winbugs. This is purely to ensure I understand what is going on. I have used the R Nimble package to construct a very simple model and to run the simulations. The model code is as follows and from what I can see has ran successfully: library(nimble) ModelCode Using this R Nimble package I have been able to obtain summary statistics from the posterior distribution as needed. However, as this is a simple model I wanted to put together an R function that does this from scratch in order to understand more fully what is going on. There are some simple examples of the metropolis Hastings algorithm online that I am looking at but it is not clear to me how to expand these for two initial unknowns (alpha and beta) as per the model above. Some code for sampling an exponential distribution is shown below. log_exp_target = function(x){ return(dexp(x,rate=1, log=TRUE)) } easyMCMC = function(log_target, niter, startval, proposalsd){ x = rep(0,niter) x[1] = startval for(i in 2:niter){ currentx = x[i-1] proposedx = rnorm(1,mean=currentx,sd=proposalsd) A = exp(log_target(proposedx) - log_target(currentx)) if(runif(1) I will continue reading but any code for this would be gratefully received.
