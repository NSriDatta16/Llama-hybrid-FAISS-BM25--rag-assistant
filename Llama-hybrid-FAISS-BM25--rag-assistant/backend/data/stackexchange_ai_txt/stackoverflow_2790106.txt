[site]: stackoverflow
[post_id]: 2790106
[parent_id]: 2789979
[tags]: 
First of all, NEVER EVER compare a value to true. It's if Condition1 then begin end else if Condition2 then begin end; Comparing to true can, in the worst case, fail even if the value is true. There is a good (but german) article 'Ãœber den Umgang mit Boolean' in the Delphi-PRAXiS.net community forums wich shows an example to reproduce this strange-seeming behaviour. Regarding your question directly: This code would be better in a custom paint event. This will get called for every cell and directly paint it with the correct colors. And it well draw in the correct colors even when repainted. In your event you would only draw the cells once, and if - for any reason - the grid repaints your color would be lost. Then, after all, this code is stringly UI and component related. If you hadn't this grid on your form, you wouldn't need this code. What you could do to decouple things a bit is to pass the values retrieved from the grid row to an external unit that will do only the calculation and returns a logical result. Your UI code on the form then would take this result and has to decide how it has to be displayed (ie. what color etc.) and put the information on the grid.
