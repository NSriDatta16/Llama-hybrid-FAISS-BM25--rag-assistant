[site]: crossvalidated
[post_id]: 548956
[parent_id]: 
[tags]: 
What is the result of $\frac{\partial^2 \ell(\beta)}{\partial \beta \partial \beta^T}$?

For logistic regression model, the log-likelihood function can be written as $$\ell(\beta)=\sum_{i=1}^N(y_i\beta^Tx_i-\log(1+e^{\beta^Tx_i}))$$ This is a $(p+1)$ nonlinear equations in $\beta$ . To solve this problem, we use the Newton-Raphson algorithm, which requires the second-derivative $$\frac{\partial^2 \ell(\beta)}{\partial \beta \partial \beta^T}=-\sum_{i=1}^Nx_ix_i^Tp(x_i;\beta)(1-p(x_i;\beta)) \,(*)$$ where $p(x_i;\beta)=1-\frac{1}{1+e^{\beta^Tx_i}}$ . My question is how to get (*)? I know that $$\frac{\partial \ell}{\partial \beta }=\sum_i (y_ix_i-\frac{e^{\beta^Tx_i}x_i}{1+e^{\beta^Tx_i}})\in R^{(p+1)\times 1}$$ But what is $$\frac{\partial^2 \ell(\beta)}{\partial \beta \partial \beta^T}?$$ I get $$\frac{\partial^2 \ell(\beta)}{\partial \beta \partial \beta^T}=\frac{\partial}{\partial \beta^T }(\sum_i (y_ix_i-\frac{e^{\beta^Tx_i}x_i}{1+e^{\beta^Tx_i}}))=?$$
