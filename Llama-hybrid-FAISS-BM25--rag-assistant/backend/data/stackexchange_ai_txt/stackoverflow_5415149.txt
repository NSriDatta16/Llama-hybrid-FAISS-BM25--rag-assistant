[site]: stackoverflow
[post_id]: 5415149
[parent_id]: 
[tags]: 
problem setting progress bar before alert dialog which has a spinner

public class classified extends Activity { private ArrayAdapter aaagency ; String strdata=""; String strerrormess=""; public void onCreate(Bundle savedInstanceState) { setTitle("Classified Ad. Booking"); super.onCreate(savedInstanceState); this.setContentView(R.layout.classified); } public void srcAgency(View view) throws IOException { Log.i("Classified Ad","srcAgency"); new srcAgency().execute(); srcAgency srcagen = new srcAgency(); strdata = srcagen.strtempdata; Log.i("AgencyData2", strdata); Log.i("AgencyData3", strerrmess); if(strerrmess.equals("")) { strarr= fun1.split(strdata, "^"); aaagency = new ArrayAdapter (this, android.R.layout.simple_spinner_dropdown_item , strarr); AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle("Agency"); builder.setAdapter(aaagency, new DialogInterface.OnClickListener() { public void onClick(DialogInterface dialog, int item) { txtAgency.setText(strarr[item]); } }); builder.show(); } } class srcAgency extends AsyncTask { String strtempdata=""; ProgressDialog dialog; @Override protected void onPreExecute() { strerrmess=""; super.onPreExecute(); dialog = ProgressDialog.show(classified.this, "", "Please wait...", true); dialog.show(); } @Override protected Void doInBackground(Void... unused) { try { stragency = txtAgency.getText().toString().trim(); intagencyBrac1= stragency.lastIndexOf('('); intagencyBrac2= stragency.lastIndexOf(')'); if (stragency.length() =0||intagencyBrac2>=0) {strerrmess="Please Enter Characters for Agency Searching";} else { if(stragency.indexOf(' ')!=-1) {stragency = stragency.replace(' ', '!');} Log.i("AgencyUrl",strurl); strdata = "Client1^Client2^Client3^Client4^Client5^Client6^Client1"; Log.i("AgencyData",strdata); strtempdata = strdata; if(!strdata.equals("")) { } else {strerrmess ="No Data Available";} } } catch(Exception e) { } return null; } @Override protected void onPostExecute(Void unused) { dialog.dismiss(); if (strerrmess.equals("Please Enter atleast 3 Characters for Agency Searching")) {Toast(strerrmess);intflag=1;} else if(strerrmess.equals("Please Enter Characters for Agency Searching")) {Toast(strerrmess);intflag=1;} else if(strerrmess.equals("Your Session Got Expired. Please login again.")) { Intent intent = new Intent(classified.this, loginscreen.class); startActivity(intent); Toast(strerrmess); intflag=1; } else {intflag=0;} } } } I am unable to get the value of strdata which i have initialized in asynctask function in the srcagency function. What should I do? Even though strdata is a global variable. I have also tried this but I think you can't initialize array adapter in onpostexecute function... @Override protected void onPostExecute(Void unused) { dialog.dismiss(); if (strerrmess.equals("Please Enter atleast 3 Characters for Agency Searching")) {Toast(strerrmess);intflag=1;} else if(strerrmess.equals("Please Enter Characters for Agency Searching")) {Toast(strerrmess);intflag=1;} else if(strerrmess.equals("Your Session Got Expired. Please login again.")) { Intent intent = new Intent(classified.this, loginscreen.class); startActivity(intent); Toast(strerrmess); intflag=1; } else {strarr= fun1.split(strdata, "^"); aaagency = new ArrayAdapter (this, android.R.layout.simple_spinner_dropdown_item , strarr); AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle("Agency"); builder.setAdapter(aaagency, new DialogInterface.OnClickListener() { public void onClick(DialogInterface dialog, int item) { txtAgency.setText(strarr[item]); } }); builder.show();} } Any help or comments would be appreciated. Thanks
