[site]: crossvalidated
[post_id]: 423329
[parent_id]: 422201
[tags]: 
@BruceET is right in that you would need to first verify there there is no carryover effect in order to perform your suggested operations. I do see in your question, you state the assumption that "those two instances are far enough in time such that one instance is not interfering with the other", by which you mean to assume there is no carryover effect. Given this assumption, it would be valid to calculate the causal effect of the drug as the difference between the two instances. Also do note that if these treatments (and non-treatments) were assigned rather than observed , you may have to deal with non-compliance (people who were given the drug but do not take it, or people who were not given the drug and took it anyways, or people who took other drugs that may cure headache). You may consider calculating the Local Average Treatment Effect (LATE) rather than the Average Treatment Effect (ATE).
