[site]: crossvalidated
[post_id]: 628163
[parent_id]: 
[tags]: 
GLS when error covariance matrix depends on regression coefficient

My data is a pair of points (x1, y1) & (x2, y2) [Just in case it's relevant, I explain how the data is created at the end]. I know how the data points are correlated. For a GLS (generalized least squares) analysis, I can represent the structure of the error with the following matrix: $$ \begin{array}{c|lcr} & x_1 & x_2 & y_1 & y_2 \\ \hline x_1 & 1 & \dfrac{1}{2} & \dfrac{3ρ}{4} & \dfrac{ρ}{2}\\ x_2 & \dfrac{1}{2} & 1 & \dfrac{ρ}{2} & \dfrac{3ρ}{4}\\ y_1 & \dfrac{3ρ}{4} & \dfrac{ρ}{2} & 1 & \dfrac{1}{2}+\dfrac{ρ^2}{4}\\ y_2 & \dfrac{ρ}{2} & \dfrac{3ρ}{4} & \dfrac{1}{2}+\dfrac{ρ^2}{4} & 1 \end{array} $$ where ρ, rho, is the correlation between x and y, and what I am trying to solve for by regressing y on x. However, I am stuck because the correlation of y1 and y2 is a function of ρ. It seems obvious to me that this shouldn't cause any problems at all, but I am very bad at statistics and have no idea how to do a GLS when my variance-covariance error matrix is a function of ρ. While a mathematical explanation of what to do is appreciated (& sufficient), what I need most is R code that will take this type of matrix and a set of points (x1, y1), (x2,y2) and estimate ρ (& beta). The origin of this question and of this data comes from my field of evolutionary biology where we commonly model evolution as a brownian motion process, if y is log(body mass) and x is average seasonal temperature, we want to run a regression on how log(body mass) depends on the seasonal temperature. Our hypothesis is that colder temperatures favor larger animals. We model both the traits as evolving via brownian motion on a phylogenetic tree with shared ancestry (see tree below). I want to test "causation" by seeing if one of the trait's changes precedes changes in the other. Let's say my hypothesis is that colder temperatures happen 0.5 time units before subsequent changes in body mass. Under this model, changes in y along yb and yc will still be correlated with how x changed along xa, thus causing y1 and y2 to be correlated as a function of ρ. Because the total time that passes in the evolutionary example below is 2 units, and the second species is birthed and starts evolving separately after 1 time unit, and because there is a 0.5 time unit delay, the correlation matrix above results, as can be seen by looking at the correlations in the tree diagram below. This is a very simple example with two traits and two species, but ideally I need an approach that will work for arbitrarily many species and traits. Thanks again! - Figure: Caption:While evolution is occurring the entire time, for illustration purposes, I show a small excerpt of the X variable's evolution (green line) and the Y variable's (yellow line). Note that because Y evolves with a 0.5 time unit delay, the change in the Y variable across the yellow line has ρ correlation with the change in X along the green line.
