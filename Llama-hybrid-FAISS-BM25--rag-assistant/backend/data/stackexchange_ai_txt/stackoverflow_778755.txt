[site]: stackoverflow
[post_id]: 778755
[parent_id]: 777316
[tags]: 
GetForegroundWindow() returns the window which currently receives user input, it doesn't necessarily need to be on top of all others. A window can be set to be "topmost" with the SetWindowPos() function which will cause it to be ontop of other windows even if it doesn't have the focus (i think this is what you mean by popup window). You could probably force your window to be ontop of these by making it a topmost window too by calling SetWindowPos() with HWND_TOPMOST as the second parameter. Since the window has the input focus it should then end up on top of all topmost windows. If the window is not your own window, you have to make sure to put it back to its original state after you did your screen grabing. To find out if the window was topmost to begin with, call GetWindowLongPtr(myWindowHandle, GWL_EXSTYLE ) and see if the WS_EX_TOPMOST style was set.
