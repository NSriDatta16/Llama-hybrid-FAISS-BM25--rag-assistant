[site]: crossvalidated
[post_id]: 641922
[parent_id]: 
[tags]: 
Question about using the RFpredInterval Package: How to calculate the standard deviation of data points in same terminal node as test data point

I am using the RFpredInterval package (specifically the rfpi function) to obtain prediction intervals for a random forest. I would like to estimate the confidence intervals for my test data set by taking the standard deviation of data points in same terminal node as each test data point (also referred to as BOP data). I have tried doing this (detailed below) however I don't think I am correctly pulling the correct BOP/terminal node data to take the standard deviation of. I edited the rfpi function to return the "BOPtest" term created within the function, thinking this could be a list of the BOP data for each data point in the testing data set. I checked if this was the correct term by taking the mean of each element in the BOPtest list, as this is how the random forest algorithm calculates the final predictedoutput. However this is not the case. If anyone could help me out in deciphering the code within the rfpi function to pull the BOP data it would be much appreciated. Here is an example of what I've done ## load example data data(BostonHousing, package = "RFpredInterval") set.seed(2345) ## define train/test split testindex $test_pred, testdata$ medv, bop.mean, bop.sd)) colnames(result_df) I figured result_df $pred and result_df$ bop_mean should be equal. Here are links to the rfpi function page on github: https://github.com/cran/RFpredInterval/blob/master/R/rfpi.R I also had to load these functions: https://github.com/cran/RFpredInterval/blob/master/R/build.bop.R https://github.com/cran/RFpredInterval/blob/master/R/calibration.functions.R https://github.com/cran/RFpredInterval/blob/master/R/formpi.functions.R
