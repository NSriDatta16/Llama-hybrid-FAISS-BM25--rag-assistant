[site]: stackoverflow
[post_id]: 2999717
[parent_id]: 2995957
[tags]: 
The link I provided in your other question gives you all the information you need to do this. In semi-pseudocode: DiskDevice = CreateFile(DiskDevicePath); DiskDeviceNumber = DeviceIoControl(DiskDevice, IOCTL_STORAGE_GET_DEVICE_NUMBER); for each VolumeDevicePath in GetLogicalDriveStrings VolumeDevice = CreateFile(VolumeDevicePath); VolumeDeviceNumber = DeviceIoControl(VolumeDevice, IOCTL_STORAGE_GET_DEVICE_NUMBER); if(VolumeDeviceNumber == DiskDeviceNumber) // volume (i.e. "G:") corresponding to VolumeDevicePath resides on disk (i.e. "XYZ USB Storage Device") corresponding to DiskDevicePath I'm not 100% sure (it's been a while), but I think that the Disk device (GUID_DEVINTERFACE_DISK) is a child of the USB device (GUID_DEVINTERFACE_USB_DEVICE). In any event, I think DiskDevicePath needs to be the path of the Disk device (not the USB device).
