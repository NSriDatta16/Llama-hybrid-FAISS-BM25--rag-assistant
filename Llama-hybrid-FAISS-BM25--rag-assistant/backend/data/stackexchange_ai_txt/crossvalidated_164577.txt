[site]: crossvalidated
[post_id]: 164577
[parent_id]: 164573
[tags]: 
That whole area is called "Hierarchical Forecasting". Rob Hyndman has some material that could be helpful to conceptualize the problem. You could use standard clustering techniques (kmeans, dbscan, hierarchichal clustering, PAM, clara,k-medoids, etc) along with product line classification to identify your "units of demand". Since you are dealing with time series you should use a distance or dissimilarity measure that takes that into consideration. This link to SE discussion https://quant.stackexchange.com/questions/848/time-series-similarity-measures considers several similarities measures that can be helpful. In your case given the substitution effect, you need to apply some simple transformation that takes into account that "close" time series are those with highly positively or highly negative correlation. For example if you use some form of correlation rho, transforming it with: d=1 - abs(rho) or d=1 - rho^2 you could use them in a standard clustering algorithm. Chapter about Hierarchical Clustering in Rob Hyndman book http://www.otexts.org/fpp/9/4
