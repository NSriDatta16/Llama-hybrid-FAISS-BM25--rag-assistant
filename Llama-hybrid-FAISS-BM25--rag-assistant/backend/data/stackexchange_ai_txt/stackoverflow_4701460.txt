[site]: stackoverflow
[post_id]: 4701460
[parent_id]: 
[tags]: 
Facebook Chat difficulty user's JID

I've a problem connecting to Facebook's XMPP to use chat api. In fact the only problem is that I don't know the JID, sometime user doesn't have provided his username and it won't work simply by settings his/her userID as an JID. I've tried my own JID from facebook that I use in iChat and it worked perfectly. So, according to the docs I should rather log user to the chat by using access token instead of username/password. I'm successfuly logged in, the accesss token is in the form: 18112...|f6daa87...-1392...|qE7...-sD6... Now I use the XMPPFramework with XMPPStreamFacebook by Eric Chamberlain. This is my method starting the chat -(void)launchService { if (xmppStream) { [xmppStream release]; xmppStream = nil; } xmppStream = [[XMPPStreamFacebook alloc] init]; xmpReconnect = [[XMPPReconnect alloc] initWithStream:xmppStream]; if (xmppRosterStorage) { [xmppRosterStorage release]; xmppRosterStorage = nil; } xmppRosterStorage = [[XMPPRosterCoreDataStorage alloc] init]; if (xmppRoster) { [xmppRoster release]; xmppRoster = nil; } xmppRoster = [[XMPPRoster alloc] initWithStream:xmppStream rosterStorage:xmppRosterStorage]; [xmppStream addDelegate:self]; [xmppRoster addDelegate:self]; [xmppRoster setAutoRoster:YES]; [xmppStream setHostName:@"chat.facebook.com"]; [xmppStream setHostPort:5222]; [xmppStream setMyJID:[XMPPJID jidWithString:@"test@chat.facebook.com"]]; // You may need to alter these settings depending on the server you're connecting to allowSelfSignedCertificates = NO; allowSSLHostNameMismatch = NO; // Uncomment me when the proper information has been entered above. NSError *error = nil; if (![xmppStream connect:&error]) NSLog(@"Error connecting: %@", error); } and - (void)xmppStreamDidConnect:(XMPPStream *)sender { NSError *error = nil; // [xmppStream authenticateWithAccessToken:[self appDelegate].token error:&error]; NSLog(@"---------- xmppStreamDidConnect: ----------"); isOpen = YES; if (![[self xmppStream] authenticateWithAccessToken:[self appDelegate].token error:&error]) { NSLog(@"Error authenticating: %@", error); } } - (void)xmppStream:(XMPPStream *)sender didNotAuthenticate:(NSXMLElement *)error { NSLog(@"---------- xmppStream:didNotAuthenticate: ---------- %@ desc %@",error,[error description]); } ... In the console I get: 2011-01-15 19:41:06.547 Facebookwebsiteziosfbconnect[81160:207] SEND: 2011-01-15 19:41:06.548 Facebookwebsiteziosfbconnect[81160:207] SEND: 2011-01-15 19:41:06.920 Facebookwebsiteziosfbconnect[81160:207] RECV: 2011-01-15 19:41:06.922 Facebookwebsiteziosfbconnect[81160:207] RECV: X-FACEBOOK-PLATFORM DIGEST-MD5 2011-01-15 19:41:06.922 Facebookwebsiteziosfbconnect[81160:207] ---------- xmppStreamDidConnect: ---------- 2011-01-15 19:41:07.829 Facebookwebsiteziosfbconnect[81160:207] ---------- xmppStream:didNotAuthenticate: ---------- (null) desc (null) I just want to confirm that if I provided the real login (that I use in iChat) instead of test@chat.facebook.com, and my password authentication in didConnect everything the authentication works. Does anyone see the problem? Thx in advance.
