[site]: crossvalidated
[post_id]: 586572
[parent_id]: 
[tags]: 
How to find PCA solution using matrix derivatives?

I'm trying to derive PCA using matrix derivative. Most textbook tend to firstly derive the base case when $L=1$ , where $L$ is the dimension of transformed vectors $z$ . Notation: $\mathbf{X}_{N\times D}$ is the design matrix (data matrix) and $\mathbf{W}_{D\times L}$ is the PCA transformation. And $\mathbf{W}$ should be orthogonal. Basically, I want to solve the optimization problem as follows: $$\mathcal{L}(\mathbf{W},\mathbf{Z})=\frac{1}{N}\|\mathbf{X}-\mathbf{Z}\mathbf{W}^T\|_F^2 \quad \text{s.t.}\quad\mathbf{W}\text{ is orthogonal}$$ My attempt is to first take derivative w.r.t. $\mathbf{Z}$ and use Lagrangian Multiplier to solve $\mathbf{W}$ . $$\frac{\partial \mathcal{L}}{\partial \mathbf{Z}}=\frac{1}{N}(-2\mathbf{XW}+2\mathbf{Z})=\mathbf{0}\Rightarrow \mathbf{Z}=\mathbf{XW}$$ That's my desired result and plug $\mathbf{Z^*=XW}$ in $\mathcal{L}$ . We get $$\mathcal{L}(\mathbf{W},\mathbf{Z}^*)=\frac{1}{N}\text{tr}[\mathbf{X}^T\mathbf{X}-\mathbf{W^TX^TXW}]$$ . Now I want to use Lagrangian multiplier method to tackle the constraint optmization problem. However, I'm stuck by how to appropriately describe $\mathbf{W}$ is orthogonal. I've tried to use the equivalent statement that $\|\mathbf{W}^T\mathbf{W}-I\|_F^2=0$ . But the resulting derivative is so pretty weird which involves $\mathbf{WW^TW}$ .
