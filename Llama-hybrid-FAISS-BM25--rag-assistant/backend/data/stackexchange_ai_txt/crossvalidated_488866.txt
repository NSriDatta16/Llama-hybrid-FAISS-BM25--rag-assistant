[site]: crossvalidated
[post_id]: 488866
[parent_id]: 
[tags]: 
Estimating conditional probabilities in the context of finite state discrete time Markov chains of order p

Consider a Markov chain with evenly observed discrete times, where the order of the Markov chain is 1. Then we may estimate the transition probability of the Markov chain using sample proportions. Letting $X_t$ be the state of the Markov chain at time $t$ , this means that to estimate \begin{equation} \mathbf{P}_{ij}=P(X_{t+1}=j\mid X_t=i) \end{equation} we consider the ratio of $n_{ij}$ , which is the number of times the process moved from $i$ to $j$ , to $\sum_{k}n_{ik}$ , which is the total number of entities that began at time $t$ - i.e. \begin{equation} \hat{\mathbf{P}}_{ij}=\frac{n_{ij}}{\sum_kn_{ik}} \end{equation} Now consider the case where the Markov process is of order $p$ , such that \begin{align} \mathbf{P}_{i_{t+1}\mid i_{t},\cdots,i_{1}}&=P(X_{t+1}=i_{t+1}\mid X_{t}=i_{t},\cdots X_{1}=i_{1})\\ &=P(X_{t+1}=i_{t+1}\mid X_{t}=i_{t},\cdots X_{t-p}=i_{t-p}) \quad p\geq 1 \end{align} and suppose we wish to estimate the conditional probability \begin{equation} \mathbf{P}_{i_{t+1}\mid i_{t-q}}=P(X_{t+1}=i_{t+1}\mid X_{t-q}=i_{t-q})\quad\text{where}\quad p\geq q\geq1 \end{equation} Would it be correct to use the same sample proportion? - i.e. \begin{equation} \hat{\mathbf{P}}_{i_{t+1}\mid i_{t-q}}=\frac{n_{i_{t-q}i_{t+1}}}{\sum_{k_{t+1}}n_{i_{t-q}k_{t+1}}} \end{equation}
