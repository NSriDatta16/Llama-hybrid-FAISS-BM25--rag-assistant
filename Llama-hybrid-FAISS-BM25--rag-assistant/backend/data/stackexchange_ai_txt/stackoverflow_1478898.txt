[site]: stackoverflow
[post_id]: 1478898
[parent_id]: 1478853
[tags]: 
Check your SELECT block, it reads: SELECT agentName, SUM(sales1.Amount) AS Gross1, SUM(sales1.Amount * sales1.Commission) AS Commission1, SUM(sales2.Amount) AS Gross2, SUM(sales2.Amount * sales2.Commission) AS Commission2 and you are joining on a SALES3 table whose values are not present in the SELECT clause. This confuses SQL Server. Remove the INNER JOIN on Sales3 and it's OR piece in the WHERE block and it'll work. OR Add those items to the SELECT block.
