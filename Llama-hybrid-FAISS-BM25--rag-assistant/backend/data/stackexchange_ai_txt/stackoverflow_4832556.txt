[site]: stackoverflow
[post_id]: 4832556
[parent_id]: 4832068
[tags]: 
Have you tried writing the SELECT part of the query like this. It should return the same result. It works in two steps: First it calculates the required minimum and maximum values and then it does some NULL value replacement. (Your CASE statements seem to be overly complex since you haven't considered that an empty string and NULL are the same in Oracle.) I'd be very intersted to know if the inner SELECT has already wrong maximum result. SELECT matchKey as matchKey , NVL(contributionP ,0 ) as contributionP , NVL(stimulusContributionP ,0 ) as stimulusContributionP , NVL(contributionC ,0 ) as contributionC , NVL(ageMultiplier ,0 ) as ageMultiplier , NVL(rateTableIdP ,0 ) as rateTableIdP , NVL(rateTableIdC ,0 ) as rateTableIdC , NVL(accountNbrP ,0 ) as accountNbrP , NVL(accountNbrC ,0 ) as accountNbrC , NVL(commissionExpenseAccount ,0 ) as commissionExpenseAccount , NVL(commissionReceivableAccount ,0 ) as commissionReceivableAccount , NVL(commissionType ,0 ) as commissionType , NVL(commission ,0 ) as commission , NVL(pmPm ,0 ) as pmPm , NVL(fee ,0 ) as fee , NVL(planAgeGroupIdP ,0 ) as planAgeGroupIdP , NVL(planAgeGroupIdC ,0 ) as planAgeGroupIdC , NVL(rafP ,0 ) as rafP , NVL(rafC ,0 ) as rafC , NVL(nbrEmployeesRafP ,0 ) as nbrEmployeesRafP , NVL(nbrEmployeesRafC ,0 ) as nbrEmployeesRafC , CASE WHEN maxContractId = 'No Contract No' THEN minContractId ELSE maxContractId END as contractId , NVL(basePlanId ,0 ) as basePlanId , CASE WHEN maxGroupOrPolicyNumber = 'No Contract No' THEN minGroupOrPolicyNumber ELSE maxGroupOrPolicyNumber END as groupOrPolicyNumber , CASE WHEN maxPlanCoverageDescription = 'No Contract No' THEN minPlanCoverageDescription ELSE maxPlanCoverageDescription END as planCoverageDescription , CASE WHEN maxCobraGopn = 'No Contract No' THEN minCobraGopn ELSE maxCobraGopn END as cobraGopn , CASE WHEN maxCobraPcd = 'No Contract No' THEN minCobraPcd ELSE maxCobraPcd END as cobraPcd , CASE WHEN maxCobraCid = 'No Contract No' THEN minCobraCid ELSE maxCobraCid END as cobraCid , benefitId as benefitId , NULL as insuranceStart , NULL as insuranceEnd , NULL as categoryId FROM ( SELECT matchKey as matchKey , MAX(contributionP ) as contributionP , MAX(stimulusContributionP ) as stimulusContributionP , MAX(contributionC ) as contributionC , MAX(ageMultiplier ) as ageMultiplier , MAX(rateTableIdP ) as rateTableIdP , MAX(rateTableIdC ) as rateTableIdC , MAX(accountNbrP ) as accountNbrP , MAX(accountNbrC ) as accountNbrC , MAX(commissionExpenseAccount ) as commissionExpenseAccount , MAX(commissionReceivableAccount ) as commissionReceivableAccount , MAX(commissionType ) as commissionType , MAX(commission ) as commission , MAX(pmPm ) as pmPm , MAX(fee ) as fee , MAX(planAgeGroupIdP ) as planAgeGroupIdP , MAX(planAgeGroupIdC ) as planAgeGroupIdC , MAX(rafP ) as rafP , MAX(rafC ) as rafC , MAX(nbrEmployeesRafP ) as nbrEmployeesRafP , MAX(nbrEmployeesRafC ) as nbrEmployeesRafC , MIN(contractId ) as minContractId , MAX(contractId ) as maxContractId , MAX(basePlanId ) as basePlanId , MIN(groupOrPolicyNumber ) as minGroupOrPolicyNumber , MAX(groupOrPolicyNumber ) as maxGroupOrPolicyNumber , MIN(planCoverageDescription ) as minPlanCoverageDescription , MAX(planCoverageDescription ) as maxPlanCoverageDescription , MIN(cobraGopn ) as minCobraGopn , MAX(cobraGopn ) as maxCobraGopn , MIN(cobraPcd ) as mincobraPcd , MAX(cobraPcd ) as maxcobraPcd , MIN(cobraCid ) as minCobraCid , MAX(cobraCid ) as maxCobraCid , MAX(benefitId ) as benefitId FROM meCostingXPrePrePre GROUP BY matchKey );
