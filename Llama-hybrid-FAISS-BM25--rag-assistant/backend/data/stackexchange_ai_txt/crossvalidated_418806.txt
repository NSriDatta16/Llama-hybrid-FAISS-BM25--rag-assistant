[site]: crossvalidated
[post_id]: 418806
[parent_id]: 
[tags]: 
Rolling intercept estimation for a data panel

I am working with a panel containing $T$ daily observations (one for each $t = 1, 2, ..., T$ ) for each element $i$ ( $i = 1, 2, ..., N$ ) of the dependent variable $y$ . The panel is unbalanced because some of the $y_{it}$ were not observed for all days. Specifically, $y_{it}$ would be the return of company $i$ on day $t$ . I am interested in calculating, for each element $i$ and for each month $t'$ ( $t' = 1, 2, ..., T'$ ), the intercept coefficient from a regression of the $y_{it}$ on a common factor $x_t$ (think a market index return). $x_t$ is not specific to any $i$ element (because the market index is unique), but can of course be expressed in the form $X_{it}$ by simply replicating its values on each day for each element $i$ in the sample. I have though of two possible procedures to achieve my objective: Run the following time series regression for each $i$ ( $i = 1, 2, ..., N$ ) and each month $t'$ ( $t' = 1, 2, ..., T'$ ) in the sample: $y_{it} = \alpha_i + b_ix_t + u_{it}$ . This should result in a series of $T'$ $\alpha_i$ values, one for each element $i$ and each month $t'$ . Alternatively, run a fixed-effects panel regression at each month $t'$ : $Y_{it} = \beta X_{it} + \alpha_i + u_{it}$ , where $\alpha_i$ would be the time-invariant (within each month $t'$ ) individual effect (for each $i$ -th individual firm). First, are the two procedures correctly defined? Second, how can I determine which of the two is more appropriate for my analysis?
