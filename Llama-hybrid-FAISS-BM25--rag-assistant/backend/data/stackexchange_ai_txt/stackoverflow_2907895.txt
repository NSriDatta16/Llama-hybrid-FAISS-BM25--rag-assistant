[site]: stackoverflow
[post_id]: 2907895
[parent_id]: 276362
[tags]: 
I typed up the code below with the assistance of Automator (recording an action, and then dragging the specific action out of the "Watch Me Do" window in order to get the Applescript). If you want to print a PDF from an application other than Safari, you might have to run through the same process and tweak this Applescript around the Print dialogue, since each program might have a different Print GUI. # Convert the current Safari window to a PDF # by Sebastain Gallese # props to the following for helping me get frontmost window # http://stackoverflow.com/questions/480866/get-the-title-of-the-current-active-window- document-in-mac-os-x global window_name # This script works with Safari, you might have # to tweak it to work with other applications set myApplication to "Safari" # You can name the PDF whatever you want # Just make sure to delete it or move it or rename it # Before running the script again set myPDFName to "mynewpdfile" tell application myApplication activate if the (count of windows) is not 0 then set window_name to name of front window end if end tell set timeoutSeconds to 2.0 set uiScript to "keystroke \"p\" using command down" my doWithTimeout(uiScript, timeoutSeconds) set uiScript to "click menu button \"PDF\" of sheet 1 of window \"" & window_name & "\" of application process \"" & myApplication & "\"" my doWithTimeout(uiScript, timeoutSeconds) set uiScript to "click menu item 2 of menu 1 of menu button \"PDF\" of sheet 1 of window \"" & window_name & "\" of application process \"" & myApplication & "\"" my doWithTimeout(uiScript, timeoutSeconds) set uiScript to "keystroke \"" & myPDFName & "\"" my doWithTimeout(uiScript, timeoutSeconds) set uiScript to "keystroke return" my doWithTimeout(uiScript, timeoutSeconds) on doWithTimeout(uiScript, timeoutSeconds) set endDate to (current date) + timeoutSeconds repeat try run script "tell application \"System Events\" " & uiScript & " end tell" exit repeat on error errorMessage if ((current date) > endDate) then error "Can not " & uiScript end if end try end repeat end doWithTimeout
