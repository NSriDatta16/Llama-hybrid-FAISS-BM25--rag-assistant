[site]: crossvalidated
[post_id]: 626010
[parent_id]: 476828
[tags]: 
The model suggested by @RobertLong is a great start (+1). It has one quirk though that may be unintended: there is a treatment effect at each time point, including at time T0 (pre-therapy). $$ \begin{aligned} \operatorname{E}\left\{Y | \text{time} = T_0, \text{group} = C\right\} &= \beta_0 \\ \operatorname{E}\left\{Y | \text{time} = T_0, \text{group} = T\right\} &= \beta_0 + \beta_1 \end{aligned} $$ However, the treatment can't have an effect on the outcome before the treatment is administered and if the assignment of subjects to a treatment group is randomized, the expected difference between the two groups at baseline is 0. $$ \begin{aligned} \operatorname{E}\left\{Y | \text{time} = T_0, \text{group} = C\right\} &= \beta_0 \\ \operatorname{E}\left\{Y | \text{time} = T_0, \text{group} = T\right\} &= \beta_0 \qquad \end{aligned} $$ For the other time points (T1, T2, T3) the model remains unchanged. Here is how to specify this model in the R formula syntax. It's a bit wordy but gets the job done. outcome ~ I(time == "T1") + I(time == "T2") + I(time == "T3") + I(group == "T" & time == "T1") + I(group == "T" & time == "T2") + I(group == "T" & time == "T3") + (group | subject) The terms I(group == "T" & time == "Ti") are the contrasts between treatment and control for each time point Ti = {T1, T2, T3}. The benefit of this formulation is that we estimate the fixed effects more precisely, ie. with smaller std. error. I ran a simulation to illustrate (full R code below). First the fixed effects from Model 1, which includes a treatment effect at T0: #> Estimate Std. Error t value #> (Intercept) 0.09103 0.05012 1.816 #> groupT -0.11822 0.06687 -1.768 #> timeT1 -0.06673 0.04887 -1.366 #> timeT2 0.05765 0.04887 1.180 #> timeT3 0.17911 0.04887 3.665 #> groupT:timeT1 0.21681 0.07137 3.038 #> groupT:timeT2 0.20880 0.07137 2.925 #> groupT:timeT3 0.39799 0.07137 5.576 Of primary interest are the contrasts between treatment and control at time points T1 to T3: #> time = T1: #> contrast estimate SE df t.ratio p.value #> T - C 0.0986 0.0669 85.2 1.474 0.1441 #> time = T2: #> contrast estimate SE df t.ratio p.value #> T - C 0.0906 0.0669 85.2 1.355 0.1791 #> time = T3: #> contrast estimate SE df t.ratio p.value #> T - C 0.2798 0.0669 85.2 4.184 0.0001 And next the fixed effects from Model 2, which doesn't have a treatment effect at T0. The bottom three rows correspond to the contrasts T - C at time points T1, T2 and T3; the std. errors are smaller. #> Estimate Std. Error t value #> (Intercept) 0.02416 0.03357 0.720 #> I(time == "T1")TRUE -0.03590 0.04561 -0.787 #> I(time == "T2")TRUE 0.08849 0.04561 1.940 #> I(time == "T3")TRUE 0.20995 0.04561 4.603 #> I(group == "T" & time == "T1")TRUE 0.15102 0.06069 2.488 #> I(group == "T" & time == "T2")TRUE 0.14301 0.06069 2.356 #> I(group == "T" & time == "T3")TRUE 0.33221 0.06069 5.474 Finally one more point. The comment This study is carried by several institutes (...) suggests this is a multi-center study. If this is the case, the model should account for "center effects" as well; whether as fixed or random depends on the details. The simulation R code: library("lme4") set.seed(123) # T0: T - C = 0.0 - 0.0 = 0.0 # T1: T - C = 0.2 - 0.0 = 0.2 # T2: T - C = 0.3 - 0.1 = 0.2 # T3: T - C = 0.6 - 0.2 = 0.3 sim_fixef
