[site]: crossvalidated
[post_id]: 611424
[parent_id]: 
[tags]: 
In causal inference, can you control for confounders by matching the treatment and control group based on the time series of the outcome variable?

Suppose that Walmart has 100 stores. It has a coupon for cereal, and it wants to know if the coupon increases cereal sales by a significant amount. Walmart puts the coupon on the cereal shelf in 10 stores; let's call this the treatment group. The other 90 stores do not the the coupon; let's call this the control group. There are all kinds of confounders that affect sales, like the median income of the shoppers who visit the store the number of shoppers who visit the store the number of competing retailers near the store Because of these confounders, we have to rely on causal inference. I know that there are 2 common ways in causal inference to deal with situations like this: controlling for confounders in a regression model estimating propensity scores using the confounders, then matching each treatment store to a control store with similar propensity scores, and doing a paired t-test My question is about a possible 3rd method that I learned from casual conversations with other data scientists. Here are the steps. A. For all 100 stores, find the time series of cereal sales for 1 year before the introduction of the coupon. B. For each treatment store, find 5 control stores whose cereal sales histories match the treatment store's cereal sales history. C. Using the matched control stores, build some regression model to predict the counterfactual sales for the treatment stores (i.e. what their cereal sales would have been without the coupon). D. Calculate the average treatment effect on the treated (ATT) on the treatment stores based on their actual sales and their counterfactual sales. I am not fully clear on the validity behind this approach. Somehow, the matching process of the sales bypasses the confounding effects. (I don't understand this, and nobody can explain it to me properly. I'm posting this question to gain some clarity on it.) To the experts on causal inference: Is this approach correct? If so, how exactly does matching on the outcome variable (i.e. sales) overcome the confounding effects?
