[site]: crossvalidated
[post_id]: 229938
[parent_id]: 229931
[tags]: 
The entire probability distribution for X, namely P(X = i) for all values of i from 0 to N, can be obtained using a discrete-time (time-inhomogeneous) Markov Chain having $2N + 2$ states. The states are: "Initial state of 0 trials having been conducted" For each i from 0 to N-1, there is a state for "i trials have had value 1, with most recent trial being 0" For each i from 0 to N-1, there is a state for "i trials have had value 1, with most recent trial being 1" There is a single state for "N trials have had value 1" The one-step transition matrix M is formed in the obvious fashion for the transitions between the states, based on the data you say is available. The Markov Chain is started in the initial state of 0 trials having been conducted, and is run for N steps. The first row of $M^N$ contains the probabilities of being in the various states after N trials. For each i from 0 to N-1, P(X = i) = sum of the entries in the first row of $M^N$ for the states "i trials have had value 1, with most recent trial being 0" and "i trials have had value 1, with most recent trial being 1". P(X = N) = entry in the first row of $M^N$ for the state "N trials have had value 1" Here is a sample formulation and results: Let N = 3, so there are 8 states, which I have ordered: "Initial state of 0 trials having been conducted" "0 trials have had value 1, with most recent trial being 0" "0 trials have had value 1, with most recent trial being 1" "1 trial has had value 1, with most recent trial being 0" "1 trial has had value 1, with most recent trial being 1" "2 trials have had value 1, with most recent trial being 0" "2 trials have had value 1, with most recent trial being 1" "3 trials have had value 1" In this example,let p = 0.5 P(trial has same value as previous trial) = d P(trial has different value than previous trial) = 1-d A value of d = 0.5 corresponds to independent (binomial) trials, d = 1 corresponds to perfectly correlated trials, and d = 0 corresponds to perfectly anti-correlated (i.e., flip-flopping) trials. Here is the single step transition matrix M for d = 0.8. 0 0.5000 0 0 0.5000 0 0 0 0 0.8000 0 0 0.2000 0 0 0 0 0.2000 0 0 0.8000 0 0 0 0 0 0 0.8000 0 0 0.2000 0 0 0 0 0.2000 0 0 0.8000 0 0 0 0 0 0 0.8000 0 0.2000 0 0 0 0 0 0.2000 0 0.8000 0 0 0 0 0 0 0 1.0000 Here are the resulting probability distributions for X for values of d from 0 to 1 in 0.1 increments. All the results make perfect sense to me. d P(X=0) P(X=1) P(X=2) P(X=3) 0.0000 0 0.5000 0.5000 0 0.1000 0.0050 0.4950 0.4950 0.0050 0.2000 0.0200 0.4800 0.4800 0.0200 0.3000 0.0450 0.4550 0.4550 0.0450 0.4000 0.0800 0.4200 0.4200 0.0800 0.5000 0.1250 0.3750 0.3750 0.1250 0.6000 0.1800 0.3200 0.3200 0.1800 0.7000 0.2450 0.2550 0.2550 0.2450 0.8000 0.3200 0.1800 0.1800 0.3200 0.9000 0.4050 0.0950 0.0950 0.4050 1.0000 0.5000 0 0 0.5000
