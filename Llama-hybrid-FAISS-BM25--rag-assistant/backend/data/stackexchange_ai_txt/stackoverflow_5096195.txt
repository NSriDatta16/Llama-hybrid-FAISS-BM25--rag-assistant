[site]: stackoverflow
[post_id]: 5096195
[parent_id]: 4666047
[tags]: 
The createPreviewDialog has to be created BEFORE the transformation into pdf FopFactory fopFactory = FopFactory.newInstance(); FOUserAgent foUserAgent = fopFactory.newFOUserAgent(); AWTRenderer renderer = new AWTRenderer(); renderer.setPreviewDialogDisplayed(false); foUserAgent.setRendererOverride(renderer); renderer.setUserAgent(foUserAgent); PreviewDialog previewDlg = PreviewDialog.createPreviewDialog(foUserAgent, null, false); renderer.setStatusListener(previewDlg); renderer.clearViewportList(); TransformerFactory transformFactory = TransformerFactory.newInstance(); Transformer transformerFo = transformFactory.newTransformer(new StreamSource(xslt)); FileOutputStream fileoutFo = new FileOutputStream(tempFoFile); BufferedOutputStream outFo = new BufferedOutputStream(fileoutFo); transformerFo.transform (new StreamSource(xml),new StreamResult(outFo)); Transformer transformerPdf = transformFactory.newTransformer(); FileOutputStream fileoutPdf = new FileOutputStream(tempPdfFile); BufferedOutputStream outPdf = new BufferedOutputStream(fileoutPdf); final Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, outPdf); Source srcPdf = new StreamSource(fo); Result resPdf = new SAXResult(fop.getDefaultHandler()); transformerPdf.transform(srcPdf, resPdf);
