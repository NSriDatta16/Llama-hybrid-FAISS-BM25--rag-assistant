[site]: stackoverflow
[post_id]: 905947
[parent_id]: 905909
[tags]: 
You can extract the full path as follows: @echo off setlocal echo Drag and drop your .txt file here, after that press Enter: set txtfile= set /p txtfile= echo. for %%i in (%txtfile%) do set txtdir=%%~dpi for %%i in (%txtfile%) do set txtfil=%%~nxi cd /d %txtdir% dir %txtfil% endlocal The first for statement gets the drive and path, the second gets the filename and extension. I've used cd /d to change the drive and directory and just used setlocal/endlocal to preserve my path outside the script (you can remove these if you don't care). The full range of ~-modifiers can be found by running "for /?" in a command window. It really is a powerful command, and these modifiers aren't restricted to "for", they can be used on any %1-type arguments to scripts as well.
