[site]: stackoverflow
[post_id]: 2020807
[parent_id]: 
[tags]: 
Tips on Dealing with Large Strings With Regards to Memory Usage

How can I force a shrink of a DataTable and/or List so that I can free memory efficiently? I am currently removing the processed row from the DataSet every iteration of the loop, but I'm not sure if the memory is being released. for (int i = m_TotalNumberOfLocalRows - 1; i >= 0; i--) { dr = dt.Rows[i]; // Do stuff dt.Rows.Remove(dr); } If this doesn't shrink the DataTable's footprint in memory I can use a List. I'm only using the DataTable as a store for the DataRows, I could use whatever collection or storage mechanism that would be low on memory and be able to release memory every x iterations. Thank you. Edit: After doing some memory profiling after reading What Are Some Good .NET Profilers? I've discovered that the main consumer of memory are strings. We are doing lots of user output during this process, and the memory consumption is cycling between approximately 170MB-230MB, peaking at around 300MB. I'm using a StringBuilder with an initial size of 20971520 to hold the output/log of what is happening and after one percent of the total number of records have been processed I'm setting a DevExpress MemoEdit control's Text property to the StringBuilder.ToString(). I've found that this method is quicker than appending the StringBuilder.ToString() to the MemoEdit.Text (obviously the logic w.r.t. the StringBuilder is different between appending and setting the MemoEdit.Text) I've also found that instead of recreating the StringBuilder(20971520) it's easier on memory and quicker to execute to just StringBuilder.Remove(0, StringBuilder.Length) Are there any tips that you could share to improve performance when working with large strings (the log file that it written out that contains the log is approximately 12.2MB for about 30 000 records)? Note: I have changed the title of the question and the tags. Old title:How can I Force a Shrink of a DataTable and/or a List to Release Memory? Old tags: list datatable c# .net memory
