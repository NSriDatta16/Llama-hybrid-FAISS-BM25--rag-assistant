[site]: crossvalidated
[post_id]: 584651
[parent_id]: 
[tags]: 
How to select ranks to search for CP decomposition of 4-mode tensor of experimental gene expression data?

I have a sparse (0.625 percent non-zero occupancy) data tensor with shape (118, 16, 5009, 10) . I would like to try exploring the data using CP decomposition . The modes represent sample, timepoint, gene ID, and an experimental condition, and the entries are levels of gene transcription (RNASeq). The tensorly implementation I am using requires that I provide the rank as an input, which is normal for such implementations. Naturally I could perform a search of different ranks to see what patterns show up in the factor loadings, but are there principles or heuristics to decide what maximum rank I should search up to? In my case I ran out of storage at rank 11 decomposition (while using a memory view of a temporary file), giving the following error. numpy.core._exceptions._ArrayMemoryError: Unable to allocate 325. TiB for an array with shape (9456992, 9456992) and data type float32 The exponential scaling of the amount space required is quickly prohibitive even when using virtual memory. But I am still interested in this question in broad terms. I may have smaller data sets in the future where I would be able to check much higher ranks than [1,10].
