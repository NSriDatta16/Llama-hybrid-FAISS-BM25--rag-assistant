[site]: crossvalidated
[post_id]: 239559
[parent_id]: 
[tags]: 
Introducing a random effect in R glmer makes no difference vs glm - am I doing something wrong?

I have a logistic regression model that I was doing using the glm function in R. A reviewer commented that we needed to assess the impact of random effects. I used glmer, from R package lme4, to assess that, adding a random effects variable. But the estimates and standard errors of the fixed effect coefficients in the results of the glmer are identical to those of the glm, and the variance of the random effects variable is reported as zero - not something very low, but actually zero. This makes me worry that I have not set up the model correctly. The model has a logical result variable 'Script' that is regressed against five logical diagnostic indicators, five categories of treating doctor that are represented by four logical variables, one logical 'era' indicator, an integer age variable and a logical indicator of whether the patient has a certain blood marker. The random effects variable used in the glmer model is a doctor ID, which will be one of the 59 treating doctors in the study. That was introduced because the reviewer was concerned about particular doctor effects that would cause the estimates of coefficient and their standard errors for the doctor category indicators to be inaccurate or biased because of varying propensities of individual doctors to give the prescription that is the Script result variable. In setting up the model I had tried to follow the approach in Example 2 that is set out on this UCLA page ( http://www.ats.ucla.edu/stat/r/dae/melogit.htm ), which has a fixed effects variable 'Experience' that is a property of a doctor, and a random effects variable DID (Doctor ID). I speculated that perhaps the effect of the random effects variable disappeared if there were too many other explanatory variables. To test this out, I ran a slimmed-down model with only the four doctor category variables in it. That gave me a meaningful random effect variance. I then added more variables in a series of steps and found sure enough that the random effect variance decreased slightly with each added explanatory variable. Then it suddenly dived with the addition of a further explanatory variable (Btype1indic) from 0.08877 to 4e-14. I added one more explanatory variable (age_int, the integer age variable) and the variance went to zero. Is it the case that the impact of a random effects variable, and its variance, decreases with the addition of each other fixed-effects variable to the model? Why does the impact eventually go to zero, rather than just continuing to get smaller? Should I be concerned that the fact that it goes to zero means I have done something wrong? I attach below the output from my diagnostic runs. It shows the glmer output summaries as I add more variables at each step. I've inserted the marker '+++++++++++++++++++++++++++++++++++++' next to the random effects variances to make them easier to spot and compare. The output includes a glm run at the end. It can be seen that the estimates and standard errors of the p-values are identical to those in the glmer run. The AIC is close but not identical, at 492.83 vs 494.8. I don't know what to make of that. Thank you very much for any help that anybody can provide. [1] "New mixed effects regression ####################################################################################" Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod'] Family: binomial ( logit ) Formula: Script ~ DrIsCat1 + DrIsCat2 + DrIsCat3 + DrIsCat4 + (1 | DrID) Data: datatable AIC BIC logLik deviance df.resid 635.9 665.0 -311.9 623.9 947 Scaled residuals: Min 1Q Median 3Q Max -0.4896 -0.3776 -0.3099 -0.2397 4.4144 Random effects: Groups Name Variance Std.Dev. DrID (Intercept) 0.1006 0.3172 +++++++++++++++++++++++++++++++++++++ Number of obs: 953, groups: DrID, 59 Fixed effects: Estimate Std. Error z value Pr(>|z|) (Intercept) -2.8762 0.3042 -9.454 |z|) (Intercept) -3.7230 0.4197 -8.871 |z|) (Intercept) -3.8135 0.4459 -8.552 |z|) (Intercept) -4.5004 0.4487 -10.029 |z|) (Intercept) -5.33613 0.61104 -8.733 |z|) (Intercept) -5.33613 0.61103 -8.733
