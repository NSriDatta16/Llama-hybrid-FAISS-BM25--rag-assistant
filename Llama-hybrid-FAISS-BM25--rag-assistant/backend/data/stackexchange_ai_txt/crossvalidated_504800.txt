[site]: crossvalidated
[post_id]: 504800
[parent_id]: 
[tags]: 
Why are my predictied values from a Bayesian AR(1) model lagging behind the data?

Summary : I have simulated some data on an AR(1) process in R and fit the model in Stan. When plotting the predictions, the predicted values tend to lag behind the true values. Why is this? Detail I am simulating fake data from the following AR(1) model: \begin{equation} y_{t} \sim Normal(\eta_{t}, \sigma) \end{equation} \begin{equation} \eta_{t} = \mu + \alpha y_{t-1} \end{equation} for $t$ from $2,...,N$ , and where $y_{1} \sim Normal(\mu, 0.1)$ In R: # requirements require(tidyverse) require(coda) require(rstan) # convenience function for the highest density interval hdi I then fit the model to this data using the following Stan program to return the parameter values: data{ int N; vector[N] y; } parameters{ real mu; real alpha; real sigma; } transformed parameters{ vector[N-1] eta; eta = mu + alpha * y[1:(N-1)]; } model{ mu ~ normal(0, 1); sigma ~ normal(0, 1); alpha ~ normal(0, 1); y[2:N] ~ normal(eta, sigma); } generated quantities{ vector[N-1] log_lik; vector[N-1] PPD; for(t in 1:(N-1)){ log_lik[t] = normal_lpdf(y[t] | eta[t], sigma); PPD[t] = normal_rng(eta[t], sigma); } } Fit the model: # compile the Stan model ar1 In this plot, the black line and points show the raw data, the dark green line and ribbon the posterior mean and uncertainty around the mean, and the yellow ribbon the 95% HDI of the posterior predictive distribution. But it seems the predicted values tend to lag behind the real values, in this case by one data point. An increase in the real data is reflected by a increase in the predicted value shifted by one time point in the future. This is a recurring theme for my exploration of time series models, even on data that have been simulated from that model as I have done here. Does anyone have any advice?
