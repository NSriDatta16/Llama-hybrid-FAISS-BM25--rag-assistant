[site]: stackoverflow
[post_id]: 2602422
[parent_id]: 2601745
[tags]: 
As far as I remember, box handler is implementy differently from other handlers in OL. We had to implement an own handler which returns a geometry with lon/lat coordinates rather that with pixel coordinates: Legato.Handler.Box = OpenLayers.Class(OpenLayers.Handler.Box, { endBox : function(end) { var result; if (Math.abs(this.dragHandler.start.x - end.x) > 5 || Math.abs(this.dragHandler.start.y - end.y) > 5) { var start = this.dragHandler.start; var top = Math.min(start.y, end.y); var bottom = Math.max(start.y, end.y); var left = Math.min(start.x, end.x); var right = Math.max(start.x, end.x); var lowerLeftLonLat = this.map.getLonLatFromPixel(new OpenLayers.Pixel( left, bottom)); var upperRightLonLat = this.map.getLonLatFromPixel(new OpenLayers.Pixel( right, top)); var bounds = new OpenLayers.Bounds(lowerLeftLonLat.lon, lowerLeftLonLat.lat, upperRightLonLat.lon, upperRightLonLat.lat); result = bounds.toGeometry(); } else { var xy = this.dragHandler.start.clone(); var lonLat = this.map.getLonLatFromPixel(xy); result = new OpenLayers.Geometry.Point(lonLat.lon, lonLat.lat); } this.removeBox(); this.callback("done", [ result ]); }, CLASS_NAME :"Legato.Handler.Box" });
