[site]: crossvalidated
[post_id]: 459712
[parent_id]: 
[tags]: 
Comparing time series trends of non-linear count data across multiple firms in R

I have data on the number of patent applications per year for 20 years for ten different firms. I am trying to answer the question, "did the number (count) of applications evolve differentially across firms over time?" I think that the "correct" way to characterize my data are that they are time series data, where the number of patent applications for each firm is collected yearly and where the yearly counts are uncorrelated with the previous year. I would like to use inferential statistics to characterize the evolution of the firms relative to each other. My first thought was to use linear regression (OLS) with the variable of interest being the interaction between the firm factor variable and year (i.e. y = b0 + b1*year + b2*factor(firm) + b3*yearXfactor(firm) + error term). However, the data are non-linear, as I found out upon looking at my model diagnostics. I also thought to use a Poisson or negative binomial GLM model, but ran into problems with overfitting and assumption violations. I also thought to use a model that allowed for a random intercept, as each of the nine firms have very different numbers of patent applications at year 1, but again ran into issues. Finally, I then applied the Kendall-Mann test for each individual firm, and unsurprisingly saw that not all of the firms follow a monotonic pattern. Within R, I then thought to use the tsglm function within the tscount package, however you cannot use a categorical predictor variable in that function as it is currently written. Therefore, I'm unable to use that function to address whether the yearly patent applications evolved differentially across firms over time. I am happy to provide data if it would be helpful and appreciate any thoughts/ideas on this question.
