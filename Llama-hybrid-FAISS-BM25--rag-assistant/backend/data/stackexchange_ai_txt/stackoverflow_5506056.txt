[site]: stackoverflow
[post_id]: 5506056
[parent_id]: 
[tags]: 
Mine Reporting based on one field and the presence of two values

This is in SQL Server 2005. I work in a call center, where call records are stored in a History table. The way the business works, is that an agent (Agent1) takes a call, speaks to the customer then transfers that call to some random second agent (Agent2) for them to close the sale. In SQL, what the data shows is that the first agent spoke to the customer, and then the call ended with no Disposition. The second record shows a new call, with a new HistoryID, and it shows Agent1 and Agent2 in the agent field. Here is an example of how data is laid out: HistoryID| CallID | Date | Data | Agent 10940824 | 2149513 | 3/31/2011 12:20:01 PM | Call Data of the Record | agent1 10940853 | 2149513 | 3/31/2011 12:23:17 PM | Call Data of the Record | agent1 agent2 Agent1 & Agent2 would actually be the agents first name, last initial so Agent1 = bobs, Agent2 = annb. There can be many agents involved, so the names of Agent1 and Agent2 will most likely always be different. I'm attempting to do some reporting, primarily on the Agent2 Examples of report would be: How many transfers did Agent2 receive? Hypothetically, I'd ask SQL to give me a count of all of the History Records where Agent2 is the second person on a record (for a given date, or date range) Adding these possible report scenarios: Maybe select the record that has the two agents, then select the preceding record where Agent1 exists for the CallID on it's own. Meaning, I'm working backwards with the data. I ask SQL to find where two values exist in the Agent field, then grab the first agent name and CallID, and fetch the preceding record based on those two values. Another one would be: I would like to get all the records where there are agent1 and agent2 exist in the Agent field. If there is any additional information anyone requires for a better answer, please let me know.
