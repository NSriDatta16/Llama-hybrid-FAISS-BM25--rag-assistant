[site]: crossvalidated
[post_id]: 71613
[parent_id]: 
[tags]: 
Detecting outliers using 95% PI around a natural spline fit

Please see the picture below: I wanted to mark the points that are not consistent with their adjacent points as outlier. What I did was to fit a natural spline fit to 1000 observations (the purple line in the picture is the fitted line). I then consider 95% prediction interval and 99% prediction interval around the fit. I consider any point outside of the 99% PI as outlier. If you look at the picture above, you would see that the red dots are the points that were selected as outliers. In particular look at the outliers after x = 150 (x axis). These are very consistent and should have not been selected as outlier. As you noticed the PI interval is very narrow and I think this is because of two things: n = 1000 is large data is highly correlated Question is how can I take this correlation into account and get a realistic 95% PI? Do I need a time series approach? What is your suggestion? Your help is greatly appreciated
