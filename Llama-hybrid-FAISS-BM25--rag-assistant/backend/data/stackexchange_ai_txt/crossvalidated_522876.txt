[site]: crossvalidated
[post_id]: 522876
[parent_id]: 
[tags]: 
Anova vs linear mixed (random) effect model vs Bayesian analysis in R

I am not an expert in statistics nor in R so I apologise beforehand if my description is unclear at any point because of that. I tested several models for the same problem and would like to understand differences/similarities. Description of the problem We measured the ‘concentration’ of 11 units of a material in 3 replicates from the same batch at 3 different days in a (partly) randomized manner. All the 11 units were spiked with 3 different ampoules of another material that supposed to be homogeneous and the ampoules are randomly selected form a large batch. The concentration was calculated from the spike/unit isotope ratio. There is a significant day-to-day difference (day 1 is off) and all distributions are assumed to be normal. The equivalence of the individual units is of little importance but I would like to quantify the between units standard deviation. These values seem to differ from method to method although the model is the same… (I tried to add some data here but failed...might try it later) Mean(conc)=296.74; SD(conc)=0.13. ANOVA after normalization of data Normalization of all concentration data of each day by dividing all data by the daily maximum. Running ANOVA on normalized data: summary(aov(conc)~as.factor(norm_unit), data)) SD(bu) = sqrt(MS(unit)-MS(Residuals)/3) = 0.0737 Nested ANOVA Concentration values are nested in days: summary(aov(conc)~ as.factor(day)/as.factor(unit), data)) SD(bu) = sqrt(MS(unit)-MS(Residuals)/3) = 0.0697 The sd calculated form the two ANOVAs give very close results although in my opinion the 2nd version is a better model of the problem. Using lmer as mixed (random) effect model I set the fixed effect to 0 because I expect all the units to be homogeneous and give the same concentration value. Random effects are expected due to day-to-day and unit-to-unit differences: lmer(conc~(1|day/unit), data) SD(day:unit) = 0.0696, which is basically the same as model 2. This is not a real surprise to me even though the real ANOVA equivalent imo should be: summary(aov(conc~ Error(as.factor(unit)/as.factor(unit)), data))!? 4) Same model as 3) the Bayesian way The weakly informative priors of stan_lmer were not changed only the adapt_delta was increased and the convergence is OK most of the time. stan_lmer(conc~(1|day/unit), data, control = list(adapt_delta = 0.99)) SD(day:unit) ≈ 0.08 This is the same model as the frequentist and it suggests that the frequentist SD is underestimated by around 13%. So far, I did not touch possible spike ampoule-to-ampoule differences but it may be also significant and I would add it to the model as random effect. Using lmer as mixed (random) effect model – modified model It is assumed that there might be significant day-to-day, spike ampoule-to-ampoule and unit-to-unit differences. The days and ampoules are at the same hierarchical level but the units are nested in both. I would describe it as: lmer(conc~(1|day)+(1|spike)+(1|day:spike:unit), data) SD(day:spike:unit) = 0.0547 (I cannot think of a solution with aov or car::Anova). Same as 5) with stan_lmer Here if I want to ensure convergence then the priors needs to be slightly modified. stan_lmer(conc~(1|day)+(1|spike)+(1|day:spike:unit), data, iter=10000, control = list(adapt_delta = 0.99), prior_aux = rstanarm::exponential(3, autoscale=TRUE ), prior_intercept = normal(296.75, 0.3,autoscale=TRUE), prior_covariance = decov(scale=0.9, shape=1.2)) SD(day:spike:unit) = 0.07, same story: it shows that frequentist SD is underestimated by around 20%. I have to admit that I modified the priors a bit intuitively but I would still consider them weakly informative. And I would appreciate any comment on this. If I understand correctly lmer and the system I want to model then I think 5) and 6) are the most accurate descriptions. I am still unsure though what the best way is to decide which sd to use (frequentist or Bayesian) and how to define priors?
