[site]: stackoverflow
[post_id]: 4673523
[parent_id]: 
[tags]: 
mySQL query question

I have and ORDERS table from a customer shopping cart. It's the typical customer name, address, etc..list of fields. The twist is that the cart will populate the shipping information into the appropriate fields (shipName, shipAddress, ShipState, etc) when the customer enters shipping information that is different then the billing information. However, when the customer ships to themselves, the cart does not move the shipping information to the proper fields for shipping (i.e., shipName, shipAddress, shipState). It keeps this information in the ordName, ordAddress, ordCity, etc fields and then keeps the shipping related fields empty. Therefore, these shipping fields are then empty for orders that customers ship to themselves. I used IF commands to move the ordName, ordAddr, etc to alias names when no shipping information is provided so that the shipping information for all order types (whether the customer ships to themselves or to another address) is handled. That part is working fine in my query below. One issue remains. My shipping program can't use long State name (e.g, Michigan, New York, etc). It needs the state to be the two character abbreviation (e.g, MI, NY). I have a look up table called * STATES that has a mapping between long state name and the two character abbreviation. I am trying to use the ShipState alias to look up the correct two character name for a given state. I tried to do this as a JOIN but keep getting errors. I removed the join I was using and am only showing the code that works correct right now but doesn't do the mapping for state abbreviation. Can someone please help? SELECT orders.ordDate AS `Date`, orders.ordID AS Order_ID, orders.ordEmail AS Email, IF(ordShipName = ' ', ordName, ordShipName) AS Name, IF(ordShipAddress = ' ', ordAddress, ordShipAddress) AS Address_1, IF(ordShipAddress2 = ' ', ordAddress2, ordShipAddress2) AS Address_2, IF(ordShipCity = ' ', ordCity, ordShipCity) AS City, IF(ordShipState = ' ', ordState, ordShipState) AS ShipState, IF(ordShipZip = ' ', ordZip, ordShipZip) AS Postal, IF(ordShipCountry = ' ', ordCountry, ordShipCountry) AS Country, IF(ordShipPhone = ' ', ordPhone, ordShipPhone) AS Phone, FROM orders WHERE orders.ordID > 21700 HAVING Country = 'United States of America'
