[site]: crossvalidated
[post_id]: 412898
[parent_id]: 
[tags]: 
Does prediction-at-the-means give the correct survival function in the long run?

If you fit a Cox model, it's possible to come up with an estimate of the baseline hazard function using the Breslow step estimator. In R, this is the basehaz function, but by default it centers the covariates. Importantly, that is not the baseline hazard function, i.e. the hazard function when all covariates are 0. With centered continuous covariates, the cumulative hazard function approximates the unadjusted hazard functinon. However, if you adjust for categorical covariates, centering the dummy-encoded values gives prediction-at-the-means and makes no sense because the observed data have either dummy variables equal to 0 or 1, but not some fractional value. To get a consistent estimate of the survival function, it seems to me that you would have to actually get the baseline hazard function, then predict survival for each covariate level, and average them together point-wise for the population level survival. Would this be correct? I tried to explore this with a simulation but I can't seem to create the disparate findings I would expect. library(survival) set.seed(123) n $time, exp(-bh$ hazard), type='l', main='Baseline hazard') plot(survfit(Surv(y) ~ 1), add=T, col='red', main='Empirical survival')
