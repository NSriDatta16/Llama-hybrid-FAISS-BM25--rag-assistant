[site]: crossvalidated
[post_id]: 472219
[parent_id]: 470305
[tags]: 
@eyeExWhy 's answer directed me to a slightly different approach (unless I misunderstood that answer). I think the error is in 'In the case of $p_0$ , just excluding the cases that were not rated by both raters' With 'account for', I mean that knowing the sampling scheme, I want a calculation that in expectation has the same value as when the sampling did not occur. Start from the un-sampled situation: \begin{bmatrix} & T_{2+} & T_{2-} \\ T_{1+} & 200 & 100 \\ T_{1-} & 100 & 200 \end{bmatrix} Then \begin{align} p_0 & = \frac{200+200}{200+100+100+200} = 2/3 \\ p_{1+} &= p_{1-} = p_{2+} = p_{2-} = 0.5 \\ p_e &= 0.5*0.5+0.5*0.5 = 0.5\\ \kappa & = 1- \frac{1-2/3}{1-0.5} = 1/3 \end{align} After the sampling, on average we get this (sample the first row with probability 0.5, sample the second row with probability 1) \begin{bmatrix} 100 & 50 \\ 100 & 200 \end{bmatrix} By assigning weights inversely proportional to the sampling probabilities, the sampling scheme is accounted for: \begin{align} w_{++} &= w_{+-} = 1/0.5=2\\ w_{-+} &= w_{--} = 1/1 = 1 \\ p_0 & = \frac{2*100+200}{2*100+2*50+100+200} = 2/3 \\ p_{1+} &= \frac{2*100 + 2*50}{2*100+2*50+100+200} = 0.5 \\ p_{1-} &= \frac{100 + 200}{2*100+2*50+100+200} = 0.5 \\ p_{2+} &= \frac{2*100 + 100}{2*100+2*50+100+200} = 0.5 \\ p_{2-} &= \frac{2*50 + 200}{2*100+2*50+100+200} = 0.5 \\ p_e &= 0.5*0.5+0.5*0.5 = 0.5\\ \kappa & = 1- \frac{1-2/3}{1-0.5} = 1/3 \end{align}
