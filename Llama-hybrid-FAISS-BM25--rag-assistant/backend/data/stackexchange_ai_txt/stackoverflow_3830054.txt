[site]: stackoverflow
[post_id]: 3830054
[parent_id]: 3829949
[tags]: 
You can see my answer in nhibernate 2.0 Efficient Data Paging DataList Control and ObjectDataSource . Code again: protected IList GetByCriteria( ICriteria criteria, int pageIndex, int pageSize, out long totalCount) { ICriteria recordsCriteria = CriteriaTransformer.Clone(criteria); // Paging. recordsCriteria.SetFirstResult(pageIndex * pageSize); recordsCriteria.SetMaxResults(pageSize); // Count criteria. ICriteria countCriteria = CriteriaTransformer.TransformToRowCount(criteria); // Perform multi criteria to get both results and count in one trip to the database. IMultiCriteria multiCriteria = Session.CreateMultiCriteria(); multiCriteria.Add(recordsCriteria); multiCriteria.Add(countCriteria); IList multiResult = multiCriteria.List(); IList untypedRecords = multiResult[0] as IList; IList records = new List (); if (untypedRecords != null) { foreach (T obj in untypedRecords) { records.Add(obj); } } else { records = new List (); } totalCount = Convert.ToInt64(((IList)multiResult[1])[0]); return records; } It clones your original criteria twice: one criteria that return the records for the page and one criteria for total record count. It also uses IMultiCriteria to perform both database calls in one roundtrip.
