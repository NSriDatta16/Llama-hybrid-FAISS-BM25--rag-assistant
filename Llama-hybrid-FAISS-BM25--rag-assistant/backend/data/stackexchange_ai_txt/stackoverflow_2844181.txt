[site]: stackoverflow
[post_id]: 2844181
[parent_id]: 2844158
[tags]: 
You can use monadic lists: import Control.Monad.ListT (ListT) import Control.Monad.Trans.Class (lift) -- transformers, not mtl import Data.List.Class (takeWhile, repeat, toList) import Prelude hiding (takeWhile, repeat) getEvents :: IO [Event] getEvents = toList . takeWhile (/= NoEvent) $ do repeat () lift pollEvent :: ListT IO Event ListT from the "List" package on hackage.
