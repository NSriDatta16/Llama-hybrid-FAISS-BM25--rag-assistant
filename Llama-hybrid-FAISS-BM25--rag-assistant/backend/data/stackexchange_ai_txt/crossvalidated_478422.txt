[site]: crossvalidated
[post_id]: 478422
[parent_id]: 446389
[tags]: 
This is a great question. The authors are opaque with respect to this point in most of their papers, but they fully address it in Rowland et al 2019 (Statistics and Samples in Distributional RL). In order for the quantile code to converge, the agent needs to do the following steps every time the RPE $\delta_i$ is computed: Impute a distribution consistent with the current set of quantiles $\{V_i\}_{i=1,...,N}$ estimated for state $x'$ Sample a quantile $V_j(x')$ from that distribution Step 1 basically means finding a distribution that is consistent with the current set of estimates (quantiles, expectiles, etc), and step 2 is sampling an estimate (quantile, expectile) from that distribution. In the case in which $V_i$ are quantiles, a sample from the imputed distribution can be approximated by simply sampling a quantile $V_j(x')$ . In the case that $V_i$ are expectiles, however, the imputation step cannot be sidestepped in the same way (see Rowland et al 2019 for more details).
