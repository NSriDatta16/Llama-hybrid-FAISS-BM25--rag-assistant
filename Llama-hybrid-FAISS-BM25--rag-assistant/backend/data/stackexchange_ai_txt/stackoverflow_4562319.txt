[site]: stackoverflow
[post_id]: 4562319
[parent_id]: 
[tags]: 
Read/Unread cell (using drawrect)

My app downloading posts from internet to UITableViewCell. When user taps on cell, i am need to set this article as read (like on Mail.app). I dont know how to do that. I am adding url (when user press cell) to database (like "url|url|url"), open detail view. And when he goes back to UITableView checking existing url in DB. Table now is too slow! Can u help me and say what other method i can use to do that? Like in mail.app. I am using custom cell and code in drawRect method. Please, help - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath { NSString *CellIdentifier = [NSString stringWithFormat:@"%d",indexPath.row]; NSMutableArray *array=[NSMutableArray array]; if([[NSUserDefaults standardUserDefaults] objectForKey:@"readPostS"]!=nil) [array addObjectsFromArray:[[NSUserDefaults standardUserDefaults] objectForKey:@"readPostS"]]; NSUInteger indexOfObject = [array count]>0?[array indexOfObject:[NSNumber numberWithInt:indexPath.row]]:100000; //I add this, because row don't want update using updateRowAtIndexPath QuickCell *cell = (QuickCell*)[tableView dequeueReusableCellWithIdentifier:CellIdentifier]; if (cell == nil || (indexOfObject!=NSNotFound && indexOfObject!=100000)) { cell = [[[QuickCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease]; cell.frame = CGRectMake(0.0, 0.0, 320.0, 68.0); cell.accessoryType = UITableViewCellAccessoryNone; if([self.subject count]>0) { [self.allImages addObject:[NSNull null]]; NSString *userNameLJ = [NSString stringWithFormat:@"%@",[self.journalurl objectAtIndex:indexPath.row]]; userNameLJ = [userNameLJ stringByReplacingOccurrencesOfString:@"http://" withString:@""]; userNameLJ = [userNameLJ stringByReplacingOccurrencesOfString:@".livejournal.com" withString:@""]; userNameLJ = [userNameLJ stringByReplacingOccurrencesOfString:@"community/" withString:@""]; NSString *postURL = [NSString stringWithFormat:@"http://m.livejournal.com/read/user/%@/%@",userNameLJ,[self.ditemid objectAtIndex:indexPath.row]]; NSMutableDictionary *dict = [NSMutableDictionary dictionary]; [dict setObject:[self.subject objectAtIndex:indexPath.row] forKey:@"title"]; [dict setObject:[Utilities replaceForCell:[Utilities flattenHTML:[self.entry objectAtIndex:indexPath.row]]] forKey:@"description"]; if([[database executeQuery:@"SELECT * FROM read WHERE posts=?;",postURL] count]>0) { //if this post is read [dict setObject:[NSNumber numberWithBool:NO] forKey:@"highlighted"]; } else { [dict setObject:[NSNumber numberWithBool:YES] forKey:@"highlighted"]; } [dict setObject:[self.journalname objectAtIndex:indexPath.row] forKey:@"nick"]; [cell setContentForCell:dict]; BOOL trueOrFalse = [[self.allImages objectAtIndex:indexPath.row] isKindOfClass:[NSNull class]]?YES:NO; if(trueOrFalse) { if (tableView.dragging == NO && tableView.decelerating == NO) { //if no image cached now, download it if(indexPath.row 0) [[NSUserDefaults standardUserDefaults] setObject:array forKey:@"readPostS"]; else [[NSUserDefaults standardUserDefaults] removeObjectForKey:@"readPostS"]; } } return cell; } ////////////////////////////////////////////////////////////// ///////-(void)viewWillApear ////////////////////////////////////////////////////////////// NSMutableArray *readPosts = [NSMutableArray array]; if([[NSUserDefaults standardUserDefaults] objectForKey:@"readPostS"]!=nil) { [readPosts addObjectsFromArray:[[NSUserDefaults standardUserDefaults] objectForKey:@"readPostS"]]; self.read = (NSMutableArray*)[database executeQuery:@"SELECT * FROM read;"]; for(int i=0;i Ok. I think, my code is to bad and u can understand, what i am doing here) Answer on other question. How i can update hidden cells? User see only 6 cell in a moment, i need to update, for example, 10 cells. How? Or, how reload cell, if it allready exists? Lets say - NSString *CellIdentifier = [NSString stringWithFormat:@"%d",indexPath.row]; QuickCell *cell = (QuickCell*)[tableView dequeueReusableCellWithIdentifier:CellIdentifier]; if (cell == nil) { cell = [[[QuickCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease]; cell.frame = CGRectMake(0.0, 0.0, 320.0, 68.0); cell.accessoryType = UITableViewCellAccessoryNone; .........} now cell exists and if i call reload data nothing happen. And reloadCellAtIndexPath does not working too, because cell has unique identifier and ixists. HOW I CAN RELOAD CELL AND CALL DRAWRECT AGAIN?))
