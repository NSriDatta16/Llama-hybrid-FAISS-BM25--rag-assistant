[site]: stackoverflow
[post_id]: 5253739
[parent_id]: 
[tags]: 
trying to elminate from rows with dates closer than 5 minutes to each other

I need to count all the rows in a MySQL table omitting the records with same agent and msisnd columns and dates closer than 5 minutes to each other. For example, id type agent msisdn date 2706 jurnal EC_Catalin.Silvan 745844472 2011-02-18 18:31:54 63535 item EC_Adelina.Gartan 766699747 2011-02-22 18:42:15 56513 item EC_Adelina.Gartan 766733667 2011-02-24 17:13:31 56372 item EC_Adelina.Gartan 766733667 2011-02-24 17:12:01 The query should return COUNT = 3 because the rows with id's 56513 and 56372 have close dates to each other. So far i've got this query and it's not working SELECT `calls_count_pre`.* FROM `calls_count_pre` LEFT JOIN `calls_count_pre` AS `temp` ON (`calls_count_pre`.`id` = `temp`.`id`) WHERE (MINUTE(TIMEDIFF(`calls_count_pre`.`date`, `temp`.`date`)) It's simply returning all records. I know I'm not selecting a COUNT, but even a SELECT * would be a start at this point. Thanks in advance.
