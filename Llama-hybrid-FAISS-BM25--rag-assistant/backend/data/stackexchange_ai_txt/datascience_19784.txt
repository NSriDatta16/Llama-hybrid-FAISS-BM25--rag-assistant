[site]: datascience
[post_id]: 19784
[parent_id]: 
[tags]: 
Lasso implementation in Python

I am working on this course on Machine Learning 2012 from UBC (CPSC 340). I am stuck on a Homework code problem which shows the following RuntimeError in RuntimeWarning: invalid value encountered in add, C = np.diag(np.dot(X.T, (ytile.T - protile.T + third.T))) Can anyone help me check what the problem in the code is? Also, when I print the $\theta$, they are exponentially increasing and the loop keeps on executing. def ridge(X, y, d2): one = np.linalg.inv(np.dot(X.T, X) + d2 * (np.eye(8))) two = np.dot(X.T, y) theta = np.dot(one, two) return theta def lasso(X, y, d2): theta = ridge(X, y, d2) k = len(theta) theta_ = np.zeros(k) A = 2 * (np.sum(X**2, axis = 0)) while np.sum(np.abs(theta_ - theta)) > 1e-5: theta_ = theta.copy() ytile = np.tile(y, (k, 1)) pro = np.dot(X, theta) protile = np.tile(pro, (k,1)) third = np.dot(np.diag(theta), X.T) ######################################################## C = np.diag(np.dot(X.T, (ytile.T - protile.T + third.T))) ######################################################## for i in range(k): if C[i] d2 : theta[i] = ( C[i] - d2 ) / A[i] else: theta[i] = 0 return theta theta = lasso(Xtrain, ytrain, 1) print(theta)
