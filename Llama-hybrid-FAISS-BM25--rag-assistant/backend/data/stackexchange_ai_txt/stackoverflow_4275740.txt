[site]: stackoverflow
[post_id]: 4275740
[parent_id]: 
[tags]: 
zero read timeout for pcap

Is -1 a valid read timeout for pcap? I was told by someone that setting to_ms to -1 in pcap_open_live(char *device, int snaplen, int promisc, int to_ms, char *errbuf); causes it to return immediately when a packet is detected - effectively a zero timeout. It makes a lot of sense that there be some way to set a zero timeout, but then why not make -1 be infinite and 0 be 0? That would be more logical. Additionally, I haven't been able in any way to confirm what effect a to_ms value of -1 has on pcap. So, is -1 a valid timeout value? If so, what effect does it have? If not, is there any way to set a detection timeout of zero?
