[site]: stackoverflow
[post_id]: 1758936
[parent_id]: 1758229
[tags]: 
Finally it worked. Here is the code: IDENTIFICATION DIVISION. PROGRAM-ID.RemoveDup2. ENVIRONMENT DIVISION. INPUT-OUTPUT SECTION. FILE-CONTROL. SELECT INPUTFILEDUP ASSIGN TO 'C:\Cobol\INPUTFILEDUP.txt' ORGANIZATION IS LINE SEQUENTIAL. SELECT OUTFILEDUP ASSIGN TO 'C:\Cobol\OUTFILEDUP.txt' ORGANIZATION IS LINE SEQUENTIAL. SELECT WorkFile ASSIGN TO "WORK.TMP". DATA DIVISION. FILE SECTION. FD INPUTFILEDUP. 01 INPUTFILEDUPREC. 88 EOFINPUTFILEDUP VALUE HIGH-VALUES. 02 INPUTFILEID PIC 9(07). FD OUTFILEDUP. 01 OUTFILEDUPREC PIC 9(07). SD WorkFile. 01 WORKREC. 02 WINPUTFILEID PIC 9(07). WORKING-STORAGE SECTION. 77 WS-VARIABLE PIC 9(09) VALUE ZERO. 77 REC-NOT-MATCH PIC 9(01). 77 CUR-VARIABLE PIC 9(7) VALUE ZERO. PROCEDURE DIVISION. BEGIN. SORT WorkFile ON ASCENDING KEY WINPUTFILEID USING INPUTFILEDUP GIVING INPUTFILEDUP OPEN INPUT INPUTFILEDUP OPEN OUTPUT OUTFILEDUP READ INPUTFILEDUP AT END SET EOFINPUTFILEDUP TO TRUE END-READ PERFORM UNTIL (EOFINPUTFILEDUP) IF INPUTFILEID NOT EQUAL TO WS-VARIABLE MOVE INPUTFILEID TO WS-VARIABLE WRITE OUTFILEDUPREC FROM INPUTFILEID READ INPUTFILEDUP AT END SET EOFINPUTFILEDUP TO TRUE PERFORM UNTIL (EOFINPUTFILEDUP) ELSE DISPLAY "DUPLICATE FOUND " INPUTFILEID READ INPUTFILEDUP AT END SET EOFINPUTFILEDUP TO TRUE END-READ END-PERFORM CLOSE INPUTFILEDUP CLOSE OUTFILEDUP STOP RUN.
