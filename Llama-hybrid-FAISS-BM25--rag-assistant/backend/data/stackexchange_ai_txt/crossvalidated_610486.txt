[site]: crossvalidated
[post_id]: 610486
[parent_id]: 
[tags]: 
Reversible-jump MCMC for knot selection

Let $\{Z(\boldsymbol s):\boldsymbol s\in\mathcal D\}$ denote the Gaussian spatial random field on a spatial domain $\mathcal D\subset\mathbb R^2$ . Suppose that at $N$ locations, we have observations $\mathbf Z=\{Z(\boldsymbol s_1),\ldots, Z(\boldsymbol s_N)\}$ . Consider the Bayesian hierarchical model: \begin{equation}\label{OurMethod} \begin{aligned} &\textbf{Data Model: } &\mathbf Z\mid\boldsymbol\delta,\tau^2\sim\mathcal N(\boldsymbol\Phi\boldsymbol\delta,\tau^2\mathcal I) \\ &\textbf{Process Model: } &\boldsymbol\delta \mid\tau^2\sim\mathcal N(\textbf 0, \tau^2\mathcal I)\\ &\textbf{Parameter Model: } & \tau^2\sim p(\tau^2), \mathcal K\sim p(\mathcal K), \end{aligned} \end{equation} where $\boldsymbol\Phi$ is an $N\times r$ basis function matrix where the $r$ basis functions have corresponding knots $\mathcal K=\{\boldsymbol k_1,\ldots\boldsymbol k_r\}$ . I wish to employ a reversible-jump MCMC (RJMCMC) algorithm to select the number and the placement of the knot locations. We take the number of knots $r$ to be random, from some countable set $\mathcal S$ . $\mathcal M_{r}$ denotes the model with exactly $r$ knots and $\mathcal K(r) = \{\boldsymbol k_1,\ldots, \boldsymbol k_{r}\}$ denotes the knot locations. We shall generate samples from the joint posterior of $(r, \mathcal K(r))$ . To account for the varying dimensionality, we must develop appropriate reversible jump moves. For this problem, possible transitions are to add a knot (birth step), delete a knot (death step), or move a knot. These independent move types are randomly chosen with probability $b_{r}$ for move $r$ to $r +1$ (birth step), $d_{r}$ for move $r$ to $r -1$ (death step), and $\eta_{r}$ for the move step. These probabilities must satisfy $b_{r} + d_{r} + \eta_{r} = 1$ . Let $r\in\mathcal S = \{0,\ldots, R\}$ where $R$ is the maximum number of knot locations. For the prior specification of $r$ , we specify a truncated Poisson distribution: $$p(r)\propto\frac{\lambda^{r} \exp(-\lambda)}{r!}\mathbf{1}_{\{0,\ldots,R\}}(r),$$ where a smaller value of $\lambda$ penalizes for a large number of basis functions and hence results in a more parsimonious model. For a given $r$ , the knot locations $\boldsymbol k_i$ are taken to be randomly uniformly selected with state space the candidate knot locations $\mathcal R = \{\boldsymbol k_1 ,\ldots, \boldsymbol k_R\}$ , where $\boldsymbol k_1 ,\ldots, \boldsymbol k_R$ are specified to be equidistantly spread over $\mathcal D$ . Given $r$ , the prior distribution for $\mathcal K(r) = \{\boldsymbol k_1,\ldots, \boldsymbol k_{r}\}$ is then given by: $$p(\mathcal K(r)\mid r)=\frac{r!(R-r)!}{R!}$$ At each step of the RJMCMC algorithm, we propose one of three modifications to the current set of knots: Add a knot (birth step): Draw a new knot $\boldsymbol k_{r+1}$ uniformly with probability $1/(R- r)$ from the set of the $R - r$ vacant knot locations. Let $\mathcal K^*= \mathcal K\cup \{\boldsymbol k_{r+1}\}$ be the proposed set of knots, which now has size $r^* = r + 1$ . Delete a knot (death step): Select a knot $\boldsymbol k_J$ uniformly at random from one of the $r$ current knot locations, so it is drawn with probability $1/r$ . Then set $\mathcal K^*= \mathcal K \backslash \{\boldsymbol k_J\}$ and $r^* = r- 1$ . Move a knot: Select a knot $\boldsymbol k_J$ uniformly at random to be deleted, and then select a new location $\boldsymbol k_{r+1}$ from the vacant knot locations (i.e., where to move the old knot). This results in $\mathcal K^* = \{\boldsymbol k_{r+1}\}\cup\mathcal K\backslash\{\boldsymbol k_J\}$ and $r^* = r$ . Note that when we propose to add a knot, a corresponding basis coefficient $\delta'$ will also need to be proposed. Similarly, if we propose to delete a knot, the current basis coefficient $\delta$ will be set to $0$ . If we propose to move a knot, we will propose changing the current basis coefficient from $\delta$ to $\delta'$ . For the birth step, the prior ratio is given by: \begin{align*} \text{prior ratio} &=\frac{\text{prior for }r+1\text{ knots}}{\text{prior for }r\text{ knots}}\times\frac{\text{prior for location of }r+1\text{ knots}}{\text{prior for location of }r\text{ knots}}\\ &\times\frac{\text{prior for proposed basis coefficient}}{\text{prior for current basis coefficient}}\\ &=\frac{p(r+1)}{p(r)}\frac{r+1}{R}\times\frac{\mathcal N(\delta';0,\tau^2)}{\mathcal N(0;0,\tau^2)} \end{align*} The corresponding proposal ratio is given by \begin{align*} \text{proposal ratio} &=\frac{d_{r+1}(1/(r+1))}{b_{r}(1/(R-r))} \times\frac{1}{\mathcal N(\delta';0,\sigma^2)}\\ &=\frac{d_{r+1}(R-r)}{b_{r}(r+1)}\times\frac{1}{\mathcal N(\delta';0,\sigma^2)}\\ \end{align*} where $\sigma^2$ is the proposal variance for $\delta$ . Similar logic can be applied to the death step and the move step. The acceptance probability for the proposed set of knot locations is then $\min\{1,\alpha\}$ where \begin{equation} \alpha=\frac{\pi(\mathcal K^*,\boldsymbol\delta^*\mid\mathbf Z)Q(\mathcal K^*,\mathcal K)}{\pi(\mathcal K,\boldsymbol\delta\mid\mathbf Z)Q(\mathcal K,\mathcal K^*)} \end{equation} with proposal ratio given by \begin{equation} \frac{\mathcal Q(\mathcal K^*,\mathcal K)}{\mathcal Q(\mathcal K,\mathcal K_k^*)}=\begin{cases} \frac{d_{r+1}(R-r)}{b_{r}(r+1)}\times\frac{1}{\mathcal N(\delta';0,\sigma^2)},&r^*=r+1\\ \frac{b_{r-1}(r)}{d_{r}(R-r+1)}\times\mathcal N(\delta;0,\sigma^2),&r^*=r-1\\ 1,&r^*=r \end{cases}\end{equation} Currently, I am specifying the probability of adding, deleting, and moving a knot to be 1/3 for all $r$ . However, I am interested in letting these probabilities adapt to the data. For example, if the predictions are highly variable, we may favor adding a knot. Would I be violating any "rules" (e.g., detailed balance, reversibility) if I started the Markov chain with $b_r=d_r=\eta_r=1/3$ and then changed these probabilities (possibly at each step) during the MCMC algorithm?
