[site]: crossvalidated
[post_id]: 492831
[parent_id]: 
[tags]: 
How can I use Bayesian statistics to test this particular hypothesis?

There is a set $R=\{r_1, r_2, ..., r_K\}$ of $N$ ranks (where $N>> K$ ). I test the hypothesis that the ranks in $R$ are not homogeneously distributed in $\{1, 2, ..., N\}$ . As I am interested in particular in the case where ranks are low (that is, the ranks from $R$ tend to be at the beginning of the numbers), I calculate the following statistic: $c_R = -2 \sum_{i=1}^{K}\ln( \frac{r_i}{N})$ It can be easily shown that this statistic has a $\chi^2_{2\cdot K}$ distribution (same as proof of Fisher's method ). Now, whatever you think about the theory behind that, this test works wonders in my practical application when testing for gene set enrichments . However, similar to many other approaches in the field, it has a relatively high FP rate; clearly, the assumption of independence of ranks in $R$ is not fulfilled for genes. Also, gene sets vary in their number; some are very small (5-15 genes compared to 10-20 thousand of other genes), some are quite large (200-500 genes). This results in a kind of Lindley's paradox, in that even small deviations from uniform distribution for the large gene sets get very low value (it is possible to calculate an effect size and in fact this is an important number to look at when analysing the results; but that is beyond the scope of this question). I would like to try to use a bayesian approach to calculate a posterior probability after observing $c_R$ , using a uniform prior. Having little experience with bayesian statistics, how would I go about it? H_0 is that the ranks in $R$ are uniformly distributed (better would be: uniformly distributed, but partly correlated). $H_1$ is that they aren't. Say, I would like to compute $P(H_0|c_k) = \frac{P(c_k|H_0)\cdot P(H_0)}{P(c_k|H_0)\cdot P(H_0) + P(c_k|H_1)\cdot P(H_1)}$ $P(c_k|H_0)$ is simply the p-value from the $\chi^2_{2N}$ distribution. I am somewhat hazy about the remaining terms. I read "Statistical Rethinking" a while ago, and I think that I roughly know what to do, but I am unable to pin the details. What would be an alternative to the uniform distribution? I guess a Poisson distribution with $\lambda$ varying from 1 to $N$ . How should $\lambda$ be distributed? Heck if I know. How should I calculate $P(H_0)$ ? I think that once I can sample from $H_1$ , I can estimate the $P(c_t|H_1)$ similarly using random sampling. Actually, it would be best if I could introduce a measure for how tightly the genes are correlated and sample from that, but I'm not sure how to do it. Rather than using a software package like (R)stan, I would prefer to be able to get at a solution myself in order to understand the process. So, my question: how do I in this setup calculate $P(H_0)$ ? How should I sample the $H_1$ ?
