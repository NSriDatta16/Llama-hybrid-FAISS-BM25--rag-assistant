[site]: datascience
[post_id]: 74281
[parent_id]: 
[tags]: 
value error of incompatible wrong dimension during training a model

I was implementing a decision tree on a dataset . Before that, I wanted to transform a particular column with CountVectorizer . For this, I am using pipeline to make it simpler. But there is an error of incompatible row dimensions. code # Imported the libraries.... from sklearn.feature_extraction.text import CountVectorizer as cv from sklearn.preprocessing import OneHotEncoder as ohe from sklearn.compose import ColumnTransformer as ct from sklearn.pipeline import make_pipeline as mp from sklearn.tree import DecisionTreeClassifier as dtc transformer=ct(transformers=[('review_counts',cv(),['verified_reviews']), ('variation_dummies', ohe(),['variation']) ],remainder='passthrough') pipe= mp(transformer,dtc(random_state=42)) x= data[['rating','variation','verified_reviews']].copy() y= data.feedback x_train,x_test,y_train,y_test= tts(x,y,test_size=0.3,random_state=42,stratify=y) print(x_train.shape,y_train.shape) # ((2205, 3), (2205,)) pipe.fit(x_train,y_train) # Error on this line Error --------------------------------------------------------------------------- ValueError Traceback (most recent call last) in () ----> 1 pipe.fit(x_train,y_train) 7 frames /usr/local/lib/python3.6/dist-packages/scipy/sparse/construct.py in bmat(blocks, format, dtype) 584 exp=brow_lengths[i], 585 got=A.shape[0])) --> 586 raise ValueError(msg) 587 588 if bcol_lengths[j] == 0: ValueError: blocks[0,:] has incompatible row dimensions. Got blocks[0,1].shape[0] == 2205, expected 1. Questions How is this error of incompatible row dimension forming ? How it can be solved?
