[site]: stackoverflow
[post_id]: 2393844
[parent_id]: 2392105
[tags]: 
Fixed with $this->getResponse()->setHeader('Content-type', 'image/jpeg'); $this->getResponse()->setHeader('Expires', '', true); $this->getResponse()->setHeader('Cache-Control', 'public', true); $this->getResponse()->setHeader('Cache-Control', 'max-age=3800'); $this->getResponse()->setHeader('Pragma', '', true); $this->getResponse()->setHeader('ETag', $etag); if ($etag == $this->getRequest()->getHeader('If-None-Match')) { $this->getResponse()->setHttpResponseCode(304); } else { $w = (int) $this->_getParam('w'); $h = (int) $this->_getParam('h'); $image->resize($path, $w, $h); } thanks to http://dustint.com/archives/25 When I added $this->getResponse()->setHeader('Expires', '', true); $this->getResponse()->setHeader('Cache-Control', 'public', true); $this->getResponse()->setHeader('Cache-Control', 'max-age=3800'); $this->getResponse()->setHeader('Pragma', '', true); If-None-Match header in the request appeared, which helped me to match it against etag. @Gumbo Oh, I understand it well :) Thanks everyone who tried to help.
