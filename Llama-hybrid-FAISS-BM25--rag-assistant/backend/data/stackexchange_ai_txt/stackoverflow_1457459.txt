[site]: stackoverflow
[post_id]: 1457459
[parent_id]: 1457333
[tags]: 
The entity for a new line is &#10; . I played with your code until I found something that did the trick. It's not very elegant, I warn you: //First remove any indentations: $xml = str_replace(" ","", $xml); $xml = str_replace("\t","", $xml); //Next replace unify all new-lines into unix LF: $xml = str_replace("\r","\n", $xml); $xml = str_replace("\n\n","\n", $xml); //Next replace all new lines with the unicode: $xml = str_replace("\n","&#10;", $xml); Finally, replace any new line entities between > &#10; \n The assumption, based on your example, is that any new lines that occur inside a node or attribute will have more text on the next line, not a to open a new element. This of course would fail if your next line had some text that was wrapped in a line-level element.
