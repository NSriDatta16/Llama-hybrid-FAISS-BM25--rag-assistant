[site]: crossvalidated
[post_id]: 533100
[parent_id]: 
[tags]: 
Rao-Blackwellization in Black Box VI

In the paper, " Black Box Variational Inference, " by Ranganath et al. (2013), the authors derive a Rao-Blackwellized estimator of the gradient of the evidence lower bound with respect to a single variational parameter $\lambda_i$ . Notation: $q(z | \lambda) = \prod_{i=1}^n q(z_i | \lambda_i)$ is the factorized variational approximation. $q_{(i)}$ is "the distribution of variables in the model that depend on the $i$ 'th variable, i.e. the Markov blanket of $z_i$ ." $p_i(x, z_{(i)})$ is the product of the terms in the joint that depend on those variables. Then by their derivation, \begin{equation} \nabla_{\lambda_i} \mathcal{L} = E_{q_{(i)}} \left[\nabla_{\lambda_i} \log q(z_i | \lambda_i)(\log p_i(x, z_{(i)}) - \log q(z_i | \lambda_i)) \right]. \end{equation} With samples $z_s \sim q_{(i)}(z | \lambda)$ , they then propose to estimate the above via Monte Carlo. \begin{equation} \nabla_{\lambda_i}\mathcal{L} \approx \frac{1}{S}\sum_{s=1}^S \nabla_{\lambda_i} \log q_i(z_s | \lambda_i)(\log p_i(x, z_s) - \log q_i(z_s | \lambda_i)). \end{equation} My question is: is it not an abuse of notation to write $q_i(z_s | \lambda_i)$ , since $z_s$ is vector-valued (one entry for each R.V. in the Markov blanket) and $q_i$ is properly a conditional distribution of a univariate random variable? In that case, what are we supposed to read for $q_i(z_s | \lambda_i)$ ? To be even more pedantic, the Markov blanket of an R.V. doesn't include the R.V. itself, right? So a sample $z_s$ doesn't contain an entry corresponding to variable $i$ , so the conditional is undefined. So if the above is correct, then we are making two leaps: By Markov blanket the authors refer to the classical notion of Markov blanket, plus the RV itself. There is implicit indexing into $z_s$ going on when we write $q_i(z_s | \lambda_i)$ (should be $q_i(z_{si} | \lambda_i))$ .
