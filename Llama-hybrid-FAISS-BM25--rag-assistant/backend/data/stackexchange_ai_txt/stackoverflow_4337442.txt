[site]: stackoverflow
[post_id]: 4337442
[parent_id]: 4334345
[tags]: 
You can use my JwaWinsta unit which is in the Delphi Jedi Apilib. More specifically you can use WinStationQueryInformationW with the WinStationClient info class which returns a WINSTATIONCLIENT structure. In this structure is the WinStationClientFlags member which is a bitfield that can contain any mask of the following constant: TS_PERF_DISABLE_NOTHING = $0; TS_PERF_DISABLE_WALLPAPER = $1; TS_PERF_DISABLE_FULLWINDOWDRAG = $2; TS_PERF_DISABLE_MENUANIMATIONS = $4; TS_PERF_DISABLE_THEMING = $8; TS_PERF_ENABLE_ENHANCED_GRAPHICS = $10; TS_PERF_DISABLE_CURSOR_SHADOW = $20; TS_PERF_DISABLE_CURSORSETTINGS = $40; TS_PERF_ENABLE_FONT_SMOOTHING= $80; TS_PERF_ENABLE_DESKTOP_COMPOSITION = $100; TS_PERF_DEFAULT_NONPERFCLIENT_SETTING = $40000000; TS_PERF_RESERVED1 = $80000000; Further more this structure also returns the ColorDepth member.
