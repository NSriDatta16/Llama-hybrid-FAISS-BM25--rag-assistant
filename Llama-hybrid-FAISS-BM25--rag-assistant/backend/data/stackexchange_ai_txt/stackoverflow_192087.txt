[site]: stackoverflow
[post_id]: 192087
[parent_id]: 191974
[tags]: 
SELECT (invoiceprice * detailweight) / SUM(weight) OVER(PARITTION BY invoice) as weighted, * FROM tblInvoiceDetails Windowed functions are awesome for doing things like weighted averages, and other things that previously required CURSORS.
