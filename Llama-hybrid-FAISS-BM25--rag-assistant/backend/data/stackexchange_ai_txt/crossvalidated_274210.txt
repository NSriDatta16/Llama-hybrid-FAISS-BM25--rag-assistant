[site]: crossvalidated
[post_id]: 274210
[parent_id]: 
[tags]: 
How do I weight a prior for empirical Bayesian updating using a multivariate gamma distribution?

This is my first time dipping my toes into the Cross Validated waters, so please go easy on this rookie both to CV and to Bayesian statistics. :) I have a dataset of 215,000 observations of two continuous numerical variables, just call them X and Y. Each observation contains a value for each variable, along with the name of the person it corresponds to and the year it was taken. There are around 500 people, two consecutive years of data, and ~200 observations per person per year, though some people only have a couple of observations and some have like 500. X and Y have a positive linear correlation. This dataset represents an entire population, not just a sample taken from one. After some poking around, I've found that the data are fairly well-described by a multivariate gamma distribution (MVG) with five parameters: a shape and rate parameter for each of X and Y, and a correlation matrix between them. For any group of observations--the relevant ones being the population as a whole, and those for each person in each year--I can fit a MVG using maximum likelihood. My goal is to predict the parameters of the MVG for each person in year 2, using a blend of that person's MVG in year 1 and the overall average MVG. I know how to update a single-variable gamma distribution from prior to posterior: (α0 + nα, β0 + Σxi). What I don't know is: How many observations' worth of data to put on the prior. If α0 and β0 are just the parameters of the overall average, then they're given the same weight as one single observation, which means that a typical person's posterior will contain like 200 parts sample for every 1 part prior. That's obviously wrong. I imagine I need to solve this empirically, by optimizing for the right number of observations to place on the prior that yields the posterior closest to the actual MVG in year 2. However, I don't know what loss function to minimize in order to determine this value. I can measure how close a prediction of a single continuous variable is to a result using mean squared error. But how do I measure how similar/close a gamma distribution defined by one set of parameters is to one defined by a different set of parameters? I imagine it would be some form of the mean square error of the density function calculated at every point on the distribution...or can I just sample randomly from one distribution and then apply a Kolmogorov–Smirnov test against the other? How to expand the updating function to a multivariate gamma from the one-dimensional one that uses (α0 + nα, β0 + Σxi), as well as whatever loss function I wind up using for the above. Googling around, I found http://www2.stat.duke.edu/~sd83/Research/das-dey-mult-gamma.pdf for the update, but wasn't able to decipher the notation of Equation 8, which I believe is the closed-form solution. I also found the kde.test goodness-of-fit function which can expand beyond one dimension, but would hope for a more elegant method. If anyone could offer any guidance on this, I'd really appreciate it. Thanks in advance for any ideas you might be able to offer. Dan
