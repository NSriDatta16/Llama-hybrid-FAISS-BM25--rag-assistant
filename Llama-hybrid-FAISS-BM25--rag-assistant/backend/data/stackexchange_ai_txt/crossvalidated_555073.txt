[site]: crossvalidated
[post_id]: 555073
[parent_id]: 
[tags]: 
How to Collapse data with weighted averages for the variables?

I have a dataset containing postal codes, district numbers and some other variables such as income, age, education levels etc from about 10,000 observations. I need to Collapse(mean) variables 'income' and 'age' by postal codes but I want to take the weighted average so that I avoid the following problem. After collapsing, I find the average income and age by postal codes amongst my observation. However, not all observation are evenly spread out by postal codes. There are more observations from 1 postal code as compared to another, which is normal. However for collapsing, I want to reweight my variables in such a way that proportionately more weight is given to postal codes with more observations and less to postal codes with lesser observations. This way the average income and age by postal code would not be unbiased. If somebody could help me out with any tricks or solutions, it would save a lifetime of effort from me.
