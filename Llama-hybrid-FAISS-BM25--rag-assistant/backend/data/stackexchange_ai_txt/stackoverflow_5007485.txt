[site]: stackoverflow
[post_id]: 5007485
[parent_id]: 
[tags]: 
SQL Query For Most Popular Combination

Suppose I have a grocery store application with a table of purchases: customerId int itemId int Four customers come into the store: Bob buys a banana, lemonade, and a cookie Kevin buys a banana, lemonade, and a donut Sam buys a banana, orange juice, and a cupcake Susie buys a banana I am trying to write a query which would return which combinations of items are most popular. In this case, the results of this query should be: banana and lemonade-2 I have already written a query which tells me a list of all items which were in a multi-item purchase (we exclude sales of one item - it cannot form a "combination"). It returns: banana - 3 lemonade - 2 cookie - 1 donut - 1 cupcake - 1 orange juice - 1 Here is the query: SELECT itemId, count( * ) FROM grocery_store INNER JOIN ( SELECT customerId FROM grocery_store GROUP BY customerId HAVING count( itemId ) > 1 )subQuery ON subQuery.customerId = grocery_store.customerId GROUP BY itemId; Could I get a pointer about how to expand my existing query to get the desired output?
