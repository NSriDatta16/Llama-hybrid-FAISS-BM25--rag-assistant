[site]: stackoverflow
[post_id]: 4947630
[parent_id]: 4927272
[tags]: 
Here's the code for the GridView on default.aspx: I used a variation of the code detailed on this page and got it to work! vb.net SQL query works in SQL server but not when called from checkbox For the default.aspx.vb code behind I added: Public Sub checkbox_CheckedChanged(ByVal sender As Object, ByVal e As EventArgs) 'Handles checkbox.CheckedChanged Dim connectionString As String = ConfigurationManager.ConnectionStrings("AgentLeadsConnectionString").ConnectionString Dim box As CheckBox = DirectCast(sender, CheckBox) Dim tblcell As TableCell = CType(box.Parent, TableCell) Dim dgRow As GridViewRow = CType(tblcell.Parent, GridViewRow) Dim lastname As String = [last name].Rows(dgRow.DataItemIndex).Cells(0).Text Dim firstname As String = [first name].Rows(dgRow.DataItemIndex).Cells(0).Text Dim address As String = [Address Line1].Rows(dgRow.DataItemIndex).Cells(0).Text Dim insertSQL As String If box.Checked = True Then insertSQL = "UPDATE MktDataLeads_scrubbed " insertSQL &= "SET donotmail=1 " insertSQL &= "WHERE [last name]= @lastname AND [first name]=@firstname AND [Address Line1]=@address " Else insertSQL = "UPDATE MktDataLeads_scrubbed " insertSQL &= "SET donotmail=0 " insertSQL &= "WHERE [last name]= @lastname AND [first name]=@firstname AND [Address Line1]=@address " End If Using con As New SqlConnection(connectionString) Dim cmd As New SqlCommand(insertSQL, con) cmd.Parameters.AddWithValue("@donotmail", donotmail) Try con.Open() cmd.ExecuteNonQuery() Catch Err As SqlException MsgBox("Error", 65584, "Insertion Error") End Try con.Close() End Using End Sub For the gridview I used the same code: ' Enabled="true" /> ' />
