[site]: stackoverflow
[post_id]: 3300734
[parent_id]: 
[tags]: 
Grouping parents containing the same set of children

I have this parent-child relationship Paragraph --------- ParagraphID PK // other attributes ... Sentence -------- SentenceID PK ParagraphID FK -> Paragraph.ParagraphID Text nvarchar(4000) Offset int Score int // other attributes ... I'd like to find paragraphs that are equivalent; that is paragraphs that contain the same set of sentences. Two sentences are considered the same if they have the same Text, Offset and Score - SentenceID/ParagraphID is not part of the comparison, and two paragraphs are equivalent if they contain an equal set of sentences. Could someone show me what a query to find equal paragraphs would look like? EDIT: There are ca. 150K paragraphs, and 1.5M sentences. The output should include the ParagraphID, and the lowest paragraph ID that is equivalent to this one. E.g. if paragraph1 and paragraph2 are equal, then output would be ParagraphID EquivParagraphID 1 1 2 1
