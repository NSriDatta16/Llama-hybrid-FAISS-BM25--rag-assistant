[site]: crossvalidated
[post_id]: 71414
[parent_id]: 
[tags]: 
Specify a Zero-inflated (Hurdle) Gamma Model in JAGS/BUGS

I'm trying to use a zero-inflated gamma model (or a gamma 'hurdle' model). The model is a mixture of logistic regression and generalized linear modeling. I can do this analysis in two steps: 1) do a logistic regression against presence/absence data and then 2) Use a generalized linear model with a gamma distribution on the positive values. I'm trying to set the model up where, if y = 0, then E(y) = p, but if y > 0, then E(y) is gamma distributed. I'm trying to set this up in BUGS/JAGS, because I've seen these models worked before for poisson-distributions . I tried to adapt the code from that link into a gamma distribution, but I can't quite seem to get it to work. I know the code won't work because my data have zeroes, and the likelihood function can't be evaluated with zeroes. However, even when restricted to positive values, I get errors for invalid parent values. Even so, I'm not even sure the model is specified correctly. Here is the model: # For the ones trick C Has anyone set a model up like this or have any advice on how to set it up correctly? UPDATE I've tried a new set of code that's similar, but slight different. I still have not gotten it to work model{ # For the ones trick C 0.0001. This is essentially a presence # absence dummy variable z[i] = 0.0001 (z = 1). So if z = 1, then the first bit must be # 0 and the second bit 1. Use 1 - z, which is 0 if y > 0.0001 and 1 if y UPDATE 2 I've gotten it to run by deleting the definition of logGamma[i] and putting it directly into the likelihood function, which now reads: logLik[i] The problem was that JAGS was trying to evaluate the log likelihood at all observations first, resulting in NA's for the 0's. In the new way, it only evaluates it if z = 1 (I think). I'm still having trouble getting the parameter estimates to line up. For example, the gamma's are almost identical to a logistic regression of the same form (hooray!). But the betas are pretty far off from a gamma GLM of the positive values. I don't know if this is normal or not, but I suspect there are still problems with my model specification.
