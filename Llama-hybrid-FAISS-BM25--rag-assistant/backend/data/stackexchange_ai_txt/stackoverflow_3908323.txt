[site]: stackoverflow
[post_id]: 3908323
[parent_id]: 3899852
[tags]: 
LINQ is just freaking magical: public IEnumerable FindImages(FlowDocument document) { return document.Blocks.SelectMany(FindImages); } public IEnumerable FindImages(Block block) { if (block is Table) { return ((Table)block).RowGroups .SelectMany(x => x.Rows) .SelectMany(x => x.Cells) .SelectMany(x => x.Blocks) .SelectMany(FindImages); } if (block is Paragraph) { return ((Paragraph) block).Inlines .OfType () .Where(x => x.Child is Image) .Select(x => x.Child as Image); } if (block is BlockUIContainer) { Image i = ((BlockUIContainer) block).Child as Image; return i == null ? new List () : new List (new[] {i}); } throw new InvalidOperationException("Unknown block type: " + block.GetType()); }
