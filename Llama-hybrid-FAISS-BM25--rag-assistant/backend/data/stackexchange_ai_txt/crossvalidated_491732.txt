[site]: crossvalidated
[post_id]: 491732
[parent_id]: 
[tags]: 
Multivariate bayesian parameter estimation

I am implementing an example for pymc3 in python and I want to understand the mathematical formulation of this code. # Create random sample. y_observations = np.random.normal(loc=0.5, scale=0.35, size=2000) # Create pymc3 model. with pm.Model() as exercise1: # Prior distributions standard_deviation = pm.HalfNormal('sigma', sd=1.0) mean = pm.Normal('mu', mu=0.0, sd=1.0) y = pm.Normal('y', mu=mean, sd=standard_deviation, observed=y_observations) # Running Markov Chain Monte Carlo trace = pm.sample(1000) pm.traceplot(trace, ['mu', 'sigma']) plt.show() Question : I am trying to formulate the task of the code as a mathematical procedure. I wanted to know if my understanding of the underlying mathematics behind the code is correct. My attempt to put the code into mathematical language : The data $\mathcal{D} = \{y_1, \ldots, y_N\}$ is assumed to be independent and identically distributed (short i.i.d.). The underlying distribution is the normal distribution $$y \sim \mathcal{N}(y|\mu, \sigma).$$ Hence, the two parameters are $\mu$ and $\sigma$ . The prior is given by $$p(\mu,\sigma) = \mathcal{N}(\mu| 0, 1) \cdot \mathcal{N}_+(\sigma|0, 1),$$ in which $\mathcal{N}_+(\sigma|0, 1)$ is the half-normal distribution. The mathematical formulation is given by $$\mathcal{N}_+(\sigma|0, 1) = 2 \mathcal{N}(\sigma|0, 1)\text{ , for }\sigma \geq 0$$ Note that we assumed stochastic independence between $\mu$ and $\sigma$ by applying $p(\mu,\sigma) = p(\mu) \cdot p(\sigma)$ . The likelihood $p(\mathcal{D}|\mu, \sigma)$ can be written as $$p(\mathcal{D}|\mu, \sigma) = \prod_{n=1}^N\mathcal{N}(y_n|\mu, \sigma),$$ if we apply the i.i.d. property. Hence, the posterior distribution $p(\mu, \sigma | \mathcal{D})$ is given by $$p(\mu, \sigma | \mathcal{D}) = \dfrac{p(\mathcal{D}|\mu, \sigma)p(\mu,\sigma)}{\int_{\mu=-\infty}^{\infty}\int_{\sigma=0}^{\infty}p(\mathcal{D}|\mu, \sigma)p(\mu,\sigma)d\sigma d\mu}$$ $$= \dfrac{\prod_{n=1}^N\mathcal{N}(y_n|\mu, \sigma)\mathcal{N}(\mu| 0, 1) \cdot \mathcal{N}_+(\sigma|0, 1)}{\int_{\mu=-\infty}^{\infty}\int_{\sigma=0}^{\infty}\prod_{n=1}^N\mathcal{N}(y_n|\mu, \sigma)\mathcal{N}(\mu| 0, 1) \cdot \mathcal{N}_+(\sigma|0, 1)d\sigma d\mu}.$$ The Markov Chain Monte Carlo (MCMC) algorithm samples parameters $\mu$ and $\sigma$ from this posterior distribution and counts how often a specific value (or interval) for $\mu$ and $\sigma$ is selected to generate the plots on the left-hand side.
