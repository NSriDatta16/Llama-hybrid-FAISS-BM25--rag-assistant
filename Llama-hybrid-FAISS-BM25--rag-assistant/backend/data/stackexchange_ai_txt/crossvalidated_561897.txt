[site]: crossvalidated
[post_id]: 561897
[parent_id]: 
[tags]: 
Simpson paradox with lmer

I am measuring 2 responses in patients from different age cohorts. Each response is negatively correlated with age. This gives me a positive correlation of ResponseX and ResponseY in a total population. For each given age group ResponseX and ResponseY are negatively correlated. Moreover, the slope of this correlation is Age-dependent. Below you will find the code to generate fake data very similar to what I have: library('ggplot2') library(tidyverse) library(lme4) # average X and Y depends from Age k_mu If I will plot the glm regressions it looks pretty nice: ggplot(data, aes(x = x, y = y, color = age) ) + geom_point() + geom_smooth(method = "lm", se = T)+ geom_smooth(group=1,method = "glm", se = T,'color'='black')+ labs(x='ResponseX', y='ResponseY', color='Age') Now I want to find equations for all 4 lines from this plot and equation of dependence of ingroup slopes from age. To do this I tried to use lmer , but I could not find a solution. The following code gives me an error: lmer(y ~ 1+age + (1+x|age), data = data) %>% summary() Could you help me to model my data?
