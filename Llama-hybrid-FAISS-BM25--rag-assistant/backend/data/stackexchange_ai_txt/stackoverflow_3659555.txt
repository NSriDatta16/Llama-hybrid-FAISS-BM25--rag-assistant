[site]: stackoverflow
[post_id]: 3659555
[parent_id]: 3658026
[tags]: 
=(SUM(($A$2:$A$9=A2)*($B$2:$B$9=B2)*($C$2:$C$9))-(SUM(($B$2:$B$9=B2)*($C$2:$C$9))/SUM(--($B$2:$B$9=B2))))/SUM(($A$2:$A$9=A2)*($B$2:$B$9=B2)*($C$2:$C$9)) This is an array formula and must be entered with Control+Shift+Enter, not just Enter. If your first line of data starts in A2, this formula goes in D2 and fill down to the extent you have data. SUM(($A$2:$A$9=A2)*($B$2:$B$9=B2)*($C$2:$C$9)) This part sums all the data that has the same name and month as the row you're on. (SUM(($B$2:$B$9=B2)*($C$2:$C$9))/SUM(--($B$2:$B$9=B2))) This part takes the average (sum/count) of all the data that has the same name as the row you're on regardless of month. For dec, 553, 12, you'll get -4.17%. The average for 553 is 12.5 and dec is 4.17% less than the average.
