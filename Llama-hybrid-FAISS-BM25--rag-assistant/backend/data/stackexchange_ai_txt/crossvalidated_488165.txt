[site]: crossvalidated
[post_id]: 488165
[parent_id]: 
[tags]: 
How Would I Perform the ADF Unit Root Test Manually?

I am trying to gain a better understanding of the procedure of the ADF unit root test as I believe I am misunderstanding it. I have written python code that follows the steps below and I receive a different test statistic to that of python's "adfuller" function when not accounting for a constant or trend. Suppose I wanted to perform the ADF test with 3 lags (for simplicity), as I currently understand it: Step 1 Construct the equation with 3 lags: $y_t = \beta_1y_{t-1}+\beta_2y_{t-2}+\beta_3y_{t-3}+\epsilon_t$ Compute the estimated regression: $y_t = \hat\beta_1y_{t-1}+\hat \beta_2y_{t-2}+\hat \beta_3y_{t-3}$ To obtain the $\hat \beta$ 's: $\hat\beta$ $=$$(X^{'}X)^{-1}X^{'}y_t$ Step 2 Rewrite the above estimated regression equation to construct the ADF equation: $\Delta y_t = \hat \pi_1y_{t-1}+\hat c_1\Delta y_{t-1}+\hat c_2\Delta y_{t-2}$ Where the ADF test statistic is $TS=\frac{\hat \pi}{SE(\hat \pi)}$ Where $\hat \pi =\hat\beta_1+\hat\beta_2+\hat\beta_3-1$ [ADF Derivation & TS Source: https://www.youtube.com/watch?v=4TBZnrUDrog] Where $SE(\hat \pi)=\sqrt {MSE}*\sqrt{\Sigma y_{t-1}^2}$ [SE Source: https://www.bauer.uh.edu/rsusmel/phd/ec2-5.pdf] (page 15) Using an example time series (1 is the newest value, 9 is the oldest value). I understand this time series would not work as the $X'X$ matrix in the OLS regression would become singular, it is just for easy demonstration: $$ y_t = [1, 2, 3, 4, 5, 6, 7, 8, 9] $$ $$ y_t(adjusted) = [1, 2, 3, 4, 5, 6] $$ $$ y_{t-1} = [2, 3, 4, 5, 6, 7] $$ $$ y_{t-2} = [3, 4, 5, 6, 7, 8] $$ $$ y_{t-3} = [4, 5, 6, 7, 8, 9] $$ $$ X=\begin{bmatrix}2&3&4\\3&4&5\\4&5&6\\5&6&7\\6&7&8\\7&8&9\end{bmatrix}X^{'}=\begin{bmatrix}2&3&4&5&6&7\\3&4&5&6&7&8\\4&5&6&7&8&9\end{bmatrix} $$ I would like to know whether my understanding of the ADF test is wrong or I have simply coded my python script incorrectly. Thank you for your time.
