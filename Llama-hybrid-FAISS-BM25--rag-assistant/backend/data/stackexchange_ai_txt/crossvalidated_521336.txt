[site]: crossvalidated
[post_id]: 521336
[parent_id]: 
[tags]: 
Minibatch Weighted Sampling for estimating log(q_z) for disentangled representation based on ELBO loss in VAE

I'm reading the paper "Isolating Sources of Disentanglement in VAEs" https://arxiv.org/pdf/1802.04942.pdf . Assuming $p(n)$ is a uniform distribution and that we have a model to get $q(z|n)$ for any input n. Also, $q(z|n)$ represents a normal distribution, so the model predicts the mean and covariance matrix for $q(z|n)$ . Please consider the following minibatch-based estimation provided by the author. Doubt 1. I'm not able to understand how to come from the second line to the third line, where $E_{p(B_M)}$ is introduced along with averaging over the values of $q(z|n_m)$ . It is somewhat intuitive, but I'd like to know concretely. Doubt 2. What happened to the $E_r(B_M|n)$ coming to S4. I'm sorry, if these are too trivial. Thanks for any help.
