[site]: stackoverflow
[post_id]: 5198530
[parent_id]: 
[tags]: 
File download fails over https in IE

I'm trying to download a file over HTTPS & it fails in IE but works perfectly with Firefox & Chrome: aspx code is as follows: Code behind code on button click is as follows: protected void Button1_Click(object sender, EventArgs e) { string filename = TextBox1.Text; string filepath = Server.MapPath(filename); byte[] bytFile = null; FileStream fs = new FileStream(filepath, FileMode.Open, FileAccess.Read); BinaryReader br = new BinaryReader(fs); long numBytes = new FileInfo(filepath).Length; bytFile = br.ReadBytes((int)numBytes); string extension = ".xlsx"; Response.ClearHeaders(); Response.Clear(); Response.Buffer = true; if (extension == ".doc") { Response.ContentType = "application/vnd.ms-word"; Response.AddHeader("content-disposition", "attachment;filename=" + filename); } else if (extension == ".docx") { Response.ContentType = "application/vnd.openxmlformats-officedocument.wordprocessingml.document"; Response.AddHeader("content-disposition", "attachment;filename=" + filename); } else if (extension == ".xls" || extension == ".xlsx") { if (extension == ".xls") { Response.ContentType = "application/vnd.ms-excel"; Response.AddHeader("content-disposition", "attachment;filename=" + filename); } else { Response.ContentType = "application/ms-excel"; //Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"; Response.AddHeader("content-disposition", "attachment;filename=" + filename); } } else if (extension == ".pdf") { Response.ContentType = "application/pdf"; Response.AddHeader("content-disposition", "attachment;filename=" + filename); } Response.Charset = ""; Response.Cache.SetCacheability(HttpCacheability.NoCache); Response.BinaryWrite(bytFile); HttpContext.Current.ApplicationInstance.CompleteRequest(); Response.End(); } Please help
