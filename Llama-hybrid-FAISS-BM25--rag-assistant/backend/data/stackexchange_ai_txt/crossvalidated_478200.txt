[site]: crossvalidated
[post_id]: 478200
[parent_id]: 
[tags]: 
Can I use matching weights to check that treatment endogeneity is eliminated after exact matching?

I want to check that the endogeneity of a treatment variable gets eliminated by conditioning on a set of control variables, but I am not entirely sure on how to proceed. I have tried one approach and I would welcome your thoughts. I have a cross-sectional dataset with 200K+ individuals, households being the sampling units. I want to estimate the causal effect of some dichotomous treatment $X$ on a continuous outcome $Y$ . My basic model is as follows: $$y_{h,i} = \beta_0 + \beta x_{h,i} + \epsilon_{h,i},$$ where $\epsilon_{h,i}=\eta_h+\upsilon_{h,i}$ , $\eta_h$ being a household (fixed or random) effect, and $\upsilon_{h,i}$ being idiosyncratic error. The problem is that $X$ is endogenous, so OLS is inconsistent. I need to employ other estimators for causal inference, and in my case matching estimators are the most appropriate (I don't have a good instrument for $X$ and am not in a panel setting so as to use DiD). I have a large sample size so I can afford exact matching. I use the R package MatchIt (method="exact") to do the matching. Call $\mathbf{Z}$ the variables I use to exactly match treated and untreated individuals. The matching procedure returns a vector of strictly positive weights, $W$ , such that, if $x_{h,i}=1$ , $w_{h,i}=1$ ; otherwise, given $\mathbf{Z}$ , $w_{h,i}=n_{\mathbf{Z},t}/(n_{\mathbf{Z}}-n_{\mathbf{Z},t})$ , i.e. the weight is increasing in the number of matched treated individuals and decreasing in the total number of individuals equal in $\mathbf{Z}$ . The point of these weights is to run WLS, using the following weighted version of the above model: $$w_{h,i}y_{h,i} = w_{h,i}(\beta_0 + \beta x_{h,i} + \epsilon_{h,i}).$$ Provided that $\mathbf{Z}$ suffices to conditionally break the endogeneity of $X$ (through the weight adjustments $W$ ), my understanding is that WLS returns an unbiased estimate of $\beta$ , which is interpreted as the average treatment effect on the treated. Right, but does the $\mathbf{Z}$ I chose do the job? I want to test this. I want evidence that matching individuals on $\mathbf{Z}$ breaks the endogeneity of $X$ and makes my set-up random-like, so I can make causal inference. Essentially, I want to test that $E(\epsilon_{h,i}|X,\mathbf{Z})=E(W^T\mathbf{\epsilon}|W^TX)=0$ (please forgive the slightly informal notation), knowing that $E(\epsilon_{h,i}|X)\neq0$ most likely. For a start, I ran a Hausman test to check that $Cov(\eta_h,X|\mathbf{Z})=0$ , i.e. that random effects were preferred to fixed effects in the weighted model. I found this was the case (while $Cov(\eta_h,X)\neq0$ , suggesting fixed effects were preferred in the unweighted model). This is a good result, since it shows that $X$ is uncorrelated with part of $\epsilon_{h,i}$ after matching. Yet it is not enough. I also want to test that $Cov(\upsilon_{h,i},X|\mathbf{Z})=0$ . At first I thought I could run a classic test for endogeneity by regressing $X$ on $\mathbf{Z}$ and then adding the residuals as regressors in the weighted model. If the coefficient on these residuals had been non-zero, I would have concluded $X$ was still endogenous, and so that matching on $\mathbf{Z}$ did not fully eliminate endogeneity. However, the premise of this test is that $\mathbf{Z}$ is uncorrelated to $Y$ , and I have good reasons to believe the opposite. Thus specified, the endogeneity test won't work. Hence, instead of regressing $X$ on $\mathbf{Z}$ , and knowing I do not have any good instrument for $X$ at all, I thought I could try the following: $$x_{h,i} = \delta_0 + \delta w_{h,i} + \zeta_h + v_{h,i},$$ where $\zeta_h$ is a household random effect and $v_{h,i}$ idiosyncratic error. I thought I could then test for the endogeneity of $X$ as usual, by adding the residuals of the last model (the fitted values of $v_{h,i}$ ) as regressors in the weighted model above and examine the coefficient thereon. I reckon the last is kind of an odd model. Yet $X$ and $W$ are very much correlated ( $x_{h,i}=1$ implies $w_{h,i}=1$ ), so we can explain the former in terms of the latter. Notice also that $W$ is uncorrelated to $Y$ , except through $X$ : by construction, it only depends on $X$ , $n_{\mathbf{Z}}$ and $n_{\mathbf{Z},t}$ , the latter two being uncorrelated to $Y$ . For this reason, $W$ qualifies as an 'instrument' for $X$ . This is why I tried to test for endogeneity using this pseudo-instrumental variable. In this way, I am using the same variable, $W$ , both as an instrument (in the $X$ -regression) and as weights (in the weighted $Y$ -regression). Notice also that, again by construction, $Cov(\zeta_h,W)=0$ , hence the choice of random as opposed to fixed effects. Following this approach, I got results that make some sense. The residuals had a zero coefficient when plugged into the weighted model, suggesting $X$ was no longer endogenous after matching on $\mathbf{Z}$ . I then tried to do the matching using smaller set of $\mathbf{Z}$ (call it $\mathbf{Z}'$ ), which I did not believe to be able to break endogeneity. I used the newly obtained vector of weights (call it $W'$ ) in place of $W$ , and I found the coefficient on residuals to be non-zero, suggesting that $X$ was still endogenous after such 'reduced' matching, as expected. Now, my question is: does my procedure make sense to you as it does to me? I hope I made clear that my goal is to check that, after matching treated and untreated individuals on some set of controls, treatment assignment becomes exogenous. My procedure is meant to make this check. Do you think it is sound? Does it need some adjustments? Or is it complete nonsense? Is there a better way? I would appreciate some feedback, references, or advice on how to deal with the matter alternatively. Thank you!
