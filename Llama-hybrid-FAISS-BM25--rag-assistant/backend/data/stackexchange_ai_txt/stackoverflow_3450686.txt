[site]: stackoverflow
[post_id]: 3450686
[parent_id]: 
[tags]: 
XSL processor stack has overflowed - can't understand why

I'm trying to conditionally display the content of HTML page depending if a document being generated for a recognised company or not. However, the transformation doesn't work and I can't understand why :( I use MSXML3.0 as transformer and oXygen as IDE, which gives the errors I presented below. What I do is to construct a long string of all recognised companies (default and extra if any). I then split them into elements that are stored in the $companiesKnownList variable. To determine if a company is in that list I count how many times it occurs: count($companiesKnownList/token[normalize-space(.) = $productName]) &lt; 1 If it's less than 1, then the company doesn't appear in the $companiesKnownList variable and therefore is not recognized. Otherwise, if it appears in the $companiesKnownList variable once or more times it is a recognized company. Nevertheless, this is where it breaks and displays the following error: Description: Code: 0x80004005 Description: The XSL processor stack has overflowed - probable cause is infinite template recursion. Description: The transformer process ended with code: 1 I've noticed that if my XML has got a recognised company, ex @ProductName="ski" then transformation fails with stack overflow. If I have an unrecognized company, ex @ProductName="bla" the transformation works and text that it isn't a recognized company is displayed. I don't understand what's going wrong with valid companies. I would be more than grateful if you could help me out. I have been staring at it for a day now...without any progress :S Thanks! Here is my stylesheet: This type of company is NOT recognised for this document. This type of company is recognised for this document. XML is something simple like: In this example, ski is recognized company, but transformation fails. In this example, bla is not a recognized company and transformation succeeds with displaying text: "This type of company is NOT recognised for this document."
