[site]: stackoverflow
[post_id]: 5303291
[parent_id]: 
[tags]: 
How To Prevent Internet Explorer Security Alert During HTTPWebRequest

Is there a way to prevent an error message or of programmatically clicking yes to the message that pops up while retrieving an HTTPWebRequest? The code shown below causes an alert message whose text is "This page has an unspecified potential security risk. Would you like to continue?" The caption of the message is "Internet Explorer". Some clues as to what might be causing the error message are: • It does not seem to be caused by an sslPolicyErrors as the line of code ServicePointManager.ServerCertificateValidationCallback = ((sender, certificate, chain, sslPolicyErrors) => true); should prevent this. • Internet Explorer options were set so that the website http://jobsearch.monster.com is on the list of trusted sites. • The message occurs after the next to the last line of code is executed: -oDoc.close(); • The message can be observed by running the code in response to a button click on a widows form. • The error message has to be manually clicked three times (yes or no) in order for the message to dissappear. • This is the only web site to date that causes this error message. using System; using System.Collections.Generic; using System.ComponentModel; using System.Data; using System.Drawing; using System.IO; using System.Linq; using System.Text; using System.Windows.Forms; //using System.Threading; using System.Net; using mshtml; namespace FitCShp { public partial class frmThreadIssue : Form { public frmThreadIssue() { InitializeComponent(); } private void button2_Click(object sender, EventArgs e) { HTMLDocumentClass oDoc; oDoc = GetDoc(); } public HTMLDocumentClass GetDoc() { string WebAddrs = "http://jobsearch.monster.com/PowerSearch.aspx?q=proven%20record%20relationship&where=portland%2C%20or&rad=20&rad_units=miles&tm=60"; IHTMLDocument2 oDoc = null; HttpWebRequest Req = (HttpWebRequest)WebRequest.Create(WebAddrs); //build the request ServicePointManager.ServerCertificateValidationCallback = ((sender, certificate, chain, sslPolicyErrors) => true); Req.AllowAutoRedirect = true; Req.ContentType = "application/x-www-form-urlencoded"; Req.KeepAlive = false; Req.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.11) Gecko/20071127 Firefox/2.0.0.11'"; HttpWebResponse resp = (HttpWebResponse)Req.GetResponse(); //Get the encoding of the response System.Text.Encoding Enc = System.Text.Encoding.GetEncoding(resp.CharacterSet); StreamReader sr = new StreamReader(resp.GetResponseStream(), Enc); //Create the stream reader string sDoc = sr.ReadToEnd(); //read the stream that represents the Webdoc sr.Close(); //close the stream HTMLDocument ProfileHTML = new HTMLDocument(); oDoc = (IHTMLDocument2)ProfileHTML; oDoc.write(sDoc); oDoc.close(); //--- Error occurs here return (HTMLDocumentClass)oDoc; } } }
