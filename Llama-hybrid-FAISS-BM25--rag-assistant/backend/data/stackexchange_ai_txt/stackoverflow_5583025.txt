[site]: stackoverflow
[post_id]: 5583025
[parent_id]: 
[tags]: 
Stored Procedure MVC3 error on execution

I got a stored procedure that reads a table and insert those data to antoher table. That's the way how it works because the first table imports data from excel using a package with SSIS. In EF4 I imported the SP and create function import: This SP has 2 IN variables and 2 OUT varibales. The IN varibales are parameters and OUT variables are a message and the number of records created. I put the code generated: #Region "Function Imports" ''' ''' No Metadata Documentation available. ''' ''' No Metadata Documentation available. ''' No Metadata Documentation available. ''' No Metadata Documentation available. ''' No Metadata Documentation available. Public Function spCargaArchivos(parIDPoliza As Nullable(Of Global.System.Int64), parFechaActual As Nullable(Of Global.System.DateTime), varError As ObjectParameter, varKontador As ObjectParameter) As Integer Dim parIDPolizaParameter As ObjectParameter If (parIDPoliza.HasValue) Then parIDPolizaParameter = New ObjectParameter("parIDPoliza", parIDPoliza) Else parIDPolizaParameter = New ObjectParameter("parIDPoliza", GetType(Global.System.Int64)) End If Dim parFechaActualParameter As ObjectParameter If (parFechaActual.HasValue) Then parFechaActualParameter = New ObjectParameter("parFechaActual", parFechaActual) Else parFechaActualParameter = New ObjectParameter("parFechaActual", GetType(Global.System.DateTime)) End If Return MyBase.ExecuteFunction("spCargaArchivos", parIDPolizaParameter, parFechaActualParameter, varError, varKontador) End Function #End Region But when I try to execute the SP I get error: The parameter at index 2 in the parameters array is null Execution Dim varMensaje As Objects.ObjectParameter = Nothing Dim varError As Objects.ObjectParameter = Nothing Dim varRespuesta As Integer = varEntidades.spCargaArchivos(parIDPoliza, Now.Date, varError, varMensaje) Any suggestion??
