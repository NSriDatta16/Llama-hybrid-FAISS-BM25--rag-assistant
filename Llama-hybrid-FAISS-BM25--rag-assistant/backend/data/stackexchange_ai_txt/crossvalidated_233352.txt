[site]: crossvalidated
[post_id]: 233352
[parent_id]: 
[tags]: 
Time Series Analysis, Model Change: Dealing with Outliers

I have time series, and I know the models underlying this time series. So, for example, first 100 points are generated with model $H_1$, next 50 with model $H_2$ and so on. The problem is: I am interested only in long shifts of model. In other words, I want to detect events that involve > 10 points, but I know that these large events can contain extra-small model shifts, like: 50 points with $H_0$, 15 points with $H_1$, 1 point with $H_2$, 10 points with $H_1$, 2 points with $H_0$, 20 points with $H_1$. I do not want to detect these small events within the large model shift. If I will try to calculate likelihood ratio for the segment that contains micro-shifts, my ratio will be slightly shifted. I want to say: each point have a probability of .99 to be generated by one of the $H$ models and .01 probability to be a complete noise, outlier. I know how to calculate likelihood ratio in case if an outlier was generated by some distribution, but I do not know the distribution of outliers. The question is: how to write likelihood ratio formula for the point, taking into account that with probability 0.01 the point is meaningless, generated with unknown distribution without any constraints?
