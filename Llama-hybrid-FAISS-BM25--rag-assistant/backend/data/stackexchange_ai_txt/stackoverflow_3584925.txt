[site]: stackoverflow
[post_id]: 3584925
[parent_id]: 3264994
[tags]: 
FSCTL_GET_VOLUME_BITMAP should be exactly what you're looking for, and should be pretty quick. This is what a lot of components use to try and defrag a single file, say, into a large contiguous space.
