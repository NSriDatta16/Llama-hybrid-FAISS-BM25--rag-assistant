[site]: crossvalidated
[post_id]: 4202
[parent_id]: 4187
[tags]: 
Expressing factors relationships using R formulas follows from Wilkinson's notation, where '*' denotes crossing and '/' nesting, but there are some particularities in the way formula for mixed-effects models, or more generally random effects, are handled. For example, two crossed random effects might be represented as (1|x1)+(1|x2) . I have interpreted your description as a case of nesting, much like classes are nested in schools (nested in states, etc.), so a basic formula with lmer would look like (unless otherwise stated, a gaussian family is used by default): y ~ x + (1|A:B) + (1|A) where A and B correspond to your inner and outer factors, respectively. B is nested within A, and both are treated as random factors. In the older nlme package, this would correspond to something like lme(y ~ x, random=~ 1 | A/B) . If A was to be considered as a fixed factor, the formula should read y ~ x + A + (1|A:B) . But it is worth checking more precisely D. Bates' specifications for the lme4 package, e.g. in his forthcoming textbook, lme4: Mixed-effects Modeling with R , or the many handouts available on the same webpage. In particular, there is an example for such nesting relations in Fitting Linear Mixed-Effects Models, the lme4 Package in R . John Maindonald's tutorial also provides a nice overview: The Anatomy of a Mixed Model Analysis, with Râ€™s lme4 Package . Finally, section 3 of the R vignette on lme4 imlementation includes an example of the analysis of a nested structure. There is no predict() function in lme4 (this function now exists, see comment below), and you have to compute yourself predicted individual values using the estimated fixed (see ?fixef ) and random (see ?ranef ) effects, but see also this thread on the lack of predict function in lme4 . You can also generate a sample from the posterior distribution using the mcmcsamp() function. Sometimes, it might clash, though. See the sig-me mailing list for more updated information.
