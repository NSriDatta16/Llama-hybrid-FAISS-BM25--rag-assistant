[site]: crossvalidated
[post_id]: 484448
[parent_id]: 
[tags]: 
Accounting for spatial structure in constrained ordination analysis (vegan)

I am looking to use ordination to test whether certain environmental measures influence the microbial community in soil samples. I am a bit confused about the correct way to define the model and restrict permutations when testing different hypotheses. The samples were collected in a blocked manner - 6 samples from each 20x10cm block, and 10 blocks within my 50x50m site. I have the measurements (in cm) between every sample, and about 15 environmental measures (various soil characteristics). I want to test whether 3 of the variables influence the community composition, and given the sampling design and the high variation in my environmental variables between samples, I though it would be interesting to test if there was an overall site effect (larger scale), and if there was an effect within blocks (smaller scale). So far I have tried using Canonical Correspondence Analysis and Adonis in the vegan package of R. To test for the within-block effect, I thought I should restrict permutations to samples within a block. I'll try to demonstrate with a similar example from the "dune" dataset data(dune) data(dune.env) perm But I am confused about how to test for an overall effect. If this was a normal regression model, I would include my "blocks" as a random effect, but I don't think random effects can be included in ordination models. When I've read about this, people have suggested including my blocks as "strata", but does this not just restrict permutations to within blocks, and so end up being exactly the same as my "within-block" test? I'm also confused about the best way to specify any restricted permutations. The following models all give different results, and I'm not sure which is correct: perm2 I'm also wondering whether I should try and partial out the geographic distances, as an alternative to including them as "random effects" or restricted permutations. Given that I can produce a Euclidean distance matrix between all my samples based on geographic distance, maybe I should use a Multiple regression on distance matrices (MRM) approach. e.g. library(ecodist) MRM(dist(dune) ~ dist(dune.env $A1)+dist(dune.env$ Moisture) + dist(geography)) I know you can partial out particular variables using CCA/Adonis, but can you can partial out a distance matrix?
