[site]: crossvalidated
[post_id]: 72573
[parent_id]: 
[tags]: 
When making inferences about group means, are credible Intervals sensitive to within-subject variance while confidence intervals are not?

This is a spin off of this question: How to compare two groups with multiple measurements for each individual with R? In the answers there (if I understood correctly) I learned that within-subject variance does not effect inferences made about group means and it is ok to simply take the averages of averages to calculate group mean, then calculate within-group variance and use that to perform significance tests. I would like to use a method where the larger the within subject variance the less sure I am about the group means or understand why it does not make sense to desire that. Here is a plot of the original data along with some simulated data that used the same subject means, but sampled the individual measurements for each subject from a normal distribution using those means and a small within-subject variance (sd=.1). As can be seen the group level confidence intervals (bottom row) are unaffected by this (at least the way I calculated them). I also used rjags to estimate the group means in three ways. 1) Use the raw original data 2) Use only the Subject means 3) Use the simulated data with small within-subject sd The results are below. Using this method we see that the 95% credible intervals are narrower in cases #2 and #3. This meets my intuition of what I would like to occur when making inferences about group means, but I am not sure if this is just some artifact of my model or a property of credible intervals. Note. To use rjags you need to first install JAGS from here: http://sourceforge.net/projects/mcmc-jags/files/ The various code is below. The original data: structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 2, 0, 16, 2, 16, 2, 8, 10, 8, 6, 4, 4, 8, 22, 12, 24, 16, 8, 24, 22, 6, 10, 10, 14, 8, 18, 8, 14, 8, 20, 6, 16, 6, 6, 16, 4, 2, 14, 12, 10, 4, 10, 10, 8, 4, 10, 16, 16, 2, 8, 4, 0, 0, 2, 16, 10, 16, 12, 14, 12, 8, 10, 12, 8, 14, 8, 12, 20, 8, 14, 2, 4, 8, 16, 10, 14, 8, 14, 12, 8, 14, 4, 8, 8, 10, 4, 8, 20, 8, 12, 12, 22, 14, 12, 26, 32, 22, 10, 16, 26, 20, 12, 16, 20, 18, 8, 10, 26), .Dim = c(108L, 3L), .Dimnames = list( NULL, c("Group", "Subject", "Value"))) Get subject Means and simulate the data with small within-subject variance: #Get Subject Means means The function to fit the JAGS model: require(rjags) #Jags fit function jags.fit Fit the model to each group of each dataset: #Fit to raw data groupA Credible interval/highest density interval function: #HDI Function get.HDI First Plot: layout(matrix(c(1,1,2,2,3,4),nrow=3,ncol=2, byrow=T)) boxplot(dat[,3]~dat[,2], xlab="Subject", ylab="Value", ylim=c(0, 1.2*max(dat[,3])), col=c(rep("Red",length(which(dat[,1]==unique(dat[,1])[1]))/6), rep("Green",length(which(dat[,1]==unique(dat[,1])[2]))/6), rep("Blue",length(which(dat[,1]==unique(dat[,1])[3]))/6) ), main="Original Data" ) stripchart(dat[,3]~dat[,2], vert=T, add=T, pch=16) legend("topleft", legend=c("Group A", "Group B", "Group C", "Individual Means +/- 95% CI"), col=c("Red","Green","Blue", "Grey"), lwd=3, bty="n", pch=c(15), pt.cex=c(rep(0.1,3),1), ncol=3) for(i in 1:length(unique(dat[,2]))){ m Second Plot: layout(matrix(c(1,2,3,4,4,4,5,5,5,6,6,6),nrow=4,ncol=3, byrow=T)) #Plot priors plot(seq(0,10,by=.01),dgamma(seq(0,10,by=.01),5,5), type="l", lwd=4, xlab="Value", ylab="Density", main="Prior on Within-Subject Precision" ) plot(seq(0,10,by=.01),dgamma(seq(0,10,by=.01),1,1), type="l", lwd=4, xlab="Value", ylab="Density", main="Prior on Within-Group Precision" ) plot(seq(0,300,by=.01),dnorm(seq(0,300,by=.01),10,100), type="l", lwd=4, xlab="Value", ylab="Density", main="Prior on Group Means" ) #Set overall xmax value x.max EDIT with my personal version of the answer from @St√©phaneLaurent I used the model he described to sample from a normal distribution with mean=0, between subject variance =1 and within subject error/variance= 0.1,1,10,100. A subset of the confidence intervals are shown in the left panels while the distribution of their widths is shown by the corresponding right panels. This has convinced me that he is 100% correct. However, I am still confused by my example above but will follow this up with a new more focused question. The code for the above simulation and charts: dev.new() par(mfrow=c(4,2)) num.sims muG } sub
