[site]: stackoverflow
[post_id]: 2634927
[parent_id]: 
[tags]: 
Scroll to anchor

I have the following userjs which is intended to remove anchor part of the URL but still jump to it: // ==UserScript== // @name PurgeAnchor // @include * // ==/UserScript== (function() { var reg=/^(.*)\#(.*)$/; var match=reg.exec(location); function ObjectPosition(obj) { var curtop = 0; if(obj.offsetParent) while(1) { curtop += obj.offsetTop; if(!obj.offsetParent) break; obj = obj.offsetParent; } else if(obj.y) curtop += obj.y; return curtop; } if(match) { document.location.replace(match[1]); sessionStorage.setItem("anchor", match[2]); } window.addEventListener("load", (function() { var anchor=sessionStorage.getItem("anchor"); if(anchor!==null) { var obj=document.anchors.item(anchor); // var obj=document.getElementById(anchor); // if(obj===null) { // obj=document.getElementsByName(anchor)[0]; // } var pos=0; if(obj!==null) { pos=ObjectPosition(obj); window.scrollTo(0, pos); } sessionStorage.removeItem("anchor"); } }), false); })() The problem is that if I have an empty tag with the name set, it fails to jump. obj.scrollIntoView() also fails. Opera-10.52_pre6306, Gentoo.
