[site]: stackoverflow
[post_id]: 2782519
[parent_id]: 1144894
[tags]: 
A month ago, I ran into this issue. At first I thought it was a corrupted cookie jar as I could clean out the cookies and go. However, it popped up again. This time I spent an hour going through it, watching what was sent, reviewing what safari sent back, and I found the problem. In this case, I had an array of cookie values being sent to the browser after login prior to the redirect. The values looked something like 'user id', 'user full name', 'some other id', etc. ( yes, the id's are encrypted so no worries there ) My user full name was actually in a , format. When safari was posting the cookie back to the server, everything after the comma after the lastname was dropped. It was only posting back values up to that point. When i removed the comma the rest of the values started working just fine. So it appears that if you send a cookie value that contains a comma, then safari doesn't properly escape that in it's internal storage. Which leads me to think that if they aren't properly escaping commas, then there are probably some security issues with safari's cookie handling code. Incidentally, this was tested on Win 7 x64 with safari 4.0.5. Also I put up a web page at: http://cookietest.livelyconsulting.com/ which shows this exact problem. (I removed that test site) IE, FF, and chrome all correctly set the cookie. safari does not.
