[site]: stackoverflow
[post_id]: 1519658
[parent_id]: 1519585
[tags]: 
There is a great library to manage ethernet. If You want go to low level stuff its certainly worth to learn. It's quite hard C API to learn. Lib PCAP. link to lib pcap sourceforge Some sample code: #include #include #include #include void find_eth_addr(struct in_addr *search_ip, const struct pcap_pkthdr* pkthdr, const u_char *packet) { struct ether_header *eth_hdr = (struct ether_header *)packet; if (ntohs(eth_hdr->ether_type) == ETHERTYPE_IP) { struct ip *ip_hdr = (struct ip *)(packet + sizeof(struct ether_header)); if (ip_hdr->ip_dst.s_addr == search_ip->s_addr) print_eth_addr(eth_hdr->ether_dhost); if (ip_hdr->ip_src.s_addr == search_ip->s_addr) print_eth_addr(eth_hdr->ether_shost); } } There's also nice "kernel functions wrapper" like library: DNET which provides great functionality to use it on low level networking. (also getting MAC addresses). DNET There are UNIX & win ports for both libraries.
