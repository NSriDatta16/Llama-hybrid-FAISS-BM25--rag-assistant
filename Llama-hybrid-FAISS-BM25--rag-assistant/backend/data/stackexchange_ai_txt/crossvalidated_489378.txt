[site]: crossvalidated
[post_id]: 489378
[parent_id]: 489353
[tags]: 
Your function BinariserDF is probably the problem. Since you're using it in a FunctionTransformer , it gets called separately for the training and test folds in the cross-validation, so the number of dummy variables may be different, and the model scoring fails. Instead, use SimpleImputer and ColumnTransformer with OneHotEncoder . (The encoding is also probably safe to do on the entire dataset, if you know what you're doing; but the imputation shouldn't be done on the entire set nor separately on the train and test sets as you do now.)
