[site]: stackoverflow
[post_id]: 2343896
[parent_id]: 2342321
[tags]: 
There is something broken with that store's registration/login. The activation email said to just login to activate the account. I've tried logging in multiple times but I get the error "This account is not activated." everytime I try to login. Below is a quick change that prints the returned login page. $url_to = 'http://fastorder.newrock.es/store2009/index.php/customer/account/loginPost/'; $url_from = 'http://fastorder.newrock.es/store2009/index.php/customer/account/login/'; $url_get = 'http://fastorder.newrock.es/store2009/index.php/'; $name_pass = 'login%5Busername%5D=*****&login%5Bpassword%5D=*****&send='; function login($link,$user,$from) { $fp = fopen("cookie.txt", "w"); fclose($fp); $log = curl_init(); curl_setopt($log, CURLOPT_REFERER, $from); curl_setopt($log, CURLOPT_URL, $link); curl_setopt($log, CURLOPT_COOKIEJAR, "cookie.txt"); curl_setopt($log, CURLOPT_COOKIEFILE, "cookie.txt"); curl_setopt($log, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2) Gecko/20100115 Firefox/3.6"); curl_setopt($log, CURLOPT_TIMEOUT, 40); curl_setopt($log, CURLOPT_RETURNTRANSFER, TRUE); curl_setopt($log, CURLOPT_HEADER, TRUE); curl_setopt($log, CURLOPT_FOLLOWLOCATION, TRUE); curl_setopt($log, CURLOPT_POST, TRUE); curl_setopt($log, CURLOPT_POSTFIELDS, $user); $data = curl_exec($log); curl_close($log); return $data; } echo login($url_to,$name_pass,$url_from); function get($url) { $get = curl_init(); curl_setopt($get, CURLOPT_RETURNTRANSFER, TRUE); curl_setopt($get, CURLOPT_COOKIEFILE, "cookie.txt"); curl_setopt($get, CURLOPT_URL, $url); return curl_exec ($get); curl_close ($get); } $html = get($url_get); echo $html; Edit: Is the cookies data is being written to the cookies file (cookie.txt)? If not... Check the file permissions, make sure its writable. A bug in earlier versions of php5 caused the cookies file option to be ignored. Details on the bug are here: http://bugs.php.net/bug.php?id=33475 Solution: Add unset($log) after curl_close($log); Its hard to debug this script w/o being able to test it.
