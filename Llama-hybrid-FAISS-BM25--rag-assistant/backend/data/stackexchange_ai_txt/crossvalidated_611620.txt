[site]: crossvalidated
[post_id]: 611620
[parent_id]: 459545
[tags]: 
There may be a mistake in the formula from @oszkar's answer. You can see this by modifying b from the example above. The code a yields [1] -3.4 [1] 2.9 [1] 0.2 [1] 1 [1] 0.2 [1] -3.1 [1] 0.6 It may not make sense to have a correlation outside of [-1, 1]. The ccf in R: ccf(a, b, 3, plot = F)$acf gives , , 1 [,1] [1,] -0.37777778 [2,] 0.32222222 [3,] 0.02222222 [4,] 0.11111111 [5,] 0.02222222 [6,] -0.34444444 [7,] 0.06666667 The form for $r_{ij}(t)$ used in R is actually $$r_{ij}(t)=\dfrac{c_{ij}(t)}{\sqrt{\sigma_i^2\sigma_j^2}}$$ where $$\sigma_i^2=\frac{1}{n} \sum_{s=1}^{n}\left[X_i(s)-\overline{X}_i\right]^2.$$ That is, the denominator is the square root of the product of the "population variance" of the two time series. With this formula you can see that the results below match with the results from ccf . a gives [1] -0.3777778 [1] 0.3222222 [1] 0.02222222 [1] 0.1111111 [1] 0.02222222 [1] -0.3444444 [1] 0.06666667
