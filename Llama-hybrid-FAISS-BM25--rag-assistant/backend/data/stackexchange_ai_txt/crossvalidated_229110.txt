[site]: crossvalidated
[post_id]: 229110
[parent_id]: 229106
[tags]: 
A linear transformation of the position variables is equivalent to the inverse linear transformation of the momentum variables. Ideally, you want to sample from a (transformed) distribution whose covariance matrix is the identity matrix, and this is obtained by the transformation indicated above. For details, there is a nice explanation in Neal's "MCMC using Hamiltonian dynamics", Chapter 5 of the Handbook of Markov Chain Monte Carlo , Section 4.1 ("Effect of linear transformations"). The chapter is available here . Neal explains: Suppose we have an estimate, $\Sigma$ , of the covariance matrix for $q$ , and suppose also that $q$ has at least a roughly Gaussian distribution. How can we use this information to improve the performance of HMC? One way is to transform the variables so that their covariance matrix is close to the identity, by finding the Cholesky decomposition, $\Sigma = LL^T$ , with $L$ being lower-triangular, and letting $q^\prime = L^{−1}q$ . [ $\ldots$ ] An equivalent way to make use of the estimated covariance $\Sigma$ is to keep the original $q$ variables, but use the kinetic energy function $K(p) = p^T \Sigma p/2$ — ie, we let the momentum variables have covariance $\Sigma^{−1}$ . The equivalence can be seen by transforming this kinetic energy to correspond to a transformation to $q^\prime = L^{−1} q$ (see equation (4.1)), which gives $K(p^\prime) = (p^\prime)^T{M^\prime}^{−1}p^\prime$ with $M^\prime = (L^{−1}(LL^T)(L^{−1})^T)^{−1} = I$ . To give some intuition, suppose that the target pdf is cigar-shaped pointing in one direction which is not axis-aligned. You can either rotate and rescale the space, so that the cigar becomes a ball, and then draw momenta from a unit multivariate normal, or equivalently you can keep the original space and draw your momenta so that they are aligned with the cigar (e.g., with most of the velocity along the major axis of the cigar, so that you can explore it quickly).
