[site]: stackoverflow
[post_id]: 1469955
[parent_id]: 1467898
[tags]: 
The Pig version would go something like this (untested): Data = LOAD '/my/data' using PigStorage() as (aa:int, bb:float, cc:chararray); grp = GROUP Data by aa; topK = FOREACH grp ( sorted = ORDER Data by bb DESC; lim = LIMIT sorted 5; GENERATE group as aa, lim; ) STORE topK INTO '/my/output' using PigStorage(); Pig isn't optimized for performance; it's goal is to enable processing of multi-terabyte datasets using parallel execution frameworks. It does have a local mode, so you can try it, but I doubt it will beat your script.
