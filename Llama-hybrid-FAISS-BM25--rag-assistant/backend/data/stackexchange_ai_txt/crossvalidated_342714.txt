[site]: crossvalidated
[post_id]: 342714
[parent_id]: 342713
[tags]: 
What you're doing, although theoretically valid, is not computationally stable. This is because although your estimator is a consistent estimator, for large $k$ there are very few samples available to estimate the lag covariance, leading to bad estimates of this value. There has been a rich study of estimating this variance term in the MCMC literature. There are estimators that weight and truncate the lag $k$, and these estimators are called spectral variance estimators. They have been shown to be strongly consistent estimators in same Flegal et.al (2010) paper, however, they are a tad bit slow to compute. There is also the faster batch means estimator, mentioned in the same paper as above. They have also been shown to be consistent (in the same paper). However, the above paper is only meant for univariate quantities, so these do not assess the covariance for a Markov chain from a multivariate distribution. You can find details of this covariance matrix in the post here . There has recently been work done in estimating the variance-covariance matrix for Markov chains from multivariate distributions. Extensions of the spectral variance estimators are in Vats et.al (2018) and extensions of the batch means estimator are in Vats et. al. (2017) . Note that for this multivariate setting the spectral variance estimators are often too computationally expensive. You can implement all these estimators using the R package mcmcse . This post has some more information about the implementation.
