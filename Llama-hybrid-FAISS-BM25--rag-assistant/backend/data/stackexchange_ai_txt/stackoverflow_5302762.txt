[site]: stackoverflow
[post_id]: 5302762
[parent_id]: 
[tags]: 
Problems in creating a webtest to test logins

I'm needing some help with a coded web test. I created a coded web test to see how many accounts are valid to log into my application. I have a lot of accounts (2000+) and I need to know which of them are valid. Basically, I recorded a web test that hits an URL and searches for some certain text that appears in the page after the login. Then I created an xml file containing all account names and passwords and set it as credentials data source. Then modified the testrun.testrunconfig to specify "one test per datasource row" to have the test run for every row in the xml file. After this, I converted the test to a "coded" web test. So far so good. The problem arises when I try to create a file (to programmatically add the successful logins in a file). I have a StreamWriter declared privately and try to initialize it in the test constructor, but this throws an error: "could not run webtest xxx on agent yyy: exception has been thrown by the target of an invocation". I tried to initialize the stream in the same line where it's declared, but I get the same results. Does anyone have any idea on how can I accomplish the desired test? I know that I can accomplish this without a coded web test, but to collect the successful login information I have to go line by line in the test result and see what are the ones that passed. If anyone has a better idea, it's very welcomed! Best regards Beto
