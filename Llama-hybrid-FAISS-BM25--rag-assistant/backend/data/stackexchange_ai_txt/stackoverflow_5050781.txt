[site]: stackoverflow
[post_id]: 5050781
[parent_id]: 
[tags]: 
MapReduce - how do I calculate relative values (average, top k and so)?

I'm looking for a way to calculate "global" or "relative" values during a MapReduce process - an average, sum, top etc. Say I have a list of workers, with their IDs associated with their salaries (and a bunch of other stuff). At some stage of the processing, I'd like to know who are the workers who earn the top 10% of salaries. For that I need some "global" view of the values, which I can't figure out. If I have all values sent into a single reducer, it has that global view, but then I loose concurrency, and it seems awkward. Is there a better way? (The framework I'd like to use is Google's, but I'm trying to figure out the technique - no framework specific tricks please)
