[site]: stackoverflow
[post_id]: 650810
[parent_id]: 650758
[tags]: 
To Location 1: SELECT DISTINCT organization_id FROM organization_locations ol WHERE ol.eff_date BETWEEN @date1 AND @date2 AND ol.location = 1 From Location 1: SELECT DISTINCT organization_id FROM ( SELECT organization_id, ( SELECT TOP 1 location_id FROM organization_locations oln WHERE oln.organization_id = ol.organization_id AND oln.eff_date Show previous location: SELECT ol.*, ( SELECT TOP 1 location_id FROM organization_locations oln WHERE oln.organization_id = ol.organization_id AND oln.eff_date Having a UNIQUE INDEX on (organization_id, eff_date) will help you a lot.
