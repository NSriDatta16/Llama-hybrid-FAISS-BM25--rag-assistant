[site]: stackoverflow
[post_id]: 1015595
[parent_id]: 
[tags]: 
Build dynamic menu using Nested Sets

I am trying to build a dynamic menu in my PHP CMS; the pages/categories are organized using the nested sets model. Full tree: root A B B1 B1.1 B1.2 B2 B2.1 B2.1 C C1 C2 C3 D I want to convert this result set to an unordererd list, which only displays a part of the tree. For example: If I click on B, I want to show only the following part of the list: A B B1 B2 C D Next, if I click on B1 I want the to show this list: A B B1 B1.1 B1.2 B2 C D etc. I use the following SQL query to get all nodes from the (mysql) database: SELECT node.id, node.lft, node.rgt, node.name, GROUP_CONCAT(parent.name ORDER BY parent.lft SEPARATOR "/" ) AS path, (COUNT(parent.lft) - 1) AS depth FROM pages AS node, pages AS parent WHERE node.lft BETWEEN parent.lft AND parent.rgt AND ( parent.hidden = "no" AND node.hidden = "no") AND parent.lft > 1 GROUP BY node.id ORDER BY node.lft I managed to create the full list without recursion (using the depth column), but I can't filter the menu like I have shown above; I think I need to get the parent's lft and rgt value for each node and filter out the elements using PHP. But how can I get these values in the same query? Are there any other suggestions on how to achieve this? Thanks in advance!
