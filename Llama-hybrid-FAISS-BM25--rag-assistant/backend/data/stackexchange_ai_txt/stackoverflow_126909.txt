[site]: stackoverflow
[post_id]: 126909
[parent_id]: 126855
[tags]: 
If I understand your question correctly, you should be able to get the average weight of all users based on their last visit from the following SQL statement. We use a subquery to get the last visit as a filter. SELECT avg(uv.weight) FROM (SELECT weight FROM uservisit uv INNER JOIN (SELECT userid, MAX(dateVisited) DateVisited FROM uservisit GROUP BY userid) us ON us.UserID = uv.UserId and us.DateVisited = uv.DateVisited I should point out that this does assume that there is a unique UserID that can be used to determine uniqueness. Also, if the DateVisited doesn't include a time but just a date, one patient who visits twice on the same day could skew the data.
