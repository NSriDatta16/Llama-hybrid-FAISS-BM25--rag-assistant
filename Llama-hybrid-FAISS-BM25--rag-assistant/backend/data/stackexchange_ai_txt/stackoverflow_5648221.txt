[site]: stackoverflow
[post_id]: 5648221
[parent_id]: 
[tags]: 
Fighting with SurfaceView, Camera and OpenGL

We've been fighting with some problems relating to SurfaceViews for more than a week, and find no proper solution to them. We read the other questions in the forum regarding to similar problems (and even Mixare source code) but couldn't find an answer, so we hope you could help us somehow. Scenario: We've got a SurfaceView for the Camera a SurfaceView for an OpenGL layer, which goes on top of the camera. another View, which shows some information about what we can see on the screen. This one goes on top of both SurfaceViews. Problem: No matter how hard we try, both SurfaceViews apparently don't get on well with each other. If we try to: setContentView(mCameraPreview); addContentView(mGLSurfaceView, new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); addContentView(mInfoView, new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); (which seems logical), everything goes as expected until we lock/unlock the phone. After that, the GLSurfaceView just disappears (not the InfoView, that one is still shown). If, instead, we try to: setContentView(mGLSurfaceView); addContentView(mCameraPreview, new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); addContentView(mInfoView, new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); Then the problem is that the GLSurfaceView only appears after lock/unlock, and before that the screen is showing the camera and the InfoView. We discovered that if we sleep the main thread for 4.6 seconds (or more) after executing onStart() in the activity that shows the views, the behaviour is as expected (both camera, glsurface and info views are shown, even after lock/unlock). The thing is, we're looking for a more... elegant solution. It seems to us that the problem is the camera taking more time than expected in Camera.open() , and so the camera View is added, the GLSurfaceView is added, and when the camera actually opens, it opens on top of the GLSurfaceView. Regarding to this, we used bringToFront() on GLSurfaceView, and got it on top of the info view, but after lock/unlock the camera still opened on top of it, leaving us with a screen with the camera preview only. Any ideas? How can we show both SurfaceViews and the info view on top of them?
