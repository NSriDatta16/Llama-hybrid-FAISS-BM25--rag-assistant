[site]: stackoverflow
[post_id]: 4519231
[parent_id]: 
[tags]: 
Using htmlunit try to login in a website, facing this kind error

Code /* * To change this template, choose Tools | Templates * and open the template in the editor. */ package qzone; import java.net.*; import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException; import com.gargoylesoftware.htmlunit.WebClient; import com.gargoylesoftware.htmlunit.html.*; import java.io.IOException; import java.util.logging.Level; import java.util.logging.Logger; /** * * @author wangyi */ public class Main { /** * @param args the command line arguments */ public static void main(String[] args) { Main main = new Main(); try { main.submittingForm(); } catch (Exception ex) { Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex); } } public void submittingForm() throws Exception { final WebClient webClient = new WebClient(); //webClient.setJavaScriptEnabled(false); // Get the first page final HtmlPage page1 = webClient.getPage("http://qzone.qq.com/"); // Get the form that we are dealing with and within that form, // find the submit button and the field that we want to change. final HtmlForm form = page1.getFormByName("loginform"); //final HtmlSubmitInput button = form.getInputByName("subbtn"); final HtmlSubmitInput button = page1.getHtmlElementById("subbtn"); final HtmlTextInput loginName = form.getInputByName("u"); final HtmlPasswordInput loginPs = form.getInputByName("p"); // Change the value of the text field loginName.setValueAttribute("525356734"); loginPs.setValueAttribute("5230911,.."); // Now submit the form by clicking the button and get back the second page. final HtmlPage page2 = button.click(); final String pageAsXml = page2.asText(); System.out.println(pageAsXml); //webClient.closeAllWindows(); } public void homePage() throws Exception { final WebClient webClient = new WebClient(); final HtmlPage page = webClient.getPage("http://htmlunit.sourceforge.net"); //massertEquals("HtmlUnit - Welcome to HtmlUnit", page.getTitleText()); final String pageAsXml = page.asXml(); //assertTrue(pageAsXml.contains(" ")); final String pageAsText = page.asText(); //assertTrue(pageAsText.contains("Support for the HTTP and HTTPS protocols")); //System.out.println(pageAsText); webClient.closeAllWindows(); } } Log Dec 23, 2010 9:05:31 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://imgcache.qq.com/ptlogin/ac/v7/js/login_div.js?v=1.2.1', but got 'application/x-javascript'. Dec 23, 2010 9:05:31 PM com.gargoylesoftware.htmlunit.javascript.host.ActiveXObject jsConstructor WARNING: Automation server can't create object for SSOAxCtrlForPTLogin.SSOForPTLogin2 Dec 23, 2010 9:05:31 PM com.gargoylesoftware.htmlunit.javascript.StrictErrorReporter runtimeError SEVERE: runtimeError: message=[Automation server can't create object] sourceName=[http://imgcache.qq.com/ptlogin/ac/v7/js/login_div.js?v=1.2.1] line=[1] lineSource=[null] lineOffset=[0] Dec 23, 2010 9:05:31 PM com.gargoylesoftware.htmlunit.html.HtmlScript isExecutionNeeded WARNING: Script is not JavaScript (type: text/html, language: ). Skipping execution. Dec 23, 2010 9:05:31 PM com.gargoylesoftware.htmlunit.html.HtmlScript isExecutionNeeded WARNING: Script is not JavaScript (type: text/html, language: ). Skipping execution. Dec 23, 2010 9:05:32 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://ptlogin2.qq.com/check?uin=525356734&appid=15000101&r=0.052038031951785135', but got 'application/x-javascript'. Dec 23, 2010 9:05:33 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://ptlogin2.qq.com/login?u=525356734&p=3DEA711A779CD7F24D771D1E568D5A94&verifycode=!NU7&=on&aid=15000101&u1=http%3A%2F%2Fimgcache.qq.com%2Fqzone%2Fv5%2Floginsucc.html%3Fpara%3Dizone&ptredirect=1&h=1&from_ui=1&dumy=&fp=loginerroralert', but got 'application/x-javascript'. Dec 23, 2010 9:05:33 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://imgcache.qq.com/ac/qzfl/appclientlib.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:35 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:37 PM com.gargoylesoftware.htmlunit.javascript.host.html.HTMLDocument jsxFunction_getElementById WARNING: getElementById(script1293109537081) did a getElementByName for Internet Explorer Dec 23, 2010 9:05:37 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/ac/qzone/v5/G/common/global/global_B419b419_b.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:38 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/ac/qzone/v5/G/common/interface/interface_B419b419_b.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:38 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/ac/qzone/v5/G/common/shop/shop_B206b207.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:39 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/ac/qzone/v5/ofp/ofp_B206b207.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:39 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/qzone/v5/statistic.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:40 PM com.gargoylesoftware.htmlunit.javascript.host.html.HTMLDocument jsxFunction_getElementById WARNING: getElementById(script1293109540568) did a getElementByName for Internet Explorer Dec 23, 2010 9:05:40 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzs.qq.com/ac/qzfl/appclientlib.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:40 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/qzone/v5/owner2/ic/IC_Core_v2.0.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:41 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/qzone/v5/owner2/ic/IC_Extend_v2.0.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:41 PM com.gargoylesoftware.htmlunit.IncorrectnessListenerImpl notify WARNING: Expected content type of 'application/javascript' or 'application/ecmascript' for remotely loaded JavaScript element at 'http://cnc.qzonestyle.gtimg.cn/qzone/v5/owner2/ic/ic_trigger_ex.js', but got 'application/x-javascript'. Dec 23, 2010 9:05:42 PM qzone.Main main Exception SEVERE: null net.sourceforge.htmlunit.corejs.javascript.WrappedException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot find function createElement in object [object]. (http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js#331) at net.sourceforge.htmlunit.corejs.javascript.Context.throwAsScriptRuntimeEx(Context.java:1797) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.doProcessPostponedActions(JavaScriptEngine.java:649) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.processPostponedActions(JavaScriptEngine.java:705) at com.gargoylesoftware.htmlunit.html.HtmlElement.click(HtmlElement.java:1265) at com.gargoylesoftware.htmlunit.html.HtmlElement.click(HtmlElement.java:1214) at com.gargoylesoftware.htmlunit.html.HtmlElement.click(HtmlElement.java:1177) at qzone.Main.submittingForm(Main.java:54) at qzone.Main.main(Main.java:27) Caused by: com.gargoylesoftware.htmlunit.ScriptException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot find function createElement in object [object]. (http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js#331) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:601) at net.sourceforge.htmlunit.corejs.javascript.Context.call(Context.java:537) at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.call(ContextFactory.java:538) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:499) at com.gargoylesoftware.htmlunit.html.HtmlPage.loadExternalJavaScriptFile(HtmlPage.java:970) at com.gargoylesoftware.htmlunit.html.HtmlScript.executeScriptIfNeeded(HtmlScript.java:363) at com.gargoylesoftware.htmlunit.html.HtmlScript$1.execute(HtmlScript.java:225) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.doProcessPostponedActions(JavaScriptEngine.java:644) ... 6 more Caused by: com.gargoylesoftware.htmlunit.ScriptException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot find function createElement in object [object]. (http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js#331) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:601) at net.sourceforge.htmlunit.corejs.javascript.Context.call(Context.java:537) at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.call(ContextFactory.java:538) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:499) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:474) at com.gargoylesoftware.htmlunit.html.HtmlPage.executeJavaScriptIfPossible(HtmlPage.java:880) at com.gargoylesoftware.htmlunit.html.HtmlScript.executeInlineScriptIfNeeded(HtmlScript.java:312) at com.gargoylesoftware.htmlunit.html.HtmlScript.executeScriptIfNeeded(HtmlScript.java:379) at com.gargoylesoftware.htmlunit.html.HtmlScript$1.execute(HtmlScript.java:225) at com.gargoylesoftware.htmlunit.html.HtmlScript.onAllChildrenAddedToPage(HtmlScript.java:245) at com.gargoylesoftware.htmlunit.html.HTMLParser$HtmlUnitDOMBuilder.endElement(HTMLParser.java:578) at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source) at com.gargoylesoftware.htmlunit.html.HTMLParser$HtmlUnitDOMBuilder.endElement(HTMLParser.java:536) at org.cyberneko.html.HTMLTagBalancer.callEndElement(HTMLTagBalancer.java:1136) at org.cyberneko.html.HTMLTagBalancer.endElement(HTMLTagBalancer.java:1038) at org.cyberneko.html.filters.DefaultFilter.endElement(DefaultFilter.java:206) at org.cyberneko.html.filters.NamespaceBinder.endElement(NamespaceBinder.java:329) at org.cyberneko.html.HTMLScanner$ContentScanner.scanEndElement(HTMLScanner.java:2999) at org.cyberneko.html.HTMLScanner$ContentScanner.scan(HTMLScanner.java:1991) at org.cyberneko.html.HTMLScanner.scanDocument(HTMLScanner.java:895) at org.cyberneko.html.HTMLConfiguration.parse(HTMLConfiguration.java:499) at org.cyberneko.html.HTMLConfiguration.parse(HTMLConfiguration.java:452) at org.apache.xerces.parsers.XMLParser.parse(Unknown Source) at com.gargoylesoftware.htmlunit.html.HTMLParser$HtmlUnitDOMBuilder.parse(HTMLParser.java:765) at com.gargoylesoftware.htmlunit.html.HTMLParser.parse(HTMLParser.java:211) at com.gargoylesoftware.htmlunit.html.HTMLParser.parseHtml(HTMLParser.java:165) at com.gargoylesoftware.htmlunit.DefaultPageCreator.createHtmlPage(DefaultPageCreator.java:225) at com.gargoylesoftware.htmlunit.DefaultPageCreator.createPage(DefaultPageCreator.java:108) at com.gargoylesoftware.htmlunit.WebClient.loadWebResponseInto(WebClient.java:429) at com.gargoylesoftware.htmlunit.WebClient.loadDownloadedResponses(WebClient.java:2127) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.doProcessPostponedActions(JavaScriptEngine.java:627) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.access$400(JavaScriptEngine.java:78) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:596) ... 13 more Caused by: com.gargoylesoftware.htmlunit.ScriptException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot find function createElement in object [object]. (http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js#331) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:601) at net.sourceforge.htmlunit.corejs.javascript.Context.call(Context.java:537) at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.call(ContextFactory.java:538) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:499) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:474) at com.gargoylesoftware.htmlunit.html.HtmlPage.executeJavaScriptIfPossible(HtmlPage.java:880) at com.gargoylesoftware.htmlunit.html.HtmlScript.executeInlineScriptIfNeeded(HtmlScript.java:312) at com.gargoylesoftware.htmlunit.html.HtmlScript.executeScriptIfNeeded(HtmlScript.java:379) at com.gargoylesoftware.htmlunit.html.HtmlScript$1.execute(HtmlScript.java:225) at com.gargoylesoftware.htmlunit.html.HtmlScript.onAllChildrenAddedToPage(HtmlScript.java:245) at com.gargoylesoftware.htmlunit.html.HTMLParser$HtmlUnitDOMBuilder.endElement(HTMLParser.java:578) at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source) at com.gargoylesoftware.htmlunit.html.HTMLParser$HtmlUnitDOMBuilder.endElement(HTMLParser.java:536) at org.cyberneko.html.HTMLTagBalancer.callEndElement(HTMLTagBalancer.java:1136) at org.cyberneko.html.HTMLTagBalancer.endElement(HTMLTagBalancer.java:1038) at org.cyberneko.html.filters.DefaultFilter.endElement(DefaultFilter.java:206) at org.cyberneko.html.filters.NamespaceBinder.endElement(NamespaceBinder.java:329) at org.cyberneko.html.HTMLScanner$ContentScanner.scanEndElement(HTMLScanner.java:2999) at org.cyberneko.html.HTMLScanner$ContentScanner.scan(HTMLScanner.java:1991) at org.cyberneko.html.HTMLScanner.scanDocument(HTMLScanner.java:895) at org.cyberneko.html.HTMLConfiguration.parse(HTMLConfiguration.java:499) at org.cyberneko.html.HTMLConfiguration.parse(HTMLConfiguration.java:452) at org.apache.xerces.parsers.XMLParser.parse(Unknown Source) at com.gargoylesoftware.htmlunit.html.HTMLParser$HtmlUnitDOMBuilder.parse(HTMLParser.java:765) at com.gargoylesoftware.htmlunit.html.HTMLParser.parse(HTMLParser.java:211) at com.gargoylesoftware.htmlunit.html.HTMLParser.parseHtml(HTMLParser.java:165) at com.gargoylesoftware.htmlunit.DefaultPageCreator.createHtmlPage(DefaultPageCreator.java:225) at com.gargoylesoftware.htmlunit.DefaultPageCreator.createPage(DefaultPageCreator.java:108) at com.gargoylesoftware.htmlunit.WebClient.loadWebResponseInto(WebClient.java:429) at com.gargoylesoftware.htmlunit.WebClient.getPage(WebClient.java:307) at com.gargoylesoftware.htmlunit.html.BaseFrame.loadInnerPageIfPossible(BaseFrame.java:141) at com.gargoylesoftware.htmlunit.html.BaseFrame.loadInnerPage(BaseFrame.java:100) at com.gargoylesoftware.htmlunit.html.HtmlPage.loadFrames(HtmlPage.java:1763) at com.gargoylesoftware.htmlunit.html.HtmlPage.initialize(HtmlPage.java:204) at com.gargoylesoftware.htmlunit.WebClient.loadWebResponseInto(WebClient.java:436) at com.gargoylesoftware.htmlunit.WebClient.loadDownloadedResponses(WebClient.java:2127) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.doProcessPostponedActions(JavaScriptEngine.java:627) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.access$400(JavaScriptEngine.java:78) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:596) ... 45 more Caused by: net.sourceforge.htmlunit.corejs.javascript.WrappedException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot find function createElement in object [object]. (http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js#331) at net.sourceforge.htmlunit.corejs.javascript.Context.throwAsScriptRuntimeEx(Context.java:1797) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.doProcessPostponedActions(JavaScriptEngine.java:649) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.access$400(JavaScriptEngine.java:78) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:596) ... 83 more Caused by: com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot find function createElement in object [object]. (http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js#331) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:601) at net.sourceforge.htmlunit.corejs.javascript.Context.call(Context.java:537) at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.call(ContextFactory.java:538) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:499) at com.gargoylesoftware.htmlunit.html.HtmlPage.loadExternalJavaScriptFile(HtmlPage.java:970) at com.gargoylesoftware.htmlunit.html.HtmlScript.executeScriptIfNeeded(HtmlScript.java:363) at com.gargoylesoftware.htmlunit.html.HtmlScript$1.execute(HtmlScript.java:225) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.doProcessPostponedActions(JavaScriptEngine.java:644) ... 85 more Caused by: net.sourceforge.htmlunit.corejs.javascript.EcmaError: TypeError: Cannot find function createElement in object [object]. (http://cnc.qzs.qq.com/ac/qzone/qzfl/qzfl_2.0.9.0.js#331) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3772) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3750) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.typeError(ScriptRuntime.java:3778) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.typeError2(ScriptRuntime.java:3797) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.notFunctionError(ScriptRuntime.java:3861) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.getPropFunctionAndThisHelper(ScriptRuntime.java:2346) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.getPropFunctionAndThis(ScriptRuntime.java:2313) at net.sourceforge.htmlunit.corejs.javascript.Interpreter.interpretLoop(Interpreter.java:1515) at net.sourceforge.htmlunit.corejs.javascript.Interpreter.interpret(Interpreter.java:845) at net.sourceforge.htmlunit.corejs.javascript.InterpretedFunction.call(InterpretedFunction.java:164) at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.doTopCall(ContextFactory.java:429) at com.gargoylesoftware.htmlunit.javascript.HtmlUnitContextFactory.doTopCall(HtmlUnitContextFactory.java:269) at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:3162) at net.sourceforge.htmlunit.corejs.javascript.InterpretedFunction.exec(InterpretedFunction.java:175) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$3.doRun(JavaScriptEngine.java:490) at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:595) ... 92 more BUILD SUCCESSFUL
