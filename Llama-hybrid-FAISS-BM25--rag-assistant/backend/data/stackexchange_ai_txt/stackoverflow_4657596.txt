[site]: stackoverflow
[post_id]: 4657596
[parent_id]: 4295335
[tags]: 
You can't find all bots this way, but you could catch some, or at least get some probability of UA being a bot and use that with conjunction with another method. Some bots forget about Accept-Charset and Accept-Encoding headers. You may also find impossible combinations of Accept and User-Agent (e.g. IE6 won't ask for XHTML, Firefox doesn't advertise MS Office types). When blocking, be careful about proxies, because they could modify the headers. I recommend backing off if you see Via or X-Forwarded-For headers. Ideally, instead of writing rules manually, you could use bayesian classifier. It could be as simple as joining relevant headers together and using them as a single "word" in the classifier.
