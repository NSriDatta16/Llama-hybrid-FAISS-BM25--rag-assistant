[site]: stackoverflow
[post_id]: 2130066
[parent_id]: 
[tags]: 
SP takes forever to run in SSIS

This is my first question so bear with me, i will also attempt to answer one somewhere if i can as payment, though not sure my skills are up to it yet. I have a stored procedure in SQL 2008 that at the moment executes with a result of about 600 odd rows, it has unions within it and a user defined function used multiple times. Nothing outrageous. Query completes in 7 seconds via a query window in the Management studio. Within BIDS, writing a SSIS i use the same SP as an OLEDB source as part of a Data flow. The result set is output to Excel. That same query hangs within the Pre-execute phas for 40 odd minutes before completing. I have tried re-creating the same data flow incase there was some strange quirk, i have tried replacing the UDF within the query to see if that was the problem but to no avail. Does anyone have any ideas what the problem maybe or what i might do to further some investigation. Kind regards, Matt H
