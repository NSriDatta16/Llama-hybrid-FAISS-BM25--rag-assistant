[site]: stackoverflow
[post_id]: 5645454
[parent_id]: 
[tags]: 
weighted mean with integers

The situation: we have an integer based microcontroller and we need to calculate weighted mean (for example, weight 32, like 31-1), and store it in an array. The the final code will be in C. (And just to be sure, this is not a homework :) ) We were thinking to store the result of modulus division with the weight on the result (the avg calc) and use it in the next round as additional data. If we had float, it would be like this: avg[i] = ( avg[i-1] * (WEIGHT-1) + measured ) / WEIGHT; Since we don't, I was thinking this: pt = (mod == 0) ? WEIGHT-1 : WEIGHT-2; tmp = avg[i-1] * pt + mod + measured; avg[i] = tmp / WEIGHT; mod = tmp % WEIGHT; But this seem to give me false results, and I'm really stuck with the implementation. Anyone, with some ideas? EDIT Thank you very much for the fast responses, although I may have not asked the question clear enough: we have a factor of the needed weight from the previous average and the current sample.
