[site]: stackoverflow
[post_id]: 572748
[parent_id]: 564608
[tags]: 
What you can do is set up your "perfect" trace and script it out as SQL. Then execute it to run the trace and save output to a file or table. Now, you could wrap the SQL to create the trace in another stored proc that can be run via SQL Agent/idle threshold, but use fn_trace_getinfo to see if one if running already. You can not automate it in SSMS or use an environment variable: the code, the job, the alerts etc all must exist on the server. You can put the scripted trace into a batch file and run it via osql/sqlcmd but it has to be invoked manually. There is no profiler API: all it does is run stored procs, just like any solution will have to. Why can't you add monitoring SQL code hat is independant of the app code? You can't use SMO either ... only to read traces Edit: a trace always requires SQL to be run against the server
