[site]: stackoverflow
[post_id]: 3508239
[parent_id]: 
[tags]: 
WIX 3.5 fails under NAnt but not under VS2010

I know this a is a common issue, but everything I can find in the forums seems to relate to 64bit framework incompatability (which is not an issue in my case). I have a set of simple WIX 3.5 installers developed using Votive that I can compile happily in VS2010, but when I try to compile them via NAnt (and MSBuild) on TeamCity (i.e. TeamCity -> Nant -> MSBuild -> WIX) I get the following error: [exec] Project file contains ToolsVersion="4.0", which is not supported by this version of MSBuild. Treating the project as if it had ToolsVersion="3.5". [exec] Compile: [exec] Microsoft (R) Windows Installer Xml Compiler version 3.5.2006.0 [exec] Copyright (C) Microsoft Corporation. All rights reserved. [exec] [exec] Product.wxs [exec] Product.Generated.wxs [exec] Link: [exec] Microsoft (R) Windows Installer Xml Linker version 3.5.2006.0 [exec] Copyright (C) Microsoft Corporation. All rights reserved. [exec] [exec] light.exe : error LGHT0001: Unable to load DLL 'winterop.dll': The specified module could not be found. (Exception from HRESULT: 0x8007007E) [exec] [exec] Exception Type: System.DllNotFoundException [exec] [exec] Stack Trace: [exec] at Microsoft.Tools.WindowsInstallerXml.Cab.Interop.NativeMethods.ExtractCabBegin() [exec] at Microsoft.Tools.WindowsInstallerXml.Binder.BindDatabase(Output output, String databaseFile) [exec] at Microsoft.Tools.WindowsInstallerXml.Binder.Bind(Output output, String file) [exec] at Microsoft.Tools.WindowsInstallerXml.Tools.Light.Run(String[] args) [exec] Done Building Project "c:\dev2\ad3\utilities\Installers\Database\Database.wixproj" (default targets) -- FAILED. [exec] Done Building Project "c:\dev2\ad3\AgentDesktop3.1.sln" (default targets) -- FAILED. [exec] [exec] Build FAILED. [exec] [exec] "c:\dev2\ad3\AgentDesktop3.1.sln" (default target) (1) -> [exec] "c:\dev2\ad3\utilities\InstallerService\InstallerService.csproj" (default target) (5) -> [exec] (ResolveAssemblyReferences target) -> [exec] C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets : warning MSB3088: Could not read state file "obj\Release\ResolveAssemblyReference.cache". Unable to find assembly 'Microsoft.Build.Tasks.v4.0, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. [exec] [exec] [exec] "c:\dev2\ad3\AgentDesktop3.1.sln" (default target) (1) -> [exec] "c:\dev2\ad3\utilities\Installers\Database\Database.wixproj" (default target) (6) -> [exec] (Link target) -> [exec] light.exe : error LGHT0001: Unable to load DLL 'winterop.dll': The specified module could not be found. (Exception from HRESULT: 0x8007007E) [exec] [exec] 1 Warning(s) [exec] 1 Error(s) [exec] [exec] Time Elapsed 00:00:05.92 BUILD FAILED Any ideas?
