[site]: stackoverflow
[post_id]: 5157770
[parent_id]: 
[tags]: 
What is removing my headers in PHP/Apache2?

I'm using PHP 5.3 and Apache 2.0 to serve a script which adds a number of headers to the output: header('HTTP/1.1 200 OK'); header("Content-Type: application/json"); header("Last-Modified: $lastmode"); // $lastmod = Tue, 01 Mar 2011 14:56:22 +0000 header("Etag: $etag"); // Etag = 5da02274fcad09a55f4d74467f66a864 Now, all the headers come through except for the Last-Modified and Etag . In my httpd.conf I have the following: Header unset Cache-Control Header unset Pragma But in my response I get: HTTP/1.1 200 OK Date: Tue, 01 Mar 2011 16:49:10 GMT Server: Apache/2.2.14 (EL) mod_ssl/2.2.14 OpenSSL/0.9.8e-fips-rhel5 Keep-Alive: timeout=15, max=8000 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: application/json Expires: 0 Cache-Control: no-cache My Last-Modified and Etag headers are gone and we have Cache-Control and Expires in their place. I should also mention that I have disabled mod_expires to no avail. I am pulling my hair out at this point as no matter what I do the headers are simply not there. What could possibly cause them to be removed? Thanks, J UPDATE: It seems that Apache is adding the additional headers after PHP has shutdown and I would think it's also removing the headers I set above. Registering a shutdown function in PHP and calling apache_response_headers shows: Pragma= Expires= Etag=5da02274fcad09a55f4d74467f66a864 Last-Modified=Tue, 01 Mar 2011 14:56:22 +0000 Keep-Alive=timeout=15, max=8000 Connection=Keep-Alive Transfer-Encoding=chunked Content-Type=application/json
