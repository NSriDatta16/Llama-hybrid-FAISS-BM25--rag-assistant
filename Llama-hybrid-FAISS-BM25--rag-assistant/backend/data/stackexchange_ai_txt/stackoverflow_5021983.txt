[site]: stackoverflow
[post_id]: 5021983
[parent_id]: 
[tags]: 
Extend Open (COBOL)

I recently got an assignment to use the "EXTEND OPEN" command to add data to an already existing file. While I thought I understood what it did I find that my program is hitting a snag, giving me this error: "148 Wrong open mode or access mode for write". It is a simple program, meant to only add one new file of entries to a master file, but I can't quite get it. Here is what I have: DATA DIVISION. FILE SECTION. FD OLD-MASTER-IN. 01 OLD-MASTER-REC-IN. 05 O-STATE-ABREV-IN PIC XX. 05 PIC X. 05 O-STATE-NAME-IN PIC X(17). FD TRANS-FILE-IN. 01 TRANS-REC-IN. 05 N-STATE-ABREV-IN PIC XX. 05 PIC X. 05 N-STATE-NAME-IN PIC X(17). WORKING-STORAGE SECTION. 01 ARE-THERE-MORE-RECORDS PIC X(3) VALUE 'YES'. PROCEDURE DIVISION. 100-MAIN. OPEN INPUT OLD-MASTER-IN EXTEND TRANS-FILE-IN PERFORM UNTIL ARE-THERE-MORE-RECORDS = 'NO ' READ OLD-MASTER-IN AT END MOVE 'NO' TO ARE-THERE-MORE-RECORDS NOT AT END PERFORM 200-REGULAR-UPDATE END-READ END-PERFORM CLOSE OLD-MASTER-IN TRANS-FILE-IN STOP RUN. 200-REGULAR-UPDATE. WRITE OLD-MASTER-REC-IN FROM TRANS-REC-IN. Any Help will be appreciated.
