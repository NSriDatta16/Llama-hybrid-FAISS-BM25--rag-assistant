[site]: stackoverflow
[post_id]: 1981414
[parent_id]: 
[tags]: 
asp.net windows authentication to sql server

I can not seem to get sql server to recognize my credentials. Asp.net recognizes me when I login but when I execute a sql command I get a login failed message. The IIS server and SQL server are on different machines. There are other applications the IIS server which are able to authenticate to the sql server. I believe the Active Directory settings are correct. I am investigating what I am doing differently. I must be missing something. I check the IIS settings The web config is set to impersonate. Below is the relevant information. If anyone has any idea as to what I missed or am doing wrong I would appreciate some help. IIS Settings: 'Integrated Windows authentication' is checked 'Enable anonymous access" is not checked Web Config Page_Load Code: Dim winId As IIdentity = HttpContext.Current.User.Identity TextBoxMessage.Text = winId.Name + Environment.NewLine Dim cnn As SqlClient.SqlConnection Try Dim sql As String = "*****" cnn = New SqlClient.SqlConnection("Data Source=*****;Initial Catalog=****;Integrated Security=True") cnn.Open() Dim cmd As New SqlClient.SqlCommand(sql, cnn) cmd.ExecuteNonQuery() cnn.Close() Catch ex As Exception TextBoxMessage.Text += ex.Message cnn.Close() End Try Output: Domain\UserName Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'.
