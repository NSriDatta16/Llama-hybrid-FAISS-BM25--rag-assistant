[site]: stackoverflow
[post_id]: 3196008
[parent_id]: 3195734
[tags]: 
This isn't elegant or well documented. It creates a System.Diagnostic.Process object and performs some common initializations on it. Once you get the Process object, you can perform additional adjustments on it, then call Process.Start to start the process. function New-Process($cmd, $arguments, [switch]$stdout, [switch]$stdin, [switch]$stderr, [switch]$shellexec, [switch]$showwindow) { $process = New-Object "System.Diagnostics.Process" $startinfo = New-Object "System.Diagnostics.ProcessStartInfo" $startinfo.FileName = $cmd $startinfo.Arguments = $arguments $startinfo.WorkingDirectory = $pwd.Path $startinfo.UseShellExecute = $shellexec $startinfo.RedirectStandardInput = $stdin $startinfo.RedirectStandardOutput = $stdout $startinfo.RedirectStandardError = $stderr if (!$showwindow) { $startinfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden } $process.StartInfo = $startinfo return $process }
