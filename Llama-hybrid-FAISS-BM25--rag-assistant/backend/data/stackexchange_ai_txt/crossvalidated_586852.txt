[site]: crossvalidated
[post_id]: 586852
[parent_id]: 
[tags]: 
Should I correct for batch effect before selecting features using random forest for RNA-Seq data?

This is a mix of bioinformatics and ML problem. Hope someone with both expertise can help. Please forgive me if it's unclear or I used the wrong words as I am very new to ML. I am trying to pick out some important features (genes) in a RNA-Seq data set of 37 samples to predict the outcome of the disease. The outcome is binary. And before I ran anything, I used removeBatchEffect() from limma on a normalised matrix from vst() , because there are two batches in it. The outcome variable is balanced in the two batches. LASSO failed with coefficients all being 0. Hence I am planning to try random forest (RFE or Boruta) and treeSHAP to interpret the result. I have a few questions before I move on and hope you can provide some insight: If I want to build a model based on gene expression using random forest, and apply it to other cohort as well, should I perform batch effect correction? In case I have built a random forest model, can I get interpretation from random forest nodes like those in decision trees? e.g. you can reach the outcome 1 via a clear path of high feature A value followed by high feature B value, or low feature A value followed by high feature C value. Then you know the interaction of A, B and C is important. With my limited knowledge, I think tree-based ML can lead to one class through more than one path? Please correct me if I am wrong. Edited: I thought about the experiment again and read the comments. I have deleted and modified some questions to make it more specific.
