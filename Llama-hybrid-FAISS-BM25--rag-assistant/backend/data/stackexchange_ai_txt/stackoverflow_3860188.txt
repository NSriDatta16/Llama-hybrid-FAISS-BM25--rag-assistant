[site]: stackoverflow
[post_id]: 3860188
[parent_id]: 3860134
[tags]: 
Using fold and intersectWith on the maps is a bit more elegant (and probably faster): combi :: M.Map Int Float -> M.Map Int Float -> Float combi x y = M.fold (+) 0 $ M.intersectionWith (*) x y combi sparse1 sparse2 returns 414.0 as desired. And if you care about performance, try using Data.IntMap : it should be several times faster than Data.Map here.
