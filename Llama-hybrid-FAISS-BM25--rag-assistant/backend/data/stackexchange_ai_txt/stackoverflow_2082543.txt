[site]: stackoverflow
[post_id]: 2082543
[parent_id]: 
[tags]: 
C# Drag&Drop Move of Items in Current ListView

1) How do you move items in a ListView using Drag&Drop? I have implemented D&D copy for files dragged from a directory. 2) BTW, how do you get a directory link by D&D to ListView, I've seen applications that get the directory path by D&D from address bar of Windows Explorer. private void lvwFiles_DragEnter(object sender, DragEventArgs e) { if (e.Data.GetDataPresent(DataFormats.FileDrop)) e.Effect = DragDropEffects.Copy; else e.Effect = DragDropEffects.None; } private void lvwFiles_DragDrop(object sender, DragEventArgs e) { if (e.Data.GetDataPresent(DataFormats.FileDrop)) { var paths = (string[])e.Data.GetData(DataFormats.FileDrop); var path = Path.GetDirectoryName(paths[0]); paths = Media.FilterPaths(paths); lvwFilesAdd(path, paths); lvwFilesWrite(); } } Found this @ Microsoft (VS2005; http://support.microsoft.com/kb/822483 ), I'm trying to make sense of this code and make it work in my program. I'll see how to separate this from the code already in the DragEnter & DragDrop event handlers. //lvwFiles_ItemDrag event handler // //Begins a drag-and-drop operation in the ListView control. lvwFiles.DoDragDrop(lvwFiles.SelectedItems, DragDropEffects.Move); //lvwFiles_DragEnter event handler // int len=e.Data.GetFormats().Length-1 ; int i; for (i = 0 ; i
