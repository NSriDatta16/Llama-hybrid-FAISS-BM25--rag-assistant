[site]: stackoverflow
[post_id]: 5138610
[parent_id]: 
[tags]: 
OSX: Undefined symbols in C when said symbols exist

Something odd is happening. I have a static library, in C, compiled using CMake. I link against to build an executable fine on Ubuntu, but under Snow Leopard I get an undefined symbol error when I attempt to do this: per-ms006:mbuild douglasl$ make Linking C executable Sample Undefined symbols: "_na_Gfx_Impl", referenced from: _na_impl_render in libdesktop.a(impl.c.o) ld: symbol(s) not found collect2: ld returned 1 exit status make[2]: *** [Sample] Error 1 make[1]: *** [CMakeFiles/Sample.dir/all] Error 2 make: *** [all] Error 2 This is mysterious to me, because nm on the static library shows: ... (pile of stuff omitted) ... libdesktop.a(impl.c.o): 0000000000003a30 s EH_frame1 0000000000003990 s LC0 00000000000039a0 s LC1 00000000000039ac s LC2 00000000000039d0 s LC3 00000000000039f0 s LC4 00000000000039fc s LC5 0000000000003a0c s LC6 0000000000003a1b s LC7 0000000000003a2a s LC8 U _SDL_PollEvent U _free U _malloc U _na_Gfx_Impl na_Gfx_Impl is unremarkable, its just a struct; and, just to repeat, this code compiles fine on my ubuntu system. I don't know enough about osx library linking to know what's wrong here, but... it's just a fragment of c code; surely this is me doing something wrong, rather than something weird with OSX. help! :) Edit: For reference, the struct is defined: /** Implementation struct. */ struct na_Gfx_Impl { /** Parent. */ struct na_Gfx *gfx; /** SDL surface for rendering. */ SDL_Surface *screen; /** Handler for sprites. */ struct na_utils_SetHandler *key; /** Set of texture values. */ GLfloat *texture; /** Set of vextex values. */ GLfloat *vertex; }; and used: /** Render implementation. */ int na_impl_render(struct na_Api *api) { struct na_Gfx_Impl *impl = (struct na_Gfx_Impl *) (api->gfx->impl); ... However, I conclude something must be screwed up badly. There is no reason (as I understand it) for the struct symbol to turn up in the static lib.
