[site]: crossvalidated
[post_id]: 422371
[parent_id]: 
[tags]: 
Is there a extension of PCA for when input variables have a repeating or nested structure?

Is there an analysis technique similar to principal component analysis, but which respects the repeated/tiled nature of the input factors? An illustrative (but somewhat contrived) example might be in order: Imagine a business which has hourly sales data (total revenue and item sales quantities) from a large number of stores over the period of several years. They wish to use an analysis technique to extract repeated trends in the data. A simple approach would be to use PCA on the data, with stores as one matrix axis and all the individual sales data points as the other. This would result in components and loadings for each store. However, while it would extract commonalities between stores, the components would tread each hour's data individually, and there would be no extraction of the yearly, weekly, or daily trends in the data. Another approach might be averaging by year/week/day, and doing PCA on the collapsed matrices, but it seems to me that doing so would start mixing the yearly effects with the weekly ones, weekly with the daily, etc. (Such that a Friday afternoon sales bump might not be extracted.) Ideally, there would be a method which can decompose the full set of multi-year data for each store into multiple levels of components (daily, weekly, yearly and whole-set) each with their own loadings, such that the full data set is a linear combination of the daily, weekly, yearly and whole-set components and loadings. That is, just as PCA finds the matrices $C$ and $L$ for which $X = L*C$ , where $C$ is a matrix of orthogonal and uncorrelated components, I'm looking for something which finds something like $$X = L_t*C_t + B_y*L_y*C_y + B_w*L_w*C_w + B_d*L_d*C_d$$ where the subscripts represent the repeated yearly, weekly, and daily trends (or total set residuals), the $B_x$ are "broadcasting" matrices which tile the results appropriately to upscale the dimensions of the matrix, and the $C_x$ components have a similar sense of being "minimal" as the PCA ones do. (Note that I wouldn't need exactly this formulation, but just something similar to it.) I realize this likely overdetermines the system, but I presume that if there's an existing technique which does this, it would likely include a regularization technique (perhaps analogously to sparse PCA). Searching online for things like "multilevel PCA", "nested PCA", or "hierarchical PCA" seems to point in the direction of "multiple factor analysis". From what I understand, though, this is not directly relevant as while MFA does deal with groupings of inputs, it considers them independently, and not as a repeated grouping. (That is, it would balance the influence of each week, but not necessarily apply the same components across all weeks.)
