[site]: stackoverflow
[post_id]: 4519551
[parent_id]: 
[tags]: 
Problem with IE8 with ajax and alert

i have the following script. everything works fine in ff, safari. But in IE the alert "Du kannst pro Beitrag nur 1 x voten." is not showing Browser Support Code function voteFunction(){ var ajaxRequest; // The variable that makes Ajax possible! try{ // Opera 8.0+, Firefox, Safari ajaxRequest = new XMLHttpRequest(); } catch (e){ // Internet Explorer Browsers try{ ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) { try{ ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP"); } catch (e){ // Something went wrong alert("Your browser broke!"); return false; } } } // Create a function that will receive data sent from the server ajaxRequest.onreadystatechange = function(){ var TYPE = document.getElementById('TYPE').value; if(ajaxRequest.readyState == 4){ if (ajaxRequest.responseText == 'you voted allready'){alert('Du kannst pro Beitrag nur 1 x voten.')} if (ajaxRequest.responseText != 'you voted allready'){ document.getElementById('cdm_play_video_votes').innerHTML= ajaxRequest.responseText;} if (TYPE == 1 ){publishVideovote();} if (TYPE == 2 ){publishImagevote();} } } var videoid = document.getElementById('videoid').value; var userid = document.getElementById('userid').value; var queryString = "?function=vote&videoid=" + videoid + "&userid=" + userid ; ajaxRequest.open("GET", "function.php" + queryString, true); ajaxRequest.send(null); } //--> can anybody help me? thanks a lot in advance
