[site]: stackoverflow
[post_id]: 5079303
[parent_id]: 5079183
[tags]: 
this is what I use for drag and drop to a treeview for files: public class DragDropManager { private UserControl _parent; private AddFilesEventHandler OnAddFiles; public DragDropManager() { } public UserControl Parent { set { _parent = value; if ( ! ( _parent is IDropFileTarget ) ) { throw new Exception("DragDropManager: Parent usercontrol does not implement IDropFileTarget interface"); } OnAddFiles = new AddFilesEventHandler(((IDropFileTarget)_parent).AddFiles); _parent.AllowDrop = true; _parent.DragEnter += new System.Windows.Forms.DragEventHandler(this.OnDragEnter); _parent.DragDrop += new System.Windows.Forms.DragEventHandler(this.OnDragDrop); } } /// /// Handle parent form DragEnter event /// /// /// private void OnDragEnter(object sender, System.Windows.Forms.DragEventArgs e) { string[] formats = e.Data.GetFormats(true); //e.Effect = DragDropEffects.All; for (int formatIndex = 0; formatIndex /// Handle parent form DragDrop event /// /// /// private void OnDragDrop(object sender, System.Windows.Forms.DragEventArgs e) { try { string[] formats = e.Data.GetFormats(true); string[] values = new string[1]; string url = string.Empty; for (int formatIndex = 0; formatIndex you can use it as follows: DragDropManager dragDropManager = new DragDropManager(); dragDropManager.Parent = this; and need to implement this on the UserControl public interface IDropFileTarget { void AddFiles(Array Files); }
