[site]: stackoverflow
[post_id]: 5532548
[parent_id]: 
[tags]: 
Can this Matlab function be vectorized (or made to run faster by other another method)?

The main problem is finding values at a fixed offset from the current value. My current method is very slow when the Value vector is large (typically 100000's of elements). function [ AverageValue ] = CalculateAverageValueOverAngle( Value, Angle ) % function [ AverageValue ] = CalculateAverageValueOverAngle( Value, Angle ) % Calculate average value from instantaneous value and angle % Average value is calculated over +- 90 degrees from current angle AverageValue = zeros( size( Value ) ); UnwrappedRadians = unwrap( Angle ./ 180 * pi ); for i=1:length(UnwrappedRadians) mid = UnwrappedRadians(i); start = find( UnwrappedRadians(1:i) (mid + pi/2), 1, 'First'); if isempty(start) | isempty(finish) AverageValue(i) = Value(i); else AverageValue(i) = mean(Value(start:finish+i-1)); % nanmean end end end
