[site]: stackoverflow
[post_id]: 4941367
[parent_id]: 4941001
[tags]: 
When you say it's not persisting, do you mean that the association isn't there, or that it's not being saved in the database? One option (as Brian mentioned above) would be to add some debug logging to see exactly what's going on. I've taken the liberty of refactoring your code be more Rails-like (assuming that payment has_many :packing_slips ): class Payment "Shipping") packing_slips.create(:department => "Royalty") if order.has_book? end # At this point, the packing_slips collection should be # populated - valid or not, so we can check what's going on. # If you're not getting any output here, the packing slips # aren't even being generated, which means there's a problem # with order.has_physical_product? if Rails.env.development? packing_slips.each do |ps| Rails.logger.debug("Error Messages: #{ps.errors.full_messages.inspect}") unless ps.valid? end end # btw, `unless !foo` is the same as `if foo` MembershipMailer.membership_email(order) if order.has_membership? end end
