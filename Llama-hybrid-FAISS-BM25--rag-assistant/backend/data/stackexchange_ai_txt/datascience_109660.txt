[site]: datascience
[post_id]: 109660
[parent_id]: 
[tags]: 
Value Error: Shapes (None,128,128) and (None, 4) are incompatible

I am trying to perform CNN on my dataset. I came across the below error ValueError: Shapes (None, 128, 128) and (None, 4) are incompatible The shape of my xTrain and yTrain is as follows (8, 128, 128, 3) (8, 128, 128) This is my CNN model model = keras.Sequential() model.add(Conv2D(32, kernel_size=1, padding='valid', activation='relu', input_shape=(128, 128, 3))) model.add(Dropout(0.25)) model.add(Conv2D(48, kernel_size=1, padding='valid', activation='relu')) model.add(Dropout(0.25)) model.add(Flatten()) model.add(Dense(64, activation='relu')) #model.add(Dropout(0.5)) model.add(Dense(4, activation='softmax')) Please note that my yTrain data consists of values from 0-3, therefore output layer mapped as 4 in the last layer. I am compiling my model as: # Run the model model.compile(loss='categorical_crossentropy', optimizer= 'rmsprop',metrics=['accuracy']) model.fit(xTrain, yTrain, epochs=2) I have looked into one of the solutions here and made the following changes model.compile(loss='sparse_categorical_crossentropy', optimizer= 'adam',metrics=['accuracy']) model.fit(xtrain, ytrain, epochs=2) This gave me below error logits and labels must have the same first dimension, got logits shape [8,4] and labels shape [131072] Where am I going wrong? Please guide.
