[site]: stackoverflow
[post_id]: 1856610
[parent_id]: 968369
[tags]: 
Call SHGetFileInfo for both description and icon. From experience I can tell you that accessing and searching the registry is slow. I do not know exactly how slow. BUT , I had to cache results to avoid accessing the registry. In addition, reliably retrieving file information for all file types is not as simple as you describe in Item #1. Let SHGetFileInfo do the work for you reliably and cache results to improve performance as shown below with the file's type name. Moreove, see How to use the SHGetFileInfo function to get the icons that are associated with files in Visual Basic .NET at http://support.microsoft.com/kb/319340 for an easy way of retrieving the icon. Private Shared _descriptions As New Dictionary(Of String, String) Private Shared Function CacheDocumentDescription(ByVal extension As String, ByVal description As String) As String _descriptions.Add(extension, description) DumpCacheDocumentItem(extension, description, "added") Return description End Function _ Private Shared Sub DumpCacheDocumentItem(ByVal extension As String, ByVal description As String, ByVal category As String) Debug.WriteLine(extension & ", " & description, category) End Sub Public Shared Function GetTypeName(ByVal fullPath As String) As String Dim sExt As String = System.IO.Path.GetExtension(fullPath) If Len(sExt) = 0 Then Return "File" End If If _descriptions.ContainsKey(sExt) Then 'return cached value Return _descriptions.Item(sExt) End If Dim sDocDescription As String = Missico.Shell.ShellFileInfo.TypeName(fullPath) Return CacheDocumentDescription(sExt, sDocDescription) End Function
