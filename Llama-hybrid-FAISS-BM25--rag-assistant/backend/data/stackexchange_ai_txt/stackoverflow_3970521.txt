[site]: stackoverflow
[post_id]: 3970521
[parent_id]: 3962654
[tags]: 
I found the solution. FFI can't deal with pcap_if_t **. I wrote a C function to return just an array of structs. pcap_if_t* find_devs() { pcap_if_t *devs; char errbuf[PCAP_ERRBUF_SIZE]; int res; res=pcap_findalldevs(&devs, errbuf); return devs; } I still need to handle error cases, but this does work.
