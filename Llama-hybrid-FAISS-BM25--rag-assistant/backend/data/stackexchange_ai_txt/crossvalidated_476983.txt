[site]: crossvalidated
[post_id]: 476983
[parent_id]: 
[tags]: 
R mlogit package: system is computationally singular: reciprocal condition number

I am trying to analyze a choice experiment for a homework: $ id: num [1:1944] 1 1 1 1 1 1 1 1 1 1 ... $ set : num [1:1944] 1 1 1 2 2 2 3 3 3 4 ... $ option : Factor w/ 3 levels "1","2","3": 1 2 3 1 2 3 1 2 3 1 ... $ choice: num [1:1944] 0 1 0 0 1 0 0 1 0 1 ... $ asc : Factor [1:1944] "1" "1" "0" "1" ... $ REC: Factor w/ 3 levels "0","1","2": 2 2 1 3 3 1 3 3 1 2 ... $ BDV: Factor w/ 3 levels "0","1","2": 2 2 1 1 1 1 3 1 1 1 ... $ SITE: Factor w/ 3 levels "0","1","2": 1 2 1 1 2 1 1 3 1 3 ... $ COST: num [1:1944] 1000 2500 0 2500 1000 0 1500 2500 0 2500 ... So the CE have 3 attributes (REC, BDV and SITE) each one has three levels (0, 1 and 3). Thus, each person had choice sets, each set have 3 options (0, 1 and 3). I need to do a Multinomial logistic regression, so I used the 'mlogit' package. My model is this: test.mlogit2 and I have this error: Error in solve.default(H, g[!fixed]) : system is computationally singular: reciprocal condition number = 1.06743e-21 The most common answer I have read is that it is a multicollinearity problem, so I tested removing variables and effectively it doesn't give me the error removing the REC variable. The problem is that I made the function only with the REC variable and it gives me the same error, but testing the other attributes alone doesn't give me the error, so I don't think it's a multicollinearity problem. test.mlogit2 REC: table(test.mlogit2 $choice,test.mlogit2$ REC) 0 1 2 FALSE 485 435 376 TRUE 163 213 272 det(t(as.matrix(test.mlogit2 $REC)) %*% as.matrix(test.mlogit2$ REC)) [1] 3240 BDV: table(test.mlogit2 $choice,test.mlogit2$ BDV) 0 1 2 FALSE 955 156 185 TRUE 341 163 144 det(t(as.matrix(test.mlogit2 $BDV)) %*% as.matrix(test.mlogit2$ BDV)) [1] 1635 SITE: table(test.mlogit2 $choice,test.mlogit2$ SITE) 0 1 2 FALSE 993 146 157 TRUE 303 188 157 det(t(as.matrix(test.mlogit2 $SITE)) %*% as.matrix(test.mlogit2$ SITE)) [1] 1590 However, the error appear only with REC (alone or with the other attributes)
