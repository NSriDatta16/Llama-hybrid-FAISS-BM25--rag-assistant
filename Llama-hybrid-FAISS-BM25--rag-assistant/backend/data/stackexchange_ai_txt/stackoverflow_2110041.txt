[site]: stackoverflow
[post_id]: 2110041
[parent_id]: 
[tags]: 
JMeter proxy and java serialization in HTTP/POST?

We have an applet-servlet communication that we'd like to record with JMeter's HTTP proxy. It works with GET messages until the applet sends an HTTP POST message which includes some serialized Java objects (built-in types), then we get this error in the Applet: alt text http://img339.imageshack.us/img339/9238/appletservletjmeterhttp.png OK, so there's some JVM version conflict somewhere in the queue. But where? The communication runs OK without JMeter, that is: Applet -> Tomcat -> Servlet. All on my local machine. But it doesn't work through JMeter: Applet -> JMeter proxy -> Tomcat -> Servlet. Also all on my machine. It is as if JMeter was modifying the POST message content... I tested it with the Apache proxy as well, working fine. Even funnier thing is that I have only one version of Java installed, one JDK and one JRE. Both 1.6.0_07... Thought I'd ask before starting digging deeper in the rabbit hole ;-) Here is the hex dump of the POST data sent directly to Tomcat: 00000348 ac ed 00 05 73 72 00 11 6a 61 76 61 2e 6c 61 6e ....sr.. java.lan 00000358 67 2e 49 6e 74 65 67 65 72 12 e2 a0 a4 f7 81 87 g.Intege r....... 00000368 38 02 00 01 49 00 05 76 61 6c 75 65 78 72 00 10 8...I..v aluexr.. 00000378 6a 61 76 61 2e 6c 61 6e 67 2e 4e 75 6d 62 65 72 java.lan g.Number 00000388 86 ac 95 1d 0b 94 e0 8b 02 00 00 78 70 00 00 01 ........ ...xp... 00000398 7b { And here is the data when sent through JMeter: 00000128 ac ed 00 05 73 72 00 11 6a 61 76 61 2e 6c 61 6e ....sr.. java.lan 00000138 67 2e 49 6e 74 65 67 65 72 12 e2 a0 a4 f7 3f 3f g.Intege r.....?? 00000148 38 02 00 01 49 00 05 76 61 6c 75 65 78 72 00 10 8...I..v aluexr.. 00000158 6a 61 76 61 2e 6c 61 6e 67 2e 4e 75 6d 62 65 72 java.lan g.Number 00000168 3f ac 3f 1d 0b 3f e0 3f 02 00 00 78 70 00 00 01 ?.?..?.? ...xp... 00000178 7b { A lot of "3f"s in the second dump... So this is definitely some kind of an encoding problem. The content type is set correctly in the header: POST /ABCOrder/ABCServlet?cmd=getNetworkConnection HTTP/1.1 Connection: keep-alive Content-Type: application/octet-stream Host: 109.107.148.164:8443 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 User-Agent: Mozilla/4.0 (Windows Vista 6.0) Java/1.6.0_14 Content-Length: 81
