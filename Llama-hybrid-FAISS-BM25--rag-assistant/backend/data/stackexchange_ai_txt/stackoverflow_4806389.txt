[site]: stackoverflow
[post_id]: 4806389
[parent_id]: 4806262
[tags]: 
I'm not on a computer with a database engine, so I can't be sure about this: UPDATED following comment SELECT A.symbol, A.dseqkey, AVG(B.volume) MovingAverage FROM temp_vol A LEFT JOIN temp_vol B ON A.symbol = B.symbol AND A.dseqkey BETWEEN B.dseqkey - 30 AND B.dseqkey GROUP BY A.symbol, A.dseqkey
