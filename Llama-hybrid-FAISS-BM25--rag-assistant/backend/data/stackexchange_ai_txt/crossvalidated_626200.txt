[site]: crossvalidated
[post_id]: 626200
[parent_id]: 
[tags]: 
Gamma GLM goodness-of-fit diagnostics and remedies for double glm

I’m looking for some help in diagnosing a gamma GLM. I am not sure whether the apparently poor fit is to do with the fact that my glm models dispersion rather than the mean, whether I am misunderstanding the diagnostic plots, whether I should try a different link function, or what else I might do to remedy it. Thanks heaps in advance for any suggestions. My data are records of height above sea level from some satellite tags ordinarily fitted to birds. These records tend to be very imprecise, and a little biased downwards, so my colleagues ran some calibration experiments in which the tags were fitted not to a bird but to a fixed post at ground level. Below, a probability density plot of recorded height above ground in meters. Negative values imply the tag was underground (it wasn't!) Then I fitted a model in which the variation in recorded height was regressed against one categorical predictor (the overhead canopy habitat blocking view of the sky) and two continuous predictors that capture the configuration of available satellites across the sky (‘DOP’), and the time in seconds that elapsed while the tag attempted to obtain a location fix (‘fixtime’). Here’s an example of how one of these predictors, fixtime, is related to the dispersion: To obtain this I used the double glm method due to Gordon Smyth and Peter Verbyla, implemented in the R package dglm. This fits two glms: one for prediction of the mean, another for the dispersion. The mean model is intercept-only (since the tag isn’t moving) and gaussian with an identity link. The dispersion model is required by the package to follow a gamma family distribution, but with a range of available link functions. fit.aa I started with the log link function. Plotting the residuals against fitted values following the dglm package authors’ example code gave me this encouraging-looking plot (ggplot version shown instead below so you can see a fitted smooth through the data): plot(fitted(fit.aa $dispersion.fit), residuals(fit.aa$ dispersion.fit)) However I followed up by using Florian Hartig’s DHARMa package to plot simulated residuals. Here there seems to be something violently amiss. The qq plot compares residuals simulated from the fitted dispersion model to a uniform distribution. It should follow the 45º line but instead hugs the horizontal axis, kicking up abruptly at the far right. simulationOutput The right plot shows quantile regressions of the rank-transformed fitted values vs the residuals, and should be a set of horizontal lines representing the 25th, 50th and 75th quantiles. I am not sure how to interpret it as the quantile lines hug the horizontal axis. DHARMa::plotResiduals(simulationOutput) ... but the quantile test doesn't look good: DHARMa::testQuantiles(simulationOutput, predictor = NULL, quantiles = c(0.25, 0.5, 0.75), plot = TRUE) > Test for location of quantiles via qgam > data: simulationOutput > p-value alternative hypothesis: both Finally, I tried using the stats::simulate() function to simulate the response from the fitted model, and compare it to the observed values for dispersion; following a post I'm having trouble relocating. The simulated values (multiple lines in grey) seem similar in distribution to the observed ones (single black line). That seems in conflict with the message of the DHARMa plots, but I suspect I am just missing something? sims $dispersion.fit, nsim = 250) obs dispersion.fit $residuals + fit.aa$ dispersion.fit$fitted.values plot(density(obs)) for (i in 1:50) lines (density(sims[[i]]), col = "grey80") So, I am wondering: Do these plots collectively indicate that the choice of family or link function is a poor fit to the data? How can I remedy this? I am constrained to using the gamma family within the dglm package (and it seems like a reasonable choice anyway for modelling a dispersion). I feel a little timid about just throwing a range of link functions at the problem without some underlying theoretical justification for choosing a particular link. But perhaps that is misplaced? Or are there some other alterations to the model specification that I could enact? Thank you for bearing with me for this long question, and thanks very much in advance for any suggestions.
