[site]: stackoverflow
[post_id]: 3879520
[parent_id]: 
[tags]: 
Efficient computation of "variable (number of points included)" moving average in R

I'm trying to implement a variable exponential moving average on a time series of intraday data (i.e 10 seconds). By variable, I mean that the size of the window included in the moving average depends on another factor (i.e. volatility). I was thinking of the following: MA(t)=alpha(t)*price(t) + (1-alpha(t))MA(t-1), where alpha corresponds for example to a changing volatility index. In a backtest on huge series (more than 100000) points, this computation causes me "troubles". I have the complete vectors alpha and price, but for the current values of MA I always need the value just calculated before. Thus, so far I do not see a vectorized solution???? Another idea, I had, was trying to directly apply the implemented EMA(..,n=f()) function to every data point, by always having a different value for f(). But I do not find a fast solution neither so far. Would be very kind if somebody could help me with my problem??? Even other suggestions of how constructing a variable moving average would be great. Thx a lot in advance Martin
