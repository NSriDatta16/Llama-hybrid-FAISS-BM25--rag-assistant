[site]: stackoverflow
[post_id]: 4130000
[parent_id]: 
[tags]: 
Setting the right transaction isolation mode with NHibernate, how to?

We have switched from sqlite to FireBird embedded server, because FB seems to support concurrent updates of the database, but we sometimes have these exception coming from it: 2010-10-28 15:49:31,242 [56] ERROR NetworkCatcher.Entities.Agent.Server.RunResultManager - Failed to send result to server 32W2K3SP2VM-DEV. NHibernate.Exceptions.GenericADOException: could not update: ExecutionEntry#89_19_32W2K3SP2VM-DEV][SQL: UPDATE Run SET ExecutionId = ?, Source = ?, Destination = ?, ProtocolId = ?, Duration = ?, SampleCount = ?, StartTime = ?, ServerHostName = ?, SamplesSentToServer = ?, SampleInterval = ?, Parameters = ? WHERE Id = ?] ---> FirebirdSql.Data.FirebirdClient.FbException: deadlock update conflicts with concurrent update concurrent transaction number is 31632 ---> FirebirdSql.Data.Common.IscException: deadlock update conflicts with concurrent update concurrent transaction number is 31632 at FirebirdSql.Data.Client.Native.FesDatabase.ParseStatusVector(IntPtr[] statusVector) at FirebirdSql.Data.Client.Native.FesStatement.Execute() at FirebirdSql.Data.FirebirdClient.FbCommand.ExecuteCommand(CommandBehavior behavior, Boolean returnsSet) at FirebirdSql.Data.FirebirdClient.FbCommand.ExecuteCommand(CommandBehavior behavior) at FirebirdSql.Data.FirebirdClient.FbCommand.ExecuteNonQuery() . . . The FB response to this was “Why do you think it's a bug? It's a regular update conflict causing by two transactions updating the same record simultaneously. What is your transaction isolation mode?“ This phrase has puzzled me twice – once, because I was unpleasantly surprised to discover that I may write the same record concurrently and the second time – I have no idea what is my transaction isolation mode and how do I use it to serialize writes to the same record. The mapping of the object, being updated is: I am sure there is a good samaritan out there, who knows the answer to my problem. Please, please, please share from your wisdom... Thanks.
