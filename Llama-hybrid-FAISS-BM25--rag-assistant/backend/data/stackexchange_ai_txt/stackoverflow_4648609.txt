[site]: stackoverflow
[post_id]: 4648609
[parent_id]: 4646987
[tags]: 
Your question is confusing. But to answer the part with the average value: you should do this on database side with the AVG-SQL-Function like this: CREATE TABLE #Temp ( Id int, ServCode INT, Value INT) INSERT INTO #Temp Values(1,100,3) INSERT INTO #Temp Values(2,100,4) INSERT INTO #Temp Values(3,100,3) INSERT INTO #Temp Values(4,100,3) INSERT INTO #Temp Values(5,101,5) INSERT INTO #Temp Values(6,101,5) select AVG(Value)FROM #Temp WHERE ServCode=100 drop table #Temp Use this to create an extra column in your query with the average of every row's Serv-Code: SELECT T1.*, (SELECT AVG(Value) FROM [#Temp] AS T2 WHERE T1.ServCode=T2.ServCode) AS average FROM [#Temp] AS T1
