[site]: datascience
[post_id]: 83940
[parent_id]: 
[tags]: 
How to Set the Same Categorical Codes to Train and Test data? Python-Pandas

NOTE: If someone else it's wondering about this topic, I understand you're getting deeper in the Data Analysis world, so I did this question before to learn that: You encode categorical values as INTEGERES only if you're dealing with Ordinal Classes, i.e. College degree, Customer Satisfaction Surveys as an example. Otherwise if you're dealing with Nominal Classes like, gender, colors or names, you MUST convert them with other methods since they do not specific any numerical order, most known are One-hot Encoding or Dummy variables. I encorage you to read more about them and hope this has been useful. Check the link below to see a nice explanation: https://www.youtube.com/watch?v=9yl6-HEY7_s This may be a simple question but I think it can be useful for beginners. I need to run a prediction model on a test dataset, so to convert the categorical variables into categorical codes that can be handled by the random forests model I use these lines with all of them: Train: data_['Col1_CAT'] = data_['Col1'].astype('category') data_['Col1_CAT'] = data_['Col1_CAT'].cat.codes So, before running the model I have to apply the same procedure to both, the Train and Test data. And since both datasets have the same categorical variables/columns, I think it will be useful to apply the same categorical codes to each column respectively. However, although I'm handling the same variables on each dataset I get different codes everytime I use these two lines. So, my question is, how can I do to get the same codes everytime I convert the same categoricals on each dataset? Thanks for your insights and feedback.
