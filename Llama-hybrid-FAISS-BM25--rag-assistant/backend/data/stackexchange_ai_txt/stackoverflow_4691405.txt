[site]: stackoverflow
[post_id]: 4691405
[parent_id]: 
[tags]: 
Magento: use various methods in 1 model

I'm having a problem using methods in my module's model class. I have a public function which triggers 2 protected methods. The problem is that only the first 1 returns a value. Here is my class: _init('points/points'); $this->_customer = Mage::getSingleton('customer/session')->getCustomer(); } public function getCustomerAvailablePoints() { $confirmed = $this->_getCustomerConfirmedPoints(); $redeemed = $this->_getCustomerRedeeemedPoints(); $balance = ($confirmed - $redeemed); return $balance; } protected function _getCustomerConfirmedPoints() { $availablePoints = $this->addFieldToFilter('customer_id', $this->_customer->getId()) ->addFieldToFilter('points_status', self::POINTS_CONFIRMED) ->addFieldToSelect('points_pending') ->addExpressionFieldToSelect('available_points', 'SUM({{points_pending}})', 'points_pending'); return $availablePoints->getFirstItem()->getAvailablePoints(); } protected function _getCustomerRedeeemedPoints() { $redeemedPoints = $this->addFieldToFilter('customer_id', $this->_customer->getId()) ->addFieldToFilter('points_status', self::POINTS_REDEEMED) ->addFieldToSelect('points_pending') ->addExpressionFieldToSelect('redeemed_points', 'SUM({{points_pending}})', 'points_pending'); return $redeemedPoints->getFirstItem()->getRedeemedPoints(); } } Now, if, in _getCustomerRedeeemedPoints(), I replace $this by Mage::getResourceModel('points/points_collection') it works fine. But as I already am insdide the class, I don't understand why I have to instance it through Mage : as far as I understand, $this is only available once. So, am I doing something wrong? thanks in advance.
