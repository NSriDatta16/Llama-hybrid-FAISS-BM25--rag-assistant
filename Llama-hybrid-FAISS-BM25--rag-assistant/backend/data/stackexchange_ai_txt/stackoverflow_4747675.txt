[site]: stackoverflow
[post_id]: 4747675
[parent_id]: 4746838
[tags]: 
may be it helps to you package Autodrag.test; import android.app.Activity; import android.os.Bundle; import android.os.Handler; import android.os.Message; import android.view.Menu; import android.view.MenuItem; import android.widget.ImageView; import android.widget.LinearLayout.LayoutParams; public class Autodrag extends Activity { private boolean goRight=false,goDown=false,stop=false; private ImageView img; private LayoutParams layoutparms; private Thread thread; private Runnable run; private Handler handler; @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.main); handler=new Handler(){ @Override public void handleMessage(Message message) { super.handleMessage(message); switch (message.what) { case 0: Myball(5,5); break; default: break; } } }; run =new Runnable() { @Override public void run() { while (!stop) { Message message=new Message(); message.what=0; handler.sendMessage(message); try{ Thread.sleep(100); }catch (Exception e) { Thread.currentThread().interrupt(); } } } }; } @Override public boolean onCreateOptionsMenu(Menu menu) { super.onCreateOptionsMenu(menu); menu.add(0, 0, 0, "Start"); menu.add(0, 1, 0, "Stop"); return true; } @Override public boolean onOptionsItemSelected(MenuItem item){ switch (item.getItemId()) { case 0: thread = new Thread(run); thread.start(); stop=false; return true; case 1: stop=true; return true; } return true; } private void Myball(int goX,int goY) { img=(ImageView)findViewById(R.id.img); layoutparms = (LayoutParams) img.getLayoutParams(); if (layoutparms.leftMargin 180){ goRight = false; } if (layoutparms.topMargin 300){ goDown = false; } if (goRight){ layoutparms.leftMargin += goX; }else{ layoutparms.leftMargin -= goX; } if (goDown){ layoutparms.topMargin += goY; }else{ layoutparms.topMargin -= goY; } img.setLayoutParams(layoutparms); } }
