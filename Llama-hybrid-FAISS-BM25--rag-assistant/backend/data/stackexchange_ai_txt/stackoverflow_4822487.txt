[site]: stackoverflow
[post_id]: 4822487
[parent_id]: 
[tags]: 
Error '80040e21' Multiple-step operation generated errors

I have a page that posts to a SQL Server 2008 database and I'm Getting the following error. Microsoft Cursor Engine error '80040e21' Multiple-step operation generated errors. Check each status value. /incConfirm.asp, line 429 The code posts data to a table then re-queries to pick up and order ID for use when data is entered into a second table. In debugging I can see that the problem is being caused by the order ID not being carried forward. The code is shown below (with line 469 marked). This is the first part: Set rsOrder = Server.CreateObject("ADODB.RecordSet") rsOrder.CursorLocation = adUseClient rsOrder.Open "Orders Order By orderID", cnn, adOpenDynamic, adLockOptimistic, adCmdTable rsOrder.AddNew rsOrder.Fields("orderCustId") = trim(iCustID) rsOrder.Fields("orderPayId") = trim(iPayID) rsOrder.Fields("orderAddrId") = trim(iAddrID) rsOrder.Fields("orderDate") = Now rsOrder.Fields("orderIsComplete") = 1 rsOrder.Update bookMark = rsOrder.AbsolutePosition rsOrder.Requery rsOrder.AbsolutePosition = bookMark iOrderID = rsOrder.Fields("orderID") closeobj(rsOrder) End Function This is the second (containing line 469): Set rsOrderDetail = Server.CreateObject("ADODB.RecordSet") rsOrderDetail.CursorLocation = adUseClient rsOrderDetail.Open "OrderDetails Order By detailID", cnn, adOpenDynamic, adLockOptimistic, adCmdTable rsOrderDetail.AddNew rsOrderDetail.Fields("odrdtOrderId") = trim(iOrderID) - LINE 469 As mentioned iOrderID has no value, hence the error. The puzzling thing is that I've been using this code for some time and it works fine on 2 seperate pages?
