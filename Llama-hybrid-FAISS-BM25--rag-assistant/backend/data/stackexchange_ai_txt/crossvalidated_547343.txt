[site]: crossvalidated
[post_id]: 547343
[parent_id]: 
[tags]: 
Value from Brown-Forsythe test using R is different to if done manually. Trying to figure out where things went awry

As the title reads I was working on some exercises and one of the questions asked me to calculate the Brown-Forsythe Test statistic to determine if the variance of the residuals is constant. I've done this procedure in the past manually, but I'm working on expressing things in R code to be able to leverage its power so when the time comes in the future I'll have a handle on things. So in R I used the bf.test() function found in the onewaytests package. To perform the test I had to initially split my data in half. The exercise asked me to take the 40 smallest values of fitted_lm and make that one group and then the second group was the rest of the values (41 values greater than fitted_lm ). To make the bf.test() work I had to turn my groupings into a factor: > factor_of_fitted = with(data = Commercial_Properties, fitted_lm Commercial_Properties$factor_fitted = factor_of_fitted That's where you see the factor_fitted column in my data set. Once doing such I performed the test and got the following: > bf.test(data = Commercial_Properties, formula = residuals ~ as.factor(factor_fitted), alpha = 0.05) Brown-Forsythe Test (alpha = 0.05) ------------------------------------------------------------- data : residuals and as.factor(factor_fitted) statistic : 1.421309 num df : 1 denom df : 78.46183 p.value : 0.2367813 Result : Difference is not statistically significant. ------------------------------------------------------------- Fortunately I have a solution manual for the textbook I'm using. Looking at the result from the text they have a different value for the test statistic (labeled as $t_{BF}^{*}$ ) So I know if I had done the process manually I would've most likely got the same result as the text. Which in small data sets is feasible, but once I'm dealing with larger data sets it's not going to be as easy to do this manually. So I was wondering what I did wrong in organizing my data to not get the same test statistic as the solution guide? To be able to make things easier I've included the full data set below: dput(Commercial_Properties) structure(list(Rental_Rates = c(13.5, 12, 10.5, 15, 14, 10.5, 14, 16.5, 17.5, 16.5, 17, 16.5, 16, 16.5, 17.225, 17, 16, 14.625, 14.5, 14.5, 16.5, 16.5, 15, 15, 13, 12.5, 14, 13.75, 14, 15, 13.75, 15.625, 15.625, 13, 14, 15.25, 16.25, 13, 14.5, 11.5, 14.25, 15.5, 12, 14.25, 14, 16.5, 14.5, 15.5, 16.75, 16.75, 16.75, 16.75, 17, 16, 14.5, 15, 15, 16, 15.5, 15.25, 16.5, 19.25, 17.75, 18.75, 19.25, 14, 14, 18, 13.75, 15, 15.5, 15.9, 15.25, 15.5, 14.75, 15, 14.5, 13.5, 15, 15.25, 14.5), Age = c(1, 14, 16, 4, 11, 15, 2, 1, 1, 8, 12, 2, 2, 13, 2, 1, 1, 12, 16, 3, 6, 3, 3, 3, 14, 1, 15, 16, 2, 16, 2, 3, 3, 16, 16, 13, 1, 14, 3, 15, 1, 15, 1, 15, 3, 3, 4, 1, 4, 4, 2, 2, 1, 2, 3, 15, 17, 1, 14, 2, 1, 0, 18, 16, 13, 20, 18, 16, 1, 2, 16, 1, 15, 4, 20, 3, 3, 18, 15, 11, 14), Op_Expense_Tax = c(5.02, 8.19, 3, 10.7, 8.97, 9.45, 8, 6.62, 6.2, 11.78, 14.62, 11.55, 9.63, 12.99, 12.01, 12.01, 7.99, 10.33, 10.67, 9.45, 12.65, 12.08, 10.52, 9.47, 11.62, 5, 9.89, 11.13, 7.96, 10.73, 7.95, 9.1, 12.05, 8.43, 10.6, 10.55, 5.5, 8.53, 9.04, 8.2, 6.13, 8.32, 4, 10.1, 5.25, 11.62, 5.31, 5.75, 12.46, 12.75, 12.75, 11.38, 5.99, 11.37, 10.38, 10.77, 11.3, 7.06, 12.1, 10.04, 4.99, 7.33, 12.11, 12.86, 12.7, 11.58, 11.58, 12.97, 4.82, 9.75, 10.36, 8.13, 13.23, 10.57, 11.22, 10.34, 10.67, 8.6, 11.97, 11.27, 12.68), Vacancy_Rate = c(0.14, 0.27, 0, 0.05, 0.07, 0.24, 0.19, 0.6, 0, 0.03, 0.08, 0.03, 0, 0.04, 0.03, 0, 0.14, 0.12, 0, 0.03, 0.13, 0, 0.05, 0, 0, 0.33, 0.05, 0.06, 0.22, 0.09, 0, 0, 0.03, 0.04, 0.04, 0.1, 0.21, 0.03, 0.04, 0, 0, 0, 0, 0, 0.16, 0, 0, 0, 0.03, 0, 0, 0, 0.57, 0.27, 0, 0.05, 0, 0.14, 0.05, 0.06, 0.73, 0.22, 0, 0, 0.04, 0, 0.03, 0.08, 0, 0.03, 0.02, 0.23, 0.05, 0.04, 0, 0, 0, 0.08, 0.14, 0.03, 0.03 ), Total_Sq_Ft = c(123000, 104079, 39998, 57112, 60000, 101385, 31300, 248172, 215000, 251015, 291264, 207549, 82000, 359665, 265500, 299000, 189258, 366013, 349930, 85335, 235932, 130000, 40500, 40500, 45959, 120000, 81243, 153947, 97321, 276099, 90000, 184000, 184718, 96000, 106350, 135512, 180000, 315000, 42500, 30005, 60000, 73521, 50000, 50724, 31750, 168000, 70000, 27000, 129614, 129614, 130000, 209000, 220000, 60000, 110000, 101206, 288847, 105000, 276425, 33000, 210000, 240000, 281552, 421000, 484290, 234493, 230675, 296966, 32000, 38533, 109912, 236000, 243338, 122183, 128268, 72000, 43404, 59443, 254700, 434746, 201930), residuals = c(`1` = -1.03567244005944, `2` = -1.51380641405037, `3` = -0.591053402133659, `4` = -0.133568082335235, `5` = 0.313283765150399, `6` = -3.18718522392237, `7` = -0.538356748944345, `8` = 0.236302385996349, `9` = 1.98922037248654, `10` = 0.105829602747806, `11` = 0.0231248303375595, `12` = -0.337070751068471, `13` = 0.717869467777838, `14` = -0.39241101481937, `15` = -0.20101957286503, `16` = -0.814937024117113, `17` = 0.101690072282649, `18` = -1.75913163724428, `19` = -1.2101149159064, `20` = -0.634341765183287, `21` = -0.366004170475953, `22` = 0.288596122855648, `23` = -0.0932002476873237, `24` = 0.233884283934414, `25` = -0.853339940810852, `26` = -2.12393446949041, `27` = 0.466014056944787, `28` = -0.573974675317338, `29` = -1.06882672700907, `30` = -0.197717691204396, `31` = -1.12173717691291, `32` = -0.173906919197219, `33` = -1.03012563640357, `34` = -0.0909536535687804, `35` = 0.215053952020427, `36` = 0.784804746475957, `37` = 1.08392037338663, `38` = -2.13245126940118, `39` = -0.185470952077321, `40` = -1.12038545273967, `41` = -0.0127716796287901, `42` = 2.50093864322792, `43` = -1.58283345207266, `44` = 0.929599529783516, `45` = 0.394236721188825, `46` = 0.117200255343118, `47` = 0.815339786695246, `48` = 1.60589656366231, `49` = 0.557941960402757, `50` = 0.494737471820888, `51` = 0.207611404280235, `52` = -0.0320457978950357, `53` = 1.15579653742154, `54` = 0.234272601000998, `55` = -1.07348973870662, `56` = 1.05964667223628, `57` = -0.261711554772372, `58` = 1.03165127260948, `59` = -0.345957206526787, `60` = 0.203372872216656, `61` = 0.91796112557882, `62` = 2.9441449324703, `63` = 2.45969648166138, `64` = 1.8590887491699, `65` = 1.4518076575634, `66` = -0.483857748462958, `67` = -0.756250356020606, `68` = 2.01140230949244, `69` = 0.0785504271364723, `70` = 0.00989280872616449, `71` = 1.76689842599545, `72` = -0.46393087551268, `73` = -0.510410865690217, `74` = -0.106354745783563, `75` = 1.20942716910305, `76` = -0.261085606218594, `77` = -0.627547724654831, `78` = 0.910085786900333, `79` = -0.550846871179429, `80` = -2.0301809444414, `81` = -0.906819055572569), fitted_lm = c(`1` = 14.5356724400594, `2` = 13.5138064140504, `3` = 11.0910534021337, `4` = 15.1335680823352, `5` = 13.6867162348496, `6` = 13.6871852239224, `7` = 14.5383567489443, `8` = 16.2636976140037, `9` = 15.5107796275135, `10` = 16.3941703972522, `11` = 16.9768751696624, `12` = 16.8370707510685, `13` = 15.2821305322222, `14` = 16.8924110148194, `15` = 17.426019572865, `16` = 17.8149370241171, `17` = 15.8983099277174, `18` = 16.3841316372443, `19` = 15.7101149159064, `20` = 15.1343417651833, `21` = 16.866004170476, `22` = 16.2114038771444, `23` = 15.0932002476873, `24` = 14.7661157160656, `25` = 13.8533399408109, `26` = 14.6239344694904, `27` = 13.5339859430552, `28` = 14.3239746753173, `29` = 15.0688267270091, `30` = 15.1977176912044, `31` = 14.8717371769129, `32` = 15.7989069191972, `33` = 16.6551256364036, `34` = 13.0909536535688, `35` = 13.7849460479796, `36` = 14.465195253524, `37` = 15.1660796266134, `38` = 15.1324512694012, `39` = 14.6854709520773, `40` = 12.6203854527397, `41` = 14.2627716796288, `42` = 12.9990613567721, `43` = 13.5828334520727, `44` = 13.3204004702165, `45` = 13.6057632788112, `46` = 16.3827997446569, `47` = 13.6846602133048, `48` = 13.8941034363377, `49` = 16.1920580395972, `50` = 16.2552625281791, `51` = 16.5423885957198, `52` = 16.782045797895, `53` = 15.8442034625785, `54` = 15.765727398999, `55` = 15.5734897387066, `56` = 13.9403533277637, `57` = 15.2617115547724, `58` = 14.9683487273905, `59` = 15.8459572065268, `60` = 15.0466271277833, `61` = 15.5820388744212, `62` = 16.3058550675297, `63` = 15.2903035183386, `64` = 16.8909112508301, `65` = 17.7981923424366, `66` = 14.483857748463, `67` = 14.7562503560206, `68` = 15.9885976905076, `69` = 13.6714495728635, `70` = 14.9901071912738, `71` = 13.7331015740046, `72` = 16.3639308755127, `73` = 15.7604108656902, `74` = 15.6063547457836, `75` = 13.5405728308969, `76` = 15.2610856062186, `77` = 15.1275477246548, `78` = 12.5899142130997, `79` = 15.5508468711794, `80` = 17.2801809444414, `81` = 15.4068190555726), factor_fitted = c(`1` = TRUE, `2` = TRUE, `3` = TRUE, `4` = TRUE, `5` = TRUE, `6` = TRUE, `7` = TRUE, `8` = FALSE, `9` = FALSE, `10` = FALSE, `11` = FALSE, `12` = FALSE, `13` = FALSE, `14` = FALSE, `15` = FALSE, `16` = FALSE, `17` = FALSE, `18` = FALSE, `19` = FALSE, `20` = TRUE, `21` = FALSE, `22` = FALSE, `23` = TRUE, `24` = TRUE, `25` = TRUE, `26` = TRUE, `27` = TRUE, `28` = TRUE, `29` = TRUE, `30` = FALSE, `31` = TRUE, `32` = FALSE, `33` = FALSE, `34` = TRUE, `35` = TRUE, `36` = TRUE, `37` = FALSE, `38` = TRUE, `39` = TRUE, `40` = TRUE, `41` = TRUE, `42` = TRUE, `43` = TRUE, `44` = TRUE, `45` = TRUE, `46` = FALSE, `47` = TRUE, `48` = TRUE, `49` = FALSE, `50` = FALSE, `51` = FALSE, `52` = FALSE, `53` = FALSE, `54` = FALSE, `55` = FALSE, `56` = TRUE, `57` = FALSE, `58` = TRUE, `59` = FALSE, `60` = TRUE, `61` = FALSE, `62` = FALSE, `63` = FALSE, `64` = FALSE, `65` = FALSE, `66` = TRUE, `67` = TRUE, `68` = FALSE, `69` = TRUE, `70` = TRUE, `71` = TRUE, `72` = FALSE, `73` = FALSE, `74` = FALSE, `75` = TRUE, `76` = FALSE, `77` = TRUE, `78` = TRUE, `79` = FALSE, `80` = FALSE, `81` = FALSE), fitted_lm_inter_two = c(`1` = 14.6116798577332, `2` = 11.1916330930142, `3` = 10.6929751419447, `4` = 14.9970693316611, `5` = 13.5321424338277, `6` = 11.8447040877392, `7` = 14.2387694605939, `8` = 17.2471890939162, `9` = 15.4894910008001, `10` = 16.4442024731856, `11` = 17.5133080797731, `12` = 16.7244341351021, `13` = 15.1542644276347, `14` = 17.0652317677913, `15` = 17.386797838442, `16` = 17.6793446680949, `17` = 16.01276803313, `18` = 15.6160310671909, `19` = 15.3871484858081, `20` = 15.0355424842674, `21` = 16.9646358788209, `22` = 16.0367231766605, `23` = 14.9053935625622, `24` = 14.7219161827122, `25` = 14.8289083816498, `26` = 14.5540167514953, `27` = 13.6813659178485, `28` = 14.4313119499636, `29` = 14.8848419753938, `30` = 14.5641221825535, `31` = 14.8596894577731, `32` = 15.687830923695, `33` = 16.5526108304165, `34` = 12.9785287733056, `35` = 14.1202878020442, `36` = 14.1661979578704, `37` = 15.2896847025652, `38` = 14.2307529965451, `39` = 14.5936312206155, `40` = 13.203430619155, `41` = 14.4301755876548, `42` = 13.3834676419329, `43` = 13.9873375650687, `44` = 14.1242292385165, `45` = 13.3240205403671, `46` = 16.2383430173208, `47` = 13.8399712533045, `48` = 14.1448935065841, `49` = 16.0967613414401, `50` = 16.1584467142199, `51` = 16.2453366247313, `52` = 16.6073805607836, `53` = 16.4527862334832, `54` = 15.4786654587565, `55` = 15.4573652950645, `56` = 14.2008846171333, `57` = 15.4067278268119, `58` = 14.9712938394994, `59` = 15.9119799046393, `60` = 14.8274036384947, `61` = 16.04294294626, `62` = 16.8448963733325, `63` = 15.7524858092804, `64` = 17.0106566737114, `65` = 17.6513462931722, `66` = 15.0770145346552, `67` = 15.0116830599038, `68` = 16.0832647503218, `69` = 14.0206538124515, `70` = 14.8257773376662, `71` = 14.1970108477843, `72` = 16.7509472769789, `73` = 16.2216720728956, `74` = 15.5064282922696, `75` = 14.5933342257741, `76` = 15.1517080909956, `77` = 14.9992784580798, `78` = 12.2017346276572, `79` = 15.0676973219743, `80` = 16.924152247941, `81` = 15.9072363357914)), row.names = c(NA, -81L), class = c("tbl_df", "tbl", "data.frame"))
