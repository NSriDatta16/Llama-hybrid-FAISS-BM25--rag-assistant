[site]: stackoverflow
[post_id]: 1231783
[parent_id]: 1231748
[tags]: 
If you are using the Enterprise edition of SQL Server then why make your project difficult for yourself by using raw T-SQL code? You can achieve your objectives in a more simple and robust manner by using SQL Server Integration Services (SSIS), a technology specifically designed to perform ETL tasks and is of course included with your edition of SQL Server. Pre-built components already exist to process data in the manner which you desire and you have the added bonus of being able to easily incorporate auditing and logging capabilities into your solution. What you are looking to achieve could be accomplished via pure T-SQL coding, however you would be making life more difficult for yourself in the process and the resulting solution would, in my opinion, most likely be cumbersome and less elegant.
