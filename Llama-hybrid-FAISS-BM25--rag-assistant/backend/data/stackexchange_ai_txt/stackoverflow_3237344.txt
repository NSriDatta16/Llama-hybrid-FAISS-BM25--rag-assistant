[site]: stackoverflow
[post_id]: 3237344
[parent_id]: 3237034
[tags]: 
You might have a cycle in your graph (see, it's not a tree). You can use code like this to detect it: private Unit GetUnit(Unit organisationalUnit) { return GetUnit(organisationalUnit, new HashSet ()); } private Unit GetUnit(Unit organisationalUnit, HashSet visited) { if (visited.Contains(organisationalUnit)) { throw new Exception("Cycle detected!"); // or just return null if you prefer } visited.Add(organisationalUnit); if (organisationalUnit.IsMainUnit) { return organisationalUnit; } if (organisationalUnit.Parent == null) return null; return GetUnit(organisationalUnit.Parent, visited); }
