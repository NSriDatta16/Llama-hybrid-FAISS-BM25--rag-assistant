[site]: crossvalidated
[post_id]: 563072
[parent_id]: 562779
[tags]: 
Centile estimation for longitudinal data is surprisingly tricky. If the number of subjects is large and the number of measurements (per subject) is generally small, then: a) One approach is to ignore the longitudinal aspect of the data and treat it as cross-sectional (i.e. independent) observations. This approach was taken by the World Health Organization when they developed their World Child Growth Standards charts (they had measurements on 8440 children), published in 3 books, 2006, 2007, 2009. The centiles (treating the data as independent observations) can be obtained using gamlss, see Stasinopoulos et al. (2017) Chapter 13 (which focusses on a single continuous explanatory variable), and Rigby et al. (2019) Section 5.9 (which focusses on two continuous explanatory variables), although in gamlss any number and type of explanatory variables are allowed. b) If you are not happy with ignoring the longitudinal aspect of the data, then another approach is to randomly select one observation from each subject, so the data is then cross-sectional. c) You could repeat b) m times, and then average the resulting m fitted centiles, or average the m fitted cdfâ€™s and obtain the centiles from that average cdf. I doubt whether b), and especially c), would give centiles which are much different from a), but it would be a useful check. If the number of subjects is small and the number of measurements (per subject) is large, then a random effects model may be important for obtaining centiles. However this is difficult as there are 2 problems: a) How to find a suitable random effects model. b) How to obtain the centiles of marginal distribution of Y (integrating out the random effects).
