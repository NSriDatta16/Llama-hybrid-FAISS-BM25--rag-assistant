[site]: crossvalidated
[post_id]: 597463
[parent_id]: 474915
[tags]: 
Since disasters = pm.Poisson('disasters', rate, observed=disaster_data) for this model the likelihood is the Poisson: $P(n_i|\lambda) = \frac{\lambda^{n_i} e^{-\lambda}}{n_i!}$ where $n_i$ represents the observed number of disasters of the year $i$ and each year is considered independent of the other i.e. the log-likelihood is just the sum over all the years of the log-likelihoods, while $\lambda$ represents the average rate of disasters per year. In general, in a switch-point model, you may choose whatever likelihood you consider more appropriate, and in this case the Poisson seems quite logical, as the events we are counting are independent (it seems reasonable to assume that each disaster is independent on the previous ones). As you pointed out, in this switch-point model, the average rates is $$\lambda = \begin{cases} \lambda_e \text{ if } t = \tau_s \\ \end{cases} $$ or, if you prefer, $$\lambda = \lambda_l \theta(t-\tau_s) + \lambda_e \theta(\tau_s-t) $$ I would not include $\lambda$ as a part of the likelihood, as it does not involve the data at all, but I'd rather consider it an intermediate random variable, since it's a function of the remaining priors only: $$ \lambda_e, \lambda_e \sim \exp(1) \\ \tau_s \sim \mathcal{U}(t_l, t_h) $$
