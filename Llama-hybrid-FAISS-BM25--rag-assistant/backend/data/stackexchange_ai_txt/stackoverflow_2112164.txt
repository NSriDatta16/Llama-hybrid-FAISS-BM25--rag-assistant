[site]: stackoverflow
[post_id]: 2112164
[parent_id]: 2109939
[tags]: 
This may be easier in a front end reporting/display application but for sql you need to perform a dynamic pivot. But since the columns are aliased by a sequential player number and the specific players vary by game you can't use the typcial dynamic sql examples. Here is one way to do it: sample data set ansi_warnings off set nocount on create table #t (Game varchar(20), Role varchar(15), [Name] varchar(20)) insert #t select 'VolleyBall', 'Coach', 'Sujatha' union all select 'VolleyBall', 'Player', 'Rajendran' union all select 'VolleyBall', 'Player', 'Juno' union all select 'VolleyBall', 'Player', 'Indira' union all select 'VolleyBall', 'Player', 'Ganesh' union all select 'VolleyBall', 'Player', 'Vasanth' union all select 'Tennis', 'Coach', 'Rajeshkumar' union all select 'Tennis', 'Player', 'Vivek' union all select 'Tennis', 'Player', 'Rubala' union all select 'Cricket', 'Coach', 'Gary' union all select 'Cricket', 'Player', 'Viru' union all select 'Cricket', 'Player', 'Gauti' union all select 'Cricket', 'Player', 'Sachin' union all select 'Cricket', 'Player', 'Mahi' union all select 'Cricket', 'Player', 'Yuvi' union all select 'Cricket', 'Player', 'Suresh' union all select 'Cricket', 'Player', 'Virat' union all select 'Cricket', 'Player', 'Bhajji' union all select 'Cricket', 'Player', 'Zaheer' union all select 'Cricket', 'Player', 'Ishant' union all select 'Cricket', 'Player', 'Ashish' create dynamic SELECT and PIVOT clauses and the EXEC'd statement declare @max int select top 1 @max = count(*) from #t where role = 'player' group by game order by count(*) desc declare @sel varchar(2000) ,@piv varchar(2000) ;with nos (n) as (select 1 union all select n+1 from nos where n OUTPUT: game coach player1 player2 player3 player4 player5 player6 player7 player8 player9 player10 player11 -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- -------------------- Cricket Gary Ashish Bhajji Gauti Ishant Mahi Sachin Suresh Virat Viru Yuvi Zaheer Tennis Rajeshkumar Rubala Vivek NULL NULL NULL NULL NULL NULL NULL NULL NULL VolleyBall Sujatha Ganesh Indira Juno Rajendran Vasanth NULL NULL NULL NULL NULL NULL
