[site]: stackoverflow
[post_id]: 5364996
[parent_id]: 5347653
[tags]: 
- (void)locationManager:(CLLocationManager *)manager didUpdateHeading:(CLHeading *)heading { int newHeading; int queuecount; newHeading = heading.trueHeading; [queue addObject:[NSNumber numberWithInt:newHeading]]; if([queue count] > 10) [queue removeObjectAtIndex:0]; queuecount = [queue count]; NSEnumerator *e = [queue objectEnumerator]; NSNumber *sum; int oldd = 0 , newd, average =0; BOOL firstLoop = YES; while ((sum = [e nextObject])) { newd = [sum intValue]; if(firstLoop) {oldd = newd;firstLoop=NO;} if((newd +180) oldd) { newd -=360;oldd = newd; average = average + newd; continue; } average = average + newd; oldd = newd; } average = (average / queuecount) % 360; [map setTransform:CGAffineTransformMakeRotation((-1 * average * M_PI) /180)]; }
