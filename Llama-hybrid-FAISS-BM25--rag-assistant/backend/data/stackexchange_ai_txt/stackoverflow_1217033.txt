[site]: stackoverflow
[post_id]: 1217033
[parent_id]: 
[tags]: 
Realloc Problem

Thank you for looking, please ignore - all sorts of shenanigans are happening and I am trying to debug more. ===================================== Can anyone explain this behavior of realloc? Output: before realloc start: testing%20encryp before realloc app: ' ' realloc size: 27 after realloc: testing%20e strlen(newstr): 11 newstr: testing%20e Code: char * strAppend(char * start, char * app) { int i=strlen(start); int j=0; printf("before realloc start: %s\n", start); printf("before realloc app: '%s'\n", app); printf("realloc size: %i\n", i+strlen(app)+1); char * newstr = realloc(start, sizeof(char) * (i + strlen(app) + 1)); printf("after realloc: %s\n", newstr); while(app[j] != '\0') newstr[i++] = app[j++]; printf("strlen(newstr): %i\n", strlen(newstr)); printf("newstr: %s\n", newstr); return newstr; } It's deleting "ncryp" from start after the realloc; but that's not supposed to happen.... Edit: More Code, More Output char * urlEncode(char * c) { #ifdef EBUG printf("urlEncode: Encoding '%s'\n", c); #endif int len = strlen(c)+1; char * ret = malloc(sizeof(char) * len); memset(ret, 0, len); int z=0; char * escapee = malloc(sizeof(char) * 4); escapee[0] = '%'; escapee[3] = '\0'; for(int i=0;i = len) { ret = strAppend(ret, " "); len += strlen(" "); } printf("z = %i len = %i ret = %s\n", z, len, ret); if ( (48 Last Edit: I have no idea what is going on at the moment. Different runs of the program with and without debug flags produce different output. I'm going back to the drawing board and looking for memory errors using valgrind.
