[site]: stackoverflow
[post_id]: 5070432
[parent_id]: 
[tags]: 
JavaScript: how to dynamically add a Flash file (SWF) to the DOM so IE will load it

I have pages that need to dynamically load content based upon their data description in XML files. Among the items that may be dynamically loaded are SWFs. I have code that correctly loads and starts the movies in Firefox via the http and file protocols and Chrome via the http protocol. I need it to successfully load in Internet Explorer in both http and file protocols as well, but all Flash Video Player reports is 'Movie not loaded...'. Could someone please review the following information and give me a fix? The description of Flash objects in the XML looks like this: I have JavaScript that parses this and creates an object that looks like the following JSON: { 'tag': 'multimedia', 'attributes': [ 'type': 'flash', 'swf': 'swf/filename_here.swf', 'width': '600', 'height': '400', 'version': '7.0.19.0' ] } Eventually, this object is passed to a function that creates the DOM element (yes, I know the function is ordered oddly; I was trying different things to make it work): var path = var path = document.location.href; path = path.substr(0, path.lastIndexOf('/') + 1); var version = null; function isIE() { return navigator.userAgent.lastIndexOf('Trident') > 0; } function buildFlash(element) { version = element.attributes.version; var name = document.createElement('param'); name.setAttribute('name', 'movie'); name.setAttribute('value', path + element.attributes.swf); (if (!isIE()) { var inner = document.createElement('object'); inner.setAttribute('type', 'application/x-shockwave-flash'); inner.setAttribute('data', path + element.attributes.swf); inner.setAttribute('width', element.attributes.width); inner.setAttribute('height', element.attributes.height); } var flash = document.createElement('object'); flash.setAttribute('id', 'flashMovie'); flash.setAttribute('classid', 'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'); flash.setAttribute('width', element.attributes.width); flash.setAttribute('height', element.attributes.height); flash.appendChild(name); if (!isIE()) { flash.appendChild('inner'); } var div = document.createElement('div'); div.setAttribute('id', 'multimedia'); div.appendChild('flash'); return div; } The resulting div is eventually added to the correct location in the page. Any ideas?
