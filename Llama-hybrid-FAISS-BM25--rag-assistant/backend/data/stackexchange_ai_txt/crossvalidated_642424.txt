[site]: crossvalidated
[post_id]: 642424
[parent_id]: 
[tags]: 
Covariance matrix of autoregressive process

I am learning about autoregressive processes and there is something that I find unclear about the structure of their covariance matrix. Some sources (e.g. Box and Jenkins, 2016) describe the autocovariance matrix of a stationary process $(z_1,z_2,...,z_n)$ as: \begin{equation} \Gamma_n=\begin{bmatrix} \gamma_0&\gamma_1&\gamma_2&\cdots&\gamma_{n-1}\\ \gamma_1&\gamma_0&\gamma_1&\cdots&\gamma_{n-2}\\ \gamma_2&\gamma_1&\gamma_0&\cdots&\gamma_{n-3}\\ \vdots&\vdots&\vdots&\cdots&\vdots\\ \gamma_{n-1}&\gamma_{n-2}&\gamma_{n-3}&\cdots&\gamma_0 \end{bmatrix}=\sigma^2_z\begin{bmatrix} 1&\rho_1&\rho_2&\cdots&\rho_{n-1}\\ \rho_1&1&\rho_1&\cdots&\rho_{n-2}\\ \rho_2&\rho_1&1&\cdots&\rho_{n-3}\\ \vdots&\vdots&\vdots&\cdots&\vdots\\ \rho_{n-1}&\rho_{n-2}&\rho_{n-3}&\cdots&1 \end{bmatrix}=\sigma^2_z\mathbf{P}_n \end{equation} where both the covariance and correlation matrices are constant along the diagonals. In order to estimate the autocovariance function for $\gamma_k$ we can use: \begin{equation} c_k=\hat\gamma_k=\frac{1}{N}\sum^{N-k}_{t=1}(z_t-\bar{z})(z_{t+k}-\bar{z})\qquad k=0,1,2,...,K \end{equation} where $\bar{z}$ is the sample mean of the series. The kth lag autocorrelation is then $\hat\rho_k=\frac{c_k}{c_0}$ . This should also hold for autoregressive processes of the type: \begin{equation} z_t=\theta_1z_{t-1}+\theta_2z_{t-2}+...+\theta_pz_{t-p}+\epsilon_t \end{equation} as long as they are stationary. However, sources that specifically treat autoregressive processes give a specific form for the covariance of the autoregressive process defined in terms of the regression parameters ( $\theta_k$ ), (e.g. van der Leeuw, 1992): \begin{equation} V=[P^TP-QQ^T]^{-1} \end{equation} where P is a TxT matrix taking the form \begin{equation} P=\begin{bmatrix} 1&0&0&\cdots&\cdots&\cdots&\cdots&0\\ \theta_1&1&0&\ddots&\ddots&\ddots&\ddots&0\\ \theta_2&\theta_1&1&0&\ddots&\ddots&\ddots&0\\ \vdots&\theta_2&\theta_1&1&0&\ddots&\ddots&0\\ \vdots&\vdots&\vdots&\vdots&\vdots&\vdots&\vdots&\vdots\\ \theta_p&\theta_{p-1}&\ddots&\theta_2&\theta_1&1&\cdots&0\\ \vdots&\theta_p&\theta_{p-1}&\ddots&\ddots&\ddots&1&0\\ 0&0&\theta_p&\theta_{p-1}&\ddots&\ddots&\cdots&1 \end{bmatrix} \end{equation} while Q is a (T-p)x(T-p) matrix taking the form: \begin{equation} Q=\begin{bmatrix} \theta_p&\theta_{p-1}&\cdots&\theta_1\\ 0&\theta_p&\cdots&\theta_2\\ 0&0&\ddots&\vdots\\ 0&0&\cdots&\theta_p\\ \vdots&\cdots&\cdots&0\\ 0&\cdots&\cdots&0\\ \end{bmatrix} \end{equation} The matrices are clearly computed differently, but are they related in some way? Can the first be regarded as the sample covariance matrix while the second as the theoretical covariance matrix, or are they describing two different quantities? References Box, Jenkins (2016). Time Series Analysis . Wiley. van der Leeuw (1992) "The covariance matrix of ARMA-errors in closed form". Journal of Econometrics .
