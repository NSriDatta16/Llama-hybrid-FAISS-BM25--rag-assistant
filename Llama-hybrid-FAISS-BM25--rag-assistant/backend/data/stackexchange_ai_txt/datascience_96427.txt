[site]: datascience
[post_id]: 96427
[parent_id]: 93018
[tags]: 
I suggest you play with the height parameter. According to your figure the peaks are easy to detect. You could use the most frequent value as offset for the height parameter, but I think you should play with those values. After you find the desired peaks, you can simply do a left and right search so that you calculate the average and replace it instead of the peak.
