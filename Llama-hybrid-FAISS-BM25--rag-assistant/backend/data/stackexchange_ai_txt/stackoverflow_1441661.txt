[site]: stackoverflow
[post_id]: 1441661
[parent_id]: 1441399
[tags]: 
If this is a table of sales transactions, then there should not be any rows in there for days on which there were no Sales. I.e., If ProductId 21 had no sales on 1 June, then this table should not have any rows with productId = 21 and day = '1 June'... Therefore you should not have to filter anything out - there should not be anything to filter out Select ProductId, Avg(Sales) AvgSales From Table Group By ProductId should work fine. So if it's not, then you have not explained the problem completely or accurately. Also, in yr question, you show Avg(Sales) in the example SQL query but then in the text you mention "average number of sales that each product ... " Do you want the average sales amount, or the average count of sales transactions? And do you want this average by Product alone (i.e., one output value reported for each product) or do you want the average per product per day ? If you want the average per product alone, for just thpse sales in the ten days prior to now? or the ten days prior to the date of the last sale for each product? If the latter then Select ProductId, Avg(Sales) AvgSales From Table T Where day > (Select Max(Day) - 10 From Table Where ProductId = T.ProductID) Group By ProductId If you want the average per product alone, for just those sales in the ten days with sales prior to the date of the last sale for each product, then Select ProductId, Avg(Sales) AvgSales From Table T Where (Select Count(Distinct day) From Table Where ProductId = T.ProductID And Day > T.Day)
