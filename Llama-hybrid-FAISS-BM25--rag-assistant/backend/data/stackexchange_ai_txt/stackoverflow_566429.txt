[site]: stackoverflow
[post_id]: 566429
[parent_id]: 566411
[tags]: 
Profile the code. I've no idea how one does that in PHP, but it's the only reasonable way to work out what's going on. Sometimes making code more elegant will have a detrimental effect on performance, but not usually to that extent. You need to work out where the time's going, and fix that bit.
