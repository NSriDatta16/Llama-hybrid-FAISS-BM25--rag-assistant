[site]: crossvalidated
[post_id]: 522046
[parent_id]: 
[tags]: 
I replicated ordered probit output (using a Stata dataset) with four R packages, compared it to Stata, unable to even come close to the Stata output

I was trying to reverse engineer the values of an unclear parameter by comparing R outcomes to Stata outcomes for an ordinal probit model ( link ). To my surprise I could not replicate the outcome (fake data set with 2000 observations). To be sure, I decided to replicate the ordinal probit models with a Stata dataset. As the results (below) show, the differences in output were not a coincidence. I provided all data and code for both Stata and R below Although I did not expect the results to be completely identical, they are off by quite some margin. Because of this, I have two questions: Is there an R package that is able to replicate the Stata results, so that I can reverse engineer the values that I am looking for? Can anyone shed any sort of light on these differences. What is it about these models that makes these differences so large and what does that say about any result from an ordinal model? References: https://www.stata.com/manuals14/roprobit.pdf NOTE: Everyone, please feel encouraged to check if there are any mistakes in my code that might explain the differences Replication In Stata, with oprobit : use http://www.stata-press.com/data/r14/fullauto oprobit rep77 foreign length mpg Iteration 0: log likelihood = -89.895098 Iteration 1: log likelihood = -78.106316 Iteration 2: log likelihood = -78.020086 Iteration 3: log likelihood = -78.020025 Iteration 4: log likelihood = -78.020025 Ordered probit regression Number of obs = 66 LR chi2(3) = 23.75 Prob > chi2 = 0.0000 Log likelihood = -78.020025 Pseudo R2 = 0.1321 ------------------------------------------------------------------------------ rep77 | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- foreign | 1.704861 .4246796 4.01 0.000 .8725037 2.537217 length | .0468675 .012648 3.71 0.000 .022078 .0716571 mpg | .1304559 .0378628 3.45 0.001 .0562463 .2046656 -------------+---------------------------------------------------------------- /cut1 | 10.1589 3.076754 4.128577 16.18923 /cut2 | 11.21003 3.107527 5.119389 17.30067 /cut3 | 12.54561 3.155233 6.361467 18.72975 /cut4 | 13.98059 3.218793 7.671874 20.28931 ------------------------------------------------------------------------------ In R , with polr from the MASS package: library(MASS) polr In R , with vglm from the VGAM package: library(VGAM) vglm |z|) (Intercept):1 -17.92738 5.47221 -3.276 0.001053 ** (Intercept):2 -19.86496 5.52892 -3.593 0.000327 *** (Intercept):3 -22.10321 5.63780 -3.921 8.84e-05 *** (Intercept):4 -24.69203 5.81757 -4.244 2.19e-05 *** foreign 2.89684 0.75766 3.823 0.000132 *** length 0.08283 0.02252 3.677 0.000236 *** mpg 0.23076 0.06805 3.391 0.000696 *** --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Names of linear predictors: logitlink(P[Y>=2]), logitlink(P[Y>=3]), logitlink(P[Y>=4]), logitlink(P[Y>=5]) Residual deviance: 156.5014 on 257 degrees of freedom Log-likelihood: -78.2507 on 257 degrees of freedom Number of Fisher scoring iterations: 6 No Hauck-Donner effect found in any of the estimates Exponentiated coefficients: foreign length mpg 18.116799 1.086354 1.259563 In R , with clm from the ordinal package: clm |z|) foreign 2.89681 0.79064 3.664 0.000248 *** length 0.08283 0.02272 3.646 0.000267 *** mpg 0.23077 0.07045 3.275 0.001055 ** --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Threshold coefficients: Estimate Std. Error z value 1|2 17.927 5.551 3.229 2|3 19.865 5.596 3.550 3|4 22.103 5.709 3.872 4|5 24.692 5.891 4.192 (8 observations deleted due to missingness) In R , with orm from the rms package: library(rms) orm DATA for R fullauto
