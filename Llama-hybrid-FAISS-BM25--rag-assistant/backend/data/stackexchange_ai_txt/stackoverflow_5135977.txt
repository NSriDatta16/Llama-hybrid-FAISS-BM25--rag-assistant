[site]: stackoverflow
[post_id]: 5135977
[parent_id]: 
[tags]: 
R - nonlinear filter to a time series - filter, lapply or loop?

I have a vector containing simple time series data (extracted from a deSolve matrix), which for testing purposes can be: x and would like to apply the nonlinear filter x[n]*x[n]-x[n-1]*x[n+1] to all elements of the vector except the first and last elements because the filter can't be applied to these two elements (e.g., when the x[n-1] term meets the first element or the x[n+1] term meets the last element). Therein lies my problem. Things I've tried: 1) The filter() command expects a linear filter (i.e., without multiplication of filter coefficients). 2) lapply() requires that the function applies to all elements of the list. Is a loop the only alternative? Thanks for your help, Carey
