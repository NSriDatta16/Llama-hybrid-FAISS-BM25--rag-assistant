[site]: stackoverflow
[post_id]: 3939235
[parent_id]: 3938669
[tags]: 
try this where sDFSPath is the path you want to query and sHostServer is the Server you want to query your WMI, this can be any of the two servers you mentioned above. You can even make a more elegant code when it fails on first server then query WMI on the next servers public static ArrayList GetActiveServers(string sDFSPath, string sHostServer) { ArrayList sHostNames = new ArrayList(); ManagementPath oManagementPath = new ManagementPath(); oManagementPath.Server = sHostServer; oManagementPath.NamespacePath = @"root\cimv2"; oManagementScope = new ManagementScope(oManagementPath); oManagementScope.Connect(); SelectQuery oSelectQuery = new SelectQuery(); oSelectQuery.QueryString = @"SELECT * FROM Win32_DfsTarget WHERE LinkName LIKE '%" + sDFSPath.Replace("\\", "\\\\") + "%' and State = 1"; ManagementObjectSearcher oObjectSearcher = new ManagementObjectSearcher(oManagementScope, oSelectQuery); ManagementObjectCollection oObjectCollection = oObjectSearcher.Get(); if (oObjectCollection.Count != 0) { foreach (ManagementObject oItem in oObjectCollection) { sHostNames.Add(oItem.Properties["ServerName"].Value.ToString()); } } return sHostNames; } Hope it makes sense
