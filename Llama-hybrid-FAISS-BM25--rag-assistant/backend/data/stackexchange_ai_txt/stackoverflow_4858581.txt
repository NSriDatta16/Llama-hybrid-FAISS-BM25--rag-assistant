[site]: stackoverflow
[post_id]: 4858581
[parent_id]: 4345643
[tags]: 
I'm afraid I'm not an expert on how Dragging and Dropping files actually works. So I can't go through your code an figure out what's wrong. What I can do is give you the code that I use. It works for me now under Delphi 2009 on XP, Vista and Windows 7. It also worked when I was previously using Delphi 4 on Windows 98 and Windows XP. Maybe you can figure out what's wrong in your code using this, or you might want to try using or adapting this code. It is originally from the book: "Delphi 3 - User Interface Design", pages 169 - 171. If I've left out an important routine, let me know in a comment and I'll edit my answer to include it. type TMainForm = class(TForm) procedure WMDropFiles(var WinMsg: TMessage); message wm_DropFiles; procedure AppMessageHandler(var Msg: TMsg; var Handled: Boolean); procedure TMainForm.FormShow(Sender: TObject); begin DragAcceptFiles(Handle, true); Application.OnMessage := AppMessageHandler; end; procedure TLogoAppForm.WMDropFiles(var WinMsg: TMessage); const BufSize = 255; var TempStr : array[0..BufSize] of Char; NumDroppedFiles, I: integer; Filenames: TStringList; begin NumDroppedFiles := DragQueryFile(TWMDropFiles(WinMsg).Drop, $ffffffff, nil, 0); if NumDroppedFiles >= 1 then begin Filenames := TStringList.Create; for I := 0 to NumDroppedFiles - 1 do begin DragQueryFile(TWMDropFiles(WinMsg).Drop, I, TempStr, BufSize); Filenames.Add(TempStr); end; OpenFiles(Filenames, ''); Filenames.Free; end; DragFinish(TWMDropFiles(WinMsg).Drop); WinMsg.Result := 0; end; procedure TLogoAppForm.AppMessageHandler(var Msg: TMsg; var Handled: Boolean); begin if (Msg.Message = WM_DropFiles) and IsIconic(Application.Handle) then begin Perform(Msg.Message, Msg.Wparam, Msg.lParam); Handled := true; end end;
