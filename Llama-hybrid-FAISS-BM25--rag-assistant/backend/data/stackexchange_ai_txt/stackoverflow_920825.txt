[site]: stackoverflow
[post_id]: 920825
[parent_id]: 920776
[tags]: 
WITh cal(year) AS ( SELECT 1 AS current_year UNION ALL SELECT year + 1 FROM cal WHERE year year ORDER BY yield_year ASC ) ELSE yield_value END FROM cal LEFT JOIN yield ON yield_year = year For missing years this query takes the average of closest years found.
