[site]: stackoverflow
[post_id]: 1525000
[parent_id]: 
[tags]: 
Sending email with recordset data

I've got a classic ASP page listing some properties from a database and with each property there is a small contact form - to enable a user to 'request a callback' from the property agent associated with that property. However, whichever form I complete - the email to the agent always includes details of the first property on the page, rather than the property that the person is requesting a callback for. This is the code I have on the listings page (along with the contact form); "") Then Response.Write(" Form Submitted ") %> 0) AND (NOT rspropertyresults.EOF)) %> "" Then %> PCM "" AND (rspropertyresults.Fields.Item("ContentDetails").Value) <> " " Then %> " title="Request Callback" href="#">Request Callback "> Request a callback Name Email Telephone I also have a docallback.asp page that handles the email sending; body,p,td{font-family:arial;font-size:12px;} " mBody = mBody & " A tenant has requested a call back for further information regarding the following property: " If (rspropertyresults.Fields.Item("ContentHouseNo").Value) <> "" Then varFullAddress = (rspropertyresults.Fields.Item("ContentHouseNo").Value) & " " End If varFullAddress = varFullAddress & (rspropertyresults.Fields.Item("ContentStreet").Value) If (rspropertyresults.Fields.Item("ContentStreet2").Value) <> "" Then varFullAddress = varFullAddress & " " & (rspropertyresults.Fields.Item("ContentStreet2").Value) End If If (rspropertyresults.Fields.Item("ContentTown").Value) <> "" Then varFullAddress = varFullAddress & " " & (rspropertyresults.Fields.Item("ContentTown").Value) End If If (rspropertyresults.Fields.Item("ContentArea").Value) <> "" Then varFullAddress = varFullAddress & " " & (rspropertyresults.Fields.Item("ContentArea").Value) End If varFullAddress = varFullAddress & " " & (rspropertyresults.Fields.Item("ContentPostCode").Value) mBody = mBody & " " & varFullAddress & " " mBody = mBody & " Their details are: " If request.Form("fldName") <> "" Then mBody = mBody & " Name: " & request.Form("fldName") & " " End If If request.Form("fldTelephone") <> "" Then mBody = mBody & "Telephone: " & request.Form("fldTelephone") & " " End If If request.Form("fldEmail") <> "" Then mBody = mBody & "Email: " & request.Form("fldEmail") & " " End If mBody = mBody & " " & " " & "http://www."& varSiteDomain & " " & " " mBody = mBody & " " strMSSchema = "http://schemas.microsoft.com/cdo/configuration/" Set oCdoConfg = Server.CreateObject("CDO.Configuration") oCdoConfg.Fields.Item(strMSSchema & "sendusing") = 1 oCdoConfg.Fields.Item(strMSSchema & "smtpserver") = "" oCdoConfg.Fields.Item(strMSSchema & "sendusername") = "" oCdoConfg.Fields.Item(strMSSchema & "sendpassword") = "" oCdoConfg.Fields.Update set oCdoMsg = server.createobject("CDO.Message") oCdoMsg.to = "" oCdoMsg.bcc = "" oCdoMsg.from = "" oCdoMsg.Subject = "A tenant has requested a callback about one of your properties" oCdoMsg.HTMLbody = mBody Set oCdoMsg.Configuration = oCdoConfg oCdoMsg.send set oCdoMsg = nothing set oCdoConfg = nothing response.Redirect("default.asp") %> I wondered if anyone might be able to spot why the email is not sending the specific property details in the email? Apologies for the rather lengthy code. Thank you.
