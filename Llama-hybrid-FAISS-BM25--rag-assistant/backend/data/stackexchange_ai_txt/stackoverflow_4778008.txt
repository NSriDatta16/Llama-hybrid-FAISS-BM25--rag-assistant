[site]: stackoverflow
[post_id]: 4778008
[parent_id]: 
[tags]: 
Implementing OpenID consumer details

For OpenID smart mode, the specification uses a Diffie-Hellman key exchange. I'm wondering if the public and private keys can be reused (assuming they aren't compromised), or if they should be generated for every request. I'm using PHP's OpenSSL library (my code: $key = openssl_pkey_new(array('private_key_type' => OPENSSL_KEYTYPE_DH)); ) to generate keys, and it's terribly slow (22 seconds on average to generate a key--very unacceptable for a website). If keys can't be reused, is there any faster way I can generate keys using OpenSSL? I'd rather not do it by hand due to dependencies on math libraries, etc. EDIT: To be clear, I am looking for two things in an answer: Can I reuse Diffie-Hellman keys in OpenID association mode, and if not, is there a faster way to generate keys using OpenSSL than openssl_pkey_new() , since that is taking an exceptionally long time.
