[site]: stackoverflow
[post_id]: 1593011
[parent_id]: 
[tags]: 
DLL self-registration: how to register just for the current user?

I'm using Visual C++. I'd like to really only have the DLL registered for the current user, even if the users is an administrator. For that reason, I changed all of the project.rgs references to HKCR. But, using Process Monitor while using regsvr32 to register the DLL, I notice that it still tries to create HKCR\TypeLib\{ ... } . This happens on the call to CComModule::RegisterServer() . Is this inherent of CComModule ? Is there anything I'm missing, in terms of configuration of Visual C++? I know that I can use RegOverridePredefKey , but I don't want to load more DLLs, and it's not a very elegant solution.
