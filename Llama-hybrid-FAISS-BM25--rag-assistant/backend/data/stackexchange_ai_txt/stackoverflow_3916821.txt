[site]: stackoverflow
[post_id]: 3916821
[parent_id]: 3916701
[tags]: 
Took the liberty of aliasing the tables for readability: SELECT ap.USERMASTERID, ap.GROUPID, ap.VISIBLE, ap.APPLICATIONID FROM dbo.GROUP g RIGHT OUTER JOIN dbo.APPLICATIONS_PERMISSION ap ON g.ID = ap.GROUPID FULL OUTER JOIN dbo.USER_MASTER um ON ap.USERMASTERID = um.ID AND g.ID = um.GROUPID WHERE (um.ID = 7) AND (ap.APPLICATIONID = 3) If I understand correctly, sounds like we want to return a list of users who either have direct permission on the app, or who are members of a group with permission on the app. Let's simplify it by doing those two queries separately: --Direct permission SELECT ap.USERMASTERID, NULL AS 'GROUPID', ap.VISIBLE, ap.APPLICATIONID FROM dbo.APPLICATIONS_PERMISSION ap INNER JOIN dbo.USER_MASTER um ON ap.USERMASTERID = um.ID WHERE (ap.USERMASTERID = 7) AND (ap.APPLICATIONID = 3) UNION ALL --Permission through group membership SELECT ap.USERMASTERID, ap.GROUPID, ap.VISIBLE, ap.APPLICATIONID FROM dbo.APPLICATIONS_PERMISSION ap INNER JOIN dbo.Group g ON ON g.ID = ap.GROUPID INNER JOIN dbo.USER_MASTER um ON g.USERMASTERID = um.ID WHERE (um.ID = 7) AND (ap.APPLICATIONID = 3) Might have to play with that a little to get exactly what you need, but I would say: do them separately. Might not even need the join to the User_Master table, since it doesn't look like you're actually retrieving any fields from it. Just filter from ap.UserMasterID or g.UserMasterID.
