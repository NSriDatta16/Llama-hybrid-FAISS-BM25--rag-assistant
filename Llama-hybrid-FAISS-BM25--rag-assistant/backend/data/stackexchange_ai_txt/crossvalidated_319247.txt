[site]: crossvalidated
[post_id]: 319247
[parent_id]: 
[tags]: 
Bayesian modeling of 2x2 factorial design. Am I doing it right?

I have a 2x2 factorial design with factors task (a, b) and stimulus type (c, d). I'm looking at behavioral data and was wondering how to test the main effect of task. To be more specific, I want to know if $a>b$. The data I have are counts (correct button presses), so using a binomial regression would make sense here (correct me if I'm wrong). Essentially I thought of doing it in two different ways. One is to use a contrast to test the difference in task. For this I model each possible combination of factors, giving me four different Bionmial regression models, such as this one: $$n_{hits,i} \sim Binomial(n_i, p_i)$$ $$\mbox{logit}(p_i) = \alpha$$ $$\alpha \sim N(0, 10).$$ I then end up with four posterior distributions for $\alpha$ with these combinations: ac, ad, bc, bd. I then proceed in calculating the contrast using a deterministic distribution: $$diff = (\alpha_{ab}+\alpha_{ac})-(\alpha_{bc}+\alpha_{bd}).$$ The second way I thought of modeling it is to use a linear regression: $$n_{hits,i} \sim Binomial(n_i, p_i)$$ $$\mbox{logit}(p_i) = \alpha + \beta_{ab}\cdot x_{ab} + \beta_{cd}\cdot x_{cd}$$ $$\alpha \sim N(0, 10)$$ $$\beta_{ab} = \beta_{cd} \sim N(0, 10).$$ Now I also think there is an interaction, but before going there I want to know if I'm modeling this the right way. If looking at the main effect of task, which parameter estimates do I look at, $\beta_{ab}$? Going further, I need to calculate the difference in probability between a and b. I took the traces from the NUTS sampler and calculated the difference in probability between $\alpha + \beta_{ab}$ and $\alpha$. Or should I also include the second level: $\alpha + \beta_{ab} + \beta_{cd}$ vs $\alpha + \beta_{cd}$? The two different approaches give me different results. The contrast approach gives me a distribution (median with 95% probability interval): 2.5% 0.026857 50% 0.045664 97.5% 0.064639 While the second approach gives me for the first difference: 2.5% -0.000202 50% 0.025890 97.5% 0.051782 and for the second difference: 2.5% -0.000140 50% 0.018837 97.5% 0.037980 Why do I get two different answers? Which one is right? I'm implementing all this using pymc3, if anybody cares.
