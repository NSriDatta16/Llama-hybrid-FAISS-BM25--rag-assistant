[site]: stackoverflow
[post_id]: 1111662
[parent_id]: 1110077
[tags]: 
So the cells in each row are actually the children of the cells in the previous row where the "pos" value of the child cell is >= the "pos" value of the parent cell and If you're hell-bent on using XSL for this then take a look at the following-sibling axis. However, it's going to be one messy selection path. Probably easier to do two transforms: one that organizes the flat data into a hierarchical format, and one that produces the final output. Personally, I think I'd write a program that explicitly processes the DOM tree, particularly if this is a one-off operation. I suspect that it would be just as fast to write, and not have the chance for strange corner cases in the selection logic.
