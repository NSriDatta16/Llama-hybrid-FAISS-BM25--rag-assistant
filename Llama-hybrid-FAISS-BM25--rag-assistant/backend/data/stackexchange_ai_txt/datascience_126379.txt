[site]: datascience
[post_id]: 126379
[parent_id]: 126377
[tags]: 
You want to reshape your forecast file. You could use Miller and run mlr --csv cat -n then \ put '$n=$n-1;$n="windSpeed_".string($n)."h"' then \ reshape -s n,windSpeed_mph then \ unsparsify input.csv > output.csv to get +---------------------------+--------------+--------------+--------------+--------------+ | timestamp | windSpeed_0h | windSpeed_1h | windSpeed_2h | windSpeed_3h | +---------------------------+--------------+--------------+--------------+--------------+ | 2023-11-14 15:00:00-05:00 | 10 | | | | | 2023-11-14 16:00:00-05:00 | | 11 | | | | 2023-11-14 17:00:00-05:00 | | | 12 | | | 2023-11-14 18:00:00-05:00 | | | | 13 | +---------------------------+--------------+--------------+--------------+--------------+ Some notes: cat -n to add a field with a progressive id counter (1 based) put '$n=$n-1;$n="windSpeed_".string($n)."h"' to transform to zero-based, and create your desired field name reshape -s n,windSpeed_mph to apply the reshape you want But please pay attention to @j-h answer .
