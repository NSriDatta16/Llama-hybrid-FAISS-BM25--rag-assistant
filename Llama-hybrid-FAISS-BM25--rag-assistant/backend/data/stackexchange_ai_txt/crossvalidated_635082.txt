[site]: crossvalidated
[post_id]: 635082
[parent_id]: 
[tags]: 
repeated measures within participant in lme4

I'm trying to learn linear mixed effects models and how to estimate them using the R package lme4 and I am confused about some aspects. I have a dataset where a number of participants completed 6 trials for each condition in a 2 × 2 factorial design ( factor1 and factor2 ). I want to model intercept, slope, and interaction between factors as random effects. Following the software paper by Bates et al. (2015) for the lme4 package and using their example as a starting point, I came up with this model: response ~ 1 + factor1 * factor2 + (1 + factor1 * factor2 | participant) What I'm unclear about is how to account for the repeated-measures character of the responses; within participant, responses for different conditions may be correlated across trials. There is no trial variable, just 6 different observations for each condition and participant. E.g. for participant 1: Question: Do I have to add something to my model to account for the correlation within participant between conditions across trials, and if yes, what? Adding to my confusion, the conditional model in Eq. (2), i.e. within-participant in my application, $$ (\mathcal{Y} | \mathcal{B} = b) \mathrel{\sim} \mathcal{N} \left( X \beta + Z b, \sigma^2 W^{-1} \right) $$ includes a covariance matrix $\sigma^2 W^{-1}$ , but the description says that $W$ is diagonal, i.e. it assumes observations within participant are uncorrelated. In principle, the example analysis of sleepstudy in the paper has a similar problem: The reaction time measurements form a time series across days. However, in that case there is only one time series per subject, so there is no way to estimate these correlations (at least not without further assumptions like an AR process) – so I guess they don't need to be modeled?
