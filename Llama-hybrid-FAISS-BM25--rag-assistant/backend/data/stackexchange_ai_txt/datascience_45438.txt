[site]: datascience
[post_id]: 45438
[parent_id]: 
[tags]: 
could not broadcast input array from shape (2,3) into shape (3) while using timestamp to build neural network in python

Here I want predict value every 60 minutes. So I have data 540 with three inputs. so I wrote an code with time steps and it gave me this error. Can anyone help me to solve this problem? my code : y=data['y1'].astype(int) cols=['x1', 'x2', 'x3'] x=data[cols].astype(int) n = x.shape[0] p = x.shape[1] x = x.values y = y.values train_start = 0 train_end = int(np.floor(0.8*n)) test_start = train_end+1 test_end = n x_train = x[np.arange(train_start, train_end), :] x_test = x[np.arange(test_start, test_end), :] y_train = y[np.arange(train_start, train_end), :] y_test = y[np.arange(test_start, test_end), :] x_train=x_train.reshape(x_train.shape +(1,)) x_test=x_test.reshape(x_test.shape + (1,)) num_time_steps = 9 num_features = x.shape[1] x_train = np.zeros((x_train.shape[0] - num_time_steps + 1, num_time_steps, num_features), dtype="float32") x_test = np.zeros((x_test.shape[0] - num_time_steps + 1, num_time_steps, num_features), dtype="float32") for i in range(len(x_train)): for timestep in range(num_time_steps): x_train[i][timestep] = x_train[i + timestep] for i in range(len(x_test)): for timestep in range(num_time_steps): x_test[i][timestep] = x_test[i + timestep] y_train = y_train[num_time_steps - 1:] y_test = y_test[num_time_steps - 1:] change code: train_end = 80 x_train=x[0: train_end ,] x_test=x[train_end +1: ,] y_train=y[0: train_end] y_test=y[train_end +1:] x_train=x_train.reshape(x_train.shape +(1,)) x_test=x_test.reshape(x_test.shape + (1,)) num_time_steps = 9 num_features = x.shape[1] x_train_n = np.zeros((x_train.shape[0] - num_time_steps + 1, num_time_steps, num_features), dtype="float32") x_test_n = np.zeros((x_test.shape[0] - num_time_steps + 1, num_time_steps, num_features), dtype="float32") for i in range(len(x_train_n)): for timestep in range(num_time_steps): x_train_n[i][timestep] = x_train[i + timestep] for i in range(len(x_test_n)): for timestep in range(num_time_steps): x_test_n[i][timestep] = x_test[i+timestep] y_train_n = y_train[num_time_steps - 1:] y_test_n = y_test[num_time_steps - 1:] Error,
