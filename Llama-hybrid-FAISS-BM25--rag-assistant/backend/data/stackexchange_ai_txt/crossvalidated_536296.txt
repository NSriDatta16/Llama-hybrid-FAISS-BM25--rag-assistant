[site]: crossvalidated
[post_id]: 536296
[parent_id]: 
[tags]: 
Increasing the speed of `lme` in the package `nlme`, or, equivalent code in `lme4`

I want to evaluate a dataset with linear mixed effects. Usually I am a Mathematica user, which doesn't have support for this, so I am using R within Mathematica using RLink . I've managed to get good results using nlme with the lme function: MyDataFrame=data.frame(x=x, PopulationLabel=factor(PopulationLabel)); library(nlme); results = lme( x~1, data=MyDataFrame, random=~1|PopulationLabel, weights=varIdent(form = ~1|PopulationLabel), method = 'REML', control = lmeControl(opt = 'optim', maxIter = 1000, msMaxIter = 1000) ); summary(results)$tTable Here y is the data point and pop is the grouping label. The issue I am running into is when I have 200 groupings or more (in a dataset with roughly 3500 data points in total) is computation time, here is a plot with computation time as a function of the number of groupings: Now I realise with a large number of groupings I should expect to pay for this in computation time, but I have a large number of these sets to evaluate -- so I would like to optimise if possible. But I understand that the only course of action may be to run the code overnight or over a weekend, or to parallelise as much as possible. I have read that nlme is an older package and that lme4 may be better optimised, however I am not an experience R user so I am struggling with the syntax. Can anyone show me how to write the equivalent of the code above in lme4 , or, if anyone knows any other packages that may do what I want faster -- I would be very grateful! Further information I had a question in the comments about the nature of my problem. I am looking at time series data which are normally distributed, but the mean and variance may change at random points, for example: This is a simulated dataset, so I know where the changes occur, in this particular example the changes in local population means is very small so a weighted mean is probably enough, but I want to compare a weighted mean approach to a linear mixed effects approach -- hence my use of lme from nlme . I am using change-point analysis on real data to group the data. Here is a data sample which has been grouped using a change-point analysis: https://pastebin.com/B8uyt7sj With my current nlme code this would take between 6-10 minutes to evaluate.
