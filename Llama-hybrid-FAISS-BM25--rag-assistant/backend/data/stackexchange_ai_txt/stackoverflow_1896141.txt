[site]: stackoverflow
[post_id]: 1896141
[parent_id]: 1895164
[tags]: 
The code as published doesn't look like it should give the error described unless you inadvertently feed it an array. You might want to look at the divmod() function, which could clean up the inner loop somewhat. And you're going to perform a lot of unnecessary integer divisions should your smallest prime factor be large. It's not the answer you're looking for, but a particularly elegant Ruby prime factor solution can be found here
