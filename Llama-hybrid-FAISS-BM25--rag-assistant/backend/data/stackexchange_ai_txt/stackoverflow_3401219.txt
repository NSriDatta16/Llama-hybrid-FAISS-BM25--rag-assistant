[site]: stackoverflow
[post_id]: 3401219
[parent_id]: 
[tags]: 
Fun with sessions

I've a problem that annoy me very much. It's because I'm trying to make a PHP login script. But when I log in correctly, it'll not let me in. If I comment out some lines (I'll mark them), the script works, but that's the code I was planning to use to check in on every page, so people don't can come in if they don't should have access. Below, I've posted the code. index.php header("Log ind",0); $login = new login; $login->showLogin(); $functions->footer(); ?> /functions/functions.php - Hansens Opskrifter Hansens Opskrifter /functions/mysql.php mysqlconnect(); } function mysqlconnect() { $conn = mysql_connect("localhost","user","pass"); if(!$conn) { die("Noget gik galt - kontakt Kristoffer og vis ham den følgende meddelelse: " . mysql_error()); } if(!mysql_select_db("db",$conn)) { die("Noget gik galt - kontakt Kristoffer og vis ham den følgende meddelelse: " . mysql_error()); } } function mysqlquery($query) { $result = mysql_query($query); if($result) { return $result; } } } ?> login.php doLogin($name,$pass); if($l == TRUE) { header("Location: http://hansensopskrifter.co.cc/loggedin.php"); } else { exit; } ?> /functions/login.php Log ind Navn: Kode: Glemt kode? header("Intet navn indtastet",0); echo "Du glemte at indtaste dit navn."; $this->showLogin(); $functions->footer(); return false; } elseif(!$pass) { $functions = new functions; $functions->header("Ingen adgangskode indtastet",0); echo "Du glemte at indtaste din adgangskode."; $this->showLogin(); $functions->footer(); } $query = "SELECT `id`, `navn`, `kode` FROM `users` WHERE `navn` = '".$n."' "; $result = $mysql->mysqlquery($query); while($row = mysql_fetch_assoc($result)) { $k = sha1($pass); $navn = $row['navn']; $kode = $row['kode']; $n = ucfirst(strtolower($n)); if($navn == $n && $kode == $k) { $_SESSION['id'] = $row['id']; $_SESSION['navn'] = $row['navn']; return true; } else { $functions = new functions; $functions->header("Forkert navn eller kode",0); echo "Det indtastede navn eller kode er forkert."; $this->showLogin(); $functions->footer(); return false; } } } } ?> loggedin.php header("Logger ind..."); ?> Du er nu logget ind. Du vil automatisk blive viderestillet om omkring 5 sekunder. Hvis du er tr&aelig;t af at vente kan du klikke her . footer(); ?> I've tried a lot of things, and now, I just hope you can help me. I've checked that there is a cookie that's created called PHPSESSID on my computer. Thank you very much in advance.
