[site]: stackoverflow
[post_id]: 4119183
[parent_id]: 4119035
[tags]: 
You might want to look at DeviceIoControl and IOCTL_STORAGE_QUERY_PROPERTY . For example, you can tell if a device is USB by specifying StorageDeviceProperty and looking at the BusType member. The "device type" member is also interesting. If you don't mind forgoing XP support, there is the Virtual Disk Service which I believe provides this sort of information.
