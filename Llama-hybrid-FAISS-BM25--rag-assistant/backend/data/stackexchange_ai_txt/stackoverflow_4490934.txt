[site]: stackoverflow
[post_id]: 4490934
[parent_id]: 4490216
[tags]: 
It looks like excel is evaluating the formula in a strange way, hence why you are seeing #VALUE! . To see why the formula is failing, click on the formula cell and then go to Tools > Formula Auditing > Evaluate Formula . You will see that the steps are: AVERAGE(Output!D1:Output!D5) =AVERAGE(5:Output!D5) =AVERAGE(5:1) =AVERAGE(#VALUE!) =#VALUE! But when you execute F2+Enter on the cell, you will see that Excel changes its execution plan and gets the right answer. I'm afraid the only thing I can think of to fix this is to use a comma-separated list, instead of a range: Formula formula = new Formula(3,5, "AVERAGE(Output!D1,Output!D2,Output!D3,Output!D4,Output!D5)");
