[site]: crossvalidated
[post_id]: 474698
[parent_id]: 410468
[tags]: 
A few observations on Stephan Kolassa's answer: Computing the incremental averages as follows is more numerically robust in practice: $$ \bar{x}_{n+1} = \bar{x}_{n} + \frac{x_{n+1} - \bar{x}_{n}}{n+1} $$ $$ \bar{y}_{n+1} = \bar{y}_{n} + \frac{y_{n+1} - \bar{y}_{n}}{n+1} $$ Note how this formulation avoids (potentially) large products such as $n\bar{x}_{n}$ . $$ \\ $$ Then there's a small error in the first factors of $N_{n+1}$ , $D_{n+1}$ and $E_{n+1}$ : $$ N_{n+1} = N_{n} + (x_{n+1} - \bar{x}_{n})(y_{n+1} - \bar{y}_{n+1}) $$ $$ D_{n+1} = D_{n} + (x_{n+1} - \bar{x}_{n})(x_{n+1} - \bar{x}_{n+1}) $$ $$ E_{n+1} = E_{n} + (y_{n+1} - \bar{y}_{n})(y_{n+1} - \bar{y}_{n+1}) $$ Note the $\bar{x}_n$ (and $\bar{y}_{n}$ ) in the first factor, instead of $\bar{x}_{n+1}$ (and $\bar{y}_{n+1}$ ). When there's not much variance in the data series, $\bar{x}_n$ and $\bar{x}_{n+1}$ tend to be nearly identical, so it wouldn't matter much. However, for all other scenarios, the difference can be substantial. Some useful references: https://jonisalonen.com/2013/deriving-welfords-method-for-computing-variance/ https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Online
