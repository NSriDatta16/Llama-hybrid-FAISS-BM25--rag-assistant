[site]: crossvalidated
[post_id]: 191540
[parent_id]: 
[tags]: 
Likelihood for dependent data above a threshold

Let $(Y_t)$ a real-valued stationary Markov chain and $u$ some positive threshold. We assume that for $y>u$, $$Y_{t+1}|\{Y_t=y\}\sim\mathcal{N}(\alpha y+\mu y^\beta,\sigma^2 y^{2\beta})$$ I want to find the maximum likelihood estimator of $(\alpha,\beta,\mu,\sigma)$, but I'm not sure how I should write the likelihood function, since my data are not independent, but they're not a Markov chain either (there are only some clusters of observations above the threshold). What I did in R: Yt=Y[1:(length(X)-1)] Yt1=Y[2:length(X)] ind=which(Yt>u) LL=function(alpha,beta,mu,sig){ R=dnorm(Yt1[ind],mean=alpha*Yt[ind]+mu*Yt[ind]^beta,sd = sig^2*Yt[ind]^(2*beta)) -sum(log(R)) } estim_ml=mle(minuslogl = LL,start = list(alpha=0.7,beta=0.5,mu=0,sig=1)) It works and it gives me estimates that are not absurd, but I think this is not correct as it's just the product of densities, just like independent data. Is there a way to find the likelihood function? If not, is what I did a good approximation?
