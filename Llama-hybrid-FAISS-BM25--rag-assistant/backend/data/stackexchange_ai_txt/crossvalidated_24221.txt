[site]: crossvalidated
[post_id]: 24221
[parent_id]: 
[tags]: 
Mahalanobis distance via PCA when $n<p$

I have an $n\times p$ matrix, where $p$ is the number of genes and $n$ is the number of patients. Anyone whose worked with such data knows that $p$ is always larger than $n$. Using feature selection I have gotten $p$ down to a more reasonable number, however $p$ is still greater than $n$. I would like to compute the similarity of the patients based on their genetic profiles; I could use the euclidean distance, however Mahalanobis seems more appropriate as it accounts for the correlation among the variables. The problem (as noted in this post ) is that Mahalanobis distance, specifically the covariance matrix, doesn't work when $n Error in solve.default(cov, ...) : system is computationally singular: reciprocal condition number = 2.81408e-21 So far to try solve this, I've used PCA and instead of using genes, I use components and this seems to allow me to compute the Mahalanobis distance; 5 components represent about 80% of the variance, so now $n > p$. My questions are: Can I use PCA to meaningfully get the Mahalanobis distance between patients, or is it inappropriate? Are there alternative distance metrics that work when $n
