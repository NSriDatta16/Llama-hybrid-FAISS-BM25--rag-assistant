[site]: stackoverflow
[post_id]: 370837
[parent_id]: 
[tags]: 
Why does my application allow me to save files to the Windows and System32 folders in Vista?

I have an application written in Delphi 7 which does not require an admin privilages to run. For some reason I am able to save files to c:\windows and c:\windows\system32 from within the application even though the application has not requested UAC elevation . I am logged in as an admin with UAC turned on and I haven't changed any of the default UAC settings. The files actually show up under Windows Explorer as well. I am not using the 'Run as Administrator' option. If I try to do the same thing using WordPad under the same profile I get an error as expected. Any ideas what is going on? Th application is using Ole Structured Storage to save and includes the following manifest, if that helps. Edit: To be clear my application does not save anything to these locations by default. I am choosing these locations via the standard file save dialog. Update I have found out why my application was being treated as legacy despite including the above manifest. It turns out a 2nd manifest was also being included which did not have the 'trustInfo' section. I have removed this 2nd manifest and all is well now. Thanks for all the help
