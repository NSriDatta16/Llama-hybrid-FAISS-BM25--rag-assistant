[site]: stackoverflow
[post_id]: 4323130
[parent_id]: 
[tags]: 
Login to web page using HttpWebRequest

I am trying to login to the website below using HttpWebRequest. I am passing in the username and password using the Credentials property but keep getting back the Login page of the website. Can anyone explain what I am doing wrong. https://oyster.tfl.gov.uk/oyster/entry.do (Login Page) HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(Url); request.ContentType = "application/x-www-form-urlencoded"; request.Credentials = new NetworkCredential(Username, Password); request.Method = "POST"; request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"; request.Headers.Add("Accept-Language: en-us,en;q=0.5"); request.Headers.Add("Accept-Encoding: gzip,deflate"); request.Headers.Add("Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7"); request.KeepAlive = true; request.Headers.Add("Keep-Alive: 300"); request.Referer = Url; request.UserAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.0.3705;)"; HttpWebResponse response = (HttpWebResponse)request.GetResponse(); using (StreamReader reader = new StreamReader(response.GetResponseStream())) { string tmp = reader.ReadToEnd(); }
