[site]: crossvalidated
[post_id]: 633278
[parent_id]: 
[tags]: 
Can a covariate also be a random effect in glmmTMB model with ar1

I have data consisting of catches of insects at weekly intervals over 2 years, repeated with the same methods at the same location 3 decades later. My main question is, have numbers (total and for individual species) changed over that time. Numbers in a catch can range from zero to thousands. Much of this variation will be due to seasonality – some species are flying for just a few months in summer. Air temperature was also recorded as this strongly affects insect activity and thus the catch. I began by fitting models with seasonality modelled as a quadratic of “week” (centred on mid-summer). With a log link in glm this translates to a Gaussian curve which appears a good fit for these species. The temperature effect “air” is not quite linear (with log link) and a quadratic term improved fit. Even with these covariates the catches are highly overdispersed so negative binomial errors were specified. model “year” is the inter-decadal effect (factor, 2 levels). Interactions between year and the temperature and seasonal effects are interesting but I’ll keep it simple for now, but note that I do want to estimate the parameters for seasonality so “week + week^2” is a covariate, not a random effect. Results from this model seemed reasonable but DHARMa detected temporal autocorrelation in the residuals (as could be expected) so I graduated to: times Results of this formulation seemed an improvement – AIC is lower and autocorrelation of residuals is reduced (though not eliminated). But I have concerns about “week” appearing as a covariate and also as a random factor (in ar1). Well, week and times are not exactly the same (week resets for each calendar year), but they are clearly related so could these terms in the model be competing for the same information? Could that hinder ar1 from fully dealing with temporal autocorrelation and also result in biased estimates of the seasonal effect (week)? I noticed that when adding ar1 to the models (for a dozen different species), the estimates for week are shifted positively (a later seasonal peak) and p-values for that estimate increased (more so than for other parameters in the model). However, when I simulated bigger datasets with similar features and known parameters, there was very little sign of bias, it did not increase with increasing ar1, and ar1 was correctly recovered. That is comforting, but I’m a bit suspicious of my simulated data (I could explain more if needed – I resorted to using Excel). So my questions are: Is it ok if a variable appears as a covariate and as a random effect in the ar1 section of a glmmTMB model? Is my model with ar1 suitable for testing a year effect and estimating the seasonality while accounting for temporal autocorrelation? Or is there a better way? Can anyone suggest how, with R, I can simulate data with one factor, two quadratic covariates that are correlated with each other, and negative binomial errors?
