[site]: stackoverflow
[post_id]: 281167
[parent_id]: 
[tags]: 
Slow SQL Code on local server in MS Access

I've got a particular SQL statement which takes about 30 seconds to perform, and I'm wondering if anyone can see a problem with it, or where I need additional indexing. The code is on a subform in Access, which shows results dependent on the content of five fields in the master form. There are nearly 5000 records in the table that's being queried. The Access project is stored and run from a terminal server session on the actual SQL server, so I don't think it's a network issue, and there's another form which is very similar that uses the same type of querying... Thanks PG SELECT TabDrawer.DrawerName, TabDrawer.DrawerSortCode, TabDrawer.DrawerAccountNo, TabDrawer.DrawerPostCode, QryAllTransactons.TPCChequeNumber, tabdrawer.drawerref FROM TabDrawer LEFT JOIN QryAllTransactons ON TabDrawer.DrawerRef=QryAllTransactons.tpcdrawer WHERE (Forms!FrmSearchCompany!SearchName Is Null Or [drawername] Like Forms!FrmSearchCompany!SearchName & "*") And (Forms!FrmSearchCompany.SearchPostcode Is Null Or [Drawerpostcode] Like Forms!FrmSearchCompany!Searchpostcode & "*") And (Forms!FrmSearchCompany!SearchSortCode Is Null Or [drawersortcode] Like Forms!FrmSearchCompany!Searchsortcode & "*") And (Forms!FrmSearchCompany!Searchaccount Is Null Or [draweraccountno] Like Forms!FrmSearchCompany!Searchaccount & "*") And (Forms!FrmSearchCompany!Searchcheque Is Null Or [tpcchequenumber] Like Forms!FrmSearchCompany!Searchcheque & "*"); "); EDIT The Hold up seems to be in the union query that forms the QryAllTransactons query. SELECT "TPC" AS Type, TabTPC.TPCRef, TabTPC.TPCBranch, TabTPC.TPCDate, TabTPC.TPCChequeNumber, TabTPC.TPCChequeValue, TabTPC.TPCFee, TabTPC.TPCAction, TabTPC.TPCMember, tabtpc.tpcdrawer, TabTPC.TPCUser, TabTPC.TPCDiscount, tabcustomers.* FROM TabTPC INNER JOIN TabCustomers ON TabTPC.TPCMember = TabCustomers.CustomerID UNION ALL SELECT "CTP" AS Type, TabCTP.CTPRef, TabCTP.CTPBranch, TabCTP.CTPDate, TabCTP.CTPChequeNumb, TabCTP.CTPAmount, TabCTP.CTPFee, TabCTP.CTPAction, TabCTP.CTPMember, 0 as CTPXXX, TabCTP.CTPUser, TabCTP.CTPDiscount, TABCUSTOMERS.* FROM TabCTP INNER JOIN TabCustomers ON Tabctp.ctpMember = TabCustomers.CustomerID; I've done a fair bit of work with simple union queries, but never had this before...
