[site]: stackoverflow
[post_id]: 5171891
[parent_id]: 5171722
[tags]: 
This should work for MS SQL Server. It assumes that there truly is one entry per date per user, with no gaps in dates, and no mucking around with time (hours, minutes, seconds) values. (Also, no null values!) It will calculate the average daily increase, whether or not it actually goes up ever day. SELECT mt.UserName, avg(mt.Balance - mt2.Balance) AvgDailyIncrease from MyTable mt inner join MyTable mt2 on mt2.UserName = mt.UserName and mt2.CaptureDate = dateadd(dd, -1, mt.CaptureDate) group by mt.UserName order by avg(mt.Balance - mt2.Balance) desc
