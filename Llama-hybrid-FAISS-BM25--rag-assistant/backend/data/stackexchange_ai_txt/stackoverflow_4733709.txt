[site]: stackoverflow
[post_id]: 4733709
[parent_id]: 4733169
[tags]: 
The format vulnerability is in usage() - with the sprintf() and printf() taking format strings that are generated from argv[0] , which an attacker can manipulate to contain whatever they want. The main buffer overflow is the one highlighted by Péter Török ; when scanning code for security vulnerabilities, any unchecked buffer filling with blatant comments like that is a signpost asking for trouble. The environment variable USER is used - it could be manipulated by the unscrupulous, but it is debatable whether it would really buy you anything. You could set it to say 'root', and the attempted 'chown' command would user the name it was told to use. There's a race of sorts between the chown command and the chmod() system call. It isn't immediately clear how you'd exploit that separately from the other issues - but it might give you something to leverage. Including twice is redundant but otherwise harmless. With POSIX 2008, it isn't even needed in most places at all.
