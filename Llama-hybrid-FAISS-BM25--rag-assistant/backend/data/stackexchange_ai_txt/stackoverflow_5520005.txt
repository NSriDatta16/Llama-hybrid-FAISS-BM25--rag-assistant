[site]: stackoverflow
[post_id]: 5520005
[parent_id]: 5519939
[tags]: 
In SQL Server one option is to make the filters in the WHERE clause and the average in the SELECT select avg(ValueCol) from Table1 where DateCol between @Date-304 and @Date Another option, in the same logic of the excel could be: select avg(case when DateCol between @Date-304 and @Date then ValueCol else null) from Table1
