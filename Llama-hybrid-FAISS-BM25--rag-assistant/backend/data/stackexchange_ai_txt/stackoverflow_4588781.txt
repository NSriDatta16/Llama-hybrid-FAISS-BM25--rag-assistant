[site]: stackoverflow
[post_id]: 4588781
[parent_id]: 4587509
[tags]: 
The shell script in itself is pretty safe. The most vulnerable part of a mail is the header, and you don't allow the mail sender to change anything in it. The only way I see in the script is that someone could pass a dot on a single line, which would end the mail prematurely. And there may be the case of embedding attachments using uuencode like this: Subject: subject From: sender@example.com To: receiver@example.com text line 1 text line 2 begin 644 file-containing-abc $86)C"G]_ ` end I'm worried about the line in the .procmailrc , since I don't know the quoting rules. This might be a point where an attacker could inject code, so you need to look up the rules in the manual and test them to be sure. Some characters you should test are $ , " , \ , newlines.
