[site]: stackoverflow
[post_id]: 2307953
[parent_id]: 2306620
[tags]: 
How to conditionally select elements in zip? Zip first, select later. In this case, I'm doing the selection with catMaybes , wihch is often useful in this setting. Getting the to typecheck was a huge pain (must put fromIntegral in exactly the right spot), but here's the code I would write, relying on the optimizer as usual: average as bs cs d1 e1 = avg $ catMaybes $ zipWith3 cdiv as bs cs where cdiv a b c = if a >= d1 && a Function cdiv stands for "conditional division". To get catMaybes you have to import Data.Maybe . This code typechecks, but I haven't run it.
