[site]: stackoverflow
[post_id]: 2005438
[parent_id]: 2004771
[tags]: 
In Fortran you can't store na in an array of real numbers, you can only store real numbers. So you'll probably want to replace na's with some value not likely to be present in your data: huge() might be suitable. 2D arrays are no problem at all for Fortan. You might want to use a 2D array of logicals to replace ymiss rather than a 2D array of 1s and 0s. There is no simple, intrinsic to achieve what you want, you'd need to write a function. However, a more Fortran way of doing things would be to use the array of logicals as a mask for the operations you want to carry out. So, here's some fragmentary Fortran code, not tested: ! Declarations real(8), dimension(m,n) :: y, ynew logical, dimension(m,n) :: ymiss ! Executable where (ymiss) ynew = func(y) ! here func() is whatever your function is
