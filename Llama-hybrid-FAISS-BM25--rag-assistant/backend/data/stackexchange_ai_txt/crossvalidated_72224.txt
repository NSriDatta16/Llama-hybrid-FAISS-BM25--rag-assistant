[site]: crossvalidated
[post_id]: 72224
[parent_id]: 
[tags]: 
Singular values of the data matrix and eigenvalues of the covariance matrix

I am having some problem in computing SVD and PCA in Matlab. I do not know if I am doing theoretical mistakes or programming mistakes. Starting with a data matrix $X$, PCA computes the eigenvalues $\lambda_i$ of the covariance matrix $X^TX/(n-1)$. On the other side SVD of $X$ is given by $X=U\Sigma V^\top$, and so $$X^T X=V \Sigma^T U^T U\Sigma V^T=V \Sigma^2 V^T,$$ where $\Sigma$ is diagonal matrix of singular values with elements $\sigma_i$. So we have that $$\lambda_i=\sigma_i^2 /(n-1).$$ Now I try a Matlab example: load hald; [u s v] = svd(ingredients); sigma = cov(ingredients); [a,b] = eig(sigma); disp('sigma') disp(diag(s)') disp('lambda') disp(diag(b)') and here is the output: sigma 211.3369 77.2356 28.4597 10.2667 lambda 0.2372 12.4054 67.4964 517.7969 The obtained values do not respect the original equation. Where is the mistake?
