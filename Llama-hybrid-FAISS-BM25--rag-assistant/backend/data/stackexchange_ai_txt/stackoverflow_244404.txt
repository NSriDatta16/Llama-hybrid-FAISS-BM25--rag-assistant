[site]: stackoverflow
[post_id]: 244404
[parent_id]: 244110
[tags]: 
The code in the question has a bug which causes the error. This line writes a bunch of column names to row 0 $sheet->writeRow(0, 0, $colNames, $colHeadingFormat); Then we have the loop which is supposed to write out the value rows. for($i=1; $i writeRow($rowNumber++, 0, $row); } The problem is that $rowNumber isn't declared anywhere so it overwrites row 0 on the first pass through the loop. This overwriting seems to cause an issue with Excel Writer. The strange thing is that, on the Excel file that gives the error, you still see the row with the column names even though it's technically been overwritten. I found the solution here on Google Groups . Scroll down to the bottom. It's the last post by Micah that mentions the issue. And here's the fix addWorksheet('At a Glance'); $colNames = array('Foo', 'Bar'); $sheet->writeRow($rowNumber, 0, $colNames, $colHeadingFormat); for($i=1; $i writeRow($rowNumber, 0, $row); } header ("Expires: " . gmdate("D,d M Y H:i:s") . " GMT"); header ("Last-Modified: " . gmdate("D,d M Y H:i:s") . " GMT"); header ("Cache-Control: no-cache, must-revalidate"); header ("Pragma: no-cache"); $xls->send("test.xls"); $xls->close(); ?>
