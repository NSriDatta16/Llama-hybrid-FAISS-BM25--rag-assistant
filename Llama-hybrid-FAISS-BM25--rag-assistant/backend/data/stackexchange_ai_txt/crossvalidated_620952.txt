[site]: crossvalidated
[post_id]: 620952
[parent_id]: 
[tags]: 
System GMM yields invalid results while Difference GMM is correct

While studying about GMMs I generated the following dataset to experiment with. import numpy as np import pandas as pd rows = [] for individual_id in range(40): lag_y = 0 for time in range(10): x1 = np.random.normal(0, 1, 1)[0] eps = np.random.normal(0, 1, 1)[0] individual_effect = individual_id y = 0.3 * x1 + individual_effect + 0.1*lag_y + 0.01 * eps rows.append( { 'x1': x1, 'y': y, 'individual_id': individual_id, 'time': time } ) lag_y = y df = pd.DataFrame(data=rows) df.to_csv("sample_dataset.csv") The population model is $y_{i,t} = 0.1y_{i,t-1} + 0.3x_{i,t} + \alpha_i + \varepsilon_{i,t}$ . When I fit a difference GMM in stata using import delimited "sample_dataset.csv" xtset individual_id time xtabond2 y x L1.y, gmm(L2.y, collapse) iv(x) robust noleveleq I get reasonable estimates Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm. Warning: Two-step estimated covariance matrix of moments is singular. Using a generalized inverse to calculate robust weighting matrix for Hansen test. Difference-in-Sargan/Hansen statistics may be negative. Dynamic panel-data estimation, one-step difference GMM ------------------------------------------------------------------------------ Group variable: individual~d Number of obs = 320 Time variable : time Number of groups = 40 Number of instruments = 8 Obs per group: min = 8 Wald chi2(0) = . avg = 8.00 Prob > chi2 = . max = 8 ------------------------------------------------------------------------------ | Robust y | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- x | .2987912 .0008267 361.42 0.000 .2971709 .3004116 | y | L1. | .0987338 .0044346 22.26 0.000 .0900421 .1074255 ------------------------------------------------------------------------------ Instruments for first differences equation Standard D.x GMM-type (missing=0, separate instruments for each period unless collapsed) L(1/9).L2.y collapsed ------------------------------------------------------------------------------ Arellano-Bond test for AR(1) in first differences: z = -4.52 Pr > z = 0.000 Arellano-Bond test for AR(2) in first differences: z = -2.29 Pr > z = 0.022 ------------------------------------------------------------------------------ Sargan test of overid. restrictions: chi2(6) = 7.09 Prob > chi2 = 0.313 (Not robust, but not weakened by many instruments.) Hansen test of overid. restrictions: chi2(6) = 8.32 Prob > chi2 = 0.215 (Robust, but weakened by many instruments.) Difference-in-Hansen tests of exogeneity of instrument subsets: iv(x) Hansen test excluding group: chi2(5) = 4.64 Prob > chi2 = 0.461 Difference (null H = exogenous): chi2(1) = 3.68 Prob > chi2 = 0.055 However, when running System GMM, the results are completely different and don't make sense with respect to the population model . xtabond2 y x L1.y, gmm(L2.y, collapse) iv(x) robust Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm. Warning: Two-step estimated covariance matrix of moments is singular. Using a generalized inverse to calculate robust weighting matrix for Hansen test. Difference-in-Sargan/Hansen statistics may be negative. Dynamic panel-data estimation, one-step system GMM ------------------------------------------------------------------------------ Group variable: individual~d Number of obs = 360 Time variable : time Number of groups = 40 Number of instruments = 10 Obs per group: min = 9 Wald chi2(2) = 207983.51 avg = 9.00 Prob > chi2 = 0.000 max = 9 ------------------------------------------------------------------------------ | Robust y | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- x | .2817627 .0351817 8.01 0.000 .2128079 .3507175 | y | L1. | .9696906 .0080149 120.99 0.000 .9539817 .9853994 | _cons | .8759827 .238385 3.67 0.000 .4087566 1.343209 ------------------------------------------------------------------------------ Instruments for first differences equation Standard D.x GMM-type (missing=0, separate instruments for each period unless collapsed) L(1/9).L2.y collapsed Instruments for levels equation Standard x _cons GMM-type (missing=0, separate instruments for each period unless collapsed) D.L2.y collapsed ------------------------------------------------------------------------------ Arellano-Bond test for AR(1) in first differences: z = 0.87 Pr > z = 0.386 Arellano-Bond test for AR(2) in first differences: z = 0.76 Pr > z = 0.449 ------------------------------------------------------------------------------ Sargan test of overid. restrictions: chi2(7) = 15.21 Prob > chi2 = 0.033 (Not robust, but not weakened by many instruments.) Hansen test of overid. restrictions: chi2(7) = 17.62 Prob > chi2 = 0.014 (Robust, but weakened by many instruments.) Difference-in-Hansen tests of exogeneity of instrument subsets: GMM instruments for levels Hansen test excluding group: chi2(6) = 8.70 Prob > chi2 = 0.191 Difference (null H = exogenous): chi2(1) = 8.91 Prob > chi2 = 0.003 iv(x) Hansen test excluding group: chi2(6) = 16.99 Prob > chi2 = 0.009 Difference (null H = exogenous): chi2(1) = 0.62 Prob > chi2 = 0.430 A basic FE regression is much better even though there should be dynamic panel bias present. . xtreg y x L1.y, fe vce(cluster individual) Fixed-effects (within) regression Number of obs = 360 Group variable: individual~d Number of groups = 40 R-sq: within = 0.9990 Obs per group: min = 9 between = 0.9940 avg = 9.0 overall = 0.9475 max = 9 F(2,39) = 155735.95 corr(u_i, Xb) = 0.9674 Prob > F = 0.0000 (Std. Err. adjusted for 40 clusters in individual_id) ------------------------------------------------------------------------------ | Robust y | Coef. Std. Err. t P>|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- x | .2995587 .0006096 491.40 0.000 .2983257 .3007918 | y | L1. | .0987098 .0005703 173.10 0.000 .0975564 .0998632 | _cons | 19.52823 .0122089 1599.51 0.000 19.50353 19.55292 -------------+---------------------------------------------------------------- sigma_u | 11.706987 sigma_e | .00997811 rho | .99999927 (fraction of variance due to u_i) ------------------------------------------------------------------------------ Which assumption am I violating? Or what else I am doing wrong? Why is there _const present for the system GMM?
