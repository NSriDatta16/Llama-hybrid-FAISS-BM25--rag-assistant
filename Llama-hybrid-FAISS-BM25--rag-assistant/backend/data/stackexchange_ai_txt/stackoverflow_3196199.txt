[site]: stackoverflow
[post_id]: 3196199
[parent_id]: 
[tags]: 
#NAME error when setting cell formula through VBA.

I am writing a macro that requires me to get the average of the values in a column with an unknown number of rows. I use this to get the number of the last row: Dim lastRow As Long lastRow = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row That works. What doesn't work is when I try to use it here: Range("B2").Select ActiveCell.FormulaR1C1 = "=AVERAGE('table1'!AM2:AM" & lastRow & ")" Doing that, I get a result of #NAME? . How can I fix this?
