[site]: stackoverflow
[post_id]: 5085199
[parent_id]: 
[tags]: 
How to cause a Test Run Error if AssemblyCleanup times out?

I'm using MSTest in Visual Studio 2010 and have the need to restore my database after all tests have run. What I did was decorate a method with the AssemblyCleanupAttribute attribute. Shared Sub AssemblyCleanup() ' Restore my databases which takes a long time... End Sub Problem is the clean up takes a reasonable amount of time, so much so that the timeout is reached. The only reason I started realizing that a timeout occurred is that in debug mode the Output window reports "...QTAgent32.exe, AgentObject: Cleanup: Timeout reached in cleaning up the agent.". Hence it fails very quietly and I would have loved if MSTest reported a Test Run Error. What is the best way to detect and report the timeout? My ideal solution would be to report the timeout as a test run error.
