[site]: stackoverflow
[post_id]: 980292
[parent_id]: 808914
[tags]: 
I believe I have the same problem as Steve Homer. In addition to this SO question I also found this thread on eggheadcafe.com Very slow SP execution when using .net - very fast in Management Studio - totico The answers say it's about parameter sniffing and how that affects which execution plan is used. The answers there specifically mentions the arithabort set option and how that affects the selection of plan. Now I just need to find out how to change the set options from VBA... Finally thanks to this forum entry on social.msdn.com i managed to get it right. First, set multiple connections to false: connectionObject.Properties("Multiple Connections") = False and then use the following function on your connection to set arithabort on ... Private Sub OptionSet(ByRef cnn As adodb.Connection) Dim cmd As adodb.Command Set cmd = New adodb.Command With cmd Set .ActiveConnection = cnn .CommandType = adodb.CommandTypeEnum.adCmdText .CommandText = "set arithabort on" Call .Execute End With Set cmd = Nothing End Sub
