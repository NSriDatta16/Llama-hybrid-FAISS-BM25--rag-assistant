[site]: datascience
[post_id]: 33757
[parent_id]: 
[tags]: 
Get top 5 performers from team using pandas

I am new to both python and pandas, numpy etc. I am trying to do some data analysis on batsmen performances for a given team. I have successfully written python code to scrape data and store it in sqlite db in following format PLAYER_ID RUNS BALLS_FACED STRIKE_RATE NAME MATCH_DATE 4327 9 13 69.23 Anderson, J 6/18/2015 0:00 4327 0 0 0 Anderson, J 6/19/2015 0:00 4327 3 5 60 Anderson, J 6/20/2015 0:00 4327 0 0 0 Anderson, J 6/21/2015 0:00 3475 0 0 0 Cusack, A R 8/2/2008 0:00 3475 5 7 71.43 Cusack, A R 8/3/2008 0:00 3475 2 2 100 Cusack, A R 8/4/2008 0:00 3475 0 0 0 Cusack, A R 8/5/2008 0:00 3475 0 0 0 Cusack, A R 6/8/2009 0:00 3475 12 6 200 Cusack, A R 6/10/2009 0:00 3475 20 12 166.67 Cusack, A R 6/11/2009 0:00 3475 2 3 66.67 Cusack, A R 6/14/2009 0:00 3475 2 2 100 Cusack, A R 6/15/2009 0:00 3475 0 0 0 Cusack, A R 2/1/2010 0:00 3475 15 13 115.38 Cusack, A R 2/9/2010 0:00 3475 2 4 50 Cusack, A R 2/11/2010 0:00 3475 65 44 147.73 Cusack, A R 2/13/2010 0:00 3475 28 22 127.27 Cusack, A R 2/13/2010 0:00 3475 2 4 50 Cusack, A R 4/30/2010 0:00 3475 0 0 0 Cusack, A R 5/4/2010 0:00 3475 14 11 127.27 Cusack, A R 2/22/2012 0:00 3475 0 0 0 Cusack, A R 3/14/2012 0:00 3475 22 13 169.23 Cusack, A R 3/18/2012 0:00 3475 1 7 14.29 Cusack, A R 7/18/2012 0:00 3475 0 0 0 Cusack, A R 7/20/2012 0:00 3475 15 14 107.14 Cusack, A R 9/19/2012 0:00 3475 0 0 0 Cusack, A R 9/24/2012 0:00 3475 0 0 0 Cusack, A R 11/16/2013 0:00 3475 1 1 100 Cusack, A R 11/30/2013 0:00 3475 0 0 0 Cusack, A R 2/19/2014 0:00 3475 8 6 133.33 Cusack, A R 2/21/2014 0:00 3475 0 1 0 Cusack, A R 3/17/2014 0:00 3475 0 0 0 Cusack, A R 3/19/2014 0:00 3475 0 0 0 Cusack, A R 3/21/2014 0:00 3475 0 0 0 Cusack, A R 6/19/2015 0:00 3475 0 0 0 Cusack, A R 6/20/2015 0:00 3475 0 0 0 Cusack, A R 6/21/2015 0:00 3475 0 0 0 Cusack, A R 7/13/2015 0:00 3475 13 4 325 Cusack, A R 7/15/2015 0:00 3475 0 0 0 Cusack, A R 7/17/2015 0:00 3475 0 1 0 Cusack, A R 7/25/2015 0:00 3752 0 0 0 Dockrell, G H 2/1/2010 0:00 3752 0 0 0 Dockrell, G H 2/9/2010 0:00 3752 0 0 0 Dockrell, G H 2/11/2010 0:00 3752 0 0 0 Dockrell, G H 2/13/2010 0:00 3752 0 0 0 Dockrell, G H 2/13/2010 0:00 3752 0 6 0 Dockrell, G H 4/30/2010 0:00 3752 0 0 0 Dockrell, G H 5/4/2010 0:00 3752 0 0 0 Dockrell, G H 2/22/2012 0:00 3752 0 0 0 Dockrell, G H 2/23/2012 0:00 3752 2 2 100 Dockrell, G H 2/24/2012 0:00 3752 0 0 0 Dockrell, G H 3/14/2012 0:00 3752 0 0 0 Dockrell, G H 3/18/2012 0:00 3752 0 0 0 Dockrell, G H 3/22/2012 0:00 3752 0 0 0 Dockrell, G H 3/23/2012 0:00 3752 0 0 0 Dockrell, G H 3/24/2012 0:00 I need to find the top five performers based on the performance in last five matches based on average, runs & strike rate and plot them. I know I need to group by each player and by match date then sort and somehow get the top 5 results based on average or runs and below is what I have so far. dataFrame = pd.read_sql_query("select pm.player_id, pm.runs, pm.balls_faced, pm.strike_rate, pd.name, pm.match_date from player_match_details pm inner join player_data pd where pm.player_id = pd.player_id and pd.country = '" + country + "' and match_type = '" + matchType + "'", conn) #print(dataFrame) playerByDate = dataFrame.groupby(['PLAYER_ID','MATCH_DATE']) I know it doesn't sound too difficult but I am clueless on how to go forward on this. Edit : Added dataframe details as requested RangeIndex: 600 entries, 0 to 599 Data columns (total 6 columns): PLAYER_ID 600 non-null int64 RUNS 600 non-null int64 BALLS_FACED 600 non-null int64 STRIKE_RATE 600 non-null float64 NAME 600 non-null object MATCH_DATE 600 non-null object dtypes: float64(1), int64(3), object(2) memory usage: 23.5+ KB
