[site]: crossvalidated
[post_id]: 569279
[parent_id]: 
[tags]: 
Probability that two samples from a multinomial distribution intersect in a specific way

The following combinatorially difficult problem has obvious applications in information retrieval and bioinformatics but I haven't seen its solution discussed anywhere. I am interested in computing the probability that two samples drawn from a multinomial distribution have a specific intersection of elements. To make this concrete, imagine that I have a large urn containing balls of $m$ different colors and that the probability of drawing a ball with color $c$ is known to be $p(c)$ , $c \in \{1\ldots m\}$ . Next, imagine that I draw two samples from the urn with replacement, $S_1$ and $S_2$ , whose sizes are $n_1 = |S_1|$ and $n_2 = |S_2|$ . Denote the number of balls in $S_1$ drawn with color $c$ as $f_1(c)$ . And similarly, denote the number of balls in $S_2$ with color $c$ as $f_2(c)$ . Now let $g(c)$ denote the number of balls with color $c$ that $S_1$ and $S_2$ have in common, $$ g(c) = \min \{ f_1(c), f_2(c) \}. $$ I am interested in computing the probability of observing a particular set of items common to both $S_1$ and $S_2$ , call it $\vec{g} = \langle g(1), g(2), \ldots, g(m) \rangle$ , resulting from the described sampling process. That is, I want to compute $$ P\bigl( \vec{g} ~ \bigl| ~ p(1), ..., p(m), |S_1|=n_1, |S_2|=n_2 \bigr). $$ I am well aware that this probability can be estimated through monte sampling, but doing so is extremely inefficient when there are many different colors of balls (large $m$ ) and the sets $S_1$ and $S_2$ contain more than just a handful of items. Are there other, more efficient approaches to estimating the intersection probability for two draws from a multinomial distribution? I am surprised I haven't found any given that this seems to be a fundamental problem in probability.
