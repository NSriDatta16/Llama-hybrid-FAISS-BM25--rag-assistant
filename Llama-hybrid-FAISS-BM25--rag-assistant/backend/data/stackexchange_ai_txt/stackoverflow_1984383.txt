[site]: stackoverflow
[post_id]: 1984383
[parent_id]: 473028
[tags]: 
Try this: 1022, 732 Reading values from App.Config File: //This method will read the value of the OptionsPortNumber in the //above app.config file. private int LoadConfigData () { System.Xml.XmlDocument doc = new System.Xml.XmlDocument(); // AppDomain.CurrentDomain.SetupInformation.ConfigurationFile // points to the config file. doc.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile); int smartRefreshPortNumber = 0; foreach (XmlNode node in doc.ChildNodes.Item(1)) { //Searching for the node “” if (node.LocalName == "appSettings") { smartPortNumber =Convert.ToInt32(node.ChildNodes.Item(1).Attributes[1].Value); } } Return smartPortNumber; } Updating the value in the App.config: //This method will read the value of the OptionsPortNumber in the //above app.config file. private void UpdateConfigData() { System.Xml.XmlDocument doc = new System.Xml.XmlDocument(); doc.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile); //Looping through all nodes. foreach (XmlNode node in doc.ChildNodes.Item(1)) { //Searching for the node “” if (node.LocalName == "appSettings") { if (!dynamicRefreshCheckBox.Checked) { node.ChildNodes.Item(1).Attributes[1].Value = this.portNumberTextBox.Text; } else { node.ChildNodes.Item(1).Attributes[1].Value = Convert.ToString(0); } } } //Saving the Updated values in App.config File.Here updating the config //file in the same path. doc.Save(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile); }
