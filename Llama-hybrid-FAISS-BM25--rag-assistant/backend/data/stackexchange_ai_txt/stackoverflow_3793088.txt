[site]: stackoverflow
[post_id]: 3793088
[parent_id]: 3787870
[tags]: 
The following VBScript uploads a file using FrontPage RPC: Function StringToByteArray(str) Set stream = CreateObject("ADODB.Stream") stream.Open stream.Type = 2 ''adTypeText stream.Charset = "ascii" stream.WriteText str stream.Position = 0 stream.Type = 1 ''adTypeBinary StringToByteArray = stream.Read() stream.Close End Function Sub UploadFile(sourcePath, siteUrl, docName, title, checkincomment, userName, password) strHeader = "method=put+document%3a12.0.4518.1016" + _ "&service_name=%2f" + _ "&document=[document_name=" + Escape(docName) + _ ";meta_info=[vti_title%3bSW%7c" + Escape(title) + "]]" + _ "&put_option=overwrite,createdir,migrationsemantics" + _ "&comment=" + _ "&keep%5fchecked%5fout=false" + vbLf bytearray = StringToByteArray(strHeader) Set stream = CreateObject("ADODB.Stream") stream.Open stream.Type = 1 ''adTypeBinary stream.Write byteArray Set stream2 = CreateObject("ADODB.Stream") stream2.Open stream2.Type = 1 ''adTypeBinary stream2.LoadFromFile sourcePath stream2.CopyTo stream, -1 stream.Position = 0 Set xmlHttp = CreateObject("MSXML2.XMLHTTP") xmlHttp.open "POST", siteUrl + "/_vti_bin/_vti_aut/author.dll", false, userName, password xmlhttp.setRequestHeader "Content-Type","application/x-vermeer-urlencoded" xmlhttp.setRequestHeader "X-Vermeer-Content-Type","application/x-vermeer-urlencoded" xmlhttp.setRequestHeader "User-Agent", "FrontPage" xmlHttp.send stream If xmlHttp.status = 200 Then If Instr(xmlHttp.responseText, "successfully") = 0 Then MsgBox "ERROR: " & vbCrLf & xmlHttp.responseText Else ''Checkin strHeader = "method=checkin+document%3a12.0.4518.1016" + _ "&service_name=%2f" + _ "&document_name=" & Escape(docName) + _ "&comment=" + Escape(checkincomment) + _ "&keep%5fchecked%5fout=false" + vbLf Set xmlHttp = CreateObject("MSXML2.XMLHTTP") xmlHttp.open "POST", siteUrl + "/_vti_bin/_vti_aut/author.dll", false, userName, password xmlhttp.setRequestHeader "Content-Type","application/x-vermeer-urlencoded" xmlhttp.setRequestHeader "X-Vermeer-Content-Type","application/x-vermeer-urlencoded" xmlhttp.setRequestHeader "User-Agent", "FrontPage" xmlHttp.send strHeader End If End If If xmlHttp.status / 100 <> 2 Then MsgBox "ERROR: status = " & xmlHttp.status & vbCrLf & xmlHttp.responseText End If End Sub UploadFile "C:\Users\myusername\Desktop\Test File.zip", _ "http://computername/Sites/sitename", _ "Requirements/Test File.zip", _ "Test title", _ "Test checkin comment", _ "MYDOMAIN\myusername", "mypassword" MsgBox "Done" Please note that the file name should consist of ASCII characters only. Otherwise, the above script will not work.
