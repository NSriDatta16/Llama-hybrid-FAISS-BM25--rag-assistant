[site]: crossvalidated
[post_id]: 599820
[parent_id]: 
[tags]: 
Design of proportions comparison experiment (Frequentist and Bayesian)

I need to design an animal experiment where I test the survival proportion following administration of a vaccine and inoculation of the disease. I have 3 vaccines in the trial, the control (C), the standard (S), and the test vaccine I design (T). I am trying to conduct a power analysis to correctly choose the number of mice required. I am also interested in the Bayesian approach and trying to understand it. I use R. From previous experiments I have the following proportion estimations: pC = 0.15 pS = 0.85 pT >= 0.45 I am testing a version of the test vaccine that I anticipate being at least equal, or better than the 0.45 survival measured before. I want to test 2 separates hypothesis: a) The test vaccine provides higher protection than the control vaccine (pT>pC) b) The test vaccine provides non-inferior (NI) protection than the standard vaccine given a NI margin m of 0.2, decided as a threshold to push the test vaccine to the next step (pS-pT I.Frequentist approach: To estimate the number of mice for to test a) I can use power.prop.test, but I am not sure of the procedure for the test of the NI b) assuming that the new pT would be close to pS. I did write this code where I simulated 5000 experiments assuming binomial law for the number of survivors and using different number of animals n and possible pT and computed the power counting the number of times in the simulations the CI of the difference between Standard and Test proportions was below 0.2. Is it the correct approach here? #Parameters# pS=0.85 #survival rate Standard vaccine pT=seq(0.7,0.9,by=0.05) #survival rate Test vaccine range for power analysis n=seq(8,50)#Number of animals simu=5000 #number of experiment tried thresh=0.2 #max acceptable difference to standard for Non inferiority (NI) mat=matrix(rep(0,length(pT)*length(n)),ncol=length(pT),nrow=length(n))#stored c=0 #col index r=0 #row index #Simulations# for (i in pT){ #loop for the different potential values of the test vaccine survival rate c=c+1 r=0 for (j in n){ # loop for the power for different nbr of animals print(j) r=r+1 live_S=rbinom(simu,j,pS) #simulations from binomial law of survival counts in standard vaccine group live_T=rbinom(simu,j,i) #simulations of survival counts in test vaccine group temp=c() for(k in 1:simu){ #loop comparing every simulations for a given pT and n res=prop.test(c(live_S[k],live_T[k]),c(j,j)) #test proportion temp=c(temp,res$conf.int[2]) # get the difference CI upper level } mat[r,c]=sum(temp II.Bayesian approach: Having read multiple posts here and papers, I was wondering if I could adopt a Bayesian approach for this problem (I am completely new to Bayesian statistics). The reason is that I am trying to estimate the probability of the effects more than just a yes/no, in order to give more evidence to push the development of the vaccine(or not depending on the result). My understanding of the procedure is: assume some priors of a Beta distribution B(1,1) on the proportions of survivals of the different vaccines, get the posterior distributions of pS, pC and pT being beta distributions get the posterior distributions of the relevant differences (pS-pT and pC-pT)sampling using rbeta compute the correct Bayes factors of the different hypothesis such as for the NI hypothesis $$ BF=\frac{P(pS-pT =m | data)} $$ with m the margin decided to declare NI Is it the correct procedure for a NI trial ? If this procedure is correct, what is the approach to estimate the number of animals to use in these cases ? Similarly to the frequentist approach, should I compute different Bayes factor for different potential pT and number of animals and choose a situation with a high enough Bayes Factor? Is there some accepted “high enough” Bayes factor in scientific literature? Thanks for your help !
