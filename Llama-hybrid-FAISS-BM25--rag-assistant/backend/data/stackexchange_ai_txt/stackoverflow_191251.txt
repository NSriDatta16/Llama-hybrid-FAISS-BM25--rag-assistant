[site]: stackoverflow
[post_id]: 191251
[parent_id]: 
[tags]: 
How to install WPF application to a PC without Framework 3.5

I have a question about how to deploy WPF application into a PC without Framework 3.5. If a PC just installs Windows XP and sp3, Is it possible to design a setup package that can install WPF Application directly on this PC? The situation is like this: I designed a simple WPF Application. And I want to get its setup package. When the customs get the package, they can install the application directly, even if their PCs do not have Framework3.5 installed. Is it possible? If it is possible, how can I do this? //----------------------------------------------------------- I found Matt give a http://forums.microsoft.com/EmbeddedWindows/ShowPost.aspx?PostID=3967493&SiteID=47>solution Is it the only solution? You can delete .NET assemblies you don't use from the GAC as long as you test your app to make sure that you don't trim down too much. Majority of .NET assemblies are wrappers on top of Win32 API so they can be removed without affecting the OS. You can get the list of which assemblies you are using by looking at References node in Visual Studio solution explorer on your development machine. All dependencies are there (If assembly A depends on assembly B, both A and B mist be in the list) but there are some assemblies belonging to the runtime itself such as Accessibility.dll see the list below. Make sure you use gacutil.exe (can be called from Visual Studio command prompt) to remove the assemblies. You have to run gacutil after you boot up your embedded image and have .NET installed. Just copy the SDK\v2.0\bin folder from Visual studio gacutil.exe /l can be used to list all assemblies installed. I used to try to run WPF application on WinPE with no .NET installed. I just manually install the CLR + about 30 dlls from .NET. Here is the list of all files required 10/19/2006 05:13 PM 10,752 Accessibility.dll 09/18/2006 01:32 PM 66,728 big5.nlp 09/18/2006 01:32 PM 82,172 bopomofo.nlp 11/01/2006 10:34 PM 17,920 Culture.dll 11/01/2006 10:34 PM 9,728 fusion.dll 09/18/2006 01:32 PM 116,756 ksc.nlp 11/01/2006 10:34 PM 326,656 mscorjit.dll 10/19/2006 05:14 PM 4,366,336 mscorlib.dll 11/01/2006 10:34 PM 330,752 mscorrc.dll 11/01/2006 10:34 PM 5,632,512 mscorwks.dll 09/18/2006 01:32 PM 59,342 normidna.nlp 09/18/2006 01:32 PM 45,794 normnfc.nlp 09/18/2006 01:32 PM 39,284 normnfd.nlp 09/18/2006 01:32 PM 66,384 normnfkc.nlp 09/18/2006 01:32 PM 60,294 normnfkd.nlp 09/18/2006 01:32 PM 83,748 prc.nlp 09/18/2006 01:32 PM 83,748 prcp.nlp 11/02/2006 04:36 AM 3,915,264 PresentationCore.dll 02/23/2007 06:06 PM 184,320 PresentationFramework.Aero.dll 02/23/2007 06:06 PM 126,976 PresentationFramework.Classic.dll 11/02/2006 04:36 AM 4,972,544 PresentationFramework.dll 02/23/2007 06:06 PM 376,832 PresentationFramework.Luna.dll 09/18/2006 01:32 PM 262,148 sortkey.nlp 09/18/2006 01:32 PM 20,320 sorttbls.nlp 10/19/2006 05:14 PM 413,696 System.configuration.dll 10/19/2006 05:14 PM 3,035,136 System.dll 10/19/2006 05:14 PM 704,512 System.Drawing.dll 10/19/2006 05:14 PM 5,414,912 System.Windows.Forms.dll 10/19/2006 05:14 PM 2,039,808 System.XML.dll 02/23/2007 06:06 PM 32,768 UIAutomationProvider.dll 02/23/2007 06:06 PM 86,016 UIAutomationTypes.dll 11/02/2006 04:36 AM 1,167,360 WindowsBase.dll 09/18/2006 01:33 PM 28,288 xjis.nlp Hope that helps Matt
