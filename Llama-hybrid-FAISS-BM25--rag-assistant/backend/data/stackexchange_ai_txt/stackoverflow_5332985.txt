[site]: stackoverflow
[post_id]: 5332985
[parent_id]: 
[tags]: 
How to validate XML with multiple namespaces in Python?

I'm trying to write some unit tests in Python 2.7 to validate against some extensions I've made to the OAI-PMH schema: http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd The problem that I'm running into is business with multiple nested namespaces is caused by this specification in the above mentioned XSD: Metadata must be expressed in XML that complies with another XML Schema (namespace=#other). Metadata must be explicitly qualified in the response. Here's a snippet of the code I'm using: import lxml.etree, urllib2 query = "http://localhost:8080/OAI-PMH?verb=GetRecord&by_doc_ID=false&metadataPrefix=nsdl_dc&identifier=http://www.purplemath.com/modules/ratio.htm" schema_file = file("../schemas/OAI/2.0/OAI-PMH.xsd", "r") schema_doc = etree.parse(schema_file) oaischema = etree.XMLSchema(schema_doc) request = urllib2.Request(query, headers=xml_headers) response = urllib2.urlopen(request) body = response.read() response_doc = etree.fromstring(body) try: oaischema.assertValid(response_doc) except etree.DocumentInvalid as e: line = 1; for i in body.split("\n"): print "{0}\t{1}".format(line, i) line += 1 print(e.message) I end up with the following error: AssertionError: http://localhost:8080/OAI-PMH?verb=GetRecord&by_doc_ID=false&metadataPrefix=nsdl_dc&identifier=http://www.purplemath.com/modules/ratio.htm Element '{http://www.openarchives.org/OAI/2.0/oai_dc/}oai_dc': No matching global element declaration available, but demanded by the strict wildcard., line 22 I understand the error, in that the schema is requiring that the child element of the metadata element be strictly validated, which the sample xml does. Now I've written a validator in Java that works - however it would be helpful for this to be in Python, since the rest of the solution I'm building is Python based. To make my Java variant work, I had to make my DocumentFactory namespace aware, otherwise I got the same error. I've not found any working example in python that performs this validation correctly. Does anyone have an idea how I can get an XML document with multiple nested namespaces as my sample doc validate with Python? Here is the sample XML document that i'm trying to validate: 2002-02-08T08:55:46Z http://arXiv.org/oai2 oai:arXiv.org:cs/0112017 2001-12-14 cs math Using Structural Metadata to Localize Experience of Digital Content Dushay, Naomi Digital Libraries With the increasing technical sophistication of both information consumers and providers, there is increasing demand for more meaningful experiences of digital information. We present a framework that separates digital object experience, or rendering, from digital object storage and manipulation, so the rendering can be tailored to particular communities of users. Comment: 23 pages including 2 appendices, 8 figures 2001-12-14
