[site]: crossvalidated
[post_id]: 495919
[parent_id]: 492956
[tags]: 
The instantaneous coherence function for a single pair of FFT frames is always equal to one. In the numerator, you are multiplying complex spectrum X with the complex conjugate of spectrum Y and then squaring the result. In the denominator you end up taking the sum of the squares of the real and imaginary parts of spectrum X and spectrum Y. The conjugate of a complex number works out to keeping the real part and and inverting the sign of the imaginary part. The sign change in the imaginary part falls out when you square the numbers. So, for any single X and Y pair, the numerator and the denominator are expected to be identical, addition and multiplication being commutative. In a perfectly noiseless LTI system you would further expect the relationship between the input and output spectra to remain constant when averaged over time. I real world systems, X and Y will tend to diverge when averaged across multiple frames, resulting in coherence of less than one.
