[site]: stackoverflow
[post_id]: 4843300
[parent_id]: 4843194
[tags]: 
First we will create some example data to make the problem concrete: w_sp = sample(seq(0, 100, 0.01), 1000) power = 1/(1+exp(-(rnorm(1000, mean=w_sp, sd=5) -40)/5)) Suppose we want to bin the power values between [0,5), [5,10), etc. Then bin_incr = 5 bins = seq(0, 95, bin_incr) y_mean = sapply(bins, function(x) mean(power[w_sp >= x & w_sp We have now created the mean values between the ranges of interest. Note, if you wanted the median values, just change mean to median . All that's left to do, is to plot them: plot(w_sp, power) points(seq(2.5, 97.5, 5), y_mean, col=3, pch=16) To get the average based on data that falls within two standard deviations of the average, we need to create a slightly more complicated function: noOutliers = function(x, power, w_sp, bin_incr) { d = power[w_sp >= x & w_sp (m_d - 2*sd(d)) & (d
