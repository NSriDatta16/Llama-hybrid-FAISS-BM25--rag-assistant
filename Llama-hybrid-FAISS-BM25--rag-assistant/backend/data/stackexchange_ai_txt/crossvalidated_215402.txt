[site]: crossvalidated
[post_id]: 215402
[parent_id]: 
[tags]: 
Bayesian Data Analysis: Section 3.4 Sampling from the joint posterior distribution Example

For reference: $$ p(\sigma^{2}|y) \propto \tau_n N(\mu_n | \mu_0, \tau_0^{2}) \text{Inv}-\chi^{2}(\nu_0, \sigma^{2}_0) \prod_{i=1}^{n} N(y_i|\mu_n,\sigma^{2}) \tag{3.14} $$ The book states: As with the conjugate prior distribution, the easiest way to draw ($\mu,\sigma^{2})$ from their joint posterior distribution, is to draw $\sigma^{2}$ from its marginal posterior density and then $\mu$ from its conditional posterior density, given the drawn value $\sigma^{2}$. The first step -- drawing $\sigma^{2}$-- must be done numerically, for example using the inverse cdf method based on a computation of the posterior density (3.14) on a discrete grid of values $\sigma^{2}$. The second step is immediate: draw $\mu \sim N(\mu_n, \tau_n^{2})$, with $\mu_n$ and $\tau_n^{2}$ from (3.11) The author then uses the above method in an example with real data. I am trying to replicate the example, but am struggling with the sequencing of how to draw $\sigma^{2}$. I understand that $\sigma^{2}$ comes from the density listed in 3.14, I know what the inverse cdf method is, but not how I can use it in this situation. If you have the book, this is from p.82 of the 3rd edition. My python code below illustrates my attempt at the football data example, but I have an error thrown because of a dimensionality mismatch between the subtraction of my data values and $\mu_n$ in the normal density product that is at the end of (3.14). Any/all help appreciated. sigma_sq = 1/(np.linspace(150,250,1000)**2) ## grid values sigma_pr = sps.uniform.rvs(loc=0,scale=10000*2,size=1) ## prior tau_n = 1/((1/4)+(len(fb_dat)/sigma_sq)) ## hy mu_n =( 1/2 * 0 + (len(fb_dat) / sigma_sq) * fb_dat.spread.mean() ) / (1/4 + (len(fb_dat) / sigma_sq)) norm_n = sps.norm.rvs(loc=0,scale=2, size = 1 ) data_sample = np.sqrt(sigma_sq)**-1 * np.exp(-1/(2*sigma_sq) * (fb_dat.spread - mu_n ).sum())
