[site]: crossvalidated
[post_id]: 599918
[parent_id]: 
[tags]: 
Creating a Generalized Additive Model for Zero-Inflated Proportion Response Variable

I am a PhD Candidate just beginning the data analysis phase of my dissertation. I have minimal experience with statistical modeling, so I have had to do a lot of self-teaching so please bear with me. I have 1.5 years worth of longitudinal data from individual tortoises, which I would like to fit in a Generalized Additive Model (GAM) or Hierarchical GAM (HGAM) using the mgcv or gamm4 packages. In summary, I would like to examine seasonal shifts in frugivory exhibited by all tortoises in my study system at the population-wide level, and then examine how each individual tortoise contributes to that cumulative seasonal shift in their diet. At the same time, I would like to incorporate spatial effects as a random factor since these tortoises are in three distinct "tortoise towns" within the same landscape. Just to be explicit with the data I am working with, I would like to describe the data I plan on including in my GAM, below. Response variable: prop.fruit = Zero-inflated proportional data bounded by [0,1]. Predictor variables: time.index = Count data where 0 is the first day I began collecting fecal samples. ind = Categorical variable where each of the 14 levels is a different individual tortoise that has provided multiple samples. The minimum number of samples from a given individual is n=5, but I can provide a more strict cutoff if this sample size is inadequate. town = Categorical variable where each of the 3 levels indicates which tortoise town an individual belongs to (East, West, and South). I would like this variable to be a random effect as I'm only interested in the difference among individual tortoises through time and how they contribute to the cumulative spline. Note: I will leave it at that for now, but I also have seed counts for 5 focal plant species that were recovered from these fecal samples and seem to be important food items in their diet and which facilitate this shift toward frugivory. I would like to incorporate these data into the analysis, but would like to first develop the simpler model with the above variables. The reason for the inclusion of these plants in the analysis is to examine which of these 5 plant species are most important in steering this shift of the tortoises toward a more frugivorous diet. I have written my R code below using guidance from the below paper as well as a YouTube video from Dr. Gavin L. Simpson: Pedersen, E. J., D. L. Miller, G. L. Simpson, and N. Ross. 2019. Hierarchical generalized additive models in ecology: an introduction with mgcv. PeerJ 7:e6876. So far, this is my code: rm(list=ls(all=TRUE)) library(mgcv) library(readxl) # Load data data $ind ind) data $town town) ### Create models with each of the possible smoothing combinations # Create model.G model.G The code works just fine and I am able to compare among each of the models to obtain the best one according to BIC. I used ML as my method rather than REML because it provided me the lowest BIC score when I compare the same models when using both methods. I have a few questions about what I have done so far, which I was hoping someone could help shed light on: With my response variable being a zero-inflated proportion, bounded by [0,1], is tw(link="log") an appropriate distribution family to use? Is there any pre-analysis transformation I should perform to account for this inflation? I have watched videos on the pscl R package, which deals with zero-inflation, but have not considered how I could use it with mgcv to deal with the zero-inflation before analysis. If you go through the paper I cited above, you will see the way I coded for my study system is the same as in the CO2 example. I didn't use the te() function as in the bird example because I just wanted to take into account the categorical spatial information rather than coordinates. However, I do have GPS coordinates for all of the samples if that might be more appropriate for considering space as a random effect. How could I incorporate the additional categorical variable of town as a random effect into the existing code for each of the models, so that I can solely compare the differences among each individual in contributing to this seasonal shift in diet? Again, if using te() with GPS coordinates would work better in considering space as a random effect, I am open to that consideration as well. Thank you! To test for the relative importance of the 5 plant species I mentioned above in contributing to this shift in frugivory, would you suggest I only focus on the cumulative spline rather than adding this complexity to the individual-level smooths? I will defer to the expertise of anyone who has experience with these types of models, so please feel free to comment your thoughts and suggestions. I feel really out of my element. Thank you very much for your time. I am new to using StackExchange, so I would appreciate any advice or suggestions regarding the contents of my post. Thank you.
