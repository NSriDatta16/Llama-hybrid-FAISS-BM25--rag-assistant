[site]: crossvalidated
[post_id]: 182113
[parent_id]: 
[tags]: 
Training a neural network to predict the maximum of a distribution

Suppose I have some training data, where each datum is the pair $(x, y)$. Here, $x$ is continuous, and $y$ is a distribution over discrete values. I now want to train a deep neural network to predict which bin in the distribution $y$ is the maximum for any given input $x$. There are three ways to achieve this. What I would like to know, is which do you think would produce the best network for my task? 1) The first method would be to treat each training datum as a pair $(x, \arg\max(y))$, where $\arg\max(y)$ is the in in the distribution $y$ corresponding to the maximum. Then, the network would be trained for classification. 2) The second method would be to train the network for regression, using the full distribution $y$ as the output of each datum. During inference, the network would output its predicted distribution, an you would take the maximum over this distribution. 3) The third method, which is a compromise of 1) and 2), would be to train the network for regression, but only take the bins corresponding to the top few values in the distribution $y$. Therefore, the network is only mapping $x$ to values of $\arg\max(y)$ which are themselves most likely to correspond the maximum. In this way, the network does not "waste" its capacity on regressing to values of $y$ which are never likely to be the maximum.
