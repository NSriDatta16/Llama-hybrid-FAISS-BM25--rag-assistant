[site]: crossvalidated
[post_id]: 498970
[parent_id]: 498872
[tags]: 
Assuming the data to be at irregular intervals with different number of measurements for each subject: $y_{t_{11}},y_{t_{12}},\ldots,y_{t_{1K_1}}$ $y_{t_{21}},y_{t_{22}},\ldots,y_{t_{2K_2}}$ $\vdots$ $y_{t_{N1}},y_{t_{N2}},\ldots,y_{t_{NK_N}}$ For sake of simplicity, I am writing the equations for linear models instead of a proportional odds model which can be modeled using a logit link function. We could model the first measurement for the ith subject as: $$y_{t_{i1}} = \beta_0 +\beta_1t_{i1}+\boldsymbol{\beta X}+\gamma_i+\epsilon_{i1}$$ The second measurement should be autocorrelated with the first measurement. The correlation should be 1 when $t_{i2} = t_{i1}$ and 0 when they are too far away. One choice is to choose the correlation to be inversely proportional to the time interval. $$corr(t1,t2) = \frac{\rho}{\rho+f(t_{i2}-t_{i1})} $$ where $f$ can be chosen depending on the decay needed. If $f$ is chosen as the identity function, it means that we have a correlation of 0.5 at a time interval of $\rho$ (which is flexible and $\rho$ can be estimated accordingly) The second measurement then becomes: $$y_{t_{i2}} = \beta_0 +\beta_1t_{i2}+\boldsymbol{\beta X}+\frac{\rho}{\rho+(t_{i2}-t_{i1})}\gamma_i+\epsilon_{i2}$$ Similarly, $$y_{t_{i3}} = \beta_0 +\beta_1t_{i3}+\boldsymbol{\beta X}+\frac{\rho}{\rho+(t_{i3}-t_{i1})}\gamma_i+\epsilon_{i3}$$ $$\vdots$$ $$y_{t_{iK_i}} = \beta_0 +\beta_1t_{iK_i}+\boldsymbol{\beta X}+\frac{\rho}{\rho+(t_{iK_i}-t_{i1})}\gamma_i+\epsilon_{iK_i}$$ This correlation structure seems simple and natural, however, (I think) as we go to the measurements at the end, like the correlation between the last observation and last but one observation is small compared to the first and second observation even if they are equally separated in time. To remedy this an alternative specification of the random effects to preserve autocorrelation between measurements is: $$y_{t_{i2}} = \beta_0 +\beta_1t_{i2}+\boldsymbol{\beta X}+\frac{\rho}{\rho+(t_{i2}-t_{i1})}\gamma_i+\epsilon_{i2}$$ Similarly, $$y_{t_{i3}} = \beta_0 +\beta_1t_{i3}+\boldsymbol{\beta X}+\frac{\rho}{\rho+(t_{i2}-t_{i1})}\frac{\rho}{\rho+(t_{i3}-t_{i2})}\gamma_i+\epsilon_{i3}$$ $$\vdots$$ $$y_{t_{iK_i}} = \beta_0 +\beta_1t_{iK_i}+\boldsymbol{\beta X}+\frac{\rho}{\rho+(t_{i2}-t_{i1})}\frac{\rho}{\rho+(t_{i3}-t_{i2})} \ldots \frac{\rho}{\rho+(t_{iK_i}-t_{iK_{i-1}})}\gamma_i+\epsilon_{iK_i}$$ There may be some attenuation in correlation here too, but probably much less than the previous specification. This model could be estimated with a Bayesian hierarchical model with appropriate priors on the random effects and beta coefficients without any non-identifiability issues. I just wrote down my thoughts, I am not an expert in the field. Please let me know if I missed any major concept or if am wrong somewhere.
