[site]: stackoverflow
[post_id]: 5457238
[parent_id]: 5456448
[tags]: 
Ok, got this together... It's maybe not the prettiest -- but then neither is the input format ;-) String txt = '''Big Co.\t2009 Q4\t29\t88\t308 \t2010 Q1\t38\t\t \t2010 Q4\t21\t\t Gargantua Inc.\t2009 Q4\t33\t139 \t2010 Q1\t31\t\t \t2010 Q2\t36\t\t \t2010 Q3\t39\t\t Mediocre Ltd.\t2009 Q4\t39\t81 \t2010 Q4\t42\t\t''' // Parse the text def summary = txt.split( '\n' ).inject( [] ) { list, row -> def split = row.split( '\t' ).collect { it.trim() } while( split.size() th q } th "summary" } // Row for each group summary.each { group -> tr { td group.group allQuarters.each { q -> def v = group.subtotals."$q" if( v ) td v else td { mkp.yieldUnescaped '&nbsp;' } } td group.grouptotal } } // Footer row tr { td { mkp.yieldUnescaped '&nbsp;' } allQuarters.each { q -> td { mkp.yieldUnescaped '&nbsp;' } } td summary.grandtotal.find { it } // Get the first non-empty grandtotal } } println writer.toString()
