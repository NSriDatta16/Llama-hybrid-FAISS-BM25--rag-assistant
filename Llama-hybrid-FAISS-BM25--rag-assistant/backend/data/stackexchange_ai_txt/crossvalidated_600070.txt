[site]: crossvalidated
[post_id]: 600070
[parent_id]: 
[tags]: 
How can I derive this equation?

I am reading Understanding Diffusion Models: A Unified Perspective , but I am confused about equation 45. Concretely, the consistency term: $$ \sum_{t=1}^{T-1} \mathbb{E}_{q(x_{t-1},x_t,x_{t+1}|x_0)}\left[\log \frac{p_\theta(x_t|x_{t+1})}{q(x_t|x_{t-1})}\right] = -\sum_{t=1}^{T-1} \mathbb{E}_{q(x_{t-1},x_{t+1}|x_0)}\left[D_{KL}(q(x_t|x_{t-1})||p_\theta(x_t|x_{t+1}))\right]. $$ Where $q$ and $p_\theta$ are Markov chains, i.e., $q(x_{t-1},x_t,x_{t+1}) = q(x_{t-1})q(x_t|x_{t-1})q(x_{t+1}|x_t)$ . I just have done some derivation: $$ \begin{aligned} \mathbb{E}_{q(x_{t-1},x_t,x_{t+1}|x_0)}\left[\log \frac{p_\theta(x_t|x_{t+1})}{q(x_t|x_{t-1})}\right] & = \iiint q(x_{t-1},x_t,x_{t+1}|x_0) \left[\log \frac{p_\theta(x_t|x_{t+1})}{q(x_t|x_{t-1})}\right] dx_{t-1}dx_tdx_{t+1}\\ &=\iiint \frac{q(x_{t-1},x_t,x_{t+1}|x_0)}{q(x_t|x_{t-1})}q(x_t|x_{t-1})\left[\log \frac{p_\theta(x_t|x_{t+1})}{q(x_t|x_{t-1})}\right] dx_{t-1}dx_tdx_{t+1}\\ &=\iiint q(x_{t-1}|x_0)q(x_{t+1}|x_{t},x_0)q(x_t|x_{t-1})\left[\log \frac{p_\theta(x_t|x_{t+1})}{q(x_t|x_{t-1})}\right] dx_{t-1}dx_tdx_{t+1}. \end{aligned} $$ But I don't know why $\frac{q\left(x_{t-1},x_t,x_{t+1}|x_0\right)}{q\left(x_t|x_{t-1}\right)} = q(x_{t-1},x_t|x_0)$ solely on the Markov assumption.
