[site]: stackoverflow
[post_id]: 3651785
[parent_id]: 3649429
[tags]: 
Are you sure that you really need a third-party library? If your needs are basic, the Windows API is all you need ( using MMSystem ). var mo: HMIDIOUT; const MIDI_NOTE_ON = $90; MIDI_NOTE_OFF = $80; MIDI_CHANGE_INSTRUMENT = $C0; MIDI_DEVICE = 0; MIDI_VEL = 108; procedure MIDIInit; begin midiOutOpen(@mo, MIDI_DEVICE, 0, 0, CALLBACK_NULL); SetPlaybackVolume($FFFFFFFF); end; function MIDIEncodeMessage(Msg, Param1, Param2: integer): integer; begin result := Msg + (Param1 shl 8) + (Param2 shl 16); end; procedure SetCurrentInstrument(CurrentInstrument: TMIDIInstrument); begin midiOutShortMsg(mo, MIDIEncodeMessage(MIDI_CHANGE_INSTRUMENT, ord(CurrentInstrument), 0)); end; procedure NoteOn(NewNote, NewIntensity: byte); begin midiOutShortMsg(mo, MIDIEncodeMessage(MIDI_NOTE_ON, NewNote, NewIntensity)); end; procedure NoteOff(NewNote, NewIntensity: byte); begin midiOutShortMsg(mo, MIDIEncodeMessage(MIDI_NOTE_OFF, NewNote, NewIntensity)); end; procedure SetPlaybackVolume(PlaybackVolume: cardinal); begin midiOutSetVolume(mo, PlaybackVolume); end; where the instruments are type TMIDIInstrument = (midiAcousticGrandPiano, midiBrightAcousticPiano, midiElectricGrandPiano, midiHonkyTonkPiano, midiRhodesPiano, midiChorusedPiano, midiHarpsichord, midiClavinet, midiCelesta, midiGlockenspiel, midiMusicBox, midiVibraphone, midiMarimba, midiXylophone, midiTubularBells, midiDulcimer, midiHammondOrgan, midiPercussiveOrgan, midiRockOrgan, midiChurchOrgan, midiReedOrgan, midiAccordion, midiHarmonica, midiTangoAccordion, midiAcousticGuitarNylon, midiAcousticGuitarSteel, midiElectricGuitarJazz, midiElectricGuitarClean, midiElectricGuitarMuted, midiOverdrivenGuitar, midiDistortionGuitar, midiGuitarHarmonics, midiAcousticBass, midiElectricBassFinger, midiElectricBassPick, midiFretlessBass, midiSlapBass1, midiSlapBass2, midiSynthBass1, midiSynthBass2, midiViolin, midiViola, midiCello, midiContrabass, midiTremoloStrings, midiPizzicatoStrings, midiOrchestralHarp, midiTimpani, midiStringEnsemble1, midiStringEnsemble2, midiSynthStrings1, midiSynthStrings2, midiChoirAahs, midiVoiceOohs, midiSynthVoice, midiOrchestraHit, midiTrumpet, midiTrombone, midiTuba, midiMutedTrumpet, midiFrenchHorn, midiBrassSection, midiSynthBrass1, midiSynthBrass2, midiSopranoSax, midiAltoSax, midiTenorSax, midiBaritoneSax, midiOboe, midiEnglishHorn, midiBassoon, midiClarinet, midiPiccolo, midiFlute, midiRecorder, midiPanFlute, midiBottleBlow, midiShakuhachi, midiWhistle, midiOcarina, midiLead1Square, midiLead2Sawtooth, midiLead3CalliopeLead, midiLead4ChiffLead, midiLead5Charang, midiLead6Voice, midiLead7Fifths, midiLead8BrassLead, midiPad1NewAge, midiPad2Warm, midiPad3Polysynth, midiPad4Choir, midiPad5Bowed, midiPad6Metallic, midiPad7Halo, midiPad8Sweep, midiEmpty0, midiEmpty1, midiEmpty2, midiEmpty3, midiEmpty4, midiEmpty5, midiEmpty6, midiEmpty7, midiEmpty8, midiEmpty9, midiEmpty10, midiEmpty11, midiEmpty12, midiEmpty13, midiEmpty14, midiEmpty15, midiEmpty16, midiEmpty17, midiEmpty18, midiEmpty19, midiEmpty20, midiEmpty21, midiEmpty22, midiEmpty23, midiGuitarFretNoise, midiBreathNoise, midiSeashore, midiBirdTweet, midiTelephoneRing, midiHelicopter, midiApplause, midiGunshot); Try this: procedure TForm1.FormCreate(Sender: TObject); begin MIDIInit; SetCurrentInstrument(midiHarmonica); NoteOn(50, 127); sleep(200); NoteOn(60, 127); sleep(200); NoteOn(70, 127); sleep(200); NoteOff(70, 127); NoteOff(60, 127); NoteOff(50, 127); SetCurrentInstrument(midiAcousticGrandPiano); NoteOn(70, 127); NoteOn(80, 127); sleep(1000); SetCurrentInstrument(midiApplause); NoteOn(64, 127); sleep(2000); NoteOff(64, 127); end;
