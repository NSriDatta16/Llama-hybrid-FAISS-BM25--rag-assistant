[site]: stackoverflow
[post_id]: 5249267
[parent_id]: 5249034
[tags]: 
You could use a CTE (Common Table Expression) to calculate the average cost per category, and update your table from that: ;WITH CatCost AS ( SELECT Category, SUM(Cost) / (1.0 * SUM(Num)) 'AvgCostCat' FROM dbo.YourTable GROUP BY Category ) UPDATE dbo.YourTable SET ave_cost_category = cc.AvgCostCat FROM CatCost WHERE dbo.YourTable.Category = cc.Category
