[site]: datascience
[post_id]: 126895
[parent_id]: 
[tags]: 
ROC Curve - How to deal with overflow?

I'm trying to calculate the ROC curve and the AUC of a binary logistic regression from scratch, without using third party methods like sklearn.metrics.roc_curve , to see if I really understand what it's about. However, I'm having some issue, probably overflow related, when computing TPR , true positive rate, and FPR , false positive rate. Let M = confusion_matrix(y_true,pred) ; the following code seem to be problematic: fpr = M[1,0]/(M[0,0]+M[1,0]) tpr = M[1,1]/(M[1,1]+M[0,1]) For threshold very close to either zero or one, one of the denominators goes to zero. If I force fpr,tpr=1,1 every time M[1,1]+M[0,1]=0 , the ROC curve obtained looks like this Any ideas on what I could do differently?
