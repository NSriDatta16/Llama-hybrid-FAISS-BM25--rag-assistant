[site]: stackoverflow
[post_id]: 2141015
[parent_id]: 2140959
[tags]: 
The NPE is easy. One of the lines MediaLocator ml = new MediaLocator("file:capture.mpg"); datasink = Manager.createDataSink(outputDS, ml); in method startCapture throws a CannotRealizeException . So datasink is not initialized and if you try to close it later in stopCapture , it's still null and that causes the NPE. To avoid the NPE: test, if datasink isn't null before calling a method on it. EDIT and could you PLEASE remove the application logic from the constructor and move it to the main method. A constructor is for constructing an object, mainly for initializing class members and nothing else. And Java classes should start with a capital letter, that helps people (and us) understanding the code.
