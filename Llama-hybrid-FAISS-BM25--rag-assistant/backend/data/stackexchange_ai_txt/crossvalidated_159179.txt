[site]: crossvalidated
[post_id]: 159179
[parent_id]: 159135
[tags]: 
After checking with Wilcox's book, the data needs to be stored in list mode, which is neither wide nor long. Basically, each element of listA[[i]] is a vector for each permutation of the levels within your factor. It's a bit clunky, but once you organise your data in this way, there should not be a problem. See below for example code using WRS. library(WRS) #Use a loop to create a data set containing a 3x2x2 factorial experiment myMeans=c(10, 15, 20, 10, 11, 10, 9, 9.5, 9, 10, 11, 10) set.seed(1) mySD=rnorm(n=12, mean = 2, sd = .5) set.seed(1) myN=round(rnorm(12, 50, 10), 0) myData=list(level1=NA) for(i in 1:12){ set.seed(i) myData[[i]]=rnorm(50, myMeans[i], mySD[i]) } #Give the variables more sensible names based on the design names(myData)[1:3]=paste("1.1", 1:3, sep=".")#Names are FactorA.FactorB.FactorC names(myData)[4:6]=paste("1.2", 1:3, sep=".") names(myData)[7:9]=paste("2.1", 1:3, sep=".") names(myData)[10:12]=paste("2.2", 1:3, sep=".") #Plot the data to get a sense of what the results look like boxplot(myData, col=rep(c("orange", "darkorange2", "lightgreen", "forestgreen"), c(3,3,3,3))) abline(v=6.5, lwd=2) abline(v=c(3.5, 9.5), lty=2) #Run the robust ANOVA with a 20% trimming. the grp argument is unnecessary in this example because the variables are in the right order in the list, but it is included for compelteness. t3way(3,2,2, myData, tr = .2, grp=1:12)
