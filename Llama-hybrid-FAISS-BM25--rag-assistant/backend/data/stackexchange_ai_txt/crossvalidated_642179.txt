[site]: crossvalidated
[post_id]: 642179
[parent_id]: 
[tags]: 
MMD to estimate coefficients of a finite mixture is not quadratic?

I am trying to find a relatively fast density estimation by matching RKHS embeddings. I am somehow surprised by my findings and would like a sanity check: I have some observations $y_1, ..., y_n \in [a, b]$ , and a kernel $k$ with its RKHS $\mathcal H$ . The kernel embedding of my observations can be written $\hat \mu = \sum_{i=1}^n \beta_i k(y_i, \cdot)$ . I am using a general notation with coefficients $\beta$ so that the approach can be used for the "classical" embedding, but also conditional embeddings. I would like to get a quick estimate of the distribution at hand, and for that I considered $d$ known densities $p_1, ... p_d$ , and I consider $p:= \sum_{i=1}^d w_i p_i$ such that for all $i$ , $w_i \geq 0$ and $\sum_{i=1}^d w_i =1$ , and $\mu_p$ its kernel embedding. Can I find: $$\mathbf w^* \in \arg\min \lVert \mu_p -\hat \mu \rVert_\mathcal{H}^2 \text{ under constraints } w_i \geq 0 \text{ and } \sum_{i=1}^d w_i =1$$ As it turns out, by introducing $\mu_{p_i}:= \mathbb{E}_{U\sim p_i}[k(U, \cdot)]$ the kernel embedding of $p_i$ , and using the fact that $\mu_p = \sum_{i=1}^d w_i \mu_{p_i}$ we have: $$\left\Vert \mu_p -\hat \mu \right\Vert_\mathcal{H}^2 = \left\Vert \sum_{i=1}^d w_i \mu_{p_i}\right\Vert_\mathcal{H}^2-2 \sum_{i=1}^d w_i \langle \mu_{p_i} , \hat \mu \rangle_\mathcal{H}+\lVert \hat \mu \rVert_\mathcal{H}^2$$ For my minimisation problem, I can neglect the last term as it is independant of $w_i$ . To compute the second, I just need to use the reproducing property and I find: $$\sum_{i=1}^d w_i \langle \mu_{p_i} , \hat \mu \rangle_\mathcal{H} =\sum_{i=1}^d w_i \left(\sum_{j=1}^n \beta_j \int k(u, y_j) p_i(u) \,du \right)$$ I can pre-compute the integrals, and then it's just linear in the vector of $w_i$ s, easy! Now the issue I have is with the first term. Also using the definitions and reproducing property I find: $$\left\Vert \sum_{i=1}^d w_i \mu_{p_i}\right\Vert_\mathcal{H}^2 = \sum_{i=1}^d \sum_{i=1}^d w_i w_j \mathbb{E}_{U\sim p_i, V\sim p_j}[k(U, V)] = \sum_{i=1}^d \sum_{i=1}^d w_i w_j \int k(u, v) p_i(u) p_j(v) \,du \,dv$$ This term is quadratic in the $w_i$ s, however the matrix with entries $\int k(u, v) p_i(u) p_j(v) \,du \,dv$ is symetric but does not appear to be positive definite ? (at least based on my numerical experiments). This is not great: I had hoped that using a "simple" expression for $p$ would allow me to solve it with quadratic programming and get quick/relatively cheap estimates on the fly. I found this quite surprising and counter-intuitive, hence my two questions: Is my finding correct, or is there an overlook or mistake from my part ? Is there any "intuitive" explanation as to why the matrix with entries $\int k(u, v) p_i(u) p_j(v) \,du \,dv$ would be conditionally positive definite by not be p.d., and why the MMD of a finite mixture is behaving so poorly ? Thanks in advance, and cheers!
