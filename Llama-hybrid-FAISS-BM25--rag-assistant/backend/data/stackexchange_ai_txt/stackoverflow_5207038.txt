[site]: stackoverflow
[post_id]: 5207038
[parent_id]: 
[tags]: 
The better way to pass the foreign_key value to the Rails controller

It's been almost a week since I've began to dig deeper in forms , associations , hashes , symbols... But it seems I cannot solve the puzzle without your help . I am working on a project for displaying different galleries content . The basic idea is when the user sees the names of galleries (names are links ) to be able to click on chosen one. Then all the images ,that belong to this gallery , are displayed . On the bottom there should be a link "Add image in this gallery" . My models : class Gallery I have created index on gallery_id for the 'pictures' table . My big problem appears here , how to pass the gallery_id to the controller's action 'new' . As I've seen in "Agile web development with Rails" it could be : @gallery.id) %> As it seems in this case the foreign_key :gallery_id is exposed in the URL bar of the browser . The second problem is that :gallery_id is available for the controller 'new' function , but "disappears" for the 'create' function (causing an error " Couldn't find Gallery without an ID ") . The problem is gone when I add a hidden field in the _form for pictures , in my case : params[:gallery_id] %> Here are my definitions in the 'pictures' controller : def new @gallery=Gallery.find(params[:gallery_id]) @picture=@gallery.pictures.build end def create @gallery = Gallery.find(params[:gallery_id]) @picture = @gallery.pictures.new(params[:picture]) if @picture.save redirect_to(@picture, :notice => 'Picture was successfully created.') else redirect_to(galleries ,:notice => 'Picture was NOT created.') end end And finaly the link_to definition in show.html.erb for galleries: @gallery.id) %> Here is the debug output before submitting the image : --- !map:ActiveSupport::HashWithIndifferentAccess gallery_id: "6" action: new controller: pictures and after submitting the 'create' button (with exception raised ) : {"utf8"=>"âœ“", "authenticity_token"=>"IGI4MfDgbavBShO7R2PXIiK8fGjkgHDPbI117tcfxmc=", "picture"=>{"image"=>"wilsonblx.png"}, "commit"=>"Create"} As you see , there is nothing like "gallery_id" in the "pictures" hash . Summarizing my questions to you : Is there a way to pass the foreign_key without hidden_field ? Could I hide somehow passing the foreign key form showing in the URL bar ? Is there an alternative on passing arguments using 'link_to' ? Thank you .
