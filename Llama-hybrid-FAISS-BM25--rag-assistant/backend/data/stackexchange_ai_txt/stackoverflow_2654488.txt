[site]: stackoverflow
[post_id]: 2654488
[parent_id]: 2210288
[tags]: 
It is necessary to add synthetic disk (ResourceType. Disk , ResourceSubType. DiskSynthetic ) using Msvm_VirtualSystemManagementService.AddVirtualSystemResources. Parent = SCSI controller's WMI path. ManagementObject synthetic = Utilities.GetResourceAllocationSettingData(scope, ResourceType.Disk, ResourceSubType.DiskSynthetic); synthetic["Parent"] = ; //or SCSI controller path (WMI path) synthetic["Address"] = ; //0 or 1 for IDE string[] RASDs = new string[1]; RASDs[0] = synthetic.GetText(TextFormat.CimDtd20); Then to attach virtual hard disk (ResourceType. StorageExtent , ResourceSubType. VHD ) using Msvm_VirtualSystemManagementService.AddVirtualSystemResources. Parent = Synthetic disk's WMI path, Connection = *.vhd file path. ManagementObject hardDisk = Utilities.GetResourceAllocationSettingData(scope, ResourceType.StorageExtent, ResourceSubType.VHD); hardDisk["Parent"] = ; //WMI path string[] connection = { }; //Path to *.vhd file hardDisk["Connection"] = connection; string[] RASDs = new string[1]; RASDs[0] = hardDisk.GetText(TextFormat.CimDtd20); Use Common Utilities for the Virtualization Samples and WMI Explorer .
