[site]: stackoverflow
[post_id]: 1573880
[parent_id]: 
[tags]: 
I can't seem to add a column header to a list box in an inherited MFC dialog. What's wrong?

I have a CStdDlg thats inherits from a CDialog class. In the CStdDlg dialog, I have a list box (m_lcList1), edit box (m_ceEdit1), a radio button(m_rbButton2) and buttons OK, Cancel and Button1. I am trying to create another class named CDerivedDlg that inherits from CStdDlg. I want to use everything in CStdDlg but from the CDerivedDlg. This is a silly test application here, but I need something exactly like this is a real application. I'll show all the code below. PROBLEM: The problem keeps bombing whenever I try to add a column header to the list box. m_hWnd = NULL Can anyone tell me what's wrong? I would truly appreciate it. Thank you. // CStdDlg.cpp file #include "stdafx.h" #include "testdlg.h" #include "StdDlg.h" #ifdef _DEBUG #define new DEBUG_NEW #undef THIS_FILE static char THIS_FILE[] = __FILE__; #endif ///////////////////////////////////////////////////////////////////////////// // CStdDlg dialog CStdDlg::CStdDlg(UINT nIDTemplate, CWnd* pParent /*=NULL*/) : CDialog(CStdDlg::IDD, pParent) { //{{AFX_DATA_INIT(CStdDlg) //}}AFX_DATA_INIT } void CStdDlg::DoDataExchange(CDataExchange* pDX) { CDialog::DoDataExchange(pDX); //{{AFX_DATA_MAP(CStdDlg) DDX_Control(pDX, IDC_EDIT1, m_ceEdit1); DDX_Control(pDX, IDC_RADIO2, m_rbButton2); DDX_Control(pDX, IDC_LIST1, m_lcList1); //}}AFX_DATA_MAP } IMPLEMENT_DYNAMIC(CStdDlg, CDialog) BEGIN_MESSAGE_MAP(CStdDlg, CDialog) //{{AFX_MSG_MAP(CStdDlg) //}}AFX_MSG_MAP END_MESSAGE_MAP() ///////////////////////////////////////////////////////////////////////////// // CStdDlg message handlers BOOL CStdDlg::OnInitDialog() { CDialog::OnInitDialog(); return TRUE; // return TRUE unless you set the focus to a control // EXCEPTION: OCX Property Pages should return FALSE } =================================================================================== //CStdDlg.h file #if !defined(AFX_STDDLG_H__CDAFF61F_91AB_4B47_9970_6B8BB5DE0003__INCLUDED_) #define AFX_STDDLG_H__CDAFF61F_91AB_4B47_9970_6B8BB5DE0003__INCLUDED_ #if _MSC_VER > 1000 #pragma once #endif // _MSC_VER > 1000 // StdDlg.h : header file // #include ///////////////////////////////////////////////////////////////////////////// // CStdDlg dialog class CStdDlg : public CDialog { DECLARE_DYNAMIC(CStdDlg) // Construction public: CStdDlg(UINT nIDTemplate,CWnd* pParent = NULL); // standard constructor CString GetTitle() { CString csTTL; GetWindowText(csTTL); return csTTL; } // Dialog Data //{{AFX_DATA(CStdDlg) enum { IDD = IDD_STDDLG }; CEdit m_ceEdit1; CButton m_rbButton2; CListCtrl m_lcList1; //}}AFX_DATA // Overrides // ClassWizard generated virtual function overrides //{{AFX_VIRTUAL(CStdDlg) protected: virtual void DoDataExchange(CDataExchange* pDX); // DDX/DDV support //}}AFX_VIRTUAL // Implementation protected: void ShowMsg() { AfxMessageBox("ShowMsg from StdDlg"); } // Generated message map functions //{{AFX_MSG(CStdDlg) virtual BOOL OnInitDialog(); //}}AFX_MSG DECLARE_MESSAGE_MAP() }; //{{AFX_INSERT_LOCATION}} // Microsoft Visual C++ will insert additional declarations immediately before the previous line. #endif // !defined(AFX_STDDLG_H__CDAFF61F_91AB_4B47_9970_6B8BB5DE0003__INCLUDED_) =================================================================================== //CDerivedDlg.cpp file // StdDlg.cpp : implementation file // #include "stdafx.h" #include "testdlg.h" #include "CDerivedDlg.h" #ifdef _DEBUG #define new DEBUG_NEW #undef THIS_FILE static char THIS_FILE[] = __FILE__; #endif ///////////////////////////////////////////////////////////////////////////// // CDerivedDlg dialog CDerivedDlg::CDerivedDlg(CWnd* pParent /*=NULL*/) : CStdDlg(CDerivedDlg::IDD, pParent) { //{{AFX_DATA_INIT(CDerivedDlg) //}}AFX_DATA_INIT } void CDerivedDlg::DoDataExchange(CDataExchange* pDX) { CDialog::DoDataExchange(pDX); //{{AFX_DATA_MAP(CDerivedDlg) //}}AFX_DATA_MAP } IMPLEMENT_DYNAMIC(CDerivedDlg, CStdDlg) BEGIN_MESSAGE_MAP(CDerivedDlg, CStdDlg) //{{AFX_MSG_MAP(CDerivedDlg) ON_BN_CLICKED(IDC_BUTTON1, OnButton1) //}}AFX_MSG_MAP END_MESSAGE_MAP() ///////////////////////////////////////////////////////////////////////////// // CDerivedDlg message handlers //void CDerivedDlg::OnOK() //{ // // TODO: Add extra validation here // AfxMessageBox("CDerived Class OK button pressed"); // CDialog::OnOK(); //} BOOL CDerivedDlg::OnInitDialog() { CStdDlg::OnInitDialog(); SetWindowText("Derived Test Window"); m_lcList1.InsertColumn(0,"This is a test"); *******THIS IS WHERE IT CRASHES***** m_rbButton2.ShowWindow(SW_HIDE); m_ceEdit1.ShowWindow(SW_HIDE); return TRUE; // return TRUE unless you set the focus to a control // EXCEPTION: OCX Property Pages should return FALSE } void CDerivedDlg::OnButton1() { // // TODO: Add extra validation here AfxMessageBox("CDerived Button1 pressed"); AfxMessageBox(GetTitle()); } void CDerivedDlg::OnOK() { AfxMessageBox("CDerived Class OK button pressed"); } =================================================================================== // CDerivedDlg.h file #if !defined(AFX_CDerivedDlg_H__CDAFF61F_91AB_4B47_9970_6B8BB5DE0003__INCLUDED_) #define AFX_CDerivedDlg_H__CDAFF61F_91AB_4B47_9970_6B8BB5DE0003__INCLUDED_ #if _MSC_VER > 1000 #pragma once #endif // _MSC_VER > 1000 // CDerivedDlg.h : header file // #include "StdDlg.h" ///////////////////////////////////////////////////////////////////////////// // CDerivedDlg dialog class CDerivedDlg : public CStdDlg { DECLARE_DYNAMIC(CDerivedDlg) // Construction public: CDerivedDlg(CWnd* pParent = NULL); // standard constructor virtual void SetTTL(CString csTitle) { this->SetWindowText(csTitle); } // Dialog Data //{{AFX_DATA(CDerivedDlg) enum { IDD = IDD_STDDLG }; //}}AFX_DATA // Overrides // ClassWizard generated virtual function overrides //{{AFX_VIRTUAL(CDerivedDlg) protected: virtual void DoDataExchange(CDataExchange* pDX); // DDX/DDV support //}}AFX_VIRTUAL // Implementation protected: // Generated message map functions //{{AFX_MSG(CDerivedDlg) virtual BOOL OnInitDialog(); afx_msg void OnButton1(); virtual void OnOK(); //}}AFX_MSG DECLARE_MESSAGE_MAP() }; //{{AFX_INSERT_LOCATION}} // Microsoft Visual C++ will insert additional declarations immediately before the previous line. #endif // !defined(AFX_CDerivedDlg_H__CDAFF61F_91AB_4B47_9970_6B8BB5DE0003__INCLUDED_) ===================================================================================
