[site]: crossvalidated
[post_id]: 500910
[parent_id]: 
[tags]: 
Understanding and implementing the last step in the 3-Step Latent Class Analysis using covariates from Vermunt 2010

I am interested in implementing the 3-Step approach for LCA with covariates ( $Z_i$ ) in R. According to Vermunt (2010) , the "Standard" three-step approach would involve (mentioned in pages 5 and 6): Step 1: Fit an LCA model without covariates, and Step 2: Compute $P(W=s|X=t)$ or the "weights" for each observation ( $Y_i$ ) by the posterior probabilities $P(X=t|Y_i)$ Step 3: Fit a "weighted" multinomial logistic regression model. Question 1: It is not clear how to fit the multinomial logistic model in R when there is proportional assignment (i.e. $w_{it}\ne0 \forall t\in[1,2,..T]$ , where $T$ is the number of latent classes). Question 2: In pages 8 and 9 of 1 , Vermunt also states that the method proposed by Bolck, Croon, and Hagenaars (2004) improves the results by establishing the relationship between $P(W=s|Z_i)$ and $P(X=t|Z_i)$ and this is followed by the expression $E=AD$ from which $P(X=t|Z_i)$ can be estimated. Given that there is a way to perform the "weighted" multinomial logistic regression, it is possible to handle negative weights which appear in the matrix $A$ (mentioned in page 9)? If possible, I want to know if the SAS Macro for 3-Step Analysis is based on the method by 2 from their description of the 3rd step on page 5. Thank you
