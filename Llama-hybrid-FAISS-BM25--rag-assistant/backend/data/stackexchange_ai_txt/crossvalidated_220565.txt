[site]: crossvalidated
[post_id]: 220565
[parent_id]: 220480
[tags]: 
In Euclidean space, the weighted average of a set of input points is easy to calculate and has a nice, closed form solution. As you mention, it's not possible to perform the same procedure on the sphere, because the resulting point would no longer lie on the surface of the sphere. A quick and dirty approach is to simply take the standard weighted average, then renormalize the resulting vector so that it lies on the surface of the sphere. This is an approximate solution that might work in certain cases. There is precedent in the literature. A more principled solution is to generalize the weighted average to spherical geometries by recasting it as an optimization problem. In Euclidean space, the weighted average can be written as the point that minimizes the weighted sum of squared distances to each of the input points. The solution to this optimization problem is the familiar expression for the weighted average. Say we want to take the weighted average of points $\{x_1, ..., x_n\} \in \mathbb{R}^d$. The corresponding weights for each point are given by $\{w_1, ..., w_n\}$. The weights are nonnegative and sum to $1$. The weighted average $a^*$ is given by: $$a^* = \underset{a}{\text{argmin}} \sum_{i=1}^{n} w_i \| x_i - a\|^2$$ This problem can be generalized to spherical geometries by replacing the Euclidean distance with the geodesic distance on the surface of the sphere (i.e. how far you'd have to travel along the surface of the sphere to get from one point to another). $$a^* = \underset{a}{\text{argmin}} \sum_{i=1}^{n} w_i D_S(x_i, a)^2$$ Here, $D_s(x_i, a)$ denotes the geodesic distance between points $x_i$ and $a$ on the surface of sphere $S$. BTW, this formulation of the problem is for (hyper)spheres of any dimension, not just 3. I'm not aware of a closed form solution for this problem, but the following paper gives two iterative algorithms. They report runtimes of a few hundred microseconds for taking the weighted average of 12 points on a 3-sphere. They also discuss how to perform interpolation on the surface of a sphere, which seems relevant to some of the use cases you're considering. Buss and Fillmore (2001) . Spherical Averages and Applications to Spherical Splines and Interpolation.
