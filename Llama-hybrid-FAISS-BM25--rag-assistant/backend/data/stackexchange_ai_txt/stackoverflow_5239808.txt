[site]: stackoverflow
[post_id]: 5239808
[parent_id]: 5239781
[tags]: 
Is it Pythonic, elegant and efficient? Looks good to me... Are you able to do it better? "better"? If it's understandable, and efficient, isn't that enough? Maybe look at defaultdict to use that instead of setdefault.
