[site]: stackoverflow
[post_id]: 2066866
[parent_id]: 
[tags]: 
how to load xml from url and apply specified xsl (xml-stylesheet processing instruction)

I am using C# to load a url. My URL is an XML document which contains the processing instruction During development, I was using SHDocVw.InternetExplorer ie = new SHDocVw.InternetExplorer(); ie.Navigate2(...). But since deploying to the server, I am getting the error. System.UnauthorizedAccessException: Retrieving the COM class factory for component with CLSID {0002DF01-0000-0000-C000-000000000046} failed due to the following error: 80070005. As per above advice, I tried the following. In both cases I am receiving the raw XML. How do I get get the transformed HTML? (NOTE: I cannot use XSLCompiledTransform because the 3rd-party provided XSL uses XSLT only supported by MSXML.) client.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)"); Stream data = client.OpenRead(xmlUrl); StreamReader reader = new StreamReader(data); string s = reader.ReadToEnd(); as well as HttpWebRequest httpRequest = (HttpWebRequest)WebRequest.Create(URL.ToString()); using (HttpWebResponse httpResponse = (HttpWebResponse)httpRequest.GetResponse()) { Stream receiveStream = httpResponse.GetResponseStream(); Encoding encode = System.Text.Encoding.GetEncoding("utf-8"); StreamReader readStream = new StreamReader(receiveStream, encode); Console.WriteLine("\r\nResponse stream received."); Char[] read = new Char[256]; int count = readStream.Read(read, 0, 256); Console.WriteLine("HTML...\r\n"); while (count > 0) { String str = new String(read, 0, count); Console.Write(str); baseRequest.Append(str); count = readStream.Read(read, 0, 256); } etc.... }
