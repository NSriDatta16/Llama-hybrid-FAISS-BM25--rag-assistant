[site]: crossvalidated
[post_id]: 561903
[parent_id]: 
[tags]: 
Quantify similarity of two time series

I am a biologist that is not proficient on statistics or using R, so bear with me. I have data for two factors that increase or decrease over time. I have replicate measurements of both factors at the same time points over the course of one hour. I do not have a high amount of data, and it is quite variable. By an initial analysis I think that in the decreasing data, the trajectories are very similar, and for the increasing data, the trajectories are more dissimilar. I would like to know how can I measure this difference and quantify it, preferentially with a statistic test. I have thought of several approaches but I would like to get advice on which one would be best. Here is the data and my initial analysis: test_data Here is a plot of the data and a linear regression quadratic line. I can see that, specially for the initial time-points, there is a clear difference between the two factors on the increasing and decreasing datasets. library(ggplot2) library(ggpmisc) test = read.csv("./test_data.csv") formula = y ~ poly(x, 2, raw = TRUE) ggplot(test, aes(x=Time,y=value)) + stat_summary(geom="ribbon", fun.data=mean_se,aes(fill=Type),alpha=0.3) + stat_summary(geom="line", fun=mean,aes(color=Type), size = 1) + stat_poly_line(formula=formula, color="black", linetype="dotted") + stat_poly_eq(aes( label=paste(after_stat(eq.label), after_stat(adj.rr.label), sep = "*\", \"*")), size=3, formula=formula) + facet_wrap(~Type+Dir) + scale_x_continuous(expand=expansion(mult=0, add=1), breaks=seq(0,60,10)) + scale_y_continuous(expand=expansion(mult=0, add=1), limits=c(-200,200)) + coord_cartesian(xlim=c(0,60), ylim=c(0,100)) + xlab("Time (min)") + ylab("Normalized levels (%)") + theme(legend.position = "none", axis.text=element_text(color=black), panel.border=element_rect(color="black", fill=NA), panel.grid=element_blank(), panel.background=element_blank(), strip.background=element_rect(color="black", fill=NA)) First of all, if you think there is a better way of fitting, please let me know, there might be better fits. With this, I can clearly see that the coefficient of the x^2 is higher for Factor_2 than for Factor_1 in the increasing dataset, indicating that these factors' dependency on time follows different trends. Then, to measure the similarity between factor_1 and factor_2 trajectories, I have thought of: 1- Perform t-test analyses on data for each time point. Comparing both factors at each time point should give me an idea if there are statistical significances at the earlier time points. However, due to my low data sampling and replicates, there is no statistical significance. I want to compare the trajectories of both factors, not specific data at each time-point. 2- Calculate the fit of Factor_1 and Factor_2 regression lines for Increasing and Decreasing sets. By looking at the equations, I can see that they are more similar for the Increasing set. How could I quantify the similarity? Would R-square be a good measurement? Bonus points: how can I do this on R? 3- Other approaches. Searching for similar questions, I found that people have suggested to use Dynamic Time Warping and Permutation Distribution Clustering. I have tried to perform DTW on these sets but I do not know if there is a way of quantifying the dis/similarity over time. I have tried the TSdist R package and measured correlation distance. I obtain a higher number for the more dissimilar series, but it is hard for me to interpret. library(TSdist) #I averaged the data for the three replicates CorDistance(Inc_factor_1 $mean,Inc_factor_2$ mean) [1] 0.536924 CorDistance(Dec_factor_1 $mean,Dec_factor_2$ mean) [1] 0.455161 Thanks! and let me know if you need more information. Permutation Distribution Clustering: https://cran.r-project.org/web/packages/pdc/index.html Dynamic Time Warping: https://cran.r-project.org/web/packages/dtw/index.html
