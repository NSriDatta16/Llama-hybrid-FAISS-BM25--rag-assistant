[site]: crossvalidated
[post_id]: 120358
[parent_id]: 
[tags]: 
How to program automated shrinkage for a subset of terms in R?

I've got data from a randomized experiment that includes a lot of covariates. I'm interested $\delta$ from a model of the form $y = g(\delta T + X'\beta+ \epsilon)$, where $T$ is randomly assigned and thereby uncorrelated with $X$. I don't need to include $X$ in the model to get unbiased estimates of $\delta$, but including $X$ will improve statistical precision. However, $X$ is pretty high-dimensionsal, and its constituents are highly correlated with each other. So including all of $X$ would overly increase degrees of freedom. Term-wise selection on the other hand is undesirable because factors might look insignificant simply because of multicollinearity. I was thinking of doing the following: Take the principal components of $X$, compute their scores for each observaiton, and merge them into my dataset. Control for all of the component scores, as $\tilde X$ Apply shrinkage to each of the $\beta$'s in $\tilde X'\beta$, with separate shrinkage parameters for each coefficient in $\beta$ Given that I don't care about any of the coefficients, PCA is fine, and given that they are uncorrelated with $T$, biased shrinkage estimates aren't a problem. And because PC's are orthogonal, shrinking one won't mess with the others. The question is how to program it. Using mgcv , I could specify them each as smooth terms with high minimum smoothing parameters (forcing them to be linear), and then using the select=TRUE option to add a penalty to the null space of the smoothing penalty. It'd be something like this: library(mgcv) m = gam(y~T+s(X1,sp = 1e15,k=3)+s(X2,sp = 1e15,k=3),...,+s(Xn,sp = 1e15,k=3) ,select=TRUE) The drawback there is that I need to spend at least 3 D.F. on each term pre-penalization, which would stop me from including all of my covariates. After penalization using a framework like the above, I'd expect the dimensionality of X to go down quite a lot. But mgcv can't fit a model with more covariates than data, pre-penalization. Are there any other approaches that'll do the same thing? (This is not off-topic, because I'm asking for advice on how to program a particular statistical procedure. Its not a general programming question.)
