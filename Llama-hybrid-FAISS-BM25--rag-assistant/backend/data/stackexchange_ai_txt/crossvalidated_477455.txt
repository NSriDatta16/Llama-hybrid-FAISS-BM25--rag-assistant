[site]: crossvalidated
[post_id]: 477455
[parent_id]: 
[tags]: 
How can I measure the Contribution VaR to measure the diversifcation

I am trying to measure the benefits of the diversification of adding several P&L distributions generated with a correlation. What I want to represent is that the quantile of the sum of overall distribution is less than or equal to the sum of the individual quantiles. And then, I wonder if it is possible to measure how much the marginal distribution has contributed to the total. In summary, I have $k$ marginal distributions $(l_1, l_2, ..., l_k)$ which represent the individual P&L and the total $L$ which is the sum of the individuals. The marginal distributions are obtained with a monte carlo simulation. In this way, the result is something like: $$ \begin{bmatrix} l_{1,1} & l_{1,2} & \cdots & l_{1,k} \\ l_{2,1} & l_{2,2} & \cdots & l_{2,k} \\ \cdots & \cdots & \cdots & \cdots \\ \cdots & \cdots & \cdots & \cdots \\ l_{n,1} & l_{n,2} & \cdots & l_{n,k} \end{bmatrix} = \begin{bmatrix} L_1 \\ L_2 \\ \cdots \\ \cdots \\ L_n \\ \end{bmatrix} $$ I can easily obtain the VaR of the marginal $l^{(99\%)}_1, l^{(99\%)}_2,... l^{(99\%)}_k$ and the total distribution $L^{(99\%)}$ with the percentile. However, as I have already mentioned I also want to measure the component var ( $CVaR(l_1), CVaR(l_2), ... CVaR(l_n))$ to obtain the benefit of the diversification as the difference between the VaR of the marginal distribution and the contribution to the total. So the benefit would be computed as: $b_i = l^{(99\%)}_i - CVaR(l_i)$ . This benefit would depend on the correlation between the marginal distribution, the amounts and the shape. And I expect that this benefit should be always positive. However, I tried two methods to obtain the CVaR: Making a window around the overall VaR, averaging them and rescaling to the VaR to make the contributions more stable. $$ CVaR(l_i)$ = \frac{E[l^{(89.5\%, 99.5\%)}_i]}{\sum E[l^{(89.5\%, 99.5\%)}_i]} \cdot L^{99\%} $$ Computing the contribution VaR with kernels as its mentioned in this paper: "Cracking VaR with kernels" from Epperlein and Smillie Unfortunately, both methods do not give me positive benefit, in other words in some marginals the CVaR is greater than the marginal VaR -> $CVaR(l_i) > l^{(99\%)}$ which it does not make sense, because the reading is that it is being harmed when joined with the others. So I wonder if it exits a method to compute the diversification in a proper way, or while I am generating the marginal distribution with a monte carlo, this it the price I have to pay for.
