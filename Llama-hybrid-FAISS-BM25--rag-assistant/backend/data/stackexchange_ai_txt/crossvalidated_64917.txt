[site]: crossvalidated
[post_id]: 64917
[parent_id]: 
[tags]: 
How do sudden spikes affect hidden Markov models

I have some data that has two sudden spikes (almost like extreme masses or Dirac delta functions) within my time series data and I was wondering if that is a problem when building hidden Markov models. Here is a plot of my data to illustrate the point: I am trying to use HMM to estimate the number of latent states in the data (using the RHmm package) but I keep running into NaN problems when I get data sets with these spikes. Does anyone have an explanation for why this is or how I can alleviate this problem? If it helps, here is some R code I wrote that illustrates the point as well: library(RHmm) y = c(100,rnorm(10000)) #This code works fine HMMFit(y[-1],nStates=2) #This code doesn't HMMFit(y,nStates=2) And the output: > y = c(100,rnorm(10000)) > > #This code works fine > HMMFit(y[-1],nStates=2) Call: ---- HMMFit(obs = y[-1], nStates = 2) Model: ------ 2 states HMM with univariate gaussian distribution Baum-Welch algorithm status: ---------------------------- Number of iterations : 21 Last relative variation of LLH function: 0.000001 Estimation: ----------- Initial probabilities: Pi 1 Pi 2 0.4468508 0.5531492 Transition matrix: State 1 State 2 State 1 0.7607666 0.2392334 State 2 0.5074063 0.4925937 Conditionnal distribution parameters: Distribution parameters: mean var State 1 0.03591381 1.1009758 State 2 -0.04717922 0.7706617 Log-likelihood: -14171.31 BIC criterium: 28407.1 AIC criterium: 28356.62 > > > > > #This code doesn't > HMMFit(y,nStates=2) Call: ---- HMMFit(obs = y, nStates = 2) Model: ------ 2 states HMM with univariate gaussian distribution Baum-Welch algorithm status: ---------------------------- NO CONVERGENCE AFTER 1 ITERATIONS PROBLEM IN BAUM-WELCH'S ALGORITHM Last Estimation: ---------------- Initial probabilities: Pi 1 Pi 2 NaN NaN Transition matrix: State 1 State 2 State 1 NaN NaN State 2 NaN NaN Conditionnal distribution parameters: Distribution parameters: mean var State 1 NaN NaN State 2 NaN NaN Log-likelihood: NaN BIC criterium: NaN AIC criterium: NaN
