[site]: crossvalidated
[post_id]: 123044
[parent_id]: 112179
[tags]: 
Suppose your data are in a SAS data set called Stitches and are organized like this: Procedure Patient Stitch Time 1 1 Treatment 0.0 1 1 Treatment 1.0 1 1 Control-1 1.5 1 1 Control-1 0.0 1 2 Treatment 1.0 1 2 Control-1 0.0 1 3 Treatment 1.5 1 3 Control-2 3.0 ... 2 25 Treatment 0.0 2 25 Control-1 1.0 2 25 Control-1 0.5 Then, here is some untested SAS code that will fit a very minimal linear model: proc mixed data=Stitches; class Procedure Stitch Patient; model Time = Procedure Stitch Procedure*Stitch; random Patient(Procedure); run; If you have a lot of zeroes, this probably isn't going to fit well. If the data distribution is too granular, this probably isn't going to fit well. It's probably not going to fit well, is what I'm saying. I definitely agree with Masato Nakazawa that it would be nice to incorporate a random effect for surgeon if that makes sense, and also a fixed effect representing stitch order. You could start with stitch order as a simple covariate (i.e., don't put it in the CLASS statement). Again, untested code, but you can morph the code above in SAS to use a generalized linear mixed effect model and either use Masato Nakazawa's suggestion of negative binomial link or a Poisson link as a starting point: proc glimmix data=Stitches; class Procedure Stitch Patient; model Time = Procedure Stitch Procedure*Stitch / dist=poisson link=log; random Patient(Procedure); run; If appropriate, you could use least squares means as a first cut to evaluating differences among stitch treatments: lsmeans Stitch / cl pdiff ilink; Or, you could set up a contrast between the new treatment and the average of the two controls. I would keep the procedure type in the model. After all, if it is truly unimportant, then it isn't going to hurt much to lose a few degrees of freedom. There are many issues that may crop up for you, though. With the linear model approach, there's most likely going to be some fit problems. It might still be pragmatic to use that approach. With the generalized linear model approach, you may have fitting problems. If the interaction of procedure and stitch is significant, then you should probably slice out your results by procedure. For model structure, you could make arguments that the stitches of the same type within a patient might be better considered sub-samples. Or, you might have position effects as well as stitch order effects. Right now, this model just assumes that patients differ in their clotting time. Model diagnostics should be assessed. The data should be plotted. Again, all this code is untested, as I don't have SAS on this machine right now! I hope someone will correct me if I mis-specified it!
