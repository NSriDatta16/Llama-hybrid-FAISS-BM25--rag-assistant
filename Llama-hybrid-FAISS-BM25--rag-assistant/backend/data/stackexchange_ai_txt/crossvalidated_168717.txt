[site]: crossvalidated
[post_id]: 168717
[parent_id]: 
[tags]: 
segmentation of univariate irregular time series

this is my first post. I have an irregular time series that exhibits large shifts in both mean and in the direction of the trend. It looks something like this (though this is far cleaner than reality): set.seed(1) x = sort(rep(seq(as.POSIXct('2015/01/01'),as.POSIXct('2015/01/10'),by='day'),100) + runif(1000,0,80000)) y = c(seq(300),seq(90,70,-.2),seq(20,50,.1),seq(238.5,90,-.5)) + runif(1000,50,80) plot(x,y) The task is to: 1. accurately partition/segment the data 2. extract the change point indices 3. fit regression separately for each segment I have tried several routes, including: a) hierarchical clustering based on dissimilarity matrix b) function cpt.mean/var/meanvar from package changepoint (does not seem to work well) c) function 'breakpoints' from package strucchange (slow and often inaccurate) d) various types of kmeans (inappropriate, I know) I have also explored some other packages, such as TSclust, urca, and DTW, but these seem better suited to clustering sets of time-series, not individual values within a time series. Can someone point me in the correct direction? Perhaps I am not considering the appropriate data model? UPDATE Thank you all for your very considered responses. I went back to the strucchange package, and after some fiddling, have gotten it to work quite well. I had not initially appreciated the h 'minimal segment size' argument. Finished product:
