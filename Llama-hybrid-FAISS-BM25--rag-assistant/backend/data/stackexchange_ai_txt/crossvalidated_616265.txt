[site]: crossvalidated
[post_id]: 616265
[parent_id]: 616255
[tags]: 
Intuitively, this should make sense : to compute the expected value of $\log q(Y)$ , you can look at the expected value of $\log q (x+U)$ for each $x\in \mathcal X$ and average the result by the "mass" of each $x$ . The mathematical equivalent of this intuitive explantion is provided by the law of total expectation (LTE), according to which we have $$\int\log q(y) p(y)\ dy=:\mathbb E[\log q(Y)] \stackrel{(LTE)}{=} \mathbb E_X \big[\mathbb E_U[\log q(X + U)\mid X]\big] $$ Now, since $U\sim\text{Uniform}([0,1])$ , we can compute for all $x\in\mathcal X$ : $$\mathbb E_U[\log q(X + U)\mid X=x] = \int_0^1 \log q(x+u )\ du$$ From which it follows that $$\begin{align*} \mathbb E[\log q(Y)] &= \mathbb E_X \big[\mathbb E_U[\log q(X + U)\mid X]\big] \\ &= \sum_{x\in \mathcal X} P(x)\mathbb E_U[\log q(X + U)\mid X=x]\\ &= \sum_{x\in \mathcal X} P(x) \int_0^1 \log q(x+u )\ du \end{align*} $$ As desired.
