[site]: crossvalidated
[post_id]: 615519
[parent_id]: 
[tags]: 
Bang and Robins doubly-robust estimator biased and with large variance?

In their 2005 paper (also see the correction here ) Bang and Robins describe a doubly robust estimator of the average treatment effect. In short, the procedure is: Estimate inverse probability of treatment weights (IPTW). These are $1 / Pr[A=1|L]$ for those with $A = 1$ and $-1 / (1 - Pr[A=1|L])$ for those with $A=0$ , for treatment $A$ and vector of confounders $L$ . Then, include the IPTW in the conditional mean outcome model as a 'clever covariate': $E[Y|A,L,R]$ , where $R$ is the weights defined above. Finally, standardise over the confounder distribution of the sample. In the words of the Bang and Robins correction: ...see that we must add to the regression the inverse probability of treatment weighted (IPTW) covariate, which is the (estimated) inverse of the PS for treated subjects(Δ= 1)and the inverse of the negative of “1 minus the PS” for untreated subjects(Δ= 0). Other choices can result in inconsistent estimation of the average treatment effect. I have tried to simulate simple data and test out this estimator under correct specification of the treatment and outcome models. The results I'm getting are confusing. Here is the simulation code: library(tidyverse) dr_sim mutate(out = map(seed, dr_sim)) |> unnest(out) ## results tibble( estimator = c("IPTW","g-formula","doubly-robust"), mean_estimate = c(mean(results $msm_est), mean(results$ gform_est), mean(results $dr_est)), sd_estimate = c(sd(results$ msm_est), sd(results $gform_est), sd(results$ dr_est))) And here are the results: # A tibble: 3 × 3 estimator mean_estimate sd_estimate 1 IPTW 0.000271 0.0628 2 g-formula 0.000285 0.0626 3 doubly-robust 0.0593 1.19 The IPTW marginal structural model and parametric g-formula estimators are unbiased. The doubly robust robust estimator is not. The magnitude of bias and the extent of the variance seems to depend on the strength of the confounder-treatment relationship. When the confounder strongly affects the treatment, the doubly-robust estimator is unbiased and has low variance (lower than the IPTW estimator), but when it is weak, as above, the variance and bias can be very large. Can anyone shed any light on this? Am I incorrectly implementing the estimator? Or is there something else I'm missing?
