[site]: stackoverflow
[post_id]: 3451162
[parent_id]: 
[tags]: 
How to replace HTML nodes using Nokogiri

I have an HTML file, in which, all must be replaced with The code is: doc.css("div.replace-me").each do |div| div.replace " " end It's simple, but, unfortunately, it does't work for me. Nokogiri crashes with the following error: undefined method `children' for nil:NilClass /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.5/lib/active_support/whiny_nil.rb:52:in `method_missing' /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.2/lib/nokogiri/html/document_fragment.rb:16:in `initialize' /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.2/lib/nokogiri/xml/node.rb:424:in `new' /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.2/lib/nokogiri/xml/node.rb:424:in `fragment' /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.2/lib/nokogiri/xml/node.rb:776:in `coerce' /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.2/lib/nokogiri/xml/node.rb:331:in `replace' Replacing with a div works: doc.css("div.replace-me").each do |div| div.replace " Test " end Is this a Nokogiri bug, or did I do something wrong? The same issue occurs with add_child , inner_html and other setters for this purpose.
