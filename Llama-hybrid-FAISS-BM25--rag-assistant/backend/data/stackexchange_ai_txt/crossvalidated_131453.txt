[site]: crossvalidated
[post_id]: 131453
[parent_id]: 131190
[tags]: 
Suppose you have two continuous regressors (weight and miles per gallon) and one binary regressor (foreign manufacturer). The outcome is car price and you are interested in the effect of weight on price. You can get a sense of the interactions like this: sysuse auto reg price c.mpg##c.weight##i.foreign margins, dydx(weight) at(foreign = (0 1) mpg =(10(10)40) weight = (2000(1000)3000)) marginsplot, bydimension(foreign weight) Note that you can calculate interactions on the fly using factor variable notation. This ensures that Stata understands how all the variables are related in calculating derivative. The expected price is $$E[p \vert w,m,f]=\beta_0 + \beta_1 w + \beta_2 m + \beta_3 f +\beta_4 w\cdot m+\beta_5 w \cdot f +\beta_6m\cdot f + \beta_7 w\cdot m \cdot f$$ The derivative with respect to weight (aka the conditional marginal effect of weight) is $$\frac{\partial E[p \vert w,m,f]}{\partial w}= \beta_1 + \beta_4 m+\beta_5 \cdot f + \beta_7 m \cdot f,$$ which is a linear function of foreign and mpg. The margins command calculates this derivative evaluated at various combinations of foreign and mpg that I have selected, and marginsplot produces a graph of the derivative of the expected price with respect to weight for light and heavy domestic and foreign cars at various values of mileage. You could also have other regressors in the model, in which case the marginal effect would average over their effects: For instance, let's look at the first panel. For a very efficient light domestic car, an additional pound has negligible effect on the price. For an inefficient one, it adds $6.50 to the price tag. If you are interested in formally testing that these derivatives are different at various values of mpg, you can calculate contrasts of margins like this: margins r.foreign, dydx(weight) at(mpg = (10(10)40)) marginsplot This tests the null that the derivative of expected price with respect to weight is the same for foreign and domestic casts at various values of mpg. It also gives you an overall test that all four differences are jointly zero. It probably makes sense to make some adjustment for multiple comparisons, though I have not done that here. A really nice introduction to these commands is Michael N. Mitchell's Interpreting and Visualizing Regression Models Using Stata . Chapter 13 deals with continuous by continuous by categorical interactions.
