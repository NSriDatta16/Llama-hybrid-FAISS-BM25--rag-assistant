[site]: stackoverflow
[post_id]: 1369174
[parent_id]: 1126545
[tags]: 
SMB runs by default on port 445. So you can just log traffic on port 445 (or whatever port(s) you happen to be running it on) and massage that easily enough into whatever data you need. I'd do it with WinPcap and WinDump (Windows versions of libpcap and tcpdump). Defining custom rules (say, to record data on only one or on a range of ports) is easy. Check out the 'expression' section of the manual . There are parsers available in a lot of different languages for the data files. A quick search will find you what you need.
