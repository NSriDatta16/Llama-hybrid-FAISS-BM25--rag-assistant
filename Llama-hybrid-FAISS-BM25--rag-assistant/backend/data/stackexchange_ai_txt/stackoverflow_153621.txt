[site]: stackoverflow
[post_id]: 153621
[parent_id]: 153585
[tags]: 
One option would be for you to use a cursor to loop through all the customer Id's, then do the averages as several subqueries. Fair warning though, for large datasets, queries are not very efficient and can take a long time to process.
