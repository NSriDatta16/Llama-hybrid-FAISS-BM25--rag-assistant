[site]: stackoverflow
[post_id]: 3984427
[parent_id]: 
[tags]: 
Need help with my COBOL homework

Sorry to bother you all but I am stuck on my homework for COBOL. I've made two attempts, neither of which is working as expected. The two attempts and their output are shown below followed by the final results it needs to be. I thank you all for your help. First attempt: IDENTIFICATION DIVISION. PROGRAM-ID. MAIL-LABEL. * ****************************************************************** * This program prints duplicate side by side mailing labels. ****************************************************************** ENVIRONMENT DIVISION. INPUT-OUTPUT SECTION. FILE-CONTROL. SELECT LABEL-FILE-IN ASSIGN TO 'MAIL-LABEL.SEQ' ORGANIZATION IS LINE SEQUENTIAL. SELECT LABEL-FILE-OUT ASSIGN TO 'MAIL-LABEL.RPT' ORGANIZATION IS LINE SEQUENTIAL. DATA DIVISION. FILE SECTION. FD LABEL-FILE-IN. 01 LABEL-RECORD-IN. 05 NAME-IN PIC X(20). 05 ADDRESS-IN PIC X(20). 05 CITY-STATE-ZIP-IN PIC X(20). FD LABEL-FILE-OUT. 01 LABEL-RECORD-OUT. 05 LEFT-LABEL-OUT PIC X(20). 05 BLANK-OUT PIC X(15). 05 RIGHT-LABEL-OUT PIC X(20). 05 BLANK-A-OUT PIC X(5). WORKING-STORAGE SECTION. 01 ARE-THERE-MORE-RECORDS PIC X(3) VALUE 'YES'. PROCEDURE DIVISION. 100-MAIN. OPEN INPUT LABEL-FILE-IN OPEN OUTPUT LABEL-FILE-OUT PERFORM UNTIL ARE-THERE-MORE-RECORDS = 'NO' READ LABEL-FILE-IN AT END MOVE 'NO' TO ARE-THERE-MORE-RECORDS NOT AT END PERFORM 200-PROCESS-ONE-RECORD END-READ END-PERFORM CLOSE LABEL-FILE-IN CLOSE LABEL-FILE-OUT STOP RUN. 200-PROCESS-ONE-RECORD. MOVE NAME-IN TO LEFT-LABEL-OUT MOVE ADDRESS-IN TO BLANK-OUT MOVE CITY-STATE-ZIP-IN TO RIGHT-LABEL-OUT MOVE SPACES TO BLANK-A-OUT WRITE LABEL-RECORD-OUT. This produces: *IAN HENDERSON 1309 SPRINGBANKDETROIT MI 48024 *JANET LEASA 12700 GRATIOT SWARREN MI 48077 *COREY HAYES 400 BRUSH ST. DETROIT MI 48024 *SCOTT TOKLEY 2003 INDIAN RD.TAYLOR MI 48075 *JUDY FISHER 2200 WOODWARD ADETROIT MI 48025 *SHAWN MITCHELL 510 HOLLYWOOD PDETROIT MI 48025 *MARCUS PILLON 1450 JOY RD DEARBORN MI 48077 *BRIAN GUENETTE 456 TRUMBULL STDETROIT MI 48024 *KIM MIKA 456 LAFAYETTE SDETROIT MI 48024 *KYLE THOMPSON 1617 MAPLE RD. WARREN MI 48056 *SUE DONALDSON 11 CASS AVE. DETROIT MI 48024 My second attempt: IDENTIFICATION DIVISION. PROGRAM-ID. MAIL-LABEL. * ****************************************************************** * This program prints duplicate side by side mailing labels. ****************************************************************** ENVIRONMENT DIVISION. INPUT-OUTPUT SECTION. FILE-CONTROL. SELECT LABEL-FILE-IN ASSIGN TO 'MAIL-LABEL.SEQ' ORGANIZATION IS LINE SEQUENTIAL. SELECT LABEL-FILE-OUT ASSIGN TO 'MAIL-LABEL.RPT' ORGANIZATION IS LINE SEQUENTIAL. DATA DIVISION. FILE SECTION. FD LABEL-FILE-IN. 01 LABEL-RECORD-IN. 05 NAME-IN PIC X(20). 05 ADDRESS-IN PIC X(20). 05 CITY-STATE-ZIP-IN PIC X(20). FD LABEL-FILE-OUT. 01 LABEL-RECORD-OUT. 05 LEFT-LABEL-OUT PIC X(20). 05 BLANK-OUT PIC X(15). 05 RIGHT-LABEL-OUT PIC X(20). 05 BLANK-A-OUT PIC X(5). WORKING-STORAGE SECTION. 01 ARE-THERE-MORE-RECORDS PIC X(3) VALUE 'YES'. PROCEDURE DIVISION. 100-MAIN. OPEN INPUT LABEL-FILE-IN OPEN OUTPUT LABEL-FILE-OUT PERFORM UNTIL ARE-THERE-MORE-RECORDS = 'NO' READ LABEL-FILE-IN AT END MOVE 'NO' TO ARE-THERE-MORE-RECORDS NOT AT END PERFORM 200-PROCESS-ONE-RECORD END-READ END-PERFORM CLOSE LABEL-FILE-IN CLOSE LABEL-FILE-OUT STOP RUN. 200-PROCESS-ONE-RECORD. MOVE NAME-IN TO LEFT-LABEL-OUT MOVE ADDRESS-IN TO LEFT-LABEL-OUT MOVE CITY-STATE-ZIP-IN TO LEFT-LABEL-OUT MOVE SPACES TO BLANK-OUT MOVE NAME-IN TO RIGHT-LABEL-OUT MOVE ADDRESS-IN TO RIGHT-LABEL-OUT MOVE CITY-STATE-ZIP-IN TO RIGHT-LABEL-OUT MOVE SPACES TO BLANK-A-OUT WRITE LABEL-RECORD-OUT produced: *DETROIT MI 48024 DETROIT MI 48024 *WARREN MI 48077 WARREN MI 48077 *DETROIT MI 48024 DETROIT MI 48024 *TAYLOR MI 48075 TAYLOR MI 48075 *DETROIT MI 48025 DETROIT MI 48025 *DETROIT MI 48025 DETROIT MI 48025 *DEARBORN MI 48077 DEARBORN MI 48077 *DETROIT MI 48024 DETROIT MI 48024 *DETROIT MI 48024 DETROIT MI 48024 *WARREN MI 48056 WARREN MI 48056 *DETROIT MI 48024 DETROIT MI 48024 What I need to end up with is something like: *IAN HENDERSON IAN HENDERSON *1309 SPRINGBANK ST. 1309 SPRINGBANK ST. *DETROIT MI 48024 DETROIT MI 48024 *JANET LEASA JANET LEASA *12700 GRATIOT ST. 12700 GRATIOT ST. *WARREN MI 48077 WARREN MI 48077 *COREY HAYES COREY HAYES *400 BRUSH ST. 400 BRUSH ST. *DETROIT MI 48024 DETROIT MI 48024 *SCOTT TOKLEY SCOTT TOKLEY *2003 INDIAN RD. 2003 INDIAN RD. *TAYLOR MI 48075 TAYLOR MI 48075 What's wrong with my code?
