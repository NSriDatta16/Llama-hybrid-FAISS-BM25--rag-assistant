[site]: stackoverflow
[post_id]: 5694103
[parent_id]: 
[tags]: 
Javascript scoping issue

I am trying to build a generic ajax loader, while ajax is running a lightbox with animated "Loading" gif will be displayed. I have some issues with scoping. The code is: var t=setTimeout( "s.d.dialog( 'destroy' )" ,(s.o.msgTime*1000)); The error is: "Uncaught ReferenceError: s is not defined" ;(function ($) { $.loader = function (data, options) { return $.loader.impl.init(data, options); }; $.loader.close = function (data) { $.loader.impl.close(data); }; $.loader.create = function () { $.loader.impl.create(); }; $.loader.defaults = { appendTo: 'body', autoCreate: true, msgTime: 5, }; $.loader.impl = { d: {}, init: function(data, options){ var s = this; s.o = $.extend({}, $.loader.defaults, options); if ((typeof data === 'object')&&!(data instanceof jQuery)&&data.url) { data.success = function(data, textStatus, jqXHR){ $.loader.close(); } data.error = function(jqXHR, textStatus, errorThrown){ $.loader.close('Error accessing server'); } $.ajax(data); }else if(s.o.autoCreate){ s.create(); } return s; }, create: function() { var s = this; s.d = $(' ').appendTo(s.o.appendTo); s.d.dialog({ title: 'Loading ...', dialogClass: 'noTitleStuff', modal: true, draggable: false, resizable: false }); }, close: function(data) { var s = this; //alert(typeof s.d); if ((typeof data === 'string')&&data) { $("#loading_diag").hide(); $("#dialog").html(data); var t=setTimeout( "s.d.dialog( 'destroy' )" ,(s.o.msgTime*1000)); }else{ s.d.dialog( "destroy" ); } s.d= {}; }, }; })(jQuery); If anybody knows how to solve it please share. The first and second solution did something but havent fixed it completely, now i am getting a different error: "Uncaught TypeError: Object # has no method 'dialog' $.loader.impl.close.s.d"
