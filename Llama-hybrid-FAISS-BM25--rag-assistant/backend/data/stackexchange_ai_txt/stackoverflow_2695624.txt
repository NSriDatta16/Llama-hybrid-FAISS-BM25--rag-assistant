[site]: stackoverflow
[post_id]: 2695624
[parent_id]: 2653262
[tags]: 
JNetPcap is a library that will allow you to change headers from low level layers including TCP. http://jnetpcap.com/node/29 Here is a quick example: byte[] pktBytes = FormatUtils.toByteArray("0015c672234c90e6ba92661608004500002d358c4000800600000a000b050a090028c26e270fb8b256e3a2009f785018faf01f550000746573740a"); JMemoryPacket packet = new JMemoryPacket(pktBytes); packet.scan(Ethernet.ID); //Need to be done before doing any edits //Editing Ip layer Ip4 ip = packet.getHeader(new Ip4()); ip.source(new byte[] {2,6,0,0}); //Source Ip 2.6.0.0 ip.destination(new byte[] {1,2,3,4}); //Dest Ip 1.2.3.4 //Editing Tcp layer Tcp tcp = packet.getHeader(new Tcp()); tcp.destination(5555); //Port destination 5555 if (pcap.sendPacket(packet) != Pcap.OK) { System.err.println(pcap.getErr()); }
