[site]: stackoverflow
[post_id]: 4459484
[parent_id]: 4441948
[tags]: 
and thank you everyone who went to the trouble of sharing their thoughts. I solved the problem in the following way: When navigating from the Homepage to the new Window the following Javascript is used to open a new Window: function popupFull(url) // For explanation of this code see: http://www.quirksmode.org/js/popup.html // Note: If fullscreen = 1 you can't see the menubar, toolbar, status etc. // It is advisable to have no spaces around the commas in the parameters. { //alert("Opening: " + url) // Prepare the parameter string params = 'width='+screen.width; params += ',height='+screen.height; params += ',top=0,left=0'; params += ',fullscreen=0'; params += ',menubar=0'; params += ',toolbar=0'; params += ',directories=0'; params += ',status=0'; params += ',scrollbars=0'; params += ',resizable=1'; // Open a new window. newWin=window.open(url, "fullWindow", params); // If the current Window is in focus, switch focus to the new Window. if (window.focus) { newWin.focus() } // Return the new Window object reference. return newWin; } So the new Window can be opened and I have left the Homepage Window open but out of focus behind the new Window. In the new Window there is a 'Menu' button. Clicking on this calls the following Javascript function: function openMenu(winURL, winName, winFeatures) { // Create a reference of the Window which opened this Window. This should be // the Main Menu Window. var winObj=window.opener; var menuOuterWidth = 1080; var menuOuterHeight = 896; var menuInnerWidth = 1068; var menuInnerHeight = 767; var menuX = (screen.width - menuOuterWidth) / 2; var menuY = (screen.height - menuOuterHeight) / 2; // Prepare the parameter string for re-opening the Menu params = 'width='+menuInnerWidth; params += ',height='+menuInnerHeight; params += ',top='+menuY+',left='+menuX; params += ',fullscreen=0'; params += ',menubar=1'; params += ',toolbar=1'; params += ',status=1'; params += ',scrollbars=1'; params += ',location=1'; params += ',resizable=1'; try { // Check to see if the window reference already exists. if (winObj) { // Check to see if the Menu window is closed. if (winObj.closed) { // The Menu window is closed. // Open the Menu Window. winObj = window.open(winURL, winName, params); // Close this Course Window. window.close(); // Return the Menu Window object reference should the caller want it. return winObj; } else { // The Menu Window has not been closed. Set the Window's size and position. // Note: When resizing the outerWidth/outerHeight value has to be passed. winObj.window.resizeTo(menuOuterWidth, menuOuterHeight); winObj.window.moveTo(menuX, menuY); // Bring it into focus (bring to front). winObj.focus(); // Close this Course Window. window.close(); // Return the Menu Window object reference should the caller want it. return winObj; } } else { // The winObj object does not exist. Open the Menu. winObj = window.open(winURL, winName, params); // Close this Course Window. window.close(); // Return the Menu Window object reference should the caller want it. return winObj; } } catch(err) { txt="There was an error on this page.\n\n"; txt+="Error description: " + err.description + "\n\n"; txt+="Click OK to continue.\n\n"; //alert(txt); // When IE6 tries to obtain the winObj.closed property, when the window is closed, it can cause // an error "Permission Denied". This error is caught here. Open the Menu. // Open the Menu Window. winObj = window.open(winURL, winName, params); // Close this Course Window. window.close(); // Return the Menu Window object reference should the caller want it. return winObj; } } The comments should explain everything. The key is to get a reference to the Homepage Window where we started. ( var winObj=window.opener; ). What caused me such a headache was that if I opened the new Window (using IE6), switched back to the Homepage and closed the Homepage Window, and then in the new Window clicked on the 'Menu' button nothing happened! I tried everything and then, after a cup of tea, realised that I would never write code in any application I was developing without any form of error capture. I added a Try, Catch statement and reported the error in an 'alert'. I got a 'Permission Denied' error. After a lot of reading I figured I couldn't eliminate the error I would simply handle the error as elegantly as I could. This resulted in the code above. It works a treat and I hope this helps someone.
