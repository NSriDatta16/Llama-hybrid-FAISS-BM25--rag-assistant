[site]: crossvalidated
[post_id]: 559423
[parent_id]: 
[tags]: 
Which test to use to test for heteroscedasticity in a non linear model/fit?

I would like to test for heteroscedasticity in a non linear fit. I have a explanatory vector x and an explained variable y and want to detect heteroscedasticity in the data. I have a linear fit and a non-linear fit model and corresponding residuals vectors residual_linear_fit and residual_non_linear_fit . Standard test such as Breusch-Pagan require that the models be a ordinary linear regression model. Which test should I use to test for heteroscedasticity with non linear fitting. What should be the appropriate code? Here is the code (in python) to generate data import matplotlib.pyplot as plt from scipy.optimize import curve_fit import pdb import numpy as np def sigmoid(x,a): return a+(1/(1+np.exp(-x) )) def lin(x,a): return a*x x = np.arange(0,10,.05) print(len(x)) err = np.random.rand(1,len(x))/4 y = sigmoid(x,1) + err[0] plt.plot(x,y, ".") popt_lin, pcov_lin = curve_fit(lin, x, y) residuals_lin = y-lin(x, *popt_lin) plt.plot(x, lin(x, *popt_lin), 'k-',) # popt_sigmoid, pcov_sigmoid = curve_fit(sigmoid, x, y) residuals_sigmoid = y-sigmoid(x, *popt_sigmoid) plt.plot(x, sigmoid(x, *popt_sigmoid), 'r-',) plt.show()
