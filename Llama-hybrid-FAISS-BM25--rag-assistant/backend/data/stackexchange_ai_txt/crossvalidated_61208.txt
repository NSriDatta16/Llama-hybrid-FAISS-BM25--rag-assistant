[site]: crossvalidated
[post_id]: 61208
[parent_id]: 61108
[tags]: 
Regarding to "...Additionally an odd error occurs where if I set evidence in a LoopyBP more than once I start getting NA ..." I think it's because you set the evidence in the same Bayesian Network iterating over all samples in a training set and then you end up with some factors having 0 probabilities for all factor values. How setEvidence() works for discrete factors is that it sets the evidence probability to 0 for all factor values incompatible with evidence. I will throw an error if setEvidence() is set for all factor values. Why would you want to set the evidence in a single bayesian network over all samples? Regarding to flat probabilities for hidden nodes, remember that EM does not guarantee to converge to a global maximum, it's quite important how you set the priors in the network. Please send me your code including training set and I will check it further. On factor graph: Bayes-scala also supports inference on a factor graphs but only for continuous and hybrid bayesian networks using Expectation Propagation algorithm, the two cases I tested include kalman robot localisation and TrueSkill rating model. And the last thing on sepsets including more than one variable. It's the current limitation of bayes-scala to allow for a single sepset variable.
