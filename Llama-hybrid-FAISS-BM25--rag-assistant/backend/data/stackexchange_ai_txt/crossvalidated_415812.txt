[site]: crossvalidated
[post_id]: 415812
[parent_id]: 414945
[tags]: 
Here is an example from KFAS with two covariates and seasonal of length 12: library(KFAS) model_drivers First time point: model_drivers$Z[,,1] (Intercept) log(PetrolPrice) law sea_dummy1 sea_dummy2 sea_dummy3 sea_dummy4 sea_dummy5 sea_dummy6 sea_dummy7 sea_dummy8 sea_dummy9 sea_dummy10 sea_dummy11 1.0000 -2.2733 0.0000 1.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 And matrix T: model_drivers$T , , 1 (Intercept) log(PetrolPrice) law sea_dummy1 sea_dummy2 sea_dummy3 sea_dummy4 sea_dummy5 sea_dummy6 sea_dummy7 sea_dummy8 sea_dummy9 sea_dummy10 sea_dummy11 (Intercept) 1 0 0 0 0 0 0 0 0 0 0 0 0 0 log(PetrolPrice) 0 1 0 0 0 0 0 0 0 0 0 0 0 0 law 0 0 1 0 0 0 0 0 0 0 0 0 0 0 sea_dummy1 0 0 0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 sea_dummy2 0 0 0 1 0 0 0 0 0 0 0 0 0 0 sea_dummy3 0 0 0 0 1 0 0 0 0 0 0 0 0 0 sea_dummy4 0 0 0 0 0 1 0 0 0 0 0 0 0 0 sea_dummy5 0 0 0 0 0 0 1 0 0 0 0 0 0 0 sea_dummy6 0 0 0 0 0 0 0 1 0 0 0 0 0 0 sea_dummy7 0 0 0 0 0 0 0 0 1 0 0 0 0 0 sea_dummy8 0 0 0 0 0 0 0 0 0 1 0 0 0 0 sea_dummy9 0 0 0 0 0 0 0 0 0 0 1 0 0 0 sea_dummy10 0 0 0 0 0 0 0 0 0 0 0 1 0 0 sea_dummy11 0 0 0 0 0 0 0 0 0 0 0 0 1 0 You can probably figure out the logic here, essentially the first row of seasonal part is full of values -1 and then there is values of 1 just below the diagonal of the seasonal part. And Z just contains one in the first entry and zeros on the rest. Then you also have to remember to add some uncertainty for the seasonal states, i.e. prior state_1 ~ N(prior_mean, prior_variance). With this model and wide priors for the variance parameter H, you should get the same results with KFAS as with some Bayesian solutions, so you can use KFAS to check the results even if you want to do fully Bayesian inference. And there is also an R package bssm which you can use for these kind of models directly for fully Bayesian inference (check functions bsm and run_mcmc ).
