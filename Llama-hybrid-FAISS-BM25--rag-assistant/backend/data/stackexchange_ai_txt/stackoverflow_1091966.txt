[site]: stackoverflow
[post_id]: 1091966
[parent_id]: 1086814
[tags]: 
This is a guess, but from the StgOpenStorage API documentation: When the STGM_DIRECT flag is specified, only one of the following combination of flags may be specified from the access and sharing groups STGM_READ | STGM_SHARE_DENY_WRITE STGM_READWRITE | STGM_SHARE_EXCLUSIVE STGM_READ | STGM_PRIORITY Be aware that direct mode is implied by the absence of STGM_TRANSACTED. That is, if neither STGM_DIRECT nor STGM_TRANSACTED is specified, STGM_DIRECT is assumed. This suggests that changing the flags to STGM_READ | STGM_SHARE_DENY_NONE | STGM_TRANSACTED should do what you want. This makes sense: in 'direct' mode, if anyone could start writing to the storage, then they would overwrite what we were reading.
