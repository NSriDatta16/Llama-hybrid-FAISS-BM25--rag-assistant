[site]: stackoverflow
[post_id]: 2422671
[parent_id]: 
[tags]: 
OAuth with Digg API

I'm attempting to get Rails to play nice with the Digg API's OAuth. I'm using the oauth gem (ruby one, not the rails one). My code looks approximately like this: @consumer = OAuth::Consumer.new(API_KEY, API_SECRET, :scheme => :header, :http_method => :post, :oauth_callback => "http://locahost:3000", :request_token_url => 'http://services.digg.com/1.0/endpoint?method=oauth.getRequestToken', :access_token_url => 'http://services.digg.com/1.0/endpoint?method=oauth.getAccessToken', :authorize_url => 'http://digg.com/oauth/authorize') @request_token = DiggController.consumer.get_request_token({ :oauth_callback => "http://xx.xxx.xxx.x:3000/digg/callback" }, { 'Content-Type' => 'application/x-www-form-urlencoded' }) session[:request_token] = @request_token.token session[:request_token_secret] = @request_token.secret redirect_to @request_token.authorize_url Which is by-the-book in terms of what the gem documentation gave me. However, Digg spits a "400 Bad Request" error back at me when @consumer.get_request_token is called. I can't figure out what I'm doing wrong. Any ideas? Edit: Code updated and Wireshark output added. My error is now "401 Authorization Required". Output from Wireshark: POST /1.0/endpoint?method=oauth.getRequestToken HTTP/1.1 Accept: */* Connection: close User-Agent: OAuth gem v0.3.6 Content-Type: application/x-www-form-urlencoded Authorization: OAuth oauth_nonce="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx", oauth_callback="http%3A%2F%2Fxx.xxx.xxx.x%3A3000%2Fdigg%2Fcallback", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1268687137", oauth_consumer_key="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx", oauth_signature="xxx%2Bxxxxxxxxxxxxxxx%2Fxxxxxxx%3D", oauth_version="1.0" Content-Length: 48 Host: services.digg.com Content-Type=application%2fx-www-form-urlencoded HTTP/1.1 401 Authorization Required Date: Mon, 15 Mar 2010 21:05:37 GMT Server: Apache X-Powered-By: PHP/5.2.9-digg8 Cache-control: private X-RateLimit-Current: 1 X-RateLimit-Max: 1000 X-RateLimit-Reset: 3600 X-Digg-Api-Version: 1.0 Accept-Ranges: bytes Content-Length: 111 Keep-Alive: timeout=5, max=9998 Connection: Keep-Alive Content-Type: text/xml;charset=utf-8
