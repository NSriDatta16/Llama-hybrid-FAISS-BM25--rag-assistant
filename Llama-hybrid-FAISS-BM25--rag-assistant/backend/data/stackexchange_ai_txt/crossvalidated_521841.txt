[site]: crossvalidated
[post_id]: 521841
[parent_id]: 
[tags]: 
Regression line Scatterplot R (Time Series)

I am trying to do an interrupted time series analysis, while my knowledge about this is quite limited, though I dig deeper and deeper every day. I am interested if the price of a certain wine is influenced by a treatment especially on a short-term basis (level). Example from a dataset called Pavie : `Lot closed` price Treatment `Time since treatment` 54 2014-11-20 00:00:00 268. 0 0 55 2015-03-21 00:00:00 309. 0 0 56 2015-03-28 00:00:00 247 0 0 57 2015-06-18 00:00:00 247 0 0 58 2015-06-18 00:00:00 247 0 0 59 2015-06-18 00:00:00 247 0 0 60 2015-09-19 00:00:00 334. 1 1 61 2015-10-17 00:00:00 288. 1 2 62 2015-10-17 00:00:00 309. 1 3 63 2015-12-16 00:00:00 309. 1 4 64 2016-03-19 00:00:00 329. 1 5 65 2016-06-04 00:00:00 412. 1 6 Using the whole data set to produce a scatterplot, implement a vertical line to show the treatment and add a regression line. plot(Pavie $`Lot closed`, Pavie$ price) abline(v=as.numeric(Pavie $`Lot closed`[59]), lwd=2, col='red') tsPavie price ~ Pavie $`Lot closed` + Pavie$ Treatment + Pavie$`Time since treatment`, data=Pavie ) lines( Pavie $`Lot closed`, tsPavie$ fitted.values, col="steelblue", lwd=2 ) This gives me the following plot: 2 questions: Why is the pre-treatment regression line straight, and post-intervention isn't? Where is my mistake (either in coding or thinking)? The treatment happened on 2015-06-29, how do I code such a line, that the treatment is exactly specified (at this day, there is no price given)?
