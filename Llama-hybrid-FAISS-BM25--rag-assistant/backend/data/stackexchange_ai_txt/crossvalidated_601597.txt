[site]: crossvalidated
[post_id]: 601597
[parent_id]: 
[tags]: 
How to smoothen state probabilistic time series?

I have an array of where each columns represents the probability of being in a certain state and rows represent time indexes. Each one of the rows sum up to one (we always are in one state). \begin{align*} % to put reference remove * and replace \\ by \label{pred-ME} \\ x_{i, j} &\in [0, 1]^{n, T}\\ \sum_{i=1}^{n} x_{i, t} &= 1, \quad\forall t\in {1, \dots, T}, \end{align*} where n is the number of states and T is the number of time indices. If we take an argmax from each row and assign that as our state the state transitions become quite noisy as the probabilities are independent from one time index to other time index. In my current attempt I take a mowing window and apply mode function for each window which smoothens out the state transitions but is there anything more sophisticated solutions? I was thinking about Markov chains but they are only dependent on the previous state so they might not be the smartest solution. If it matters I have reference data how the state transitions should behave (e.g. [1, 1, 1, 2, 2, 1, 1, 3, ...])
