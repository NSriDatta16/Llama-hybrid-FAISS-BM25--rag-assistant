[site]: crossvalidated
[post_id]: 300905
[parent_id]: 
[tags]: 
Using information about covariance between ARIMA models in forecasting

I'm interested in how to incorporate information about the covariances of related timeseries from multiple univariate forecasts into each forecast. The ultimate goal of this is to implement hierarchical forecasts with prediction intervals, I am not considering a VAR here, I thought that this merited a separate simulation question as it is sufficiently general as to be of wider interest. I will link to the other question when I've written it up. I want to check that the following approach works, that is, if there are statistical issues with this approach. I've tried to keep the code readable and am only really worried about it insofar as there's a statistical issue. I have two correlated time series, the data here are just for the purposes of an example: library(tidyverse) library(hts) library(MASS) exampledata I fit models to each of the series, and build a variance-covariance matrix of the residuals - in this I think I am following the estimation strategy of this paper: https://robjhyndman.com/publications/mint/ , in particular page 11, method 4. allr Variance-Covariance matrix of residuals: # inspecting the matrices fullcovmat fullcovmat %>% cov2cor I can now simulate from the residuals using mvrnorm, assumption being that the residuals are jointly normally distributed, perhaps the assumption of joint normality here is too strong, I understand that without specific data only horoscopic advice can be given on this. intervalsone % unlist %>% ts(start = 17), col = "red") } plot(forecast(auto.arima(ally[,2]), level = 95)) for(i in 1:3){ lines(ints2[i,] %>% unlist %>% ts(start = 17), col = "red") }
