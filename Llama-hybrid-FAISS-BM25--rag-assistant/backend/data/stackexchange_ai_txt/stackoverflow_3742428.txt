[site]: stackoverflow
[post_id]: 3742428
[parent_id]: 3187087
[tags]: 
I suggest a high-tech method, which very few people know: reading the documentation. man pcap tells us there are actually two different lengths available: caplen a bpf_u_int32 giving the number of bytes of the packet that are available from the capture len a bpf_u_int32 giving the length of the packet, in bytes (which might be more than the number of bytes available from the cap- ture, if the length of the packet is larger than the maximum num- ber of bytes to capture) An example in C: /* Grab a packet */ packet = pcap_next(handle, &header); if (packet == NULL) { /* End of file */ break; } printf ("Got a packet with length of [%d] \n", header.len); Another one in Python with the pcapy library : import pcapy reader = pcapy.open_offline("packets.pcap") while True: try: (header, payload) = reader.next() print "Got a packet of length %d" % header.getlen() except pcapy.PcapError: break
