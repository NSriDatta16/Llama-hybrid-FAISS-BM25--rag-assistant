[site]: stackoverflow
[post_id]: 3789090
[parent_id]: 3788552
[tags]: 
Itzik Ben Gan writes a lot about these "gaps and islands" problems. His row_number solution to this is WITH C AS ( SELECT N, ROW_NUMBER() OVER (ORDER BY N) AS RN FROM t ) SELECT Cur.N+1,Nxt.N-1 FROM C AS Cur JOIN C AS Nxt ON Nxt.RN = Cur.RN+1 WHERE Nxt.N-Cur.N>1 And a solution without row_number from the same source. SELECT N+1 AS start_range, (SELECT MIN(B.N) FROM t AS B WHERE B.N > A.N)-1 AS end_range FROM t AS A WHERE NOT EXISTS(SELECT * FROM t AS B WHERE B.N = A.N+1) AND N
