[site]: stackoverflow
[post_id]: 1615766
[parent_id]: 1614282
[tags]: 
Ill try to describe how it works now more detailed in answer, because comments have fixed length=) Here is recieve sequence: 1. Service recieves messages from MSMQ(number of messages can differ-atm it uses 500 messages bulk packet). 2. Then refines distinct device Ids. 3. For each device id it uses MS EntLib isolated storage cache with structure: DeviceId --> List where DeviceId is lookup key. 4. If we have more then 1k messages in cache - write them into db in one sequence and after write "index" to lookup table: Index: id serial_id index_start_datetime index_end_datetime index_first_dataid index_last_dataid 5. Cleans cache for this DeviceId Also i store data in couples: id data1 data2 type for example lat lon, speed course, adc1 adc2, dio1,dio2 and if there is no coupled value: value 0 I choose double because i can store every type of data devices send in it. The dont send strings, but most of em are csv style like 1,0,23,50.0000N30.00000,1,2,12,0,1,2 etc. Even alarms and etc have same type of data. When I need to get some data i just find indexes for given datetime window and DeviceId and get actual data knowing when it starts and ends. And there is no complex queryes. Just 2 simple ones. Other code is interpreting this using some protocol "mappings". Thanks for EAV tip. I think it fits well. First table Track is for agregating messages and getting em quickly in retrival algorithm i described couple strings before.
