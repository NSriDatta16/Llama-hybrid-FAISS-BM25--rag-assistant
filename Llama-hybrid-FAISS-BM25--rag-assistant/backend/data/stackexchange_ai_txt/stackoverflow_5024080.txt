[site]: stackoverflow
[post_id]: 5024080
[parent_id]: 5023238
[tags]: 
Assuming the data you have given, this problem is well within Perl's grasp without a database: my %data; while (my $line = ) { chomp $line; my ($c1, $c2, undef, @cols) = split /\|/, $line, -1; $data{"$c1|$c2"}[$_] += $cols[$_] for 0 .. $#cols; } print join('|' => $_, @{ $data{$_} }), "\n" for sort keys %data; __DATA__ A|B|C|100|200|300 A|B|C|200|100|0 A|X|C|100|100|100 which prints: A|B|300|300|300 A|X|100|100|100 You will of course need to code in the remaining transforms, but this should give you a start. Even if it turns out you need to access the raw rows more than once, assuming your data is not gigantic, you could load it into a two dimensional array, and then run your passes over it. Or you could use Tie::File to access a very large file without reading it all in.
