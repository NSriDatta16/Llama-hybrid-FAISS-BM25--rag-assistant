[site]: crossvalidated
[post_id]: 315127
[parent_id]: 315099
[tags]: 
First note that you can calculate the covariance function from the model. Note that the covariance for all pair of rows is the same as their distribution is different only in their mean. $$ \gamma\left(h\right) = Cov\left(X_{j,k},X_{j,k+h}\right) = \sum_{t = 0}^{p-1} \sum_{s = 0}^{p-1} \rho_t \rho_s Cov\left(Z_{j,k+s},Z_{j,k+h+t}\right) \\ = \begin{cases} \sum_{t = 0}^{p-1 - \left|h\right|} \rho_t \rho_{t+\left|h\right|} & \left|h\right| The covariance matrix between the rows will be $$ \Sigma_{i,j} = \gamma\left(\left| i - j\right|\right) $$ Now, we can generate the data, and compute the empirical covariance. We'll generate $n$ vectors of length $d$, where each is a moving average of $p+d-1$ random variables with windows of size $p$. # Calculate d moving averages with window size p out of vector of size p+d-1 ma Note that in the models parameters I choose, $\Sigma_{i,j} = \max\left\lbrace p - \left|i-j\right|, 0 \right\rbrace$.
