[site]: stackoverflow
[post_id]: 5532834
[parent_id]: 
[tags]: 
How to keep facebook login without browser alive in .NET?

I am logging in to facebook using a HTTPWebRequest in .NET, it works fine returning home.php logged in, but if I try to load another page it does not do it as logged in. I have tried saving the cookie from the home return but still does not work. Any help would be appreciated. I have the following code: try { //Get Cookies strURL = "https://login.facebook.com/login.php"; request =(HttpWebRequest) HttpWebRequest.Create(strURL); request.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.204 Safari/534.16"; request.Method = "GET"; request.CookieContainer = cookieJar; response = (HttpWebResponse)request.GetResponse(); foreach (System.Net.Cookie tempCookie in response.Cookies) { cookieJar.Add(tempCookie); } //Send the post data now request = (HttpWebRequest)HttpWebRequest.Create(strURL); request.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.204 Safari/534.16"; string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x"); request.Method = "POST"; request.AllowAutoRedirect = true; request.CookieContainer = cookieJar; request.ContentType = "multipart/form-data; boundary=" + boundary; request.KeepAlive = true; StreamWriter writer = new StreamWriter(request.GetRequestStream()); writer.Write("email=xxx@gmail.com&pass=xxx&persistent_inputcheckbox=on"); writer.Close(); response = (HttpWebResponse)request.GetResponse(); CookieContainer loggedInCookies = new CookieContainer(); foreach (Cookie tempCookie in response.Cookies) { loggedInCookies.Add(tempCookie); } //Get the data from the page StreamReader stream = new StreamReader(response.GetResponseStream()); string data = stream.ReadToEnd(); response.Close(); if (data.Contains(" Facebook") == true) { //LOGGED IN SUCCESSFULLY } return loggedInCookies; } catch (Exception ex) { return null; }
