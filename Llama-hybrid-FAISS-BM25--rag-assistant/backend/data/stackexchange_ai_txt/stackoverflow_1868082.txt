[site]: stackoverflow
[post_id]: 1868082
[parent_id]: 1867810
[tags]: 
I have this piece of code to check whether a file is a PE file and a managed assembly. It's quite easy to use: var files = Directory.GetFiles ( Directory.GetCurrentDirectory (), "*.dll", SearchOption.AllDirectories); var potentialEffects = new List (); foreach (var file in files) { if (!Image.IsAssembly (file)) continue; var assembly = Assembly.LoadFile (filepath); potentialEffects.AddRange (assembly.GetTypes ()); } For what it's worth, a little benchmark shows that it's twice as fast on my machine compared to the exception Assembly.LoadFrom will trigger. On the other hand, it will lose a bit of time in the valid case. So it's a matter of timing the average case.
