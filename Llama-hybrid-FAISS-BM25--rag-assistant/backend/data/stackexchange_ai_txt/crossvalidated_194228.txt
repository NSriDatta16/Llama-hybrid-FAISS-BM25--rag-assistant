[site]: crossvalidated
[post_id]: 194228
[parent_id]: 
[tags]: 
Average conditional variance

Related to Explanatory power of variable . Given a data for 1d variable $Y$ and multidimensional variable $X$, what is the best way to compute average conditional variance of $Y$ given $X$: $$ \Bbb V(Y|X) := \Bbb E\left[\Bbb E\left[\left(\left.Y - \Bbb E[Y|X]\right)^2\right|X\right]\right]. $$ I think, I should first simplify and get $$ \Bbb V(Y|X) = \Bbb EY^2 - \Bbb E\left[\Bbb E[Y|X]^2\right]. $$ The first term is easy to estimate, so I wonder about the second one. Preferrably I'd used something available in python libraries. For example, I found an implementation of Alternative Conditional Expectation, hence I can just compute the latter, square it and take the mean over the data. However, in that case I first disintegrate the data, and the integrate it back, which may introduce unnecessary errors. Since I'm interested in the average of the squared conditional expectations, rather than in the conditional expectation per point, maybe there is an easier way to compute it?
