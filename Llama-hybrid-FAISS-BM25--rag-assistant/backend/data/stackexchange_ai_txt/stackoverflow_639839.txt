[site]: stackoverflow
[post_id]: 639839
[parent_id]: 638458
[tags]: 
I've found through bitter experience that using the Tag property builds fragile solutions. A type-safe way of mapping TreeNode s to XmlElement s is to create a Dictionary . It's a mite harder at first than using the Tag property, but it makes the association extremely explicit. (I just yesterday fixed a bug that came from one piece of code saving keys to objects in a Tag property while another one was expecting the Tag to contain the objects themselves.) So the code in the AfterSelect event would look something like: TreeNode n = sender as TreeNode; if (n != null) { string[] result = TreeNodeMap[n].Attributes .Select(x => x.Name + "=" + x.Value) .ToArray(); }
