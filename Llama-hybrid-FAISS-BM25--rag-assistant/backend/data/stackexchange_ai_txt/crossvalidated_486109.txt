[site]: crossvalidated
[post_id]: 486109
[parent_id]: 
[tags]: 
GAMs: specifying knots positions for thin-plate regression splines

PROBLEM STATEMENT I have many replicates of the same dataset. I want to fit the same GAM to each replicate, and then average the model coefficients and covariance matrices (Vp) from all GAMs. The best smooth for my variables is a thin-plate regression spline. However, when running the GAMs with bs = "tp", there is not information available about the position of the knots for the splines in the model. When specifying the knots, the AIC is much higher than that of the GAM where the algorithm positions the knots (R-sq also drops substantially when knots positions are given). QUESTION Is it possible to have a GAM in which I specify the knots positions, but without having a big loss of model fit? Maybe this could be done by extracting the knots positions of the GAM whose knots have been placed automatically by the algorithm, and then use them in the "knots" argument of the GAM in which I need to specify the knots positions. DUMMY CODE Note that, in my dummy example, mod_1 (GAM without specifying knots positions) has the highest AIC, while mod_2 (GAM providing knots positions) has the lowest AIC. Please pretende that it is the other way around and the lowest AIC belongs to mod_1 (or edit my code). library(tidyverse) library(mgcv) set.seed(248) # Produce a table of a dummy, ecological response variable and five predictor variables # The "soil" variable is a control (categorical) variable, and the x,y coordinates will be # controlling for spatial variation eco_data $rain), seq(900, 2900, length = 98), max(eco_data$ rain))) lim_temp $temp), seq(11, 17, length = 8), max(eco_data$ temp))) lim_xcor $xcor), seq(320000, 480000, length = 98), max(eco_data$ xcor))) lim_ycor $ycor), seq(-445000, -405000, length = 98), max(eco_data$ ycor))) # Put all knots into a list kts
