[site]: stackoverflow
[post_id]: 5211257
[parent_id]: 
[tags]: 
A somewhat complex mysql query

I'm currently working on a news database website and I can't seem to create a query to select the 5 hottest news articles. The 2 tables of the database that are affected for this query are: News - containing all news items (id, author, message, etc.) Rates - containing all ratings on news items (id, news_id, rating, etc.) Now my query should select 5 news_ids from the table Rates with the highest average rating and most votes ( so: ordered by AVG(Rating) and COUNT(*) I supposed ). I first tried to make my query as well get all info of these news_ids from the News table instantly ( using a WHERE id IN(--the query selecting the 5 hottest news_ids--) clause ) but that returned an error of my MySql Version not being cappable of using LIMIT inside of the WHERE IN clause sub-query. Well, I hope you can help me out on the first query that has to select those 5 news_ids. The query I got as for now ( but not fully working ) is: SELECT news_id FROM (SELECT news_id, AVG(rating) AS average_r, COUNT(*) AS amt_r FROM rates GROUP BY news_id ORDER BY average_r,amt_r DESC LIMIT 5 ) AS news_rates or in content with the rest of my script: $get_hot_news_ids = mysql_query("SELECT news_id FROM (SELECT news_id, AVG(rating) AS average_r, COUNT(*) AS amt_r FROM rates GROUP BY news_id ORDER BY average_r,amt_r DESC LIMIT 5) AS news_rates"); $first = 1; while($news_id = mysql_fetch_assoc($get_hot_news_ids)) { if(!$first) { $hot_news_ids .= " ,"; }else{ $first = 0; } $hot_news_ids .= $news_id['news_id']; } //print_r($hot_news_ids); $get_hot_news = mysql_query("SELECT * FROM news WHERE id IN($hot_news_ids) ORDER BY FIELD(id, $hot_news_ids)");
