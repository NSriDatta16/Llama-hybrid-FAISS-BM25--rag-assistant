[site]: crossvalidated
[post_id]: 4456
[parent_id]: 4334
[tags]: 
You can build this model with AD Model Builder's random effects package. This is free software available at http://admb-project.org . What you will get is full information maximum likelihood solutions with the ability to try MCMC methods afterwards if you wish. The idea is to regard this as a random effects problem and integrate over the random effects via the Laplace approximation. The trick is parameterize if properly so that the Hessian with respect to the random effects is sparse. I built the model and a simulator. It seems to work well. To give you an idea I have included the ADMB source for the model. DATA_SECTION init_int nobs init_vector Y(1,nobs) vector resids(2,nobs) PARAMETER_SECTION init_number Phi1 init_number Phi2 init_bounded_number log_sigma(-5.0,5.0,2); init_bounded_number log_p1(-5.0,5.0,2); init_bounded_number log_p2(-5.0,5.0,2); objective_function_value f init_number A2 init_number B2 random_effects_vector A(3,nobs) random_effects_vector B(3,nobs) vector nu_1(3,nobs); vector nu_2(3,nobs); vector pred_Y(2,nobs); sdreport_number sigma sdreport_number p1 sdreport_number p2 PROCEDURE_SECTION f0(log_sigma,log_p1,log_p2,A2,B2); f2(3,log_sigma,log_p1,log_p2,A(3),B(3),A2,B2,Phi1,Phi2); for (int i=4;i There is a "gotcha" with this approach. Note that one can set A(i) such that Y(i)-A(i)-B(i)*Y(i-1)=0 Then if you let sigma->0 the log-likelihood -> infinity. So the "real" answer is a local maximum. You can stabilize the estimation by putting a lower bound on sigma or keeping sigma fixed at a reasonable value for a while.
