[site]: stackoverflow
[post_id]: 5472057
[parent_id]: 5441829
[tags]: 
If you're looking at doing this with PDF, RTF and DOC it might be best to approach it in a different way as they are all very different formats. Instead - if you consider attaching comments to an area of the page as opposed to a specific text selection then all you need to know about the document is which page you're looking at. A much easier task. Then you get the user to 'drag out' a comments box for an area of that page. Think of them more like sticky-notes. This way you can add comments to images as well as text and it allows a much more flexible system for support of other file formats in the future. I realise this isn't I direct answer to the question, but thought it relevant enough to post.
