[site]: stackoverflow
[post_id]: 3281481
[parent_id]: 3277133
[tags]: 
Included a reference to Microsoft Scripting Runtime, and used a Dictionary object to keep tally of frequency, then looked for index highest frequency and the corresponding key is the mode. Not the quickest/most elegant solution, but I just needed something up fast that worked. Function fnModeSingle(ByRef pValues() As Single) As Single Dim dict As Dictionary Set dict = New Dictionary dict.CompareMode = BinaryCompare Dim i As Long Dim pCurVal As Single For i = 0 To uBound(pValues) 'limit the values that have to be analyzed to desired precision' pCurVal = Round(pValues(i), 2) If (pCurVal > 0) Then 'this will create a dictionary entry if it doesn't exist dict.Item(pCurVal) = dict.Item(pCurVal) + 1 End If Next 'find index of first largest frequency' Dim KeyArray, itemArray KeyArray = dict.Keys itemArray = dict.Items pCount = 0 Dim pModeIdx As Integer 'find index of mode' For i = 0 To UBound(itemArray) If (itemArray(i) > pCount) Then pCount = itemArray(i) pModeIdx = i End If Next 'get value corresponding to selected mode index' fnModeSingle = KeyArray(pModeIdx) Set dict = Nothing End Function
