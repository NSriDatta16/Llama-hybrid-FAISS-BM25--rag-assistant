[site]: stackoverflow
[post_id]: 3938633
[parent_id]: 3927685
[tags]: 
Note: This is NOT the best method! You should be creating a new block/template for this and pass the data via another means. You should also not ever instantiate a Db connection in the view/template. With that said - here is how I implemented Commission Junction on a Magento store long before I learned how to override modules/templates/etc. app\design\frontend\enterprise\default\template\checkout\success.phtml getOrderId(); $order = Mage::getModel('sales/order')->loadByIncrementId($orderId); $orderTotal = $order->subtotal; $orderEntityId = $order->entity_id; $db = Mage::getModel('Core/Mysql4_Config')->getReadConnection(); // Retrieve ordered products $sql = sprintf(" SELECT * FROM `sales_flat_order_item` WHERE (order_id = %d);", $orderEntityId ); $orderedProducts = $db->fetchAll($sql); // Loop through each product in order foreach ($orderedProducts as $orderedProduct) { $productId = (int) $orderedProduct['product_id']; $quantity = (int) $orderedProduct['qty_ordered']; } ?> &CID= &OID= &TYPE=339032&CURRENCY=USD&METHOD=IMG" height="1" width="20">
