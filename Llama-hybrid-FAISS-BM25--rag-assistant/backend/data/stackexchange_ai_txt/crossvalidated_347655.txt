[site]: crossvalidated
[post_id]: 347655
[parent_id]: 347652
[tags]: 
Here's a simple example that illuminates how the stepAIC() function from the MASS package works. # consider the built-in mtcars data set; select variables of interest data The first 6 records in this example data set are as follows: > head(data) mpg disp hp wt Mazda RX4 21.0 160 110 2.620 Mazda RX4 Wag 21.0 160 110 2.875 Datsun 710 22.8 108 93 2.320 Hornet 4 Drive 21.4 258 110 3.215 Hornet Sportabout 18.7 360 175 3.440 Valiant 18.1 225 105 3.460 The example data set includes a total of 32 records, one for each type of car, on the variables: mpg Miles/(US) gallon disp Displacement (cu.in.) hp Gross horsepower wt Weight (1000 lbs) We'll use the variable mpg as the response variable and the variables disp, hp and wt as the predictor variables. The stepAIC() function performs backward model selection by starting from a "maximal" model, which is then trimmed down. The "maximal" model in our example is given by the commands: Model1_LM The summary associated with the maximal model is as follows: > summary(Model1_LM) Call: lm(formula = mpg ~ ., data = data) Residuals: Min 1Q Median 3Q Max -3.891 -1.640 -0.172 1.061 5.861 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 37.105505 2.110815 17.579 The "maximal" model is a linear regression model which assumes independent model errors and includes only main effects for the predictor variables. The "maximal" model is used as input for the stepAIC() function: require(MASS) fit1_LM The backward model selection produced by this function is: Start: AIC=65.83 mpg ~ disp + hp + wt Df Sum of Sq RSS AIC - disp 1 0.057 195.05 63.840 194.99 65.831 195.05 63.840 The first two rows of this output show the AIC and model formula for the "maximal" model. The next portion of the output shows what happens to the AIC value of the reduced models obtained by eliminating, in turns, each of the predictors from the "maximal" model. If the elimination of a predictor improves the "maximal" model, the AIC should become smaller. It turns out that when eliminate the predictor disp from the "maximal" model, we achieve a smaller AIC (i.e., AIC = 63.840), than the one corresponding to the "maximal" model (i.e., AIC = 65.831). This suggests that the "maximal" model can be improved by simply discarding disp. The "improved" model includes only hp and wt as predictor variables and has an AIC of 63.840. We now repeat the same process as the one described in the paragraph above - we start out with the "improved" model, eliminate each of the remaining predictors hp and wt in turns from the model and monitor how that impacts the AIC. If the AIC becomes smaller, that means that the eliminated predictor does not contribute much to the model. In our example, we cannot reduce the "improved" model's AIC by eliminating either hp or wt from the model. In fact, when we eliminate each of these predictor variables from the model, the AIC increases, suggesting the elimination has a detrimental effect on the model. So the "final" model is the one posted by R when we type the following command: fit1_LM In other words, the "final" model is: > fit1_LM Call: lm(formula = mpg ~ hp + wt, data = data) Coefficients: (Intercept) hp wt 37.22727 -0.03177 -3.87783 This model includes only hp and wt as predictor variables. We can now examine the summary of the fit of this "final" model to our data: summary(fit1_LM) The summary looks like this: > summary(fit1_LM) Call: lm(formula = mpg ~ hp + wt, data = data) Residuals: Min 1Q Median 3Q Max -3.941 -1.600 -0.182 1.050 5.854 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 37.22727 1.59879 23.285 The summary shows that both hp and wt have significant effects on mpg. Among cars with the same wt, hp is negatively associated with mpg. Among cars with the same hp, wt is negatively associated with mpg. In this example, stepAIC() was applied to the entire data set. Note that AIC is recommended as a criterion for model selection in those situations where the model will be used for predictive purposes.
