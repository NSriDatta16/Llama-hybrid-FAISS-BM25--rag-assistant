[site]: datascience
[post_id]: 40694
[parent_id]: 
[tags]: 
Renaming deep learning layers causes bad results

I created two CNN models using Keras. The models give good accuracy results. To concatenate these models together to create a multi input model, I have to change the names of the layers to be unique . So, I changed the layers names in the second model using the following code: for layer in model2.layers: layer.name = layer.name + str("_2") After changing the names of the layers, the second model gives a bad results . When I remove the code of renaming, the second model gives a good accuracy. How can I solve this problem? Is there another way to change the layers names? The complete code here: model = vgg16.VGG16(include_top=False, input_shape=(64,64,3)) inp = model.input out = model.output model2 = vgg16.VGG16(include_top=False, input_shape=(64,64,3)) for layer in model2.layers: layer.name = layer.name + str("_2") inp2 = model2.input out2 = model2.output merged = concatenate([out, out2]) merged = Dense(1024, activation='relu')(merged) merged = Dense(num_classes, activation='softmax')(merged) model_fusion = Model([inp, inp2], merged) model_fusion.summary()
