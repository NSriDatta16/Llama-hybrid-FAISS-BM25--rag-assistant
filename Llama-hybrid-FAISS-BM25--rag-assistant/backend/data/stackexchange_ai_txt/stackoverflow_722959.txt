[site]: stackoverflow
[post_id]: 722959
[parent_id]: 722922
[tags]: 
The sad truth is that C isn't really designed to encapsulate all those memory management issues. If you look at fairly high quality APIs like POSIX, you'll see that the common pattern is that you pass a pointer to a pointer to a function, which then allocates the memory, and that you later pass it again to a function that destroys it. It's not necessarily elegant, but I don't think there are many ways to make it really elegant without simulating OOP in C.
