[site]: crossvalidated
[post_id]: 237939
[parent_id]: 
[tags]: 
Why is the Haar wavelet providing better frequency discrimination than alternatives?

I'm using PyWavelets (aka "pywt") to understand the discrete wavelet transform, and I'm trying to construct a crude power spectrum of a sinusoidal time series with frequency components of 1/8 and 1/32. The length of the series is $2^{10} = 1024$; the first 200 points are plotted below: The problem is, I can't figure out why the for-educational-use-only Haar wavelet is doing a better job picking out the frequencies than the other ones from the PyWavelets package (see output below code). Can anyone explain what's going on? import numpy as np import pywt from matplotlib import pyplot as plt x = np.arange(1024) y = np.sin(2 * np.pi * x / 8) + np.sin(2 * np.pi * x / 32) plt.plot(x[0:200], y[0:200]) plt.show def get_power_spectrum(y, wavelet): print("Using", wavelet, "wavelet") coefs = pywt.wavedec(y, wavelet, mode = 'sym', level = 10) for i in range(10): detail_i = coefs[i + 1] octave = 10 - i period = 2 ** octave frequency = 1 / period detail_norm = np.sqrt(detail_i.dot(detail_i)) / np.sqrt(len(detail_i)) print("frequency is 1 / ", str(period), "=", round(frequency, 2), "has detail coef norm", str(round(detail_norm, 2))) get_power_spectrum(y, 'haar') get_power_spectrum(y, 'db2') In the output below, you can see that the frequencies 1/8 and 1/32 pop for the Haar wavelet, but not so much for the db2 wavelet. Now the db2 wavelet has a pretty gnarly shape, and I thought it might be too different from the shape of the original waveform, but the "sym" series didn't seem to fare any better. Using haar wavelet frequency is 1 / 1024 = 0.0 has detail coef norm 0.0 frequency is 1 / 512 = 0.0 has detail coef norm 0.0 frequency is 1 / 256 = 0.0 has detail coef norm 0.0 frequency is 1 / 128 = 0.01 has detail coef norm 0.0 frequency is 1 / 64 = 0.02 has detail coef norm 0.0 frequency is 1 / 32 = 0.03 has detail coef norm 3.59 frequency is 1 / 16 = 0.06 has detail coef norm 0.25 frequency is 1 / 8 = 0.13 has detail coef norm 1.86 frequency is 1 / 4 = 0.25 has detail coef norm 0.57 frequency is 1 / 2 = 0.5 has detail coef norm 0.4 Using db2 wavelet frequency is 1 / 1024 = 0.0 has detail coef norm 1.68 frequency is 1 / 512 = 0.0 has detail coef norm 2.13 frequency is 1 / 256 = 0.0 has detail coef norm 1.58 frequency is 1 / 128 = 0.01 has detail coef norm 1.14 frequency is 1 / 64 = 0.02 has detail coef norm 0.79 frequency is 1 / 32 = 0.03 has detail coef norm 1.95 frequency is 1 / 16 = 0.06 has detail coef norm 2.34 frequency is 1 / 8 = 0.13 has detail coef norm 0.73 frequency is 1 / 4 = 0.25 has detail coef norm 1.31 frequency is 1 / 2 = 0.5 has detail coef norm 0.24
