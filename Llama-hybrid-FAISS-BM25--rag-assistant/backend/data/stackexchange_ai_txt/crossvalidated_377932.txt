[site]: crossvalidated
[post_id]: 377932
[parent_id]: 
[tags]: 
Comparing how similar/different are two paired datasets, and how similar/different are from a third one

First time posting, I hope not to break any rules here. I have 3 datasets, d1, d2, and d3, each with ~5,000 values measured in the same regions (paired data?). I also have additional datasets d1', d1'', and d2' with the same 5,000 regions, measured in a smaller sample size of d1 and d2. A description of the data can be found here: https://i.stack.imgur.com/b7YNw.jpg My expectations would be, for each region, either to have similar values in all d1-d2-d3 datasets, or to have similar values in d1-d2 and different in d3. What I find, though , is an intermediate (Pearson's) correlation (0.5-0.7) between d1-d2, a very poor correlation between d1-d3 (0.15-0.23), and an intermediate correlation between d2-d3 (0.5). When plotting the datasets against eachother... It seems that regions with higher values in d2 than in d1, tend to have also higher values in d3. As each dataset has different distributions, I am interested in comparing, say, "the top 10%" regions. For this, I ranked/sorted each dataset converting them to uniform distributions, from 0 (top value) to 1 (lowest value). This shows a clear bias of d3, towards regions where d2 are higher than in d1. My expectations for this plot would be, if d1-d2-d3 were correlated, d3 to be higher in the top-right corners (high in d1 & d2), or d3 to be randomly distributed through all regions. If I look at regions where the ranking in d1 and d2 is different than a threshold (25% in the plots), I still see a clear bias of d3 towards high-d2. Up until this point, is everything solid? Should I be doing something different? Next, I decomposed each dataset into 6 independent variables, trying to discover which is the cause of this d2-d3 association I am finding. The correlation between datasets are as follows (correlation of the raw values, not the sorted/ranked values): +-----+----------+----------+----------+ | var | d1 vs d2 | d1 vs d3 | d2 vs d3 | +-----+----------+----------+----------+ | all | 0.65 | 0.16 | 0.55 | | v1 | 0.78 | 0.61 | 0.72 | | v2 | 0.85 | 0.5 | 0.66 | | v3 | 0.9 | 0.73 | 0.78 | | v4 | 0.73 | 0.42 | 0.7 | | v5 | 0.75 | -0.09 | 0.16 | | v6 | 0.89 | -0.1 | 0.02 | +-----+----------+----------+----------+ As the previous ranked d1-d2 axis holds a meaning (they correlate also with several other relevant variables beyond the d1-d2-d3 datasets), I decided to sort/rank these d* _ v1-v6 datasets and plot them against the old axis (let's call them d1_all - d2_all). This results in the following: v1 - v2 - v3 : All datasets (d1-d2-d3), when using these 3 sub-variables (v1 - v2 - v3) show a similar distribution to what was previously seen in d1_all - d2_all - d3_all. All 3 datasets have the highest value regions above the diagonal, with d1 being a bit worse. v4 - v5 - v6 : v4: d2 and d3 show a similar distribution, with d1 being different/the expected distribution of d1_v4 being higher where both d1_all and d2_all are higher. v5: d1 and d3 are completely opposite. d2 shows an intermediate distribution, towards high d1_all and d2_all regions. v6: d1 and d2 show a similar distribution, opposite to d3. d2 is slightly less extreme than d1. d3 being consistently above the diagonal is expected and consistent with the literature. Being d1 sometimes concordant and sometimes opposite to d3 is expected. What is not expected are the consistent disagreements between d1 and d2 (and their correlation with d3). At first sight, it is clear that some of these sub-variables (specially v4 and v5, v6 less so, and v2 even less so) show discordances between d1 and d2. I have run a PCA of the subvariables, and it separates all datasets*variables in two groups, the ones clustering above the diagonal, and the ones clustering below the diagonal (PC1=55%, PC2=20%), in both the raw and the ranked data. I need to further divide these 6 subvariables into ~100 independent variables. I want some method to test differences between d1-d2-d3 more reliable than visual observation of the ranked data. I want this to point me towards a (small-ish?) number of variables to further inspect. The best idea I've had until now is: standarize d1 and d2 (using the raw data), substract std(d1)-std(d2) and correlate this result with the raw data of d3. This gives: +-----+----------------------------------------+ | var | ( std(d1)-std(d2) ) correlated with d3 | +-----+----------------------------------------+ | all | -0.46 | | v1 | -0.16 | | v2 | -0.29 | | v3 | -0.11 | | v4 | -0.39 | | v5 | -0.34 | | v6 | -0.26 | +-----+----------------------------------------+ But this is very far from perfect, as v4 and v5 are the two variables with the biggest difference between datasets (as seen in the plots before), but their correlation is not much higher than v2 and v6, whose differences are much less clear. This is probably caused by very small (negative) differences in std(d1_v6)-std(d2_v6) that correlate with d3. Does anyone know of a test I can use here? Anything more scientific than "visual observation"? A million thanks in advance
