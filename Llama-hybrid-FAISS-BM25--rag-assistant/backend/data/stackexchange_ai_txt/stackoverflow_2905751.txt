[site]: stackoverflow
[post_id]: 2905751
[parent_id]: 235822
[tags]: 
The solution I am posting is a couple production ready VBScripts that leverage whoami to find this information. One cool thing about them is that they work with XP (for information that is available on XP) if you place a copy of the Resource Kit version of whoami.exe next to the script (or in the system32 folder of each machine). CSI_IsSession.vbs contains a single function that can tell you almost anything you want to know about UAC or the current session the script is running under. VBScriptUACKit.vbs (which uses CSI_IsSession.vbs) allows you to selectively prompt for UAC in a script by relaunching itself. Has been designed and debugged to work under many execution scenarios. Both scripts contain sample code that demonstrates how to use the core script code.
