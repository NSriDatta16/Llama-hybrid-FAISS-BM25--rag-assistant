[site]: stackoverflow
[post_id]: 1567397
[parent_id]: 1482699
[tags]: 
I can't find the declaration instruction for the vars "ServiceName" and "ServiceType" in your code sample. Assuming a String type (thus a unicode string), I guess (yes... no D2009 available to test this) lazy typecasting could be an issue: name := ServiceName; Why not use the following? name := PAnsiChar(AnsiString(ServiceName)) Anyhow... just my 2 cts. BTW: I always use the pre defined " EmptyStr ", " EmptyWideStr " ... so the test would look like: if (ServiceName <> EmptyStr) then which should be safe and avoid the confusion of types. On the other side, Delphi may interpret the '' as an ANSIChar like the following declaration do: const MyParagraphChar = 'ยง'; Not sure... I'm confused - should go home now ;)
