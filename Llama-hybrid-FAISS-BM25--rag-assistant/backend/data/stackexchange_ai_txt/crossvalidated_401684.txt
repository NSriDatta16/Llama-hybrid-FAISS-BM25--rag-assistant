[site]: crossvalidated
[post_id]: 401684
[parent_id]: 
[tags]: 
Variance components model: proportions of within and between variance are off?

I was hoping someone could help me see what I'm obviously missing here. I simulated some clustered data and, in the sense of a variance component model, wanted to take a look at the variances of the level 2 and level 1 residuals. My model stipulated that it should be about 50-50 (see rho = 0.5) (Now with libraries) : library( mvtnorm) library( dplyr) library( reshape2) library( lavaan) set.seed( 123); gen_cluster Because I'm only interested in the error components, I will just look at the x variable. I expected intuitively, that if I calculated the per-subject means and then subtracted each observation from that, I would get my $u_j$ and $e_{ij}$ , so to speak. Because the level 1 and level 2 errors are uncorrelated, $Var(x_{ij})=Var(u_j) + Var(e_{ij})$ . So I did that: xmean % rename( x = x.x, y = y.x, xmean = x.y) But the variance R is giving me is off, as far as I can tell: $Var(u_j) = 1.34$ and $Var(e_{ij}) = 0.67$ . In sum, they add up to the exact variance of the original variable: $Var(x)=2.01$ but the proportions are off (about 66-33 instead of 50-50). I made a wide-dataset and ran some intercept-only types of models in lavaan (FE and MLM) to try and confirm this and they are giving me the right variances. # Make wide dataset for lavaan model 1 (lavm1) df $xvar cluster)/3) dfwide FE (lavm1) Estimates Std.Err. z-value P(>|z|) alpha 0.986 0.043 23.426 0.000 x1 1.014 0.042 23.134 0.000 x2 0.976 0.044 23.597 0.000 x3 1.031 0.042 23.225 0.000 MLM (lavm2) Estimates Std.Err. z-value P(>|z|) alphaw 1.007 alphab 0.986 Which is giving me the expected result: an average within variance (averaged over the 3 waves in the wide dataset) of about 1.0 and a between variance of also around 1.0 (Note on edit: originally I had simulated 5 waves but used only 3 in the post for the sake of simplicity - in making the code more transparent, I changed it to really only simulate 3 waves - that's why the values in the table above are now slightly different). I am sure I'm just overlooking something obvious, but I've been staring at the problem too long to find it for myself. I would very much appreciate some help!
