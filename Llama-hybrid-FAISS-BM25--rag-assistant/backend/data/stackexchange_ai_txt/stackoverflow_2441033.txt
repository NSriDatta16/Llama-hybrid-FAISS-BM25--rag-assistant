[site]: stackoverflow
[post_id]: 2441033
[parent_id]: 2383212
[tags]: 
managed to get a relatively "working" fix in by writing my own treeDropEvent... however if someone has a more elegant solution, please feel free to share. the code below will solve anyone else's headaches for drag/drop with setItemWidgets in a tree, cheers. from PyQt4.QtCore import * from PyQt4.QtGui import * class InlineEditor (QWidget): _MUTE = 'MUTE' def __init__ (self, parent): QWidget.__init__ (self, parent) self.setAutoFillBackground (True) lo = QHBoxLayout() lo.setSpacing(4) self._cbFoo = QComboBox() for x in ["ABC", "DEF", "GHI", "JKL"]: self._cbFoo.addItem(x) self._leBar = QLineEdit('', self) lo.addWidget (self._cbFoo, 3) lo.addSpacing (5) lo.addWidget (QLabel ( 'Bar:')) lo.addWidget (self._leBar, 3) lo.addStretch (5) self.setLayout (lo) class Tree(QTreeWidget): def __init__(self, parent=None): QTreeWidget.__init__(self, parent) # Here is the issue? self.setDragDropMode(QAbstractItemView.InternalMove) self.installEventFilter(self) self.setColumnCount(3) self.dropEvent = self.treeDropEvent for n in range (2): i = QTreeWidgetItem (self) # create QTreeWidget the sub i i.setText (0, "first" + str (n)) # set the text of the first 0 i.setText (1, "second") for m in range (2): j = QTreeWidgetItem(i) j.setText (0, "child first" + str (m)) self.item = InlineEditor(self) # deal with a combination of multiple controls self.setItemWidget(self.topLevelItem(0).child(1), 1, self.item) def treeDropEvent(self, event): dragItem = self.currentItem() QTreeWidget.dropEvent(self, event) # rebuild widget (grabbing it doesnt seem to work from self.itemWidget?) self.item = InlineEditor(self) self.setItemWidget(dragItem, 1, self.item) class Form (QDialog): def __init__(self,parent=None): QDialog.__init__(self, parent) grid = QGridLayout () tree = Tree () grid.addWidget (tree) self.setLayout (grid) app = QApplication ([]) form = Form () form.show () app.exec_ ()
