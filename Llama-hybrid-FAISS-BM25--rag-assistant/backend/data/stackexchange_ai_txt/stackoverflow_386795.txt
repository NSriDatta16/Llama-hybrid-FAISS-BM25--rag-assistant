[site]: stackoverflow
[post_id]: 386795
[parent_id]: 
[tags]: 
select top 1000, but know how many rows are there?

SQL Server 2005 I have 10 million rows in DB, and run a select (with lots of "where" and joints.. pretty complex). The results are presented in grid (think goolge results) and because of that, the user cannot possibly use more then 1000 results. So I limit my SQL with a TOP 1000. Problem : User still wants to know that there are 5432 results for his search. Can I get that info without paying the price (or in other words, with still getting the speed benefits the "top 1000" is giving me ?) Assumptions - Assume that the TOP 1000 brings 1000 out of 100K rows. So even the network price of moving 100K might be an issue. Conclusions There is no free lunch! you can get the elegant way (accepted answer) but it still takes as long as the more expensive operation (i.e. counting all results). In real life, I will go with the 2 SQL approach, one to return top 1000 rows for display, and one that is ASYNC and updates some AJAX panel with the count(*) results that will take much much longer to computer
