[site]: crossvalidated
[post_id]: 255729
[parent_id]: 255574
[tags]: 
The definition of a state space model is a hidden/unobserved markov chain $x_t$, and observed data $y_t$. I don't know if you can go breaking the rules so early on like that. First hunch: try a model like this for each security. It might accomplish what you want to accomplish, while not breaking the rule that states have to be hidden. $$ y_t = c + x_t + v_t $$ $$ x_t = x_{t-1} + w_t $$ where $y_t \in \mathbf{R}^3$, $x_t \in \mathbf{R}^1$, $w_t \overset{iid}{\sim} \text{Normal}(0, Q)$, $v_t \overset{iid}{\sim} \text{Normal}(0, R)$. At regularly sampled intervals $$ \left[ \begin{array}{c} y_{1,t}\\ y_{2,t} \\ y_{3,t} \end{array}\right] = \left[ \begin{array}{c} ask_t\\ execution_t \\ bid_t \end{array}\right] $$ and $c = (\epsilon/2, 0, -\epsilon/2)$ so $\epsilon$ is the bid-ask spread. Finally $$ R = \left[ \begin{array}{ccc} r_{1,1} & 0 & 0\\ 0 & r_{2,2} & 0 \\ 0 & 0 & r_{3,3} \end{array}\right] $$ so you would expect $r_{2,2}$ to be equal to or atleast very close to $0$, and the other two you might constrain to be the same. Anyway the parameters you would have to estimate would be $(c, R, Q)$, which is do-able. Also, nowhere am I saying that the state is observable. But I am kind of working around that by saying $y_{2,t} = x_t + \{\text{very little noise}\}$, and we're thinking about $x_t$ as the 'true' price (you kind of have to defend your interpretation of 'true' here). Then do diagnostics on the residuals of this model. You will probably have better looking ones. Just a guess, though. I don't work in this domain. If it's still a problem you can make $v_t$ have fatter tails. Possible extensions: Let $c$ change overtime (call it $c_t$) Sample at irregularly sampled intervals better state dynamics. model multiple securities all at once Let the variances be stochastic or maybe just changing deterministically in time Executions happen on the NBBO, which means sometimes $y_{1,t} = y_{2,t}$ which doesn't jive with your choice of $c$. So $c_t$ might even need to be switching or something.
