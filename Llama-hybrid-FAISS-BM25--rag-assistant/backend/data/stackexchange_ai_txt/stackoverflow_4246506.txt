[site]: stackoverflow
[post_id]: 4246506
[parent_id]: 
[tags]: 
Can't get simple WPF drag and drop to work

For a simple test I want to drag a Button to a TextBox. I can start dragging the Button, but the Drop event is not raised. What am I missing? Xaml: Code: public partial class DnDTest : Window { public DnDTest() { InitializeComponent(); } private Point dragStartPoint; private void button_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e) { dragStartPoint = e.GetPosition(null); } private static bool IsDragging(Point dragStartPoint, MouseEventArgs e) { var diff = e.GetPosition(null) - dragStartPoint; return e.LeftButton == MouseButtonState.Pressed && (Math.Abs(diff.X) > SystemParameters.MinimumHorizontalDragDistance || Math.Abs(diff.Y) > SystemParameters.MinimumVerticalDragDistance); } private void button_PreviewMouseMove(object sender, MouseEventArgs e) { if (IsDragging(dragStartPoint, e)) { DragDrop.DoDragDrop(button, new DataObject("Button", button), DragDropEffects.Move); e.Handled = true; } } private void textBox_DragEnter(object sender, DragEventArgs e) { e.Handled = true; } private void textBox_Drop(object sender, DragEventArgs e) { var button = (Button)e.Data.GetData("Button"); textBox.Text = string.Format("[0]", button.Content.ToString()); e.Handled = true; } }
