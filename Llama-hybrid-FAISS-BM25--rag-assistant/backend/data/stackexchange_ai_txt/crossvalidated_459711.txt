[site]: crossvalidated
[post_id]: 459711
[parent_id]: 458337
[tags]: 
Answer about analysis 1 If you want to perform a Friedman test, you have to use 15 groups of 3 observations (one group for each combination of spine and fat size, and one observation for modality), so that the samples are paired. Repeated measurements must be reduced to one single observation by averaging them. The alternative is to use not a non-parametric test, but a linear model, which seems a confortable solution, as it helps with both your problems at one time. Answer about analysis 2 If you average repeated measurements, you can create five paired samples of 9 observations (same averages as before, but this time divided in samples according to the size). Also, it seems to me that you should avoid Kruskal Wallis test, as it assumes independence between the samples, so it is less powerful than tests that take pairing into account. On the other hand, Kruskal Wallis doesn't requires pairing, so you can use it without averaging repeated measurements; I wouldn't recommend going down this way though, blocking for nuisance factors is generally more effective than having a not too larger sample. So, you could use a Friedman test again. However, I don't understand why you would even be interested in a post-hoc test between sizes, how comes that a specific size of fat around the bone would be specially interesting? Wouldn't you be satisfied by learning that fat wraps have an effect overall? In fact, as the size is clearly an ordinal variable (so, basically a numeric one), I would not go for a Friedman test either, but for a linear model. This seems by any mean the best option: it lets you use both blocking factors and repeated measurements, and it allows better insight into data. If you are worried about scientific correctness, just check the diagnostic plots before looking at the tests results: if the effect of the size is not linear, add non-linear effects; if the residuals have variance depending on factors... well, let's hope not, because in that case you'll have to use a different model. Code for the linear model Following the discussion on the comments here there is the code you could use for doing analysis n. 2: # developing the data frame to use it for linear modeling BD= c(as.matrix(my.df[, 4:6])) Vertebra= paste('L', gl(3, nrow(my.df)), sep= '') df= cbind(my.df[, 1:3], Vertebra, BD) df $Size= as.numeric(as.character(df$ Size)) # linear models m_wo_mod= lm(DB~Size+Vertebra, data= df) m_wo_size= lm(DB~Modality+Vertebra, data= df) m_complete= lm(DB~Modality*Size+Vertebra, data= df) # diagnostic plots plot(m_wo_mod) plot(m_wo_size) plot(m_complete) plot(df $Size, m_wo_mod$ residuals, col= df$Modality) # test question 1 anova(m_wo_mod, m_complete) # test question 2 anova(m_wo_size, m_complete)
