[site]: stackoverflow
[post_id]: 3177547
[parent_id]: 3177515
[tags]: 
My bet is that there is a ' in the user agent strings that are causing the parser error. The User-Agent string returned to PHP is under control of the local browser, which means that you need to treat it no differently from regular user input. A malicious user or a user who has been infected by a virus/trojan/worm could change the user agent string to cause an SQL injection attack. At the very least, you need to escape it (with mysql_real_escape_string() for example. My bet is that once you do this, your parser errors should also go away. Better yet, try to move to using prepared statements if your system allows this.
