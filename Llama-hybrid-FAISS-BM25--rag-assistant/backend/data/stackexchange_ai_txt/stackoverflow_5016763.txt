[site]: stackoverflow
[post_id]: 5016763
[parent_id]: 5016717
[tags]: 
Your code would almost work -- you want both conditions to be true, not either, so a quick change to: foreach (DataRow dr in dsValue.Tables[0].Rows) { DateTime dt = Convert.ToDateTime(dr["tijd"]); if (dt > DateTime.Now.AddHours(-1) && dt ...would suffice. It may be (much) more efficient to move the logic to the database, or at the very least precalculate "an hour ago" and "an hour's time" outside of the loop. For example, if your SQL looked a s little like DECLARE @HourAgo DATETIME SET @HourAgo = DATEADD(HOUR,-1,GETDATE()) DECLARE @HoursTime DATETIME SET @HoursTime = DATEADD(HOUR,1,GETDATE()) SELECT opdracht, [other columns] FROM ExampleTable WHERE opdracht BETWEEN @HourAgo AND @HoursTime
