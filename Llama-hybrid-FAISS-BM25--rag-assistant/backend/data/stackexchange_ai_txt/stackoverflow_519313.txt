[site]: stackoverflow
[post_id]: 519313
[parent_id]: 518988
[tags]: 
Are you sure that the variability you're seeing is caused by "bad" execution plans? This may be a cause, but there may be a number of other reasons: "other" load on the db machine when using different data, there may be "easy" and "hard" data issues with having to allocate more memory/file storage ... Have you tried running the SP with the same data a few times? Also, in order to figure out what is causing the runtime/variability, I'd try to do some detailed measuring to pin the problem down to a specific section of the code. (Easiest way would be to insert some log calls at various points in the sp). Then try to explain why that section is slow (other than "5M rows ;-)) and figure out a way to make that faster. For now, I think there are a few questions to answer before going down the "splitting up the sp" route.
