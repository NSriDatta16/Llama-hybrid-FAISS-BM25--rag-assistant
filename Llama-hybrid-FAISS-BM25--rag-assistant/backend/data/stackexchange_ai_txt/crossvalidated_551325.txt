[site]: crossvalidated
[post_id]: 551325
[parent_id]: 551302
[tags]: 
From Wikipedia the leverage score of each element (row) of the independent variable is the diagonal of the hat matrix: $\mathbf{H} = \mathbf{X(X^{T}X)^{-1}X^{T}}$ where $\mathbf{X}$ is the design matrix. Here I reproduce your example. For comparison with the manual calculation, I fit the model with lm and use the R function hatvalues to extract the leverage: df This is instead the manual calculation returning the same results: # Design matrix. Can be done also with model.matrix(~x + y) X $x, y= df$ y) X intercept x y [1,] 1 2 -4.8e-09 [2,] 1 2 -4.0e-02 [3,] 1 2 -8.0e-02 [4,] 1 2 -1.2e-01 [5,] 1 2 -1.6e-01 [6,] 1 2 -2.0e-01 H
