[site]: crossvalidated
[post_id]: 546861
[parent_id]: 546516
[tags]: 
I haven't tried it out, but I expect that something like qresult should work for a simple logistic regression. illicit here is a dummy variable (or factor) for the version of the question. As far as I know, it's not necessary for the subject identifier subject to have more than one observation for all subjects; it should be enough to have a good number of them (those in the "illicit&prescribed" group). I haven't run multinomial logistic regressions with mixed effects myself; I suspect glmer doesn't do that but it seems package mclogit does it (which apparently requires the specification random=1|subject ). What could not be identified is any potential interaction between subject and whether a subject belongs to the "illicit&prescribed" group, i.e., whether the subjects in this group behave systematically different from the others. As this may well be the case in reality, I'm somewhat skeptical about the simple mixed effects model above, but this could be explored by suitable plots and particularly by running separate analyses for the "both" group and the other two, and checking whether conclusions are different. Note by the way the technically this assumes that there is a random subject effect also for the individuals in the "pure" groups, however I don't think this is a problem - it will not affect the general tendency of the coefficient estimator for illicit but may add some additional uncertainty to p-values and the like, which may well be realistic. As I haven't tried it out myself, tell me how it goes. Sometimes trouble shows up when trying out something that "in principle should work".
