[site]: stackoverflow
[post_id]: 5019789
[parent_id]: 5019665
[tags]: 
Possibly you could do the DELETE from your staging table combined with the OUTPUT clause. and INSERT the result of the OUTPUT clause into your main table to do this all in one atomic statement. OUTPUT deleted.* into dashboardtasks There are some restrictions listed in BOL though which may make this approach unviable. The output_table cannot: Have enabled triggers defined on it. Participate on either side of a foreign key constraint. Have CHECK constraints or enabled rules. Full syntax for your query... DELETE FROM staggingtasks OUTPUT DELETED.[tour], DELETED.tourname, DELETED.[taskname], DELETED.[deptdate], DELETED.[tasktype], DELETED.[desc], DELETED.[duedate], DELETED.[compdate], DELETED.[comments], DELETED.[agent], DELETED.[compby], DELETED.[graceperiod], DELETED.completed, DELETED.canceled INTO dashboardtasks WHERE NOT EXISTS(SELECT * FROM dashboardtasks WHERE ( staggingtasks.tour = dashboardtasks.tour and staggingtasks.taskname = dashboardtasks.taskname and staggingtasks.deptdate = dashboardtasks.deptdate and staggingtasks.duedate = dashboardtasks.duedate and staggingtasks.tourname = dashboardtasks.tourname ))
