[site]: stackoverflow
[post_id]: 1260090
[parent_id]: 
[tags]: 
test if a PDF file is finished in Ruby (on Solaris/Unix)?

i have a server, that generates or copies PDF-Files to a specific folder. i wrote a ruby script (my first ever), that regularily checks for own PDF-files and displayes them with acrobat. So simple so nice. But now I have the Problem: how to detect the PDF is complete? The generated PDF ends with %%EOF\n but the copied ones are generated with some Apple-Magic (Acrobat Writer I think), that has an %%EOF near the beginning of the File, lots of binary Zeros and another %%EOF near the end with a carriage return (or line feed) and a binary zero at the end. while true dir = readpfad Dir.foreach(dir) do |f| datei = File.join(dir, f) if File.file?(datei) if File.stat(datei).owned? if datei[-9..-1].upcase == "__PDF.PDF" if File.stat(datei).size > 5 test = File.new(datei) dummy = test.readlines if dummy[-1][0..4] == "%%EOF" #move the file, so it will not be shown again cmd = "mv " + datei + " " + movepfad system(cmd) acro = ACROREAD + " " + File.join(movepfad, f) + "&" system(acro) else puts ">>>" + dummy[-1] + " Any help or idea? Thanks Peter
