[site]: stackoverflow
[post_id]: 5297842
[parent_id]: 
[tags]: 
How to handle onContextItemSelected in a multi fragment activity?

I'm currently trying to adapt my application to use the "Compatibility Libraries for Android v4" to provide the benefits of the usage of fragments even to Android 1.6 users. The implementation of a context menu seems to be tricky: The main activity of the application is extending the FragmentActivity class. The fragments are all based on one class which extends the Fragment class. The fragment class is calling registerForContextMenu() in its onCreateView() method and overrides the methods onCreateContextMenu() and onContextItemSelected() . For onCreateContextMenu() this works pretty well. The context menu is inflated from a resource file and slightly modified based on the selected item (which is based on a listView... even if the fragment is not an ListFragment). The problem occurs when a context menu entry is selected. onContextItemSelected() is called for all currently existing fragments starting with the first added one. In my case the fragments are used to show the content of a folder structure. When the context menu of a subfolder fragment is opened and a menu item is selected, onContextItemSelected() is first called on the upper levels (depending on how many fragments are allowed/visible in this moment). Right now, I use a workaround by a field on activity level which holds the tag of last fragment calling its onCreateContextMenu() . This way I can call "return super.onContextItemSelected(item)" in the begin of onContextItemSelected() when the stored tag is not the same as getTag(). But this approach looks a bit dirty to me. Why is onContextItemSelected() called on all fragments? and not just one the one that was calling onCreateContextMenu() ? What is the most elegant way to handle this?
