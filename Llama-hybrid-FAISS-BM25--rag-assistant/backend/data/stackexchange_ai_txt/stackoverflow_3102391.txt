[site]: stackoverflow
[post_id]: 3102391
[parent_id]: 3102249
[tags]: 
My friend, I've been looking @ your code, and so far, all I've really found are typing errors. For instance, * in the set clause, there is no comma between the set for packaged_in_uom_id and priced_in_uom_id * in the subquery for priced_in_uom_id, there is no space in front of the from clause. My advice is to adopt a stylized pattern for how you write you sql. The pattern I use says that * each clause goes on its own line - select, from where, order by, group by * each column goes on its own line * list commas go BEFORE the item when I began to format your code using these patterns, I began to see the problems. I enforce these patterns using RedGate's SQL Refactor. It's the best SQL code formatter I've found.
