[site]: crossvalidated
[post_id]: 21572
[parent_id]: 
[tags]: 
How to plot decision boundary of a k-nearest neighbor classifier from Elements of Statistical Learning?

I want to generate the plot described in the book ElemStatLearn "The Elements of Statistical Learning: Data Mining, Inference, and Prediction. Second Edition" by Trevor Hastie & Robert Tibshirani& Jerome Friedman. The plot is: I am wondering how I can produce this exact graph in R , particularly note the grid graphics and calculation to show the boundary.
