[site]: crossvalidated
[post_id]: 439078
[parent_id]: 
[tags]: 
How is explained variance in sparse PCA calculated?

Sparse PCA is a technique proposed by Zou et all in this paper. In usual PCA the obtained loadings are orthonormal, and the resulting scores are uncorrelated. However, in sparse PCA you give up these orthogonality and uncorrelatedness in exange of sparse loadings that ease interpretation in high dimension. Since the loadings are no longer orthonormal in SPCA, it is not as straightforward as in PCA to compute the explained variance, and in order to solve this problem, in the paper mentioned above (section 3.4) they propose an alternative way of calculating the variance that takes into account the correlations. Supose your data matrix is $X$ and you compute $P$ the matrix of sparse loadings. Then you can obtain $Z=XP$ the matrix of scores. Now, as stated in section (3.4), you can decompose $Z=QR$ where Q is orthonormal and $R$ is upper triangular, and the explained variance from the sparse component $j$ in $P$ can be calculated as $R_{jj}^2$ . Therefore, the total variance explained using sparse PCA is equal to $\sum_{j=1}^k R_{jj}^2$ . Now, I used the elasticnet package in R that implements the sparse PCA proposed in the paper and I tried to replicate those calculations for the variance: # Load data data("BostonHousing") x = BostonHousing[, -c(2, 4, 9, 10, 14)] # Select non-categorical variables total_variance_in_x = sum(diag(var(x))) n = dim(x)[1] # Obtain sparse components n_comp=9 spca_fit1 = spca(x, K=n_comp, type="predictor", sparse="penalty", para=rep(10, 9)) total_var_spca = spca_fit1$var.all/(n-1) # Check that the variance in x is the same as in SPCA. abs(total_variance_in_x - total_var_spca) So my questions are: Why is total_variance_in_x equal to total_var_spca ? Is there no loss on variability due to the correlatedness and non-orthogonality? Why is total_var_spca_qr_aproach much larger than total_var_spca ? I am following the steps described in the paper in which the package is based so these values should match. Am I doing something wrong? Did I misunderstand anything?
