[site]: crossvalidated
[post_id]: 426756
[parent_id]: 420529
[tags]: 
Their formula has the correct sign, and the crux of the reason why is that they're doing the variance decomposition with respect to a distribution different than the one you are. Considering this different distribution will make it so that the square is on the outside of the expectation, rather than on the inside as you have it. We'll take notation from their paper without explanation, and, as they do, we will treat the partition $\Pi$ as fixed. First, notice that $$\mathbb{E}_{\mathcal{S}^\textrm{tr}}[\hat{\mu}(x; \mathcal{S}^\textrm{tr}, \Pi)] = \mu(x; \Pi),$$ so that $\hat{\mu}(x; \mathcal{S}^\textrm{tr}, \Pi)$ is an unbiased estimator for $\mu(x; \Pi)$ . We will use these to make an estimator for the square $\mu^2(x; \Pi)$ , via $$\underbrace{\mathbb{E}_{\mathcal{S}^\textrm{tr}}[\hat{\mu}^2(x; \mathcal{S}^\textrm{tr}, \Pi)]}_{(1)} - \underbrace{\mathrm{Var}_{\mathcal{S}^\textrm{tr}} \left( \hat{\mu}(x; \mathcal{S}^\textrm{tr}, \Pi) \right)}_{(2)} = \left( \mathbb{E}_{\mathcal{S}^\textrm{tr}}[\hat{\mu}(x; \mathcal{S}^\textrm{tr}, \Pi)] \right)^2 = \mu^2(x; \Pi).$$ The first term $(1)$ can be estimated simply by $\hat{\mu}^2(x; \mathcal{S}^\textrm{tr}, \Pi)$ , and the second term $(2)$ can be estimated by the quantity in the paper. Ultimately, the goal is to estimate $\mathbb{E}_{X_i} \left[ \mu^2 (X_i; \Pi) \right],$ where $X_i$ is a draw from the test set. This is done by averaging the estimator (described above) over the test points. (Note, there's a typo where, on the eighth page, the first summand in the third displayed equation should also be the first summand in the second displayed equation.)
