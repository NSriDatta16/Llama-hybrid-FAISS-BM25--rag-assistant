[site]: crossvalidated
[post_id]: 147856
[parent_id]: 
[tags]: 
Bayesian Mixture Model Gibbs Sampler for two linear relationships

I am attempting to use a Gibbs Sampler to model a mixture of two groups, where the group membership is defined by a linear relationship conditional on x. Both groups have the same slope and intercept, but one group has an additional, positive constant added to the common intercept. My question is that my set up does not seem to be correctly separating out the two groups. (see plot with result below) $$ z_i = \begin{cases} 1, & \text{if observation $i$'s response is in group 1 (with positive shift)}, \\ 0, & \text{if observation $i$'s response is in group 2}. \end{cases} $$ $$ y_i = \begin{cases} \text{N} (\gamma + \beta x_i + \tau z_i\, , \, \sigma^2 ) & \text{ with prob. } \lambda, \\ \text{N} (\gamma + \beta x_i \,,\, \sigma^2) & \text{ with prob. } 1- \lambda. \end{cases} $$ The (simulated) data look like this: And here is my code: #synthetic data a synthetic dataset of 100 points truebeta =logu, sigma2.prop, sigma2[i-1]) } I tried plotting the iterations to gauge convergence, and the chain is not converging. plot(sigma2, type = "l") plot(lambda, type = "l", xlim = c(0,100)) plot(beta, type = "l") plot(gamma, type = "l", xlim= c(0,50)) plot(tau, type = "l", xlim = c(0,50)) And to diagnose autocorrelation: acf(beta) acf(lambda) acf(gamma) acf(tau) I haven't thinned or thrown out burn-in yet, but from these preliminary plots, I am not getting what I hope to (regression lines through each group of points). Instead, group membership goes virtually all to one group (0) in the z vector, and both lines are between the two groups. plot(xs,ys) abline(mean(gamma), mean(beta)) abline(mean(gamma) + mean(tau), mean(beta)) Here is a plot of what I am getting right now:
