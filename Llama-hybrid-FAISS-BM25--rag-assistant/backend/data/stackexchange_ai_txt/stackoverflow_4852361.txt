[site]: stackoverflow
[post_id]: 4852361
[parent_id]: 4851680
[tags]: 
You can do this with apply.yearly , but all the data to be split by period needs to be in one object because apply.yearly only splits x and not signal (or anything else passed via ... ). library(quantmod) getSymbols("GLD", from="2007-01-03", to="2011-01-28") set.seed(21) sig 0, na.rm=TRUE)/N cbind(N,HitRate) } hit.rate(merge(ROC(Cl(GLD)),sig)) # N HitRate # [1,] 1026 0.539961 apply.yearly(merge(ROC(Cl(GLD)),sig), hit.rate) # GLD.Close sig # 2007-12-31 250 0.5560000 # 2008-12-31 253 0.5256917 # 2009-12-31 252 0.5277778 # 2010-12-31 252 0.5634921 # 2011-01-28 19 0.3684211 Also, your "note" that TTR requires xts objects is incorrect. TTR functions use xts internally, which allows them to handle most time-series classes (xts, zoo, timeSeries, chron, its, irts, fts, etc.) as well as data.frame, matrix, and numeric/integer vectors. If the object is coercible to xts, TTR functions will return an object of the same class given to them. For example: > str(ROC(Cl(GLD))) An ‘xts’ object from 2007-01-03 to 2011-01-28 containing: Data: num [1:1027, 1] NA -0.01017 -0.0243 0.00514 0.0061 ... - attr(*, "dimnames")=List of 2 ..$ : NULL ..$ : chr "GLD.Close" Indexed by objects of class: [Date] TZ: xts Attributes: List of 2 $ src : chr "yahoo" $ updated: POSIXct[1:1], format: "2011-01-31 08:41:53" > str(ROC(as.zoo(Cl(GLD)))) ‘zoo’ series from 2007-01-03 to 2011-01-28 Data: Named num [1:1027] NA -0.01017 -0.0243 0.00514 0.0061 ... - attr(*, "names")= chr [1:1027] "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-08" ... Index: Class 'Date' num [1:1027] 13516 13517 13518 13521 13522 ... > str(ROC(as.timeSeries(Cl(GLD)))) Time Series: Name: object Data Matrix: Dimension: 1027 1 Column Names: GLD.Close Row Names: 2007-01-03 ... 2011-01-28 Positions: Start: 2007-01-03 End: 2011-01-28 With: Format: %Y-%m-%d FinCenter: GMT Units: GLD.Close Title: Time Series Object Documentation: Mon Jan 31 08:48:35 2011 > str(ROC(as.ts(Cl(GLD)))) Time-Series [1:1027] from 1 to 1027: NA -0.01017 -0.0243 0.00514 0.0061 ... > str(ROC(as.data.frame(Cl(GLD)))) 'data.frame': 1027 obs. of 1 variable: $ GLD.Close: num NA -0.01017 -0.0243 0.00514 0.0061 ... > str(ROC(as.matrix(Cl(GLD)))) num [1:1027, 1] NA -0.01017 -0.0243 0.00514 0.0061 ... - attr(*, "dimnames")=List of 2 ..$ : chr [1:1027] "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-08" ... ..$ : chr "GLD.Close" > str(ROC(as.numeric(Cl(GLD)))) num [1:1027] NA -0.01017 -0.0243 0.00514 0.0061 ...
