[site]: crossvalidated
[post_id]: 277674
[parent_id]: 
[tags]: 
Multilevel logistic regression in R: ML vs. Bayesian estimation

I hope you can help me with an issue I encountered while trying to build a multilevel logistic regression model in R. I get different results depending on whether I fit the model using Maximum Likelihood estimation or Bayesian inference. The basic situation is the following. A 2x2 contingency table tells me that people in Northern California are more likely to have Trait A (traitA) than people in Southern California. The table shows frequencies and percentages in parentheses. To start off, I replicated this finding with a simple logistic regression in R with south_ca as a binary predictor: fit1 The result: Call: glm(formula = traitA ~ 1 + south_ca, family = binomial(link = "logit"), data = dat1) Deviance Residuals: Min 1Q Median 3Q Max -1.233 -0.979 -0.979 1.123 1.390 Coefficients: Estimate Std. Error z value Pr(>|z|) (Intercept) 0.130 0.170 0.76 0.4456 south_ca -0.616 0.213 -2.90 0.0038 ** --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 546.07 on 398 degrees of freedom Residual deviance: 537.62 on 397 degrees of freedom (52 observations deleted due to missingness) AIC: 541.6 Number of Fisher Scoring iterations: 4 The Bayesian version yields comparable results. The point estimate for south_ca is similar and the 95% confidence interval does not include zero. t_prior The result: Model Info: function: stan_glm family: binomial [logit] formula: traitA ~ 1 + south_ca algorithm: sampling priors: see help('prior_summary') sample: 4000 (posterior sample size) num obs: 399 Estimates: mean sd 2.5% 25% 50% 75% 97.5% (Intercept) 0.1 0.2 -0.2 0.0 0.1 0.2 0.5 south_ca -0.6 0.2 -1.0 -0.7 -0.6 -0.5 -0.2 mean_PPD 0.4 0.0 0.4 0.4 0.4 0.5 0.5 log-posterior -272.6 1.0 -275.4 -273.0 -272.3 -271.9 -271.7 Diagnostics: mcse Rhat n_eff (Intercept) 0.0 1.0 2658 south_ca 0.0 1.0 2641 mean_PPD 0.0 1.0 3477 log-posterior 0.0 1.0 1590 Now, it happens to be the case that people were assessed at 3 sites in Northern CA and at 2 sites in Southern CA, and I want to take between-sites variation into account in my model. ML estimation: M0.1 The result: Generalized linear mixed model fit by maximum likelihood (Adaptive Gauss-Hermite Quadrature, nAGQ = 30) [glmerMod] Family: binomial ( logit ) Formula: traitA ~ south_ca + (1 | site) Data: dat Control: glmerControl(optimizer = "bobyqa") AIC BIC logLik deviance df.resid 542.3 554.2 -268.1 536.3 396 Scaled residuals: Min 1Q Median 3Q Max -1.136 -0.860 -0.725 0.969 1.380 Random effects: Groups Name Variance Std.Dev. site (Intercept) 0.0402 0.201 Number of obs: 399, groups: site, 5 Fixed effects: Estimate Std. Error z value Pr(>|z|) (Intercept) 0.131 0.206 0.64 0.526 south_ca -0.606 0.282 -2.15 0.031 * --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 The difference between Northern CA and Southern CA continues to be significant. Now the Bayesian approach: t_prior The result: Model Info: function: stan_glmer family: binomial [logit] formula: traitA ~ south_ca + (1 | site) algorithm: sampling priors: see help('prior_summary') sample: 4000 (posterior sample size) num obs: 399 groups: site (5) Estimates: mean sd 2.5% 25% 50% 75% 97.5% (Intercept) 0.12 0.35 -0.61 -0.07 0.12 0.31 0.79 south_ca -0.56 0.50 -1.57 -0.85 -0.58 -0.30 0.52 b[(Intercept) sit -0.09 0.36 -0.85 -0.27 -0.06 0.10 0.59 b[(Intercept) site:2] -0.12 0.36 -0.89 -0.29 -0.08 0.07 0.57 b[(Intercept) site:3] 0.24 0.38 -0.43 0.02 0.19 0.43 1.09 b[(Intercept) site:4] -0.26 0.40 -1.20 -0.44 -0.20 -0.03 0.42 b[(Intercept) site:5 0.20 0.39 -0.65 0.01 0.18 0.40 1.00 Sigma[site:(Intercept) 0.31 0.63 0.00 0.05 0.14 0.34 1.68 mean_PPD 0.43 0.03 0.37 0.41 0.43 0.46 0.50 log-posterior -279.74 2.53 -285.58 -281.18 -279.42 -277.87 -275.84 Diagnostics: mcse Rhat n_eff (Intercept) 0.01 1.00 1819 south_ca 0.01 1.00 1155 b[(Intercept) site:1] 0.01 1.00 1935 b[(Intercept) site:2] 0.01 1.00 1988 b[(Intercept) site:3] 0.01 1.00 1903 b[(Intercept) site:4] 0.01 1.00 975 b[(Intercept) site:5] 0.01 1.00 1091 Sigma[site:(Intercept),(Intercept)] 0.02 1.00 1028 mean_PPD 0.00 1.00 4000 log-posterior 0.08 1.00 1091 As you can see, the point estimates for south_ca are similar (ML: -0.61, Bayesian: -0.56), but with Bayesian estimation, the 95% confidence interval includes zero. Thus, I get a significant effect for south_ca with ML estimation, but not with Bayesian estimation. What kind of conclusions can I draw from these findings about the prevalence of Trait A in Northern and Southern CA? Should I prefer the Bayesian estimates over the ML estimates? The Bayesian analysis seems to suggest that there was little variation in Trait A between sites and, consequently, no regional (North-South) difference, but that conclusion seems to be add odds with the raw data in the contingency table.
