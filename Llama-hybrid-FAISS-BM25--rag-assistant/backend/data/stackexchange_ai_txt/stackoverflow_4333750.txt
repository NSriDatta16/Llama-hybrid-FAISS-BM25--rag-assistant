[site]: stackoverflow
[post_id]: 4333750
[parent_id]: 
[tags]: 
Sharepoint web part form validation blocks updating web part settings

I have written a web part in C# for Sharepoint 2007 which has a single field which is validated as a required field using RequiredFieldValidator() . The web part also has some configuration fields (ones you edit by clicking on Modify Shared Web Part). When I make changes to these fields and try to apply them, the validation of the user field kicks in and prevents the update, even though I am not submitting the form. I am only trying to submit the settings. The web part may be used in a few places on our farm, so site collection administrators need to be able to change the settings - at the moment it is not friendly enough for these users to do so. Here is where I validate the user field: // Validate form field - required field, and max length is 100 characters. InputFormRequiredFieldValidator messageRequiredValidator = new InputFormRequiredFieldValidator(); messageRequiredValidator.ControlToValidate = txtMessage.ID; messageRequiredValidator.ErrorMessage = "You must write a message to send!"; messageRequiredValidator.Display = ValidatorDisplay.Dynamic; messageRequiredValidator.Text = " You must write a message to send."; tc.Controls.Add(messageRequiredValidator); Here is where I define one of the configuration fields: private string recipientEmailAddress = "sender@domain.tld"; [WebBrowsable(true), Personalizable(true), WebPartStorage(Storage.Shared), WebDescription("Email address the form should be sent to"), WebDisplayName("Recipient Email Address"), SPWebCategoryName("Email Settings")] public string RecipientEmailAddress { get { return recipientEmailAddress; } set { recipientEmailAddress = value; } } This is the first web part I have written, so there may be some subtleties I am missing in how to do admin configuration and validation of user submitted fields.
