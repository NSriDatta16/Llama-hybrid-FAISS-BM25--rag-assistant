[site]: stackoverflow
[post_id]: 4302292
[parent_id]: 
[tags]: 
MySQL JOIN problem

SOLUTION: If anyone is interested: SELECT login_id, hotel_name, AVG( q1 ) AS q1, AVG( q2 ) AS q2, AVG( q3 ) AS q3, AVG( q4 ) AS q4, AVG( q5 ) AS q5, AVG( q6 ) AS q6, AVG( q7 ) AS q7, AVG( q8 ) AS q8, AVG( q9 ) AS q9, AVG( q10 ) AS q10, AVG( q11 ) AS q11, AVG( q12 ) AS q12, AVG( q13 ) AS q13, AVG( q14 ) AS q14, AVG( q15 ) AS q15, AVG( q16 ) AS q16, AVG( q17 ) AS q17, AVG( q18 ) AS q18, AVG( q19 ) AS q19, AVG( q20 ) AS q20, AVG( q21 ) AS q21, AVG( q22 ) AS q22 FROM thotels_respondents LEFT JOIN thotels_results ON thotels_respondents.login_id = thotels_results.company AND q24 =5 AND thotels_results.date = 'NOV2010' AND thotels_results.brand = 'XYZ' WHERE AND login_id = '66j8ttk2' GROUP BY login_id By moving the thotels_results.date and .brand to before the WHERE clause resolved the issue. Morning all, Hopefully someone will be able to assist - I'm suspecting that I've missed something completely obvious... I have two tables in MySQL hotel_respondents and hotel_results - they are joined by hotel_respondents.login_id = hotel_results.company I have the following data in hotel_results table: date brand code q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14 q15 q16 q17 q18 q19 q20 q21 q22 q23 q24 q25 NOV2010 XYZ 66j8ttk2 8 6 4 8 3 8 8 8 7 4 8 7 7 4 7 6 6 7 4 5 7 7 2 1 1 NOV2010 XYZ 66j8ttk2 9 9 5 5 5 5 3 3 9 9 9 5 6 8 6 8 8 5 5 5 6 6 2 1 1 NOV2010 XYZ 66j8ttk2 10 10 7 10 8 10 10 9 8 10 10 10 8 10 10 10 10 10 10 10 10 10 1 1 1 NOV2010 XYZ 66j8ttk2 8 6 4 8 3 8 8 8 7 4 8 7 7 4 7 6 6 7 4 5 7 7 2 1 1 NOV2010 XYZ 66j8ttk2 9 10 9 9 7 10 10 10 9 9 9 10 10 8 10 9 10 10 10 10 10 7 1 1 1 NOV2010 XYZ 66j8ttk2 10 10 10 6 10 10 10 10 6 10 10 10 10 1 10 10 10 10 10 10 10 10 1 2 1 NOV2010 XYZ 66j8ttk2 10 7 6 9 7 9 8 8 8 6 8 7 10 5 9 8 8 8 7 9 8 8 1 2 1 NOV2010 XYZ 66j8ttk2 8 8 7 7 9 9 10 1 8 10 10 9 8 8 9 8 8 7 8 8 8 9 1 2 1 NOV2010 XYZ 66j8ttk2 6 6 5 7 7 5 7 6 5 3 7 4 5 8 5 7 8 7 5 4 7 3 2 2 1 NOV2010 XYZ 66j8ttk2 10 9 10 9 10 10 8 10 9 10 10 9 9 6 9 9 9 10 9 9 9 8 2 3 2 NOV2010 XYZ 66j8ttk2 5 9 2 6 2 2 10 10 6 2 10 2 2 2 5 5 5 10 5 2 8 8 2 4 1 NOV2010 XYZ 66j8ttk2 9 8 5 7 7 9 9 9 10 10 9 7 9 6 8 8 7 8 9 10 7 10 2 4 1 Now, in Excel I run an AVERAGE for each question where q24 = 1 and the following results are returned. q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14 q15 q16 q17 q18 q19 q20 q21 q22 8.80 8.20 5.80 8.00 5.20 8.20 7.80 7.60 8.00 7.20 8.80 7.80 7.60 6.80 8.00 7.80 8.00 7.80 6.60 7.00 8.00 7.40 No, I can replicate the results in MySQL using the following code: SELECT login_id, hotel_name, AVG (q1) AS q1, AVG (q2) AS q2, AVG (q3) AS q3, AVG (q4) AS q4, AVG (q5) AS q5, AVG (q6) AS q6, AVG (q7) AS q7, AVG (q8) AS q8, AVG (q9) AS q9, AVG (q10) AS q10, AVG (q11) AS q11, AVG (q12) AS q12, AVG (q13) AS q13, AVG (q14) AS q14, AVG (q15) AS q15, AVG (q16) AS q16, AVG (q17) AS q17, AVG (q18) AS q18, AVG (q19) AS q19, AVG (q20) AS q20, AVG (q21) AS q21, AVG (q22) AS q22 FROM thotels_respondents LEFT JOIN thotels_results ON thotels_respondents.login_id = thotels_results.company AND q24 = 1 WHERE thotels_results.brand = 'XYZ' AND thotels_results.date = 'NOV2010' AND login_id = '66j8ttk2' GROUP BY hotel_name; The issue I have is as follows - the code returns the correct set of results in MySQL as long as q24 has any of 1,2,3,4,5 in the table. However, as you can see from the above data - for q24 there are NO 5's. So when you run the following code: SELECT login_id, hotel_name, AVG (q1) AS q1, AVG (q2) AS q2, AVG (q3) AS q3, AVG (q4) AS q4, AVG (q5) AS q5, AVG (q6) AS q6, AVG (q7) AS q7, AVG (q8) AS q8, AVG (q9) AS q9, AVG (q10) AS q10, AVG (q11) AS q11, AVG (q12) AS q12, AVG (q13) AS q13, AVG (q14) AS q14, AVG (q15) AS q15, AVG (q16) AS q16, AVG (q17) AS q17, AVG (q18) AS q18, AVG (q19) AS q19, AVG (q20) AS q20, AVG (q21) AS q21, AVG (q22) AS q22 FROM thotels_respondents LEFT JOIN thotels_results ON thotels_respondents.login_id = thotels_results.company AND q24 = 5 WHERE thotels_results.brand = 'XYZ' AND thotels_results.date = 'NOV2010' AND login_id = '66j8ttk2' GROUP BY hotel_name; It doesn't return any data, simply this message: MySQL returned an empty result set (i.e. zero rows). (Query took 0.2381 sec) What I need for my code and page to work correctly is to actually bring back a series of NULL's when q24 doesn't have responses for 1 to 5 - like so login_id hotel_name q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14 q15 q16 q17 q18 q19 q20 q21 q22 66j8ttk2 bbcircus NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL I have attempted to modify the code to do this but when I do, I end of messing up the calculations - I am sure I am doing something wrong with the JOIN but cannot work out where I am going wrong. Any and all help gratefully received!!! Thanks in advance, Homer.
