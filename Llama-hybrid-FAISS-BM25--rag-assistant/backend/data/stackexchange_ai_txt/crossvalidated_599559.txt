[site]: crossvalidated
[post_id]: 599559
[parent_id]: 137563
[tags]: 
By using $\theta$ directly as a parameter there will be no difficulty. Let the observed counts associated with probabilities $(p_1,p_2,p_3)$ in a sample of size $n$ be $(n_1,n_2,n - n_1 - n_2).$ Because the likelihood in terms of the parameters $p=p_2$ and $\theta = p_1/p_2$ is $$L(p,\theta;n_1,n_2,n_3)\ \propto\ (\theta p)^{n_1} (p)^{n_2} (1 - \theta p - p)^{n - n_1 - n_2},$$ the log likelihood is readily computed and a unique minimum is found at $$(\hat\theta, \hat p) = \left(\frac{n_1}{n_2}, \frac{n_2}{n}\right)$$ provided $n_2 \gt 0.$ Let's assume from now on that $p_2 n$ is large enough for the chance that $n_2=0$ to be small enough to neglect. (A lower threshold around $5$ ought to suffice, because the Poisson approximation to the distribution of $n_2$ suggests this chance drops below 1%.) The variance-covariance matrix of this Maximum Likelihood estimate is the inverse of the Hessian of the log likelihood, given by $$\hat\Sigma = \pmatrix{\frac{n_1(n_1+n_2)}{n_2^3} & -\frac{n_1}{n n_2}\\-\frac{n_1}{n n_2} & \frac{n_2 (n - n_2)}{n^3}}.$$ The square root of the upper left term is the estimated standard error of $\hat \theta,$ $$\widehat{\operatorname{se}}(\hat\theta) = \sqrt{\frac{n_1(n_1+n_2)}{n_2^3}}.$$ The Wald confidence interval of size $\alpha,$ then, is spanned by the values of $\hat\theta \mp Z_{\alpha/2} \widehat{\operatorname{se}}(\hat\theta)$ where $Z_{\alpha/2}$ is the $\alpha/2$ percentile of the standard Normal distribution. Simulations with $p=1/5$ and $\theta\in\{1/2, 1, 2, 3\}$ for $n \in \{20, 50, 100, 200\}$ suggest the Wald interval for $\alpha = 0.05$ (the standard 95% confidence) tends to have low coverage but comes close to 95% coverage provided $n \ge 100.$ Here is a summary of the fraction of 10,000 independent experiments where the Wald interval included the true value of $\theta:$ theta n 0.5 1 2 3 20 0.85 0.90 0.90 0.92 50 0.91 0.92 0.93 0.93 100 0.92 0.93 0.94 0.94 200 0.94 0.95 0.95 0.95 Notice that with $p=1/5$ and $\theta = 0.5,$ $np_1 = n\theta p = n/10.$ Perhaps a reasonable rule of thumb might be to trust this confidence interval provided both $np$ and $np\theta$ exceed $10$ or so. For smaller values of $\alpha$ you need even larger sample sizes to attain the desired coverage. Here is a summary of the simulations for $\alpha = 0.01:$ theta n 0.5 1 2 3 20 0.870 0.921 0.947 0.945 50 0.934 0.957 0.964 0.961 100 0.962 0.974 0.977 0.975 200 0.974 0.980 0.982 0.980 500 0.985 0.988 0.987 0.988 The values get up to 99% only around $n=500;$ at $n=100$ the coverage is only about 97.5%.
