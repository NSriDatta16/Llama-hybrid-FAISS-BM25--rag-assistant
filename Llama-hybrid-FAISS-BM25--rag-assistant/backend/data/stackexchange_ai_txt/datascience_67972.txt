[site]: datascience
[post_id]: 67972
[parent_id]: 
[tags]: 
Precision Recall using Distance Matrix

Given a Pre-trained CNN model, I extract feature vectors for 3450 Reference (Winter) and 3450 Query images (Spring) and compare features with euclidean distance to plot the distance matrix besides ground truth.The ground truth matrix indicates the one-to-one image correspondences as follows: img_i in Query --> img_i in Reference database I'd like to validate my result with Precision-Recall curve and here's a code I use: def draw_PR(cm_gt, cm_pred, query_season, ref_season): pr_curve = [] for th in np.arange(0, .99, 5e-4): # apply threshold tp = (cm_pred 0: plt.figure() plt.plot(pr_curve[:, 2], pr_curve[:, 1], 'b') plt.ylabel('Precision') plt.xlabel('Recall') plt.axis([0, 1.01, 0, 1.01]) plt.title('PR') plt.tight_layout() plt.grid() plt.savefig('R_'+ref_season+'_Q_'+query_season+'_PR' + '.pdf', bbox_inches='tight', dpi=1000) But my Precision-Recall curve looks wrong: Does anybody kindly help me figure out how to plot precision-recall given distance matrices of prediction and ground truth? Cheers,
