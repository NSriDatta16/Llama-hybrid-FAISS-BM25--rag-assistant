[site]: crossvalidated
[post_id]: 321033
[parent_id]: 320727
[tags]: 
It is appropriate to use the lm function to construct general linear models, including traditional anovas. For routine use to generate anova tables, I recommend using the Anova function in the car package. This gives you type-II sums of squares, which is preferable in some situations to the type-I SS reported by the anova function. You will also probably want to use the emmeans or multcomp packages for comparisons among treatments. #### Uses testdf data frame from question if(!require(car)){install.packages("car")} if(!require(emmeans)){install.packages("emmeans")} model = lm(value ~ trial*treatment, data = testdf) library(car) Anova(model) ### Anova Table (Type II tests) ### ### Response: value ### Sum Sq Df F value Pr(>F) ### trial 4.124 3 1.1272 0.343864 ### treatment 8.687 1 7.1240 0.009393 ** ### trial:treatment 11.200 3 3.0614 0.033513 * ### Residuals 87.800 72 library(emmeans) marginal = emmeans(model, ~ treatment) cld(marginal, Letters=letters) ### treatment emmean SE df lower.CL upper.CL .group ### A 3.677087 0.1746028 72 3.329023 4.025152 a ### B 4.336150 0.1746028 72 3.988086 4.684215 b ### ### Results are averaged over the levels of: trial ### Confidence level used: 0.95 ### significance level used: alpha = 0.05 marginal = emmeans(model, ~ trial:treatment) cld(marginal, Letters=letters) ### trial treatment emmean SE df lower.CL upper.CL .group ### 4 A 3.357615 0.3492057 72 2.661486 4.053744 a ### 2 B 3.600667 0.3492057 72 2.904538 4.296796 ab ### 3 A 3.634336 0.3492057 72 2.938207 4.330465 ab ### 1 A 3.805358 0.3492057 72 3.109229 4.501487 ab ### 2 A 3.911040 0.3492057 72 3.214911 4.607169 ab ### 1 B 3.982038 0.3492057 72 3.285909 4.678167 ab ### 4 B 4.660384 0.3492057 72 3.964256 5.356513 ab ### 3 B 5.101512 0.3492057 72 4.405383 5.797641 b ### ### Confidence level used: 0.95 ### P value adjustment: tukey method for comparing a family of 8 estimates ### significance level used: alpha = 0.05 hist(residuals(model), col = "darkgray") plot(predict(model), residuals(model)) ### I think that these are the comparisons you want to compare ### treatments within trials marginal = emmeans(model, ~ treatment|trial) cld(marginal, Letters=letters) ### trial = 1: ### treatment emmean SE df lower.CL upper.CL .group ### A 3.805358 0.3492057 72 3.109229 4.501487 a ### B 3.982038 0.3492057 72 3.285909 4.678167 a ### ### trial = 2: ### treatment emmean SE df lower.CL upper.CL .group ### B 3.600667 0.3492057 72 2.904538 4.296796 a ### A 3.911040 0.3492057 72 3.214911 4.607169 a ### ### trial = 3: ### treatment emmean SE df lower.CL upper.CL .group ### A 3.634336 0.3492057 72 2.938207 4.330465 a ### B 5.101512 0.3492057 72 4.405383 5.797641 b ### ### trial = 4: ### treatment emmean SE df lower.CL upper.CL .group ### A 3.357615 0.3492057 72 2.661486 4.053744 a ### B 4.660384 0.3492057 72 3.964256 5.356513 b ### ### Confidence level used: 0.95 ### significance level used: alpha = 0.05
