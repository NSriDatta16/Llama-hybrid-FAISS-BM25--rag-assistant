[site]: stackoverflow
[post_id]: 3777801
[parent_id]: 3524049
[tags]: 
The way forward for us was to construct the query using temporary tables for each clause, where each subsequent clause added was applied (via Union/Intersection/Exception) to the temporary table resulting from the previous clause. A temp table is also created for results and is updated with a TempTable Id and row count for each as they are populated. When the query has been processed the results are returned by selecting all rows from the results temp table which gives a full item by item breakdown. This prevented the need for gigantic SQL query statments featuring many many subqueries and also prevented constant re-execution of the same SQL, providing massive improvement in scalbility and performance.
