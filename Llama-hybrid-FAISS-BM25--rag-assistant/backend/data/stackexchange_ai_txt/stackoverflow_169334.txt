[site]: stackoverflow
[post_id]: 169334
[parent_id]: 
[tags]: 
Padding - Encryption algorithm

I'm writing an implementation of the XXTEA encryption algorithm that works on "streams", ie, can be used like: crypt mykey output. One of the requisites is that it doesn't have access to the file at all (it only reads an fixed size block until find an EOF). The algorithm needs that the data bytes is multiple of 4, so its needed to add a padding. For plain text a good solution is to pad with NULLs, and in the decryption just ignore the NULLs, but the same strategy cannot be used for binary streams (that can contain embedded NULLs). I've read the common solutions, like padding with the number of missing chars (if it miss 3 chars, then append an 3, 3, 3 at the end) and etc, but I wonder: theres a more elegant solution?
