[site]: crossvalidated
[post_id]: 414897
[parent_id]: 414828
[tags]: 
The theoretical calculation is the variance of $(X-Y)-(X-Z)$ . In the last line of your code, apply(xs-xc, 1, var) statement produces iters number of variances and then you average them. This doesn't make sense. Because each of the variances are obtained from $2$ samples, that are not drawn from the same population. You should be doing the following: xx = xc-xs var(xx[,1]-xx[,2])
