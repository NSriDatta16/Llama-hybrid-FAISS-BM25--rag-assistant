[site]: datascience
[post_id]: 41054
[parent_id]: 
[tags]: 
Trainable parameters explode in CNN , how to control them and yet get desired accuracy

I am building a CNN mode using CSV of size (79999, 11) Here is my model below. When I do a model summary it gives me close to two billion trainable parameters , which my laptop or even AWS Ec2 is not able to handle. What am I doing wrong ? New to ML pls help. I want trainable parameters to be something, which my 4 core 12 GB i5 can handle. Right now my Kernel just hangs. Thanks -- Code : seed=42;tf.reset_default_graph(); tf.set_random_seed(seed); np.random.seed(seed) model = Sequential() K.set_image_dim_ordering('th') # th = (channels, rows, cols) ; tf = (rows, cols, channels) #model.add(Convolution2D(30, 5, 5, border_mode= 'valid' ,input_shape = (1, 14, 5), activation= 'relu' )) #model.add(Convolution2D(30, 5, 5, border_mode= 'valid' ,input_shape = image_shape, activation= 'relu' )) #model.add(Conv2D(30, (5, 5), border_mode= 'valid' ,input_shape = image_shape, activation= 'relu', padding="valid" )) #xxmodel.add(Conv2D(30, (5, 5), input_shape = (num_of_images, num_colors_per_pixel, rows_per_image, cols_per_image), activation= 'relu', padding="valid" )) model.add(Conv2D(15, (5, 5), input_shape = image_shape, activation= 'relu', padding="valid" )) model.add(MaxPooling2D(pool_size=(1, 1))) #model.add(Convolution2D(20, 3, 3, activation= 'relu' )) model.add(Conv2D(10, (3, 3), activation='relu')) model.add(MaxPooling2D(pool_size=(1, 1))) model.add(Dropout(0.2)) model.add(Flatten()) model.add(Dense(8, activation= 'relu' )) #model.add(Dense(25, activation= 'relu' )) model.add(Dense(1, activation= 'softmax' )) model.compile(loss= 'binary_crossentropy' , optimizer= 'adam' , metrics=[ 'accuracy' ]) print ('model.input_shape ', model.input_shape) model.summary() Result : model.input_shape (None, 1, 500, 559932) _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= conv2d_1 (Conv2D) (None, 15, 496, 559928) 390 _________________________________________________________________ max_pooling2d_1 (MaxPooling2 (None, 15, 496, 559928) 0 _________________________________________________________________ conv2d_2 (Conv2D) (None, 10, 494, 559926) 1360 _________________________________________________________________ max_pooling2d_2 (MaxPooling2 (None, 10, 494, 559926) 0 _________________________________________________________________ dropout_1 (Dropout) (None, 10, 494, 559926) 0 _________________________________________________________________ flatten_1 (Flatten) (None, 2766034440) 0 _________________________________________________________________ dense_1 (Dense) (None, 8) 2212827552 _________________________________________________________________ dense_2 (Dense) (None, 1) 9 ================================================================= Total params: 22,128,277,287 Trainable params: 22,128,277,287 Non-trainable params: 0
