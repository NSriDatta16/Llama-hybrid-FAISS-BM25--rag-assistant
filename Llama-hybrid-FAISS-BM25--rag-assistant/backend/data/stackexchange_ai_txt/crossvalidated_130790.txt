[site]: crossvalidated
[post_id]: 130790
[parent_id]: 130785
[tags]: 
Generally, this is not the way that one would do a time series analysis. You don't generally just throw a whole bunch of lagged variables in a regression and see which one has the largest correlation coefficient. Time series data exhibits correlations among data points which are close together in time, violating the i.i.d. assumption of a multiple linear regression. This will be the case even if you regress on some $X_{t-i}$ term (for some arbitrary $i$ and thereby remove its variance from the error term) because correlations in time between the other variables will still remain. This function can be used to create lagged variables and you could write a for loop to generate an arbitrary number of lags, before putting them all in a linear model and using the one that has the smallest p value. However be advised that this will generate inaccurate statistics and is not recommended. The more rational approach is to use the a package like dynlm , auto.arima or similar to create a dynamic linear model and have a look at this link for instructions on which commands to use (and a general idea of the modelling workflow for time series models.) Auto.arima as described in that link is probably the closest to the function you need I suspect.
