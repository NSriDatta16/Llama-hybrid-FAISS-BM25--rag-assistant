[site]: stackoverflow
[post_id]: 996715
[parent_id]: 991257
[tags]: 
The problem is that the redirect is specified through methods that cURL won't follow. Here is the response from http://mail.google.com : HTTP/1.1 200 OK Cache-Control: public, max-age=604800 Expires: Mon, 22 Jun 2009 14:58:18 GMT Date: Mon, 15 Jun 2009 14:58:18 GMT Refresh: 0;URL=http://mail.google.com/mail/ Content-Type: text/html; charset=ISO-8859-1 X-Content-Type-Options: nosniff Transfer-Encoding: chunked Server: GFE/1.3 As you can see, the page uses both a Refresh header (and HTML meta equivalent) and javascript in the body to change location to http://mail.google.com/mail/ . If you then request http://mail.google.com/mail/ , you will be redirected (with the Location header, which cURL follows) to the page you had previously mentioned W3C correctly identifies. HTTP/1.1 302 Moved Temporarily Cache-Control: no-cache, no-store, max-age=0, must-revalidate Pragma: no-cache Expires: Fri, 01 Jan 1990 00:00:00 GMT Date: Mon, 15 Jun 2009 15:07:56 GMT Location: https://www.google.com/accounts/ServiceLogin?service=mail&passive=true&rm=false&continue=http%3A%2F%2Fmail.google.com%2Fmail%2F%3Fui%3Dhtml%26zy%3Dl&bsv=zpwhtygjntrz&scc=1&ltmpl=default&ltmplcache=2 Content-Type: text/html; charset=UTF-8 X-Content-Type-Options: nosniff Transfer-Encoding: chunked Server: GFE/1.3 HTTP/1.1 200 OK Content-Type: text/html; charset=UTF-8 Cache-control: no-cache, no-store Pragma: no-cache Expires: Mon, 01-Jan-1990 00:00:00 GMT Set-Cookie: GALX=B8zH60M78Ys;Path=/accounts;Secure Date: Mon, 15 Jun 2009 15:07:56 GMT X-Content-Type-Options: nosniff Content-Length: 19939 Server: GFE/2.0 (HTML page content here, removed) Perhaps you should add an additional step in your script to check for a Refresh header. Another possible error is that you have open_basedir set in your PHP configuration, which would disable CURLOPT_FOLLOWLOCATION - you can check this quickly by turning on error reporting, as a message is generated as either a warning or notice. The results above were all obtained with the following cURL setup: $useragent="Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.5) Gecko/2008120122 Firefox/3.0.5"; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_AUTOREFERER, 1); curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); curl_setopt($ch, CURLOPT_HEADER, 1); curl_setopt($ch, CURLOPT_USERAGENT, $useragent); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $res = curl_exec($ch); curl_close($ch);
