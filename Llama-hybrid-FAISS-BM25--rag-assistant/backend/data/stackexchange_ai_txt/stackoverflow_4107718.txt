[site]: stackoverflow
[post_id]: 4107718
[parent_id]: 
[tags]: 
SQL Server 2008 - Import part of XML File

I've been importing a whole XML File to a temp table with a XML Datatype using the below code INSERT INTO import.XMLCompanyDetail ( XMLData ) SELECT BulkColumn AS XMLData FROM OPENROWSET (BULK '\\Server\Dir1\Dir2\Dir3\ExampleXML.xml', SINGLE_BLOB) AS XMLDATA However what I'm struggling to do is only import part of the data, please see below for example XML. Ideally I would want to select either CoNum 123 or CoNum 233 and get the rest of the data in that element. Although I assume that would mean somehow then getting the relvent Row num and working from there. 123 Comp1 1950-01-06 233 Comp2 1955-11-10 if anyone can throw some syntax this way or point me in the right direction it would be much appreciated. Also its worth pointing out that I shred the data to a table later in the process but by that point its to late so really need to strip out the rest of the data, or only select the relevent data in this query or from the import.XMLCompanyDetail table. UPDATE 1 : Have found this link http://www.simple-talk.com/sql/t-sql-programming/xml-data-modification-language-workbench/ which should help. UPDATE 2: I eventually coded the below, possibly not the most elegant but it seems to work. Spent a good ten mins trying to pass the variable in through a parameter of sp_executeSQL but couldn't get it to work so just knocked out the below...will add QUOTENAME at some point before live. SET @SQL = N' UPDATE import.XMLCompanyDetail SET XMLData.modify(''delete (//VN/CompanyList/Row[@num != ' + CONVERT(VARCHAR,@RowNum) + '])'') ' EXECUTE SP_EXECUTESQL @SQL
