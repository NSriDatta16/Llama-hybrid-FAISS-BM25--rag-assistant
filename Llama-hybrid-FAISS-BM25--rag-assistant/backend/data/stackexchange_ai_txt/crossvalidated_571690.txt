[site]: crossvalidated
[post_id]: 571690
[parent_id]: 
[tags]: 
Categorical linear-model coefficients from a pairwise competition experiment

I am presenting a question for which there may be a simple statistical answer, but I have prefaced it with perhaps a longer explanation, to err on the side of caution, in hopes that the data make more sense. I hope you find it interesting also. Background I have results from a microbiological experiment, involving pairwise mixtures of five types of bacteria. Each bacterial type (called a genotype ) is labelled alphabetically {A,B,C,D,E}. Thus the pairings look something like (A vs. A, A vs. B, A vs. C, ... ,E vs. E). For brevity I denote these competitions as ordered pairs (A,A), (A,B) and so on. Each of the pairs bacteria are grown together in a test tube with limited resources. From the data I collect about their growth I can see how well each genotype competes with all others, and importantly, determine which of the two was the better competitor, for each pair. The resultant values are a measure of a kind of relative fitness in competition, termed the "selection coefficient". Briefly, an ordered pair of two competing bacteria (A,B), $s>0$ when A is a better competitor than B, $s when the converse is true, and $s\approx0$ when I don't notice a measurable difference between the two. (I won't mention more about how I measured the selection coefficients, since it's a different story altogether. But for clarify, it is measured from the log change of frequencies of the two types of bacteria in the test tube. If the frequencies of the two competing bacteria, A and B, are denoted by frequencies $a$ and $b$ , and $b=1-a$ , then the selection coefficient for the competition (A,B)is given as $$s_{(A,B)}=\frac{d}{dt} \ln{\frac{a}{1-a}}$$ .) There is an extra level of detail to these experiments: each bacteria is labelled with a fluorescent label, so I can distinguish between each genotype when grown in pairs. To be thorough, I have labelled each of the five genotypes using three colors: Green, Cyan, and Orange. Importantly, the fluorescent label may also burdens the cell's growth, though that depends on the color: Cyan and Orange don't seem to affect the growth of the bacteria, but the green label seems to slow the bacteria down. This means the competition of two bacteria of genotype A can be done in three different ways: A(cyan) vs. A(green), A(orange) vs. A(green), A(cyan) vs. A(orange). The resulting measurement from a competition like (A(cyan),A(green)) will yield a selection coefficient $s>0$ if indeed Cyan is less burdensome for the bacteria than Green. Taking these two facts together, the overall selection coefficient can be represented as a sum of two selection coefficients, one representing the effect of the genotype, and one representing the effect of the colors. Thus, $$ s_{A(cyan),B(green)} = s_{A,B} + s_{cyan,green}.$$ Setup The data corresponds to seventy five different competitions, which can be visualized as three square tables. As an example, here is the table of all pairwise competitions for the Cyan vs. Green competitions $$ \left[ {\begin{array}{cccc} (A_{cyan},A_{green}) & (A_{cyan},B_{green}) & \cdots & (A_{cyan},E_{green}) \\ (B_{cyan},A_{green}) & (B_{cyan},B_{green}) & \cdots & (B_{cyan},E_{green})\\ \vdots & \vdots & \ddots & \vdots\\ (E_{cyan},A_{green}) & (E_{cyan},B_{green}) & \cdots & (E_{cyan},E_{green})\\ \end{array} } \right] $$ There are two more tables like these for the other two color combinations. I have done each of these 75 competitions four times (replicate experiments). Here is a data.frame of simulated selection coefficients to help demonstrate the problem. Note that the pair of flourescent probes used is denoted by the first letter of each color, thus Cyan vs. Green is "CvO" under the column pair . Then, each of the two genotypes is displayed as a separate column, resulting in two columns gen1 and gen2 . Replicates are denoted under the column rep . library(tidyverse) ##To make simulated dateset ##Cyan and orange don't burden growth, and green burden assigned as color_effect ##Genotypes D and E are significantly worse competitors st.dev = 0.03; color_effect = 0.05; weak_gen = -0.05; set.seed(1) simul_fitdat % #Adding color effect mutate(s=case_when( color_pair == "CvG" ~ rnorm(n(),mean=color_effect,sd=st.dev), color_pair == "OvG" ~ rnorm(n(),mean=color_effect,sd=st.dev), color_pair == "CvO" ~rnorm(n(),mean=0,sd=st.dev))) %>% ## adding weak_gen effect to genA and genB mutate(s=case_when( gen1 %in% c("D","E") ~ s+rnorm(n(),mean=weak_gen,sd=st.dev), gen2 %in% c("D","E") ~ s+rnorm(n(),mean=-weak_gen,sd=st.dev), T~s)) simul_lm Here is the output summary I get: Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 0.0063047 0.0079558 0.792 0.4287 color_pairCvG 0.0606199 0.0058757 10.317 As expected, the color effects for green are well estimated by the model. The competitive deficits of genotypes D and E were not as well estimated. Note that genotypes D and E have positive coefficients in gen2 because selection coefficient preserves the order, and so the coefficient describes the fitness of a genotype when competed against D or E. So really it should be that coefficients $gen2D = -gen1D$ : the two model coefficients for D are "mirrored" (based on whether it was in the numerator or denominator of the selection coefficient calculation). Questions (I don't expect all of these questions answered but hopefully if one of these is obvious for you to explain you can feel free to just respond to that one). I ran the code multiple times with different seeds and the competitive deficit of genotypes D and E are routinely overestimated when they are in gen1, and underestimated when they are in gen2. Is it a stupid mistake in my code? probably. But changing the seed and also increasing number of replicates don't seem to change this result. Ideally, I would pool all of the data about genotypes D and E as a single effect, but I can't think of how to do this. I know that the data layout is not a unique solution: for example, you can place the two colors as separate columns instead of as a single one. (I have a feeling that taking the average of the two linear model coefficients for genotype D, (i.e. $genD = (gen1D - gen2D)/2$ ), even though it operationally works, would be committing a statistical felony. Not sure how the uncertainty would carry forward in that case either). Is this one of the cases when it is OK to run a model without an intercept? That way at least I can de-confound the effect of CvO from gen1A. I have a suspicion that in my actual data, the selection coefficient is not a simple sum of the color and genotype effects: there is actually an interaction of the genotype with the color. So something like $s_{A(cyan),B(green)} = s_{A,B} + s_{cyan,green} + \epsilon_{A+cyan} - \epsilon_{B+green}$ . If I don't know which genotype interacts with which color, I assume I have to create my linear model with the two interaction terms lm(s~ color_pair + gen1 + gen2 + color_pair gen1 + color_pair gen2)? Any suggestion is much appreciated. Thanks!
