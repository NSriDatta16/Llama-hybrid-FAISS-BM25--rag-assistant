[site]: crossvalidated
[post_id]: 173493
[parent_id]: 162312
[tags]: 
For anyone interested, this paper helped me a lot further: Estimating Predictive Variances with Kernel Ridge Regression by G. C. Cawley , N. L. C. Talbot and O. Chapelle Note that this paper explains how to do it for heteroscedastic noise, however you can also use it for homogeous noise as follows. The first method, KRR + LOO: Train the KRR model on the data For each sample, compute the LOO error To estimate the $\sigma^2$ compute the sum of squared residuals that were found in step 2 A more detailed method is KRR + LOO + KRR. Train the KRR model on the data For each sample, compute the LOO error Train a KRR model on the squared residuals that were found in step 2 The predictions of the second model are the prediction variances, however now we have to regularize two models, but we do get heteroscedastic variances. I guess I could also take the mean prediction of the second KRR model to find the homogeous noise term $\sigma^2$, but I'm unsure if this is useful or better than the above method. Finally, they propose a new model, that will directly take heteroscedastic noise into account. This way, the model can be regularized more in noisy regions in feature space, and thus this model is expected to perform better. In the end what I am really interested in is to estimate the probability distribution of the prediction on unseen / new data. The methods that I am now considering are: Performing the KRR + LOO method to estimate $\sigma^2$. Now I can estimate the variance of new data using: $$ \hat{y_{new}} = K_{x_{new},X_{trainset}} (K_{X_{trainset},X_{trainset}} + \lambda I)^{-1} y_{train} = P y_{train}$$ Using the identity: $$ Cov(Xa) = X^T Cov(a) X$$ I obtain: $$ Cov(\hat{y_{new}}) = P_{train}^T P_{train} \sigma^2 $$ I use the prediction on unseen data of the regular KRR model as the mean for the distribution. Performing KRR + LOO + KRR. I have two choices, I either estimate $\sigma^2$ by averaging the outputs of the second KRR model and use the above formula, or I directly use the prediction of the second KRR model on new data to estimate the prediction variance of a new point. I use the prediction on unseen data of the regular KRR model as the mean for the distribution. I use their new model to estimate the mean and variance at unseen data. I use bootstrapping to train multiple models, and I compute the variance of their predictions on the traindata. This way I can compute $\sigma^2$. Then I use the same formula as in 1. I use the prediction on unseen data of the regular KRR model as the mean for the distribution. I use bootstrapping to train multiple models, and I compute their predictions on my new data. I compute the variance of those predictions, to compute the prediction variance of each point. I use the prediction on unseen data of the regular KRR model as the mean for the distribution. What I am a bit confused about is the actual distribution of the prediction on data at a new point. Is this distribution actually a Gaussian / normally distributed?
