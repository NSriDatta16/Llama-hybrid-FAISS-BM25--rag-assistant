[site]: crossvalidated
[post_id]: 643353
[parent_id]: 639594
[tags]: 
I am by no means an expert, but these are exactly something I struggled with also, so here is my stab at it: I would recommend the following for permutation design. how(within = Within(type = "series"), plots = Plots(strata = Sample.ID), nperm = 999) As far as I know, Within specifies how to deal with having two values for each Sample.ID would be dealt with. plots specifies that each Sample.ID is the subject of repeated measure. Blocks actually doesn't work. If you need to use it (i.e. if I am misunderstanding and you must use Sample.ID as block), you can pass it within how() as blocks = Sample.ID . See Gavin (author of "permute" )'s answer to my question here . ahhh... marginal tests with multiple interactions. Afaict, there is no way of doing it and I have been doing what you are describing. As the author of vegan writes , there is no way to test interactions and main effects at the same time ("no one has written those"). This archived email thread also comes to the same conclusion. Now, for the workaround, I have also been doing the "old school ANOVA" approach. I test A*B*C , which gives me A:B:C , if that is significant I switch gears to pairwise comparisons. If not significant, formula is adjusted to A*B*C-A:B:C , which gives me A:B , B:C , A:C . If none of these are significant, then I test for A+B+C. If any of the interactions are significant, I use pairwise comparisons. So far no one I know (including my institution's statistical department) has any better idea, and I think even if it may not be 100% elegant, it is a defensible approach. If someone else (or you, now that you had to wait a bit), have better ideas, I would love to know. Hope that helps.
