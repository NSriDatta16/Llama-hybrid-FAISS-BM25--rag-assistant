[site]: stackoverflow
[post_id]: 4516122
[parent_id]: 4515700
[tags]: 
Unless you intentionally separate the encryption blocks for each element you wish to search for (which is a perfectly viable option), you will have to at least decrypt half of the file each time (on average). You can either encrypt line-by-line (like I said, perfectly possible), encrypt your search text, and then simply find the line that matches. Otherwise you will have to decrypt the file and search the output of the decryption process for the search string. If you can search the output while the encryption is still in progress, you can probably stop the decryption early when you find the text. I like the encrypted database idea from SilverbackNet, and I agree you shouldn't roll your own. You may also need to ensure the index is encrypted as well, if the database doesn't take care of that detail for you (it should)
