[site]: crossvalidated
[post_id]: 614618
[parent_id]: 
[tags]: 
How do you estimate multiple poisson rates simultaneously?

I have data showing the number of cause-specific deaths in a cohort. I want to use Poisson regression to estimate the cause-specific rate by age. The complication is that I want the predicted cause-specific rates to add-up to the predicted all-cause rate. Here is some data in R format, showing the total duration of follow-up in the cohort by age ( person_years ), the number of all-cause deaths ( all_cause ), and the number of deaths due to three causes: accidents ( accidents ), non-communicable diseases such as heart disease ( ncd ), and other ( other ): d We can use Poisson regression to fit a curve on the all-cause rate. In this model, I've used age and age squared: model1 We can predict the age-specific mortality rate and compare this to the observed rates graphically: model1 $age, person_years = 100000) d$ predicted_all_cause $observed_all_cause all_cause / d $person_years * 100000 plot(d$ age, d $observed_all_cause, ylab = 'mortality rate per 100,000', xlab = 'age') lines(d$ age, d$predicted_all_cause) So that works fine, but if we did something similar with each cause of death, the predicted rates would not add up to the all-cause rate we just estimated. If we fit a separate model for each cause of death ... m_accidents ... Then predict the age-specific rates ... d $predicted_accidents predicted_ncd ... When we add them up, they don't equal the all-cause rate. The head of the table comparing the two is shown below. d $sum_predicted_cause_specific predicted_accidents + d $predicted_ncd + d$ predicted_other head(d[, c('age', 'predicted_all_cause', 'sum_predicted_cause_specific')]) age predicted_all_cause sum_predicted_cause_specific 1 18 102.2936 108.3501 2 19 111.8447 118.4173 3 20 122.2923 129.3918 4 21 133.7212 141.3514 5 22 146.2239 154.3805 6 23 159.9019 168.5714 The fact they are different is not surprising since the curves are estimated separately. But I want them to add up exactly, so that the modelled all-cause rate 'decomposes' into the modelled cause-specific rates. The two approaches I've considered are: a multivariate poisson model, for example using vgam::vglm , but this model will not force the sum of cause-specific rates to add up to the all-cause rate. estimating the all-cause rate using glm and then using multinomial logistic regression to estimate the proportion at each age that are due to each cause of death. This seems like it might work, but feels complicated. I can't figure out the best approach. I'm happy to use any common statistical software.
