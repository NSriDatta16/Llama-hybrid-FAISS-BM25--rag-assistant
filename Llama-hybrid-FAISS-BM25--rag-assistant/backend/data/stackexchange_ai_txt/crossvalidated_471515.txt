[site]: crossvalidated
[post_id]: 471515
[parent_id]: 
[tags]: 
Understanding Loss functions in Stacked Capsule Autoencoders

I was reading Stacked Capsule Autoencoder paper published by Geoff Hinton's group last year in NIPS. While reading section 2.1 about constellation autoencoders I couldn't understand how the expression of parts likelihood is calculated. Likelihood expression given in the paper is as follows $$ p(x_{1:M}) = \prod_{m=1}^{M} \sum_{k=1}^{K} \sum_{n=1}^{N} \frac{a_k a_{k,n}}{\sum_{i} a_i \sum_{j} a_{i,j}}p(x_m|k,n) $$ The way I understood it is that it's Gaussian Mixture model. $a_k$ represents the presence probability of $k^{th}$ capsule, $a_{k,n}$ represents the conditional presence probability of $n^{th}$ candidate part { $n^{th}$ Gaussian class} in $k^{th}$ object capsule and $p(x_m | k,n)$ represents the probability that $x_m$ part capsule belongs to $n^{th}$ Gaussian class { $n^{th}$ candidate part} of $k^{th}$ object capsule. So to find the $p(x_1)$ over 'k' object capsules, each having 'n' candidate predictions we marginalize $p(x_1)$ over 'k' and 'n' . So shouldn't the likelihood expression be $$ p(x_{1:M}) = \prod_{m=1}^{M} \sum_{k=1}^{K} \sum_{n=1}^{N} a_k a_{k,n} \space p(x_m|k,n) $$ From where does $\sum_{i} a_i \sum_{j} a_{i,j}$ is coming in the denominator of expression given in the paper?
