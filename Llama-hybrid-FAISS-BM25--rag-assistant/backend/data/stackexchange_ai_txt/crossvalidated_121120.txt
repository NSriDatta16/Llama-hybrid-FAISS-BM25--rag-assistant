[site]: crossvalidated
[post_id]: 121120
[parent_id]: 
[tags]: 
Why does this logistic GAM fit so poorly?

I am trying to create a logistic regression model with mgcv::gam with what I think is a simple decision boundary, but the model I build performs very poorly. A local regression model built using locfit::locfit on the same data finds the boundary very easily. I want to add additional parametric regressors to my real-life model, so I do not want to switch to a purely local regression. I want to understand why GAM is having trouble fitting the data, and whether there was ways of specifying the smooths that can perform better. Here's a simplified, reproducible example: Ground truth is 1 = point lies within the unit circle, 0 if outside e.g. z = 1 if sqrt(x^2 + y^2) The observed data is noisy, with both false positives and false negatives Construct a logistic regression to predict whether a point is inside the circle or not, based on the point's Cartesian coordinates. Local regression can find the boundary well (50% probability contour is very close to the unit circle), but a logistic GAM consistently overestimates the size of the circle for the same probability band. library(ggplot2) library(locfit) library(mgcv) library(plotrix) set.seed(0) radius ### Model boundary condition using x,y coordinates ### local regression finds the boundary pretty accurately m.locfit ### But GAM fits very poorly, also tried with fx=TRUE but didn't help m.gam ### gam.check doesn't indicate a problem with the model itself gam.check(m.gam) Method: UBRE Optimizer: outer newton full convergence after 8 iterations. Gradient range [5.41668e-10,5.41668e-10] (score -0.815746 & scale 1). Hessian positive definite, eigenvalue range [0.0002169789,0.0002169789]. Basis dimension (k) checking results. Low p-value (k-index ### But GAM misses again m.gam2 ### Can also plot gam on link scale for alternate view plot(m.gam2, se=FALSE, rug=FALSE) abline(v=1, col="red") gam.check(m.gam2) Method: UBRE Optimizer: outer newton full convergence after 4 iterations. Gradient range [-3.29203e-08,-3.29203e-08] (score -0.8240065 & scale 1). Hessian positive definite, eigenvalue range [7.290233e-05,7.290233e-05]. Basis dimension (k) checking results. Low p-value (k-index
