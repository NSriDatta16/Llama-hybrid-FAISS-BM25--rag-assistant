[site]: stackoverflow
[post_id]: 5286075
[parent_id]: 5283466
[tags]: 
I have written a short script in VBA. Hopefull it does what you want. Here you are: Function MovingAverage(ByVal r As String, ByVal i As Integer) As Double Dim rng As Range, counter As Long, j As Integer, tmp As Double Set rng = Range(r) counter = 360 j = 0 tmp = 0 While j 0 If Len(rng.Offset(j, 0)) > 0 Then tmp = tmp + rng.Offset(j, 0).Value End If j = j + 1 counter = counter - 1 Wend MovingAverage = CDbl(tmp / i) End Function 1) I have set limit to 360 cells. It means that the script will not look for more than 360 cells. If you want to change it then change the initial value of counter . 2) The script returns not rounded average. Change the last row to MovingAverage = Round(CDbl(tmp / i),2) 3) The use is just like you wanted, so just type =MovingAverage("a1";3) into the cell. Any comments are welcome.
