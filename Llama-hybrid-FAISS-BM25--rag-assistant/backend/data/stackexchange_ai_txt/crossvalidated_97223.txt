[site]: crossvalidated
[post_id]: 97223
[parent_id]: 
[tags]: 
Thinking about Neural Networks

I am confused about the output I am getting for a neural network analysis. What I am trying to do is take in the features from features.csv and use them to create a neural network to predict the variable Murder.per.100.000 . The first column is a label for each observation so I exclude that. The problem I am having is that preds is a vector of NA . Some of my features are sparse. I assume I am not dealing with missing values correctly. How should I fix that? When I limit it to non-sparse features, preds is made up of all the same value somewhere near 1 which doesn't seem right either. library('nnet') dat = read.table("features.csv", sep=",", header=TRUE) # remove observation label dat = dat[ ,-c(1)] nData = dim( dat )[1] trainInd = sample( (1:nData), 300 ) # create the training data: trainData = dat[ trainInd, ] # create the test and validation dataset: notTrainData = dat[ -trainInd, ] nData = dim( notTrainData )[1] valInd = sample( (1:nData), nData/2 ) testData = notTrainData[-valInd,] valData = notTrainData[valInd,] net = nnet(Murder.per.100.000 ~ ., data=trainData, size=5, rang=.1, decay=5e-4, maxit=200, na.action=na.exclude) preds = predict(object=net, newdata=valData)
