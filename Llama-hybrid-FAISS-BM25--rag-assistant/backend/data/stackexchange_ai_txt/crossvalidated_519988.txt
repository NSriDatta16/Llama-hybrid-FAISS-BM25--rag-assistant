[site]: crossvalidated
[post_id]: 519988
[parent_id]: 
[tags]: 
Why is the Marginal Likelihood Estimator proposed in VAE not based on importance sampling?

I'm interested in evaluating $p(x)$ using a variational autoencoder. I would expect the straightforward way to estimate the marginal likelihood to be based on importance sampling: \begin{align} p(x) &= \int_z p(z) p(x|z) \frac{q(z|x)}{q(z|x)} dz \\ & = \mathbb{E}_{q(z|x)} [ p(x | z) \frac{p(z)}{q(z|x)} ] \end{align} However, in Kingma and Welling (2013) , the authors suggest a different method in appendix D. Is there a good reason for this? The authors furthermore suggest to estimate $q(z|x)$ with a density estimation after drawing samples from it. Why is this necessary if we know $q(z|x)$ explicitly?
