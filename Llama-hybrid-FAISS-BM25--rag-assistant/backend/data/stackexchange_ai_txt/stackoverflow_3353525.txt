[site]: stackoverflow
[post_id]: 3353525
[parent_id]: 3348937
[tags]: 
If 500 or more users sends emails at the same time hmmm. It's very unusual for two events to occur "at the same time" on a computer system - but frequent for processes to overlap. I expect you will get a lot of mileage out of optimizing the email handler. But you've provided very little details of how that works. Not do you say what OS this is running on. I'd recommend you check that there aren't signs of overuse on the CPU or memory (NB you want around 80% of your memory free). If the handler starts a PHP instance for each message then that's a major overhead - but this does not contribute to the time that the mysql connection is open. If you can avoid it, don't use Blobs/Clobs - dump the data to diskfile and reference it from the database. Apply all the usual performance tuning steps (optimizing physical storage layer - e.g. RAID, database tuning). Collate all the DB interactions run by the script and run them in one block, bracketed with your db connect and close statements. If you can't handle the volume synchronously, then... Rather than reinventing the wheel, DO NOT implement your own queueing system for processing of messages - route the messages directly to a maildir or mailbox and run a daemon to poll the contents and process it. The off-the shelf MDAs will be much more efficient than using PHP. C.
