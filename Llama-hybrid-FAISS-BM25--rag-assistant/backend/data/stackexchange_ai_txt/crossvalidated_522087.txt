[site]: crossvalidated
[post_id]: 522087
[parent_id]: 521654
[tags]: 
Some gene-expression deconvolution methods start from assumptions about the gene-expression profiles (GEP) of individual cell types in a mixture. Others start from assumptions about the fractions of individual cell types within each of a set of samples. More recently, methods have been developed to try to estimate both cell-type fractions and cell-type GEPs simultaneously. For question 1 , the type of deconvolution done by CIBERSORT , the method at question in the query to Bioconductor help that you link in a comment, starts with a set of genes whose expression levels have already been determined for individual cell types within the tissue, the cell-type GEPs. Those might have been determined from pure cell cultures of individual cell types or from single-cell RNA sequencing (sc-RNAseq). You then take a set of multiple bulk samples, and use the known GEPs for the individual cell types to find the proportions of cell types within each sample that best agree with the observed overall expression of those genes. That approach assumes that the GEP for each cell type is fixed and constant among all bulk tissue samples. If you are interested in cell-type-specific expression of one of the genes in the GEP, that's already fixed by its expression within the assumed GEP. If you are interested in cell-type-specific expression of a gene not within a GEP, you don't have any direct information at all! After deconvolution you know the relative numbers of each type of cell, but outside the genes in the GEP you don't at that point know anything about how expression differs among cell types. Simply multiplying a gene-expression value by the fraction of cells of one type would assume that all cell types have equal expression of that gene, not a very reasonable assumption. For question 2 , it's simplest to start with an early deconvolution method, csSAM , designed originally for gene-expression data from microarrays. That method assumes that you already know the fraction of each cell type within each sample, determined for example by flow cytometry to distinguish blood cell types in a bulk blood sample. If you have a large number of samples with a wide enough variety of cell-type fractions, then you can try to associate the differences in gene expression among the samples with the differences in cell-type fractions among the samples. The csSAM method just does that by ordinary least-squares regression. For each gene, you do a regression of its expression values against the known cell-type fractions for the samples. The regression coefficients corresponding to each cell type for that gene provide its estimated average expression in that cell type. You can then combine the individual-gene associations with cell types into a GEP for the cell type. Unlike CIBERSORT, which assumes the same GEP for a cell type among all samples, csSAM only assumes that you know the fractions of cell types within each sample. So if you have multiple bulk samples collected under, say, 2 different conditions, you can examine differences in GEP for the same cell type between the conditions. If you start with CIBERSORT to estimate cell-type fractions among a set of samples , you could use an approach like csSAM to estimate cell-type GEPs for genes not in the GEP used by CIBERSORT. That leads into unsupervised deconvolution. More recent unsupervised deconvolution methods essentially put together those two approaches. You try to find the combination of cell-type-fractions per sample and GEP per cell type that best represents the data. For example, CDSeq uses a type of model that's been used to classify documents in an unsupervised way into types, latent Dirichlet allocation (LDA). In document classification you simultaneously model the distributions of words in different document types and the number of document types; for gene-expression deconvolution, you simultaneously model the GEPs for different cell types and the number of cell types. How well that completely unsupervised deconvolution works for gene expression is an open question. For example, the supplement to a recent bioRxiv preprint extending the CDSeq method compared its unsupervised deconvolution against sc-RNAseq data in head and neck tumors to try to line up the CDSeq-identified cell types with known cell types. (A tumor contains both invasive cancer cells and several types of normal cells, many of which represent a response to invasion by the cancer cells.) 11 of the 19 cell types identified in an unsupervised way were found strongly related to a known fibroblast GEP (thus presumably were not invasive cancer cells), while only 1 or 2 bore even a moderate relation of GEP to that known for the invasive head and neck cancer cells. That might end up being correct, but one might have hoped instead to find better associations with the several cancer cell types already distinguished in the sc-RNAseq work. In response to comment about CIBERSORTx CIBERSORTx has been proposed as a way to get cell-type-specific GEPs within individual samples , not just an estimate pooled across all samples for each cell type. That "high resolution deconvolution" would allow determination of cell-type-specific changes in expression as a function of experimental conditions that differ among samples. Here's a rough description of how that is done, mostly based on Supplementary Figure 7 associated with the manuscript. The analysis starts with an overall breakdown of expression by cell type among all samples, as above, to get estimates of cell-type fractions in each sample. Those cell-type fractions per sample are used throughout what follows. Per-sample deconvolution is then done gene by gene . For each gene, the samples are arranged in order of increasing expression. The idea is that a cell type with differential expression of that gene among the samples will tend to be differentially represented at one or the other end of that ordering of samples. Also, samples with similar expression values of that gene are likely to have similar representations of cell-type-specific expressions. So for each gene you: Break the set of samples into 2 subsets above/below a cutoff in expression values and do separate cell-type deconvolutions within each of the 2 subsets of samples. Move that cutoff around to find the cutoff that best recapitulates the gene expression data based on the separate deconvolutions for the 2 subsets. Omit any cell types that don't show differential expression between those two subsets of samples, and repeat the above to refine. That provides a set of "anchors," cell-type-specific expression values within each of the 2 subsets, to constrain the final estimate. Get an initial overall estimate of a smooth cell-type- and sample-specific set of expression values. You start with $w$ samples having the lowest expression of the gene, fit the cell-type and sample-specific expression within the "window" of $w$ samples, and then move that constant-width "window" progressively up to samples with higher expression values. "...sample-specific expression differences for a given cell type are averaged out within a given window, despite being captured across windows" (page 36 of Supplemental Material linked above).* Fit that initial estimate to the "anchors" from Step 4 to get the final estimate of cell-type- and sample-specific expression estimates for that gene. Repeat for all genes, and combine into full GEPs for each cell type and sample. The paper also provides methods that allow better comparison of gene-expression results among different expression-analysis platforms, critical practical advances that extend the usefulness of all deconvolution methods. *To deal with what happens with the "window" when you come to the top end of expression-ranked samples, you repeat the last values to fill in the top $w-1$ samples, go through the entire process in order from highest expression to lowest, then average the 2 sets of smoothed cell-type- and sample-specific expressions together.
