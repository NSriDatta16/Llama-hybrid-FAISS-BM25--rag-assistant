[site]: stackoverflow
[post_id]: 1196258
[parent_id]: 
[tags]: 
Convert Bitmap to Image

So after I pull an image out of DLL and put it into an image control it is a BitmapImage. To package it back into the dll it has to be converted back to an image. How can I convert it back to image and how can i repackage it back into the dll? This is all in wpf written in c#. private void compileDLL_Click(object sender, RoutedEventArgs e) { string sourcePath = Directory.GetCurrentDirectory() + "\\PCAngelResources.dll"; //destination path string dllname = textBox1.Text + "_PCAngelResources.dll"; string targetPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop); string destFile = System.IO.Path.Combine(targetPath, dllname); System.IO.File.Copy(sourcePath, destFile, true); //lstImages = new Dictionary (); //string filename = "PCAngelResources.dll"; Assembly pcangdll = Assembly.LoadFile(sourcePath); System.Globalization.CultureInfo culture = Thread.CurrentThread.CurrentCulture; ResourceManager rm = new ResourceManager("PCAngelResources.DynResources", pcangdll); rs = rm.GetResourceSet(culture, true, true); ResourceWriter writer = new ResourceWriter(destFile); foreach (DictionaryEntry resource in rs) { resources.Add((string)resource.Key); if (resource.Key.Equals("Branding") || resource.Key.Equals("Advertising")) { if (resource.Key.Equals("Branding")) { writer.AddResource("Branding", image5.Source); //System.Object obj = rm.GetObject((string)resource.Key); //lstImages.Add((string)resource.Key, (Bitmap)obj); } else if (resource.Key.Equals("Advertising")) { writer.AddResource("Advertising", image6.Source); } } } writer.Generate(); System.Windows.MessageBox.Show("Done", "Process Finished", MessageBoxButton.OK, MessageBoxImage.Asterisk, MessageBoxResult.OK); } When I do writer.Generate() to make the new dll I get the following error: An unhandled exception of type 'System.Runtime.Serialization.SerializationException' occurred in mscorlib.dll Additional information: Type 'System.Windows.Media.Imaging.BitmapFrameDecode' in Assembly 'PresentationCore, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' is not marked as serializable.
