[site]: stackoverflow
[post_id]: 1274996
[parent_id]: 1274862
[tags]: 
My suggestion to you would be design the desired solution first (firstly assuming that the requirements are the same) and then build a phased migration path from the existing code base basing it on the requirements that third party functionality may introduce. Refactoring should be one small step at a time - but knowing where you are going. The Working Effectively with Legacy Code (Robert C. Martin Series) will be a good read I'd suggest. Trust me (I've got the t shirts) don't attempt to refactor unless you know how to prove functionality - automated verification tests will be your saviour.
