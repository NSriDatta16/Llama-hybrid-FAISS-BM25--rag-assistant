[site]: stackoverflow
[post_id]: 4662619
[parent_id]: 4662538
[tags]: 
What about: SELECT sq.ID, sq.name, SUM(sq.premium) AS total_cost FROM ( SELECT m.id, m.name, g.premium FROM members m INNER JOIN (select distinct ID, PlanID from member_selections) s USING(ID) INNER JOIN selection_details g USING(planid) ) sq group by sq.agent By the way, is there a reason you don't have a primary key on member_selections that will prevent these duplicates from happening in the first place?
