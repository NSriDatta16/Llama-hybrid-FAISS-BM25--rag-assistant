[site]: crossvalidated
[post_id]: 391416
[parent_id]: 391408
[tags]: 
Let's walk through the matrix arithmetic. The matrix-vector product $Xw_1$ has shape $(m,n)(n,1)$ , so the result has shape $(m,1)$ . We can think of this as each row of X being mapped to a scalar. This doesn't match with the text's description: the intent appears to be to have an output for each class, i.e. multinomial logistic regression. For this to be multinomial logistic regression, we would need to have w_1 with shape $(n,P)$ . I don't recall TF's broadcasting rules but if this code executes without raising shape-related exceptions, it's probably because of behind-the-scenes broadcasting. This should be easy enough to validate: supply some data and check if there is a constant difference between each value of Y_hat . Mistakes like these are why I advocate for writing unit tests for neural network models, as I do here: What should I do when my neural network doesn't learn?
