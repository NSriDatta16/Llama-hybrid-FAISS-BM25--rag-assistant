[site]: crossvalidated
[post_id]: 342713
[parent_id]: 
[tags]: 
Variance of the Sum of Correlated Variables in R

I'm looking to compute $n\text{Var}\left(\frac{1}{n}\sum_{i=1}^nX^{(i)}\right) = \frac{1}{n}\sum_{i=1}^n\sum_{j=1}^n\text{Cov}\left(X^{(i)},X^{(j)}\right)$ in R. Assuming the X's not to be iid, we get $$ n\text{Var}\left(\frac{1}{n}\sum_{i=1}^nX^{(i)}\right) = \text{Var}\left(X^{(1)}\right) + 2\sum_{k=1}^{n-1}\left(1-\frac{k}{n}\right)\text{Cov}\left(X^{(i)},X^{(i+k)}\right).$$ But as far as I can see, $\text{Cov}\left(X^{(i)},X^{(i+k)}\right)$ is the auto-covariance $C_{XX}(k)$, i.e. $$ n\text{Var}\left(\frac{1}{n}\sum_{i=1}^nX^{(i)}\right) = \text{Var}\left(X^{(i)}\right) + 2\sum_{k=1}^{n-1}\left(1-\frac{k}{n}\right)C_{XX}(k).$$ However, when I try to compute this value for a simple Markov chain I get very inconsistent results. So I'm just wondering if anyone could help me figure out where this has gone wrong? Or is this method jut infeasible and I should rather compute several Markov chains and compute the empirical variance? I must add that I'd like to use this on a MCMC method on a multivariate distribution where I'd like to compute $n\text{Cov}\left(\frac{1}{n}\sum_{i=1}^nX^{(i)}\right)$. # Generates MC with transition probability matri K MC
