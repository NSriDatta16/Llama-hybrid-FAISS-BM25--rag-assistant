[site]: crossvalidated
[post_id]: 497658
[parent_id]: 
[tags]: 
How do I calculate the metric Cumulative Gain,...?

I am currently in the process of creating a recommender system. Here I use a neural network and then I use k-means to find the closest neighbors and thus show the user 20 recommended articles. I would like to use the Cumulative Gain (CG), Discounted Cumulative Gain (DCG) and Normalized Discounted Cumulative Gain (NDCG) metrics. I also found the following article and the following implementation of scikit-learn . from sklearn.metrics import ndcg_score >>> # we have groud-truth relevance of some answers to a query: >>> true_relevance = np.asarray([[10, 0, 0, 1, 5]]) >>> # we predict some scores (relevance) for the answers >>> scores = np.asarray([[.1, .2, .3, 4, 70]]) >>> ndcg_score(true_relevance, scores) We speak of true_relevance and scores here. How do I get this? Are these my y_test and y_train , or do I only get these values ​​after using the k-means algorithm? Can someone help me on how to get this data so that I can calculate the metrics? (If something is missing, please let me know) Dataframe : d = {'purchaseid': [0, 0, 0, 1, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 8, 9, 9, 9, 9], 'itemid': [ 3, 8, 2, 10, 3, 10, 4, 12, 3, 12, 3, 4, 8, 6, 3, 0, 5, 12, 9, 9, 13, 1, 7, 11, 11]} df = pd.DataFrame(data=d) purchaseid itemid 0 0 3 1 0 8 2 0 2 3 1 10 4 2 3
