[site]: crossvalidated
[post_id]: 552749
[parent_id]: 
[tags]: 
Estimating a conditional logistic model with hierarchical splines in mgcv leads leads to error "indefinite penalized likelihood in gam.fit5"

One can estimate a conditional logistic model in the R package mgcv by using the cox.ph family, which I have done successfully. I also estimated a logistic regression model with hierarchical spline coefficients. However, when I try to estimate a conditional logistic model with hierarchical spline coefficients as follows: fit = gam(cbind(D,ID) ~ te(X, bs = "tp", m = 2) + t2(X, edu, bs = c("tp","re"), m = 2, full = TRUE), data = my_data, family = cox.ph, weights = is.case) i get the error Error in gam.fit5(x, y, sp, Sl = Sl, weights = weights, offset = offset, : indefinite penalized likelihood in gam.fit5 I'd be grateful for any hint pointing to a potential solution or mistake I am making.
