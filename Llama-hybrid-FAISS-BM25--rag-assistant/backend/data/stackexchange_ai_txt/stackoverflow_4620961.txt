[site]: stackoverflow
[post_id]: 4620961
[parent_id]: 4466608
[tags]: 
clockworkgeek was pretty close and led me to my answer... I tried using $product->setCategoryId() and was finding that $product->getCategoryId() wasn't returning anything and that the Mage_Catalog_Model_Product_Url::getUrl method depends on the getCategoryId method on the product model to figure out a product's URL. Turns out getCategoryId is explicitly defined in the product model (not a magic method like I assumed) that returns the value of Mage::registry('current_category') . So basically I registered and unregistered 'current_category' to meet my needs. This still leaves my question partially unanswered though. I figured out how to hack around and get what URL I wanted, but technically the messy /catalog/product/view/id/123/s/my-product-slug/ -type URLs still work and I'd rather all of the URL varieties route to the category-fied one. It would be great to be able to define a single, canonical URL style in Magento. If anyone has any further insight on this please let me know!
