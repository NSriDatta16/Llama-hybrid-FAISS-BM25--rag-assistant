[site]: stackoverflow
[post_id]: 1824527
[parent_id]: 1824494
[tags]: 
One problem I see right away is that you have a dollar sign with the variable "sum" in your awk scripts. Change it to remove the dollar sign. One of the lines would then look like this: awk 'sum+=$2 ;END {print "Average = " , sum/NR > ${file}_${f}_${order}_avrg.xls }' ${file}_${f}_${order}_v1.xls
