[site]: crossvalidated
[post_id]: 502167
[parent_id]: 
[tags]: 
How to detrend all time series in a dataframe in R using dplyr

I have the following dataset in xts format, and I'm looking to do some time series analysis from it. structure(c(18677.497, 18222.227, 16867.007, 18965.841, 18608.859, 19072.449, 17101.89, 19385.288, 19646.834, 19867.532, 17626.501, 20235.08, 20852.513, 21259.869, 18765.31, 21271.06, 22627.014, 22556.635, 21579.041, 22914.744, 23083.376, 23062.13, 20764.048, 24162.822, 24159.384, 24849.414, 22949.26, 25701.357, 24628.15, 25054.86, 25830.992, 27667.65, 27108.619, 25669.114, 26804.201, 26333.838, 25457.642, 24534.197, 27036.335, 29201.078, 27132.026, 27587.638, 28749.999, 29175.038, 29283.743, 28382.333, 31414.555, 29299.194, 32586.418, 30158.472, 30063.431, 31563.277, 31575.722, 32899.211, 34381.945, 33147.538, 32881.978, 34671.871, 35847.845, 36645.115, 35574.11, 36296.92, 37405.35, 36742.271, 36645.796, 35692.646, 36934.672, 36794.882, 35976.738, 35500.944, 36101.217, 36988.611, 36517.333, 37379.029, 36715.175, 35539.216, 34663.461, 36032.225, 35946.898, 37097.837, 34188.146, 32389.837, 32168.965, 42.9966666666667, 44.2033333333333, 45.5666666666667, 46.3, 47.62, 48.6433333333333, 49.26, 50.13, 51.8405150833333, 53.7733333333333, 55.3066666666667, 56.9166666666667, 57.6175482933333, 58.3361594633333, 58.7196899966667, 58.6720549433333, 60.1541554233333, 60.7875874833333, 61.1247683766667, 61.1488586, 61.4523545, 61.61478482, 62.5264384266667, 63.1718357133333, 63.94245124, 64.4201827933333, 65.9063788, 66.8380679666667, 67.9098129566667, 69.10212163, 70.3698299866667, 70.8222982333333, 72.2914593966667, 74.7296459766667, 77.7341064166667, 78.7505175333333, 80.49292375, 82.1400544466667, 84.55414004, 85.00514258, 86.4548283133333, 86.6238629666667, 87.6721355866667, 87.6355404966667, 89.30810005, 91.0023521466667, 92.0937081766667, 93.4210182133333, 95.69783909, 96.6817337133333, 98.06146735, 99.97489879, 101.406619866667, 102.435159633333, 103.7360652, 104.704998233333, 106.5782923, 108.6095302, 109.3568655, 109.795986533333, 110.640587933333, 111.861892133333, 112.9866813, 113.593102533333, 117.271491233333, 119.350996133333, 120.7862591, 121.883740166667, 126.259396233333, 126.9264564, 127.386035566667, 128.184010866667, 130.715982233333, 131.742100433333, 133.187568, 134.943302033333, 136.6293884, 137.250016166667, 137.8941875, 138.570247233333, 139.751306533333, 139.9266249, 141.0747244, 465990.97754, 484515.21016, 500522.38491, 503742.01024, 483390.73673, 502383.8991, 508077.92499, 513696.82776, 500483.3617, 521353.3611, 526146.90036, 533852.60914, 516533.95385, 538082.06656, 541952.97691, 546662.15657, 535892.72379, 558156.47211, 569163.0173, 577633.68752, 565082.48832, 587118.17746, 600212.06218, 606683.77562, 593898.64679, 615465.0028, 632122.74687, 649809.30126, 632100.00449, 649120.43738, 663508.58312, 680111.92561, 656295.49716, 679422.9244, 685028.52064, 687853.85451, 649053.90193, 661876.59584, 671863.6809, 684145.9283, 664088.13755, 682168.49847, 694274.00386, 707477.30712, 687269.40103, 705429.18827, 715412.68672, 730145.84925, 702157.60096, 724791.69889, 730225.7045, 743902.77601, 717484.42261, 743184.67793, 745650.77892, 766855.51712, 732210.96394, 755842.49481, 759757.54458, 780278.71195, 750791.67514, 764216.81446, 765471.14519, 783757.45604, 747421.32089, 768075.48873, 770486.37871, 790481.97576, 755994.07586, 780324.45369, 782485.60967, 801180.10121, 761397.08196, 781144.13778, 792362.60674, 809635.32456, 761632.84209, 788307.42636, 793431.43881, 805965.3287, 762288.31419, 650506.45248, 745498.83293, 44.631747752498, 45.7049948643754, 46.5635925538772, 47.0235556018246, 47.9434816977195, 48.6334262696406, 48.7867472856231, 49.0473930127933, 50.7091643905606, 52.4424974953788, 54.0153367941953, 55.7028145258701, 56.4915269439355, 56.78729410071, 56.3837668170487, 55.2969944735516, 55.4964653467251, 55.810574652757, 55.8862360184435, 56.209516399104, 56.5694810782792, 56.8491988544536, 57.2252129142289, 57.3673645709733, 57.7273292501485, 58.2936431084687, 59.3781226833087, 60.0086340640296, 60.6941718925225, 61.7992863852769, 63.1084572885192, 64.3488451320466, 66.1277136888001, 67.9444091198111, 70.1971114542647, 70.8147879008084, 71.9774729766555, 73.4671632300845, 74.6661822145517, 74.9568534835135, 75.8288672903988, 76.5555454628032, 77.1732219093469, 77.5002270869289, 78.6629121627759, 80.1162685075847, 81.3516214006722, 82.3326369334181, 83.5316559178854, 84.8033427195931, 85.5663548006177, 87.0197111454265, 88.4003996729948, 89.5630847488419, 90.9437732764102, 91.7067853574348, 93.5961486056863, 95.4855118539377, 96.7208647470252, 96.9388681987465, 97.52021073667, 99.7729130711236, 101.117267690072, 101.589608502135, 103.914978653829, 106.276682714143, 107.584703424471, 108.602052865837, 110.636751748569, 111.799436824416, 112.526114996821, 113.507130529567, 114.996820782996, 116.631846670906, 118.048869107094, 118.99355073122, 119.792896720865, 121.791261694977, 122.953946770824, 123.462621491507, 124.988645653556, 124.661640475974, 126.696339358707 ), .Dim = c(83L, 4L), .Dimnames = list(NULL, c("GDP_NAM", "CPI_NAM", "GDP_SA", "CPI_SA")), index = structure(c(954460800, 962323200, 970272000, 978220800, 985996800, 993859200, 1001808000, 1009756800, 1017532800, 1025395200, 1033344000, 1041292800, 1049068800, 1056931200, 1064880000, 1072828800, 1080691200, 1088553600, 1096502400, 1104451200, 1112227200, 1120089600, 1128038400, 1135987200, 1143763200, 1151625600, 1159574400, 1167523200, 1175299200, 1183161600, 1191110400, 1199059200, 1206921600, 1214784000, 1222732800, 1230681600, 1238457600, 1246320000, 1254268800, 1262217600, 1269993600, 1277856000, 1285804800, 1293753600, 1301529600, 1309392000, 1317340800, 1325289600, 1333152000, 1341014400, 1348963200, 1356912000, 1364688000, 1372550400, 1380499200, 1388448000, 1396224000, 1404086400, 1412035200, 1419984000, 1427760000, 1435622400, 1443571200, 1451520000, 1459382400, 1467244800, 1475193600, 1483142400, 1490918400, 1498780800, 1506729600, 1514678400, 1522454400, 1530316800, 1538265600, 1546214400, 1553990400, 1561852800, 1569801600, 1577750400, 1585612800, 1593475200, 1601424000), tzone = "UTC", tclass = "Date"), class = c("xts", "zoo")) I have plotted all of my variables using the code below to try and spot patterns in the data. It looks like each series has a deterministic trend in it, so I'm looking for a solution where I can de-trend each series within my dataset (preferably using dplyr ) library(tidyverse) library(tbl2xts) dataset %>% xts_tbl() %>% gather(Key, Value, -date) %>% ggplot(aes(date,Value, col = Key)) + geom_line(size = 1) + facet_wrap(~Key, scales = 'free')
