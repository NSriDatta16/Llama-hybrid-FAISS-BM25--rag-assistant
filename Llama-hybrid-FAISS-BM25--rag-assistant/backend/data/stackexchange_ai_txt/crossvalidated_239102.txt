[site]: crossvalidated
[post_id]: 239102
[parent_id]: 237503
[tags]: 
In their 1980 paper Hosmer D.W., S. Lemeshow, ''Goodness of fit tests for the multiple logistic regression model'', Communications in Statistics - Theory and Methods, Volume 9, 1980 - Issue 10 , the authors have proven that the test statistic (for a partition with $g$ groups) is $\chi^2(g-p-1) + \sum_{i=1}^p \lambda_i \chi^2(1)$. In a second step they showed, using simulations that the term $\sum_{i=1}^p \lambda_i \chi^2(1)$ is a approximately $\chi^2(p-1)$ and as the sum of (independent) $\chi^2$ is also $\chi^2$ with degrees of freedom equal to the sum of the individual degrees of freedom they found that (1) their test statistic is exactly $\chi^2(g-p-1) + \sum_{i=1}^p \lambda_i \chi^2(1)$ and (2) their test statistic is approximately $\chi^2(g-2)$ Simulations under the Hosmer-Lemeshow conditions As they have shown this formally, any simulation that is executed under their necessary conditions should find (approximately) a $\chi^2(8)$ when $g=10$. This is the case for the simulations below (in order to keep the answer ''readable'', I inserted the ''helper'' functions at the botttom of this answer, these have to be executed first). The code contains comments to point to the major steps in the simulation. It is mainly a loop that is executed $N$ times, in each loop one has: Draw a training sample Estimate the logistic model Predict the probabilities using the estimated coefficients Compute the HL X2 The helper functions are defined at the end of my answer. simulateHosmerLemeshowX2 One can execute this simulation, you will find a graph like the one below: The bars represent the simulated test statistic of Hosmer-Lemeshow, the smooth curve is a simulated $\chi^2(8)$. It seems to conform the findings of HL. Note that the mean of the test statistic is close to 8 and that the mean of a chi-square is the number of degrees of freedom. Simulations for ''out-of-sample'' validation In this section I simulate the out-of-sample situation. The code and one result are below. The code contains comments to point to the major steps in the simulation. It is mainly a loop that is executed $N$ times, in each loop one has: Draw a sample Split it into a training and a validation sample Estimate the logistic model on the training sample Predict the probabilities using the estimated coefficients on the validation sample Compute the HL X2 on the validation sample The helper functions are defined at the end of my answer. The graphs shows that the test statistic, compute on the validation sample, is not $\chi^2(8)$, the mean seems to indicate that one might conclde that it is $\chi^2$ with 13 df, but, as indicated in the graph, then the variance is not compatible with a chi-square ? simulateHosmerLemeshowOutOfSampleX2B Annex: code for the helper functions. library(ResourceSelection) library(ggplot2) generateSample
