[site]: crossvalidated
[post_id]: 416867
[parent_id]: 416866
[tags]: 
A neural net with one hidden layer is $$ y = g(a(X\Gamma_1)\Gamma_2) $$ where $g()$ is your output activation and $a()$ is your relu or whatever. So you have a cluster variable $c$ that you can turn into a matrix of dummies $C$ . Is cluster membership predictive of $y$ ? (Go run a logistic regression right now if you don't know the answer. You should have done this first.) Just modify your neural net: $$ y = g(C\beta + a(X\Gamma_1)\Gamma_2) $$ If you think that there are nonlinear interactions between the clusters and $X$ you can do $$ y = g(C\beta + a([C,X]\Gamma_1)\Gamma_2) $$ Heck, if you think there are linear interactions between the network output and C you could do $$ y = g(C\beta + a(X\Gamma_1)\Gamma_2 + (C\times a(X\Gamma_1))\Gamma_3) $$ All of this is easy-enough to implement in Keras using the functional API. You need multiple inputs if you want parametric structure.
