[site]: stackoverflow
[post_id]: 4151191
[parent_id]: 
[tags]: 
Table Pivot with AVG inside MAX(DECODE())

Hey guys I need help with the SQL below. It keeps giving me a single output for all of my a.names: SELECT Drink.name, MAX(DECODE(Size.type, 'Small', avg, NULL)) Small, MAX(DECODE(Size.type, 'Medium', avg, NULL)) Medium, MAX(DECODE(Size.type, 'Large', avg, NULL)) Large FROM Drink, Size ( SELECT avg(Size.price) avg, Size.type, Drink.name FROM Drink, Size GROUP BY Size.type, Drink.name ) GROUP BY Drink.name ORDER BY Drink.name; OUTPUT: For example, I'll use drink brand name with a type of small, medium, large. I want the average of all the drinks in the stores across town. Without using pivot Drink | Size | Price Dr. Pepper | Small | 1.00 Dr. Pepper | Medium | 1.50 Dr. Pepper | Large | 2.00 Using pivot (the output I want): Drink | Small | Medium | Large Dr. Pepper | 1.00 | 1.50 | 2.00 Mountain Dew | 0.50 | 0.75 | 1.25 The output I'm getting: Drink | Small | Medium | Large Dr. Pepper | 1.00 | 1.00 | 1.00 Mountain Dew | 1.00 | 1.00 | 1.00
