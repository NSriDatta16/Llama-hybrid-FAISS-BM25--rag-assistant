[site]: stackoverflow
[post_id]: 1535239
[parent_id]: 
[tags]: 
Validate email address form submit

I've got a simple form that enables users to enter a promotional code and email address to be signed up to an email as follows. But at present it doesn't validate the email correctly. There is an include file doreferral.asp that; Checks to see if the code they entered exists in a table of promotional codes and also Checks to see if the email address already exists. I have added emailValidate to check to see if the email address is valid and if not, and then tell the user in the . However, it's currently stopping genuine emails so the validation isn't working. :S My doreferral.asp looks like this; The agent code does not exist. " End If ''//Check to see if the email address is valid Dim emailValidate emailValidate = 0 'Initializing goby to 0 ''//if the len is less than 5 then it can't be an email ''//(i.e.: a@a.c) If Len(session("Email")) 0 then sys_message = sys_message & " The email address is not valid. " End If ''//Check the submitted email against existing ones in the database set conn = server.CreateObject("ADODB.connection") conn.open(application("DATABASE")) qs = "SELECT COUNT(ReferredEmail) AS 'Count' FROM TenantReferral WHERE ReferredEmail = '" & Email & "'" set rs = conn.Execute(qs) countEmail = rs("Count") set rs = nothing conn.close set conn = nothing If(countEmail >= 1) Then sys_message = sys_message & " This email address has already been referred. " End If ''//Only Process the SQL if there is no sys_message If(sys_message = "") Then SQLfields = SQLfields & "ReferredCode, " SQLvalues = SQLvalues & "'"& Trim(Code) &"', " SQLfields = SQLfields & "ReferredEmail" SQLvalues = SQLvalues & "'"& Trim(Email) &"'" SQL = SQL & "INSERT into TenantReferral ("& SQLfields &") VALUES ("& SQLvalues &")" 'response.Write(SQL) set conn = server.CreateObject("ADODB.connection") conn.open application("DATABASE") SET rs = conn.execute(SQL) [Send email code] sys_message = sys_message & " Thank you for your referral. " submission = "ok" 'response.Redirect("referral.asp") End If %> I wondered if anyone might be able to help debug the emailValidate functionality to check if the email address is valid? Thank you.
