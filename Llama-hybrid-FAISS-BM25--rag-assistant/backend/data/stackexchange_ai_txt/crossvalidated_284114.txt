[site]: crossvalidated
[post_id]: 284114
[parent_id]: 
[tags]: 
How can I robustly smooth my time series data?

I have data like the following image, where the x-axis is the absolute elapsed time in hours (think calendar days; this plot goes over ~2.5 years), and the y-axis is the manually entered uptime of a machine in hours. For my data processing, I need a very robust way of smoothing the data. The image below shows a black, dashed line, which is the best I can get with a "normal" GAM. I am thinking of a GAM that minimizes the median residual or something. My ideal goal is to obtain something close to the manually drawn red line. I have tried many smoothers (cubic polynomial, loess, GAM, Theil-Sen linear regression), but every one fails in some special cases of the hundreds of graphs I have. What are other robust smoothers that I could apply here? Or are there other techniques I have completely missed so far?
