[site]: stackoverflow
[post_id]: 4439326
[parent_id]: 
[tags]: 
Position of All Matching Elements in List

I'm trying to write a function in Common Lisp similar to the built in position function, that returns a list of the positions of all elements in the haystack that match the needle, as opposed to just the first. I've come up with a few possible solutions (for example recursively searching for the next element using a cdr-from function on the position and adding the result to the previous position) but none of the approaches I've come up with so far seem particularly elegant. Can anyone suggest what would be the best way of approaching this, as I'm currently struggling.
