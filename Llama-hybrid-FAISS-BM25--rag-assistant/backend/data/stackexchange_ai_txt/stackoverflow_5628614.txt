[site]: stackoverflow
[post_id]: 5628614
[parent_id]: 
[tags]: 
KeyboardHookProc in DLL doesn't do anything when called from python

I've been trying to write a DLL in C. Install hook sets up the KeyboardProc. Calling the InstallHook() and UninstallHook() functions from Python always returns a 0, which I guess is because my callback function KeyboardProc isn't working. The following is my C code for the DLL: #include "stdafx.h" #include #include #include #include #include "ourdll.h" //#pragma comment(linker, "/SECTION:.SHARED,RWS") //#pragma data_seg(".SHARED") HHOOK hKeyboardHook = 0; int keypresses = 0; HMODULE hInstance = 0; //#pragma data_seg() BOOL WINAPI DllMain (HANDLE hModule, DWORD dwFunction, LPVOID lpNot) { hInstance = hModule; //Edit return TRUE; } LRESULT CALLBACK KeyboardProc(int hookCode, WPARAM vKeyCode, LPARAM flags) { if(hookCode The Python code to use this is as follows: >>> from ctypes import * >>> dll = CDLL('C:\...\OurDLL.dll') >>> dll.InstallHook() [Type something at this point] >>> result = dll.UninstallHook() >>> result 0 EDIT: I should probably mention that I've also tried out a LowLevelKeyboardHook . I understand that the LowLevel hook is global and will catch all keystrokes, but that just caused my dll.InstallHook() Python code to freeze for a second or two before returning zero. I am no expert in C, so any help would be greatly appreciated. Thanks.
