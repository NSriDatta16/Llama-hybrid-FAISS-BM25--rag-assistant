[site]: stackoverflow
[post_id]: 5182822
[parent_id]: 
[tags]: 
Run wordpress code from command prompt via PHP

I need to run custom WP script from command line : php myscript.php Whatever I do it doesn't work. I get this message: Error establishing a database connection I tried define('DOING_AJAX', true); define('WP_USE_THEMES', false); $_SERVER = array( "HTTP_HOST" => "mysite.com", "SERVER_NAME" => "mysite.com", "REQUEST_URI" => "/myscript.php", "REQUEST_METHOD" => "GET" ); require_once('wp-load.php'); mentioned here but it doesn't work. All server variables set by me are OK, I copied the whole $_SERVER variable from web page launched in browser (there it works) My working directory is the root of the WP install so I simply use: php myscript.php from command line. I tried several other codes mentioned on net but non of them works for me. e.g the one with : define('WP_USE_THEMES', false); require('wp-blog-header.php'); Always the same message: Error establishing a database connection As I said from web browser it works OK. This is the extraction of mysql strings from php.ini used by php cli: Configure Command => '/var/tmp/apache_mod_php/apache_mod_php-53.3.1~2/php/configure' '--prefix=/usr' '--mandir=/usr/share/man' '--infodir=/usr/share/info' '--disable-dependency-tracking' '--sysconfdir=/private/etc' '--with-apxs2=/usr/sbin/apxs' '--enable-cli' '--with-config-file-path=/etc' '--with-libxml-dir=/usr' '--with-openssl=/usr' '--with-kerberos=/usr' '--with-zlib=/usr' '--enable-bcmath' '--with-bz2=/usr' '--enable-calendar' '--with-curl=/usr' '--enable-exif' '--enable-ftp' '--with-gd' '--with-jpeg-dir=/BinaryCache/apache_mod_php/apache_mod_php-53.3.1~2/Root/usr/local' '--with-png-dir=/BinaryCache/apache_mod_php/apache_mod_php-53.3.1~2/Root/usr/local' '--enable-gd-native-ttf' '--with-ldap=/usr' '--with-ldap-sasl=/usr' '--enable-mbstring' '--enable-mbregex' '--with-mysql=mysqlnd' '--with-mysqli=mysqlnd' '--with-pdo-mysql=mysqlnd' '--with-mysql-sock=/var/mysql/mysql.sock' '--with-iodbc=/usr' '--enable-shmop' '--with-snmp=/usr' '--enable-soap' '--enable-sockets' '--enable-sysvmsg' '--enable-sysvsem' '--enable-sysvshm' '--with-xmlrpc' '--with-iconv-dir=/usr' '--with-xsl=/usr' '--enable-zend-multibyte' '--enable-zip' '--with-pcre-regex=/usr' mysql Client API version => mysqlnd 5.0.7-dev - 091210 - $Revision: 300533 $ mysql.allow_local_infile => On => On mysql.allow_persistent => On => On mysql.connect_timeout => 60 => 60 mysql.default_host => no value => no value mysql.default_password => no value => no value mysql.default_port => no value => no value mysql.default_socket => /var/mysql/mysql.sock => /var/mysql/mysql.sock mysql.default_user => no value => no value mysql.max_links => Unlimited => Unlimited mysql.max_persistent => Unlimited => Unlimited mysql.trace_mode => Off => Off mysqli Client API library version => mysqlnd 5.0.7-dev - 091210 - $Revision: 300533 $ mysqli.allow_local_infile => On => On mysqli.allow_persistent => On => On mysqli.default_host => no value => no value mysqli.default_port => 3306 => 3306 mysqli.default_pw => no value => no value mysqli.default_socket => /var/mysql/mysql.sock => /var/mysql/mysql.sock mysqli.default_user => no value => no value mysqli.max_links => Unlimited => Unlimited mysqli.max_persistent => Unlimited => Unlimited mysqli.reconnect => Off => Off mysqlnd mysqlnd => enabled Version => mysqlnd 5.0.7-dev - 091210 - $Revision: 300533 $ PDO drivers => mysql, sqlite, sqlite2 pdo_mysql Client API version => mysqlnd 5.0.7-dev - 091210 - $Revision: 300533 $ pdo_mysql.default_socket => /var/mysql/mysql.sock => /var/mysql/mysql.sock
