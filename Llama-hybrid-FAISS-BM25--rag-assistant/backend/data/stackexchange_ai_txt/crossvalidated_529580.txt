[site]: crossvalidated
[post_id]: 529580
[parent_id]: 
[tags]: 
Formula for Bayesian Improved Surname Geocoding algorithm incorrect?

The following formula for Bayesian Improved Surname Geocoding (BISG) is described in the literature for calculating the expected probability of an individual's race based on their surname and geographic location: $$P(R_i=r|G_i=g,S_i=s)=\frac{P(R_i=r|S_i=s)P(G_i=g|R_i=r)}{\sum_{i=1}^{n}P(R_i=r|S_i=s)P(G_i=g|R_i=r)}$$ Is this correct? Based on my understanding of Bayes theorem and the chain rule, the formula ought to be (simplifying notation): $$P(R|G,S)=\frac{P(G,S)P(R)}{P(G,S)}=\frac{P(G|S)P(S)P(R)}{P(G|S)P(S)}=\frac{P(G|S)P(S)P(R)}{P(G|S)P(S)}=\frac{P(G|S)P(R)}{P(G|S)}$$
