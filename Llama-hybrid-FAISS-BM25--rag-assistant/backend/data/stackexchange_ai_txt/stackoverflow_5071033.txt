[site]: stackoverflow
[post_id]: 5071033
[parent_id]: 
[tags]: 
WinForms TabControl drag drop problem

I have two TabControls and I've implemented the ability to drag and drop tabpages between the two controls. It works great until you drag the last tabpage off one of the controls. The control then stops accepting drops and I can't put any tabpages back on that control. The drag and drop code for one direction is below. The reverse direction is the same with the control names swapped. // Source TabControl private void tabControl1_MouseMove(object sender, MouseEventArgs e) { if (e.Button == MouseButtons.Left) this.tabControl1.DoDragDrop(this.tabControl1.SelectedTab, DragDropEffects.All); } //Target TabControl private void tabControl2_DragEnter(object sender, System.Windows.Forms.DragEventArgs e) { if (e.Data.GetDataPresent(typeof(TabPage))) e.Effect = DragDropEffects.Move; else e.Effect = DragDropEffects.None; } private void tabControl2_DragDrop(object sender, System.Windows.Forms.DragEventArgs e) { TabPage DropTab = (TabPage)(e.Data.GetData(typeof(TabPage))); if (tabControl2.SelectedTab != DropTab) this.tabControl2.TabPages.Add (DropTab); }
