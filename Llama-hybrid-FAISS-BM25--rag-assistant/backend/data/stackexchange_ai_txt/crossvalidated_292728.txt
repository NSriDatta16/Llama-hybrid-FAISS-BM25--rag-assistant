[site]: crossvalidated
[post_id]: 292728
[parent_id]: 
[tags]: 
How to handle identical ranks when performing quantile normalization?

I have been looking at Wikipedia Wikipedia to understand quantile normalization algorithms and I have noticed, on their example, a difference between their results and the ones given by bioconductor 's package preprocessCore . In fact, when two values have the same rank, Wikipedia take the lowest index in the reference distribution, while preprocessCore seem to take a sort of average. However, when used on big matrices, I have noticed that it is not the average of all the values of the reference distribution occupied by this "rank range" (of equal ranks). How is this adressed? Why would one method be better than the other? I understand that for small matrice, it has a huge impact on the variance of the samples, but for big matrice, the distribution should be much smoother and result in less discrepancy, right?
