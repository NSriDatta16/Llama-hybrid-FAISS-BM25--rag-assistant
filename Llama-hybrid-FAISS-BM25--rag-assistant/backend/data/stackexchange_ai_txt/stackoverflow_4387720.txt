[site]: stackoverflow
[post_id]: 4387720
[parent_id]: 
[tags]: 
Magento shopping cart pricing rules not applying correctly

I have been having a problem with shopping cart price rules that aren't being applied correctly in the cart. The problem occurs when there are multiple discounts. Here is a specific example: Discount A: Product: 3 Book Set Price: $20 each book Discount: $10 (when you buy all 3) Discount B: Product: Suit (jacket and pants) Price: $500 each piece Discount: $50 (when you buy both) Here is the situation: When the suit is listed first and the books second, all discounts are taken ($50 + $10 = $60). However, when the books are first, only the suit discount is taken ($50). Using firebug/firephp I have been able to see that for the first case, the discount is less than the price of the first product and all the discounts can be taken off that product. In the second case, the discount is more than the price of the first product. When this happens, the $50 discount is spread across the 3 books. It takes $20 off the first book, $20 off the second, $10 off the third; but then the $10 discount for the books is not processed. I need to know where to look next. What models/methods are involved in processing shopping cart price rules? How do I go about tracing the code so I can find out where the error happens?
