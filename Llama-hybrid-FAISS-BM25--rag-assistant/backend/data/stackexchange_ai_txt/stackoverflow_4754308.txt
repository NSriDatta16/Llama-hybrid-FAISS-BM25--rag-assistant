[site]: stackoverflow
[post_id]: 4754308
[parent_id]: 4269533
[tags]: 
Disclaimer: I can't clearly understand your 4. paragraph. As far as I can tell, the main problem with authentication in NHPM is that the PHP application gets absolutely zero notification of incoming connections. The Comet part of your setup is write-only for PHP. A possible solution follows, I'll be trying this out in the next days. nginx configuration: push_subscriber_concurrency first: so that the channel can only be used by the intended user push_authorized_channels_only on: not strictly necessary, but good to have in my opinion Authorization workflow: Client sends credentials via old-fashioned requests Server authenticates, and generates a token (channel id). Creates the channel and responds with the token. Client tries to open long-poll to the given channel. If it fails (possibly because the channel was hijacked), it tells the server that channel so-and-so is invalid. Mind that we use old-fashioned requests here, so you can use any auth method. Server deletes the channel. Back to step two. If the connection is successful (you probably won't know this, only that it hasn't failed), the channel can be considered authenticated. Note that if your application should be accessible from multiple pages in the same browser with the same login, then you'll need to prepare for multiple channels per user.
