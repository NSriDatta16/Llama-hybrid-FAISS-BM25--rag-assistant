[site]: stackoverflow
[post_id]: 5290078
[parent_id]: 5289925
[tags]: 
Well, from someone who has spent half my time trying to prevent session hijacks, I can tell you that is a wrong way to go about it. Yes, in theory you will have guaranteed the user is the same, but then in practice you will get expected 'unexpected' results. Certain ISP change the IP with every page load. Proxies like tor do that as well. Your best bet is simply to use the user agent. Though that has drawbacks, you can't have a fully secure system. Just ensure that you prevent xss on your site and most likely, the user can't be faked too easily. I had other implementations. The first involved taking the first part of the IP and hashing it with the ua to ensure that the IP is always in the same range, but then I found out that the country ranges vary. Another involved a country lookup to ensure that the IP is from the same country, but then again that involved an extra database lookup. The best you can do is make it harder, but it will never be secure. Almost forgot. Remember to regenerate the session I'd whenever you increase a user's priveleges such as in a login. This will help prevent session fixation attacks where the session id is passed via url. Remember your xss.
