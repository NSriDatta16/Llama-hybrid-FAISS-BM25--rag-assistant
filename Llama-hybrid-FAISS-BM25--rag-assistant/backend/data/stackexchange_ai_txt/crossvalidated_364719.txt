[site]: crossvalidated
[post_id]: 364719
[parent_id]: 
[tags]: 
propensity score matching with difference-in-differences for panel data

Research design utilizes companies that switched auditors ( TREATMENT ) and propensity score matched ( PSM ) companies that did not change their auditor ( CONTROL ). To obtain the propensity score for each company, I want to use a Probit model where the dependent variable, AUDITOR_SWITCH_PSM , is an indicator variable defined as 1 for the switch company in a given year, and 0 otherwise: $$AUDITOR-SWITCH-PSM(1\;or\;0)_i= \delta_0 + \delta_1GCO -PSM_i + \delta_2RESTATEMENT -PSM_i + \delta_3BIG 4- PSM_i+ \delta_4LNASSET- PSM_i + \delta_5LEVERAGE -PSM_i + \delta_6LOSS -PSM_i + e_i$$ Then, I want to utilize a difference-in-differences ( DID ) research design that compares differences in loan spreads between the treatment ( switch ) companies and control ( non-switch ) companies before and after the auditor change so, using the above matched sample of treatment and control companies, the main model takes the following form: $$LNSPREAD_{ijt} =\beta_0 + \beta_1TREATMENT_j + \beta_2POST-SWITCH_{it} + \beta_3TREATMENT_j * POST-SWITCH_{it} + \beta_4X_{ijt}+ e_{ijt}$$ I read this post and this one but I couldn't understand how to do PSM with DID for panel data. Could you please let me know how to do it in Stata? It should be noted that my data set is in balanced panel data format with id represents companies and time shows years. Thanks in advance.
