[site]: crossvalidated
[post_id]: 492956
[parent_id]: 
[tags]: 
Coherence using FFT: how to calculate coherence for one frame

I want to calculate coherence between two time series that are of equal lengths. Since coherence is given by Pxy/(sqrt(Pxx)*sqrt(Pyy)) , I did the following steps. Step 1: Divide both time series (say, A and B) into multiple blocks (block length =2048) Step 2: Multiply each block with blackmann window and calculate FFT. Repeat this for both time series Step 3: For each block, calculate cross spectral density Pxy by fft(A) * conjugate(fft(B)) Step 4: For each block, calculate Coherence with the above formula. I have 2 problems when implementing the above algorithm coherence comes out as 1 for all frequencies. How to get a coherence spectrogram, where I can compare the coherence of each frequency at different points of time ? The imaginary part of Pxy is always 0. I am not even sure if this is an error or not.
