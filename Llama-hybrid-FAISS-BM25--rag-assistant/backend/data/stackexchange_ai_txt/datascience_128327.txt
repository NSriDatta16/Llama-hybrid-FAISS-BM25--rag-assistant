[site]: datascience
[post_id]: 128327
[parent_id]: 
[tags]: 
How can I change my input shape in the architecture for the cnn(transfer learning)?

I have already made a model and trained it, and then saved the model along with its weights. The input shape in that model is [900,300,1] which is [height,width,channel]. I want to use the same model and changed the top base which are the dense layers but unable to change the input shape for the first Conv2D layer. The new input shape is [800,300,1]. Do I need to define the input layer separately so that I can change it? I have defined the input shape for the first conv2D layer as follows: keras.layers.Conv2D(filters=32, kernel_size=3, activation=keras.layers.LeakyReLU(alpha=0.01), kernel_initializer='he_uniform', padding = 'same', input_shape=img_shape, name='conv_01'), and i am trying this code model = keras.models.load_model('W:/MASTER_BAGCHI_SCHALDACH/THESIS/code and dataset/models/12_class_cropped_original_300_900.h5') from keras.layers import Conv2D from keras.models import Model # New input shape new_input_shape = (800, 300, 1) # Replace new_height, new_width, and new_channels with your desired values # Create a new Conv2D layer with the desired input shape new_conv_01 = Conv2D(filters=32, kernel_size=3, activation='relu', kernel_initializer='he_uniform', padding='same', input_shape=new_input_shape, name='conv_01') # Replace the first Conv2D layer in the model's layers list model.layers[1] = new_conv_01 # Remove the first layer (input layer) from the model model = Model(inputs=model.layers[1].input, outputs=model.layers[-1].output) # Print the summary of the modified model model.summary() Model: "model_18" _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= input_7 (InputLayer) [(None, 900, 300, 32)] 0 batch_normalization_10 (Ba (None, 900, 300, 32) 128 tchNormalization) pool_01 (AveragePooling2D) (None, 450, 150, 32) 0 conv_02 (Conv2D) (None, 450, 150, 64) 18496 batch_normalization_11 (Ba (None, 450, 150, 64) 256 tchNormalization) pool_02 (AveragePooling2D) (None, 225, 75, 64) 0 conv_03 (Conv2D) (None, 225, 75, 128) 73856 batch_normalization_12 (Ba (None, 225, 75, 128) 512 tchNormalization) pool_03 (AveragePooling2D) (None, 112, 37, 128) 0 flatten_01 (Flatten) (None, 530432) 0 dropout_01 (Dropout) (None, 530432) 0 dense-03 (Dense) (None, 128) 67895424 batch_normalization_13 (Ba (None, 128) 512 tchNormalization) dropout_04 (Dropout) (None, 128) 0 dense-01 (Dense) (None, 64) 8256 batch_normalization_14 (Ba (None, 64) 256 tchNormalization) dropout_02 (Dropout) (None, 64) 0 fc_layer (Dense) (None, 12) 780 ================================================================= Total params: 67998476 (259.39 MB) Trainable params: 67997644 (259.39 MB) Non-trainable params: 832 (3.25 KB) _________________________________________________________________ Could someone please help? If there is any missing information then please let me know. Thanks in advance.
