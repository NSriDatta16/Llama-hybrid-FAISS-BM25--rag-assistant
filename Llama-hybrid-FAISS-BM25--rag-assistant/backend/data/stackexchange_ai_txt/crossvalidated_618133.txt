[site]: crossvalidated
[post_id]: 618133
[parent_id]: 618095
[tags]: 
There are 10 plausibles values for mathematics ("PV1MATH"... "PV10MATH"), not 5. Additionally, Andalusia is divided in four different strata in PISA. This is the case for all regions of Spain. If you missed that, this is probably why you get different results from the PISA report tool (which is hopefully correct - a few paragraphs below you'll find some R code to get the same result as them). There's a PISA codebook (xlsx file) allowing you to check there are 10 plausible values for mathematics, and that strata in Spain are not based only on the region. Check the spreasheet " CY07_MSU_SCH_QQQ ", and search for "Plausible Value 1 in Mathematics", "Plausible Value 10 in Mathematics", "Andalusia", etc. It's generally a good idea to check thoroughly the documentation of complex data, even if it's unfortunately often a bore -and in this specific case, not very reader-friendly. Here is a reproductible example in R to get the same result than the PISA report tool for Andalusia, using the 2018 student data file available for download here : library("haven") data $avg.math = rowMeans(andalusia[,vmath], na.rm=TRUE) #calculating the weighted mean weighted.mean(andalusia$ avg.math, andalusia$W_FSTUWT) >>> 467.4082
