[site]: stackoverflow
[post_id]: 5486135
[parent_id]: 
[tags]: 
How do I add/insert an xsl:param into an xsl stylesheet before transform?

Given the following code (and not using jQuery) what would be a good way to dynamically insert an tag into the xsl before transformation? I would like someone to "fix" function addParam function addParam(xsl,name,value) { /** input: ..... output: ..... */ var parameter = document.createElement("xsl:param"); parameter.setAttribute("name",name); parameter.setAttribute("value",value); xsl.documentElement.insertBefore(parameter,xsl.documentElement.firstsChild) } function displayResult(pXml) { var xsl = loadXMLDoc("cdcatalog.xsl"); // code for IE if (window.ActiveXObject) { /* I want to call it here >>> */ addParam(xsl,"parm1","parameter value1"); var ex = pXml.transformNode(xsl); document.getElementById("availableSearchItems").innerHTML = ex; } // code for Mozilla, Firefox, Opera, Chrome, etc. else if (document.implementation && document.implementation.createDocument) { xsltProcessor = new XSLTProcessor(); xsltProcessor.importStylesheet(xsl); /* I want to call it here */ addParam(xsl,"parm1","parameter value1"); resultDocument = xsltProcessor.transformToFragment(pXml, document); document.getElementById('availableSearchItems').innerHTML = ""; document.getElementById("availableSearchItems").appendChild(resultDocument); } } I have read how to pass a parameter from an URL to a XSL stylesheet using jQuery? and understand that Firefox can do setParameter and IE can do var strParam = "//xsl:param[@name='" + p + "']"; var xslParam = xObj.selectSingleNode(strParam); xslParam.setAttribute("select",op[p]); but that is assuming the xsl has a parameter already. Pointers and corrections very welcome. Thanks
