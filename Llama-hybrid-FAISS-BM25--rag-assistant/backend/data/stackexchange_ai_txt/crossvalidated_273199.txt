[site]: crossvalidated
[post_id]: 273199
[parent_id]: 
[tags]: 
Mann-Whitney U test for two samples, both having groups within (between group variability)

I have two distributions $X$ and $Y$ with $n_Y>n_X$ that I want to test if they are different. But within each sample, I have subgroups that have an effect on the variable in question. As an example, consider the screenshot below, where I have pairs within each sample, and these pairs interact with the variables in question. So when I run the Wilcox (Mann-Whitney) test (for instance in R with wilcox.test(x, y)), how can I (or should I) take into account the between-pair variability? I could take the pair averages and then compare. Is that a good way?
