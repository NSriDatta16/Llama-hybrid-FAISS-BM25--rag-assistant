[site]: stackoverflow
[post_id]: 2913460
[parent_id]: 2911030
[tags]: 
Here's the code that creates that filename path, found in Mage_Catalog_Model_Product_Image : // build new filename (most important params) $path = array( Mage::getSingleton('catalog/product_media_config')->getBaseMediaPath(), 'cache', Mage::app()->getStore()->getId(), $path[] = $this->getDestinationSubdir() ); if((!empty($this->_width)) || (!empty($this->_height))) $path[] = "{$this->_width}x{$this->_height}"; // add misk params as a hash $miscParams = array( ($this->_keepAspectRatio ? '' : 'non') . 'proportional', ($this->_keepFrame ? '' : 'no') . 'frame', ($this->_keepTransparency ? '' : 'no') . 'transparency', ($this->_constrainOnly ? 'do' : 'not') . 'constrainonly', $this->_rgbToString($this->_backgroundColor), 'angle' . $this->_angle, 'quality' . $this->_quality ); // if has watermark add watermark params to hash if ($this->getWatermarkFile()) { $miscParams[] = $this->getWatermarkFile(); $miscParams[] = $this->getWatermarkImageOpacity(); $miscParams[] = $this->getWatermarkPosition(); $miscParams[] = $this->getWatermarkWidth(); $miscParams[] = $this->getWatermarkHeigth(); } $path[] = md5(implode('_', $miscParams)); // append prepared filename $this->_newFile = implode('/', $path) . $file; // the $file contains heading slash So, the hash is generated from the configuration info (aspect ratio, etc), as well as the watermark info. This information will not usually change. However, I do see that the path is partially generated from the store_id of the current store, so your trouble may be there. Is there a reason you can't let Magento use its normal caching procedures for both stores? Since Magento checks the filesystem for the cached image, there shouldn't be a conflict. Hope that helps! Thanks, Joe Upon contemplation, are you just trying to get the catalog images to work in both domains? The non-cached version of the catalog images are at %magento%/media/catalog/product . Copy the directories from that location and your catalog images should work.
