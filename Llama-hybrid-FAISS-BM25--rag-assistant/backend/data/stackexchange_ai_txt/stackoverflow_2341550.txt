[site]: stackoverflow
[post_id]: 2341550
[parent_id]: 2341374
[tags]: 
You could create a table-valued function to split the namelist into many rows: if object_id('dbo.fnSplitNamelist') is not null drop function dbo.fnSplitNamelist go create function dbo.fnSplitNamelist( @namelist varchar(max)) returns @names table ( name varchar(50)) as begin declare @start int declare @end int set @start = 0 while IsNull(@end,0) <> len(@namelist) + 1 begin set @end = charindex(',', @namelist, @start) if @end = 0 set @end = len(@namelist) + 1 insert into @names select ltrim(rtrim( substring(@namelist,@start,@end-@start))) set @start = @end + 1 end return end go You can use a cross apply to return the names for each namelist. Then you can use group by to sum the time per user: declare @YourTable table (namelist varchar(1000), time int) insert into @YourTable select 'John Smith, Jeremy Boyle, Robert Brits, George Aldrich', 5 union all select 'John Smith, Peter Hanson', 15 union all select 'Jeremy Boyle, Robert Brits', 10 select fn.name, sum(t.time) from @YourTable t cross apply fnSplitNamelist(t.namelist) fn group by fn.name This results in: George Aldrich 5 Jeremy Boyle 15 John Smith 20 Peter Hanson 15 Robert Brits 15
