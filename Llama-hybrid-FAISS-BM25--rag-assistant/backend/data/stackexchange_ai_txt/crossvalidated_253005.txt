[site]: crossvalidated
[post_id]: 253005
[parent_id]: 
[tags]: 
Get MLE estimates for general gravity model

I am doing homework for analysis of Network Flow Data, and as class is organised in self-study way ( we have only book as reference (Eric D. Kolaczyk Statistical Analysis of Network Data) ) I am stuck with solving the problem and have nobody to ask. We have the following log-likelihood: $$ l(\mu) = l(\alpha, \beta, \theta) = \sum_{ij } z_{ij} ( \alpha_i + \beta_j + \theta^T c_{ij} ) - \exp\{\alpha_i + \beta_j + \theta^T c_{ij}\} $$ where $$\mu_{ij} = \exp\{\alpha_i+\beta_j+\theta^Tc_{ij}\}$$ and we want to get MLE estimates of $\alpha, \beta, \theta$ of the form: $$ \hat{\mu}_{i+} = z_{i+} , \quad \hat{\mu}_{+j} = z_{+j} $$ and $$ \sum_{i,j}c_{ij:k}\hat{\mu}_{ij} = \sum_{i,j}c_{ij:k}z_{ij} $$ where $$\hat{\mu}_{i+} = \sum_{j}\mu_{ij},\quad \hat{\mu}_{+j} = \sum_{i}\mu_{ij}$$ So what I did.Let us take partial derivatives with respect to the elements. \begin{align*} 0 &= \frac{\partial l }{\partial \alpha_i} = \sum_{j} z_{ij} - \exp\{\alpha_i + \beta_j + \theta^T c_{ij}\} \\ 0 &= \frac{\partial l }{\partial \beta_j} = \sum_{i} z_{ij} - \exp\{\alpha_i + \beta_j + \theta^T c_{ij}\} \\ 0 &= \frac{\partial l }{\partial \theta_k} = \sum_{ij} z_{ij} !?!?! - c_{ij} \exp\{\alpha_i + \beta_j + \theta^T c_{ij}\}\\ \end{align*} from here relabeling by rule $x_{i+} = \sum_{j} x_{ij}$ and $x_{+j} = \sum_{i} x_{ij}$ I have obtained the following. I have several ideas on how to find those parameters. \begin{align*} \text{first idea for parameter: } \hat{\alpha}_i &= \frac{ \log ( \sum_j \beta_j + \theta^T_{i?k?} c_{ij})}{ \log ( z_{i+} ) }\\ \text{second idea for parameter: } \hat{\beta}_j &= \alpha_i + \theta^T c_{ij} - \log ( z_{ij} ) \\ \text{first idea for parameter: } \hat{\theta}_k &= \frac{1}{\sum_{ij} c_{ij;k} z_{ij}} \left( \alpha_i + \beta_j \right) \\ \end{align*} But I have no clue how to get to the result in a grey box.
