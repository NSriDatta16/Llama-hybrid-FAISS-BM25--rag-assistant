[site]: stackoverflow
[post_id]: 5516566
[parent_id]: 
[tags]: 
Visual Basic 2010 / .NET | Fast POST Request to Web

I am writing a program that must communicate with a PHP / web based backend through API style calls (POST requests). The code that I have currently is very slow - each request takes 2-3 seconds - is there a faster method or something that I can use to speed up this current method of requests: Function PostData(ByRef Data() As PostData, ByVal URL As String) Dim Requester As HttpWebRequest = HttpWebRequest.Create(URL) Requester.Method = "post" 'Requester.Proxy = New System.Net.WebProxy("localhost", 1234) 'Requester. Dim ASCIIEncoding As Encoding = New ASCIIEncoding Dim DataString As String = "apirequest=true" For Each DataItem As PostData In Data DataString = DataString & "&" & DataItem.Key & "=" & DataItem.Value Next DataString = Right(DataString, Len(DataString) - 1) Dim RawData() As Byte = ASCIIEncoding.GetBytes(DataString) Requester.Method = "POST" Requester.ContentType = "application/x-www-form-urlencoded" Requester.ContentLength = RawData.Length Requester.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6" Dim NewStream As Stream = Requester.GetRequestStream() NewStream.Write(RawData, 0, RawData.Length) NewStream.Close() Dim ResponseStreamReader As StreamReader = New StreamReader(Requester.GetResponse().GetResponseStream()) Return ResponseStreamReader.ReadToEnd() End Function
