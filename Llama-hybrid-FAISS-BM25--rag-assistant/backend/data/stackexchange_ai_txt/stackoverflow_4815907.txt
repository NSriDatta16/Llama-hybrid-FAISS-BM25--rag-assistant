[site]: stackoverflow
[post_id]: 4815907
[parent_id]: 
[tags]: 
Implementing IGridProvider, IValueProvider in AutomationPeer class

I have written AutomationPeer class for my custom control: // Automation Peer for the CustomControl private class CustommControlAutomationPeer : FrameworkElementAutomationPeer, IValueProvider, IGridProvider { public CustomControlAutomationPeer(CustomControl control) : base(control) { } #region overriding the "Core" methods from the base automation peer class that describe behavior unique and specific to custom control ... #endregion #region overriding of GetPattern should return the object that implements the specified pattern public override object GetPattern(PatternInterface patternInterface) { if (patternInterface == PatternInterface.Grid || patternInterface == PatternInterface.Value) { return this; } return base.GetPattern(patternInterface); } #endregion #region IGridProvider ... #endregion #region IValueProvider ... #endregion /// /// Pointer to CustomControl /// private CustomControl Control { get { return (CustonControl)base.Owner; } } } In computer, where installed Visual Studio, and other computer, where installed test agent I started testmethod with code: AutomationPattern[] supportedPatterns = customControl.GetSupportedPatterns(); foreach (var supPattern in supportedPatterns) Trace.WriteLine(supPattern.ProgrammaticName); Result in trace: in computer with visual studio: QTAgent32.exe, Playback - {43} [SUCCESS] MouseButtonClick - "[UIA]ControlType='RadioButton' && AutomationId='allCriteriaRadioButton'" \0 **ValuePatternIdentifiers.Pattern; GridPatternIdentifiers.Pattern** QTAgent32.exe, IEDOM : StopSession of the plugin called before StartSession QTAgent32.exe, UIA : StopSession of the plugin called before StartSession in computer with test agent: QTAgent32.exe, &lt;a class=success&gt;Playback - {43} [SUCCESS] MouseButtonClick - "[UIA]ControlType='RadioButton' &amp;&amp; AutomationId='allCriteriaRadioButton'" \0&lt;/a&gt; **GridPatternIdentifiers.Pattern** QTAgent32.exe, IEDOM : StopSession of the plugin called before StartSession QTAgent32.exe, UIA : StopSession of the plugin called before StartSession Why am I get only IGridProvider in second case?
