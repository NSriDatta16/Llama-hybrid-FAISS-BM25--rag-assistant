[site]: stackoverflow
[post_id]: 5688119
[parent_id]: 5687947
[tags]: 
I suspect that this statement makes r "null" and not a proper rectangle. Dim r As Rectangle = TryCast(sender, Rectangle) The sender is probably not a rectangle but probably a WPF-Control (some subclass of System.Windows.Controls.Control). You can easily check with the Visual Studio debugger, by placing a debug-point on this line and see if this statement evaluates. Good luck with your drag-drop implementation :).
