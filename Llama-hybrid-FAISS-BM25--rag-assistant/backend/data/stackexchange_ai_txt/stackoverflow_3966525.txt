[site]: stackoverflow
[post_id]: 3966525
[parent_id]: 2402900
[tags]: 
I'm not sure that my recently encounter is whether same as you. I'm using external javascript file loaded in html-head section as a cheking user script. This is my code that generate error in IE, but this is not generate error in Firefox. function loginCheck() { var username = dojo.byId("usernameBox").value; var password = dojo.byId("passwordBox").value; var loginForm = dijit.byId("loginDialog"); var mainPage = dijit.byId("entirePage"); var menuUrl = ""; if(username != 'admin' && username != 'user'){ alert('Incorrect username'); } else { if(password != '1234') { alert('Incorrect password'); } else { loginForm.hide(); dojo.style(mainPage.domNode, {visibility:"visible"}); dojo.doc.title = dojo.doc.title + " : Signed in as [" + username + "]"; if(username == 'user'){ menuUrl = "../data/userMenu.json"; } else if(username == 'admin') { menuUrl = "../data/adminMenu.json"; } var treeStore = new dojo.data.ItemFileReadStore({ url : menuUrl }); var treeModel = new dijit.tree.ForestStoreModel({ store : treeStore, query : { "type" : "category" }, childrenAttrs : ["children"] }); var naviTree = new dijit.Tree({ model : treeModel, showRoot : false, autoExpand : true }, "naviPane"); dojo.connect(naviTree, "onClick", function(item){ var targetPage = item.link; var targetPane = dijit.byId("centerPane"); console.log(targetPage); **targetPane.attr('href',targetPage);** console.log("redirect success."); }); } } At the ** line. IE return this error. Webpage error details User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET > CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2; > Tablet PC 2.0; .NET4.0C; .NET4.0E; AskTB5.6) Timestamp: Tue, 19 Oct 2010 08:24:35 UTC Message: Object doesn't support this property or method Line: 49 Char: 21 Code: 0 URI: http://localhost:8080/TestESarabun/script/loginCheck.js After I am tracing into dojo library and stop at file dojo/_base/xhr.js with this piece of code. dojo._ioAddQueryToUrl = function(/*dojo.__IoCallbackArgs*/ioArgs){ //summary: Adds query params discovered by the io deferred construction to the URL. //Only use this for operations which are fundamentally GET-type operations. if(ioArgs.query.length){ ioArgs.url += (ioArgs.url.indexOf("?") == -1 ? "?" : "&") + ioArgs.query; ioArgs.query = null; } } My rough solution is just comment "indexOf" line out and then, my web application run without any error. Anyway, I am not sure what is this line going to do ?
