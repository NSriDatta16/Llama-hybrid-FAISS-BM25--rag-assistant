[site]: stackoverflow
[post_id]: 1086462
[parent_id]: 1086294
[tags]: 
StructureToPtr expects struct object, and foo is not structure it is array, that is why exception occurs. I can suggest you to write structures in cycle (sadly, StructureToPtr does not have overload with Index): long LongPtr = ptr.ToInt64(); // Must work both on x86 and x64 for (int I = 0; I Another option is to write structure as four integers, using Marshal.WriteInt32: for (int I = 0; I And the last, you can use unsafe keyword, and work with pointers directly.
