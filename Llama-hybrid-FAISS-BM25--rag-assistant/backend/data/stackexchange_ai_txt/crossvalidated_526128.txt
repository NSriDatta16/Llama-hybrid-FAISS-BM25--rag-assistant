[site]: crossvalidated
[post_id]: 526128
[parent_id]: 526063
[tags]: 
There is a typo¹ in the exponential part if not in the power: Starting from \begin{align} \pi((\mu, \sigma^2) | D) \propto ~ & \overbrace{\exp(-\sigma^{-2})(\sigma^2)^{-2}}^{\pi(\sigma^2)} \times \overbrace{\sigma^{-1} \exp(-\mu^2 / 2\sigma^2)}^{\pi(\mu|\sigma^2)} \times \\ &\underbrace{\exp(-(n(\mu - \bar{x})^2 + s^2)/2\sigma^2)/\sigma^n}_{\ell(\mu,\sigma^2|D)} \end{align} one gets \begin{align} \pi((\mu, \sigma^2) | D) \propto ~ & (\sigma^{-2})^{\overbrace{\frac{1}{2}+2+\frac{n}{2}}^{(n+5)/2}}\times\\ &\exp\left\{-[(n+1)\mu^2-2n\mu\bar x+n\bar{x}^2+s^2+2]/2\sigma^2\right\}\\ \propto ~ & (\sigma^{-2})^{\frac{n+2}{2}+1+\frac{1}{2}}\times\\ &\exp\left\{-(n+1)(\mu-n\bar{x}/(n+1))^2\right\}\times\\ &\exp\left\{-[n\bar{x}^2/(n+1)+2+s^2]/2\sigma^2\right\}\\ = ~ & (\sigma^{-2})^{\frac{1}{2}} \exp\left\{-(n+1)(\mu-n\bar{x}/(n+1))^2\right\}\times\\ &(\sigma^{-2})^{\frac{n+2}{2}+1}\exp\left\{-[n\bar{x}^2/(n+1)+2+s^2]/2\sigma^2\right\} \end{align} Hence, compared with the derivation at the top the powers of $\sigma^2$ are indeed $-1/2$ and $-(n+2)/2-1$ : $$(\sigma^{-2})^{\frac{n+5}{2}}=(\sigma^2)^\frac{-1}{2}\times (\sigma^2)^{-\frac{n+2}{2}-1}$$ there is a missing $n\bar{x}^2/(n+1)$ term in the scale parameter of the posterior inverse Gamma distribution. (See Murphy's derivation for double-check.) Apologies for the confusion! ¹It was already pointed out in earlier X validated questions: Computing posterior density of Normal with unknown $\mu$ and $\sigma^2$ Help with Bayesian derivation of normal model with conjugate prior
