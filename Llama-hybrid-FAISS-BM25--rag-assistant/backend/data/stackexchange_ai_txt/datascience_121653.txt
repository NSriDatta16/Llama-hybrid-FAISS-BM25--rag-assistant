[site]: datascience
[post_id]: 121653
[parent_id]: 
[tags]: 
State and next state is the same on openai gym atari

i am using OpenGym atari to trainning my Pacman agent, this is part of my code class DQN(nn.Module): def __init__(self, action_space): super(DQN, self).__init__() self.conv1 = nn.Conv2d(3, 16, kernel_size=8, stride=4) self.conv2 = nn.Conv2d(16, 32, kernel_size=4, stride=2) self.conv3 = nn.Conv2d(32, 64, kernel_size=3, stride=1) self.fc = nn.Linear(64 * 22 * 16, action_space) def forward(self, x): x = torch.relu(self.conv1(x)) x = torch.relu(self.conv2(x)) x = torch.relu(self.conv3(x)) x = x.view(x.size(0), -1) x = self.fc(x) return x #checkpoint = torch.load("C:\\Users\\tuyen\\Downloads\\hoang_chat.h5",map_location=torch.device('cpu')) env = gym.make('ALE/MsPacman-v5',render_mode='human') n_actions = env.action_space.n state, info = env.reset() target = DQN(n_actions) #target.load_state_dict(checkpoint) target.eval() done = False while not done: action = target(torch.tensor(state, dtype=torch.float32).permute(2, 0, 1).unsqueeze(0)) max_action = torch.argmax(action) action_index = max_action.item() observation, reward, terminated, truncated, _ = env.step(action_index) done = terminated or truncated state = observation env.close() then I realize that state and observation is always the same when I put this line ... print(state == observation) state = observation ... how should I fixed this ?
