[site]: stackoverflow
[post_id]: 2967802
[parent_id]: 
[tags]: 
NSXMLParser and Geonames

I'm trying to parse a call from Geonames with NSXMLParser in the iPhone SDK. I've used this before but for some reason I'm getting an empty dictionary back even though I get results back in a web browser. Can someone please point out what I may be doing wrong. Below is the code I'm using and the results that comes back pasting it in a browser. Thanks in advance #pragma mark - #pragma mark - Parcer Services -(void)beginLoadingFeed{ //[self startLoadingWithMessage:@"Loading Results...."]; NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(loadFeed) object:nil]; [operationQueue addOperation:operation]; [operation release]; } - (void)loadFeed{ NSString *path = [NSString stringWithFormat:@"http://ws.geonames.org/postalCodeSearch?placename=%@&long&maxRows=20",self.location]; [Logger log:@"Geonames Query: %@",path]; [self parseXMLFileAtURL:path]; [self performSelectorOnMainThread:@selector(didfinishedLoadingFeed) withObject:nil waitUntilDone:YES]; } -(void)didfinishedLoadingFeed{ } - (void)parserDidStartDocument:(NSXMLParser *)parser{ [Logger log:@"found file and started parsing"]; } //Called when the parser runs into an open tag ( ) - (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict { if ([elementName isEqualToString:@"code"]) { currentResult = [NSMutableDictionary dictionary]; } else { currentElement = [elementName copy]; } } //This is just to resolve random HTML entities - (NSData *)parser:(NSXMLParser *)parser resolveExternalEntityName:(NSString *)entityName systemID:(NSString *)systemID { return [entityName dataUsingEncoding:NSASCIIStringEncoding]; } - (void)parseXMLFileAtURL:(NSString *)URL{ self.results = [[[NSMutableArray alloc] init] autorelease]; NSURL *xmlURL = [NSURL URLWithString:URL]; NSXMLParser *parser = [[NSXMLParser alloc] initWithContentsOfURL:xmlURL]; [parser setDelegate:self]; [parser parse]; [parser autorelease]; } - (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError { NSString * errorString = [NSString stringWithFormat:@"Unable to connect to web site (Error code %i )", [parseError code]]; [Logger log:@"error parsing : %@", errorString]; [self stopLoadingView]; [self showMessage:@"Error loading content" withTitle:@"Error Loading"]; } /*** Called when the parser runs into a close tag ( ). If it is the Result tag that is closing, we should add the currentResult to the array, and then forget about it ***/ - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName { if ([elementName isEqualToString:@"code"]) { [self.results addObject:currentResult]; currentResult = nil; } } - (void)parserDidEndDocument:(NSXMLParser *)parser { [Logger log:@"all done!"]; [Logger log:@"results array has %d items", [self.results count]]; [Logger log:@"Results:%@",results]; [theTableView reloadData]; [self stopLoadingView]; } Below is the result that comes back in a browser using the same call above when doing the search for the term "boston": 2808 02101 Boston US 42.370567 -71.026964 MA Massachusetts 025 Suffolk 02108 Boston US 42.357603 -71.068432 MA Massachusetts 025 Suffolk 02109 Boston US 42.360027 -71.054495 MA Massachusetts 025 Suffolk 02110 Boston US 42.357636 -71.051417 MA Massachusetts 025 Suffolk 02111 Boston US 42.350348 -71.0629 MA Massachusetts 025 Suffolk 02114 Boston US 42.361111 -71.06823 MA Massachusetts 025 Suffolk 02115 Boston US 42.342706 -71.092215 MA Massachusetts 025 Suffolk 02116 Boston US 42.349201 -71.076798 MA Massachusetts 025 Suffolk 02118 Boston US 42.336162 -71.072854 MA Massachusetts 025 Suffolk 02128 Boston US 42.364197 -71.025694 MA Massachusetts 025 Suffolk 02199 Boston US 42.347873 -71.082543 MA Massachusetts 025 Suffolk 02210 Boston US 42.348921 -71.046511 MA Massachusetts 025 Suffolk 02215 Boston US 42.347088 -71.102689 MA Massachusetts 025 Suffolk 22713 Boston US 38.538241 -78.142285 VA Virginia 047 Culpeper 24592 South Boston US 36.696335 -78.918829 VA Virginia 083 Halifax 02102 Boston US 42.338947 -70.919635 MA Massachusetts 025 Suffolk 02103 Boston US 42.338947 -70.919635 MA Massachusetts 025 Suffolk 02104 Boston US 42.338947 -70.919635 MA Massachusetts 025 Suffolk 02105 Boston US 42.338947 -70.919635 MA Massachusetts 025 Suffolk 02106 Boston US 42.354318 -71.073449 MA Massachusetts 025 Suffolk
