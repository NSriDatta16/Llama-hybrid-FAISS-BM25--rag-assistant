[site]: stackoverflow
[post_id]: 2199694
[parent_id]: 2198972
[tags]: 
I use pypcap to read packets and dpkt to parse. For example, to use dpkt to read packets from a saved pcap: import socket import dpkt import sys pcapReader = dpkt.pcap.Reader(file(sys.argv[1], "rb")) for ts, data in pcapReader: ether = dpkt.ethernet.Ethernet(data) if ether.type != dpkt.ethernet.ETH_TYPE_IP: raise ip = ether.data src = socket.inet_ntoa(ip.src) dst = socket.inet_ntoa(ip.dst) print "%s -> %s" % (src, dst) To grab frames off the wire with pypcap: import pcap pc = pcap.pcapObject() dev = sys.argv[1] pc.open_live(dev, 1600, 0, 100) pc.setfilter("udp port 53", 0, 0) while 1: pc.dispatch(1, p.pcap_dispatch) Of course, the two can be used together: (ripped from pypcap's homepage) >>> import dpkt, pcap >>> pc = pcap.pcap() >>> pc.setfilter('icmp') >>> for ts, pkt in pc: ... print `dpkt.ethernet.Ethernet(pkt)` Good luck!
