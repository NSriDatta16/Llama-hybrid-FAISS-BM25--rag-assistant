[site]: crossvalidated
[post_id]: 506400
[parent_id]: 505132
[tags]: 
The problem can be phrased as Bayesian detection of moments of structural change . You do not choose a fixed data window $W$ . Instead you assign weight $p(W)$ to window $W$ . You can use the following model by Lai and Xing (2008). On each day dependent variable $Y_t$ is normally distributed with mean $\beta_t^T X_t$ and variance $\sigma_t^2$ . Here $\beta_t$ is a vector of coefficients and $X_t$ is a set of predictors. The vector of parameters $(\beta_t, \sigma_t^2)$ is stochastic and changes on any given day according to a Bernoulli process with probability $p$ . When the change occurs, a new value of $(\beta_t, \sigma_t^2)$ is generated from a gamma-normal distribution, which is referred to as hyperdistribution . Mathematically, the model can be summarized in the following fashion. Prior: $$ (\beta_t, \sigma_t^2) = (\beta_{t-1}, \sigma_{t-1}^2) $$ or $$ \tau_t \sim\rm{gamma}(g, \lambda), $$ $$ \sigma_t^2 = \frac{1}{2\tau_t}, $$ $$ \beta_t \sim \rm{N}\Bigl(z, \frac{V}{2\tau_t}\Bigr), $$ where $z$ , $V$ , $g$ and $\lambda$ are the hyperparameters. Likelihood: $$ Y_t = \beta_t^T X_t + \varepsilon_t, $$ $$ \varepsilon_t \sim \rm{N}(0, \sigma_t^2). $$ Posterior: $$ \rm{E}[\beta_t | X_1, Y_1, ... , X_t, Y_t ] = \sum_{j=1,...,t} p_{jt} z_{jt}, $$ $$ \rm{E}[\sigma_t^2 | X_1, Y_1, ... , X_t, Y_t ] = \frac{\sum_{j=1,...,t} p_{jt} a_{jt}}{2(g_{jt} - 1)}, $$ where $p_{jt}$ are the weights. On pp 222 - 223, Lai and Xing list detailed formulas for $(p_{jt}, z_{jt}, a_{jt}, g_{jt})$ given the history of process $(Y_s, X_s)$ up to time $t$ . It is important that the hyperdistribution can be chosen as reasonably “broad”. Does not need to be estimated from the data very accurately. REFERENCE: Lai, T. L. & Xing, H. (2008) Statistical Models and Methods for Financial Markets. Springer. UPDATE: Below I am showing the formulas for $(p_{jt}, z_{jt}, a_{jt}, g_{jt})$ .
