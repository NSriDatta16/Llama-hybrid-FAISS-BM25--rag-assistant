[site]: crossvalidated
[post_id]: 229468
[parent_id]: 229358
[tags]: 
This largely follows on from Antoni's answer. Here's what I was getting at with a permutation test First let's exclude the tie as Antoni did: d s r 10 1 6 -9 -1 5 8 1 4 5 1 2 -6 -1 3 0 NA NA 2 1 1 Our test statistic is then 1+2+4+6 = 13 So we could calculate the permutation distribution from scratch as follows: pm 0)%*%cbind(1:6)))/64 which gives the same values as dsignrank(0:21,6) (yay!). So clearly when there are no ties (which is the case, since we excluded them) this is just the signed rank test, as it should be Let's consider whether we can do anything with the tie. How we really deal with it depends on how it came about. If, for example we envision an underlying continuous scale that has become discretized into categories, then our tie is simply due to two different values that our subsequently imposed categories are not fine enough to distinguish. Arguably then, the two values are "really" different but we have no basis to conclude which sign we should have and so allowing for both possibilities, half the time giving it a +1 and half the time giving it a -1 and then averaging the two (or perhaps to be conservative, some would argue we should take the higher of the two possible counts ... but I'll continue to look at the average of the two possible cases here). [By contrast if the values were inherently discrete with no underlying-but-unobserved continuous scale, then we would say that the 0 was inherent and deal with it in a different way -- I think exclusion probably makes the most sense in that case] Note tie will always have the smallest rank. So we have a table like the one above but the second last row is either: d s r : : : 0 -1 1 or d s r : : : 0 1 1 and all the other rows would have r one higher than before. d s r 10 1 7 -9 -1 6 8 1 5 5 1 3 -6 -1 4 0 Â±1 1 2 1 2 So the possible test statistics are 2+3+5+7 and 1+2+3+5+7 (17 and 18) [One alternative approach, if we're being conservative would be to treat it as a full n=7 and take the larger of the two possible p-values which gives 0.6875] If we do all the permutations but always average the two signs for the smallest rank, they'll contribute 1/2, and each of the other positive ranks will be 1 higher. In effect we'd be doing this: table(0.5+rowSums((sign>0)%*%cbind(2:7)))/64 And comparing a test statistic of 17.5 with that. This gives p = 0.625. So anyway, all the approaches are a bit different but they pretty much tell the same general story here.
