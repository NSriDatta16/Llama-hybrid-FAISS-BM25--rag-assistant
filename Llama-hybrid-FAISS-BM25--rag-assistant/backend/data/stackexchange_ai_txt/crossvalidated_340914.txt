[site]: crossvalidated
[post_id]: 340914
[parent_id]: 
[tags]: 
Supervised PCA with caret

I am trying to create my own training model in caret to do prediction using Supervised Principal Components , but I am having difficulty in preprocessing my data. As far as I know, I am not able to create my own preProcess function, so I am trying to process my data within the "fit" and "predict" components of my model. The gist is that for each feature of my data model, I compute a scaled regression coefficient and then only keep those features whose absolute coefficient value falls above some threshold (a parameter in my model). I then use this reduced $X$ to compute the first $n$ principal components and fit the subsequent model. The fit component looks like this: pcaFit param$threshold) ## Keep nonzero loadings in X pc Now, in order to do prediction, I need to keep those same loadings in my newdata, find the first $n$ principal components, and then predict with the model created above. I can't just recompute the loadings for newdata either, as these will most likely not be the same on the left-out data. For my predict function, I have something like this: pcaPredict I've tried setting loading to be a global variable, but I'm not particularly well versed in how to do that effectively. When doing so, I get warnings for locked binding, etc., and that's not a path I probably want to go down unless I have to. In short, I want to be able to get the column indices ( loadings ) found in the "fit" part of my model, and use them to preprocess the newdata before running prediction on it. I'm not sure how to update this value in both places, and as far as I'm aware, there isn't a preProcess function that I can use to help with this step. Edit: After some investigating, I have found something close to what I want to do. Using sbf/sbfControl, for any particular function used (i.e., caretSBF ), there is a caretSBF$filter = function(score, x, y) score I believe that I can update the score function to perform univariate feature selection based on my criterion above, but this value in caretSBF$filter is what I would like to tune over. Any help with that would be GREATLY appreciated.
