[site]: stackoverflow
[post_id]: 2569142
[parent_id]: 2569012
[tags]: 
Use the built-in FILTER function %# generate noisy signal x = sin(0:.1:10*pi); x = x + 0.5*(rand(1,length(x))-0.5); %# moving average smoothing window = 15; h = ones(window,1)/window; y = filter(h, 1, x); %# plot subplot(211), plot(x), ylim([-1 1]), title('noisy') subplot(212), plot(y), ylim([-1 1]), title('filtered') To solve the lag problem, try something like this: s = ceil(window/2); yy = y(s:end); n = length(x); plot(1:n, x, 'b'), hold on, plot(1:n-s+1, yy,'r'), hold off legend({'noisy' 'filtered'})
