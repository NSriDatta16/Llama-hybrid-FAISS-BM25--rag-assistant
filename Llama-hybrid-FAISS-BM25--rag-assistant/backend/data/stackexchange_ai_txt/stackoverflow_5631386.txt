[site]: stackoverflow
[post_id]: 5631386
[parent_id]: 
[tags]: 
Trouble installing certificate from .pfx file

I am trying to install a certificate on my local machine (Win Server 2003) with the X509Certificate2 class in a C# test console application. When I install the certificate with the following code, everything is fine: var serviceRuntimeMachineCertificateStore = new X509Store(StoreName.Root, StoreLocation.LocalMachine); serviceRuntimeMachineCertificateStore.Open(OpenFlags.ReadWrite); cert = new X509Certificate2(certificatePath); serviceRuntimeMachineCertificateStore.Add(cert); serviceRuntimeMachineCertificateStore.Close(); Problem is, that the private key of the certificate is not persisted, when installed without the X509KeyStorageFlags.PersistKeySet. So I tried to instanciate the certificate like this (the private key has no password, so I pass in an empty string): var serviceRuntimeMachineCertificateStore = new X509Store(StoreName.Root, StoreLocation.LocalMachine); serviceRuntimeMachineCertificateStore.Open(OpenFlags.ReadWrite); cert = new X509Certificate2(certificatePath, "", X509KeyStorageFlags.PersistKeySet); serviceRuntimeMachineCertificateStore.Add(cert); serviceRuntimeMachineCertificateStore.Close(); But trying to instanciate the certificate throws a System.Security.Cryptography.CryptographicException "Failed to load certificate: The specified network password is not correct.", even though the private key has no password. If I import the certificate in the Microsoft Management Console without specifying a password it works great. Does anybody know how to do this programmatically?
