[site]: stackoverflow
[post_id]: 2428925
[parent_id]: 2339421
[tags]: 
In cases like this I would recommend to use VBA, but I've found a (admittedly inefficient) solution with only excel formulas. In the cell A1 of a new sheet write 1, then 2 in the cell below. Select the two cells and drag down. The autocomplete function will produce the number from 1 until the end of the drag. Carry on until you reach the number 9999 In the cell B1 put the formula =TEXT(A1,"000#") ; drag the formula down to get the text from 0001 to 9999 . In the cell C1 put the formula ="9854978_"&B1&"_US.txt" ; drag the formula down to get the text from 9854978_0001_US.txt to 9854978_9999_US.txt In the cell D1 put the formula: =if(ISERROR(SUM(INDIRECT(C1&"!F:F"))),0,SUM(INDIRECT(C1&"!F:F"))) ; drag the formula down to get the sums. The solution could become much less inefficient reducing the set of possible numbers. Missing the year the possible dates are only 365. PS: the formulas could be slightly wrong because I translated them from my localized version of excel.
