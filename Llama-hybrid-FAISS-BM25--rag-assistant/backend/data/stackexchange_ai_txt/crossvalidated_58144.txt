[site]: crossvalidated
[post_id]: 58144
[parent_id]: 58090
[tags]: 
Use acf from the stats package (or Acf from the forecast package) with ci.type="ma" . Note that some people use the simpler approximation all the time - it's just to give an idea what models might be worth considering so accuracy isn't so important. Bartlett's approximation (the one you quote from Wikipedia) is only relevant to examining the autocorrelation function: the confidence interval for a lag $q$ is given assuming, as a null hypothesis, a moving average process of order $q-1$; it's conditional upon the estimated autocorrelations of all previous lags. (So note that it's not especially relevant to deciding between, say, an ARMA(1,1) & an ARMA (1,2).) You might suppose a similar formula for confidence intervals on the partial autocorrelations, mutatis mutandis; but you'd be wrong: if you assume an autoregressive process of order $p-1$, the standard errors on the partial autocorrelations are asymptotically $\frac{1}{\sqrt{n}}$, where $n$ is the number of observations. Quenouille (1949), "Approximate tests of correlation in time-series", JRSS B , 11 , 1 .
