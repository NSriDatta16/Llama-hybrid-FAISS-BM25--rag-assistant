[site]: crossvalidated
[post_id]: 481660
[parent_id]: 481515
[tags]: 
The issue here is that the mean coverage will only converge to 0.95 as the number of groups becomes large. When the number of groups is "low" then I believe you will find on average less than 95% coverage. 48 is neither particularly high or low. However, with a typical 94.5% coverage with your parameters, I don't think this is a big problem in this case. Also, the pattern you see in your plot are only relevant for the particular seed you set. To see this, we can run some more simulations. Note that I have modified your code to make it run in parallel on as many local cores as you have available. This type of simulation is particularly suited to parallelisation. Doing this reduced the run time on my machine from over 28 minutes to under 6 minutes with 48 groups and 16 subjects per group :) I have also added a progress bar for the main simulation so you are not waiting around wondering how long it's going to take: library(lme4) library(tidyverse) library(parallel) library(purrr) library(furrr) check_conf_int % bind_rows(.id = "group") %>% mutate(group = as.factor(group)) } } ) # create a parallel version of replicate parReplicate % ggplot(aes(runs, coverage)) + geom_line() + geom_hline(linetype = "dashed", yintercept = 0.95) + coord_cartesian(ylim = c(0.93, 0.97)) ) print(p) } The following two plots are for 96 groups: As you can see, these show much better coverage. And finally, one with 200 groups.
