[site]: stackoverflow
[post_id]: 2067415
[parent_id]: 
[tags]: 
Java Servlets: File download breaks when user navigates away from page

I have a servlet that allows users to download (potentially large) zip files from a web page. If the user clicks on a link to download a zip file, code similar to the following is executed in the servlet: response.setContentType("application/zip"); response.setHeader("Content-disposition", "attachment; filename=foo.zip"); response.setHeader("Pragma", ""); response.setHeader("Cache-Control", "no-store"); ZipOutputStream out = new ZipOutputStream(response.getOutputStream()); // write entries to the zip file... ... out.close() However, if the user refreshes or navigates away from the page after the download begins and before it completes (in Firefox 3.5.7), the download will fail. The following error pops up: C:\blah\foo.zip.part could not be saved, because the source file could not be read. Try again later, or contact the server administrator. Any ideas on how I can make sure the download continues in this case? UPDATE : The link that initiates the download is a plain vanilla link. Interestingly, the behavior is different on IE. Clicking on links elsewhere on the site (from the currently loaded screen) seem not to load (the browser status bar says "Waiting for https://mysite/clicked_linky.do ..."), blocking until the download completes. Typing a different URL into the address bar or using a shortcut/favorite link navigates away from the page, but the download continues as expected. Only Firefox seems to display the exact behavior I described above, although the IE blocking is not optimal.
