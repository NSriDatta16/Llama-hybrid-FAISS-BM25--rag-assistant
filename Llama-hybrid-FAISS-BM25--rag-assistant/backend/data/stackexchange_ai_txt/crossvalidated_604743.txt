[site]: crossvalidated
[post_id]: 604743
[parent_id]: 
[tags]: 
Calculating Bayesian Coverage Probabilities

I am trying to learn how to calculate Bayesian Coverage Probabilities for the parameter from a Binomial Distribution using a Beta Distribution as a Prior. As I understand, this would go as follows (fix values of alpha and beta): Step 1: Assume a true value of "p" and simulate data points from a Binomial Distribution with this "p" Step 2: Find an expression for the Posterior Distribution of "p" (there will be a closed form solution due to the Conjugacy) Step 3: Find out the 95% Credible Interval and see if the true value of "p" is contained within this interval Step 4: Repeat Step 1 - 3 many times Step 5: Choose a new true value of "p" and repeat Step 1 - Step 4 Here is my attempt to implement this in R: # Set the values of p to loop through prop = seq(0.0, 1, by = 0.005) # Initialize empty list to store results my_list_2 = list() # Start loop for (j in 1:length(prop)) { p_j = prop[j] # Initialize empty list to store results for each iteration of the inner loop my_list = list() for (i in 1:1000) { sample_i = rbinom(100, size = 1, prob = p_j) alpha_post = sum(sample_i) + 2 beta_post = 100 - sum(sample_i) + 2 posterior_sample = rbeta(1, alpha_post, beta_post) lower_i = qbeta(0.025, alpha_post, beta_post) upper_i = qbeta(0.975, alpha_post, beta_post) counter_i = ifelse(p_j >= lower_i && p_j $p, result$ mean, type = "b", main = "95% Coverage Probability Plot Using Bayesian Credible Intervals", xlab = "Proportion Value", ylab = "Average Coverage Probability (95% Credible Interval)") abline(h = mean(result$mean), col = "green", lty = 3) abline(h = 0.95, col = "red", lty = 2) Can someone please tell me if I have done this correctly? Thanks!
