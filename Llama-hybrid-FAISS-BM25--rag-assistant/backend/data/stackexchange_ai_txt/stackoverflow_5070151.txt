[site]: stackoverflow
[post_id]: 5070151
[parent_id]: 
[tags]: 
Date counter for daily returns using trading days

I have a time series dataset. This is a sample of the data: firm evntdate date evntdum ret mrktret bef_sum 1 03251110 1989-08-01 1989-02-23 1 -0.00498 0.00053 110 2 03251110 1989-08-01 1989-02-24 1 -0.00500 -0.00494 110 3 03251110 1989-08-01 1989-02-27 1 0.00503 -0.00125 110 4 03251110 1989-08-01 1989-02-28 1 0.00500 0.00392 110 5 03251110 1989-08-01 1989-03-01 1 -0.00498 -0.00040 110 6 03251110 1989-08-01 1989-03-02 1 0.00000 0.00503 110 The dataset includes information about a firm ('firm') and event date ('evntdate'). For each event date, there are several daily returns ('ret') prior to the event date, therefore for each specific event, there has to be a unique firm and event date repeated for as many times as I have daily returns. The 'bef_sum' is a number indicating the number of daily returns prior to the event date which repeats itself each row if it belongs to the same firm/event date. What I want to do is to create another column that will create a date counter, so that the first daily return (based in 'date') for a specific combination of firm/evndate will be -110 the next one -109 (because this counter is relative to the event date), and so fort. The difficulty I have is that this counter should be independent for each firm/evntdate, I cannot use a simple subtraction from the event date minus date because these are trading days, so holidays/weekends should not be considered.
