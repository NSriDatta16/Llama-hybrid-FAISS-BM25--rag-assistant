[site]: stackoverflow
[post_id]: 1825559
[parent_id]: 1823166
[tags]: 
Because your awk command is inside single quotes, the shell variables file and f will not be expanded. That's why you're getting the awk errors. I would use the following script: #!/bin/bash for file in pmb_mpi tau xhpl mpi_tile_io fftw ; do for f in 2.54 1.60 800 ; do if [[ ${f} = "2.54" ]] ; then flist=${file}_${f}_even_v1.xls ${file}_${f}_odd_v1.xls else flist=${file}_${f}_v1.xls fi cat ${flist} | awk ' s+=$2; END {print "Average = ",$s/NR} ' >${file}_${f}_avrg.xls # Or use awk '...' ${flist} >${file}_${f}_avrg.xls # if you're overly concerned about efficiency of processes. done done That will simply set flist to either both files or one file, depending on whether f is 2.54 or not, then push that list of files through a single awk script.
