[site]: crossvalidated
[post_id]: 468955
[parent_id]: 468949
[tags]: 
Importance sampling approximates the integral $\mathbb E_{\pi(x)}[h(x)]$ , so $\pi(x)$ is the original distribution. It makes sense if the original problem is to calculate an expected value of a function wrt distribution, $\pi(x)$ . Instead of sampling from $\pi(x)$ , we sample from a proposal distribution, $g(x)$ and calculate the expected value of the ratio $\frac{h(x)\pi(x)}{g(x)}$ . In integral estimation, the actual $h(x)$ and $\pi(x)$ doesn't matter. You'll again find the expected value of the ratio above. Your code needs the following change: mean(original_function(values_derived_from_inverse_CDF) / exp(-values_derived_from_inverse_CDF+38)) You were averaging $\frac{h(x)\pi(x)}{x}$ , but you should have averaged $\frac{h(x)\pi(x)}{g(x)}$ .
