[site]: stackoverflow
[post_id]: 4250995
[parent_id]: 4250925
[tags]: 
DOMDocument 's loadHtml() method works well with invalid HTML fragments, so you can use DOMXPath this way: text2 text3 text4 text5'; echo " " . htmlentities($html) . " \n"; $dom = new DOMDocument(); // loadHtml() needs mb_convert_encoding() to work well with UTF-8 encoding $dom->loadHtml(mb_convert_encoding($html, 'HTML-ENTITIES', "UTF-8")); $xpath = new DOMXPath($dom); echo "Text nodes preceding br:"; foreach($xpath->query('//text()[(following::br)]') as $node) { var_dump($node->wholeText); } echo "Text nodes following br:"; foreach($xpath->query('//text()[(preceding::br)]') as $node) { var_dump($node->wholeText); } echo "Text nodes following OR preceding br:"; foreach($xpath->query('//text()[(following::br) or (preceding::br)]') as $node) { var_dump($node->wholeText); }
