[site]: crossvalidated
[post_id]: 355112
[parent_id]: 355097
[tags]: 
There aren't very many R packages that can handle the combination of zero-inflation, random effects, and negative binomial responses. glmmTMB is one. Approximately: library(glmmTMB) glmmTMB(output ~ 1 + sex_ratio + avg_fem_size + avg_male_size + (1+ sex_ratio|block), family="nbinom2", ziformula=~1) (1+sex_ratio|block) is the syntax for allowing the baseline output and the effect of sex ratio to vary by block. This might be too complicated (how many blocks do you have??), in which case you could drop back to (1|block) , ignoring possible variation of sex ratio effect across blocks. Having sex ratio vary by week and block isn't a big deal. The ziformula (zero-inflation formula) above assumes that the zero-inflation proportion is fixed across all blocks, values of the covariates, etc.; you can relax that (by giving the ziformula argument some fixed covariates or random effects), again subject to having enough data to fit a more complicated model. glmmTMB also offers a family="nbinom1" choice, which specifies a negative binomial parameterized such that the variance is a linear (rather than quadratic) function of the mean, i.e. $V=\phi\mu$ rather than $V=\mu+\mu^2/k$. Might be worth trying. I believe the brms package can also handle this model, but that gets you into the Bayesian world, for better or worse ...
