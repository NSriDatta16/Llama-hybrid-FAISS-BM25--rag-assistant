[site]: stackoverflow
[post_id]: 451127
[parent_id]: 449036
[tags]: 
The cause of this bug is that the FixedPage's layout isn't being updated prior to writing. This causes the first FixedPage in the first FixedDocument in the FixedDocumentSequence to be written incorrectly. This affects NO OTHER PAGES IN THE RESULTING DOCUMENT , which made this bug/edge case harder to nail down. The following WORKS (rewritten version of the non-working example): FixedPage fp = CreateFixedPageWithBinding(); fp.DataContext = CreateDataContext(); var fd = new FixedDocument(); /* PAY ATTENTION HERE */ // set the page size on our fixed document fd.DocumentPaginator.PageSize = new System.Windows.Size() { Width = DotsPerInch * PageWidth, Height = DotsPerInch * PageHeight }; // Update the layout of our FixedPage var size = fd.DocumentPaginator.PageSize; page.Measure(size); page.Arrange(new Rect(new Point(), size)); page.UpdateLayout(); /* STOP PAYING ATTENTION HERE */ var pc = new PageContent(); ((IAddChild)pc).AddChild(fp); fd.Pages.Add(pageContent); // Create a fixed document sequence and add the fixed document to it FixedDocumentSequence fds = CreateFixedDocumentSequence(); var dr = new DocumentReference(); dr.BeginInit(); dr.SetDocument(fd); dr.EndInit(); (fds as IAddChild).AddChild(dr); // Create an xps document and write the fixed document sequence to it var p = Package.Open("c:\\output.xps", FileMode.CreateNew); var doc = new XpsDocument(p); var writer = XpsDocument.CreateXpsDocumentWriter(doc); wri2.Write(fds); p.Flush(); p.Close();
