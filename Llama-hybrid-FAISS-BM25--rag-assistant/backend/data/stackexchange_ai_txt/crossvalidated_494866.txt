[site]: crossvalidated
[post_id]: 494866
[parent_id]: 
[tags]: 
How to explain the numerical discrepancy between FactoMineR::PCA() and the svd() in their output of the U matrix?

I am comparing the output of two functions in R to do Principal Component Analysis (PCA), the FactoMineR::PCA() and the base::svd() using the R built-in data set mtcars , given that the former function is a wrapper of the latter, so they should converge on basic results of the $U$ if everything is fine, $\Sigma$ and $V$ , since $X = U\cdot \Sigma \cdot V^{T}$ # PCA using FactoMineR::PCA() library(FactoMineR) res.pca $svd$ V, 2) == round(svd.pca $v, 2) # Mixed TRUE/FALSE svd.pca$ v[, c(5, 7)] $v[, c(5, 7)] * -1 # correct for signs in columns 5 and 7 round(res.pca$ svd $V, 2) == round(svd.pca$ v, 2) # TRUE # comparison in terms of Sigma (they match up after correction for the divisor N-1 round(res.pca $svd$ vs, 3) == round(svd.pca$d / (sqrt(nrow(S) - 1)), 3) # TRUE # comparison in terms of U (they don't match up after correction for signs) svd.pca $u[, c(5, 7)] u[, c(5, 7)] * -1 # correct for signs svd.pca $vs d / (sqrt(nrow(S) - 1)) # to add $sdev to sdv() output and make it match up with FactoMineR $ svd $vs svd.pca$ vr $vs ^ 2 # to add Sigma (variance) to the sdv() output round(res.pca$ svd $U, 2) == round(svd.pca$ u %*% diag(svd.pca$vr), 2) # Except for the first column everything else is FALSE, why? R> head(res.pca $svd$ U[, 1:5]) [,1] [,2] [,3] [,4] [,5] [1,] -0.2838 0.826 -0.292 -0.249 -1.785 [2,] -0.2722 0.688 0.159 -0.169 -1.559 [3,] -0.9825 -0.230 -0.301 -0.214 0.181 [4,] -0.0920 -1.392 -0.471 -0.608 0.579 [5,] 0.6780 -0.584 -1.478 0.291 0.529 [6,] 0.0212 -1.723 0.160 -1.720 0.299 R> svd.pca $u %*% diag(svd.pca$ vr)[, 1:5] [,1] [,2] [,3] [,4] [,5] [1,] -0.2837 0.3041 -0.02606 -0.01165 -0.05780 [2,] -0.2722 0.2532 0.01413 -0.00792 -0.05048 [3,] -0.9823 -0.0846 -0.02680 -0.01004 0.00586 [4,] -0.0920 -0.5123 -0.04202 -0.02848 0.01875 [5,] 0.6779 -0.2148 -0.13174 0.01363 0.01712 [6,] 0.0212 -0.6341 0.01426 -0.08059 0.00967 As you can see the first column matches up, but other columns don't. So what would be the $U$ matrix in FactoMineR representing differently from that of the svd ? How to make them match up using R? Apart from the signs, it seems that the $V$ matrix is the same for the two function outpus, but what makes the $U$ different then between them? Note the scaling is also different between the two functions and this line below will do the correction: A $svd$ U %*% diag(res.pca $svd$ vs) %*% t(res.pca $svd$ V) Side note source code for FactoMineR::PCA() can be accessed and viewed by: FactoMineR:::PCA
