[site]: crossvalidated
[post_id]: 397295
[parent_id]: 395078
[tags]: 
Not wanting to add too much information in the original post, the reply here is in response to @Achim Zeleis following this part: "The corresponding score-based CUSUM tests are available in strucchange as well but the breakpoint estimation is in fxregime " And question 3, which was phrased poorly (now updated in the original post): "Re: Q3. This sounds indeed like you want to have a "monitoring" or "sequential testing" procedure for which various tools have been proposed under different labels in different communities. Statistical process control or quality control might be another relevant label." Having read the vignette of fxregime and strucchange a breakdate estimation is obtained. https://cran.r-project.org/web/packages/fxregime/vignettes/CNY.pdf https://cran.r-project.org/web/packages/fxregime/fxregime.pdf The questions associated with this part are as follows: 1. How to translate the one break date estimation found by fxregime to both the changes in intercept and auto correlation? 2. Is the logic/method I used in obtaining this break estimation using fxregime correct? 3. Should I even expect two break dates, or do both changes in intercept and auto correlation occur at the same date? (e.g. what if variance would change at a different break date, do I then get two - three different break dates? 4. Question 3 of the original post applies (updated) 5. Should I be concerned with seasonal effects as suggested by @Irish Stat (deleted answer)? I assume only when I want to model this afterwards, and not during the break testing? Analysis code snippets for myts1: Combine log series with its lags for subsequent regression. d Taking the same "Score-CUSUM" test: sc Break date estimation using fxregime : 1. LWZ and Negative Log−Likelihood plot shows optimal number of breaks of 1 2. Breakdate with a confidence interval indicates a break at observation 744 bd Then with coef I can obtain the coefficients from each segment. coef(bd) ## ## (Intercept) y1 (Variance) ## 2016.33334081892--2018.36895725728 3.926381 0.3858473 0.08969063 ## 2018.37169698331--2018.99909424358 3.778685 0.2845176 0.04813337 From here I would say that also the variance has dropped by quite a bit, but unsure how to interpret this correctly given a single break date estimation and non significance in the Score-CUSUM test? Part 2, related to question 3 in the OP Now as mentioned in Q3 of the (updated) original post, there are multiple time series, the one below is for the prediction of interval 1-2hrs for 975 consecutive days, with each day having one weighted average score. Analysis code snippets for myts2: Regarding Q0: re-evaluation of the time series. Referring the second image in the original post, the right skew is still somewhat apparent and looking at the acf() and pacf() before and after the break still indicates that an AR(1) model would work quite well (I think, similar graphs). pacf(log(window(myts2, end = c(2018, 136)))) pacf(log(window(myts2, start = c(2018, 137)))) Again combine log series with its lags for subsequent regression. e "Score-CUSUM" test: sc2 Similar to the first time series, the intercept and auto correlation coefficient change significantly at the time point visible in the original time series. However, this time there is also a fluctuation visible in the variance that is significant at the 5% level, not directly matching the time point of intercept and auto correlation. Break date estimation using fxregime : 1. LWZ and Negative Log−Likelihood plot shows optimal number of breaks of 1 due to the sharp decline of LWZ and the kink in NLL at after breakpoint 1. 2. Breakdate with a confidence interval indicates a break at observation 736 d breakdates(ci) # 2.5 % breakpoints 97.5 % # 1 2018.331 2018.347 2018.385 Then with coef I can obtain the coefficients from each segment. coef(bd1) # (Intercept) y1 (Variance) # 2016.33334081892--2018.34703944906 3.853897 0.3985997 0.07925990 # 2018.34977917509--2018.99909424358 3.106076 0.4773263 0.04625951 To evaluate this part for myts2 (1-2hr prediction interval), the variance has dropped by quite a bit but the change is less compared to myts1. Moreover, there is a change noticeable in the coefficients of the intercept and the auto correlation. Also here the question is how should this be interpreted? How does this single break date estimation reflect the breaks that are visually seen in the Score-CUSUM test? *also saw that the refit function will fit segmented regressions from the fxregimes function, which can be used to compare as mentioned last by @Achim Zeileis. Is it then possible to compare models (Q3) across the time series (myts1-10)? I assume only when they are sharing the same scale as one cannot compare a model that has a log vs one that does not.
