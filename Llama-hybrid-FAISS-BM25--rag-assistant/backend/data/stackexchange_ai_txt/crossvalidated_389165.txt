[site]: crossvalidated
[post_id]: 389165
[parent_id]: 388968
[tags]: 
This is how I would do it. Please see the questions and comment I left above. Based on the question it seemed like the choice of the newer non-CRAN panel matching library PanelMatch , while interesting, seemed to require information/data not in your question for time-series specific use cases of PSM. It sounded like you're in the more general case, wherein you'd want a plain PSM/matching package like Matching or FastMatch , though if this assumption is incorrect please let me know and provide more info on your needs. Ok so first, load the libraries and data: #devtools::install_github("insongkim/PanelMatch", dependencies=TRUE) if ( !require(pacman) ) install.packages("pacman");require(pacman) p_load(Matching,speedglm) # PanelMatch data I am taking the PS equation from your question, but normally I use the MatchBalance() function and its statistical tests to define the PS model specification Your equation mentioned leverage and loss, but it's missing from the data, so I will exclude that below. Here's the propensity score (PS) model: form OK, now extract the propensity scores: data$fitted.values Now do matching, and calculate quasi-experimental statistics, like Average effect of Treatment on the Treated (ATT) or the ATE: set.seed(1) # set a random seed atta $decost, # I assume this is the outcome Tr = data$ switch, # Treatment/Control indicator X = data$fitted.values, # PS's estimand = "ATT", # Outcome metric M = 1, # 1-to-1 or 1-to-many matching ties = F,#T, # T = VERY SLOW but higher quality replace = TRUE, exact = T, version = "fast" ) summary(atta) # That gives you your result. You should also do post hoc testing to make sure that treatment and control are NOT significantly different on any control variables.
