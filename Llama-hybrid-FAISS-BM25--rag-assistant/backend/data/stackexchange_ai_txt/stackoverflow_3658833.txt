[site]: stackoverflow
[post_id]: 3658833
[parent_id]: 3657495
[tags]: 
When you call isprime(pstep) you are looping pstep * ln(pstep) times, if you have a prime, of which the probability is 1/ln(pstep). So the cost of testing the primes is proportional to step. Unknown is the cost of testing the composites, because we don't know the average lowest factor of the composites between 2 and N. If we ignore it, assuming it is dominated by the cost for the primes, we get a total cost of SUM(pstep) for pstep = 3 to N+3, which is about proportional to N**2. You can reduce this to N**1.5 by cutting off the loop in isprime() when checked > sqrt(a).
