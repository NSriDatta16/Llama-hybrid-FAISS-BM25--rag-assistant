[site]: stackoverflow
[post_id]: 5145802
[parent_id]: 5145558
[tags]: 
How about using blocks of fixed size, e.g. 1KB? Each block would contain a byte (or 4 bytes) indicating which stream it is, and then it follows with just data. Benefits: You don't have to pay attention regarding the data itself. Data cannot accidently trigger any behaviour from your system (e.g. accidently terminate the stream) I does not require random file access when encoding. In particular, you don't store the length of the block as it is fixed. If data goes corrupt, the system can recover in the next block. Drawbacks: If you have to switch from stream to stream a lot, with each having only few bytes of data, the block may be underutilised. Lots of bytes will be empty. If the block size is too small (e.g. if you want to solve the above problem), you can get huge overhead from the header.
