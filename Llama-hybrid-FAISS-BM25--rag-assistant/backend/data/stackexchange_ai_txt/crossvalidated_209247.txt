[site]: crossvalidated
[post_id]: 209247
[parent_id]: 
[tags]: 
More effective seasonal adjustment to time series data?

I am trying to predict surface temperature using solar energy. I have 3650 daily averages for both variables. The plots of both are below: I attempt to seasonally adjust with a periodic regression in R for both: stmp.model.sa Here are the plots of the residuals from these models: As you can see, the temperature data responded well to the treatment. The solar energy data did not, as the yearly humps are still somewhat present. A few questions: Is there a more effective way to remove seasonality for the solar data? Is further treatment of the temperature trend recommended? Would a polynomial regression be sufficient to remove this trend? What model might be recommended to predict the temperature? Linear model, ARIMA/ARIMAX models, linear regression with ARIMA errors, etc? Thanks in advance for any responses! EDIT: I attempted to apply a Hodrick Prescott filter (lambda = 100*365^2) with poor results. I then attempted to fit a cycle to the solar data using a 20 period moving maximum. This was done using the following code: seq The moving maximum, the solar cycle, and the cycle subtracted from the original series is presented below: This did not remove the yearly cycle entirely either. Any advice? EDIT 2: I have successfully removed seasonality by fitting a 20 order polynomial to the first three years (using more years proves computationally difficult). If anyone can think of a better or more elegant way to achieve this, let me know.
