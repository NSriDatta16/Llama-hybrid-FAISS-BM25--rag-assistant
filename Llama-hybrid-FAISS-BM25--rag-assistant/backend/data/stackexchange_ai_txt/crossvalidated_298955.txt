[site]: crossvalidated
[post_id]: 298955
[parent_id]: 
[tags]: 
Convert "Alive" counts per replicate and time to survival data

I have a raw data set describing survival in groups of individuals over time, organized as follows: Diet Replicate N Duration Alive A 1 4 0 4 A 2 4 0 4 A 3 4 0 4 A 4 4 0 4 B 1 4 0 4 B 2 4 0 4 ... A 3 4 50 1 A 4 4 50 0 B 1 4 50 0 B 2 4 50 3 B 3 4 50 1 B 4 4 50 2 Diet is the factor, each Replicate corresponds to a vial that initially contained a pool of N individuals, Alive is the number of these initial individuals that are still alive after Duration . When an individual dies, it is removed from the vial but the vial is still being monitored. Note that in this particular data set, empty vials have still been recorded at every Duration step with "0" Alive instead of just being removed from the monitoring. Now I would like to analyze this with survfit() , but the table is not formatted properly. If I understand correctly, it needs a binary status variable where "1" corresponds to an event ( i.e. , the death of one individual in a Replicate at a given Duration ) and "0" a non-event (no one died in that particular Replicate since the previous monitoring, so individual is censored). I suppose that if two individuals from one Replicate died at a given time, two consecutive rows of "1" would be required for the corresponding Replicate and Duration , meaning that in fact my table should not group by replicates but instead unfold all individuals in rows (one row per individual instead of one per Replicate of N =4 individuals). I managed to get the bigger table with one individual per row and a Mortality binary variable where "1" means Dead and "0" means Alive, but I believe this does not correspond to a status variable: an individual reported as Dead (1) at a given time will still be described as Dead the next time, and survfit() will consider it a new mortality event. I imagine that what I would need is to convert Dead (a descriptor for a given individual) into Death (an unique event) by removing duplicates of Mortality =1 once Death has already occurred for that particular individual. I tried out of curiosity with fit=survfit(Surv(Duration, Mortality)~Diet, data=surv) , and it runs without complaints, but the counts are broken: it seems that each individual is counted multiple times (once per time-point), resulting in a n.risk much higher than my actual sample size; see the summary output with my actual data below: Call: survfit(formula = Surv(Duration, Mortality) ~ Diet, data = surv) Diet=A time n.risk n.event survival std.err lower 95% CI upper 95% CI 11 2556 114 0.9554 0.00408 0.9474 0.9634 15 2336 134 0.9006 0.00600 0.8889 0.9124 18 2116 95 0.8602 0.00702 0.8465 0.8740 22 1976 146 0.7966 0.00824 0.7806 0.8129 25 1756 150 0.7286 0.00922 0.7107 0.7469 28 1540 160 0.6529 0.01002 0.6335 0.6728 30 1320 165 0.5713 0.01059 0.5509 0.5924 32 1100 170 0.4830 0.01090 0.4621 0.5048 36 880 174 0.3875 0.01089 0.3667 0.4094 39 660 175 0.2847 0.01041 0.2650 0.3059 42 440 179 0.1689 0.00909 0.1520 0.1877 59 [220] 180 0.0307 0.00469 0.0228 0.0414 Diet=B time n.risk n.event survival std.err lower 95% CI upper 95% CI 9 2688 190 0.929 0.00494 0.91968 0.9391 16 2464 198 0.855 0.00682 0.84137 0.8681 18 2240 198 0.779 0.00806 0.76345 0.7951 22 2016 199 0.702 0.00892 0.68492 0.7199 25 1792 199 0.624 0.00949 0.60589 0.6431 28 1568 201 0.544 0.00981 0.52531 0.5638 30 1344 201 0.463 0.00988 0.44384 0.4826 32 1120 201 0.380 0.00969 0.36123 0.3992 36 896 202 0.294 0.00919 0.27667 0.3127 39 672 202 0.206 0.00827 0.19014 0.2226 42 448 203 0.113 0.00662 0.10025 0.1263 59 [224] 204 0.010 0.00222 0.00651 0.0155 The values I've put in brackets are my actual number of initial individuals in each Diet, i.e. , the values I should have at time=0. I suspect this is because survfit() assumes death events are recorded, and not dead individuals, but I am not sure how to convert the data to the proper format. I'd be very grateful if someone could give me any pointers on how to do that without re-typing the raw data accordingly.
