[site]: crossvalidated
[post_id]: 601104
[parent_id]: 600783
[tags]: 
There are a few things wrong here: I'd fit this with the tw() family using gam() not gamm() . You have some 0s, and these aren't allowed in the Gamma family so you are adding 1 to your response, but I don't see any reason why you need to use gamm() here. Better, assuming you have the effort , variable would be to model these as actual counts with poisson() or nb() families and include the effort via an offset term - add + offset(log(effort)) to your model formula, where effort is the variable that normalises the counts to catch per unit effort. Absent that variable, the tw() is the best option. You are computing the confidence interval ( upper_2se etc) using predictions from the response scale and that is incorrect: as your plot shows, the interval contains negative values which just doesn't make sense. instead, use type = "link" when predicting, and then form the confidence interval as you do it now, but then backtransform the upper and lower limits and the fitted values to the response scale using the inverse of the link function (in all the cases mentioned — Gamma , tw , nb poisson — the link function is log() , so you'd want exp() for the inverse. That way you'll get a confidence interval that respects the properties of the data. I'd compute the derivative over a much finer grid than you do — you are estimating the derivative over a very small interval around the integer year values. This is actually causing you some problems as shown in the last plot; each of the blue spikes should be associated with a red decrease, but because of the crude grid of points you are evaluating the derivative at, you simply aren't seeing the significant decreases. That last red section is also likely spurious. If you want an instantaneous measure of the derivative you should do like you do when you plot the smooth and do it for a finer grid, say 100-200 points over the range min(year) to max(year) with seq(min(year), max(year), length = 200) say. Or, if you want the derivative over the entire year (?) you would have to increase eps to be some much larger value, like 1 , and I would suggest you do a central derivative so you aren't extrapolating too much beyond the start/end of the time series. Remember these are derivatives on the link (log) scale; they aren't response level changes. Response derivatives is a bit more involved but should be in {gratia} in a few weeks. I'll try to work up a full example from your data, but I also have some questions which I'll post as comments first. Consider this a WIP.
