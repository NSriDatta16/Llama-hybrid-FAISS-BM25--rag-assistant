[site]: crossvalidated
[post_id]: 574846
[parent_id]: 
[tags]: 
How to deal with ragged power curve

I am exploring various methods for sample size calculation and power analysis from binomial data, and frequently coming up against ragged power curves that go up and down as sample size increases. I know this is to be expected when the parameter space is discontinuous, but my question is how to deal with this situation in practice? For example, let's say I'm investigating if disease prevalence in my study area is greater than 5%, and I'm doing sample size calculations under the assumption that it is actually $p = 10\%$ . I will take a sample of size $n$ , and assume my observed count, $k$ , is $\mathcal{Binomial}(n, p)$ . If the observed proportion $k/n$ is greater than $5\%$ then I will reject the null hypothesis. I can calculate power for a given $n$ by summing the binomial distribution over all $k$ such that $k/n > 5\%$ . R code to implement this and the power curve produced is shown below. I'm aiming for 80% power. This study has $\text{power} > 80\%$ for sample sizes of $n=16:19$ , but then drops below this threshold at $n=20:28$ . There may be some dropout from my study, so I need to buffer for this effect. Let's say I choose a sample size of $n=30$ , which has $\text{power} > 80\%$ . If two people drop out from my study then power drops below my target ...but if another 9 people drop out then my power recovers! So I guess my minimum sample size should be the point at which the curve no longer bounces below the threshold, i.e. $n=42$ in this case? But obviously the points of discontinuity will be very sensitive to assumed true prevalence (i.e. 10%), should I explore a range of values here? More generally, are there standard approaches to deal with this situation? # set parameters to explore p_thresh p_thresh)) # power = probability of estimating prevalence above threshold } # plot power curve plot(n_vec, beta, xlab = "sample size", ylab = "power", ylim = c(0, 1), type = "o", pch = 20) abline(h = 0.8, lty = 2)
