[site]: stackoverflow
[post_id]: 275288
[parent_id]: 274375
[tags]: 
If you want to go the sniffer way, it might be easier to use tcpflow instead of tcpdump or libpcap. tcpflow will only output TCP payload so you don't need to care about reassembling the data stream yourself. If you prefer using a library instead of gluing a bunch of programs together you might be interested in libnids. libnids and tcpflow are also available on other Unix flavours and do not restrict you to just Linux (contrarily to iptables). http://www.circlemud.org/~jelson/software/tcpflow/ http://libnids.sourceforge.net/
