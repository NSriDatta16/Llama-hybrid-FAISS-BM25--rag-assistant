[site]: stackoverflow
[post_id]: 1086814
[parent_id]: 
[tags]: 
Opening OLE Compound Documents read-only with StgOpenStorage

I'm using the StgOpenStorage API under XP to read an OLE Compound Document, but I can't find the right mix of flags to tell Windows that I need just to read the file without blocking access to it to any other process... Right now I'm using STGM_READ | STGM_EXCLUSIVE but obviously if at the same time I try to open the file from another application, it complains about denied access.. So I tried with STGM_READ | STGM_SHARE_DENY_NONE but it complains about invalid flags.. Is there a way to do this? Am I going the wrong way? Thanks in advance! (I'm calling the API from Python via pythoncom, if it's relevant)
