[site]: stackoverflow
[post_id]: 2793076
[parent_id]: 2793041
[tags]: 
Call pcap_breakloop() in your pcap_handler (you've named it packet_handler in your example). The call to pcap_loop() will then return -2 . Alternatively, make repeated calls to pcap_dispatch() until you're done, or specify a nonzero value for count to handle that number of packets before returning.
