[site]: crossvalidated
[post_id]: 396858
[parent_id]: 
[tags]: 
How to build a LME with nested random effects? A study with a very comlicated experimental design

I am trying to analyse the data on the climbing behaviour of flies. The design of the experiment was rather complicated, so I am currently struggling to build a propper LME model. The flies have been tested in 3 tubes ( 10 flies per tube ) for 30 seconds ( 300 frames ) 5 times ( 5 trials ). This test was repeated 5 times ( 5 blocks ) for 4 conditions with 2 Exposures per condition (Sham/Exposed) with different flies. Since we could not track single flies individually, I took the average position of 10 flies in tubes over time. The total amount of biological replicates (tubes with different flies) was: 4 conditions * 2 Exposures * 5 blocks * 3 tubes = 120 individual tubes df $ID=interaction(df$ cond, df $Exposure, df$ tube, df$block)# provides unique ID for each individual tube We want to check for an effect of Exposure*condition on the average climbing height ( Ycm ): fixed = Ycm ~ cond*Exposure The problem is with the random part of this model, since we have a lot of data, but most of them come from pseudoreplicates of the same individuals: 5 trials * 300 frames . We decided not to use random intercept and slope model, because climbing is not linear. Instead we try to make an intercept model with nested random effects. fly.lme = lmerTest::lmer(Ycm ~ Exposure*cond + (1|ID/trial/frame), data=df,na.action=na.exclude) But this model gives an error message Error: number of levels of each grouping factor must be . It is a bit strange, because we have 15 independent tubes per Exposure*condition. To avoid this problem I tried to change the random structure of the model: fly.lme.new = lmerTest::lmer(Ycm ~ Exposure*cond + (1|ID) + (1|trial/frame), data=df,na.action=na.exclude) summary(fly.lme.new) "Linear mixed model fit by REML. t-tests use Satterthwaite's method ['lmerModLmerTest'] Formula: Ycm ~ Exposure * cond + (1 | ID) + (1 | trial/framecor) Data: cmaver REML criterion at convergence: 592093.7 Scaled residuals: Min 1Q Median 3Q Max -8.2787 -0.6177 0.0498 0.6695 8.0832 Random effects: Groups Name Variance Std.Dev. framecor:trial (Intercept) 17.7442 4.2124 ID (Intercept) 0.7479 0.8648 trial (Intercept) 0.1425 0.3774 Residual 1.5627 1.2501 Number of obs: 176742, groups: frame:trial, 1505; ID, 120; trial, 5 Fixed effects: Estimate Std. Error df t value Pr(>|t|) (Intercept) 10.74801 0.30036 19.00000 35.784 F) Exposure 5.7115 5.7115 1 111.99 3.6548 0.05846 . cond 7.4426 2.4809 3 111.99 1.5875 0.19639 Exposure:cond 1.2077 0.4026 3 111.99 0.2576 0.85577 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1" This gives the expected outcome, but I wonder if this random structure is valid, because I thought that trials and frames should be also nested within individual tubes. Can I somehow check whether the DenDF of this model make sense or not? I would really appreciate your opinion/suggestions.
