[site]: stackoverflow
[post_id]: 4564628
[parent_id]: 2247140
[tags]: 
A quick example using Scapy, since I just wrote one: pkts = rdpcap('packets.pcap') ports = [80, 25] filtered = (pkt for pkt in pkts if TCP in pkt and (pkt[TCP].sport in ports or pkt[TCP].dport in ports)) wrpcap('filtered.pcap', filtered) That will filter out packets that are neither HTTP nor SMTP. If you want all the packets but HTTP and SMTP, the third line should be: filtered = (pkt for pkt in pkts if not (TCP in pkt and (pkt[TCP].sport in ports or pkt[TCP].dport in ports))) wrpcap('filtered.pcap', filtered)
