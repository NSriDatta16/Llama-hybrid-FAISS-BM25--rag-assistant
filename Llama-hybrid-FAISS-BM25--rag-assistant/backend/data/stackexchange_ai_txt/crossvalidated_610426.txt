[site]: crossvalidated
[post_id]: 610426
[parent_id]: 
[tags]: 
Posterior predictive distribution for Bernoulli (and categorical)

I'm trying to confirm something I've tried to figure out about the posterior predictive distribution for Bernoulli vs. Binomial (and categorical vs. multinomial) random variables after a Bayesian analysis with a conjugate prior. Let's say I have this situation: There's a process that involves yes/no classification and a-priori I had a $\text{Beta}(a,b)$ prior for the probability $\pi_\text{yes}$ of a yes classification. After seeing $n_\text{yes}$ yeses and $n_\text{no}$ nos out of $n$ classfications, I have a $\text{Beta}(a + n_\text{yes},b + n_\text{no})$ posterior for $\pi_\text{yes}$ . This posterior has an expected value (mean) of $\frac{a + n_\text{yes}}{a + b + n}$ . Now, I have $m$ new items that need classification. I know that the distribution of the yeses given our updated belief follows a $\text{beta-binomial}(m, a + n_\text{yes},b + n_\text{no})$ distribution. However, I'm interested in simulating out what happens to each individual item as part of a larger prediction problem, where you then do subsequent steps afterwards. The marginal posterior predictive distribution of each Bernoulli trial is just a $\text{Bernoulli}(\frac{a + n_\text{yes}}{a + b + n})$ . If I draw each individual item's classification from this Bernoulli, the overall mean of the predicted total number remains unchanged ( $\frac{a + n_\text{yes}}{a + b + n}$ ), but the variance is wrong (i.e. we simulated effectively from a Binomial not a Beta-Binomial), right? I assume the answer is that if I want 100 simulated datasets, I should first draw a single proportion $\pi_j$ for each dataset $j=1,\ldots,100$ and then simulate each Bernoulli trial in that dataset from a $\text{Bernoulli}(\pi_j)$ . Is that correct? I assume the same would apply when there's more than two categories (and we have a Dirichlet prior and want to then simulate individual categorical random variables), because otherwise we would not match the Dirichlet-Multinomial for the overall outcomes.
