[site]: stackoverflow
[post_id]: 1883579
[parent_id]: 1874851
[tags]: 
Here's what I generally do in my image models. Perhaps it will help: I use IM's -auto-orient option when converting. This ensures images are always rotated properly after upload I read the EXIF data after processing and get the width and height (among other things) You can then just have an instance method that outputs an orientation string based on width and height has_attached_file :attachment, :styles => { :large => "900x600>", :medium => "600x400>", :square => "100x100#", :small => "300x200>" }, :convert_options => { :all => '-auto-orient' }, :storage => :s3, :s3_credentials => "#{RAILS_ROOT}/config/s3.yml", :s3_permissions => 'public-read', :s3_protocol => 'https', :path => "images/:id_partition/:basename_:style.:extension" after_attachment_post_process :post_process_photo def post_process_photo imgfile = EXIFR::JPEG.new(attachment.queued_for_write[:original].path) return unless imgfile self.width = imgfile.width self.height = imgfile.height self.model = imgfile.model self.date_time = imgfile.date_time self.exposure_time = imgfile.exposure_time.to_s self.f_number = imgfile.f_number.to_f self.focal_length = imgfile.focal_length.to_s self.description = imgfile.image_description end
