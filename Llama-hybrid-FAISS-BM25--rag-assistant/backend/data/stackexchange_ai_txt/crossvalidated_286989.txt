[site]: crossvalidated
[post_id]: 286989
[parent_id]: 
[tags]: 
Bayesian test on Poisson Distribution

$\newcommand{\Po}{\operatorname{Poisson}}$I have $X$ the observed count, and $\theta_0$ the expected count. For instance $X=20$ and $\theta_0=9.8$. To compute the p-value, I just need to compute: $P(X \geq x)=\sum_{i=x}^\infty \Po(i\mid\theta_0)$ with $H_0:\theta = \theta_0$ and $H_1:\theta > \theta_0$. I get : ppois(20,9.8,lower.tail=F) [1] 0.00125043 Now I want to use a Bayesian approach because I know the prior probability of $H_1$, $P(H_1)$. I have no prior information regarding the shape/parameters of the distribution of $\theta$, $P(\theta)$. Maybe a uniform prior on $[0,a]$. By the way, I have no idea how to determine $a$. I would like to compute the Bayes factor and the posterior probability $P(H_1 \mid X)$. I think the key is to compute the marginal likelihood $\int_0^\infty \Po(X\mid\theta) P(\theta)\,d\theta$, which can be used to compute the Bayes Factor: $$BF=\frac{\Po(X\mid\theta_0)}{\int_0^\infty \Po(X\mid\theta) P(\theta) \, d\theta}$$ I know I can use the gamma distribution as prior conjugate, but I don't know more details. How to do it? Is there any close form solution. If yes what is it? Do you have any example in R? Thanks!
