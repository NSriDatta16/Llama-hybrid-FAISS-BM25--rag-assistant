[site]: crossvalidated
[post_id]: 95839
[parent_id]: 
[tags]: 
Gini decrease and Gini impurity of children nodes

I'm working on the Gini feature importance measure for random forest. Therefore, I need to calculate the Gini decrease in node impurity. Here is the way I do so, which leads to a conflict with the definition, suggesting that I must be wrong somewhere... :) For a binary tree, and given the probabilities of left and right children, I can calculate the Gini impurity of a node $n$: $$ i(n) = 1 - p_l^2 - p_r^2$$ And the Gini decrease: $$ \Delta i(n) = i(n) - p_li(n_l) - p_ri(n_r) $$ So, for this example with 110 observations on a node: - node (110) - left (100) - left_left (60) - left_right (40) - right (10) - right_left (5) - right_right (5) I would calculate the Gini decrease for node like this : \begin{align} i({\rm left}) &= 1 - (60/100)^² - (40/100)^²& &= 0.48 \\ i({\rm right}) &= 1 - (5/10)^² - (5/10)^²& &= 0.50 \\ i({\rm node}) &= 1 - (100/110)^² - (10/110)^²& &= 0.16 \end{align} But following the Breiman definition (or this answer on CV: How to measure / rank "variable importance" when using CART , but I don't have access to the referenced book), the impurity criterion of the descendent should be less than the parent node: Gini importance Every time a split of a node is made on variable m the gini impurity criterion for the two descendent nodes is less than the parent node. Adding up the gini decreases for each individual variable over all trees in the forest gives a fast variable importance that is often very consistent with the permutation importance measure. Because otherwise, it leads to negative Gini decrease... $$\Delta i({\rm node}) = i({\rm node}) - (100/110)*i({\rm left}) - (10/110)*i({\rm right}) = -0.32$$ So, if someone could tell where I'm wrong, I would be very grateful because it looks like I miss something evident here...
