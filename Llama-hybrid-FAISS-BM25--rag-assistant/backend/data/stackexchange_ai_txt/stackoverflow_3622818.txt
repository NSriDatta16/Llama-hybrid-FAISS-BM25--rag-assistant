[site]: stackoverflow
[post_id]: 3622818
[parent_id]: 
[tags]: 
IE's document.selection.createRange doesn't include leading or trailing blank lines

I'm trying to extract the exact selection and cursor location from a textarea. As usual, what's easy in most browsers is not in IE. I'm using this: var sel=document.selection.createRange(); var temp=sel.duplicate(); temp.moveToElementText(textarea); temp.setEndPoint("EndToEnd", sel); selectionEnd = temp.text.length; selectionStart = selectionEnd - sel.text.length; Which works 99% of the time. The problem is that TextRange.text doesn't return leading or trailing new line characters. So when the cursor is a couple of blank lines after a paragraph it yields a position at the end of the preceeding paragraph - rather than the actual cursor position. eg: the quick brown fox| The only fix I can think of is to temporarily insert a character before and after the selection, grab the actual selection and then remove those temp characters again. It's a hack but in a quick experiment looks like it will work. But first I'd like to be sure there's not an easier way.
