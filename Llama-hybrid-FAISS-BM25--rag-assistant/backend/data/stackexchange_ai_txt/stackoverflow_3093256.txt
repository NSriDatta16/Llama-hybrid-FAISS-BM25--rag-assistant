[site]: stackoverflow
[post_id]: 3093256
[parent_id]: 2366851
[tags]: 
Here's my method for parsing an HTML file and creating a PDF/A archive document from it, also with embedding fonts by using a stylesheet (in order to avoid the error: "All the fonts must be embedded. This one isn't: Helvetica") Hope this helps someone.. using System; using System.Collections.Generic; using System.Linq; using System.Text; using iTextSharp.text.pdf; using iTextSharp.text; using System.IO; using iTextSharp.text.html.simpleparser; namespace SaveAsPDF { class HtmlPdfConverter { public void RendererWebForm2PDFArchive(string fileName) { Console.WriteLine("Parsing HTML " + fileName); Document document = new Document(PageSize.A4); try { // we create a writer that listens to the document and directs a XML-stream to a file PdfWriter writer = PdfWriter.GetInstance(document, new FileStream(fileName + ".pdf", FileMode.Create)); //set document as arhive writer.PDFXConformance = PdfWriter.PDFA1A; document.Open(); //apply stylesheet to change font (and embedd it) StyleSheet styles = new StyleSheet(); FontFactory.Register("c:\\windows\\fonts\\verdana.ttf"); styles.LoadTagStyle("body", "face", "Verdana"); //prepare html StreamReader sr = new StreamReader(fileName, Encoding.Default); string html = sr.ReadToEnd(); html = RemoveTag(html, " ", " "); //convert string to stream byte[] byteArray = Encoding.UTF8.GetBytes(html); MemoryStream ms = new MemoryStream(byteArray); //parse html HTMLWorker htmlWorker = new HTMLWorker(document); System.Collections.Generic.List elements; elements = HTMLWorker.ParseToList(new StreamReader(ms), styles); foreach (IElement item in elements) { document.Add(item); } writer.CreateXmpMetadata(); document.Close(); Console.WriteLine("Done"); } catch (Exception e) { Console.Error.WriteLine(e.Message); Console.Error.WriteLine(e.StackTrace); } }**strong text**
