[site]: stackoverflow
[post_id]: 2225044
[parent_id]: 
[tags]: 
Rails custom validations with multi-model forms

I'm having problems with my rails custom validations. def validates_hsp_program(*attr_names) options = attr_names.extract_options! regex = '^(' err = '' $CetConfig.program.each do |key, val| regex The problem is that for debugging purposes I added exit 1 as I wasn't getting the error message for invalid date for that field. However, it never exits. This is the same thing I do in all my other custom validators. The only difference I can see is that this one is the second model of a multi-model form and all the others are on the first model... What am I doing wrong? My Model class ProfileProgram "STUDENT_ID", :foreign_key => "STUDENT_ID" validates_presence_of :program validates_hsp_program :program end Action from my controller def create @pc = ProfileCore.new(params[:profile_core]) @pp = ProfileProgram.new(params[:profile_program]) @pc.student_type = $CetConfig.student_type.application @pc.AGENT_ID = current_agents_staff.AGENT_ID year = @pc.contract.to_s case @pp.program when 10 then sd = year + '-09-01' ed = year + '-06-30' when 51 then sd = year + '-08-15' ed = year + '-06-30' when 52 then sd = year + '-01-15' ed = year + '-06-30' when 12 then sd = year + '-01-15' ed = year + '-01-14' else sd = nil ed = nil end @pc.start_date = Date.parse(sd) unless sd.nil? @pc.end_date = Date.parse(ed) unless ed.nil? @pc.program_status = $CetConfig.student_status.apply if @pc.valid? and @pp.valid? ProfileCore.transaction do @pc.save! @pp.save! end redirect_to(students_path(@pc.STUDENT_ID)) else render :action => 'new' end end My view (element_block is a helper that just stuffs the label and field into the right tags for the dl) { :controller => 'core', :action => 'create'} do |f| %> [ @pc, @pp ] %> 'datepicker') %> 'datepicker', :id => "student_birth_date") %>
