[site]: crossvalidated
[post_id]: 522797
[parent_id]: 522789
[tags]: 
The (Aalen-Breslow) estimator of the baseline cumulative hazard is $$\hat\Lambda_0(t)=\sum_{s\leq t} \frac{dN(s)}{\sum_{i}Y_i(s)\exp(Z_i(s)\beta)}$$ where $dN(s)$ is the number of deaths at time $s$ , $Y_i(s)$ is 1 if individual $s$ is under observation at time $s$ , and $Z_i(s)$ is the covariate vector for individual $i$ at time $s$ . The sum is over times that an event occurs, because $dN$ is zero at other times Heuristically (according to Breslow), it comes from Aalen's cumulative hazard estimator $$\hat\Lambda(t)=\sum_{s\leq t} \frac{dN(s)}{\sum_{i}Y_i(s)}$$ but in the Cox model each individual contributes $e^{Z\beta}$ rather than 1 to the denominator. In fact, what's used in the computation is the increments of $\hat\Lambda$ $$d\hat\Lambda_0(t)=\frac{dN(s)}{\sum_{i}Y_i(s)\exp(Z_i(s)\beta)}$$ The survival for individuals is estimated by first computing the cumulative hazard for individuals $$\Lambda(t;z)=\sum_{s\leq t} \exp(Z_i(s)\beta)\, d\hat\Lambda_0(t)$$ and then using $S(t)=e^{-\Lambda(t)}$ . Finally, if you want the predicted survival curve for a cohort, you compute $S(t;z)$ for each individual and then average them. As you note, this is not the same as the survival curve for an average individual, though in practice the difference is typically not all that big.
