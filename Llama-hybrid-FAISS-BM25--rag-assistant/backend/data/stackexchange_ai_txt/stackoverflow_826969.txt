[site]: stackoverflow
[post_id]: 826969
[parent_id]: 823635
[tags]: 
Do you need to use a function? Can you re-write the entire thing into a stored procedure in which you pass in the @ID as a parameter. Even if your table has indexes because you pass the @ID as a variable to the WHERE clause potentially greatly increasing the amount of time for the query to run. The reason the indexes may not be used is because the Query Analyzer does not know the value of the variables when it selects an access method to perform the query. Because this is a batch file, only one pass is made of the Transact-SQL code, preventing the Query Optimizer from knowing what it needs to know in order to select an access method that uses the indexes. You might want to consider an INDEX query hint if you cannot re-write the SQL. it might also be possible, since this just started happening, that the INDEXes have become fragmented and might need to be rebuilt.
