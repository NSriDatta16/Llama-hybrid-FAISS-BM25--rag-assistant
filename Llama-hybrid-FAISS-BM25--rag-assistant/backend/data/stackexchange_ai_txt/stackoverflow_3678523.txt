[site]: stackoverflow
[post_id]: 3678523
[parent_id]: 3678497
[tags]: 
You can add the marks for each user then divide by the number of columns: SELECT user, (test1 + test2 + test3) / 3 AS average_mark FROM users Or to ignore NULL values: SELECT user, (ISNULL(test1, 0) + ISNULL(test2, 0) + ISNULL(test3, 0)) / ( CASE WHEN test1 IS NULL THEN 0 ELSE 1 END + CASE WHEN test2 IS NULL THEN 0 ELSE 1 END + CASE WHEN test3 IS NULL THEN 0 ELSE 1 END ) AS average_mark FROM users Your table structure has two disadvantages: Because your table structure is created dynamically you would also have to construct this query dynamically. Because some students will not have taken all tests yo may have some NULL values. You may want to consider changing your table structure to fix both of these problems. I would suggest that you use the following structure for your table: user test mark ------------------- A1 1 10 A2 1 90 A3 1 78 A1 2 20 A2 2 87 A3 2 12 A1 3 30 A2 3 75 A3 3 34 Then you can do this to get the average mark per user: SELECT user, AVG(mark) AS average_mark FROM users GROUP BY user And this to get the average mark per test: SELECT test, AVG(mark) AS average_mark FROM users GROUP BY test
