[site]: stackoverflow
[post_id]: 486521
[parent_id]: 255171
[tags]: 
I had a similar issue when some XML fragments were imported into a CRM system using the wrong encoding (there was no encoding stored along with the XML fragments). In a loop I created a wrapper stream using the current encoding from a list. The encoding was constructed using the DecoderExceptionFallback and EncoderExceptionFallback options (as mentioned by @Doug). If a DecoderFallbackException was thrown during processing the original stream is reset and the next-most-likely encoding is used. Our encoding list was something like UTF-8, Windows-1252, GB-2312 and US-ASCII. If you fell off the end of the list then the stream was really bad and was rejected/ignored/etc. EDIT: I whipped up a quick sample and basic test files (source here ). The code doesn't have any heuristics to choose between code pages that both match the same set of bytes, so a Windows-1252 file may be detected as GB2312, and vice-versa, depending on file content, and encoding preference ordering.
