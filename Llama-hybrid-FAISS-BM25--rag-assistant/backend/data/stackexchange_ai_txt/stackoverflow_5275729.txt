[site]: stackoverflow
[post_id]: 5275729
[parent_id]: 
[tags]: 
C# DoDragDrop on Non-Serializable object

I have a UserControl that can be dragged around my form. I get a first chance exception when the control is accidentally dragged away from my form and into the desktop (as an example): A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in System.Windows.Forms.dll Additional information: Invalid FORMATETC structure (Exception from HRESULT: 0x80040064 (DV_E_FORMATETC)) When I start the drag/drop process, I pass in an object of type Control. It is not Serializable nor do I want it to be. Is there a way I can work around this or is there handling for dragging an object outside the host form? Callstack: > System.Windows.Forms.dll!System.Windows.Forms.DataObject.GetDataIntoOleStructs(ref System.Runtime.InteropServices.ComTypes.FORMATETC formatetc, ref System.Runtime.InteropServices.ComTypes.STGMEDIUM medium) + 0x175 bytes System.Windows.Forms.dll!System.Windows.Forms.DataObject.System.Runtime.InteropServices.ComTypes.IDataObject.GetDataHere(ref System.Runtime.InteropServices.ComTypes.FORMATETC formatetc, ref System.Runtime.InteropServices.ComTypes.STGMEDIUM medium) + 0x70 bytes System.Windows.Forms.dll!System.Windows.Forms.DataObject.System.Runtime.InteropServices.ComTypes.IDataObject.GetData(ref System.Runtime.InteropServices.ComTypes.FORMATETC formatetc, out System.Runtime.InteropServices.ComTypes.STGMEDIUM medium) + 0x152 bytes [Native to Managed Transition] Here is another stack, but VS2010 hung so I couldn't copy and paste it.
