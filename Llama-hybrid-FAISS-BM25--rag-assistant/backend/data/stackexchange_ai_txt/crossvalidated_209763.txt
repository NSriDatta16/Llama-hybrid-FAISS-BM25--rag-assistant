[site]: crossvalidated
[post_id]: 209763
[parent_id]: 208580
[tags]: 
Treat it as an optimization problem. What do you want to optimize? You want to merge objects by taking the weighted average, i.e. $z_i=(w_{xi}\cdot x_i+w_{yi}\cdot y_i)/(w_{xi}+w_{yi})$; and $w_{zi}=w_{xi}+w_{yi}$ I assume? Because that will preserve the global averages and weight sum (see comments on the question). So define a criterion on what is a good merge. Absolute error? Squared error? The absolute error is probably smallest by weighted Manhattan distance. The squared error is probably smallest by weighted Euclidean distance. So if you write down your objective, you may directly end up with a distance measure to use. Then you can repeatedly perform the best merge (= single-linkage hierarchical clustering) until the desired number of vectors remain.
