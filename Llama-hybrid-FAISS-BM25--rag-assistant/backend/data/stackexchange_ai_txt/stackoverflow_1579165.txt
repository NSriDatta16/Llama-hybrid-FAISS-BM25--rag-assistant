[site]: stackoverflow
[post_id]: 1579165
[parent_id]: 1560523
[tags]: 
Your problem is called AVERAGE in this paper (1999): A problem is 3SUM-hard if there is a sub-quadratic reduction from the problem 3SUM: Given a set A of n integers, are there elements a,b,c in A such that a+b+c = 0? It is not known whether AVERAGE is 3SUM-hard. However, there is a simple linear-time reduction from AVERAGE to 3SUM, whose description we omit. Wikipedia : When the integers are in the range [âˆ’u ... u], 3SUM can be solved in time O(n + u lg u) by representing S as a bit vector and performing a convolution using FFT. This is enough to solve your problem :). What is very important is that O(n log n) is complexity in terms of number of zeroes and ones, not the count of ones (which could be given as an array, like [1,5,9,15]). Checking if a set has an arithmetic progression, terms of number of 1's, is hard, and according to that paper as of 1999 no faster algorithm than O(n 2 ) is known, and is conjectured that it doesn't exist. Everybody who doesn't take this into account is attempting to solve an open problem. Other interesting info, mostly irrevelant: Lower bound: An easy lower bound is Cantor-like set (numbers 1..3^n-1 not containing 1 in their ternary expansion) - its density is n^(log_3 2) (circa 0.631). So any checking if the set isn't too large, and then checking all pairs is not enough to get O(n log n). You have to investigate the sequence smarter. A better lower bound is quoted here - it's n 1-c/(log(n))^(1/2) . This means Cantor set is not optimal. Upper bound - my old algorithm: It is known that for large n, a subset of {1,2,...,n} not containing arithmetic progression has at most n/(log n)^(1/20) elements. The paper On triples in arithmetic progression proves more: the set cannot contain more than n * 2 28 * (log log n / log n) 1/2 elements. So you could check if that bound is achieved and if not, naively check pairs. This is O(n 2 * log log n / log n) algorithm, faster than O(n 2 ). Unfortunately "On triples..." is on Springer - but the first page is available, and Ben Green's exposition is available here , page 28, theorem 24. By the way, the papers are from 1999 - the same year as the first one I mentioned, so that's probably why the first one doesn't mention that result.
