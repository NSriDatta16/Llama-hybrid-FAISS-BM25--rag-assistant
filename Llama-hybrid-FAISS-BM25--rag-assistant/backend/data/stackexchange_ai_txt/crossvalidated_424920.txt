[site]: crossvalidated
[post_id]: 424920
[parent_id]: 424879
[tags]: 
This is more a hint than a true definitive answer, but I think it may be useful to shed light on a very important point. So let's firstly describe a very simplified approach . A very simplified approach might be to fit an ARIMAX model on each univariate time series of footsteps, where the ext covariates may be the weather (say $\beta_{i}$ is the beta of each individual to the external covariate "weather") and possibly others, and then perform a second-level cross-sectional regression on the $\beta_{i}$ against indivdual-specific independent variables. That would be a very simplified and intuitive two-stage approach. is it wrong? Well it is not wrong per se, the problem is that, however, it is a two-stage procedure and is exposed to the various problems of using a two-stage procedure and a univariate model instead of a one-stage multivariate procedure that may reduce the standard error. So it is a reasonable appraoch, but it is simplified and, as such, it will likely have more standard error because, at each step, it will not necessarily maximize the amount of info used to estimate the coefficients (consider for example the difference between the use of several distinct univariate regressions and the seemingly unrelated regression approach (SUR)). So how to estimate everything in a shot and in a multivariate model? Well here the thing gets a bit complex. I will provide here a suggestion for this more structured solution aimed at introducing this kind of models (then you will be free to visualize the exact specification that best suites your needs). Consider the following MARSS . Go to pag.21 where they show the multivariate version with external covariates for both the $x$ and the $y$ . You will have something like (I simplify the notation a little bit here): $ \begin{matrix} y_t & = & Zx_t + Ad_{t} + \epsilon_{t} \\ x_{t+1} & = & Bx_{t}+ Uc_{t} + u_{t} \end{matrix} $ For visual simplicity, let's now add a lagged term on the right hand side of y, and change the term $Zx_{t}$ into $Z_{t}x_{t}$ , so that Z can be time-varying: $ \begin{matrix} y_t & = & Z_{t}x_{t} + Ad_{t} + \Gamma y_{t-1} + \epsilon_{t} \\ x_{t+1} & = & Bx_{t}+ Uc_{t} + u_{t} \end{matrix} $ where $Z_{t}$ is restricted to be diagonal and stores on its diagonal the weather seen for each individual (if it is the same for everyone, then the entries along the diagonal are constant) at each observed time period t $x_{t}$ is the vector whose i-th entry is the beta of the footsteps of the i-th individual of the vector $y_{t}$ to the weather seen by the corresponding individual (i-th element on the diagonal of $Z_{t}$ for each period t). As you may notice, the weather stored on $Z_{t}$ is treated like an external variable whose value is given for each t (other external common covariates for all the individuals in $y_{t}$ may be stored in the vector $d_{t}$ of the term $Ad_{t}$ ). And clearly you can model the time-varying nature of the coefficients in $x_{t}$ based on their past values (term $Bx_{t}$ ) and even possible external covariates for $x_{t}$ (term $Uc_{t}$ ). For example, one external covariate may be the proximity of the individual to a park, expressed on a ranked basis in comparison to the other individuals in the sample. You can add any covariates here to explore the relationship between those variables and the sensitivity of each individual in $y_{t}$ to the weather in $Z_{t}$ . The unknowns in your model (to be estimated via MLE/EM Algorithm) will be the matrixes of coefficients denoted in capital letters, along with the covariance matrixes of the residual terms $\epsilon_{t}$ and $u_{t}$ . Since you have a lot of parameters, the risk is to overfit. So you can restrict the those matrixes of unknowns to be diagonal to reduce such risks (clearly you are free to play with your model specification and choose the one that best suites your needs). And of course you can use the traditional Information Criteria for State Space Models. See for example here .
