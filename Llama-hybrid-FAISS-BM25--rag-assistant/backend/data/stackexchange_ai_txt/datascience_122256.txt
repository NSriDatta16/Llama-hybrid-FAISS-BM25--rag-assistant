[site]: datascience
[post_id]: 122256
[parent_id]: 122254
[tags]: 
You can't just simply add a non-differentiable element to a computational graph. You may, nevertheless try these far-from-simple approaches: Implement a differentiable version of your simulation. You can then simply use your differentiable simulation as part of your loss. There are multiple precedents for this approach, e.g. this , this and this . Use a score function estimator (also known as REINFORCE). See this answer for more detail and pointers. It is not always easy to make it converge. Use reinforcement learning (RL) approaches, like deep deterministic policy gradient (DDPG) . You usually need a lot of data for RL learning approaches to converge.
