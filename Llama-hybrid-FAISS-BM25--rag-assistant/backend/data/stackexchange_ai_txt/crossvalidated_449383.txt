[site]: crossvalidated
[post_id]: 449383
[parent_id]: 
[tags]: 
Doubts on sum-product algorithm (bayesian networks)

I have studied sum-product algorithm for factor graphs obtained by Bayesian networks (let's say polytree shaped bayesian networks for now), but I have some doubts which I hope you will help me to solve: The algorithm says that once all messages have been sent to a designated root, then the root must send messages to the leaves, but it is not clear for me if the messages which start from the root in this second phase are 1, just like the root was a leaf now, or if they are related to the messages previously received by the root in the first phase. Unluckily I have been able to find only 3 examples of the complete algorithm execution and I have seen an example in which the root starts sending back 1, another example in which it sends back messages previously received, and another one in which the root was a leaf so clearly both interpretation lead to send back 1. Once solved the doubt at point 1, I know how to compute marginals for one variable. It is not clear to me how to compute something like P(X1,X2) or P(X1|X2), where X1 and X2 are two distinct and not directly linked variable nodes of the Bayesian network.
