[site]: stackoverflow
[post_id]: 632890
[parent_id]: 
[tags]: 
Problem with adding custom sql to finder condition

I am trying to add the following custom sql to a finder condition and there is something not quite right.. I am not an sql expert but had this worked out with a friend who is..(yet they are not familiar with rubyonrails or activerecord or finder) status_search = "select p.* from policies p where exists (select 0 from status_changes sc where sc.policy_id = p.id and sc.status_id = '"+search[:status_id].to_s+"' and sc.created_at between "+status_date_start.to_s+" and "+status_date_end.to_s+") or exists (select 0 from status_changes sc where sc.created_at = (select max(sc2.created_at) from status_changes sc2 where sc2.policy_id = p.id and sc2.created_at My find statement: Policy.find(:all,:include=>[{:client=>[:agent,:source_id,:source_code]},{:status_changes=>:status}], :conditions=>[status_search]) and I am getting this error message in my log: ActiveRecord::StatementInvalid (Mysql::Error: Operand should contain 1 column(s): SELECT DISTINCT `policies`.id FROM `policies` LEFT OUTER JOIN `clients` ON `clients`.id = `policies`.client_id WHERE ((((policies.created_at BETWEEN '2009-01-01' AND '2009-03-10' OR policies.created_at = '2009-01-01' OR policies.created_at = '2009-03-10')))) AND (select p.* from policies p where exists (select 0 from status_changes sc where sc.policy_id = p.id and sc.status_id = '2' and sc.created_at between 2009-03-10 and 2009-03-10) or exists (select 0 from status_changes sc where sc.created_at = (select max(sc2.created_at) from status_changes sc2 where sc2.policy_id = p.id and sc2.created_at what is the major malfunction here - why is it complaining about the columns?
