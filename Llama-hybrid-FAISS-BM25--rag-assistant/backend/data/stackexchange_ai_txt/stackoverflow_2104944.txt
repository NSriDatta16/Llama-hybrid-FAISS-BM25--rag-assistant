[site]: stackoverflow
[post_id]: 2104944
[parent_id]: 2104720
[tags]: 
You say you insert a lot of images per day. What else do you do with the images? Do you update them, many reads? Is your file system optimized for FILESTREAMs? How do you read out the images? If you do a lot of updates, remember that SQL Server will not modify the filestream object but create a new one and mark the old for deletion by the garbage collector. At some time the GC will trigger and start cleaning up the old mess. The problem with FILESTREAM is that it doesn't log a lot to the transaction log and thus the GC can be seriously delayed. If this is the problem it might be solved by forcing GC more often to maintain responsiveness. This can be done using the CHECKPOINT statement. UPDATE: You shouldn't use FILESTREAM for small files (less than 1 MB). Millions of small files will cause problems for the filesystem and the Master File Table. Use varbinary in stead. See also Designing and implementing FILESTREAM storage UPDATE 2: If you still insist on using the FILESTREAM for storage (you shouldn't for large amounts of small files), you must at least configure the file system accordingly. Optimize the file system for large amount of small files (use these as tips and make sure you understand what they do before you apply) Change the Master File Table reservation to maximum in registry (FSUTIL.exe behavior set mftzone 4) Disable 8.3 file names (fsutil.exe behavior set disable8dot3 1) Disable last access update(fsutil.exe behavior set disablelastaccess 1) Reboot and create a new partition Format the storage volumes using a block size that will fit most of the files (2k or 4k depending on you image files).
