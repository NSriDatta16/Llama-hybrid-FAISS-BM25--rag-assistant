[site]: stackoverflow
[post_id]: 4858647
[parent_id]: 4858314
[tags]: 
This (data recieved from two different TCP connections is not ordered with respect to each other) is a fundamental property of TCP/IP. You shouldn't try and work around it by clearing the send buffer - this is fragile. Instead, you should fix the application to handle this eventuality at the application layer. For example, if you recieve a new connection on the server side from a client that you believe is already connected, you should probably drop the existing connection. Additionally, step 4 of the process is a bit dubious. Really, you should just wait until TCP reports an error (or an application-level timeout occurs on the connection) - as you've noticed, TCP will recover if the physical disconnection is only a brief one.
