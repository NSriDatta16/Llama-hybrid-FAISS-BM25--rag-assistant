[site]: crossvalidated
[post_id]: 469741
[parent_id]: 469615
[tags]: 
The posterior should be $$f(\rho | \{(x_i,y_i)\}_{i=1}^{n}) \propto \frac{1}{{(1-\rho^2})^{n+1/2}} \exp\left(\frac{-1}{2(1-\rho^2)}\sum_{i=1}^n[x_i^2 -2\rho x_iy_i+y_i^2]\right)$$ and the part $(1-\rho^2)^{n}$ is missing from the likelihood ratio in the R code. The proposal being $\mathrm{Unif} (\rho_n-0.1, \rho_n + 0.1)$ , there is a positive probability that the simulated value stands outside $(-1,1)$ for values of $\rho_{n}$ close enough to $\pm 1$ . The target density in the R code should therefore be set to zero outside $(-1,1)$ to accommodate such entries. There is thus an issue with the likelihood function as coded since, if I use instead library(mvtnorm) l_ratio I recover an MCMC sample converging to the generating value of $\rho$ . In the R code provided in the question, it should be l_ratio
