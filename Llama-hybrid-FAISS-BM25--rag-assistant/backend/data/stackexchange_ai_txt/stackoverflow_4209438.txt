[site]: stackoverflow
[post_id]: 4209438
[parent_id]: 
[tags]: 
How to Pivot/Unpivot Something with SQL2000

I'm querying a table which essentially a bunch of dates. FRECDCUST DTRECDCUST DTINSPECTED DTRECDCUSTPO DTADDEDSO DTSHIPPEDSUP DTQUOTEDCUST 1/1/1900 12:00:00 AM 7/27/2010 12:00:00 AM 7/30/2010 12:00:00 AM 7/26/2010 12:00:00 AM 8/6/2010 12:00:00 AM 1/1/1900 12:00:00 AM 8/6/2010 12:00:00 AM 1/1/1900 12:00:00 AM 7/27/2010 12:00:00 AM 7/30/2010 12:00:00 AM 7/26/2010 12:00:00 AM 8/6/2010 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 1/1/1900 12:00:00 AM 3/12/2010 12:00:00 AM 3/15/2010 12:00:00 AM 3/11/2010 12:00:00 AM 3/16/2010 12:00:00 AM 3/24/2010 12:00:00 AM 4/13/2010 12:00:00 AM 1/1/1900 12:00:00 AM 11/6/2009 12:00:00 AM 11/6/2009 12:00:00 AM 11/3/2009 12:00:00 AM 11/9/2009 12:00:00 AM 11/20/2009 12:00:00 AM 12/7/2009 12:00:00 AM I am taking the date difference between two dates on each line. For example, the days to inspect is found like this: SELECT (CASE WHEN year(SYC_ext.DTRECDCUST) <> 1900 AND year(SYC_ext.DTINSPECTED) <> 1900 THEN DATEDIFF(dd, SYC_ext.DTRECDCUST, SYC_ext.DTINSPECTED) ELSE NULL END) AS [AverageDaystoInspect] Blah blah... This creates a row of different DateDiff calcuations which end up looking like this: Product Class Average Days to Inspect Average Days to Process SO Average Days to Ship to Affiliate Average Days to Quote Average Days to Receive Ammended PO 01 2 4 8 27 21 01 2 4 8 27 21 01 3 5 2 88 8 01 3 5 2 88 8 01 1 8 11 72 1 01 3 2 7 27 0 01 5 2 7 27 0 Please forgive the spacing problems. So, each of these rows in the data set starts with a number which represents a product category in this case 01 and is followed by a series of day calculations. I can average these values and give you an average for each category per product class. However, they want the day calculations along the left side of a table or matrix with the product classes along the top, exactly opposite of what I have here. If I pivot them in Excel, I get the following: 01 05 10 Avg Days to Inspect 5 3 5 Avg Days to Process PO 4 5 5 Avg Days to Ship 20 18 19 I hope this makes sense. Any idea how I can perform this in SSRS or t-sql?
