[site]: crossvalidated
[post_id]: 577350
[parent_id]: 
[tags]: 
Product of kernels vs Composition of kernels

According to Wikipedia there are two main operations between two kernels: product and composition. They look almost identical to me and I cannot figure out what's the intuition between these different operations. All kernels below are s-finite, $(S, \mathcal{S})$ , $(T, \mathcal{T})$ and $(U, \mathcal{U})$ are measurable spaces, and $(S\times T, \mathcal{S}\otimes\mathcal{T})$ and $(T\times U, \mathcal{T}\otimes\mathcal{U})$ are product measurable spaces. Product of Kernels The product of two kernels $k^1:S\times\mathcal{T}\to[0, +\infty)$ and $k^2: (S\times T)\times \mathcal{U}\to[0, +\infty)$ is a third kernel $k^\otimes:S\times(\mathcal{T}\otimes\mathcal{U})\to[0, +\infty)$ such that $$ k^\otimes(s, A) = \int_A k^1(s, dt) k^2((s, t), du) \qquad\qquad \forall\, s\in S,\, \forall\, A\in\mathcal{T}\otimes\mathcal{U}. $$ Composition of Kernels The composition of two kernels $k^1:S\times\mathcal{T}\to[0, +\infty)$ and $k^2:(S\times T)\times \mathcal{U}\to[0,+\infty)$ is a third kernel $k^\circ: S\times\mathcal{U}\to[0, +\infty)$ such that $$ k^\circ(s, B) = \int_{T\times B} k^1(s, dt) k^2((s, t), du) $$ Comments I cannot seem to get any intuition about these operations and how they relate to one another. Typically when talking about the composition of functions, we start with $f:X\to Y$ and $g:Y \to Z$ and compose them to obtain $h:X\to Z$ such that $h(x) = g(f(x))$ . That is, the composition "glues together" the domain of the domain of the second function with the codomain of the first function (in this case $Y$ ). Now this does not seem to be what is meant here for composition of kernels because the codomain of $k^1$ is $[0, +\infty)$ while the domain of $k^2$ is $(S\times T)\times \mathcal{U}$ . It seems to me that here we are composing the kernels in their domain spaces. Even then, to me it would seem logical to define the composition as follows: Given $k^1:S\times\mathcal{T}\to[0, +\infty)$ and $k^2:T\times\mathcal{U}\to[0, +\infty)$ their composition is $k^3:S\times\mathcal{U}\to[0, +\infty)$ . Now, in the usual composition between functions we say $h(x) = g(f(x))$ but here this doesn't make much sense, especially since $k^1$ works on a set $dt \in\mathcal{T}$ while $k^2$ works on an element $t\in T$ . It makes sense to therefore define the operation under the integral sign, to average over all possible moves in $T$ $$ k^3(s, B) = \int_B\int_T k^1(s, dt) k^2(t, du) \qquad\forall s\in S,\, \forall B\in\mathcal{U}. $$ Given $s\in S$ , $k^1(s, dt)$ gives the "probability" (if it's a probability kernel) of moving from $s$ to $dt\in T$ for any $dt\subseteq T$ . Then $k^2(t, du)$ gives the probability of jumping from whatever element $t\in dt$ to an element $u\in B$ . This of course only makes sense if $dt$ is a measurable set, that is $dt\in\mathcal{T}$ . Therefore for the definition above to make sense, one needs to work with measurable rectangles $A\times B$ where $A\in\mathcal{T}$ and $B\in\mathcal{U}$ , or equivalently $A\times B \in \mathcal{T}\otimes\mathcal{U}$ . This gives $$ k^3(s, B) = \int_B\int_{A\in\mathcal{T}} k^1(s, dt) k^2(t, du) \qquad\forall s\in S,\, \forall B\in\mathcal{U}. $$ This seems very arbitrary because one would need to choose $A\in\mathcal{T}$ and that would be restrictive. The solution is to include this into the definition of the product kernel. That is rather than defining $k^3:S\times\mathcal{U}\to[0, +\infty)$ one can define $k^3:S\times (\mathcal{T}\times\mathcal{U})\to[0, +\infty)$ . Then the composition would read $$ k^3(s, A\times B) = \int_B\int_A k^1(s, dt) k^2(t, du) \qquad\forall s\in S,\, \forall A\times B \in \mathcal{T}\otimes\mathcal{U}. $$ This seems the product of kernels for $k^2$ independent of $S$ as defined on Wikipedia . I am very confused: although this seems to be the natural generalization of composition of functions to kernels, it is actually the definition of kernel product?
