[site]: stackoverflow
[post_id]: 2121399
[parent_id]: 
[tags]: 
SQL Help: Find which columns caused the mismatch

The query below selects the rows from table_1 which do not exist in table_2 based on values in the 4 columns. The mismatch could be due to one or more columns. I would like to extend the query to tell me which column(s) had the mismatched values, either by showing the column name or its value. I can do this in a cursor but prefer to do it in a set based operation if possible. SELECT i.agent , i.agency , i.customer , i.Company FROM table_1 AS i WHERE NOT EXISTS ( SELECT p.agent , p.agency , p.customer , p.Company FROM table_2 AS p WHERE i.Agent = p.Agent AND i.agency = p.Agency AND i.customer = p.customer AND i.Company = p.Company ) Update: I guess this needs more refinement. Let's add that 3 out of 4 columns need to match.
