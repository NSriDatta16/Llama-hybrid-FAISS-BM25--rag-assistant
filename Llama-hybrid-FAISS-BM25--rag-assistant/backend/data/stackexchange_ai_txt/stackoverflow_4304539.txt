[site]: stackoverflow
[post_id]: 4304539
[parent_id]: 
[tags]: 
Convert Cardinal to IUnknow

I am working on adoption of Visual Basic code into Delphi code right now. What I have: // prepare query with oleClipboardFormat do begin cfFormat := CF_FileContents; ptd := nil; dwAspect := DVASPECT_CONTENT; lindex := Index; tymed := TYMED_ISTREAM or TYMED_ISTORAGE; end; // query data data.GetData(oleClipboardFormat, oleMedium) The field oleMedium.hGlobal (type of variable is Cardinal ) contains a reference to IStorage interface. How should I cast oleMedium.hGlobal to IStorage ? There is some kind of black magic in the VB sources I am translating right now. The author of the code uses following visual basic function to cast pointers to interfaces... Private Function ResolvePointer(ByVal PtrObj As Long) As stdole.IUnknown Dim oUnk As stdole.IUnknown ' Get an uncounted reference ' to the IUnknown interface MoveMemory oUnk, PtrObj, 4& ' Get a counted reference Set ResolvePointer = oUnk ' Release the uncounted reference MoveMemory oUnk, 0&, 4& End Function
