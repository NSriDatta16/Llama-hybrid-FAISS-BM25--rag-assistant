[site]: crossvalidated
[post_id]: 219602
[parent_id]: 
[tags]: 
Can we calculate $E[Y|Z]$ if we know $f(Y|X)$ and $f(X|Z)$?

While reading Jennifer Hill (2011) , p. 220, in the context of conditional average treatment effect, the author is able to calculate $E[Y|Z]$ from $f(Y|X)$ and $f(X|Z)$. My attempt to replicate the author's calculation is as follows: $$ \begin{align} E[Y|Z] &= \int y f(y|z) dy \\ &= \int y \int f(y, x| z) dx dy \\ &= \int y \int f(y|x, z) f(x|z) dx dy\\ &= \int y \int f(y|x) f(x|z) dx dy \end{align} $$ where the last equation is true because $y$ is independent from $z$ once conditional on $x$. However, this integration is rather nightmarish even with the Gaussian distributions, i.e. $f(x|z=1) \sim N(40, 10^2)$ and $f(y|x) = N(72 + 3 \sqrt x, 1)$. I tried Mathematica, which couldn't give the numerical result either. Is this the correct approach to calculate $E[Y|Z]$, or there is a more sensible approach?
