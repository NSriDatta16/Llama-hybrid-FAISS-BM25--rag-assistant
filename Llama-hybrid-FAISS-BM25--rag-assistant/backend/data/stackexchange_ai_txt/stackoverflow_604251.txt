[site]: stackoverflow
[post_id]: 604251
[parent_id]: 
[tags]: 
powershell exchange 2003 : wmi-object does not pull all mailbox stores?

I have the following code pulling from my exchange server 2003. connect-qadservice -service 'localhost' foreach ($server in $exchangeservers) { $AllUsers += get-wmiobject -class Exchange_Mailbox -namespace Root\MicrosoftExchangeV2 -computername $server| select servername,storagegroupname, storename,mailboxdisplayname,totalitems,size, DeletedMessageSizeExtended, legacyDN, datediscoveredabsentInDS } $exchngver = "2003" foreach ($user in $AllUsers) { $obj = new-object psObject $office = get-qaduser -Identity $user.legacyDN | select office, description } disconnect-qadservice and it doesn't grab all the mailbox stores on the server. Any idea why or what might be causing this? thanks in advance NOTE: IT seems to grab all the mailbox stores except for 1 in the 2nd storage group. I have no idea why this is... The funny thing is my vbscript grabs all the mailbox stores using the same namespace and class just fine.
