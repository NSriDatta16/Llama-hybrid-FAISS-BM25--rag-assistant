[site]: stackoverflow
[post_id]: 1440163
[parent_id]: 1440118
[tags]: 
Subsystem type (GUI, console, etc.) is stored in the PE header, which you can access via the ImageHlp functions. You can get it with the following code: // Retrieve the header for the exe. GetModuleHandle(NULL) returns base address // of exe. PIMAGE_NT_HEADERS header = ImageNtHeader((PVOID)GetModuleHandle(NULL)); if (header->OptionalHeader.Subsystem == IMAGE_SUBSYSTEM_WINDOWS_CUI) { // Console application. } Relevent MSDN entries: ImageNtHeader IMAGE_NT_HEADERS IMAGE_OPTIONAL_HEADER
