[site]: stackoverflow
[post_id]: 5084758
[parent_id]: 1216315
[tags]: 
// Check if new identity is needed. if (getId) { // Execute db specific autonumber or identity retrieval code // SELECT SCOPE_IDENTITY() -- for SQL Server // SELECT @@IDENTITY -- for MS Access // SELECT MySequence.NEXTVAL FROM DUAL -- for Oracle string identitySelect; switch (DataProvider) { // Access case "System.Data.OleDb": identitySelect = "SELECT @@IDENTITY"; break; // Sql Server case "System.Data.SqlClient": identitySelect = "SELECT SCOPE_IDENTITY()"; break; // Oracle case "System.Data.OracleClient": identitySelect = "SELECT MySequence.NEXTVAL FROM DUAL"; break; default: identitySelect = "SELECT @@IDENTITY"; break; } command.CommandText = identitySelect; id = int.Parse(command.ExecuteScalar().ToString()); }
