[site]: datascience
[post_id]: 114121
[parent_id]: 114119
[tags]: 
welcome to the Data science SE community:) A couple of questions in regards to the OP. In what percentage of cases is this problem of dividing by zero would occur. Could you compute the percentage of such data points in the entire dataset after step 2. Based on the percentage, you could either consider dropping those points ( of the percentage is too less), similarly think of other approaches to go about tackling the problem, which brings me to point nr.2 Might think of using some other similarly measure which could solve this problem https://pytorch.org/docs/stable/generated/torch.nn.CosineSimilarity.html This similarity score adds a small epsilon to avoid division by zero error.
