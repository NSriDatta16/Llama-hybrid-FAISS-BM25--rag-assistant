[site]: stackoverflow
[post_id]: 4847073
[parent_id]: 
[tags]: 
Catch PHP Exits in CLI via sh

Alright, I am trying to figure this problem out. I have a class that loops indefinitely until I either restart it manually or it runs out of available ram. I've written the code to be compliant with both CLI and normal web based execution. The only difference is with web-based execution the script will last about 12 hours or so until it crashes due to memory issues. When I run it in CLI it runs far longer, (On average 4-5 days before a crash due to memory) The script is an IRC bot that is heavily customized for what I need it to do. I don't know enough of C++, ruby, python or other languages to make something that is cross platform compliant. My dev machine is Windows and my production server is Ubuntu. Right now I have the script successfully forking off and detaching from the terminal window so I can close that with out ending the script. But what I am trying to figure out is how to catch errors and restart the script automatically since it tends to fail at random times and not always when I am at the IRC channel to catch the failure. One last positive would be a way to catch if I requested a restart from the channel and have the bot restart as I am constantly adding in new code functions or just general bug fixes. Here is my CLI start php script #!/usr/bin/php machineKill(); unlink($PID_FILE); exit (); break; case SIGHUP : $bot->machineKill(); unlink($PID_FILE); break; default : // handle all other signals } } Depending on the server I connect to since it connects to a maximum of 2 servers I run the following in the terminal to get the script running php bot_start_shell.php --server="servernamehere" > /dev/null So what I am trying to do is get a shell file coded correctly to monitor that script, and if it exits due to error or requested restart to restart the script.
