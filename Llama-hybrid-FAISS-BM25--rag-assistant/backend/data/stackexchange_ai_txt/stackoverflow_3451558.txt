[site]: stackoverflow
[post_id]: 3451558
[parent_id]: 3360746
[tags]: 
I've merged sections before (had to, for what we were doing). It can get tricky, and I think one of the problems we had has bitten you too: you're merging the .text section (which contains executable code) into the .data section (which doesn't). The .data section doesn't get the executable bit, and the /SECTION linker option (which should be able to force it to be executable) apparently doesn't work on .data . The way we worked around it is to create a new section, then merge all of the others into it. Here's how: In one of your *.cpp files, add the following lines after your #include lines: #pragma comment(linker, "/section:.merged,ERW") #pragma code_seg(".merged") (The second line has to be above some actual code, to create the new section.) Then change the -merge: commands to go to a new .merged section instead of the .data section... -merge:.edata=.merged -merge:.rdata=.merged -merge:.text=.merged -merge:.bss=.merged ...and add a new one to put the .data section there too: -merge:.data=.merged That should do the trick. You'll still get some warnings about the sections having different attributes, but you should be able to ignore them now (we suppress them by using /ignore:4254 on the linker). The final .merged section will have executable, read, and write permissions, which will eliminate the problem. (Our code is compiled with MSVC2005, but this should work in later ones too.)
