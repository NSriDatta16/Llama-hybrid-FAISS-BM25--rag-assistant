[site]: stackoverflow
[post_id]: 4087632
[parent_id]: 4086299
[tags]: 
The reason for the odd behavior seems to be related to the fact that the entire framework for Magento spins up before really getting around to controllers and such. This means that your previous login state (logged out, in this case) is recorded before your code is run. It's my guess (though I haven't run through all the code) that you could reset a few session/registry variables during login to solve this problem. If you do this, please contribute it back to Magento so that we can all share :)
