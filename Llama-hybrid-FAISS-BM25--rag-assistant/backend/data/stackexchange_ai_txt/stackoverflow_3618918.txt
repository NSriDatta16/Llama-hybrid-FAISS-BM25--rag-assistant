[site]: stackoverflow
[post_id]: 3618918
[parent_id]: 3617862
[tags]: 
You're on the wrong track with this. The cursor shape is not controlled by WM_SETCURSOR anymore when a D+D is in progress. COM takes over and alters the shape when a window give the 'okay to drop' feedback. Which is probably what's missing from your code. You cannot bypass 'OLE' or the MFC wrappers that make it easy, the source of the drag will use it. Lookup IDropTarget::DragEnter to get that right. Using a class wrapper is certainly the best approach, it isn't that easy to get it right on your own.
