[site]: stackoverflow
[post_id]: 3794548
[parent_id]: 3794462
[tags]: 
Yes, you're battling UIPI, an aspect of UAC that prevents unelevated programs from hijacking the resources of an elevated one. And yes, ChangeWindowMessageFilter() allows you to bypass this restriction for Windows messages. However, OLE drag and drop doesn't use Windows messages. It uses callbacks, review the docs for RegisterDragDrop() for details. This microsoftie blog post tells you that you're screwed although it opens the door for CWMF. How to get a WM_DROPFILES message is however completely unclear to me. Using DragAcceptFiles() in a sample Windows Forms app had no discernible effect.
