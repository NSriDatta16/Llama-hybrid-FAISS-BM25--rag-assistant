[site]: stackoverflow
[post_id]: 536028
[parent_id]: 530320
[tags]: 
One possible solution is to encapsulate the mailing as a stored procedure e.g. mail_error_as_MAILER (wich you will later call) and another stored procedure e.g. ALTER PROCEDURE [dbo].[mail_error](@error_ID int) SET NOCOUNT ON declare @rc int declare @object int declare @src varchar(255) declare @desc varchar(255) declare @osql_cmd varchar(1000) -- create shell object exec @rc = sp_oacreate 'wscript.shell', @object out if @rc0 begin exec sp_oageterrorinfo @object, @src out, @desc out return END DECLARE @user VARCHAR(50) DECLARE @password VARCHAR(50) DECLARE @database VARCHAR(50) DECLARE @server VARCHAR(50) DECLARE @sql varchar(200) SET @user=MAILER,@password=XXXXXX,@database=XXXXXX,@server=XXXXX SET @sql= 'EXEC mail_ERROR_as_MAILER @error_ID=' + CAST(@error_id as varchar(10)) set @osql_cmd='osql -U'+@user+' -P'+@password+' -d'+@database+' -S"'+@server+'" -Q"' +@sql+'"' exec @rc= sp_oamethod @object, 'run', null, @osql_cmd --print @rc if @rc0 begin exec sp_oageterrorinfo @object, @src out, @desc out return end -- destroy shell object exec sp_oadestroy @object But this requires: * hardcoding password (make sure users cannot view definition of stored procedure ...) * giving users access to sp_oacreate etc... (opens up other security problems e.g. DOS) that way they can only use the mail the way you want to without giving them permission to mail other things. Or safer, let users put mail in some kind of mail_queue(wich you can control what they can put in) and have an agent acount send these mails periodically Or: give them permission to mail but take a big club with rusted spikes on abuse
