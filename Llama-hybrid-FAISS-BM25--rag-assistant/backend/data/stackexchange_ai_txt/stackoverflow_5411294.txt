[site]: stackoverflow
[post_id]: 5411294
[parent_id]: 1771165
[tags]: 
The best way to implement this is to use a tool like Reflector and see how the System.Web.Security.FormsAuthentication.SignOut method implements removing the authentication cookie. In Reflector, open up System.Web and navigate to the FormsAuthentication object and find the SignOut method. Right click on it and select "Disassemble" (Choose your language from the menu). VB.NET Public Shared Sub SignOut() FormsAuthentication.Initialize Dim current As HttpContext = HttpContext.Current Dim flag As Boolean = current.CookielessHelper.DoesCookieValueExistInOriginal("F"c) current.CookielessHelper.SetCookieValue("F"c, Nothing) If (Not CookielessHelperClass.UseCookieless(current, False, FormsAuthentication.CookieMode) OrElse current.Request.Browser.Cookies) Then Dim str As String = String.Empty If (current.Request.Browser.Item("supportsEmptyStringInCookieValue") = "false") Then str = "NoCookie" End If Dim cookie As New HttpCookie(FormsAuthentication.FormsCookieName, str) cookie.HttpOnly = True cookie.Path = FormsAuthentication._FormsCookiePath cookie.Expires = New DateTime(&H7CF, 10, 12) cookie.Secure = FormsAuthentication._RequireSSL If (Not FormsAuthentication._CookieDomain Is Nothing) Then cookie.Domain = FormsAuthentication._CookieDomain End If current.Response.Cookies.RemoveCookie(FormsAuthentication.FormsCookieName) current.Response.Cookies.Add(cookie) End If If flag Then current.Response.Redirect(FormsAuthentication.GetLoginPage(Nothing), False) End If End Sub With the above as an example, I was able to create a common method called RemoveCookie() in a shared assembly, code is below: VB.NET ''' ''' Method to remove a cookie ''' ''' Key ''' Public Shared Sub RemoveCookie(ByVal key As String) ' Encode key for retrieval and remove cookie With HttpContext.Current Dim cookie As New HttpCookie(.Server.UrlEncode(key)) If Not IsNothing(cookie) Then With cookie .HttpOnly = True .Expires = New DateTime(&H7CF, 10, 12) End With ' Remove from server (has no effect on client) .Response.Cookies.Remove(.Server.UrlEncode(key)) ' Add expired cookie to client, effectively removing it .Response.Cookies.Add(cookie) End If End With End Sub Having tested this using FireBug and the Cookie add-in for FireBug (in FireFox), I can attest that the cookie immediately gets removed. Any questions, feel free to message me.
