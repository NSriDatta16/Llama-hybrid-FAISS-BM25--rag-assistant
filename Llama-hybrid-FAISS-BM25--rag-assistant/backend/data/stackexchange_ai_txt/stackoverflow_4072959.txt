[site]: stackoverflow
[post_id]: 4072959
[parent_id]: 4071527
[tags]: 
I'm not sure I follow what you are trying to do with your code, but here is a skeleton of how I would organize it. function getTotalHours( $id) { $sum = getHoursOnProject( $id); foreach( getChildIds( $id) as $childId) { $sum += getTotalHours( $childId); } return $sum; } function getChildIds( $id) { $query = "SELECT id FROM folders WHERE parent_id = $id"; ... return $childIdArray; } function getHoursOnProject( $id) { $query = "SELECT sum(hours) as totalhours FROM projects WHERE folder_id = $id"; ... return $hours; }
