[site]: stackoverflow
[post_id]: 403443
[parent_id]: 
[tags]: 
How to set up access to MSSQL 2005 Database Mail?

I've just setup Database mail within MSSQL 2005. I have been able to send email from an administrator account on the server and through a SQL Server Agent job. But, I unable to send email when I tried to send email via a login that just has access to a database for our web application. What is the best way to set up access to Database Mail? I have 2 senerios where I want to send email. Schedule a job through SQL Server Agent to run a Stored Procedure that does some process and then sends an email. (this hasn't been a problem) Have a stored procedure invoked from a web application that calls another stored procedure which could send an email. (this is were my permissions issue is) Possible Solutions The only way that I have found to grant permission to a login is to map the login to the msdb database and grant the public and DatabaseMailUserRole . This really concerns me as I would assume that this gives to much access to the msdb database. Store the email I want to send in a table and then have a SQL Server Agent job look at that table every so often to send any queued emails. This way the database login for the web application does not execute the [msdb].[dbo].[sp_ send _dbmail] call and thus does not need any permission to the msdb database. Are there any other solutions?
