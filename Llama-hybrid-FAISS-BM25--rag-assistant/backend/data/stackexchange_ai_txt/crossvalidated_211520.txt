[site]: crossvalidated
[post_id]: 211520
[parent_id]: 
[tags]: 
Covariance matrix of parameters in logistic regression

Let $$f(y)=\prod_i \binom{n_i}{y_i}\pi(x_i)^{y_i}(1-\pi(x_i))^{n_i-y_i}$$ where $$\pi(x_i)=\frac{e^{\sum_j x_{ij}B_j}}{1+e^{\sum_j x_{ij}B_j}}$$ then the likelihood is $$L\propto \prod_{i}\pi(x_i)^{y_i}(1-\pi(x_i))^{(n_i-y_i)}$$ $$l=\sum_i y_i log(\frac{\pi(x_i)}{(1-\pi(x_i))})+\sum_i n_i log(1-\pi(x_i))$$ I found that $$\frac{d^2l}{dBdB}=-\sum_i n_ix_{ij}\frac{e^{\sum_j x_{ij}B_j}}{(1+e^{\sum_j x_{ij}B_j})^2}=-\sum_i n_ix_{ij}\pi(x_i)(1-\pi(x_i))$$ the Fisher information is $$I(\hat{B})=-E[\frac{d^2l}{dBdB}]$$ and $$cov(\hat{B})=I^{-1}(\hat{B})=(X'Diag[(n_i{\hat{\pi}}(x_i)(1-{\hat{\pi}}(x_i))]X)^{-1}(*)$$ In the last line $X$ is a matrix. anyone can help me understand how to get $(*)$? EDIT: $B$ is the parameters of the model
