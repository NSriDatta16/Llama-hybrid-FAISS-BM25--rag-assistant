[site]: stackoverflow
[post_id]: 4862519
[parent_id]: 4862156
[tags]: 
The code that you already you have is a good start, but (as you probably know) it will only be executed when the user clicks the button. If you need to ping the server periodically every 30 minutes, you will need to start a timer and run your code each time the timer has elapsed. A Timer control is already provided for you by the .NET Framework, and it's quite simple to take advantage of its functionality. Here's a quick step-by-step: In Design Mode (where you can edit your form from inside of Visual Studio), scroll down to the "Components" tab in the Toolbox and drag the "Timer" control to your form. A new Timer control will appear in a gray box at the bottom of your screen. Use the Properties Window to give it a name and set its properties: Name: pingTimer Enabled: True Interval: 60000 Switch to code view and add a class-level variable of type Integer to your form. This variable will be used to keep track of how many seconds have elapsed so far. The reason you have to do this is the Interval of the Timer is measured in milliseconds, which makes its maximum value far less than 30 minutes. By setting the interval to "60000", the timer will "tick" every 1 minute, and on each tick, you will increment the variable keeping track of the total number of timer ticks. When the value of that variable reaches 30 (indicating 30 minutes has elapsed), you will reset it to 0 and run your ping code. Add an event handler method for the Timer.Tick event. This is where the code that I just talked about above will go. So, your final code might look something like this: ' Class-level variable to keep track of the number of "ticks" so far Private elapsedTime As Integer = 0 Private Sub pingTimer_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pingTimer.Tick ' Check the time that has elapsed so far If elapsedTime >= 30 Then ' It has been 30 minutes, so reset the elapsed time count elapsedTime = 0 ' And do the ping If My.Computer.Network.Ping("209.85.143.99") Then MsgBox("Server pinged successfully.") Else MsgBox("Ping request timed out.") End If Else ' It has not yet been 30 minutes, so increment the elapsed time count elapsedTime += 1 End If End Sub
