[site]: crossvalidated
[post_id]: 37553
[parent_id]: 37527
[tags]: 
While the first estimate is the MLE under perfect conditions, I believe there's enough scope for both estimating the proportion and testing the assumption that really all proportions are the same. You can do this as a nested logistic regression with just a common intercept vs. a bunch of fixed effects for each subject. Or a variance component in a GLMM way. The test that all coefficients are equal to zero (or that the variance component is equal to zero) would justify the first approach. If this test fails, you have to admit that your success probabilities vary between subjects; in this case, the overall probability may still be a valid population parameter and a target of inference, but only the second formula is applicable. The variance estimator is formula (2.3-8) in Korn & Graubard 1999 (which is a great book worth having if you work with surveys to any appreciable extent).
