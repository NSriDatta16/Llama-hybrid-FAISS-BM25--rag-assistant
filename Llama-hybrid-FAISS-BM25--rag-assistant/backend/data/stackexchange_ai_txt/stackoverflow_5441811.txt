[site]: stackoverflow
[post_id]: 5441811
[parent_id]: 5441709
[tags]: 
I would suggest starting with libpcap (or its sibling, winpcap on Windows), and then interpreting the saved captures; the libpcap team has done a fantastic job making a very reliable and fast mechanism to interface with the kernel's raw sockets support to run as efficiently as possible. (The Linux kernel provides a BPF -like interface for specifying which packets to offload to userspace; see Documentation/networking/filter.txt for Linux details.)
