[site]: crossvalidated
[post_id]: 447256
[parent_id]: 
[tags]: 
Latent time-series with multiple observations per time point

I have a latent time-series $\psi_t$ where for each time point $t$ I have multiple observations $y_t$ , generated from a distribution dependent on $\psi_t$ . The number of observations $n_t$ some time point changes for each $t$ . Importantly, when $n_t$ is larger, the latent time-series should change more than if $n_t$ is small. A possible simple set-up could be: $\psi_t\sim AR(1)$ $y_{ti} \sim N(\psi_t, \sigma^2), ~~~~i = 1, \dots, n_t.$ A state-space model approach can allow me a latent time-series, but still assumes one observation from it for each $t$ . I can run a hierarchical model so as to shrink each estimate $\psi_t$ more with smaller $n_t$ , but then we ignore the time-series structure. I've searched a lot for a good solution, but have so far come up with nothing. I'm looking for a simple model that is implemented in R or Python, The solutions I have come up with are: Model a latent time-series where the latent variable is measured by multiple observations at each time point. Run a regular time-series model, but use $n_t$ as a weight for each time point. This seems very simple (and easy to implement in any likelihood-based estimation), but I have surprisingly found no time-series implementation allowing weights. Either one would work just as well, but I would also be OK with some pragmatic approximation to the problem. My questions about either of these, then, are: Is there a common name for such a model? Is it implemented in R or Python or anywhere?
