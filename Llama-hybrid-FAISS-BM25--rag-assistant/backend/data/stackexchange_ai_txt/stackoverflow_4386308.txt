[site]: stackoverflow
[post_id]: 4386308
[parent_id]: 4386067
[tags]: 
This is a classic gaps and islands problem. It essentially a common problem where you need to identify missing values (gaps) in a sequence. Fortunately there is a free sample chapter on this very topic from the Manning book, SQL Server MVP Deep Dives. Hopefully it will provide inspiration as it gives guidance on a number of possible approaches. http://www.manning.com/nielsen/SampleChapter5.pdf Here is Itzik Ben-Gan's description of the problem, quoted from the above chapter. Gaps and islands problems involve missing values in a sequence ... The sequences involved can also be temporal, such as order dates, some of which are missing due to inactive periods (weekends, holidays). Finding periods of inactivity is an example of the gaps problem, and finding periods of activity is an example of the islands problem.
