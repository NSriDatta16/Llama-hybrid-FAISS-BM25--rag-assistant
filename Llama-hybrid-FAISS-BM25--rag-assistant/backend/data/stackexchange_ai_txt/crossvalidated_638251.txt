[site]: crossvalidated
[post_id]: 638251
[parent_id]: 610254
[tags]: 
Consider using an RCT experimental structure with a multilevel model for inference This is quite a fascinating statistical problem. It bears a significant resemblance to standard causal analysis where we have multiple treatments that leads to counterfactual alternatives that cannot both occur for the same sampling unit (i.e., testing bacterial composition of the seed versus planting the seed). However, the difference here is that we are not interested in the causal effect of the treatment itself, but rather, we want to know the association between the outcomes of different treatments for sampling units that come from a common group (in this case, seeds from the same plant). The main complication is that the different treatments lead to an entirely different output variable we are measuring. Ultimately, I think this can be handled using a standard RCT experimental structure with a multilevel model for statistical inference. I do not think the counterfactual nature of the output variable precludes a multilevel model which would make an inference about the group-level (i.e., plant level) association between the two possible outputs. So long as you randomise the seeds between your two treatment alternatives (so that the selected treatment is not associated with any would-be confounding factors) you should be able to form a model that measures this association in an identifiable way. Here is an example of a basic multilevel model for this purpose. Let $k$ denote the categorical variable for the plant identity and let $i$ denote the index for each seed in the plant. We will use the variable $T$ to denote the binary treatment (with $T=0$ for testing bacterial composition and $T=1$ for planting and testing root length) and we will denote the output variable as $Y$ . As an example, we could form a multilevel model over all plants $k$ and seeds $i$ that is something like this: $$\begin{align} Y_{k,i} &= \beta_{k,0} (1-T_i) + \beta_{k,1} T_i + (\sigma_{k,0} (1-T_i) + \sigma_{k,1} T_i) \varepsilon_i, \\[18pt] \begin{bmatrix} \beta_{k,0} \\ \beta_{k,1} \end{bmatrix} &\sim \text{IID Dist} \bigg( \text{Mean} = \begin{bmatrix} \beta_{0} \\ \beta_{1} \end{bmatrix} , \text{Var} = \begin{bmatrix} \lambda_{0}^2 & \rho \lambda_{0} \lambda_{1} \\ \rho \lambda_{0} \lambda_{1} & \lambda_{1}^2 \end{bmatrix} \bigg), \\[12pt] \begin{bmatrix} \log \sigma_{k,0} \\ \log \sigma_{k,1} \end{bmatrix} &\sim \text{IID Dist} \bigg( \text{Mean} = \begin{bmatrix} \phi_{0} \\ \phi_{1} \end{bmatrix} , \text{Var} = \begin{bmatrix} \kappa_{0}^2 & \phi \kappa_{0} \kappa_{1} \\ \phi \kappa_{0} \kappa_{1} & \kappa_{1}^2 \end{bmatrix} \bigg). \\[12pt] \end{align}$$ In this multilevel model the parameters $\beta_{0}$ and $\beta_{1}$ represent the mean outcome variables for the two treatments and the parameter $\rho$ represents the correlation between the mean outcome variables at the group-level (i.e., for seeds from a single plant). So long as you have multiple data points across plants, these parameters should be identifiable model parameters, notwithstanding the counterfactual outcome variable. You could form multivariate model along these lines and then estimate the parameters using either classical or Bayesian methods. So far as I can see the parameters should be identifiable so it should be possible to estimate the group-level association of the outputs from the two treatments.
