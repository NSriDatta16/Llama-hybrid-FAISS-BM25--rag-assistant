[site]: crossvalidated
[post_id]: 615327
[parent_id]: 
[tags]: 
Reasoning weighted regression via causal inference

I want to follow a similar approach to what was done in the paper of Bornkamp et al. in 2021 (DOI: 10.1002/pst.2104). More specifically they added a link to a R markdown file ( https://oncoestimand.github.io/princ_strat_drug_dev/princ_strat_example.html ) with a working example how to implement the principal stratum strategy. One of their approach was modelling the stratum membership by a logistic regression and the predicted probabilities are then used to adjust a Cox-model by weighting. In the end, they compared the estimated coefficients to other Cox-models. As said, I want to follow this approache but I want to understand the reasoning for this. In the paper of Bornkamp & Bermann from 2020 (DOI: 10.1080/19466315.2019.1575280) they have quite a nice reasoning for the weighting approach. However, they are not quantifying a regression coefficient but rather a difference in probabilities as $$ \Delta(t)=P(T(1)>t\mid B(1)=1)-P(T(0)>t\mid B(1)=1) $$ where $$ \begin{aligned} P(T(0)>t\mid B(1)=1)=&\int P(T(0)>t\mid B(1)=1,Z)p(Z\mid B(1)=1)dZ\\ &\text{Principal ignorability:}\\ =&\int P(T(0)>t\mid Z)p(Z\mid B(1)=1)dZ\\ &\text{Due to randomization:}\\ =&\int P(T(0)>t\mid X=0,Z)p(Z\mid B(1)=1)dZ\\ &\text{Consistency assumption:}\\ =&\int P(T>t\mid X=0,Z)p(Z\mid X=1,B(1)=1)dZ\\ \end{aligned} $$ What results from this is according to the paper: $$ \begin{aligned} p(T(0)\mid B(1)=1)&=\int p(T\mid X=0,Z)p(Z\mid X=1,B(1)=1)dZ\\ &=\int p(T,Z\mid X=0)\frac{p(Z\mid X=1,B(1)=1)}{p(Z\mid X=0)}dZ\\ &=\int p(T,Z\mid X=0)\frac{p(B=1\mid Z,X=1)p(Z\mid X=1)p(X=1)}{p(Z\mid X=0)p(B=1,X=1)}dZ\\ &\text{Due to randomization }p(Z\mid X=1)=p(Z\mid X=0):\\ &\propto \int p(T,Z\mid X=0)\underbrace{p(B=1\mid Z,X=1)}_{w(Z)}dZ \end{aligned} $$ Now, they say in the paper that this result can be implemented via modelling for example a weighted Kaplan-Meier, where the weights $w(z)$ are modelled via logistic regression. However, they do not mention anything about integrating over the covariates $Z$ . They call this approach "weighted placebo patients". My problem is that I do not really see the connection between this "weighted placebo patients" approach to the weighted Kaplan-Meier estimator (and thus also do not see the relation to the weighted Cox-model). Any help to clarify this is much appreciated!
