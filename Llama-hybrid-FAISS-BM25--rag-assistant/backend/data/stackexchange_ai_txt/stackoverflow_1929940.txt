[site]: stackoverflow
[post_id]: 1929940
[parent_id]: 1929903
[tags]: 
Change Activities to Activity: from gtc in document.Descendants("Activity").Elements("Lap") And for the heartrate, add these two lines near the end of your select: TriggerMethod = gtc.Element("TriggerMethod").Value, AverageHeartRateBpm = gtc.Element("AverageHeartRateBpm").Element("Value").Value, MaximumHeartRateBpm = gtc.Element("MaximumHeartRateBpm").Element("Value").Value } Here is my complete code. The only change I made apart from the two I mentioned was to remove the xsi:type attributes. using System; using System.Windows.Forms; using System.Linq; using System.Xml.Linq; namespace WindowsFormsApplication1 { public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void button1_Click(object sender, EventArgs e) { string xml = @" 2009-12-17T19:53:14Z 820.5400000 1510.3433838 2.6089859 104 128 139 Active Manual "; XDocument document = XDocument.Parse(xml); var query = from gtc in document.Descendants("Activity").Elements("Lap") select new { Id = gtc.Parent.Element("Id").Value, StartTime = gtc.Attribute("StartTime").Value, TotalSeconds = gtc.Element("TotalTimeSeconds").Value, DistanceMeters = gtc.Element("DistanceMeters").Value, MaximumSpeed = gtc.Element("MaximumSpeed").Value, Calories = gtc.Element("Calories").Value, Intensity = gtc.Element("Intensity").Value, TriggerMethod = gtc.Element("TriggerMethod").Value, AverageHeartRateBpm = gtc.Element("AverageHeartRateBpm").Element("Value").Value, MaximumHeartRateBpm = gtc.Element("MaximumHeartRateBpm").Element("Value").Value }; dataGridView1.DataSource = query.ToList(); } } }
