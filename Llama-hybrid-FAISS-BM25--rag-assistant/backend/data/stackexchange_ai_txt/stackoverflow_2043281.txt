[site]: stackoverflow
[post_id]: 2043281
[parent_id]: 
[tags]: 
Datediff between non-consecutive rows in a table

I would like to take the average of the time difference from Table1 below. The values are not consecutive and occasionally the time value is repeated, so I need to 1) sort by time, 2) discard non-unique values, 3) perform the time difference (in milliseconds), then 4) average the resulting time difference values. Further I'd like to 5) limit the datediff operation to a chosen time range, such as WHERE _TimeStamp >= '20091220 11:59:56.1' AND _TimeStamp = '20091220 11:59:56.8'. I am pretty stumped how to put this all together! Table1: _TimeStamp 2009-12-20 11:59:56.0 2009-12-20 11:59:56.5 2009-12-20 11:59:56.3 2009-12-20 11:59:56.4 2009-12-20 11:59:56.4 2009-12-20 11:59:56.9
