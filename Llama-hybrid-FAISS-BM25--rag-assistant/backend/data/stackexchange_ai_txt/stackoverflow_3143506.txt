[site]: stackoverflow
[post_id]: 3143506
[parent_id]: 3143443
[tags]: 
You're not quite building the string correctly as far as I can tell. If no @Item_Num is passed in, you'll end up with no WHERE key word... you'll just have "FROM [tblItem_Log] AND..." I would make all of the criteria appends be "AND ..." and as your initial statement use: FROM [tbl_Item_Log] WHERE (1=1) Since you have code to return the generated string, why not put that into SSMS and try to run it? I also just noticed that if you don't pass in date values that you will end up executing a NULL string, because your final concatenation will end up causing a NULL. These are the kinds of things that you need to pay very close attention to if you're going to be using dynamic SQL to build queries. Once I corrected that I was able to run the stored procedure without any errors (at least to generate what looks like a valid SQL statement). That leads me to believe that it may be a problem with data types in the underlying table. Can you provide the definition for that? One last note: Personally, I would use CONVERT(VARCHAR(11), RecDate, 106) AS RecDate instead of the seemingly unnecessary subquery that you have. Yet another edit: You may want to remove the code that checks LTRIM(@Search_User_ID) <> ''. It's a pointless bit of code and perhaps a setting particular to your server/connection is causing it to fail because of the type mismatch.
