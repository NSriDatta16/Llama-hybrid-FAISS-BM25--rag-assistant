[site]: crossvalidated
[post_id]: 508310
[parent_id]: 
[tags]: 
How to analyze duration & frequency of different alternating events with generalized linear mixed models?

I have the following data. For each subject, there are observations of different brain states (i.e. brain state A, B, C & D) with varying duration which can also be seen as observations of different alternating event types with varying duration : Subject observation brainState duration (ms) 1 1 A 54 1 2 C 44 1 3 D 32 1 4 B 108 1 5 A 76 1 6 D 45 1 7 A 70 1 8 C 50 1 9 B 90 1 10 C 52 2 1 C 56 2 2 B 75 2 3 C 45 2 4 A 80 2 5 D 50 2 6 C 61 2 7 B 70 2 8 C 71 2 9 A 76 2 10 D 41 (Notably, this is just an excerpt of my data. The total sample consists ca. 850 subjects and between 1'000 to 2'000 single observations of brain states aka events per subject (i.e. ca. 1'275'000 total observations)) What is usually done in the field (i.e. EEG microstate analysis) is that from the sequence the following two parameters are calculated for each subject: average duration (ms) per brain state (i.e. sum of the duration of all single observations of a given brain state divided by the number of single observations of the same brain state) average frequency of occurrence (1/s) per brain states (i.e. the number of single observations of a given brain state divided by the total measurement time in seconds for this subject) Subsequently, the averaged data is usually analyzed with anovas to answer questions like: "Do the different brain states differ in their average duration resp. in their average occurrence (per second)?" I would like to answer the same questions, but without averaging it (using raw data as shown above) in order to be able to apply linear mixed models which can take into account that different subjects have different amounts of data and that for different brain states, there is different amount of data. This is relatively straightforward for duration where I can just use each individual occurring brain state event as a single observation and then analyze it with a linear mixed model (for example in lmer) with the following model: duration ~ brainState + (brainState|Subject) (family=gaussian) However, I do not know if it is possible to analyze occurrence (or something conceptually similar) like this and could not figure it out so far. Question: It is possible to analyze occurrence of events (or something conceptually similar) with the raw data from above with linear mixed models and if so, how? One thought which occurred to me is that I could partially average the data meaning that I could calculate the frequency of occurrence for the different brain states for, example given, each 2 or 4 second segment of data (each of this segment would then be considered to be a single observation). This should make the application of linear mixed models possible (ca. 40-90 observations per subject, depending on total measurement time). However, it would still not be the real raw data, the segmentation would be quite artificial (i.e. length of the segments) and I have never encountered such a "partial averaging" anywhere. So I would also be really interested in any insights, comments on this potential make-shift solution.
