[site]: stackoverflow
[post_id]: 3887479
[parent_id]: 
[tags]: 
Why is my php loop not working?

Ok I have a PHP variable $question that looks like this: $question['3']['type'] = 'checkbox'; $question['3']['desc'] = 'checkbox question'; $question['3']['deft'] = '1'; $question['3']['opts'] = 'Check Test 1'; $question['3']['opts'] = 'Check Test 2'; What I want to do is have this be a question on a survey where the desc is the question, and opts are the multiple answers. I currently have this statement: if ($type == "checkbox") { if (strtolower($deft) == 'y') { $box_value = "1"; $CHECKED = ' CHECKED'; } else { $box_value = "0"; $CHECKED = ''; } print " \n "; } It works but it doesn't allow me to include a question (only answers). I want to do something like this: if ($type == "checkbox") { print " \n"; $i = 1; foreach ($opts as $opt_key => $opt_value) { if ($deft == $i) {$CHECKED = "checked=\"checked\""; } else { $CHECKED = ''; } print " - $opt_value \n"; $i++; } } I'm getting an error because my code is crappy. Can anyone tell help me fix this code? THanks Here is the rest of the code $value) { if ($key != 'button') { if (preg_match('/^hidden_(.*)/i',$key)) { $value = security_filter($value); $key = trim(strstr($key,'_'),'_'); if (isset($hidden[$key])) { $hidden_data[$key] = $value; } } else { if (isset($question[$key])) { $value = security_filter($value); if ($question[$key]['type'] == 'checkbox') { $value = "YES"; } $results[$key] = $value; } } } } # Now that the responses are processed, prepare the email. $msg = "----------------- User Info -----------------\n\n"; $msg .= "Sent from: ".$_SERVER['REMOTE_HOST']." [".$_SERVER['REMOTE_ADDR']."] \n"; $msg .= "Coming from (referer): ".$_SERVER['HTTP_REFERER']."\n"; $msg .= "Using (user agent): ".$_SERVER['HTTP_USER_AGENT']."\n\n"; $msg .= "---------------------------------------------\n\n"; if (isset($question)) { $lineflag = FALSE; foreach ($results as $key => $value) { if ($lineflag == FALSE) { $msg .= "----------------- Questions -----------------\n\n"; $lineflag = TRUE; } $msg .= "Question: ". $key ." - ". $question[$key]['desc'] ."\n"; $msg .= "Response: ". $value . "\n\n"; } $msg .= "---------------------------------------------\n"; } $msg .= "\n"; if (isset($hidden_data)) { $lineflag = FALSE; foreach ($hidden_data as $key => $value) { if ($lineflag == FALSE) { $msg .= "---------------- Hidden vars ----------------\n\n"; $lineflag = TRUE; } $msg .= $key ." - ". $value ."\n"; } $msg .= "\n---------------------------------------------\n"; } # Prep and send email. $headers = "Return-Path: $email_to_send_to\r\n"; $headers .= "From: $name_of_survey processor \r\n"; $headers .= "Content-type: text/plain; charset=$charset\r\n"; mail($email_to_send_to, $name_of_survey . " mailer", $msg, $headers); # Include template file. if (!(empty($survey_complete_page))) { include($survey_complete_page); } } else { if (!(empty($survey_heading_page))) { include($survey_heading_page); } print " \n"; foreach ($question as $key => $value) { $type = strtolower($question[$key]['type']); $desc = $question[$key]['desc']; $deft = $question[$key]['deft']; $opts = $question[$key]['opts']; print $desc."\n"; /* if ($type == "checkbox") { if (strtolower($deft) == 'y') { $box_value = "1"; $CHECKED = ' CHECKED'; } else { $box_value = "0"; $CHECKED = ''; } print " \n "; } */ if ($type == "checkbox") { print " \n"; $i = 1; foreach ($opts as $opt_key => $opt_value) { if ($deft == $i) {$CHECKED = "checked=\"checked\""; } else { $CHECKED = ''; } print " - $opt_value \n"; $i++; } } if ($type == "radio") { print " \n"; $i = 1; foreach ($opts as $opt_key => $opt_value) { if ($deft == $i) { $CHECKED = " checked=\"checked\""; } else { $CHECKED = ''; } print " - $opt_value \n"; $i++; } } if ($type == "select") { print " \n"; print " \n"; $i = 1; foreach ($opts as $opt_key => $opt_value) { if ($deft == $i) { $CHECKED = ' SELECTED'; } else { $CHECKED = ''; } print " $opt_value \n"; $i++; } print " \n"; } if ($type == "text") { print " \n"; $size = $opts['size']; $maxl = $opts['maxl']; print " \n"; } if ($type == "textarea") { print " \n"; $colz = $opts['cols']; $rowz = $opts['rows']; print " $deft \n"; } # Spacing between survey questions ----------- print " \n"; # -------------------------------------------- } foreach ($hidden as $key => $value) { print " \n"; } print " \n"; print " &nbsp; -- &nbsp; \n"; print " \n"; print " "; print " Powered by A Plus Professional Resumes \n"; } if (!(empty($close_template))) { include($close_template); } ?>
