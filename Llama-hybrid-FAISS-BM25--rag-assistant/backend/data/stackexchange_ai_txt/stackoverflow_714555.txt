[site]: stackoverflow
[post_id]: 714555
[parent_id]: 714517
[tags]: 
WITH q AS ( SELECT Company.*, ROW_NUMBER() OVER (PARTITION BY CompanyState, CompanyCity, CompanyName ORDER BY CompanyID) AS rnName, ROW_NUMBER() OVER (PARTITION BY CompanyState, CompanyCity, CompanyAddress ORDER BY CompanyID) AS rnAddress FROM Company ) SELECT * WHERE rnName > 1 OR rnAddress > 1 Note, though, that if your data will look like this: CompanyID CompanyName CompanyAddress --------- ----------- -------------- 1 McDonalds Avenue 1 2 McDonalds Avenue 2 3 Starbucks Avenue 2 , then both records 2 and 3 will be deleted (which is what you requested but probably not what you wanted) If you just want to list all rows having duplicates, then issue: SELECT * FROM Company co WHERE EXISTS ( SELECT 1 FROM Company cn WHERE cn.CompanyState = co.CompanyState AND cn.CompanyCity = co.CompanyCity AND cn.CompanyName = co.CompanyName AND cn.CompanyID <> co.CompanyID ) OR EXISTS ( SELECT 1 FROM Company ca WHERE ca.CompanyState = co.CompanyState AND ca.CompanyCity = co.CompanyCity AND ca.CompanyAddress = co.CompanyAddress AND ca.CompanyID <> co.CompanyID ) This will work in SQL Server 2000 too. Having indexes on (CompanyState, CompanyCity, CompanyName) and (CompanyState, CompanyCity, CompanyAddress) will greatly improve this query.
