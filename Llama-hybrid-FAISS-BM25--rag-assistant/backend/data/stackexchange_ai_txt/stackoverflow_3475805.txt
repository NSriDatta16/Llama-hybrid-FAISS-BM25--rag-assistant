[site]: stackoverflow
[post_id]: 3475805
[parent_id]: 3475752
[tags]: 
It's because your toLog sproc is expecting you to supply the @messageTime parameter, which you haven't done, and it doesn't have a default value like the other parameters. As you set the @messageTime always to GETDATE() inside the sproc, it looks like you just want to scrap that parameter: CREATE PROCEDURE dbo.toLog @etlJobName NVARCHAR(60) = 'unknown', @whereTo NVARCHAR(20) = 'print', @messag NVARCHAR(255) = 'empty' AS BEGIN IF @whereTo = 'log' OR @whereTo = 'logandprint' INSERT INTO logTable(messageTime, etlJobName, whereTo, messag) VALUES (GETDATE(), @etlJobName, @whereTo, @messag) IF @whereTo = 'print' OR @whereTo = 'logandprint' PRINT CONVERT(VARCHAR, GETDATE(), 113) + ', ' + @etlJobName + ', ' + @whereTo + ', ' + ', ' + @messag END Or, if you do want to be able to pass in a datetime yourself: CREATE PROCEDURE dbo.toLog @messageTime DATETIME = null, @etlJobName NVARCHAR(60) = 'unknown', @whereTo NVARCHAR(20) = 'print', @messag NVARCHAR(255) = 'empty' AS BEGIN IF (@messagetime IS NULL) SET @messagetime = GETDATE() IF @whereTo = 'log' OR @whereTo = 'logandprint' INSERT INTO logTable(messageTime, etlJobName, whereTo, messag) VALUES (@messageTime, @etlJobName, @whereTo, @messag) IF @whereTo = 'print' OR @whereTo = 'logandprint' PRINT CONVERT(VARCHAR, @MessageTime, 113) + ', ' + @etlJobName + ', ' + @whereTo + ', ' + ', ' + @messag END
