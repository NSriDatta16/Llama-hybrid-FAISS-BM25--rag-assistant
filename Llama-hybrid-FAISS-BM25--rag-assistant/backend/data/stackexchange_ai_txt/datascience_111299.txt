[site]: datascience
[post_id]: 111299
[parent_id]: 
[tags]: 
Create features for each row or only for a specific value

I have a problem. I want to predict when the customer will place another order in how many days if an order comes in. I have already created my target variable next_day_in_days . This specifies in how many days the customer will place an order again. And I would like to predict this. Since I have too few features, I want to do feature engineering. I would like to specify how many orders the customer has placed in the last 90 days. For example, I have calculated back from today's date how many orders the customer has placed in the last 90 days. Is it better to say per row how many orders the customer has placed? Please see below for the example. So does it make more sense to calculate this from today's date and include it as a feature or should it be recalculated for each row? customerId fromDate next_day_in_days 0 1 2021-02-22 24 1 1 2021-03-18 4 2 1 2021-03-22 109 3 1 2021-02-10 12 4 1 2021-09-07 133 8 3 2022-05-17 61 10 3 2021-02-22 133 11 3 2021-02-22 133 Example # What I have customerId fromDate next_day_in_days purchase_in_last_90_days 0 1 2021-02-22 24 0 1 1 2021-03-18 4 0 2 1 2021-03-22 109 0 3 1 2021-02-10 12 0 4 1 2021-09-07 133 0 8 3 2022-05-17 61 1 10 3 2021-02-22 133 1 11 3 2021-02-22 133 1 # Or does this make more sense? customerId fromDate next_day_in_days purchase_in_last_90_days 0 1 2021-02-22 24 1 1 1 2021-03-18 4 2 2 1 2021-03-22 109 3 3 1 2021-02-10 12 0 4 1 2021-09-07 133 0 8 3 2022-05-17 61 1 10 3 2021-02-22 133 0 11 3 2021-02-22 133 0
