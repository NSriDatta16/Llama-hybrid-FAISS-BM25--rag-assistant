[site]: crossvalidated
[post_id]: 349784
[parent_id]: 
[tags]: 
Propensity matching and analysis of resultant data on a data set with repeated measures

We have extracted retrospective case-level data collected over several years. We are using the administration of rescue antiemetic in the postanesthesia care unit as a proxy for postoperative nausea and vomited (binary outcome). We’ve extracted data around many variables including age, gender, ASA-PS score, exposures, etc. as confounders (the matching variables). We are looking to see whether preoperative strategies are associated with differential outcomes. The problem we are having is that the 14k cases represent only 10k unique patients. It has been proposed to me to discard all but, say, the first case. My main concern about choosing an arbitrary strategy for discarding cases is that there is no a priori reason to discard any given case. I ran a Monte Carlo simulation where I randomly select single unique cases and then propensity match; I’ve found wide dispersion in the resultant confidence interval of a test association. In other words, discarding cases before propensity matching seems to discard valuable information as well. I’d need to look at absolute standardized mean differences in the Monte Carlo to see if there is increased imbalance in the sample as well. Specific questions I am looking for answers to: For propensity matching, would it be acceptable to match at the case level, then stratify on the matched, then combine strata for nonunique treated patients, then used conditional logistics regression or generalized estimating equations to assess the treatment effect on the treated? This would potentially level nonunique patients unstratified in the non-treated group. In a personal communication, it has been summarized to me that the core issue here is that there are two sources of clustering to account for: a) Matched pairs: treated and control subjects who were matched would share a homogeneity in outcomes. b) The same subject having multiple records (and thus a within-subject homogeneity in outcomes). I'm wondering how to approach this problem without excessively discarding useful information. More broadly, can the same tools that can account for repeated measures (e.g. conditional logistic regression or generalized estimating equations) also be used on matched sample? In other words: if have repeated measures within a matched sample, can you use these tools to analyze that data? Is there a mechanism in existing propensity matching packages to exclude non-unique patients in the nontreated (control) population once a case from that patient has been selected? (We are using MatchIt in R). Is that a reasonable approach? What are your thoughts on propensity matching at the case level, with possible multiple cases for each unique patient in the propensity-matched cohort, and then performing Monte Carlo simulation where conditional logistic regression is performed on a match-stratified dataset where only a single case per unique patient is randomly selected from amongst the cases in the propensity-matched cohort? Wondering if this or this might have some insight. It seems that the clustering being spoken of in these examples are more broad sources of clustering applicable to relatively large proportions of the sample. Here, the sources of clustering are at the patient-level and the matching-level.
