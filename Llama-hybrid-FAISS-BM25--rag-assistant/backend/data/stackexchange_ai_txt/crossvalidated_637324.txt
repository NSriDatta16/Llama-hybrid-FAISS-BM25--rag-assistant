[site]: crossvalidated
[post_id]: 637324
[parent_id]: 
[tags]: 
Test if two curves have the same shape

I have a gene expression measured for 5 humans (7 different layers each: L1, L2, L3, L4, L5, L6, WM) and 4 chimpanzee (7 different layers each: L1, L2, L3, L4, L5, L6, WM). What I want to do is to compare gene expression profiles across the layers. More specifically I want to check if two profiles have the same shape (see the picture). I feel that there should be an easy way to do this. Something like: Fit the smoothing spline for human profile Fit the smoothing spline for chimp profile Substract the two and compare it with y ~ mean_human - mean_chimp using F-test But I'm not sure how to do this right. For now I do it using permutations: I substracted the average across the layers for each sample to eliminate the difference because of average level of expression Fit the smoothing spline for human profile Fit the smoothing spline for chimp profile Fit the smoothing spline for (human + chimp) profile Calculate residuals for each model ( $RES_{H}$ , $RES_{C}$ , $RES_{HC}$ ) and F statistic $$ F = \frac{RES_{HC} - RES_{H} - RES_{C}}{RES_{H} + RES_{C}} $$ Do permutations (n=1000) to find the distribution of F-statistic and calculate p-value But it feels weird to compare the splines this way. The illustration of dataset table you can see here bellow Sample_id layer condition expression human1 L1 human 10 human1 L2 human 5 human1 L3 human 6 ... human1 WM human 7 human2 L1 human 11 ... human5 WM human 8 chimp1 L1 chimpanzee 20 chimp1 L2 chimpanzee 15 ... chimp4 WM chimpanzee 16
