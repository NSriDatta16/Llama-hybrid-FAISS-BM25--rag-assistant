[site]: crossvalidated
[post_id]: 291589
[parent_id]: 
[tags]: 
Finding time intervals where two groups of time series are significantly different

I have two sets of time series, let's call them $C$ and $D$. Assume that $C$ ($D$) has $n$ ($m$) samples (each sample is a time-series of length $T$). I want to assess if there are periods of time when $C$ and $D$ are significantly different. As a concrete example I have plotted the average time series of $C$ in solid and of $D$ in dashed: Note that I'm only plotting the average trajectories and not the individual ones. So I thought of going to each time point and do a Welch's t-test for unknown unequal variances and mark each time point where the test gives me a significant difference between the two sets for that time: But... We can see some isolated points where they are significantly different (e.g. around the beginning of the time series). Maybe we can expect that due to the fact that even if the two sets come from the same distribution, they could be different at that point by chance. On the other hand there is a period for which the test consistently gives me a significant difference for a long period of time. So I thought of only labeling as significantly different those points for which their say $5$ neighbours are also statistically different. But now I wonder... Is there a more principled way of assessing when two collections of time series are different? Should I do a non-parametric test? Should I use permutation tests? If so, how? PS: if you are interested, these are neural data and $C$ and $D$ refers to control and optogenetically perturbed activities (the perturbation started after the second dashed line and lasted until around the middle of the remaining space).
