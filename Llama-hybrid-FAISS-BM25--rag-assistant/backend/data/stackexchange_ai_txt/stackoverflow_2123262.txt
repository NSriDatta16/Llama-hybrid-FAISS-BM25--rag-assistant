[site]: stackoverflow
[post_id]: 2123262
[parent_id]: 1971361
[tags]: 
The problem is that the windows CHM viewer is basically MSIE (Internet Explorer). The exact rendering is probably version dependant. (and for the average file you'd probably want MSIE 6) In other words to get a faithful reproduction is to use some extracter (I use the one from CHMLIB or, lately, Free Pascal/Lazarus) to decompress the CHM (which is just an html archive with additional indexes), and fire up MSIE for each page, and instrumenting it to write to e.g. a virtual PDF writer. This way you have some chance to really capture it the way IE renders it. (and hope it doesn't render differently to printer than to screen). The TOC is in XML form in the .hhc files, and you could transform one of them to the PDF bookmarks treeview. If you somehow get the number of "pages" back from IE, you could probably even transform the index files to something you could add to the PDF, since you could make out on which page every topic is. But that is for the advanced class :-)
