[site]: crossvalidated
[post_id]: 501513
[parent_id]: 501496
[tags]: 
"Weighted choice sampling" means that you sample each category with some predefined probability, so you basically sample from a categorical distribution . If each category has fixed probability, there is not much else that you can do about. There are some methods for special cases like Gumbel-max trick when the probabilities are unnormalized, tricks to speed up sampling for large number of categories, etc., but those do not seem to be related to your problem, as you do not mention any technical problems that need solving. What we usually do when sampling from such language models, is we use softmax with temperature (see e.g. the blog post by Andrej Karpathy , this TensorFlow tutorial , or the Deep Learning with Python book by Fran√ßois Chollet for more details). The idea is pretty simple. When you make predictions from the model, you take the logits predicted by the final layer $z_i$ and pass them through softmax function, to transform them to probabilities i.e. $p_i = \exp(z_i) / \sum_j \exp (z_j)$ . The thing that we change is we introduce a hyperparameter, the temperature $T$ , so that the softmax function becomes: $$ p_i = \frac{\exp( z_i\,/\,T )}{\sum_j \exp( z_j\,/\,T )} $$ where $T=1$ leads to standard softmax, decreasing it makes the probabilities more extreme, hence more certain, so the samples are closer to the optimal values that would be predicted by the model, while increasing it leads to more diverse, "random" samples. Quoting Karpathy: Temperature. We can also play with the temperature of the Softmax during sampling. Decreasing the temperature from 1 to some lower number (e.g. 0.5) makes the RNN more confident, but also more conservative in its samples. Conversely, higher temperatures will give more diversity but at cost of more mistakes (e.g. spelling mistakes, etc). Then, you use those probabilities same way as you would do with the raw probabilities. See also the paper by Hinton, Vinyals, and Dean for another example of how temperature is used for other purposes.
