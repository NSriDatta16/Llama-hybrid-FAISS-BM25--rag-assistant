[site]: stackoverflow
[post_id]: 5440679
[parent_id]: 5440613
[tags]: 
Not knowing anything about the layout of your tables, the data in your tables, nor what you expect vs. what you have, I'm just guessing here. First, you probably need to repeat the use of SUM for the other instances where you access mc_gross and tax . Also, I think your use of subqueries is messing you up, in particular the two instances of SELECT SUM(totalamount) FROM table1 . I imagine you want to limit the rows used in the calculation of these sums similarly to how you do with totalagentsales . You can reuse the totalagentsales value if you move it into the FROM clause as follows: SELECT SUM(p.mc_gross) AS totalsales, SUM(p.tax) AS totlatax, q.totalagentsales, DATE_FORMAT(p.payment_date, '%d-%m-%Y') AS filter, (SUM(p.mc_gross) - SUM(p.tax) - q.totalagentsales) AS TotalRevenue, (SUM(p.tax) + q.totalagentsales) AS TotalPayment FROM table2 AS p, (SELECT SUM(totalamount) totalagentsales FROM table1 WHERE DATE_FORMAT(paydate, '%d-%m-%Y') = DATE_FORMAT(p.payment_date, '%d-%m-%Y') ) AS q GROUP BY filter LIMIT 0, 30 Edit SELECT SUM(p.mc_gross) AS totalsales, SUM(p.tax) AS totlatax, q.totalagentsales, DATE_FORMAT(p.payment_date, '%d-%m-%Y') AS filter, (SUM(p.mc_gross) - SUM(p.tax) - q.totalagentsales) AS TotalRevenue, (SUM(p.tax) + q.totalagentsales) AS TotalPayment FROM table2 AS p LEFT JOIN (SELECT SUM(totalamount) totalagentsales, DATE_FORMAT(paydate, '%d-%m-%Y') AS filter FROM table1 GROUP BY filter) AS q ON DATE_FORMAT(p.payment_date, '%d-%m-%Y') = q.filter GROUP BY filter LIMIT 0, 30
