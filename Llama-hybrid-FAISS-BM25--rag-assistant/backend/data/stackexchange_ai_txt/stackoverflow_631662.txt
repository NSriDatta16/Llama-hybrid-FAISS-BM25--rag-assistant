[site]: stackoverflow
[post_id]: 631662
[parent_id]: 631632
[tags]: 
That's because you can't dereference a void pointer without first casting it to something else. This is because the C implementation needs to know what type of object the dereferenced pointer is. In addition to the union suggested already, you can use the method you allude to, but you would have to conditionally convert (implicitly or explicitly with a cast) if you want to dereference storage: int *iptr; double *dptr; switch (x.type) { case typedouble: dptr = x.storage; // implcit conversion example // reference your "image" as dptr[i] now break; case typeint: iptr = (int *)x.storage; // explicit conversion, actually unnecessary // reference your "image" as iptr[i] now break; }
