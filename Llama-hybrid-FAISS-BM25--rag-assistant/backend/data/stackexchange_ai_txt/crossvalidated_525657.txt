[site]: crossvalidated
[post_id]: 525657
[parent_id]: 521389
[tags]: 
Thank you for your interest in our paper. I have written a recent survey on Rao-Blackwellisation with Gareth Roberts, more recently. Concerning your concerns: The formula \begin{align} &\frac{1}{T}\sum_{t=1}^Th(ϑ_t)\sum_{i=1}^T \mathbb{I}_{\theta^{(i)}=ϑ_t}\\ &\qquad=\frac{1}{T}\sum_{t=1}^Th(ϑ_t) \mathbb{E}\left[\sum_{i=1}^T \mathbb{I}_{\theta^{(i)}=ϑ_t}\middle|ϑ_1,...,ϑ_t\right] \\ \end{align} is incorrect since the second line is the Rao-Blackwellisation of the first one: \begin{align} &\mathbb E\left[\frac{1}{T}\sum_{t=1}^Th(ϑ_t)\sum_{i=1}^T \mathbb{I}_{\theta^{(i)}=ϑ_t}\middle|ϑ_1,...,ϑ_t\right]\\ &\quad=\frac{1}{T}\sum_{t=1}^Th(ϑ_t) \mathbb{E}\left[\sum_{i=1}^T \mathbb{I}_{\theta^{(i)}=ϑ_t}\middle|ϑ_1,...,ϑ_t\right] \\ \end{align} The equality \begin{align} &\frac{1}{T}\sum_{t=1}^Th(ϑ_t) \mathbb{E}\left[\sum_{i=1}^T \mathbb{I}_{\theta^{(i)}=ϑ_t}\middle|ϑ_1,...,ϑ_t\right] \\ &\quad=\frac{1}{T}\sum_{t=1}^Th(ϑ_t)\left(\sum_{i=1}^T\mathbb P\left(\theta^{(i)}=ϑ_t|ϑ_1,...,ϑ_t\right)\right) \end{align} is straightforward since \begin{align} &\mathbb{E}\left[\sum_{i=1}^T \mathbb{I}_{\theta^{(i)}=ϑ_t}\middle|ϑ_1,...,ϑ_t\right] \\ &\quad=\sum_{i=1}^T \mathbb{E}\left[\mathbb{I}_{\theta^{(i)}=ϑ_t}\middle|ϑ_1,...,ϑ_t\right]\\ &\quad=\sum_{i=1}^T\mathbb P\left(\theta^{(i)}=ϑ_t|ϑ_1,...,ϑ_t\right) \end{align} The computation of $$\mathbb P\left(\theta^{(i)}=ϑ_t|ϑ_1,...,ϑ_t\right)$$ is based on the integration of the uniform variates used to make the choice between the proposed value and the current value of the Markov chain. The computation is detailed in our 1996 paper with Georges Casella , as well as in our MCMC book .
