[site]: stackoverflow
[post_id]: 5152009
[parent_id]: 
[tags]: 
Detecting Internet Explorer bitness on the server side

I want to deliver an ActiveX object with the correct bitness for the requesting browser, meaning a 32-bit object for a 32-bit IE and a 64-bit object for a 64-bit IE. For this purpose I'm looking for some criterion, as good as reasonably possible, to distinguish between the two IE architectures. In order to make the decision on the server side, I should use the User-Agent request header, so the problem comes down to this: given the User-Agent string, how to detect, with common JSP mechanisms including just plain Java, the bitness of the IE instance which submitted the request? So far I found that 64-bit instances include the strings "Win64" and "x64" in the header, and 32-bit instances do not. If all versions and configurations of IE follow this behavior, the solution in a JSP is as easy as I would really like to find out if this behavior is an official IE specification, so I could count on it for all versions and configurations of IE from IE7 and to IE9. Did Microsoft publish any such specification? Note: I'm not tagging "Java" since the answer will most likely be relevant for other languages.
