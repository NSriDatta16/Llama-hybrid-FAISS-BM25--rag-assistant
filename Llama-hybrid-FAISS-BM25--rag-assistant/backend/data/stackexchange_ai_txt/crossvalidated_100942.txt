[site]: crossvalidated
[post_id]: 100942
[parent_id]: 
[tags]: 
MCMC Standard error

I need to make a simulation to calculate the integral of a pdf $f(x|D)$ over a region $T$.That is, I need to evaluate $$\int_T f(x|D)\; dx$$ to do this, I just defined the function $g(x)=1$ if $x \in T$ and $g(x)=0$ if $x$ is not in $T$. So the integral that I want to evaluate is $$\int_{D(f)} g(x)f(x|D)\;dx$$ where $D(f)$ is the domain of $f$, right? The Monte Carlo estimative of my integral is given by $$\bar{I}=\frac{1}{N} \sum_{i=1}^N g(x_i), x_i \sim f$$ right? And the Monte Carlo Standard Error is $$SE= \sqrt{\frac{1}{N}\sum_{i=1}^N(g(x_i)-\bar{I})^2}$$ I made a Python function to calculate this: def MCSE(g, estimativa): #Size of the vector g (which is composed of 0 and 1) N = int(len(g)) #Auxiliar vector vet vet = [] for i in range(N): vet.append(float((g[i]-estimativa)**2)) #Calculate the standard error and return SE = sqrt(np.mean(vet)) return SE Is my function correct? Because when I estimate the integral and it gives a value close to the real value of the integral (which I know from other ways), it is giving values close to 0.5, which doesn't seems correct. Thanks in advance!
