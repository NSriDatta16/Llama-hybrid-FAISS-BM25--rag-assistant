[site]: crossvalidated
[post_id]: 439698
[parent_id]: 
[tags]: 
How to calculate Bayes factor for conditional probability?

I have a data set of 1000 drug-effect pairs. I am trying to identify which drug is most likely given the observed effect. My original approach was to calculate $P\left(d_j | e_i\right)$ for each drug $d_j$ and effect $e_i$ , create an empiric probability distribution by resampling, estimate $p$ -values, and identify all pairs that passed the Benjamini-Yekutieli threshold. But, applying a correction for multiple hypothesis and frequentist testing to a Bayesian statistic seemed off. On further reading I discovered Bayes' factor, but I don't really understand how to calculate it. For each drug-effect pair $\left(d_j, e_i\right)$ I have two hypotheses: $H_0 \Rightarrow p\left(d_j\right) = p\left(d_j | e_i\right)$ $H_\alpha \Rightarrow p\left(d_j\right) \neq p\left(d_j | e_i\right)$ I assume $p\left(H_0\right) = p\left(H_\alpha\right)$ and $p\left(H_0\right) + p\left(H_\alpha\right) = 1$ . Bayes Factor = $\frac{\textrm{posterior odds}}{\textrm{posterior odds}} \Rightarrow \frac{p\left(H_\alpha | \textrm{D}\right)}{p\left(H_0 | \textrm{D}\right)}\Big / \frac{p\left(H_\alpha\right)}{p\left(H_0\right)}$ I don't know how to calculate the numerator of this fraction. One can switch the terms with Bayes' theorem, but I don't know how to calculate $p\left(\textrm{D} | H_O\right)$ either. My data are of form of matrices where the $ij$ th element indicates the number of times drug $i$ and effect $j$ were reported together. As a secondary question, I wonder why it seems that I wouldn't have to correct Bayes Factor for multiple comparisons.
