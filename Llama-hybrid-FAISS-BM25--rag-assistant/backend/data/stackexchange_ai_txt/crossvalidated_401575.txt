[site]: crossvalidated
[post_id]: 401575
[parent_id]: 
[tags]: 
IPTW for multiple treatments

I am dealing with a dataset where patients are subjected to multiple treatments A or B or C or D . Since there are four treatment options I am using multinomial regression to estimate the propensity score $e_i$ which are as follows Obs# Treatment e_A e_B e_C e_D 1 A 0.0011 0.4743 0.3380 0.1864 2 A 0.0013 0.3989 0.3678 0.2318 3 B 0.0171 0.2382 0.5900 0.1545 4 B 0.0355 0.3024 0.5086 0.1533 5 C 0.0171 0.2382 0.5900 0.1545 6 C 0.0355 0.3024 0.5086 0.1533 7 D 0.0791 0.1953 0.2979 0.4275 8 D 0.0272 0.2750 0.5415 0.1560 Now for IPTW I am following this article Moving towards best practice when using inverse probability of treatment weighting (IPTW) using the propensity score to estimate causal treatment effects in observational studies by Peter Austin and Beth Stuart, This this estimating casual effects among patients where all are in either of these treatment so I am using ATT not ATE. page 3 states that , weights for estimation of Average Treatment effect among the treated( ATT) : ${w_{ATT}} = Z_i+ \frac{(1-Z_i)e_i}{1-\hat{e}_i}$ , And furthure the author states, these weights are obtained by multiplying the conventional weights by e $_i$ , so that treated subjects receive a weight of one I am not sure I understand this. For example considering first observations Obs# Treatment e_A e_B e_C e_D 1 A 0.0011 0.4743 0.3380 0.1864 What is $w_i$ supposed to be, because if $Z_1=A$ indicates that $Z_1 = 1$ , I am not sure how 0.0011 0.4743 0.3380 0.1864 translates to a single estimate of $e_i$ , I suppose I could ignore $e_i$ in this equation ${w_{ATT}} = Z_i+ \frac{(1-Z_i)e_i}{1-\hat{e}_i}$ because $1-Z_i = 0$ and the this just leaves me with ${w_{ATT}} = Z_i$ so does this mean $w_i = 1$ ?? I know I am missing something here, if somebody can tell me where I am going wrong or how to calculate $w_i$ in a multi-treatment scenario while estimating ATT that will be helpful. Thanks.
