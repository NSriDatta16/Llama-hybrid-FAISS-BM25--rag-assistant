[site]: crossvalidated
[post_id]: 380254
[parent_id]: 
[tags]: 
GLM and implementation of Poisson regression model in R by hand

first of, this is not my school exercise but a given example that I'd like to convert from Stan to my own code. I am very much a pragmatic learner so doing this helps me a lot to visualize the problem. The problem is the following: #The data give numbers of fatal accidents on scheduled airline flights per year over a ten-year #period. Assume that the number of fatal accidents in year t follows a Poisson distribution with #mean theta where log(theta)=a+bt. #Year 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 #accidents 24 25 31 31 22 21 26 20 16 22 #theta[i] # `true' mean number of fatal accidents y = c(24, 25, 31, 31, 22, 21, 26, 20, 16, 22) # number of fatal accidents t = c(1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985) # year #Using noninformative priors on a and b, obtain the posterior distributions of a and b. Plot #the approximate probability density for the expected number of fatal accidents in year 1988. #Obtain the predictive interval for the the number of fatal accidents in 1988. Which is run with the following Stan model: //Poisson_regression_model data{ int N; //the number of observations real x[N]; //years, real because of mean int y[N]; // accidents } parameters{ real a_star; real b; } transformed parameters{ vector[N] log_theta; vector[N] theta; real a; a=a_star-b*mean(x); for( i in 1 : N ) { log_theta[i] = a_star+b*(x[i]-mean(x)); } theta=exp(log_theta); } model{ //priors a_star ~ normal(0, 10^3); b ~ normal(0, 10^3); //likelihood for( i in 1 : N ) { //see Stan reference manual page 520 y[i] ~ poisson_log(log_theta[i]); } } Full code and which I'd like to convert into my own, very naive implementation. So this is how far I got but I must have some mistake calculating my likelihood/log_theta. a_param_space Also I'm not sure have I named my variables correctly, it's very hard to me to convert the mathematical formula into programming terms. Say as another example I have a likelihood function $y_i|\theta_i \sim Bin(n_i, \theta_i)$ where $logit(\theta_i)=\alpha + \beta x_i$ with the link function $logit(\theta_i)=log(\theta_i/(1-\theta_i)$ . So this would mean I have to pass as a parameter to binomial density the values y-vector, n-vector and theta, where theta is computed from two parameters (with some values from parameter space), alpha and beta. Those two are then computed from the linear regression model: alpha + beta * x-vector which are inputted to the logit function (alpha + beta * x-vector)/(1-alpha + beta * x-vector) to get as a result a vector of log-odds? Am I almost correct? Thank you in advance for answering, I am very much a caricature programmer who knows how to code but can't understand math. No need to rub it in.
