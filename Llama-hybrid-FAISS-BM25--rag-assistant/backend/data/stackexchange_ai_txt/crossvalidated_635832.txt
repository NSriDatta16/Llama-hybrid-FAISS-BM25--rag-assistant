[site]: crossvalidated
[post_id]: 635832
[parent_id]: 
[tags]: 
Multilevel Regression and Poststratification (MRP) weighting in the opposite direction to Poststratification alone

We are using MRP to derive test norms for an IQ test ( Culture Fair Test , CFT) based on the TwinLife data. We adjust for age, sex, education, and migration background. Although a probability sample, the TwinLife sample turns out to be overeducated so MRP leads to an average reduction in raw test scores per age group (besides the obvious smoothing because of the penalised spline): However, what is surprising is that poststratification (P) without smoothing leads to larger, rather than smaller estimates on average: In the younger age groups (which aren't as outrageously sparse as groups 24-30 for example) it's particularly striking. What could be the reason for this? I know not all cells representing the combinations of the 4 adjustment variables are represented in the sample and others are really small and that in such cases one often recommends raking, but P by education marginals alone lead to very similar results for the younger age groups (even though on average across all age groups it leads to a similar reduction to MRP). I suspect it might have something to do with the way I'm calculating the P weights (using R): means_sds_and_ses_tl_ps % mutate(age = age0100) %>% left_join((census %>% filter(age % mutate(PS_w = census_n/sum(census_n))), by = c("age", "male", "mig", "educ")) %>% filter(age % mutate(PS_w = ifelse(is.na(PS_w), 0, PS_w)) %>% group_by(age) %>% summarise(Raw_n = n(), Raw_mean = mean(cft, na.rm = T), Raw_sd = sd(cft, na.rm = T), Raw_se_of_mean = Raw_sd/sqrt(Raw_n), PS_mean = weighted.mean(cft, PS_w, na.rm = T), PS_sd = sqrt(weighted.mean((cft - PS_mean)^2, PS_w, na.rm = T)), PS_se_of_mean = PS_sd/sqrt(Raw_n)) As you can tell from the code, I calculate the weights before joining, although that doesn't really matter in the end since weighted.mean normalises weights anyway. For weights by education marginals I did this instead: census_educ_only % group_by(educ) %>% summarise(census_n = sum(census_n)) %>% ungroup() means_sds_and_ses_tl_ps % mutate(age = age0100) %>% left_join((census_educ_only %>% mutate(PS_w = census_n/sum(census_n))) Am I doing anything wrong here? I unfortunately can't provide the actual data (these have to be requested from GESIS) and I don't know the source of this "issue" so I couldn't create an MRE but what I can provide are synthetic datasets that produce the same MRP estimates and very similar Raw and P estimates, alongside the code of course.
