[site]: stackoverflow
[post_id]: 989907
[parent_id]: 989347
[tags]: 
Alex - here is some old code I dug up to query excel. Pretty basic scenario here. Don't pay attention to the poor error handling and lack of the 'Using' construct. Dim connString As String = "Provider=Microsoft.Jet.OLEDB.4.0" & _ ";Data Source=" & ExcelFile & _ ";Extended Properties=Excel 8.0;" Dim conn As OleDbConnection = Nothing Dim dt As System.Data.DataTable = Nothing Dim excelDataSet As New DataSet() Try conn = New OleDbConnection(connString) conn.Open() dt = conn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, Nothing) If dt Is Nothing Then Return Nothing End If Dim excelSheets(dt.Rows.Count) As String Dim i As Integer = 0 For Each row As DataRow In dt.Rows excelSheets(i) = row("TABLE_NAME").ToString System.Math.Min(System.Threading.Interlocked.Increment(i), i - 1) If i = SheetNumber Then Exit For End If Next Using excelCommand As New OleDbCommand("Select * from [" & excelSheets(SheetNumber - 1) & "]", conn) Using excelAdapter As New OleDbDataAdapter(excelCommand) excelAdapter.Fill(excelDataSet) End Using End Using Catch ex As OleDbException Throw Catch ex As Exception Throw Finally conn.Close() If conn IsNot Nothing Then conn.Dispose() End If If dt IsNot Nothing Then dt.Dispose() End If End Try Return excelDataSet
