[site]: stackoverflow
[post_id]: 1485202
[parent_id]: 1485031
[tags]: 
$final_number is something you get from a racepage link right? You are using it to as $i . Instead i think you should use $i there as what you want to insert is a row for each link. What you can do is move the: $data[] = "('" . $final_location[0] . "', '" . $final_locationcode[0] . "', '" . $final_number[$i] . "', '" . $final_rating[$i] . "')"; ...line to the bottom of for($c=0; $c line which would make you code look like this starting from that point, (notice $data=array() is defined before the loop): $data = array(); for($c=0; $c [0-9]{1,2} #', $racepage, $number); preg_match_all('# [0-9]{1,3} #', $racepage, $rating); preg_match_all('# [\w]+([\s][A-Z]+)? #', $racepage, $location); preg_match_all('# [\w]+\s[0-9]+ #', $racepage, $locationcode); //strip tags for storage in DB $number_data = implode(",", $number[0]); $dbnumber = strip_tags($number_data); $final_number[] = explode(",", $dbnumber); $rating_data = implode(",", $rating[0]); $dbrating = strip_tags($rating_data); $final_rating[] = explode(",", $dbrating); $location_data = implode(",", $location[0]); $dblocation = strip_tags($location_data); $final_location[] = explode(",", $dblocation); $locationcode_data = implode(",", $locationcode[0]); $dblocationcode = strip_tags($locationcode_data); $final_locationcode[] = explode(",", $dblocationcode); $data[] = "('" . $final_location[0] . "', '" . $final_locationcode[0] . "', '" . $final_number[0] . "', '" . $final_rating[0] . "')"; } if(count($queries) != 0) { $query = "insert into ratings(location, location_code, tab_no, rating) values " . implode(", ", $data); $hostname = "%hostname%"; // eg. mysql.yourdomain.com (unique) $username = "%username%"; // the username specified when setting-up the database $password = "%password"; // the password specified when setting-up the database $database = "%database"; // the database name chosen when setting-up the database (unique) mysql_connect($hostname,$username,$password); mysql_select_db($database) or die("Unable to select database"); mysql_query($query) OR die(mysql_error()) } I think there are some problems with this code still. Edit :I also noticed that on this line $number_data = implode(",", $number[0]); Wouldn't $number[0] be a string, it couldn't be an array because $number is an array of matched strings so $number[0] would be the whole matched string. This would apply to 'number_data', 'rating_data', 'location_data' and 'locationcode_data' so you can $number_data = strip_tags($number[0]); and then when creating the insert data: $data[] = "('" . $final_location . "', '" . $final_locationcode . "', '" . $final_number . "', '" . $final_rating . "')";
