[site]: crossvalidated
[post_id]: 611808
[parent_id]: 
[tags]: 
Is it possible to specify a nested autocorrelation term when working with a hierarchical structure (GAM)?

I am modelling the occurrence of a species at 5 different sites on an hourly basis (presence/absence), based on a range of temporal predictors (e.g. time of the year, day/night cycle, tides ...). Covariates are indicated by x1, x2, ... in the code below. For information, I have ~70 000 data points. I am using a HGAM structure, as introduced in Pedersen et al.2019 . For each covariate, I first investigated different specification options (global smoother or not, shared penalty or not ...), and selected the best one based on AIC and my research question. When putting all of the terms together in the model, I end up with a structure like this: model The explained deviance of the model is only about 13%. Given the high temporal resolution (hourly), I expect some temporal autocorrelation in the residuals. I read in the bam() documentation, and in other posts ( here and there ), that this could be specified using the rho argument in bam() following the order of the dataset. However, I am not sure this applies when the model as a hierarchical structure ? I know it is feasible in gamm() , but the problem then is that I cannot specify multiple factor-smoother interaction terms as currently written in the model ... Is it something that could be tackled in brms ? Or any other way ? For information, here is the output of the acf and pcaf functions plot:
