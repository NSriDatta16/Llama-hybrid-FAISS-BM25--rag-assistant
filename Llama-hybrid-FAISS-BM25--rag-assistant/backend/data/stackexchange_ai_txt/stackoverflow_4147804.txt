[site]: stackoverflow
[post_id]: 4147804
[parent_id]: 4147775
[tags]: 
You could invoke sysinternals SDelete to do this for you. This uses the defragmentation API to handle all those tricky edge cases. Using the defragmentation API, SDelete can determine precisely which clusters on a disk are occupied by data belonging to compressed, sparse and encrypted files. If you want to repackage that logic in a more convenient form, the API is described here .
