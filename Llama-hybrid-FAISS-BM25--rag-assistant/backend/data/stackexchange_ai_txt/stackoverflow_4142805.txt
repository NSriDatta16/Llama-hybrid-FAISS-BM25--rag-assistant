[site]: stackoverflow
[post_id]: 4142805
[parent_id]: 
[tags]: 
How to load an image in ASP.NET from a database as a file in a web browser?

I have some images in a SQL Server database. I want to display them when a user clicks a button, but I want them to load into the browser as a file so that when the user resizes the window the images automatically resize. For example in Firefox if you go to File->Open File... and select an image on your computer, it will load it into a new window and resize it for you when you drag the scrollbars. My problem is, how do I get the image to load from a SQL Server database into the browser as a file? I have the following code on the form where the user clicks view within a GridView: function ShowImageInNewPage(url_add) { window.open(url_add, 'ViewScreenshot', 'resizable=yes,scrollbars = yes'); } > ');" /> DisplayImage.aspx has this code: protected void Page_Load(object sender, EventArgs e) { if (Request.QueryString["screenshotId"] != null) { int screenshotId= int.Parse(Request.QueryString["screenshotId"]); imgScreenshot.ImageUrl = "App_Handlers/ImageHandler.ashx?screenshotId=" + screenshotId; } } App_Handlers/ImageHandler.ashx has this code: using System; using System.Web; using System.Data; using DatabaseComponent; public class ImageHandler : IHttpHandler { public void ProcessRequest (HttpContext context) { if (context.Request.QueryString["screenshotId"] != null) { int screenshotId = int.Parse(context.Request.QueryString["screenshotId"]); DBUtil DB = new DBUtil(); DataTable dt = DB.GetScreenshot(screenshotId); if (dt != null) { Byte[] bytes = (Byte[])dt.Rows[0]["screenshot"]; context.Response.Buffer = true; context.Response.Charset = ""; context.Response.Cache.SetCacheability(HttpCacheability.NoCache); context.Response.ContentType = dt.Rows[0]["contentType"].ToString(); context.Response.AddHeader("content-disposition", "attachment;filename=" + dt.Rows[0]["fileName"].ToString()); context.Response.BinaryWrite(bytes); context.Response.Flush(); context.Response.End(); } } } public bool IsReusable { get { return false; } } } Here are the response headers for DisplayImage.aspx Server: ASP.NET Development Server/10.0.0.0 Date: Wed, 10 Nov 2010 13:13:37 GMT X-AspNet-Version: 4.0.30319 Transfer-Encoding: chunked Cache-Control: no-cache Pragma: no-cache Expires: -1 Content-Type: image/JPG Connection: Close I've changed my original question to use an image handler now thanks @leppie. Thanks for looking! UPDATE I've now changed DisplayImage.aspx to this code, but now I get some real weird behavior. When I click on an image link, this page loads and firefox asks if I want to save DisplayImage.aspx. What is going on? How can I get Firefox to load the image as a file? DisplayImage.aspx: " /> If I remove ContentType from the Page declaration the image loads into a new window however the image won't zoom, and won't resize itself. Pulling my hair out...
