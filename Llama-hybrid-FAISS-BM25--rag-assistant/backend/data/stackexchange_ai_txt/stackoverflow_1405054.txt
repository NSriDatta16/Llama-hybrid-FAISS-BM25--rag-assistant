[site]: stackoverflow
[post_id]: 1405054
[parent_id]: 
[tags]: 
How to reduce size of RTF with embedded images?

We have some code which produces an RTF document from a RTF template. It is basically doing string search and replaces of special tags within the RTF file. This is accessible via a web page. Typically, the processing time for this is really quick. However, we need to embed an image within a template. We've been embedding these as JPEG images using Word's "Insert/Picture/From File..." functionality. But we've found that the resultant RTF file size is massively dependant upon the image. For example, I've inserted a 20k JPEG logo (which is basically a solid background with some text). The RTF file increased in size from around 390k (without the image) to 510k (with the image). Then we inserted a JPEG containing a screenshot, i.e. the image contains text, multiple colours, etc. The JPEG is around 150k. Using this image, the RTF file increased in size from 390k to 3.5MB. So the encoding that Word uses for storing images into an RTF doesn't perform linearly. I'm guessing it is dependant upon what is in the JPEG image. I need to keep the size of the RTF templates to a minimum to try and keep our file processing times to a minimum. Does anyone have any ideas on how to minimize the size of the RTF files with embedded images? Is there any way of controlling the encoding that Word uses? I can't see any options anywhere. Does anyone know what type of binary encoding Word/RTF uses? Thanks in advance.
