[site]: crossvalidated
[post_id]: 381148
[parent_id]: 381085
[tags]: 
The log-likelihood function of a mixed-effects logistic regression model with normal random effects does not have a closed-form. In particular, it is defined as: $$\ell(\theta) = \sum_{i = 1}^n \log \int p(y_i \mid b_i; \theta) \, p(b_i; \theta) \; db_i,$$ where $y_i$ is the multivariate response vector for the $i$ -th subject. $b_i$ are the random effects, which have a normal distribution with mean zero and covariance matrix $D$ . $\theta$ is the parameters vector that includes the fixed effects regression coefficients, and the unique elements of the $D$ matrix. $p(y_i \mid b_i; \theta)$ is the binomial probability mass function (i.e., what you get from dbinom() ) conditional on the random effects. $p(b_i; \theta)$ is the probability density function of the multivariate normal distribution for the random effects. The integral in the definition of the log-likelihood above does not have a closed-form solution and needs to be approximated with numerical methods, such as the adaptive Gaussian quadrature. Hence, the log-likelihood of a mixed-effects logistic regression model cannot be calculated as sum(dbinom(..., log = TRUE)) .
