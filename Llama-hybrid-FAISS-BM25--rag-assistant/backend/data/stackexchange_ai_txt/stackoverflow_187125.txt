[site]: stackoverflow
[post_id]: 187125
[parent_id]: 
[tags]: 
Unit test Custom membership provider with NUnit throws null reference error

Trying to create a user account in a test. But getting a Object reference is not set to an instanve of an object error when running it. Here's my MemberShip provider class, it's in a class library MyCompany.MyApp.Domain.dll: using System; using System.Collections.Generic; using System.Web.Security; namespace MyCompany.MyApp.Domain { public class MyMembershipProvider : SqlMembershipProvider { const int defaultPasswordLength = 8; private int resetPasswordLength; public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config) { resetPasswordLength = defaultPasswordLength; string resetPasswordLengthConfig = config["resetPasswordLength"]; if (!String.IsNullOrEmpty(resetPasswordLengthConfig)) { config.Remove("resetPasswordLength"); if (!int.TryParse(resetPasswordLengthConfig, out resetPasswordLength)) { resetPasswordLength = defaultPasswordLength; } } base.Initialize(name, config); } public override string GeneratePassword() { return Utils.PasswordGenerator.GeneratePasswordAsWord(resetPasswordLength); } } } Here's my App.Config for my seperate Test Class Library MyCompany.MyApp.Doman.Test.dll that references my business domain library above: Here's my method that throws "Object reference is not set to an instanve of an object" public class MemberTest { public static void CreateAdminMemberIfNotExists() { MembershipCreateStatus status; status = MembershipCreateStatus.ProviderError; MyMembershipProvider provider = new MyMembershipProvider(); provider.CreateUser("Admin", "password", "someone@somewhere.co.uk", "Question", "Answer", true, Guid.NewGuid(), out status); } } it throws on the provider.CreateUser line
