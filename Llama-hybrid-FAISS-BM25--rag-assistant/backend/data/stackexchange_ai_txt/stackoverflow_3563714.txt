[site]: stackoverflow
[post_id]: 3563714
[parent_id]: 3561596
[tags]: 
You are telling the user agent to expect strlen($data) and then actually sending $header."\n".$data! Try something like this at the end of your code... $output=$header."\n".$data; // create table header showing to download a xls (excel) file header("Content-type: application/octet-stream"); header("Content-Disposition: attachment; filename=$export_filename"); header("Cache-Control: public"); header("Content-length: " . strlen($output); // tells file size header("Pragma: no-cache"); header("Expires: 0"); // output data echo $output;
