[site]: stackoverflow
[post_id]: 2065059
[parent_id]: 2064025
[tags]: 
Here is the less cluttered version I came up with: $url = preg_replace('~^www[.]~i', 'http://www.', array_shift($url)); $parts = parse_url($url); if (is_array($parts)) { $depth = 2; $length = 50; if (array_key_exists('host', $parts)) { $result = preg_replace('~^www[.]~i', '', $parts['host']); if (array_key_exists('path', $parts)) { $result .= preg_replace('~/+~', '/', $parts['path']); } if (array_key_exists('query', $parts)) { $result .= '?' . $parts['query']; } if (array_key_exists('fragment', $parts)) { $result .= '#' . $parts['fragment']; } if (strlen($result) > $length) { while ($depth > 0) { $result = implode('/', array_slice(explode('/', $result), 0, $depth-- + 1)) . '/'; if (strlen($result)
