[site]: stackoverflow
[post_id]: 5276700
[parent_id]: 
[tags]: 
How to call a .net method with an output parameter?

I just want to call the GenerateScript method of Microsoft.Data.Schema.ScriptDom.Sql.Sql100ScriptGenerator from PowerShell. #C public void GenerateScript( IScriptFragment scriptFragment, out string script ) I found this , but I do not get it to work $sg = new-object Microsoft.Data.Schema.ScriptDom.Sql.Sql100ScriptGenerator $sql = 'select * from PowerShell' $out = '' $sg.GenerateScript($sql, [ref] $out) $out this gives Cannot find an overload for "GenerateScript" and the argument count: "2". At line:6 char:19 + $sg.GenerateScript Edit: Current version is $sql = 'select * from PowerShell' $sr = new-Object System.IO.StringReader($sql) $sg = new-object Microsoft.Data.Schema.ScriptDom.Sql.Sql100ScriptGenerator $parser = new-object Microsoft.Data.Schema.ScriptDom.Sql.TSQL100parser($true) $errors = '' $fragment = $parser.Parse($sr,([ref]$errors)) $out = '' $sg.GenerateScript($fragment,([ref][string]$out)) $out But I get an error in line $fragment = $parser.Parse($sr,([ref]$errors)) Cannot find an overload for "Parse" and the argument count: "2". At line:11 char:26 + $fragment = $parser.Parse I'm trying to convert IList errors; using (StringReader sr = new StringReader(inputScript)) { fragment = parser.Parse(sr, out errors); } Edit: OK this works: $sql = @' select * from PowerShell -- a comment where psRefnr = 1 '@ $options = new-object Microsoft.Data.Schema.ScriptDom.Sql.SqlScriptGeneratorOptions $sr = new-Object System.IO.StringReader($sql) $sg = new-object Microsoft.Data.Schema.ScriptDom.Sql.Sql100ScriptGenerator($options) $parser = new-object Microsoft.Data.Schema.ScriptDom.Sql.TSQL100parser($true) $errors = $null $fragment = $parser.Parse($sr,([ref]$errors)) $out = $null $sg.GenerateScript($fragment,([ref]$out)) $out and generates ( it removes the comment as intended ) SELECT * FROM PowerShell WHERE psRefnr = 1;
