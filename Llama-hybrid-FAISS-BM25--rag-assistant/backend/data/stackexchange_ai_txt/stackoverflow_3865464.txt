[site]: stackoverflow
[post_id]: 3865464
[parent_id]: 
[tags]: 
Search filesystem for filepath using VBA

I am looking for a way to search a specific folder for a subfolder containing a certain string. Below I have listed a function I typed off the top of my head to see if it would work. Well, it does work but when I am talking about searching through 6,000 folders on a network drive it just isn't fast enough. I'm sure that there is a better way to do it but I can't seem to dig anything up on Google. Is there an object that allows me to leverage the windows built in file system searching and indexing capabilities? As an alternative, does someone have a way to optimize my code? The main bottleneck is the usage of instr . Here is the code: Function findPath(strId As String) As String checkObj Dim strBase As String strBase = opt.photoBasePath Dim fs As Object Set fs = CreateObject("Scripting.FileSystemObject") Dim baseFolder As Object Set baseFolder = fs.getfolder(strBase) Dim folder As Object For Each folder In baseFolder.subfolders If InStr(1, folder.name, strId) > 0 Then findPath = strBase & "\" & folder.name Exit Function End If Next folder End Function P.S. I'm sure someone will suggest modifying my folder structure so that I can programmatically predict the path but for various reason that isn't possible in my case.
