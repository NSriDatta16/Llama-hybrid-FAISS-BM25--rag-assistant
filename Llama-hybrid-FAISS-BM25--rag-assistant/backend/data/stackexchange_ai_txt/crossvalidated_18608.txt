[site]: crossvalidated
[post_id]: 18608
[parent_id]: 
[tags]: 
Principal component analysis before nearest neighbor search

I have a large data table (~500,000 rows) of normalized metrics (by Z-score) that looks like this: +------+---------------+---------------+---------------+---------------+ | ID | M1 | M2 | M3 | M4 | +------+---------------+---------------+---------------+---------------+ | 1 | -0.3993408978 | 1.1276756525 | -0.0048326259 | -1.3967152834 | | 2 | -0.3244025409 | 1.3201564550 | -0.0548842102 | -1.3317097425 | | 3 | -0.3025048971 | 1.0483477116 | -0.0849148855 | -1.3642125130 | | 4 | -0.2436245084 | 1.2600721121 | 0.0101827132 | -1.2992069721 | | 5 | -0.2781734169 | 0.3511493504 | -0.3752114475 | -1.4617208242 | | 6 | -0.2815801203 | 0.3369039595 | -0.3201552033 | -1.4617208242 | | 7 | -0.2197803259 | 0.5600918531 | -0.1750069261 | -1.3967152834 | | 8 | -0.1579796672 | 0.3966214657 | -0.0949251130 | -1.3967152834 | | 9 | -0.1209969074 | 0.0815875754 | -0.0799097717 | -1.4292180538 | | 10 | -0.1910693198 | -0.6976287961 | -0.2500836253 | -1.5917314291 | +------+---------------+---------------+---------------+---------------+...500,000 rows I also have a query point that looks like this: +---------------+--------------+---------------+---------------+ | M1 | M2 | M3 | M4 | +---------------+--------------+---------------+---------------+ | -0.5185617805 | 0.0669142157 | -0.2050375938 | -1.6918823719 | +---------------+--------------+---------------+---------------+ (1 row) I then use the query point to create a list of 300 neighbors nearest to it (with a multidimensional k-NN algorithm). What I would like to do is to is to transform the data with PCA before doing the k-NN search. I can do this with the ALGLIB library INPUT PARAMETERS: X - dataset, array[0..NPoints-1,0..NVars-1]. matrix contains ONLY INDEPENDENT VARIABLES. NPoints - dataset size, NPoints>=0 NVars - number of independent variables, NVars>=1 OUTPUT: Info - return code: * -4, if SVD subroutine haven't converged * -1, if wrong parameters has been passed (NPoints So as far as I understand, S2 will contain my transformed data - but how do I transform the query point in the same manner - so I could use it for the K-NN search on the transformed data? I am guessing I need to use V - the column that stores basis vectors. And then I'm guessing its some sort of matrix operation to transform my query point about the appropriate basis vector? Am I correct in my assumptions? How do I do this? This is all very new to me and I have no relevant background, so if possible please provide a lay man explanation.
