[site]: crossvalidated
[post_id]: 412528
[parent_id]: 
[tags]: 
Best way to estimate the probabilities of a random variable

I have some confusion about estimating the probability of a particular value of a random variable. For simplicity, consider the case of a coin and the random variable being $X = \{H,T\}$ , where $T$ is drawing a tail and $H$ a head. I know that you can estimate the probability of drawing a tail experimentally by counting the number of tails, $N_T$ , after an infinite number of throws, $N$ : $$p_{T} = \lim_{N \to \infty} \frac{N_T}{N}.$$ In practice, however you have something like this, when plotting $p_T (N)$ : That is, it converges slowly and you never have the real value. My question: What is the best way to estimate $p_T$ , $\bar{p}_T$ , and a measure of the uncertainty of the estimation $\varepsilon_{\bar{p}_T}$ ? Approach 1: Maximum likelihood I have read somewhere that the most simple estimate, that is, $$\bar{p}_{T}^I = \frac{N_T}{N},$$ is also the most probable one according to our data (I'm not 100% sure I understand this argument). However, how can I estimate its uncertainty? Something like the standard deviation of the mean? $$\varepsilon_{\bar{p}_T} = \frac{\sigma_T}{\sqrt{N}} = \sqrt{\frac{1}{N(N-1)}\sum_{i=1}^N \left( X_i^T - \bar{p}_{T}^I \right)^2 } $$ where $X_i^T=1$ if we have a tail in throw $i$ ? Approach 2: Moving average after a transient number of points What I feel makes more sense to me looking at the previous plot is instead of taking the last value as our estimate, taking a moving average after some $\alpha$ points, in the previous plot it could be for example $\alpha = 10000$ : $$\bar{p}_T^{II} = \frac{1}{N-\alpha+1} \sum_{t=\alpha}^N \frac{N_T^t}{t},$$ where $N_T^t$ is the number of tails at step $t$ . In this way you are filtering over the fluctuations you can see in the picture and you can estimate the error of $\bar{p}_T^{II}$ as the standard deviation of the moving average. I have plotted this measure and its error in the horizontal lines, and I think it does look quite good. With this method you would avoid that you take as the average the value of a fluctuating peak for example. However, I can see with this method you are giving more importance to older draws than recent draws, as the draw from time $t=\alpha$ appears $N-\alpha+1$ times in the expression but the draw from time $t=N$ appears only once, which does not make much sense. For example, if you draw only one event at time $t=\alpha$ , you would get $\frac{1}{N-\alpha +1}\sum_{t=\alpha}^N \frac{1}{t}$ which is greater than drawing one event at time $t=N$ , $\frac{1}{N-\alpha +1} \frac{1}{N}$ . Can you provide some discussion about which is the best method to use and how to solve the apparent paradox when using the moving average (it seems to avoid fluctuations but to give more importance to older events)?
