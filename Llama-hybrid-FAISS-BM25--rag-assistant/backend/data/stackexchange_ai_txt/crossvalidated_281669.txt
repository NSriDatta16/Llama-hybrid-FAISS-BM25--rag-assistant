[site]: crossvalidated
[post_id]: 281669
[parent_id]: 
[tags]: 
Simulate a sample of the posterior predictive distribution in a Bayesian hierarchical model

Suppose the following Bayesian hierarchical model: $$ Y|\lambda\sim\text{Pois}(\lambda) $$ $$ \log(\lambda)|(\mu,\sigma)\sim N(\mu,\sigma)$$ $$ \mu\sim N(0,10) $$ $$ \sigma\sim\text{Gamma}(0.01,0.01).$$ Suppose an observation $y$ of $Y$. I am interested on the theoretical simulation of a sample from the posterior predictive distribution of $Y$, written as $p(\tilde{y}|y)$. Is the following procedure correct? Take a sample from the posterior distribution of $\mu$ and $\sigma$ : $\mu^{(1)},\ldots,\mu^{(M)}$ and $\sigma^{(1)},\ldots,\sigma^{(M)}$ (assume we have it, from WinBUGS for example). Generate an observation $\eta^{(i)}$ from $N(\mu^{(i)},\sigma^{(i)})$, $i=1,\ldots,M$. Generate an observation $\gamma^{(i)}$ from $\text{Pois}(\exp(\eta^{(i)}))$, $i=1,\ldots,M$. Then $\gamma^{(1)},\ldots,\gamma^{(M)}$ is a sample from $Y$.
