[site]: stackoverflow
[post_id]: 3786529
[parent_id]: 3758062
[tags]: 
Modification of Apple's sample code for programmatically adding tables to NSAttributedString : - (NSMutableAttributedString *) printTitleTableAttributedString { NSMutableAttributedString *tableString = [[NSMutableAttributedString alloc] initWithString:@"\n\n"]; NSTextTable *table = [[NSTextTable alloc] init]; [table setNumberOfColumns:3]; [tableString appendAttributedString:[self printTitleTableCellAttributedStringWithString:@"1. zadatak\n" table:table textAlignment:NSLeftTextAlignment row:0 column:0]]; [tableString appendAttributedString:[self printTitleTableCellAttributedStringWithString:[self.problemname.stringValue stringByAppendingString:@"\n"] table:table textAlignment:NSCenterTextAlignment row:0 column:1]]; [tableString appendAttributedString:[self printTitleTableCellAttributedStringWithString:@"20 bodova\n" table:table textAlignment:NSRightTextAlignment row:0 column:2]]; [table release]; return [tableString autorelease]; } - (NSMutableAttributedString *) printTitleTableCellAttributedStringWithString:(NSString *)string table:(NSTextTable *)table textAlignment:(NSTextAlignment)textAlignment row:(int)row column:(int)column { NSColor *backgroundColor = [NSColor colorWithCalibratedRed:0 green:0 blue:0x80/255. alpha:0xFF];; NSColor *borderColor = [NSColor whiteColor]; NSTextTableBlock *block = [[NSTextTableBlock alloc] initWithTable:table startingRow:row rowSpan:1 startingColumn:column columnSpan:1]; [block setBackgroundColor:backgroundColor]; [block setBorderColor:borderColor]; [block setWidth:0.0 type:NSTextBlockAbsoluteValueType forLayer:NSTextBlockBorder]; [block setWidth:2.0 type:NSTextBlockAbsoluteValueType forLayer:NSTextBlockPadding]; NSMutableParagraphStyle *paragraphStyle = [[NSParagraphStyle defaultParagraphStyle] mutableCopy]; [paragraphStyle setTextBlocks:[NSArray arrayWithObjects:block, nil]]; [paragraphStyle setAlignment:textAlignment]; [block release]; NSMutableAttributedString *cellString = [[NSMutableAttributedString alloc] initWithString:string]; [cellString addAttribute:NSParagraphStyleAttributeName value:paragraphStyle range:NSMakeRange(0, [cellString length])]; [cellString addAttribute:NSForegroundColorAttributeName value:[NSColor whiteColor] range:NSMakeRange(0, [cellString length])]; [paragraphStyle release]; return [cellString autorelease]; } Then I just append it into the textview: [printText.textStorage setAttributedString:[self printTitleTableAttributedString]];
