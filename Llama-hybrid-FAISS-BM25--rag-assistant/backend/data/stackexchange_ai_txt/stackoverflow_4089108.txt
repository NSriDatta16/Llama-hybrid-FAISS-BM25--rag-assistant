[site]: stackoverflow
[post_id]: 4089108
[parent_id]: 
[tags]: 
sql update procedure

I have used an SQL function to update single records when called: The function is: function ToggleAnimalExclusion (AnimalId in number, StudyID in number) return number is PRAGMA AUTONOMOUS_TRANSACTION; exVal varchar2 (1); begin select exclude into exVal from mbddx_study where study_name = AnimalId and study_id = StudyID; if (exVal is null) then update mbddx_study set exclude = 'Y' where study_name = AnimalId and study_id = StudyID ; else update mbddx_study set exclude = NULL where study_name = AnimalId and study_id = StudyID ; end if ; commit; return 0; end ; This works when called from a Perl script and the single database field is updated. Now, I want to update a grouping of fields, using the same structure as above, but each study_name is part of a study_group. SO I want to update the whole group, when the group number is passed in (instead of the study_name). The code I have is: function ToggleBoxExclusion (BoxId in number, StudyID in number) return number is PRAGMA AUTONOMOUS_TRANSACTION; exVal varchar2 (1); begin select exclude into exVal from mbddx_animal where box = BoxId and study_id = StudyID; if (exVal is null) then update mbddx_animal set exclude = 'Y' where box = BoxId and study_id = StudyID ; else update mbddx_animal set exclude = NULL where box = BoxId and study_id = StudyID ; end if ; commit; return 0; end ; As you can see, it is very similar and I think the problem lies with me trying to update a number of fields. As it stands, no fields are updated when I call this function. Any ideas?# Thanks.
