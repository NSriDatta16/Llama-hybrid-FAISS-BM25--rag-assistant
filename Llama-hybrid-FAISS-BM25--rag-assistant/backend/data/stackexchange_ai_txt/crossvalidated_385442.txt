[site]: crossvalidated
[post_id]: 385442
[parent_id]: 
[tags]: 
How to use a G-Wishart distribution in stan

I would like to use the following kind of prior in a Stan simulation $$ f_{K \mid G} (k \mid g) = \frac{1}{I_g(b,D)}|k|^{\frac{b-2}{2}} \exp \biggl \{ -\frac{1}{2} \text{tr} (Dk) \biggr \}\mathbb{1}_{P_g}(k)$$ where, for $p \in \mathbb{N}$ , $k$ is a real valued $p \times p$ matrix, $b >2$ , $b \in \mathbb{N}$ , $D$ is a real valued $p \times p$ positive definite matrix and $g =(V_g,E_g)$ is an undirected graph with $V_g= \{1, \dots, p\}$ vertexes and $E_g \subset V_g \times V_g$ edges. The set $P_g$ is defined as follows: $$ P_g := \{ A \in S_+(p) \mid A(i,j)=0 \Leftarrow (i,j) \in V_g\times V_g \setminus E_g \}$$ where $S_+(p)$ is the set of real valued $p \times p$ positive definite matrices. Here $I_g(b,D)$ is the normalization constant for the distribution. $b$ and $D$ are known parameters but $G$ is distributed as the uniform on the space of graphs with $p$ nodes. This kind of prior is taken from the article "Mohammadi and Wit, Bayesian Structure Learning in Sparse Gaussian Graphical Models". The problem is the calculation of the normalizing constant. I can obtain simulation of this prior from an other software but how to put it into stan?
