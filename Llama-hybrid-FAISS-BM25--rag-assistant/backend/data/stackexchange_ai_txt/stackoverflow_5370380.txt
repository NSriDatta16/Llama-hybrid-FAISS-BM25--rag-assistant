[site]: stackoverflow
[post_id]: 5370380
[parent_id]: 1243240
[tags]: 
To do Drag & Drop in a secure way, isn't so simple with batch. Dealing with %1 , shift or %* could fail, because the explorer is not very smart, while quoting the filenames, only filenames with spaces are quoted. But files like Cool&stuff.png are not quoted by the explorer so you get a cmdline like pngCr.bat Cool&stuff.png So in %1 is only Cool even in %* is only Cool , but after the batch ends, cmd.exe tries to execute a stuff.png (and will fail). To handle this you could access the parameters with !cmdcmdline! instead of %1 .. %n , and to bypass a potential error at the end of execution, a simple exit could help. @echo off setlocal ENABLEDELAYEDEXPANSION rem Take the cmd-line, remove all until the first parameter set "params=!cmdcmdline:~0,-1!" set "params=!params:*" =!" set count=0 rem Split the parameters on spaces but respect the quotes for %%G IN (!params!) do ( set /a count+=1 set "item_!count!=%%~G" rem echo !count! %%~G ) rem list the parameters for /L %%n in (1,1,!count!) DO ( echo %%n #!item_%%n!# ) pause REM ** The exit is important, so the cmd.ex doesn't try to execute commands after ampersands exit Btw. there is a line limit for drag&drop operations of ~2048 characters, in spite of the "standard" batch line limit of ~8192 characters. As for each file the complete path is passed, this limit can be reached with few files.
