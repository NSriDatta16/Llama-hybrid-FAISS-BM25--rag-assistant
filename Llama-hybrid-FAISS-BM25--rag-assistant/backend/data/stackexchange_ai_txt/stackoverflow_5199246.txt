[site]: stackoverflow
[post_id]: 5199246
[parent_id]: 
[tags]: 
How to generate a CMS (cryptographic message syntax) with Mono Framework and BouncyCastle API?

I have a Certificate in PKCS#12 format and I need to generate a CMS signature (Cryptographic Message Syntax). Due that "Mono Framework" does not have a full implemented "System.Security.Cryptography" assembly, I am trying to use "Bouncy Castle API for C#". So, using "Bouncy Castle", I need to write an alternative code to the one I had wrote on DOTNET. The code on DOT NET is the following: X509Certificate2 crt = new X509Certificate2(); byte[] crtBytes = [ certificate in the format PKCS12 (certificate + private key) obtained using FileStream class] crt.Import(crtBytes, "123456", X509KeyStorageFlags.DefaultKeySet); Encoding msgCodificado = Encoding.UTF8; byte[] msgBytes = msgCodificado.GetBytes(xmlTRA.OuterXml); // xmlTRA.OuterXml is the data to sign ContentInfo pkcsContentInfo = new ContentInfo(msgBytes); SignedCms cms = new SignedCms(pkcsContentInfo); CmsSigner firmante = new CmsSigner(crt); firmante.IncludeOption = X509IncludeOption.EndCertOnly; cms.ComputeSignature(firmante); // ---> throw an cryptografy exception with MONO byte[] firma = cms.Encode(); firmaB64 = Convert.ToBase64String(firma); Anyone knows how to write an alternative code using "Bouncy Castle API for C#"?
