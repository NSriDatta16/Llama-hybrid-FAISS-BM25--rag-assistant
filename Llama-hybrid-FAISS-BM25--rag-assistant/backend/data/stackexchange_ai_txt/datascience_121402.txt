[site]: datascience
[post_id]: 121402
[parent_id]: 121396
[tags]: 
for anyone who is looking for answer. This is the change i made.Thanks to @brewmaster321 UPVOTE his answer # image inputs image_input = Input(shape=IMG_SHAPE) print(image_input.shape) x = resnet_preprocessing(image_input) print('preprocess: ', x.shape) x = resnet(x) print('resnet: ',x.shape) x = GlobalAveragePooling2D()(x) # add a pooling layer\ print('polling: ',x.shape) x = Dense(UNITS*max_len)(x) print('dense: ',x.shape) # now (32, 128*50) => (32, 6400(multiple of 6400)) as required x = tf.reshape(x, (-1, max_len, UNITS)) print('reshape: ',x.shape) print('') in Dense layer instead of just Dense(UNITS) now is Dense(UNITS*max_len) removed Flatten() layer and added GlobalAveragePooling2D()
