[site]: crossvalidated
[post_id]: 175507
[parent_id]: 
[tags]: 
Bayesian modeling and FDR correction

Question Assume that we have 2 experiments, each of which yields $N$ observations. We label them $(c_1^i,\ldots,c_N^i)$ with $i=1,2$. Each observation is a positive integer, and can be modeled as a Poisson variate. We wish to know where the two experiments disagree. Assume further that in the classical context, the appropriate analysis for this experiment would be to Perform a rate ratio test on all pairs of observations, asking whether $c_i^1$ and $c_i^2$ have the same Poisson rate ($\mathcal{H}_0$) or not ($\mathcal{H}_1$) Perform a FDR (Benjamin-Hochberg) correction on the $p$-values to account for multiple testing Select those pairs with $q I would like to know what is the Bayesian take on this, in particular at step 2. Ideas I have pursued a model comparison approach, but am stuck at step 2 First, I write the probability for two observations and one rate, model $M_1$: $$p(M_1|c_i^1,c_i^2) = \int \text{d}\lambda p(c_i^1,c_i^2|\lambda)p(\lambda)$$ Or two rates, model $M_2$: $$p(M_2|c_i^1,c_i^2) = \int \text{d}\lambda_1\text{d}\lambda_2 p(c_i^1|\lambda_1)p(c_i^2|\lambda_2)p(\lambda_1)p(\lambda_2)$$ I use a proper prior for $p(\lambda)$, which I don't want to discuss here. Then, I compute the Bayes factor for these two models: $K_i = p(M_2|c_i^j)/p(M_1|c_i^j)$ assuming equal prior odds. The Bayes factor for all observations then factorizes into the individual pairs: $K=K_1\cdots K_N$ Now, the big question, is how do we assign most probable models to each pair? a) Maximize K, e.g. give 1 rate to points for which $K_i b) Seek a combination to reach, say, $K\simeq 3$. But how do I do that? That sounds much closer to FDR to me. Write down the posterior probability of one rate being larger than the other, and use this probability in a setting similar to the definition of a $p$-value. I did not try this yet but thought I could write it here.
