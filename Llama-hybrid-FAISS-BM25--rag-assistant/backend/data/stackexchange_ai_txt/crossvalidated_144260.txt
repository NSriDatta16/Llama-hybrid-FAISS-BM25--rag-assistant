[site]: crossvalidated
[post_id]: 144260
[parent_id]: 144250
[tags]: 
Using R you can just fit a linear model, such as fit . This will produce two intercepts, one for each level ("X" and "Y") of the factor "C". From there you can perform diagnostics by simply invoking plot(fit) , or with specific commands, such as dfbeta(fit) . EDIT: Following is an example of OLS regression calculated both with linear algebra and with the R built-in functions to kind of avoid leaving any stoned unturned... Scenario: We want to predict the money spent in self-indulgence in one year (don't ask...) in $US based on two parameters: demographics ( categorical or factor variable with levels "ch" for child; "f" for female; and "m" for male) and height (in cm). I know... silly... But I'll stay out of controversy... Here are the vectors to code the y variable (yearly expenditures) and to code for the demographics dummy variable: y Let's construct the design matrix A : A It looks like this: ch f m [1,] 1 0 0 [2,] 1 0 0 [3,] 0 1 0 [4,] 0 1 0 [5,] 0 0 1 [6,] 0 0 1 And let's calculate the OLS model, remembering the formula: $\hat{\beta}=(A^{T}A)^{-1}A^{T}y$ solve(t(A) %*% A) %*% t(A) %*% y [,1] ch 55 f 900 m 1900 Exactly the average expenditure for each demographic group! Makes sense... Using the built-in formula in R: lm(y ~ A) (Intercept) Ach Af Am 1900 -1845 -1000 NA We get the same results with the (Intercept) corresponding to males (that's why "Am" is NA); children being 1900 - 1845 = 55; and women, 1900 - 1000= 900. Now let's add the variable height in cm: H And let's add this vector to the design matrix: A And run the regression - we want to predict money spent based on gender and height: round(solve(t(A) %*% A) %*% t(A) %*% y,3) [,1] ch -1021.667 f -968.333 m -348.333 H 12.667 Now the intercepts make no intuitive sense, because we want a slope to fit the entire data cloud: H = 12.7. The built-in function $lm(y \sim A)$ results in: Coefficients: (Intercept) Ach Af Am AH -348.33 -673.33 -620.00 NA 12.67 Corresponding to -348.33 - 673.33 = -1021.66 for children and -348.33 - 620.00 = -968.33 for females. Let's see if it sort of works: fit compared to y Not that bad...
