[site]: crossvalidated
[post_id]: 359394
[parent_id]: 
[tags]: 
Rayleigh quotient, traces and LDA optimization problem

I've been working about Linear Discriminant Analysis the last weeks, and after reading many articles, I see some aspects of this problem not very clear. The LDA optimization problem is formulated by defining the within-class ($S_w$) and between class ($S_B$) scatter matrices, and, despite the solution proposed everywhere consists in taking the eigenvectors of $S_{w}^{-1}S_B$ (let's assume that the matrices are regular enough to talk about inverses), the problem formulations I have seen are different and some of them don't seem to lead to that solution. For example, one of the formulations consists in finding a matrix $U = (u_1,\dots,u_r)$, where $u_i$ are column vectors, whose vectors maximize the generalized Rayleigh quotient sum, $$ R(U) = \sum_{i=1}^r \frac{u_i^TS_Bu_i}{u_i^TS_wu_i}$$ In this case, there exist a regular matrix $P$ so that $P^TS_BP = D$ is diagonal and $P^TS_wP = I$, and we can convert the generalized Rayleigh quotient sum in a common Rayleigh quotient sum, $$ r(U) = \sum_{i=1}^r \frac{y_i^TDy_i}{y_i^Ty},$$ where $u_i = P^{-1}y_i$, so there is a bijective correspondence between both quotients. The second problem leads to the general PCA optimization problem $$ \max_{U^TU = I} tr(U^TDU) ,$$ for which I know how to find the solution (in this case, the leading elements of the canonical basis, since $D$ is diagonal), and after applying $P$, we obtain the eigenvectors of $S_w^{-1}S_b$. However, I usually find LDA with this trace optimization problem: $$ \max tr((U^TS_wU)^{-1}(U^TS_BU)), $$ and in this case I can't rewrite this as a Rayleigh quotient sum. A still more different problem is the following one, for which I don't expect to have the same solution as the others, but anyways it is usually mentioned in LDA explanations: $$\max \frac{tr(U^TS_BU)}{tr(U^TS_wU)}. $$ Even sometimes the trace is substituted by a determinant. So, which of these problems really lead to the solution of taking the eigenvectors of $S_w^{-1}S_B$?
