[site]: datascience
[post_id]: 115135
[parent_id]: 
[tags]: 
can't convert lists to tensor in tensorflow python

I'm relatively new to ML and data science and I'm using tensorflow and keras to do a NLP project. I have about 18000 emails, in my code I convert each word in every email to a vector of shape (1,50) and then add all those arrays to a list. Obviously the length of those lists are different. When trying to fit my model I receive error. How my arrays look like: [[float, float,....,float],[float, float,....,float],....] My code: train_data, test_data=train_test_split(DataFrame_2,test_size=0.2, train_size=0.8,random_state=0,stratify=DataFrame['Label']) #print(test_data) #Creating the model as a function def MyModel(): model=Sequential() model.add(LSTM(100, dropout=0.15)) model.add(LSTM(100, dropout=0.15)) model.add(Dense(1,'relu')) optim=keras.optimizers.Adam() model.compile(optimizer=optim, loss='binary_crossentropy', metrics=['accurcay']) return model model=MyModel() model.fit(tf.convert_to_tensor(train_data["Body"]), train_data["Label"], batch_size=64, epochs=25, verbose=1, validation_split=0.20, use_multiprocessing=True) What I have tried: I tried used convert_to_tensor() function both in first line (where I'm splitting the data), where I was fitting the data and also where I was making the array of vectors like this: for sent in tqdm(num_sent): vectorized.append([embedding_matrix_vocab[num] for num in sent]) DataFrame_2=pd.DataFrame({'Body':vectorized, "Label":DataFrame["Label"]}) also This is the error I'm receiving: Traceback (most recent call last): File "F:\Farbod\work\ml\spam detection\SpamDetection.py", line 245, in model.fit(tf.convert_to_tensor(train_data["Body"]), train_data["Label"], batch_size=64, epochs=25, verbose=1, validation_split=0.20, use_multiprocessing=True) File "C:\Python\Python39\lib\site-packages\tensorflow\python\util\traceback_utils.py", line 153, in error_handler raise e.with_traceback(filtered_tb) from None File "C:\Python\Python39\lib\site-packages\tensorflow\python\framework\constant_op.py", line 102, in convert_to_eager_tensor return ops.EagerTensor(value, ctx.device_name, dtype) ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type list). I have this guess which may or may not help. Since the sentences are of different sizes maybe converting them to tensor is not OK and maybe they should be converted to lists with fixed sizes.
