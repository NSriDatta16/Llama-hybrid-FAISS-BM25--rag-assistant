[site]: stackoverflow
[post_id]: 3868036
[parent_id]: 
[tags]: 
Twitter API status update always returns "Incorrect signature"

I'm using Signpost as OAuth implementation for posting to Twitter. And implemented the GoogleAppEngineOAuthConsumer and GoogleAppEngineOAuthProvider classes, but since they're pretty trivial, so I'm not providing their sources here (yet). Here's my authentication part, which seems to work just fine. LoginServlet.java: // fetching the request token OAuthConsumer consumer = new GoogleAppEngineOAuthConsumer(CONSUMER_KEY, CONSUMER_SECRET); OAuthProvider provider = new GoogleAppEngineOAuthProvider(REQUEST_TOKEN_URL, ACCESS_TOKEN_URL, AUTHORIZATION_URL); String redirectUrl = provider.retrieveRequestToken(consumer, CALLBACK_URL); // cache the request token and request token secret response.sendRedirect(redirectUrl); CallbackServlet.java // fetching the access token String verifier = (String) req.getParameter("oauth_verifier"); // retrieve request token and request token secret from cache OAuthConsumer consumer = new GoogleAppEngineOAuthConsumer(CONSUMER_KEY, CONSUMER_SECRET); OAuthProvider provider = new GoogleAppEngineOAuthProvider(REQUEST_TOKEN_URL, consumer.setTokenWithSecret(token, tokenSecret); provider.setOAuth10a(true); provider.retrieveAccessToken(consumer, verifier); // store access token and access token secret And here's the actual problematic part. TweetServlet.java OAuthConsumer consumer = new GoogleAppEngineOAuthConsumer(CONSUMER_KEY, CONSUMER_SECRET); // retrieve access token and access token secret from storage consumer.setTokenWithSecret(accessToken, accessTokenSecret); final HTTPRequest updateStatus = new HTTPRequest(new URL("http://api.twitter.com/1/statuses/update.json"), HTTPMethod.POST); updateStatus.setPayload(("status=" + URLEncoder.encode(message, "UTF-8")).getBytes()); consumer.sign(updateStatus); logger.debug(new String(URLFetchServiceFactory.getURLFetchService().fetch(updateStatus).getContent())); Each and every time it results: {"request":"/1/statuses/update.json","error":"Incorrect signature"} .
