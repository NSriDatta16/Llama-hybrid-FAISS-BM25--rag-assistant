[site]: crossvalidated
[post_id]: 563575
[parent_id]: 563566
[tags]: 
It's helpful to see that the ROC curve here isn't really a curve. Instead, you're effectively producing a model that says P(Survive|Male) = .18 and P(Survive|Female) = .74 (the averages in the data), and making predictions using a range of thresholds, e.g. prediction = 1 if p_survive > threshold , or 0 otherwise. You end up predicting everyone will survive for any threshold .74. This should hopefully make it clear that calculating the AUC or drawing the ROC doesn't really provide any extra information here, since changing the threshold doesn't affect the predictions unless you set it to a daft value. However, it also shows that the AUC score you obtain is still a valid one. true_positives false_positives threshold 0.0 1.00 1.00 0.1 1.00 1.00 0.2 0.68 0.15 0.3 0.68 0.15 0.4 0.68 0.15 0.5 0.68 0.15 0.6 0.68 0.15 0.7 0.68 0.15 0.8 0.00 0.00 0.9 0.00 0.00 1.0 0.00 0.00 Code p_male, p_female = [tdf.loc[tdf['sex'] == sex, 'survived'].mean() for sex in ['male', 'female']] tdf['p_survived'] = np.where(tdf['sex'] == 'male', p_male, p_female) thresholds = np.linspace(0, 1, 11) def check_calibration(threshold, predicted_probs, outcome): prediction = 1 * (predicted_probs > threshold) return { 'true_positives' : prediction[outcome == 1].mean(), 'false_positives' : prediction[outcome == 0].mean() } calibration = pd.DataFrame([ check_calibration(thresh, tdf['p_survived'], tdf['survived']) for thresh in thresholds ]).fillna(0) calibration.index = pd.Index(thresholds, name = 'threshold') print(calibration.round(2)) accuracies.plot() plt.xlabel('Threshold (Predict "Survived" if P(Survived > Threshold))') plt.ylabel('True/False Positive Rate') plt.title('Calibration') plt.figure(figsize=(5,5)) plt.plot(accuracies['false_positives'], accuracies['true_positives']) plt.scatter(accuracies['false_positives'], accuracies['true_positives']) plt.plot([0,1], [0,1], linestyle = 'dashed', color = 'k') plt.xlabel('False Positives') plt.ylabel('True Positives') plt.title('ROC Curve')
