[site]: stackoverflow
[post_id]: 4889573
[parent_id]: 
[tags]: 
NSOutline View Drag-n-Drop Problem

Dear All, I am fighting with NSOutline View to perform drag-n-drop within the table since last 2-3 day but couldn't get what i am doing wrong, This is what i have done so far, Requirement, 1 -- I want to have a transparent or with some background image NSoutlineview in my view, to do that, i need to overwrite drawRect method of NSOutlineView, this is what i have done in header file @interface MyCustomOutlineView:NSOutlineView{ NSImage *pBackgroundImage; } - setBackgroundImage:(NSImage *)pImage; In source file, i just overwrite drawRect and some other stuffs to draw the background image or to make it transparent and this is working fine, Now in my view, i have declared the NSOutlineView object like that, /* * My Custom view will have capability to draw the gradient and other effects */ @interface OutlineParentView:MyCustomView { MyCustomOutlineView *pOutlineView; } @property(nonatomic,retain)MyCustomOutlineView *pOutlineView; In source file, implemented following method , This method will be called from the initWIthFrame #define OutlineViewPrivateDataType "MyOutlinePrivateData" -(void)InitOutlineView{ NSRect scrollFrame = [self bounds]; NSScrollView* scrollView = [[[NSScrollView alloc] initWithFrame:scrollFrame] autorelease]; [scrollView setBorderType:NSNoBorder]; [scrollView setHasVerticalScroller:YES]; [scrollView setHasHorizontalScroller:NO]; [scrollView setAutohidesScrollers:YES]; [scrollView setDrawsBackground: NO]; NSRect clipViewBounds = [[scrollView contentView] bounds]; pOutlineView = [[[CommUICustomOutlineView alloc] initWithFrame:clipViewBounds] autorelease]; NSTableColumn* firstColumn = [[[NSTableColumn alloc] initWithIdentifier:@"firstColumn"] autorelease]; ImageTextCell *pCell = [[ImageTextCell alloc]init]; [firstColumn setDataCell:pCell]; [pCell setDataDelegate:self]; [firstColumn setWidth:25]; [pOutlineView addTableColumn:firstColumn]; [pOutlineView setRowHeight:30]; [pOutlineView setDataSource:self]; /* setData delegate implemented in the MyOutlineView to handle some of event in this interface if i don't write this, then i can't handle the menu event on the Outlineview */ [pOutlineView setDataDelegate:self]; **/* On this line i am getting one warning, saying OutlineParentView doesn't implement NSOutlineView delegate protocol */** [pOutlineView setDelegate:self]; [scrollView setDocumentView:pOutlineView]; /* I don't want group row to be highlighted */ [pOutlineView setSelectionHighlightStyle:NSTableViewSelectionHighlightStyleSourceList]; [pOutlineView registerForDraggedTypes: [NSArray arrayWithObjects:OutlineViewPrivateDataType,nil]]; [pOutlineView setDraggingSourceOperationMask:NSDragOperationEvery forLocal:YES]; [scrollView setAutoresizingMask:NSViewWidthSizable|NSViewHeightSizable]; [self addSubview:scrollView]; [self setAutoresizesSubviews:YES]; [self log:@"Outline view created "]; } Other Important method related to Drag-n-Drop implemented as below - (BOOL)outlineView:(NSOutlineView *)outlineView writeItems:(NSArray *)items toPasteb oard:(NSPasteboard *)pboard{ [self log:@"write Items"]; NSData *data = [NSKeyedArchiver archivedDataWithRootObject:items]; [pboard declareTypes:[NSArray arrayWithObject:OutlineViewPrivateDataType] owner:self]; [pboard setData:data forType:OutlineViewPrivateDataType]; return YES; } - (NSDragOperation)outlineView:(NSOutlineView *)outlineView validateDrop:(id )info proposedItem:(id)item proposedChildIndex:(NSInteger)index { NSLog(@"validate Drop"); return NSDragOperationEvery; } - (BOOL)outlineView:(NSOutlineView *)outlineView acceptDrop:(id )info item:(id)item childIndex:(NSInteger)index{ [self log:@"inside accept drop for NSView "]; return YES; } I checked apple DragnDrop Sample code, but couldn't get what i am doing wrong, i believe, some problem with the [pOutlineView setDelegate:self] Function, but how to solve that, that i don't know, I upgraded recently from MyTableView to MyOutlineView, recently i was able to perform Drag-nDrop on the Custom Table view, Remaining things are working fine, like DataSource etc... Thanks in Advance Kind Regards Rohan
