[site]: stackoverflow
[post_id]: 4308354
[parent_id]: 
[tags]: 
Gdb skips source code lines while debugging assembler program for ARM7 microcontroller

I have a problem with debugging a simple program written with assembler language for ARM7 microcontroller (AT91SAM7S64). I use gcc, gdb and OpenOCD. My program is loaded to target correctly and works just fine (it blinks a led). But gdb skips through certain source code lines when i invoke 'next' command. Here is a fragment of source code: Reset_Handler: LDR R0, =0x0100 LDR R1, =PIOA_PER STR R0, [R1] LDR R1, =PIOA_OER STR R0, [R1] uuu: bl wait; LDR R1, =PIOA_SODR STR R0, [R1] uuu1: bl wait; LDR R2, =PIOA_CODR STR R0, [R2] b uuu; @ one second delay wait: ............. ............. .end To get gdb output (see below) i have used "target sim" instead of real target, but rusults are exaclty the same. (gdb) target sim Connected to the simulator. (gdb) load Loading section .text, size 0xc8 vma 0x100000 Start address 0x100000 Transfer rate: 1600 bits in It seems like gdb assume 'uuu1' as a separate function and skips it for some reason. If i delete 'uuu1' label the problem disappears. This label is not used anywhere, but gdb behavior looks very strange. I have been trying to find any solution for a long time but with do significant results. Using gcc option '-fomit-frame-pointer' didn't help. What can i do about it? Versions of gdb and gcc: arm-none-eabi-gdb --version GNU gdb (GDB) 7.1 .......... This GDB was configured as "--host=i686-pc-mingw32 --target=arm-none-eabi". arm-none-eabi-gcc --version arm-none-eabi-gcc (GCC) 4.5.1 My MakeFile: TRGT = arm-none-eabi- CC = $(TRGT)gcc CP = $(TRGT)objcopy AS = $(TRGT)gcc -x assembler-with-cpp #AS = $(TRGT)as LD = $(TRGT)ld OBJDUMP = $(TRGT)objdump LD_SCRIPT = main.ld MCU = arm7tdmi #DEBUG = stabs DEBUG = dwarf-2 ASFLAGS = -mcpu=$(MCU) -g$(DEBUG) LDFLAGS = -T $(LD_SCRIPT) all: main.elf main.lss @echo Done! main.elf : main.o @echo Linking $ Thanks in advance for any help!
