[site]: crossvalidated
[post_id]: 49868
[parent_id]: 49857
[tags]: 
I have not seen the Duan smearing correction used in this way, but at first blush, it seems sensible. Here's the intuition. The general re-transformation problem we have is that we want to get \begin{equation}E[y_i \vert x_i]=\exp (x_i'\beta) \cdot E[\exp (u_i)].\end{equation} For the first term, you can use the exponentiated prediction from the logged model. The second is more tricky. If we assume normality and independence, we can approximate the second term with $\exp (\frac{\hat \sigma^2}{2}),$ where we use the RMSE from the logged regression for the unobserved $\sigma$. Or we can use a weaker assumption of $iid$ on $u_i$, and use the sample average of the exponentiated residuals from the logged model for the second term.* That's the Duan "smearing" approach. If you have access to Cameron and Trivedi's Microeconometrics Using Stata , take a look at chapter 16, in general, and table 16.2, in particular. There they give expressions for the conditional and unconditional means of expenditure when the outcome is in logs. However, they are using a probit for the first stage, and making assumptions about joint normality and homoskedasticity of the errors in the two stages, so it's a slightly different model than the weaker $iid $ assumptions of the Duan approach with the logit. But the intuition carries over. Combining the intuition from the first paragraph and their table, we have that \begin{equation}E[y_2 \mid x,y_2>0 ] = \exp (x_2' \beta) \cdot \exp( \frac{ \sigma^2_2}{2} )\end{equation} and \begin{equation}E[y_2 \mid x ] = \exp (x_2' \beta) \cdot \exp(\frac{ \sigma^2_2}{2} ) \cdot \Phi(x_1' \beta).\end{equation} The $\sigma_2$ is the variance in the logged expenditure equation, which you can approximate as above. The subscripts indicate the stage (since you can have different predictors). The $\Phi$ is just the probability of going to see the doc from the probit first stage, which is like your logit. Thus, it seems that as long as you maintain the assumption that the two stages are independent, all you need to do is multiply by $\frac{1}{N}\sum_i^N \exp (\hat u_i)$ if you want the expected positive expenditure. You will also need to create out of sample predictions for the expenditure for those who did not get to see the doc. Addendum: Stata now has the a user-written tpm command that deals really nicely with this problem. * If you're worried about heteroskedasticity, you might try smearing by group. For example, you might try an age-group specific average residual.
