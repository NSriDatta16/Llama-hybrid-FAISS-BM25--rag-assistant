[site]: crossvalidated
[post_id]: 53269
[parent_id]: 
[tags]: 
Implementing Kalman filter in R

I am attempting to implement a Kalman filter in R. Working from "Time Series Analysis" by Hamilton the state space equations are defined as: State: $z(t) = F_z(t-1) + v(t)$ Observation: $y(t) = A'x(t) + H'z(t-1) + w(t)$ Where $x(t)$ are exogenous variables. The model I am attempting to implement is defined this way. There are multiple packages that implement state space models in R, but through reading the documentation it appears that the equations are defined differently, with $A'x(t)$ including in the state equation. Short of writing the maximum likelihood estimation code myself, does anyone know a way to fit this model in R? Update: Deleted my past update. I found another paper that implements this in a way that is much more clear, will update after I have digested it. Update 2: So I found another paper that does something similar to what I am attempting, but it is much more clear to me how to set up the state space equations. The problem I am running into now is running the filter using package dlm. If anyone has any experience that would help I would be greatful. I am able to set up the model, and then run the filter, but only 2 filtered values are returned (initial state and t=1) as opposed to t-values. I am not really clear why that is. From the dlm documentation: Observation: $y= \mathbf{F}\theta + v_t$ State: $\theta = \mathbf{G}\theta_{t-1} +w_t$ Where m is the number of observations and p is the number of parameters in $\mathbf{F}$ $\mathbf{V}$ is m x m $\mathbf{G}$ is p x p $\mathbf{W}$ is p x p $c_0$ is p x p Sample code: require(dlm) FMat kFilter$m [,1] [,2] [1,] 1.00000000 1.00000000 [2,] -0.02417179 0.05107227
