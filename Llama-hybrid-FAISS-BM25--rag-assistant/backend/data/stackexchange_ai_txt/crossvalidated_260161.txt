[site]: crossvalidated
[post_id]: 260161
[parent_id]: 
[tags]: 
How can I run an gls model, and perform variance modelling in R?

Context: I'm trying to analyse some data where I have four explanatory variables named "Estimulo", "Barra", "DPI" and "Viendocon" (all of them are taken as factors) and one response variable, named "Vueltasmin", which is a numeric one. As the explanatory variables are measured repeatedly (but not in a time-dependant manner, like in a repeated measures design) I chose a gls model. This gls strategy was selected after trying an lmer model, where I rejected Shapiro-Wilk's test for normality and had some conic-like pattern in a QQplot. I try to modelate the variance using different strategies: VarFixed, VarIdent,Varpower and VarExp. Now here is where I can't go on: there is some error I'm getting that I'm not understanding what does it means. For example, I run: m2a and getting: Error in glsEstimate(object, control = control) : computed "gls" fit is singular, rank 18. When I try to run a VarIdent, I run: m3 Barra Estimulo*Viendocon, weights=varIdent(form=~1|Barra), data=Datos) and get the same. I leave the following link where you can find the script (named "Script tesis lic") and the data base I'm using (named "EXP1"): http://dropcanvas.com/hy6ds If anyone could help or orient me, I would be very grateful. Thank you very much in advance, Yair.
