[site]: crossvalidated
[post_id]: 27217
[parent_id]: 27213
[tags]: 
Summary The weights are selected to achieve a mathematical end. In Spencer's case, the goal is to allow cubic trends to pass through the filter undistorted. This means that if we decompose the input $X_t$ into a deterministic polynomial trend component $m(t) \equiv c_3 t^3 + c_2 t^2 + c_1 t + c_0$ and a centered stochastic component $Y_t$, such that $X_t \equiv m(t) + Y_t$, then $\mathcal F \left[ X_t \right] \to m_t$ as $\sigma_Y \to 0$, where $\mathcal F$ is the filtering operation. Example Here is an illustrated example using Mathematica. I'm going to compare Spencer's filter with a 15-tap double-sided symmetric moving average. n = 101; c = RandomReal[{-1, 1}, 4]; x = RandomVariate[NormalDistribution[0, .1], n]; result = GraphicsGrid@{{ ListPlot@MovingAverage[x + Table[c.{1, t, t^2, t^3}, {t, -1, 1, 2/(n - 1)}], {-3, -6, -5, 3, 21, 46, 67, 74, 67, 46, 21, 3, -5, -6, -3}/230], ListPlot@MovingAverage[ x + Table[c.{1, t, t^2, t^3}, {t, -1, 1, 2/(n - 1)}], 15]}, {ListPlot@Table[c.{1, t, t^2, t^3}, {t, -1, 1, 2/(n - 1)}], ListPlot@{x + Table[c.{1, t, t^2, t^3}, {t, -1, 1, 2/(n - 1)}]}}} Clockwise from the top left: the output of Spencer's filter, the output of the symmetric filter, the noisy input ($X_t$), the cubic trend ($m_t$). This is with $c=\{-0.26988, -0.34137, 0.670082, 0.820887\}$ (the polynomial coefficients, in ascending order of degree). Discussion As you can see, Spencer's filter is more sensitive than the symmetric filter, owing to the negative weights. The low-pass effect of the symmetric filter is good for denoising (we're comparing the norm of the difference): Part[#2, 8 ;; -8] - MovingAverage[#1 + #2, 15] & [x, Table[c.{1, t, t^2, t^3} , {t, -1, 1, 2/(n - 1)}]] // Norm > 0.197244 for the symmetric filter versus Part[#2, 8 ;; -8] - MovingAverage[#1 + #2, {-3, -6, -5, 3, 21, 46, 67, 74, 67, 46, 21, 3, -5, -6, -3}/230] & [x, Table[c.{1, t, t^2, t^3} , {t, -1, 1, 2/(n - 1)}]] // Norm > 0.411789 for Spencer's. However, it also distorts the trend (the same test without the noise): Part[#2, 8 ;; -8] - MovingAverage[#2, 15] & [x, Table[c.{1, t, t^2, t^3} , {t, -1, 1, 2/(n - 1)}]] // Norm > 0.097972 versus Part[#2, 8 ;; -8] - MovingAverage[#2, {-3, -6, -5, 3, 21, 46, 67, 74, 67, 46, 21, 3, -5, -6, -3}/230] & [x, Table[c.{1, t, t^2, t^3} , {t, -1, 1, 2/(n - 1)}]] // Norm > 4.05378*10^-16 Further reading These lecture notes go into the derivation. You might also find resident user Rob Hyndman's article on moving averages useful.
