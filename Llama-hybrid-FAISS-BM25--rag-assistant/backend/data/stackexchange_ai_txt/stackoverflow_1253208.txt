[site]: stackoverflow
[post_id]: 1253208
[parent_id]: 1253190
[tags]: 
It's been a while since I had to do something like this... and I have only used the Verisign Payflow API. You might want to check it out. To the best of my memory, payment gateways strongly recommend against storage of card details. The recommended mechanism is to use the reference number from the original transaction, and then to link the new transaction to it; it must be very similar to the way Brain Tree handles it.
