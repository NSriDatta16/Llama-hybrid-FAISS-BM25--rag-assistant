[site]: stackoverflow
[post_id]: 1946998
[parent_id]: 1946916
[tags]: 
try this Select Avg(e.Time - s.Time) From Table s Join Table e On e.Time = (Select Min(Time) From Table Where eventname = s.eventname And time > s.Time) And Not Exists (Select * From Table Where eventname = s.eventname And time For each record representing a Start of a stage, this sql joins it to the record which represents the end, takes the difference between the end time and the start time, and averages those differences. The Not Exists ensures that he intermediate resultset of start records joined to end records only includes the start records as s... and the first join condition ensures that only the one end record ( the one with the same name and the next time value after the start time) is joined to it... To see the intermediate resultset after the join, but before the average is taken, run the following: Select s.EventName, s.Time Startime, e.Time EndTime, (e.Time - s.Time) Elapsed From Table s Join Table e On e.Time = (Select Min(Time) From Table Where eventname = s.eventname And time > s.Time) And Not Exists (Select * From Table Where eventname = s.eventname And time
