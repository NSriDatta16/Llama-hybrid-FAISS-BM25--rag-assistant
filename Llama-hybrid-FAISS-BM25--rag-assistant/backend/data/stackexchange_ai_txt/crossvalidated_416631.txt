[site]: crossvalidated
[post_id]: 416631
[parent_id]: 415974
[tags]: 
Edit: Didn't notice that whuber had already answered. I'll leave this up as an example of another (perhaps less elegant) approach to the problem. The covariance matrix Let $(X,Y)$ be a random point from the uniform distribution on a polygon $P$ with area $A$ . The covariance matrix is: $$C = \begin{bmatrix} C_{XX} & C_{XY} \\ C_{XY} & C_{YY} \end{bmatrix}$$ where $C_{XX} = E[X^2]$ is the variance of $X$ , $C_{YY} = E[Y^2]$ is the variance of $Y$ , and $C_{XY} = E[XY]$ is the covariance between $X$ and $Y$ . This assumes zero mean, since the polygon's center of mass is located at the origin. The uniform distribution assigns constant probability density $\frac{1}{A}$ to every point in $P$ , so: $$C_{XX} = \frac{1}{A} \underset{P}{\iint} x^2 dV \quad C_{YY} = \frac{1}{A} \underset{P}{\iint} y^2 dV \quad C_{XY} = \frac{1}{A} \underset{P}{\iint} x y dV \tag{1}$$ Triangulation Instead of trying to directly integrate over a complicated region like $P$ , we can simplify the problem by partitioning $P$ into $n$ triangular subregions: $$P = T_1 \cup \cdots \cup T_n$$ In your example, one possible partitioning looks like this: There are various ways to produce a triangulation (see here ). For example, you could compute the Delaunay triangulation of the vertices, then discard edges that fall outside $P$ (since it may be nonconvex as in the example). Integrals over $P$ can then be split into sums of integrals over the triangles: $$C_{XX} = \frac{1}{A} \sum_{i=1}^n \underset{T_i}{\iint} x^2 dV \quad C_{YY} = \frac{1}{A} \sum_{i=1}^n \underset{T_i}{\iint} y^2 dV \quad C_{XY} = \frac{1}{A} \sum_{i=1}^n \underset{T_i}{\iint} x y dV \tag{2}$$ A triangle has nice, simple boundaries so these integrals are easier to evaluate. Integrating over triangles There are various ways to integrate over triangles. In this case, I used a trick that involves mapping a triangle to the unit square. Transforming to barycentric coordintes might be a better option. Here are solutions for the integrals above, for an arbitrary triangle $T$ defined by vertices $(x_1,y_1), (x_2,y_2), (x_3,y_3)$ . Let: $$v_x = \left[ \begin{smallmatrix} x_1 \\ x_2 \\ x_3 \end{smallmatrix} \right] \quad v_y = \left[ \begin{smallmatrix} y_1 \\ y_2 \\ y_3 \end{smallmatrix} \right] \quad \vec{1} = \left[ \begin{smallmatrix} 1 \\ 1 \\ 1 \end{smallmatrix} \right] \quad L = \left[ \begin{smallmatrix} 1 & 0 & 0 \\ 1 & 1 & 0 \\ 1 & 1 & 1 \end{smallmatrix} \right]$$ Then: $$\underset{T}{\iint} x^2 dV = \frac{A}{6} \text{Tr}(v_x v_x^T L) \quad \underset{T}{\iint} y^2 dV = \frac{A}{6} \text{Tr}(v_y v_y^T L) \quad \underset{T}{\iint} x y dV = \frac{A}{12} (\vec{1}^T v_x v_y^T \vec{1} + v_x^T v_y) \tag{3}$$ Putting everything together Let $v_x^i$ and $v_y^i$ contain the x/y coordinates of the vertices for each triangle $T_i$ , as above. Plug $(3)$ into $(2)$ for each triangle, noting that the area terms cancel out. This gives the solution: $$C_{XX} = \frac{1}{6} \sum_{i=1}^n \text{Tr} \big( v_x^i (v_x^i)^T L \big) \quad C_{YY} = \frac{1}{6} \sum_{i=1}^n \text{Tr} \big( v_y^i (v_y^i)^T L \big) \quad C_{XY} = \frac{1}{12} \sum_{i=1}^n \big( \vec{1}^T v_x^i (v_y^i)^T \vec{1} + (v_x^i)^T v_y^i \big) \tag{4}$$ Principal axes The principal axes are given by the eigenvectors of the covariance matrix $C$ , just as in PCA. Unlike PCA, we have an analytic expression for $C$ , rather than having to estimate it from sampled data points. Note that the vertices themselves are not a representative sample from the uniform distribution on $P$ , so one can't simply take the sample covariance matrix of the vertices. But, $C$ *is* a relatively simple function of the vertices, as seen in $(4)$ .
