[site]: stackoverflow
[post_id]: 4700495
[parent_id]: 
[tags]: 
Small Memory Issue with Objective-C

I made a Mac OS X app that basically runs an NSTask. The thing is, I made a class called XXTask to handle a file, and a class called XXController to handle the drag and drops in the GUI and asking the XXTask to handle a file now and then. I had made almost the same thing in the past, and it worked fine. This time, I added a delegate protocol, and made XXController the delegate of XXTask. When XXTask fails, I ask the delegate to show a particular view, and thus call a method like this : [delegate showView]; This works, but when trying to relaunch using the information I stored on the first launch, the app outputs errors. I used NSLog to see what exactly was wrong, and it seems like three instance variables (two NSStrings and one NSMutableArray) are (null). These are the three instance variables : NSString *curFilePath; NSArray *lastArgs; NSString *lastLaunchPath; I create them like this : curFilePath = filename; // filename is an NSString passed to the method where I first create curFilePath // the object passed to the method is a retained NSString (an instance variable of XXController) lastArgs = [[NSMutableArray arrayWithObjects:curFilePath, [curFilePath stringByDeletingLastPathComponent], nil] retain]; lastLaunchPath = [[[NSBundle mainBundle] pathForResource:@"xxtask" ofType:@""] retain]; All three variables are null, but the XXTask object is not, as it can still execute code. Errors : 2011-01-15 16:38:57.233 App[24179:a0f] PATH : (null) 2011-01-15 16:40:52.846 App[24212:a0f] LAST ARGS : (null) 2011-01-15 16:40:52.847 App[24212:a0f] LAST LP : (null) 2011-01-15 16:40:52.847 App[24212:a0f] Exception detected while handling key input. 2011-01-15 16:40:52.848 App[24212:a0f] *** -[NSCFArray insertObject:atIndex:]: index (1) beyond bounds (1) When I don't draw the view by calling the delegate, everything is okay. I could put that view method in the XXTask class, but I'd rather find a neat explanation to this first. What happens when I call the delegate? (It's the first time I tried using delegate protocols) Thanks for answering! If this code looks horrible to you, I have two excuses : I've been messing around for a long time, read the memory management docs and did the most silly things. Reference-count memory management is quite new to me. I've never made real big apps like this one in the past, so I normally can't do a lot wrong, but this time memory is way more important.
