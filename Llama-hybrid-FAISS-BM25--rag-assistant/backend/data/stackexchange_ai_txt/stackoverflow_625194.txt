[site]: stackoverflow
[post_id]: 625194
[parent_id]: 624534
[tags]: 
TFD is spot on. You could also use the less elegant reference example from MSDN: Dim width As Integer = 128 Dim height As Integer = width Dim stride As Integer = CType(width / 8, Integer) Dim pixels(height * stride) As Byte ' Try creating a new image with a custom palette. Dim colors As New List(Of System.Windows.Media.Color)() colors.Add(System.Windows.Media.Colors.Red) colors.Add(System.Windows.Media.Colors.Blue) colors.Add(System.Windows.Media.Colors.Green) Dim myPalette As New BitmapPalette(Colors) ' Creates a new empty image with the pre-defined palette Dim image As BitmapSource = System.Windows.Media.Imaging.BitmapSource.Create(width, height, 96, 96, PixelFormats.Indexed1, myPalette, pixels, stride) Dim stream As New FileStream("new.bmp", FileMode.Create) Dim encoder As New BmpBitmapEncoder() Dim myTextBlock As New TextBlock() myTextBlock.Text = "Codec Author is: " + encoder.CodecInfo.Author.ToString() encoder.Frames.Add(BitmapFrame.Create(image)) encoder.Save(stream)
