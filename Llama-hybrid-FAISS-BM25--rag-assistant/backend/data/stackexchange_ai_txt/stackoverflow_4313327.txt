[site]: stackoverflow
[post_id]: 4313327
[parent_id]: 
[tags]: 
How do i set the cursor in a html editor using IE (7-8)

Actually i am trying to set the cursor to a specific node inside a html editor (which uses a contenteditable iframe). For example i have several paragraphs and want the cursor to move to the start of the previous paragraph. Unfortunatly, the Internet Explorers range object does not support setStartBefore and setStartAfter . The ierange project is not an option - the solution i am looking for needs to work with IE out of the box. How do i set the cursor in IE? In Firefox the solution is straight forward: // sets the cursor position (start defines, if cursor is needed at the start or end of the node) function setCursor(editor, node, start){ var tn = editor.getDoc().createTextNode("."); // gets the editors document if (start){ node.insertBefore(tn, node.firstChild); } else node.appendChild(tn); rng = editor.selection.getRng(); // gets the browsers range object for the users selection rng.selectNode(tn); rng.setStartBefore(tn); rng.setStartAfter(tn); ed.selection.setRng(rng); node.removeChild(tn); // removes the caret node - curser is placed now }
