[site]: crossvalidated
[post_id]: 551146
[parent_id]: 550656
[tags]: 
If the treatment affects whether the observation is selected, then you need to account for treatment somewhere in the IPW model. Including the treatment in the selection propensity score model is one way to do it. You could also estimate weights separately within each treatment group; when using a parametric model, this is equivalent to a model with an interaction between treatment and every covariate . So the difference between your two choices is whether you want only a main effect of treatment in your propensity score model or interactions between treatment and every covariate. Probably the best answer is somewhere in between, so it's a good idea to use a flexible model to model propensity scores to avoid making functional form assumptions; you can let a machine learning method like BART decide if interactions between the treatment and covariates are necessary.
