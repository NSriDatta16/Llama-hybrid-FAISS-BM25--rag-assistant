[site]: stackoverflow
[post_id]: 4433423
[parent_id]: 
[tags]: 
Poor JUnit test using springframework has fragile Thread.sleep() calls. How to fix?

I have recently joined a group with some severe JUnit testing issues. One problem is an 8 minute long test! The test has several sections; each makes calls to org.springframework.context.ApplicationEventPublisher.publishEvent() followed by Thread.sleep() of various amounts of time, then tests conditions. There are several obvious problems with this approach, the timing of the Thread.sleep() calls is fragile: tests occasionally fail on busy machines; and tests take far too long when they do not fail. Is the pool upon which these events are handled accessible for testing and is there a call to see if the event cascade has quiesced?
