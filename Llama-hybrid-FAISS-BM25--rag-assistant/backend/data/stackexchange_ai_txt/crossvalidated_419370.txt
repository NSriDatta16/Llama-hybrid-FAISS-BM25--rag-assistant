[site]: crossvalidated
[post_id]: 419370
[parent_id]: 
[tags]: 
How to decide what variables to weight in a WLS regression

My question concerns the weighting procedure used when using weighted least squares and multiple variables. I'll start by explaining my own limited understanding of how to conduct a weighted regression, and then get to my actual questions. Step 1: Test variables for heteroscedasticity. For regressions, I tend to use the R function bptest for the Breusch-Pagan test like so: bptest(y ~ x1, data = dat) Step 2: A significant result (p lm1 = lm(y ~ x1, dat) w = lm1$residuals w = 1/abs(w) Step 3: Conduct the WLS: lm2 = lm(y ~ x1, dat, weights = w) summary(lm2) #oooh and ahhh at your results Hopefully everything above is generally correct, again, I am learning. Where I am now confused applies to Steps 1 and 2. For step 1, I could reasonably see proceeding with a multiple regression in two ways. bptest(y ~ x1, data = dat) bptest(y ~ x2, data = dat) bptest(y ~ x3, data = dat) ## OR bptest(y ~ x1 + x2 + x3, data = dat) Question 1 : Now at step 2, I don't know whether only the variables detected to be significant by bptest or all of the variables of interest should be included in the linear model that I calculate w from OR if I should be using the bptest result that included all variables to inform my decision to use WLS. Question 2 : In a slightly more complicated scenario, would if affect your decision if a variable was detected as significant by itself, but the more inclusive model including all three variables was not significant? For example in a scenario where only x1 was significant: lm1 = lm(y ~ x1, dat) w = lm1$residuals w = 1/abs(w) ## OR lm1 = lm(y ~ x1 + x2 + x3, dat) w = lm1$residuals w = 1/abs(w) ## Either option followed by: lm2 = lm(y ~ x1 + x2 + x3, dat, weights = w) Question 3 : I could reasonably see either option being correct, but I am curious if there is a consensus view on which version is more correct. My only concrete thoughts are that I shouldn't choose how to carry out this method by seeing which one gives me the most favorable result, and that I should specify exactly how I did this procedure in future writeups. I'm sorry if there is already a post somewhere discussing this, but I could not find any discussing this particular gap in my knowledge and none of the few books I have seem to have any relevant guidance.
