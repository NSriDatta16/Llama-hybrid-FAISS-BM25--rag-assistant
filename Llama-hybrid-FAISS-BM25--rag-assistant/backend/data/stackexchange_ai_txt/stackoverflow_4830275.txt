[site]: stackoverflow
[post_id]: 4830275
[parent_id]: 
[tags]: 
ASP POST back to itself, then to HTTPS. Vulnerabilities?

I am struggling with securing webforms from shenanigans (previously, our "contact us" webform would submit the form's contents to an ASP that generated the e-mails, leaving it vulnerable to attack from a page outside of our website since the URL was in the form's action). In an attempt to combat the spam, I altered the classic ASP page to POST back to itself before posting to another ASP that handled the e-mail. I used code I found on 15 Seconds site to prevent multiple submits, and changed all of the posted variables to Session Variables before re-posting it to an HTTPS page. I include a hidden input field with the Session ID in it, and on the page on the HTTPS side, verify all of the fields have data in them and verify the submitted Session ID matches the current Session ID. I'd like to think this is pretty secure (short of putting it all into HTTPS), but I'm not sure. Does the initial ASP posting back to itself before posting to the HTTPS page leave a hole that could be exploited? Did I over-engineer one part while leaving another wide open?
