[site]: stackoverflow
[post_id]: 5707333
[parent_id]: 
[tags]: 
Structuring data in excel / using results of a sql query to drive another query

Suppose that I have users, tasks and each task belongs to a batch. Each task has an estimated non recurring time of completion, estimated recurring time, and an operation name (Painting, deburring, etc). Actual completion time is tracked batch by batch instead of task by task. Users log into an an interface that tracks their time spent on each batch, number of faults, and the number of faults detected by them. I am writing a report that will display each users stats for each operation(as you cannot compare a painter with a guy who is doing machining). I have no problem writing queries to find the user's total estimated amount of work completed, what was tracked on their batches and their hours worked. My problem is that I am not sure how to best represent this in excel. I would like to write a bunch of queries and then have a table that refreshes each week. So put the dates on the leftmost column with a separate worksheet for each operation then a whole summary week? Is there a better way to organize this so that I don't have 200 column wide worksheets? EDIT: So what I think I want to do is to put each user's name with each operation in a sheet. Then I want a separate worksheet that is the result of a query that takes each user with each operation and then grabs their times. Is it possible to call sql from excel depending on the results returned in a query that populates one sheet? sheet one: First Last Userid operation Bob, Bobertson, bbobertson, painting Bob, Bobertson, bbobertson, silkscreen Joe, Smith, jsmith, silkscreen Joe, Smith, jsmith, painting sheet two: week, userid, operation, time_spent_on_batches, total_estimated_work, april 4-8th bbobertson, painting, 46, 48 april 4-8th bbobertson, silkscreen, 46, 48 april 4-8th jsmith, painting, 46, 48 april 4-8th jsmith, silkscreen, 46, 48 Perhaps the second sheet could have the data on the x and the date ranges on the left?
