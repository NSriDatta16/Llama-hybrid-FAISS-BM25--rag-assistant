[site]: crossvalidated
[post_id]: 620656
[parent_id]: 
[tags]: 
How to manually calculate dAIC (survey design-based AIC) in R survey package

In preparation for fitting some more complicated distributions to survey-weighted data, I am trying to reproduce the $d\text{AIC}$ by hand for a simpler distribution (binomial in this case). I am having trouble, and would like some pointers and corrections to my understanding. The survey design based AIC $d\text{AIC}$ is defined by Lumley and Scott in their 2015 paper "AIC and BIC for modeling with complex survey data". The equation is $$ d\text{AIC} = -2n\hat l(\hat{ \mathbf{\theta}} ) + 2p\hat{\bar{\delta}} $$ where $n$ is the sample size $ \hat l(\hat{\theta} )$ is the weighted log-likelihood (Equation 2 of their paper) evaluated at the estimated parameters $\hat{\theta}$ $p$ is the number of parameters being estimated, i.e. length of $\theta$ vector $\hat{\bar{\delta}}$ is the average estimated design effect In R, I have fitted a binomial GLM in the survey package. library(survey) data(api) dstrat The logLik command gives In logLik.svyglm(mdl) : svyglm not fitted by maximum likelihood. I am not sure if this is problem - I thought AIC relies on maximum likelihood estimation. Then, I calculate Equation 2 of the paper, which is the weighted log-likelihood of a binomial GLM with a logit link, by hand. alogit I can reproduce the logLik of the model by hand, with lhat . Now I need to calculate the design effect $\hat{\bar{\delta}}$ . In the paper, on page 5, it says We can estimate $\hat{\bar{\delta}}$ by $\hat{\bar{\delta}}=\text{tr}\{ n\hat J(\hat\theta)^{-1}\hat V_U(\hat\theta) \} = n\hat J(\hat\theta)\hat V (\hat\theta)$ . Both $\hat J$ and $\hat V$ are computed routinely in the course of calculating $\hat\theta$ . I am not sure where to obtain these objects from, presumably they're stored in the mdl object somewhere. Also, I am wondering if the last term on that equation is missing the $\text{tr}(\cdot)$ term as $J$ and $V$ are matrices.
