[site]: crossvalidated
[post_id]: 623354
[parent_id]: 111205
[tags]: 
In the case of Bayesian NMF (and in general Bayesian MF with the only restriction of linearity of the factor in expectation), we have recently obtained valid closed-formulas when the model is correctly specified (our research also propose some fix to some situations of misspecification). For a Bayesian NMF using Poisson likelihood, and priors any kind with non-zero mean and variance, \begin{align} \theta_{ik} &\sim F(\mu_{\theta},\sigma_{\theta}^2), \quad \beta_{jk} \sim F(\mu_{\beta},\sigma_{\beta}^2), \nonumber \\ Y_{ij} & \sim \text{Poisson} \left(\sum_{k = 1}^K \theta_{ik}\beta_{jk}\right), \end{align} we obtain the following formula, which can be calculated with empirical estimates of the variance, expected value, and row-wise, and column-wise correlations $\rho_1$ and $\rho_2$ (one the results of the paper is that the correlation between two entries has only two possible values depending on them being in the same row or column). \begin{align} K &= \frac{ \tau \mathbf{V}[Y]-\mathbf{E}[Y]}{\rho_1\rho_2} \left( \frac{\mathbf{E}[Y]}{\mathbf{V}[Y]} \right)^2 \end{align} and $\rho = 1 − (\tau_1 + \tau_2)$ . For more generic Bayesian MF models with any observation model $F_Y$ such as \begin{align} \theta_{ik} &\sim F(\mu_{\theta},\sigma_{\theta}^2), \quad \beta_{jk} \sim F(\mu_{\beta},\sigma_{\beta}^2) \nonumber \\ Y_{ij} & \sim F_Y\left(\sum_{k = 1}^K \theta_{ik}\beta_{jk}\right), \text{ with } \mathbf{E}[Y_{ij}]=\sum_{k = 1}^K \theta_{ik}\beta_{jk}, \end{align} We obtain a similar result, with an extra dependency on the model specific expectation conditional variance $\mathbf{E}[\mathbf{V}(Y|\theta, \beta)]$ , namely \begin{align} K &= \frac{ \tau \mathbf{V}[Y]-\mathbf{E}[\mathbf{V}(Y|\theta, \beta)]}{\rho_1\rho_2} \left( \frac{\mathbf{E}[Y]}{\mathbf{V}[Y]} \right)^2 \end{align} . One caveat is that that formula is not valid for misspecified models, but it still is a starting point, given that we assume the model has some validity before even seeing the data. More details can be found in the paper: Silva, E; Kuśmierczyk, T; Hartmann, M; Klami, A. Prior Specification for Bayesian Matrix Factorization via Prior Predictive Matching . JMLR, 2023.
