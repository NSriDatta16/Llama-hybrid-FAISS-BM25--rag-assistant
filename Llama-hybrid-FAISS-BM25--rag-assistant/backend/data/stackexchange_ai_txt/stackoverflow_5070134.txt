[site]: stackoverflow
[post_id]: 5070134
[parent_id]: 
[tags]: 
Opening Excel file in IE provokes three logons?

I have a classic ASP website that posts a form to a page that then generates and streams an Excel file out to users. Actually, its a raw HTML table which I send with: Response.AddHeader "Content-Disposition", "inline; filename=file.xls" Response.AddHeader "Content-Type", "application/vnd.ms-excel" The intranet website is secured via integrated windows authentication. No other access mode is checked. The user logs in with their network password and all is well. Now, when the user submits the form, this action results in two more login dialogs. You can actually cancel out of both and still open the file. In fact, if you put in your credentials, it requires you to enter them four times! If you check "Remember password", it doesn't affect the need for logging in. Also, this happens even if the URLs are listed on the Trusted Sites section of IE. Any ideas on what I can do to minimize this? PS: Not sure, but seems to be a relatively recent issue, meaning a more recent version of IE (7/8), Office (2007+) and or Windows (Vista/7). UPDATE: Using Fiddler, I can see that something called "User-Agent: Microsoft-WebDAV-MiniRedir/6.1.7600" is attempting to connect, and getting 401.2'ed. Is IE offloading the download to something else that isn't authenticating properly? UPDATE2: Doubly-interestingly, Firefox does none of this. It receives and interprets things properly: HTTP/1.1 200 OK Date: Mon, 21 Feb 2011 19:25:26 GMT Server: Microsoft-IIS/6.0 X-Powered-By: ASP.NET Content-Disposition: inline; filename="SavingsReport_4Q2010.xls" Content-Type: application/vnd.ms-excel Content-Length: 111851 Cache-control: private
