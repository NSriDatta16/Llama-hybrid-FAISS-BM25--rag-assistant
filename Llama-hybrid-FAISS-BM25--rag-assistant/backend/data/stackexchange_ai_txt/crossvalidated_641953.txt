[site]: crossvalidated
[post_id]: 641953
[parent_id]: 
[tags]: 
What are average comparisons in the `marginaleffects` package?

I am confused about what the avg_comparison function does in the marginaleffects package. library(lme4) library(marginaleffects) I define a model model and am interested in various questions about this model. The variable t has 4 groups, one reference and 3 effect groups (it's my experimental condition). Now I want to compare each treatment group to the reference group while all other variables are average. contrasts_h1 |z|) S 2.5 % ## t treatment_1 - baseline 0.0716 0.0200 3.57 In order to understand what this actually does I followed the Marginal Effects Zoo Tutorial . I ran this to better understand the result: grid_emperical_t1 transform(treatment_1=1, treatment_2=0, treatment_3=0, baseline=0) grid_emperical_bl transform(treatment_1=0, treatment_2 =0, treatment_3=0, baseline =1) yhat_emperical_t1 Observe that the 0.06137143 on the bottom fit the 0.0614 in the contrast table well. However, what I do in this second chunk is: I overwrite the treatment condition of all data and compare them to each other. I do not compare the predicted mean inside the existing condition groups. I find this odd, as there are other covariates that correlate. For example, e depends on the treatment group. Hence, computing the avg_comparison over all data seems odd. We are forcing data to be in a group that is atypical of that group. I find it more natural to compare predict(data[t == "treatment_1"]) with predict(data[t == "treatment_0"]) , i.e. subsetting the data. Finally, my questions : Do I conceptually understand correctly what is going on here? If yes, why would you compute average comparisons this way?
