[site]: crossvalidated
[post_id]: 580834
[parent_id]: 580820
[tags]: 
Predictions from case-cohort survival studies The coxphw package probably doesn't fit your application; the weighting there is designed to take censoring probabilities into account so that you can get reasonable estimates of average hazard ratios even when the proportional hazards assumption doesn't hold. It's not designed specifically to handle sampling weights. Better tools for your application are available in the R survey package , which handles multiple sampling approaches and types of statistical analysis. That package requires a specific form for specifying the sampling design. Case-cohort survival studies are illustrated in the two-phase design vignette . Its svycoxph() function, unlike the cch() function, returns an object that inherits from coxph objects and thus can be used to generate predictions. Training/test data split Don't do it with such a small data set. See this web page for details why. Fundamentally, your training set will then give you more imprecise estimates of the coefficients and the test set will be too small to give robust estimates of model performance. The best approach is to build your model with all your data and then evaluate the performance of the modeling approach via resampling. For example, you can repeat the modeling on multiple bootstrap samples of the data, then evaluate performance of all those models on the full data set. See below, however. 812 metabolites Your 98 events set some limits on what you can do here. To avoid overfitting you should only be evaluating about 5 to 10 predictors without some type of penalization, based on a rule of thumb of 10 to 20 events per predictor in survival studies. If A1 , A2 and A3 already represent some substantial dimension reduction from your 812 metabolites, for example the first 3 principal components of the metabolite values, then you should be OK. You would be wise to include outcome-associated clinical variables in addition to the metabolite data to document that the metabolite data is adding something useful to what can already be determined clinically. Note that Cox models have omitted-variable bias even if omitted outcome-associated predictors are uncorrelated with the included predictors. Thus including clinical covariates could actually improve your ability to find outcome-associate metabolite information. If you want to build such models with all 812 of your metabolites, however, you will be facing some substantial problems with overfitting and multiple-comparison problems. Resampling I don't know enough about resampling (bootstrap or cross validation) in case-cohort designs to provide a useful answer to that part of your question. I'm not familiar enough with case-cohort sampling to know whether the bootstrap methods in the survey package are applicable to your study. I found a paper by Y. Huang on " Bootstrap for the case-cohort design ," Biometrika , June 2014, Vol. 101, No. 2, pp. 465-476 that might help. If that doesn't help or you don't get another answer to that part here, you might consider asking a separate question specific to resampling in case-cohort studies.
