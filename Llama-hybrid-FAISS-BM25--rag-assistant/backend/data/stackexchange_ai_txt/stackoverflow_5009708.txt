[site]: stackoverflow
[post_id]: 5009708
[parent_id]: 
[tags]: 
Rails & Rake task - How to prevent duplicates

How to prevent duplicates in rake task ? I have tried to write something but are totally blank. I want to check if the column Date matches the date today if that is true then just update the column with the scraped data unless create a new row with the scraped data. desc "Importer statistikker" namespace :reklamer do task :import_stats => :environment do require 'Mechanize' agent = WWW::Mechanize.new agent.get("http://www.iqmedier.dk") form = agent.page.forms.first form.Username = 'username' form.Password = 'password' form.submit agent.page.link_with(:href => "/Publisher/Stats").click form = agent.page.forms.first form.submit @stats = agent.page.search('//tr')[-2].search('td').map{ |n| n.text } if Reklamer.find(:all) where column is = Date.today if turns true then update that row with @stats else Reklamer.create!(:virksomhed => 'Iqmedier', :dato => @stats[0], :unik_klik => @stats[1], :klik => @stats[2].to_i, :unik_vis => @stats[3], :vis => @stats[4], :leads => @stats[5], :ordre => @stats[6], :cpc => @stats[7], :earn => @stats[8]) end end end Best regards, Rails beginner
