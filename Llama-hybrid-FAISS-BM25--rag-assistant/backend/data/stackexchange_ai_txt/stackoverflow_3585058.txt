[site]: stackoverflow
[post_id]: 3585058
[parent_id]: 
[tags]: 
Update same column in several sql tables using C#

The Scenario: I have a mobile phone comparing asp.net website which displays deals of various networks. The data about the deals we receive from the networks is in an excel sheet. We import the data from the excel sheets to the tables of each network in our database. Now, the data that we receive is not consistent for every network, as in, a network may name give the phone name as 'curve 8250' and another may give it as '8250 curve' and another might give it as '8250curve'. Now, we have another module which allows the user to view the deals of a particular handset available on all the networks. To make this module work, what we need to do id make sure that the phone names are consistent for all the networks. For this, I am planning to make a module for the webadmin which displays the phone names(probably in a gridview) from all the network tables, and the webmaster could edit the phone names so as to make them consistent. The retrieval of the distinct column names from all the tables was easy, and that is done. The Problem: Now, the real part is that how can we program the module so that it updates the particular column values in all the network tables. The schema of each table is exactly the same. Edit: I always forget to add something :@ . I know it can be done the hard way, in code behind, running a loop. But is there any simpler, hassle free way out there? like some datacontrol that would make life a bit easier in this situation? Update: I tried doing this using code behind. I made a gridview and displayed the data using item templates, and also provided a textbox in a second template. Then on a button click, I'm running this code: protected void Button1_Click(object sender, EventArgs e) { SqlConnection con = new SqlConnection(ConfigurationSettings.AppSettings[0].ToString()); foreach(GridViewRow gvr in GridView1.Rows) { TextBox tb = (TextBox)gvr.FindControl("New Value"); Label lbl = (Label)gvr.FindControl("Old Value"); SqlCommand cmd = new SqlCommand(); cmd.Connection = con; if (lbl.Text != tb.Text) { try //updation if primary key constraint is not broken { con.Open(); cmd.CommandText = myupdatecommand; /*this is not the actual command that I'm passing, the command I'm passing does contain the values lbl.Text & tb.Text. This is just to make it a better read.*/ cmd.ExecuteNonQuery(); } catch (SqlException sqe) { if (sqe.ErrorCode == -2146232060)//if primary key constraint is broken { try { //delete the row from the table that contains only unique phone names cmd.CommandText = deletecommand; cmd.ExecuteNonQuery(); } catch { } } } finally { con.Close(); } //Update table2 try //only updation as here the phone name is not a primary key { con.Open(); cmd.CommandText = updatetable2; cmd.ExecuteNonQuery(); } catch { } finally { con.Close(); } . . . //similarily update rest of the tables . . . Response.Redirect(Request.Url.ToString()); } } When I run the this code, everything happens smoothly, but when we update more than one row in the grid at a time, the updation only occurs for the first edited row, the other edited rows are remaining the same. I know it must be a very small thing that I'm missing out on here, but I'm not able to proceed further :( Any help on the matter is highly appreciated. Thanks in advance! PS- I'm using ASP.Net 3.5, with c# as code behind, and SQL Server 2005 as back-end.
