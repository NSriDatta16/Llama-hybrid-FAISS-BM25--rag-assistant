[site]: crossvalidated
[post_id]: 379122
[parent_id]: 
[tags]: 
Understand VAE with VamPrior

I am currently reading this paper . The authors propose to use as an prior this expression: $$ p_\lambda(z) = \frac{1}{K} \sum^K_{k=1} q_\phi (z\mid u_k) $$ where $q_\phi$ is the encoder, and $u_k$ is a learned "pseudo-input". What I dont understand is: What is $q_\phi(z\mid u_k)$ ? How do we sample from it? Do we predict like for a normal VAE just the $\mu(u_k)$ and $\sigma(u_k)$ of a normal distribution and then sample from this one? How do we train that? For a single Gaussian we can calculate the KL Divergence analytically, in terms of $\mu$ and $\sigma$ and then back propagate through the reparametrization trick. How can we do it here?
