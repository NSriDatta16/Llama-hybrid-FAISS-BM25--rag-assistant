[site]: stackoverflow
[post_id]: 244640
[parent_id]: 
[tags]: 
C# refreshing textbox from BindingSource

I am having difficulty refreshing windows forms controls that are using a BindingSource object. We have a CAB/MVP/SCSF client that I (actually “we” since it is a team effort) are developing that will interact with WCF services running on a remote server. (This is our first attempt at this, so we are in a learning mode). One of the calls (from the Presenter) to the service returns a DataSet that contains 3 DataTables, named “Contract”, “Loan” and “Terms”. Each table contains just one row. When the service returns the dataset, we store it in the SmartPart/View in a class member variable, by calling a function in the view called BindData() and passing the dataset in to the view from the presenter class; private System.Data.DataSet _ds = null; public void BindData(System.Data.DataSet ds) { string sErr = ""; try { _ds = ds; // save to private member variable // more code goes down here } } We are trying to bind each of the three DataTables to an assortment of Windows Forms TextBoxes, MaskedEditBoxes, and Infragistics UltraComboEditor Dropdown comboboxes We created three BindingSource objects, one for each DataTable using the VS2008 IDE. private System.Windows.Forms.BindingSource bindsrcContract; private System.Windows.Forms.BindingSource bindsrcLoan; private System.Windows.Forms.BindingSource bindsrcTerms; We are binding the values like this if (bindsrcContract.DataSource == null) { bindsrcContract.DataSource = _ds; bindsrcContract.DataMember = “contract”; txtContract.DataBindings.Add(new Binding("Text", bindsrcContract, "contract_id", true)); txtLateFeeAmt.DataBindings.Add(new Binding("Text", bindsrcContract, "fee_code", true)); txtPrePayPenalty.DataBindings.Add(new Binding("Text", bindsrcContract, "prepay_penalty", true)); txtLateFeeDays.DataBindings.Add(new Binding("Text", bindsrcContract, "late_days", true)); } if (bindsrcLoan.DataSource == null) { bindsrcLoan.DataSource = _ds; bindsrcLoan.DataMember = “loan”; mskRecvDate.DataBindings.Add(new Binding("Text", bindsrcLoan, "receive_date", true)); cmboDocsRcvd.DataBindings.Add(new Binding("Value", bindsrcLoan, "docs", true)); } This works when we do the first read from the service and get a dataset back. The information is displayed on the form's controls, we can update it using the form, and then “save” it by passing the changed values back to the WCF service. Here is our problem. If we select a different loan key and make the same call to the service and get a new DataSet, again with 3 tables with one row each, the controls (textboxes, masked edit boxes, etc.) are not being updated with the new information. Note that the smartPart/View is not closed or anything, but remains loaded in between calls to the service. On the second call we are not rebinding the calls, but simply trying to get the data to refresh from the updated DataSet. We have tried everything we can think of, but clearly we are missing something. This is our first attempt at using the BindingSource control. We have tried bindsrcContract.ResetBindings(false); and bindsrcContract.ResetBindings(true); and bindsrcContract.RaiseListChangedEvents = true; and for (int i = 0; i As well as resetting the DataMember property again. bindsrcContract.DataMember = ”Contract”; We’ve looked at a lot of examples. Many examples make reference to the BindingNavigator but since the DataTables only have one row, we did not think we needed that. There are a lot of examples for grids, but we’re not using one here. Can anyone please point out where we are going wrong, or point us to resources that will provide some more information? We’re using VisualStudio 2008, C# and .Net 2.0, XP client, W2K3 server. Thanks in advance wes
