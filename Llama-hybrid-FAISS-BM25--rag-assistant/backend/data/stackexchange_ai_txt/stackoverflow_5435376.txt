[site]: stackoverflow
[post_id]: 5435376
[parent_id]: 
[tags]: 
Compute average for three periods of times

I have the following three queries which get the average price for a product for three specific period of times: all data, last 7 days and last 30 days. SELECT AVG(Price) AS AggregatedPrice, COUNT(*) AS PCount FROM dbo.Products WHERE Id = @id SELECT AVG(Price) AS AggregatedPrice, COUNT(*) AS PCount FROM dbo.Products WHERE Id = @id AND DATEDIFF(day, UpdatedDatetime, getdate()) Those three queries give me the right data, but not in the form I want. Is there a way to combine those three queries into one. My final goal is to create a view with all this data on one row. In addition, it appears to me that the average computed for the 7 days could be reused for the 30 days and all the list. Is there an optimization that I can do?
