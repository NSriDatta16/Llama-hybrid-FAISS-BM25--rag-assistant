[site]: stackoverflow
[post_id]: 5156745
[parent_id]: 5140017
[tags]: 
There are a few things that profiler tools will require. Environment Variables The majority of coverage tools use the .NET ProfilerAPI to inspect managed code as it's executed. Because the ProfilerAPI uses environment variables to determine if profiling is enabled and which profiler to use, the coverage tool typically writes to these environment variables before and after the coverage session. Users can write to local environment variables without issue, but if the tool is trying to write to system level environment variables, you'll need admin permissions. Registry Access One of the environment variables is the Class Identifier for the unmanaged profiler. If the tool needs to go to the registry to get this identifier, you'll need admin permissions. The other consideration is that some tools register the unmanaged COM dll before the coverage session to play well with the .net xcopy deployment strategy. Old versions of NCover used to do this . The proposed solution is to register the dll as an administrator. Once registered, the tool shouldn't require permissions to perform this additional step.
