[site]: stackoverflow
[post_id]: 3284902
[parent_id]: 
[tags]: 
Exchange Management Powershell with .Net Return Code

How can I get the return code from the following command: RunspaceConfiguration rsConfig = RunspaceConfiguration.Create(); PSSnapInException snapInException = null; PSSnapInInfo info = rsConfig.AddPSSnapIn("Microsoft.Exchange.Management.PowerShell.Admin", out snapInException); Runspace myRunSpace = RunspaceFactory.CreateRunspace(rsConfig); myRunSpace.Open(); //Create pipeline and feed it the script text Pipeline pipeline = myRunSpace.CreatePipeline(); string strScript = "new-storagegroup -Server KINGKONG" + " -LogFolderPath c:\\rsg\\logs -Name RecoveryGroup -SystemFolderPath c:\\rsg\\data -Recovery"; //Add the command to the Commands collection of the pipeline. pipeline.Commands.AddScript(strScript) Collection results = pipeline.Invoke();
