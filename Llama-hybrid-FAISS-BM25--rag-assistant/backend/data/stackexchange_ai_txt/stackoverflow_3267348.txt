[site]: stackoverflow
[post_id]: 3267348
[parent_id]: 920505
[tags]: 
Stumbled across this question, and Ruben Bartelink gave a great answer, but with no code. So I had to look it up elsewhere, which defeats the point of StackOverflow. Now that it's 2010, the other answers given aren't quite as viable. For reference, here's code demonstrating the CopyToDataTable() extension method. It's in VB so as to not steal the credit from Ruben if he wants to revisit the past and post a more complete answer :) Public Function GetSchema(ByVal dbNames As IEnumerable(Of String)) As DataTable Dim schemaTables As New List(Of DataTable)() For Each dbName As String In dbNames Dim cnnStr = GetConnectionString(dbName) Dim cnn As New SqlConnection(cnnStr) cnn.Open() Dim dt = cnn.GetSchema("Columns") cnn.Close() schemaTables.Add(dt) Next Dim dtResult As DataTable = Nothing For Each dt As DataTable In schemaTables If dtResult Is Nothing Then dtResult = dt Else dt.AsEnumerable().CopyToDataTable(dtResult, LoadOption.PreserveChanges) End If Next Return dtResult End Function
