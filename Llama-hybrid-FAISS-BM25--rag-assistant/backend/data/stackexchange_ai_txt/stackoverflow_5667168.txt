[site]: stackoverflow
[post_id]: 5667168
[parent_id]: 5666963
[tags]: 
For the first 3 point I'd suggest you to have a look at libpcap ( tcpdump/libpcap ). For anomaly network activity detection it's a bit more complex, you could have a look at snort and use it like external analysis tool.
