[site]: stackoverflow
[post_id]: 4392683
[parent_id]: 4392574
[tags]: 
declare csrCursor cursor for select Items, count(Orders) as NumberOfOrders, sum(Orders) as TotalOrderQuantity, avg(Orders + 0.0) as AverageOrderQuantity from Fruits group by Items order by 1 declare @Item varchar(10) declare @OrderCount int declare @QuantityTotal int declare @AvgQuantity numeric(9, 2) open csrCursor fetch next from csrCursor into @Item, @OrderCount, @QuantityTotal, @AvgQuantity while (@@fetch_status = 0) -- Do stuff with variables @Item, @OrderCount, @QuantityTotal, @AvgQuantity -- Insert results in Temp Table fetch next from csrCursor into @Item, @OrderCount, @QuantityTotal, @AvgQuantity end close csrCursor deallocate csrCursor
