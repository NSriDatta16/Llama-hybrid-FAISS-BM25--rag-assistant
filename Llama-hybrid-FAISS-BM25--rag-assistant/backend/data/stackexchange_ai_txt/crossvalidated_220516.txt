[site]: crossvalidated
[post_id]: 220516
[parent_id]: 46821
[tags]: 
I had to do this recently and used dplyr . The solution is not as elegant as with data.table , but: library(dplyr) replicate(B, { cluster_sample % inner_join(cluster_sample, by = 'cluster') coef(lm(y ~ x, data = dat_sample)) }) The inner_join repeats every row having a given value x of cluster by the number of times that x appears in cluster_sample .
