[site]: stackoverflow
[post_id]: 5542185
[parent_id]: 5541828
[tags]: 
As the error message is trying to tell you, guard requires that the monad you're using must be an instance of the type class MonadPlus . In this example, you're using the State monad, which is actually a StateT transformer on top of the Identity monad. There is a MonadPlus instance for StateT , but it requires that the underlying monad must be a MonadPlus as well, which Identity isn't. For your example, you can try something like > let loop = modify (+1) >> get >>= \x -> if x
