[site]: stackoverflow
[post_id]: 2966726
[parent_id]: 2966592
[tags]: 
Something like this: public IEnumerable GetDataItems (IEnumerable dtos, Func groupCriteria, Func dataSelector, Func resultFactory) { var validDtos = dtos.Where(d => groupCriteria(d) != null); double totalNumber = validDtos.Sum(dataSelector); return validDtos .GroupBy(groupCriteria) .OrderBy(g => g.Sum(dataSelector)) .Select(gr => resultFactory(gr.Key, gr.Sum(dataSelector), gr.Sum(dataSelector) / totalNumber)); } In your example, you might call it like this: GetDataItems( x => x.Color, // the grouping criterion x => x.Number, // the value criterion (key, total, pct) => new FooDataItem { Color = key, NumberTotal = total, NumberPercentage = pct }); If you changed FooDataItem to be more generic, it would be easier.
