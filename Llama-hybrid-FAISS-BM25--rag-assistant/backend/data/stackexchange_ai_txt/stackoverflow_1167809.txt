[site]: stackoverflow
[post_id]: 1167809
[parent_id]: 1167544
[tags]: 
I don't have a solution for your problem, but here are some ideas: The source code for DevCon is available as part of the Windows DDK under DDK root\Src\Setup\Devcon . If your problem is reproducable, you could build your own version and debug it in your IDE. The sources of the OpenVPN installer can be found in the OpenVPN SVN repository . You could compare how DevCon is invoked and see if the OpenVPN is doing it in a way that prevents the problem. INF files can be installed from the command line using something like rundll32 syssetup,SetupInfObjectInstallAction DefaultInstall 128 .\ .inf but I'd guess that DevCon is doing more than that, so I don't know if this is a viable way. There has to be some reason obviously why the OpenVPN installer is using DevCon, right? @update: The OpenVPN installer seems to set a "Reboot Flag" depending of the return value of DevCon. ;------------------------------------------ ;Set reboot flag based on tapinstall return Function CheckReboot IntCmp $R0 1 "" noreboot noreboot IntOp $R0 0 & 0 SetRebootFlag true DetailPrint "REBOOT flag set" noreboot: FunctionEnd @side note: I'd guess you should be able to port DevCon to C# using P/Invokes. DevCon apparently is just a wrapper around SetupAPI and DIFxAPI. DIFxAPI Documentation: Perform a Default DIFxAPI Installation Perform a Default DIFxAPI Uninstall Operation P/Invokes: SetDifxLogCallback DIFLOGCALLBACK DIFXAPI_LOG DriverPackageInstall DriverPackageUninstall Test program: SetDifxLogCallback(DIFLogCallbackFunc, IntPtr.Zero); bool needReboot; var error = DriverPackageInstall(driverPackageInfPath, 0, IntPtr.Zero, out needReboot); if (error != 0) throw new Win32Exception(error); Output: INFO: ENTER: DriverPackageInstallW. Error code: 0 INFO: Installing INF file 'C:\Program Files (x86)\OpenVPN\driver\OemWin2k.inf' (Plug and Play).. Error code: 0 INFO: Looking for Model Section [tap0901.NTamd64].... Error code: 0 INFO: Installing devices with Id "tap0901" using INF "C:\Windows\system32\DriverStore\FileRepository\oemwin2k.inf_128556d6\OemWin2k.inf".. Error code: 0 INFO: ENTER UpdateDriverForPlugAndPlayDevices.... Error code: 0 SUCCESS: RETURN UpdateDriverForPlugAndPlayDevices.. Error code: 0 INFO: Installation was successful.. Error code: 0 SUCCESS: Install completed. Error code: 0 INFO: RETURN: DriverPackageInstallW (0x0). Error code: 0 The program must be run as administrator, otherwise you get an ERROR_ACCESS_DENIED . If the driver is already installed you get an ERROR_NO_MORE_ITEMS .
