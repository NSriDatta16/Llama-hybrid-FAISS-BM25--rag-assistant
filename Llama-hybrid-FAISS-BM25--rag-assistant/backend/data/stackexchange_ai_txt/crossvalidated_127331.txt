[site]: crossvalidated
[post_id]: 127331
[parent_id]: 
[tags]: 
Searching class-intersections of many hierarchies for maximum/minimum values

Suppose we have some data for a large number of people (e.g. salary). Suppose further, that each person is classified in several hierarchical groups. E.g. they are classified by their location (Toronto Now, what is the most efficient way to find out what intersection (e.g. Luxembourg, Investment Banker) contains the people with the highest average salary? (Simpson's paradox leads me to believe I need to brute force search, but I'm not sure.) Please note I asked this same question here: https://stackoverflow.com/questions/27262813/searching-class-intersections-of-many-hierarchies-for-maximum-minimum-values
