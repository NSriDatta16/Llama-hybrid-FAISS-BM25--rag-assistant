[site]: stackoverflow
[post_id]: 4101638
[parent_id]: 4100538
[tags]: 
Why not to use standard PHP functions for working with URLs? function addURLParameter ($url, $paramName, $paramValue) { $url_data = parse_url($url); $params = array(); parse_str($url_data['query'], $params); $params[$paramName] = $paramValue; $params_str = http_build_query($params); return http_build_url($url, array('query' => $params_str)); } Sorry didn't notice that http_build_url is PECL :-) Let's roll our own build_url function then. function addURLParameter($url, $paramName, $paramValue) { $url_data = parse_url($url); if(!isset($url_data["query"])) $url_data["query"]=""; $params = array(); parse_str($url_data['query'], $params); $params[$paramName] = $paramValue; $url_data['query'] = http_build_query($params); return build_url($url_data); } function build_url($url_data) { $url=""; if(isset($url_data['host'])) { $url .= $url_data['scheme'] . '://'; if (isset($url_data['user'])) { $url .= $url_data['user']; if (isset($url_data['pass'])) { $url .= ':' . $url_data['pass']; } $url .= '@'; } $url .= $url_data['host']; if (isset($url_data['port'])) { $url .= ':' . $url_data['port']; } } $url .= $url_data['path']; if (isset($url_data['query'])) { $url .= '?' . $url_data['query']; } if (isset($url_data['fragment'])) { $url .= '#' . $url_data['fragment']; } return $url; }
