[site]: crossvalidated
[post_id]: 126768
[parent_id]: 
[tags]: 
Equation to get an ordered logit model from R into Excel

Original I have fitted an ordered logistic regression in R using the polr function, but I am having some trouble bringing the model coefficients into Excel and getting the probabilities there. For explanatory variables FlowMonth2, Orders_Apt, GeoUnits, HomeOwner, Platform, CreditScore , my coefficients for the model are as follows: Value Std. Error t value FlowMonth2Aug 0.12321 0.03852 3.1990 FlowMonth2Dec 0.31092 0.03854 8.0672 FlowMonth2Feb 0.02497 0.03873 0.6447 FlowMonth2Jan -0.01874 0.03940 -0.4757 FlowMonth2Jul 0.02924 0.03886 0.7525 FlowMonth2Jun -0.02618 0.04054 -0.6456 FlowMonth2Mar 0.09369 0.03739 2.5054 FlowMonth2May -0.08169 0.03581 -2.2811 FlowMonth2Nov 0.32610 0.03889 8.3841 FlowMonth2Oct 0.45240 0.03708 12.2009 FlowMonth2Sep 0.22771 0.04015 5.6711 Orders_Apty 0.03786 0.02206 1.7160 GeoUnits1 -0.04070 0.03260 -1.2487 GeoUnits2 0.11923 0.03735 3.1920 GeoUnitsOther 0.30464 0.20803 1.4644 GeoUnits5 -0.19669 0.01892 -10.3942 HomeOwnery 0.16577 0.02828 5.8624 PlatformMobile -0.32933 0.01631 -20.1882 CreditScore525 - 600 1.01909 0.02937 34.7036 CreditScore600 - 700 1.12578 0.02953 38.1284 CreditScore700 - 800 1.29098 0.03091 41.7694 CreditScore800 - 900 1.43500 0.03085 46.5179 CreditScore900+ 1.33816 0.02851 46.9414 CreditScoreHit with No Score 0.33832 0.03424 9.8812 CreditScoreNo Hit 0.37199 0.06443 5.7737 The intercepts are Intercepts: Value Std. Error t value 0|1 -1.2788 0.0377 -33.9349 1|2 -0.6609 0.0371 -17.8175 2|3 -0.1683 0.0369 -4.5571 3|4 0.1520 0.0369 4.1159 4|5 0.3813 0.0370 10.3163 5|6 0.5615 0.0370 15.1714 6|7 0.7314 0.0371 19.7357 7|8 0.8551 0.0371 23.0486 8|9 0.9608 0.0371 25.8740 9|10 1.0510 0.0372 28.2760 10|11 1.1342 0.0372 30.4826 11|12 1.2607 0.0373 33.8295 12|13 1.4770 0.0374 39.5140 13|14 1.5414 0.0374 41.1957 14|15 1.5827 0.0374 42.2710 15|16 1.6127 0.0375 43.0505 16|Still Active 1.6358 0.0375 43.6499 Now when I bring this into Excel, I bring in the coefficients, select certain values to add together, say FlowMonth2 = "Aug", Orders_Apt = "n", GeoUnits = "5", HomeOwner = "y", Platform = "Desktop", CreditScore = "800 - 900" . I add these values together to get my logit statistic, $T = \mathbf{x}\mathbf{\beta}$, and then I add this $T$ to each different intercept to get $\beta_{0, i} - T$ for $1 \leq i \leq 17$ where the $17$th stage is transition from 16 to Still Active. I then take $\mathrm{logit}(\beta_{0, i} - T)$ or ${1 \over 1 + \exp(-[\beta_{0, i} - T])} = \Pr(\text{being in the $i$th stage})$ But when I try to do this in Excel, and compare it to the output of predict in R, then I can't get these values to match up? What am I doing wrong in Excel? Edit To compare the values from R and Excel, it's by more than a rounding error that they differ: R: 0 0.048650293 1 0.037989009 2 0.047738406 3 0.041799312 4 0.035787006 5 0.031644868 6 0.032650167 7 0.025400235 8 0.022740618 9 0.020074660 10 0.019006405 11 0.029758088 12 0.052613086 13 0.015949280 14 0.010274309 15 0.007485204 16 0.005777627 Still Active 0.514661427 Excel: 0|1 0.048648622 1|2 0.086640673 2|3 0.134381676 3|4 0.176177948 4|5 0.211958542 5|6 0.243615257 6|7 0.27626595 7|8 0.301669593 8|9 0.32439208 9|10 0.344464821 10|11 0.363487303 11|12 0.393228837 12|13 0.44584823 13|14 0.461809529 14|15 0.472089045 15|16 0.479571379 16|Still Active 0.485339204 Edit 2 Why are there only 17 intercepts in Excel, but 18 predicted points in R?
