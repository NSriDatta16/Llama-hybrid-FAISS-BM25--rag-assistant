[site]: crossvalidated
[post_id]: 264881
[parent_id]: 
[tags]: 
how to use GLS with correlation structure to compare two temperature time series?

I have 2 time series for temperature recorded with 2 sensors in 2 site in a bay. The sensors were recording with the same frequency and during the same period of time. The 2 sites have different depth (A=deep, B= shallow). I want to be able to say if the shallow site is warmer than the deep one or not. I am not interested in the shape of the time series. my dataset has a variable site , one that is julian day (jday) , then Average temp per day ( temp.avg ) and the standard error (se, used only for the plot) dTMP If I plot the data I obtain this graph: plot(temp.avg~jday, data=dTMP[dTMP$site=='A',], type='p', col='blue',ylim=c(5,13), pch=20 ) lines(temp.avg~jday, data=dTMP[dTMP$site=='A',], type='l', col='blue',ylim=c(5,13), lty=1 ) with(dTMP[dTMP$site=='A',], polygon(x=c(jday, rev(jday)) , y= c(temp.avg+1.96*se,rev(temp.avg-1.96*se)), border=NA, col=rgb(0,0,0,0.2) )) par(new=T) plot(temp.avg~jday, data=dTMP[dTMP$site=='B',], type='p', col='red',ylim=c(5,13), pch=20 ) lines(temp.avg~jday, data=dTMP[dTMP$site=='B',], type='l', col='red',ylim=c(5,13), lty=1 ) with(dTMP[dTMP$site=='B',], polygon(x=c(jday, rev(jday)) , y= c(temp.avg+1.96*se,rev(temp.avg-1.96*se)), border=NA, col=rgb(0,0,0,0.2) )) legend(x='topleft',legend=c('A','B'), pch=c(20,20),col=c('blue','red')) From this plot I can see that the 2 series are really similar in term of shape but one is always lower than the other. Also the 95% CI (shaded area) almost never overlap so I'm expecting a significant difference between the 2 sites. Now, I thought that the code to answer my question (i.e. is one site warmer than the other?) was: library (nlme) cs1 However the summary I can obtain says that there is no difference: Generalized least squares fit by REML Model: temp ~ site Data: dTMP AIC BIC logLik 454.5677 470.6964 -222.2839 Correlation Structure: ARMA(1,1) Formula: ~1 | site Parameter estimate(s): Phi1 Theta1 0.8661159 0.2603911 Coefficients: Value Std.Error t-value p-value (Intercept) 8.550266 0.7183725 11.902274 0.0000 siteB 0.684303 1.0159321 0.673572 0.5014 Correlation: (Intr) siteB -0.707 Standardized residuals: Min Q1 Med Q3 Max -1.6126448 -0.5530600 0.2409433 0.9841246 1.7444175 Residual standard error: 1.949408 Degrees of freedom: 188 total; 186 residual My question now are: 1) Am I coding the model correctely to account for autocorrelation within sites? i.e. is it correct to have form = ~ 1 | site in my correlation structure? if not what should I use and why? 2) with the code I wrote, what am I really doing? Am I comparing the shape of the 2 series? I read pinheiro and bates 2000 and Zuur 2009 but I can't figure it out. Rigth now I'm more confused then ever.
