[site]: crossvalidated
[post_id]: 206752
[parent_id]: 206748
[tags]: 
I recommend checking out Mostly Harmless Econometrics - they have a good explanation of this at an intuitive level. The problem you're trying to solve is selection bias. If a variable $x_i$ is correlated with the potential outcomes $y_{0i},y_{1i}$ and with the likelihood of receiving treatment, then if you find that the expected outcome of the treated is better than the expected outcome of the untreated, this may be a spurious finding since the treated tend to have higher $x$ and therefore have higher $y_{0i},y_{1i}$. The problem arises because $x$ makes $y_{0i},y_{1i}$ correlated with the treatment. This problem can be solved by controlling for $x$. If we think that the relationship between the potential outcomes and the variables $x$ is linear, we just do this by including $x$ in a regression with a dummy variable for treatment, and the dummy variable interacted with $x$. Of course, linear regression is flexible since we can include functions of $x$ as well. But what if we do not want to impose a functional form? Then we need to use a non-parametric approach: matching. With matching, we compare treated and untreated observations with similar $x$. We come away from this with an estimate of the effect of treatment for all $x$ values (or small ranges of values or "buckets") for which we have both treated and untreated observations. If we do not have many such $x$ values or buckets, in particular if $x$ is a high-dimensional vector so it is difficult to find observations close to one other, then it is helpful to project this space onto one dimension. This is what propensity score matching does. If $y_{0i},y_{1i}$ are uncorrelated with treatment given $x_i$, then it turns out that they are also uncorrelated with treatment given $p(x_i)$ where $p(x)$ is the probability of treatment given $x$, i.e. the propensity score of $x$. Here's your intuition: if we find a sub sample of observations with a very similar propensity score $p(x)$, then for that sub-sample, the treated and untreated groups are uncorrelated with $x$. Each observation is equally likely to be treated or untreated; this implies that any treated observation is equally likely to come from any of the $x$ values in the sub-sample. Since $x$ is what determines the potential outcomes in our model, this implies that, for that sub-sample, the potential outcomes $y_{0i},y_{1i}$ are uncorrelated with the treatment. This condition ensures that the sub-sample average difference of outcome between treated and untreated is a consistent estimate of the average treatment effect on this sub-sample, i.e. $$ E[y_i|\text{Treated},p(x)] - E[y_i|\text{Untreated},p(x)] $$ is a consistent estimate of the local average treatment effect. Further reading: Should we really use propensity score matching in practice? Related question comparing matching and regression
