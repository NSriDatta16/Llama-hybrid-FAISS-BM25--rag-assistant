[site]: stackoverflow
[post_id]: 2440037
[parent_id]: 2439968
[tags]: 
The Text::Balanced module is what you seem to be after if you're looking to use Perl. The following should be able to extract all the quoted speech in your example (not pretty, but gets the job done). It also works for Dennis' test cases. The advantage of the code below is that the quotes are grouped by paragraph, which may or may not be useful for later analysis Script use strict; use warnings; use Text::Balanced qw/extract_quotelike extract_multiple/; my %quotedSpeech; { local $/ = ''; while (my $text = ) { # one paragraph at a time while (my $speech = extract_multiple( $text, [sub{extract_quotelike($_[0])},], undef, 1)) { push @{$quotedSpeech{$.}}, $speech; } } } # Print total number of paragraphs in DATA filehandle print "Total paragraphs: ", (sort {$a $b} keys %quotedSpeech)[-1]; # Print quotes grouped by paragraph: foreach my $paraNumber (sort {$a $b} keys %quotedSpeech) { print "\n\nPara ",$paraNumber; foreach my $speech (@{$quotedSpeech{$paraNumber}}) { print "\t",$speech,"\n"; } } # How many quotes in paragraph 8? print "Number of quotes in Paragraph 8: ", scalar @{$quotedSpeech{8}}; __DATA__ "Ah, that's perfectly true!" exclaimed Alyosha. "Oh, do leave off playing the fool! Some idiot comes in, and you put us to shame!" cried the girl by the window, suddenly turning to her father with a disdainful and contemptuous air. "Wait a little, Varvara!" cried her father, speaking peremptorily but looking at them quite approvingly. "That's her character," he said, addressing Alyosha again. "Where have you been?" he asked him. "I think," he said, "I've forgotten something... my handkerchief, I think.... Well, even if I've not forgotten anything, let me stay a little." He sat down. Father stood over him. "You sit down, too," said he. He said, "It doesn't always work." "Secondly," I said, "it fails for three quoted phrases..." He completed my thought, "with two unquoted ones." I replied, "That's right." dejectedly. Output Total paragraphs: 10 Para 1 "Ah, that's perfectly true!" Para 2 "Oh, do leave off playing the fool! Some idiot comes in, and you put us to shame!" Para 3 "Wait a little, Varvara!" "That's her character," Para 4 "Where have you been?" Para 5 "I think," "I've forgotten something... my handkerchief, I think.... Well, even if I've not forgotten anything, let me stay a little." Para 7 "You sit down, too," Para 8 "It doesn't always work." Para 9 "Secondly," "it fails for three quoted phrases..." "with two unquoted ones." Para 10 "That's right."
