[site]: stackoverflow
[post_id]: 4965139
[parent_id]: 4964865
[tags]: 
What query are you using to get the averages? Just applying "AVG" to your expression for 'sim' should work in mysql. e.g. AVG(1000 - ABS(p1.gp - px.gp) - ABS(p1.goals - px.goals) - ABS(p1.assists - px.assists)) sim To aggregate over different years, I think there is no alternative to using a subselect or union. Reference: http://dev.mysql.com/doc/refman/5.0/en/subqueries.html http://dev.mysql.com/doc/refman/5.0/en/union.html Something like: (ORIGINAL AVG QUERY) UNION ALL (ORIGINAL AVG QUERY WITH NEW YEAR) should do the trick. (Note that your original query selects data from every year to compare it to the data for John Smith in 2010, which may not be what you want.)
