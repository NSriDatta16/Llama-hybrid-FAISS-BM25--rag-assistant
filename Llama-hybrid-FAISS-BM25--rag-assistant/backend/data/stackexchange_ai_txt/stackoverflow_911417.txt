[site]: stackoverflow
[post_id]: 911417
[parent_id]: 911326
[tags]: 
This should do it: --Test Data CREATE TABLE RowsToAverage ( ID int NOT NULL, Number int NOT NULL ) INSERT RowsToAverage(ID, Number) SELECT 1, 1 UNION ALL SELECT 2, 3 UNION ALL SELECT 3, 2 UNION ALL SELECT 4, 4 UNION ALL SELECT 5, 6 UNION ALL SELECT 6, 8 UNION ALL SELECT 7, 10 --The query ;WITH NumberedRows AS ( SELECT rta.*, row_number() OVER (ORDER BY rta.ID ASC) AS RowNumber FROM RowsToAverage rta ) SELECT nr.ID, nr.Number, CASE WHEN nr.RowNumber = nr.RowNumber - 3 ) END AS MovingAverage FROM NumberedRows nr
