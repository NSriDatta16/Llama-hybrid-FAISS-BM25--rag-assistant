[site]: stackoverflow
[post_id]: 2620449
[parent_id]: 2599027
[tags]: 
With some help from a Microsoft forum I was led into a direction that finally works. Below a proof of concept in C++.NET (. using namespace System::Windows::Forms; [STAThread] String^ GetBrowserVersion() { String^ strResult = String::Empty; WebBrowser^ wb = gcnew WebBrowser(); String^ strJS = " function GetUserAgent() { return navigator.userAgent; } "; wb->DocumentStream = gcnew MemoryStream( ASCIIEncoding::UTF8->GetBytes(strJS) ); while ( wb->ReadyState != WebBrowserReadyState::Complete ) { Application::DoEvents(); } String^ strUserAgent = (String^)wb->Document->InvokeScript("GetUserAgent"); wb->DocumentStream->Close(); String^ strBrowserName = String::Empty; int i = -1; if ( ( i = strUserAgent->IndexOf( "MSIE" ) ) >= 0 ) { strBrowserName = "Internet Explorer"; } else if ( ( i = strUserAgent->IndexOf( "Opera" ) ) >= 0 ) { strBrowserName = "Opera"; } else if ( ( i = strUserAgent->IndexOf( "Chrome" ) ) >= 0 ) { strBrowserName = "Chrome"; } else if ( ( i = strUserAgent->IndexOf( "FireFox" ) ) >= 0 ) { strBrowserName = "FireFox"; } if ( i >= 0 ) { int iStart = i + 5; int iLength = strUserAgent->IndexOf( ';', iStart ) - iStart; strResult = strBrowserName + " " + strUserAgent->Substring( iStart, iLength ); } return strResult; }
