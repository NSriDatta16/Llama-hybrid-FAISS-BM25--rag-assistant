[site]: crossvalidated
[post_id]: 319026
[parent_id]: 318887
[tags]: 
Simulation is a viable means of inspecting the operating characteristics of a diagnostic test. While preliminary studies present sensitivity and specificity with 95% confidence intervals, these CIs do not actually represent a Bayesian probability in what such values are. Thus when you set out to conduct your simulation study, it is better to consider the test characteristics as fixed or given, and then to simulate a random process of the disease status and test evaluation according to those parameters. By doing this, you can appropriately summarize the test performance (and its uncertainty) in a variety of scenarios, such as an elevated prevalence of disease or in larger samples. The basic parameters are given as follows: \begin{array}{c|ccc} & D & \bar{D} & \\ \hline T & TP & FP& n_t\\ \bar{T} & FN & TN & n-n_t\\ & n_d & n-n_d \end{array} As an example, suppose a test was developed and studied in a cohort with 40% sensitivity ($TP/n_d$) and 90% specificity ($TN/(n-n_d)$). Suppose further I consult the literature and find that the originating sample was 100 patients with a disease prevalence of 10% (say, in a hospital setting). Then, the table above boils down to \begin{array}{c|ccc} & D & \bar{D} & \\ \hline T & 4 & 9 & 13\\ \bar{T} & 6 & 81 & 87\\ & 10 & 90 \end{array} But if we wish to simulate these outcomes, the $TN$ and the $FN$ are merely binomial probability models. Using R I can simulate this contingency table with: sim gets: > sim(n=100, pd=0.1, se=0.4, sp=0.9) [,1] [,2] [1,] 4 8 [2,] 4 84 which shows some stochastic variability from the design. Performing many 1000s of replications: OUT Which gives > mean(sens) + c('lower 95%'=-1, 'mean'=0, 'upper 95%'=1) %o% qnorm(0.975) * sd(sens) [,1] lower 95% 0.06350984 mean 0.40045478 upper 95% 0.73739973 So as expected this design is inefficient for evaluating test-reliability. We did not generate variability in the test, but rather simulated the test outcome as a random process which is accurately summarized in the sensitivity and specificity and varies under experimentation a function of experimental design.
