[site]: stackoverflow
[post_id]: 1082629
[parent_id]: 1081466
[tags]: 
If all you're trying to do is figure out which documents are crashing, you should put logging around the call to the NLP library, "about to map document x". When you see the OOM, the logs for the mapper will contain the document of doom. Like you said, you should then determine what characteristics of that document cause the library to crash. In my experience, especially if the documents were created by people on the Internet, you will find some crazy huge document somewhere. At that point you have to decide what to do with such documents; either to ignore them, maybe truncate them.
