[site]: crossvalidated
[post_id]: 614775
[parent_id]: 
[tags]: 
Building a hybrid model? From a Random Forest and a OLS linear regressions

Cureently, I am conducting a regression study of household expenditure (target variable) from a set of determiants (income, household size, ...) in Malaysia using OLS and Random Forest. It is a long question... In my study, result shows that OLS regression (0.853) performs slightly better than Random Forest regresion (0.850) using r2 score. However, Random Forest is another good choice as part of my determinants having non-linear relationships (such as age) with target variable, which are classified as insignifcant variables (using t-test) in OLS. I found a study here: https://www.sciencedirect.com/science/article/pii/S0957417421000312?via%3Dihub The authors performed a comparison study between Random Forest and hedonic regression. Here is the conclusion written in the paper (RF is slightly bad in term of accuracy for my study): In terms of accuracy, the ML methods are superior to all of the regression methods, although their capacity to explain a socioeconomic variable can be found to be spurious when the variables are highly correlated. In terms of the effects on quantification, the regression models are superior as they are capable of precisely identifying each characteristicâ€™s particular effect and defining the range of effects. I am looking for a way that could utilized the strength from both of my models. Here are my assumptions: 1) Develop a hyrbid model To combine the strengths from my OLS (accuracy) and Random Forest model (able to distinguish the non-linear relationships), I tried the stacking regression. The result shows that the r2 score improved a litte(0.855) using Random Forest as base and OLS as final estimators. I am wondering do the stacking regression actually integrated both the strengths that I mentioned? Following is the python code used to develop the stacking regression: level0 = list() level0.append(('rf', RandomForestRegressor(n_estimators = 1000, min_samples_split= 30, min_samples_leaf= 4, max_features= 'auto', max_depth= 10, bootstrap= True))) level1 = LinearRegression() # define the stacking ensemble stack_model = StackingRegressor(estimators=level0, final_estimator=level1, cv=5, passthrough=True) # fit the model on all available data stack_model.fit(x_train, y_train) the x_train consists of the variables that having the non-linear relationships. I fed directly the x_train to the stacking regression, I am not sure is it a right or wrong practice. Following is the SHAP summary plot for Random Forest: And following is the statistics summary for OLS: The variable x4 is 'Sex' (insignifcant) and x5 is 'Age' (less significant compared to others). 2) Using RF as factor analysis and OLS as regression model? Since 'Sex' and 'Age' having non-linear relationships, my second assumption is using the RF model for Factor Analysis and as a tool to detect variables having the non-linear relationship with household expenditure. Then, using a quantile regression model (as how the hedonic model study did) to desribe the relationships in quantile forms. Conclusion I am looking for a way to combine both the Random Forest and OLS regressions, either develop a hyrid model or any other methods, rather than a comparison study. Appericate for any guidance. Thanks
