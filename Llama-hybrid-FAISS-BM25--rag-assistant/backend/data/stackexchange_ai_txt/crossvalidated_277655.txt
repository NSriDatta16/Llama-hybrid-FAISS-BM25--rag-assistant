[site]: crossvalidated
[post_id]: 277655
[parent_id]: 152644
[tags]: 
Given that the periodicity of the time series should be well understood a simple, but effective, algorithm based on differencing can be devised. A simple one-step differencing will detect a sudden drop from a previous value $$y_t'= y_t - y_{t-1}$$ but if the series has a strong periodic component you'd expect that drop to be considerable at a regular basis. In this case it would be better to compare any value to its counterpart at the same point in the previous cycle, that is, one period ago. $$y_t'= y_t - y_{t-n} \quad \text{where } n=\text{length of period}$$ In the case of the posted question it would be natural to expect two significant periodic components, one the length of a day, the other the length of a week. But this isn't much of a complication, as the length of the longer period can be neatly divided by the length of the shorter. If the sampling is done every hour, $n$ in the above equation should be set to $24*7 = 168$ If the drops are more of a proportional character a simple difference will easily fail to detect a sudden drop when activity is low. In such circumstances the algorithm can be modified to calculate ratios instead. $$y_t^*= \frac{y_t}{y_{t-n}}$$ I did some tests in R using a simulated dataset. In it data is sampled 6 times a day and there are strong daily and weekly periods, along with other noise and fluctuations. Drops were added in at random places and of durations between 1 and 3. To isolate the drops first ratios was calculated at distance 42, then a threshold set at 0.6, as only negative change of a certain size is of interest. Then a one-step difference was calculated, and a threshold set at -0.5. In the end one false positive appears to have slipped through (the one at the end of week 16). The graphs at the left and right show the same data, just in different ways.
