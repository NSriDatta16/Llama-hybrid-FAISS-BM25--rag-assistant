[site]: stackoverflow
[post_id]: 5155430
[parent_id]: 
[tags]: 
Openlayers - arrary of info into popupmarker

I have a connection to a database(db). I am getting the lon, lat and name from the db and stroing them: while ($row_ChartRS = mysql_fetch_array($sql1)) { $latitude=$row_ChartRS['latitude']; $longitude=$row_ChartRS['longitude']; $bus_name =$row_ChartRS['short_name']; //echo $latitude.'--'.$longitude.' '; echo $bus_name; I then create a map to display the data. The markers are working fine for all lat, lon locations. Code: function init() { projLonLat = new OpenLayers.Projection("EPSG:4326"); // WGS 1984 projMercator = new OpenLayers.Projection("EPSG:900913"); // Spherical Mercator overviewMap = new OpenLayers.Control.OverviewMap(); //adding scale ruler scale = new OpenLayers.Control.ScaleLine(); scale.geodesic = true; // get the scale projection right, at least on small map = new OpenLayers.Map('demoMap', { controls: [ new OpenLayers.Control.Navigation(), // direct panning via mouse drag new OpenLayers.Control.Attribution(), // attribution text new OpenLayers.Control.MousePosition(), // where am i? new OpenLayers.Control.LayerSwitcher(), // switch between layers new OpenLayers.Control.PanZoomBar(), // larger navigation control scale, overviewMap // overview map ] } ); map.addLayer(new OpenLayers.Layer.OSM.Mapnik("Mapnik")); map.addLayer(new OpenLayers.Layer.OSM.Osmarender("Osmarender")); //Create an explicit OverviewMap object and maximize its size after adding it to the map so that it shows //as activated by default. overviewMap.maximizeControl(); //Adding a marker markers = new OpenLayers.Layer.Markers("Vehicles"); map.addLayer(markers); vectorLayer = new OpenLayers.Layer.Vector('Routes'); map.addLayer(vectorLayer); for (k in Locations) { //adding a popup for the marker var feature = new OpenLayers.Feature(markers, new OpenLayers.LonLat(Locations[k].lon, Locations[k].lat).transform(projLonLat,projMercator)); //true to close the box feature.closeBox = true; feature.popupClass = new OpenLayers.Class(OpenLayers.Popup.AnchoredBubble, { //create the size of the box 'autoSize': true, 'maxSize': new OpenLayers.Size(100,100) }); //add info into box for (z in names) { feature.data.popup = new OpenLayers.Feature(new OpenLayers.LonLat(names[z]).transform(projLonLat,projMercator)); } //puts a scroll button on box to scroll down to txt //feature.data.overflow = "auto"; marker = feature.createMarker(); marker.display(true); markerClick = function (evt) { if (this.popup == null) { this.popup = this.createPopup(this.closeBox); map.addPopup(this.popup); this.popup.show(); } else { this.popup.toggle(); } currentPopup = this.popup; OpenLayers.Event.stop(evt); }; marker.events.register("mousedown", feature, markerClick); markers.addMarker(marker); map.setCenter(new OpenLayers.LonLat(Locations[k].lon, Locations[k].lat).transform(projLonLat,projMercator), zoom); var lonLat1 = new OpenLayers.LonLat(Locations[k].lon,Locations[k].lat).transform(new OpenLayers.Projection('EPSG:4326'), map.getProjectionObject()); var pos2=new OpenLayers.Geometry.Point(lonLat1.lon,lonLat1.lat); points1.push(pos2); //Uncomment to put boxes in when map opens //feature.popup = feature.createPopup(feature.closeBox); //map.addPopup(feature.popup); //feature.popup.show() } var lineString = new OpenLayers.Geometry.LineString(points1); var lineFeature = new OpenLayers.Feature.Vector(lineString,'',style_green); vectorLayer.addFeatures([lineFeature]); map.setCenter(lonLat1,zoom); } //function However the name in the popup marker is the same for all markers. i.e. the last name pulled from the db. Can anyone please help with this - I have spent 3 full days trying to fix it! Thanks in advance!
