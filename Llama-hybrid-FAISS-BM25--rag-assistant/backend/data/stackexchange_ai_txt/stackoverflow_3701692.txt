[site]: stackoverflow
[post_id]: 3701692
[parent_id]: 
[tags]: 
How to load combobox items on window load

I have 4 comboboxes bound (via an observable collection) to 4 separate folders containing about 200+ items each. When the window first loads, the filenames are stored in 4 separate observable collections, the datacontext of each combobox is set to its respective collection, then I'm using a converter to convert the uri to an image (with reduced quality to improve loading a bit) inside the ItemTemplate. When I run the project, the splash screen shows up for 2-3 seconds max. But when I try to open each combobox, it takes 20-30 seconds to load all the items for the first time. So I'm wondering how I can move this loading to when the splash screen is showing. Alternatively, is there a way to do something before/while the combobox is loading its items to let the user know the app didn't freeze? .. The combobox is using a wrappanel so I added a Loaded event to change a label to "Done" when it's finished loading, but I don't know which event to use to tell the user it's started loading. I tried MouseDown on the combobox but that didn't help (and I don't think it'd give the right behavior even if it worked). Edit: Here's the code (just copying the relevant parts for one combobox for simplicity) MainWindow, ComboBox XAML: MainWindow code-behind: Private layers1 As New ObservableCollection(Of CustomLayer) Sub New() InitializeComponent() cmbLayers1.DataContext = layers1 ImportLayersFromFolder(My.Application.Info.DirectoryPath & "\Layer1", layers1) cmbLayers1.SelectedIndex = 0 End Sub Private Sub ImportLayersFromFolder(ByVal folder As String, ByVal layers As ObservableCollection(Of CustomLayer)) Dim files() As String = Directory.GetFiles(folder, "*.png") Try For Each sFile As String In files layers.Add(New CustomLayer(sFile)) Next Catch ex As Exception MessageBox.Show(ex.Message) End Try End Sub CustomLayer Class: Public Class mainLayer Public Property Name As String Public Property Path As String Public ReadOnly Property FullPath As String Get Return System.IO.Path.Combine(Path, Name) End Get End Property Public Overrides Function ToString() As String Return FullPath End Function Public Sub New(ByVal filename As String) Dim info As New FileInfo(filename) Name = info.Name Path = info.DirectoryName End Sub End Class Thumbnail Converter: Public Class UriToThumbnailConverter Implements IValueConverter Public Function Convert(ByVal value As Object, ByVal targetType As System.Type, ByVal parameter As Object, ByVal culture As System.Globalization.CultureInfo) As Object Implements System.Windows.Data.IValueConverter.Convert Dim bi As New BitmapImage() bi.BeginInit() bi.DecodePixelWidth = 60 bi.CacheOption = BitmapCacheOption.OnLoad bi.UriSource = New Uri(value.ToString()) bi.EndInit() Return bi End Function Public Function ConvertBack(ByVal value As Object, ByVal targetType As System.Type, ByVal parameter As Object, ByVal culture As System.Globalization.CultureInfo) As Object Implements System.Windows.Data.IValueConverter.ConvertBack Throw New NotSupportedException End Function End Class
