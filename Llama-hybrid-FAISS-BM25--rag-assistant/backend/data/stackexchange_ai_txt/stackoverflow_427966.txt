[site]: stackoverflow
[post_id]: 427966
[parent_id]: 
[tags]: 
VB6 ADO Connection Pooling

We have a bunch of VB6 apps at our company. We are trying to debug a random SQL timeout error and did a trace with SQL Server Profiler on the Audit Login event. We noticed that the connections were coming in as nonpooled. We use the SQLOLEDB provider with SQL Server 2000 & 2005. I searched the internet and everything I come across says that connections are pooled by default in the SQLOLEDB provider, but we are not seeing this. Below is the code we use to connect to the database. We really need to have these connections pooled because we think this may be the problem with our random timeout error. Could any one shine some light on why connection pooling isn't working and any way to make it work? Thanks. Dim cnn As New ADODB.Connection cnn.ConnectionString = "Provider=SQLOLEDB;Data Source=xxx;Catalog=xxx;User ID=xxx Password=xxx;" Call cnn.Open Dim cmd As New ADODB.Command Set cmd.ActiveConnection = cnn cmd.CommandText = "SELECT * FROM [Table]" Dim rs As New ADODB.RecordSet Call rs.Open(cmd, , adOpenStatic, adLockOptimistic) While Not rs.eof 'Do stuff Call rs.MoveNext Wend 'Close and Dispose connection here
