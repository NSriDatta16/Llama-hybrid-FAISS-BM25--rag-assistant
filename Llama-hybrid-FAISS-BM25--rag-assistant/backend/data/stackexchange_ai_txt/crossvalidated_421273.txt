[site]: crossvalidated
[post_id]: 421273
[parent_id]: 
[tags]: 
Sampling highly imbalance multi-class response variable

I have a dataset (11000 x 117) with response variable having multiple classes. Here is a plot of class distribution: Some of the classes have only 1 sample in the entire dataset and some have 2, 3 and 5. I have tried: SMOTE: Smote sampling , it generates sample (with freq = 100, 11000x117) for each of the classes but the model performs very poor on such sampled dataset. May be because SMOTE generate new points in the plane for samples : SMOTE downSample & upSample: Does not give good accuracy, explained below. Sample/class weights in loss function: get_class_weights % select(var, frequency) majority=max(counter $frequency) counter$ weight=pracma::ceil(majority/counter $frequency) l_weights=setNames(as.list(counter$ weight), counter$var) return(l_weights) } This helped increase train and vald accuracy from 0.18 to 0.28 but it is still not enough. As you can see, the classes are highly imbalanced. Is there any other way this can be done? I am using Keras networks in R to train a neural network. SOLUTION I tried: After removing the observation for which the classes have low frequency( and as there is still imbalance, so I tried upSample and it resulted in the following distribution: BUT even after this distribution, the neural net gives only 35% accuracy . What could be the reason for this?
