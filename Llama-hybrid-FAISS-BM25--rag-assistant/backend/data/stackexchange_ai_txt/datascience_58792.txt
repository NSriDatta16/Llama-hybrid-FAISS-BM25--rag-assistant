[site]: datascience
[post_id]: 58792
[parent_id]: 
[tags]: 
Linear/Logistic Regression for unknown values or how to get a good prior for new coefficients

Suppose, we model the probability of making holidays by country and town. The input data are people and how many people actually made holiday in that particular town: country city people holidays ratio USA New York 1000 100 0.1 USA Seattle 1000 10 0.01 France Paris 2000 300 0.15 France Metz 500 1 0.002 I translated this into a dataset where each person is a row with a response column telling you he did make holidays there or not. The data was one-hot-encoded and a logistic regression model has been fitted: df = pd.DataFrame(data, columns=["country", "city", "response"]) y = df["response"] x = df[["country", "city"]] one_hot_encoder = OneHotEncoder(handle_unknown="ignore") one_hot_encoder.fit(x) x_encoded = one_hot_encoder.transform(x) model = LogisticRegression(C=1000, max_iter=100, tol=1e-4, multi_class="auto", fit_intercept=False) model.fit(x_encoded, y) Obviously, the model fits the data perfectly. But I have problems getting sensible outputy for new cities: test_data = [["USA", "New York"], ["USA", "Seattle"], ["France", "Paris"], ["France", "Metz"], ["USA", "LA"], ["France", "Toulouse"]] df_test = pd.DataFrame(test_data, columns=["country", "city"]) print(list(model.predict_proba(one_hot_encoder.transform(df_test))[:, 1])) Giving me the ouput: [0.09999993334172928, 0.010002334489653115, 0.14999954347142497, 0.0020084516806597843, 0.09414556621759342, 0.06613327102757466] As you can see, the probability of making holidays in LA is 0.094. Since it was 0.1 for NY and 0.01 for seattle, I expected something more in the middle, maybe around 0.05. So lets have a look at the coefficients: {'USA': -2.264036462775647, 'New York': 0.06681114479175591, 'Seattle': -2.3308476075654636 ... } This is actually different from what I expected. I expected the mean of the coefficients of New York and Seattle to be zero. I can easily have this by shifting the coefficients of the two cities by -1.13201823139 and the coefficient of USA by 1.13201823139. The model would be the same in terms of loss and predictions. Using different solvers, different regularization metrics or regularization parameters obviously gives you slightly different results, but none comes close to what I would like to have and what I expected. It also makes the interpretation of the coefficients more complicated. By shifting the coefficients as above, I create completely different log odds. Its impossible to relate how much more likely a holiday in France is compared to a holiday in the USA. Anyone has an idea how I can force the model to fit the data as I expected or any other ideas how to get good predictions for unknown data? Maybe someone has read something about this issue before? Edit: I figured it must somehow be the regualization that pushes the coefficients into this particular outcome...Any ideas how to prevent it or use a custom one that does the trick?
