[site]: stackoverflow
[post_id]: 1982991
[parent_id]: 1982939
[tags]: 
note: the average in your example is 37297, so all three values in the table end up being outside the tolerance. ;with Weeks as --narrows the range to the provided dates ( select * from YourTable where Week_End between @StartDate and @EndDate ), PercentOff as ( select week_end, sales, abs((a.avg - sales)/a.avg) as pct from Weeks cross join (select avg(sales) as avg from Weeks) a ) select * from PercentOff where pct >= .03
