[site]: stackoverflow
[post_id]: 2438173
[parent_id]: 2437763
[tags]: 
As Len Holgate mentions, I would suggest refactoring (if needed) and creating interfaces for the parts of the code where different threads interact with objects carrying a state. These parts of the code can then be tested separate from the code containing the actual functionality. To verify such a unit test, I would consider using a code coverage tool (I use gcov and lcov for this) to verify that everything in the thread safe interface is covered. I think this is a pretty convenient way of verifying that new code is covered in the tests. The next step is then to follow the advice of the other answers regarding how to run the tests.
