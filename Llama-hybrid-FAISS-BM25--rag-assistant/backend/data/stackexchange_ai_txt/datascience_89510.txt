[site]: datascience
[post_id]: 89510
[parent_id]: 89506
[tags]: 
$p(s', r | s, a)$ is the probability of arriving at state $s'$ and obtain reward $r$ given that the environment was in state $s$ and the agent took action $a$ . Therefore, this probability is defined assuming action $a$ is taken . There is no probability of taking $a$ included there. The probability of the agent taking an action is provided by the policy $\pi$ , and that is why we need it in the equation. You can think of the interaction of these two terms with the law of total probability : $p(A)=\sum _{n}p(A\mid B_{n})p(B_{n})$ , where $p(B_{n})$ is analogous to $\pi(a|s)$ and $p(A\mid B_{n})$ is analogous to $p(s', r | s, a)$ .
