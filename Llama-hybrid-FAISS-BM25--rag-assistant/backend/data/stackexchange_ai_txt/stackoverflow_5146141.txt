[site]: stackoverflow
[post_id]: 5146141
[parent_id]: 5146082
[tags]: 
Use the subset function to get the subset of the data-frame you want. E.g. if df is your original data-frame, you can do: df.d And then you can do whatever calc you want on df.d . To replace the "large" and "small" values by their mean, you could do it in base R using Joshua's approach (using ave and within ) or using the ddply function from the plyr package: require(plyr) ## ddply breaks up the data-frame according to the value of "DayNight" ('d' or 'n') and ## WITHIN each category, "transforms" the flux column as desired ddply(df, .(DayNight), transform, flux = ifelse( flux > mean(flux) + 2*sd(flux) | flux I'm using shortened versions of your column names, but I'm sure you get the idea. If you know the "right" level of the average and std deviation a priori , you can replace the mean(flux) and sd(flux) in the above code, with those values.
