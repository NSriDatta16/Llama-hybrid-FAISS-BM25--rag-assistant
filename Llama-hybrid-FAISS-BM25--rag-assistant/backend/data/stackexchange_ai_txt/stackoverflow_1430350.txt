[site]: stackoverflow
[post_id]: 1430350
[parent_id]: 1424430
[tags]: 
I don't know exactly how it's handled, but I'd look at Magento's own implementation for similar payment gateways like Google Checkout or Paypal. They work in a manner similar to what you describe for your payment processor.
