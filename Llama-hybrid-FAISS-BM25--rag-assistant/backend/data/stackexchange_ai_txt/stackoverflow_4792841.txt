[site]: stackoverflow
[post_id]: 4792841
[parent_id]: 
[tags]: 
Script timesout in the middle of execution

I wrote a small script to help re-organize my .mp3 collection. When I run this script, sometimes it will process several thousand files till it would hit an error condition (normally a move of a file that had a special character in its name/path that I hadn't counted for), but it would often exit the script with the text Script execution time was exceeded on script "C:\DevSpace\mp3move.vbs". Script execution was terminated. Im not sure why this is happening. In an effort to figure out where this occured I added several msgbox lines, and what I found is that a msgbox would popup, but then it would auto-close very quickly. Here is the code - i appoligize for not getting the formatting correctly in the forum 'Takes all .MP3 files in the source dir, reads the Artist tag associated with that file 'Checks for a dir named after the artist in the destination dir 'If the folder artist/album does not exists, it will create it 'Then move the .mp3 file to the dest dir Dim oAppShell, oFSO, oFolder, oFolderItems Dim strPath, i Dim sInfo iDebug=0 sInfo = "Item Description" strPath = "K:\_preprocess" sDestination = "K:\Music" Set oAppShell = CreateObject("Shell.Application") Set oFSO = CreateObject("Scripting.FileSystemObject") If not oFSO.FolderExists(strPath) Then WScript.Echo "Folder " & strPath & " is inaccessble" End If Set oFolder = oAppShell.NameSpace(strPath) Set oFolderItems = oFolder.Items() sCreate = "" sExist = "" sMoved = "" If (not oFolderItems is nothing) Then if oFolderItems.Count = 0 then Wscript.echo "no files found in this folder: " & strPath WScript.Quit end If If iDebug = 1 Then i = oFolderItems.count WScript.Echo i End If For Each oItem in oFolderItems If iDebug = 1 Then i = i - 1 End If If oItem.Type = "MP3 audio file (mp3)" or oItem.Type = "MP3 Format Sound (.mp3)"_ Or oItem.Type = "Windows Media Audio file" or oItem.Type = "MP3 Format Sound" then 'get artist name sArtist = oFolder.GetDetailsOf(oItem, 20) If iDebug = 1 Then MsgBox oItem.name MsgBox sArtist End If 'if 'The Beatles' change to 'Beatles, the' If InStr(LCase(sArtist),"the") = 1 Then sArtist = Mid(sArtist,5) & ", the" End If 'remove \ from band name If InStr(sArtist,"\") > 0 Then sArtist = Replace(sAlbum,"\","") End If If InStr(sArtist,"/") > 0 Then sArtist = Replace(sAlbum,"/","") End If If iDebug = 1 Then MsgBox sArtist End If 'if folder does not exist create 'MsgBox sDestination & "\" & sArtist If oFSO.FolderExists(sDestination & "\" & sArtist) Then 'MsgBox "EXIST" sExist = sExist & sDestination & "\" & sArtist & " exists" & vbCrLf Else 'MsgBox "CREATE " & sDestination & "\" & sArtist rtn = oFSO.CreateFolder(sDestination & "\" & sArtist) sCreate = sCreate & sDestination & "\" & sArtist & " created" & vbCrLf End If 'get album name sAlbum = oFolder.GetDetailsOf(oItem, 14) 'remove special characters from album name If InStr(sAlbum,":") > 0 Then sAlbum = Replace(sAlbum,":","") End if If InStr(sAlbum,"?") > 0 Then sAlbum = Replace(sAlbum,"?","") End If If InStr(sAlbum,"...") > 0 Then sAlbum = Replace(sAlbum,"...","") End If If InStr(sAlbum,"/") > 0 Then sAlbum = Replace(sAlbum,"/","") End If If InStr(sAlbum,"\") > 0 Then sAlbum = Replace(sAlbum,"\","") End If 'create dir artist/album If oFSO.FolderExists (sDestination & "\" & sArtist & "\" & sAlbum) Then 'sExist = sExist & sDestination & "\" & sArtist & sAlbum & " exists" & vbCrLf Else 'MsgBox sDestination & "\" & sArtist & "\" & sAlbum rtn = oFSO.CreateFolder (sDestination & "\" & sArtist & "\" & sAlbum) 'sCreate = sCreate & sDestination & "\" & sArtist & " created" & vbCrLf End If 'move file sSource = strPath & "\" & oItem.name & ".mp3" sDest = sDestination & "\" & sArtist & "\" & sAlbum & "\" If iDebug=1 Then MsgBox sSource & vbCrLf & sDest End If If oFSO.FileExists (sSource) Then oFSO.MoveFile sSource, sDest 'sMoved = sMoved & sSource & " moved to " & sDest & vbcrlf 'MsgBox smoved Else MsgBox sSource & " not moved" End If End If If iDebug = 1 WScript.Sleep 1000 WScript.Echo i End If Next If iDebug=1 WScript.Echo i End if 'MsgBox sCreate 'MsgBox sExist 'MsgBox sMoved End If
