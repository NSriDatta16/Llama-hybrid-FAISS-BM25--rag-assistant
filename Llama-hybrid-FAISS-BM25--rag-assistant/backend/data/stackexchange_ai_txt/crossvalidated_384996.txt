[site]: crossvalidated
[post_id]: 384996
[parent_id]: 384446
[tags]: 
Path sampling is a way to evaluate the log integral by an unbiased estimator. Let us introduce a temperature index $0\le t\le 1$ and a sequence of conditional functions $p_t(x|z)$ such that $$p_0(x|z)=1\qquad\qquad\text{and}\qquad\qquad p_1(x|z)=p(x|z)$$ Then, if $$\mathfrak{Z}_t(x)=\int p_t(x|z)\,q(z)\text{d}z$$ \begin{align*}\frac{\text{d}}{\text{d}t} \log(\mathfrak{Z}_t(x)) &= \frac{1}{\mathfrak{Z}_t(x)}\frac{\text{d}}{\text{d}t}\mathfrak{Z}_t(x)\\ &=\frac{1}{\mathfrak{Z}_t(x)}\int\frac{\text{d}}{\text{d}t}p_t(x|z)\,q(z)\text{d}z\\ &=\frac{1}{\mathfrak{Z}_t(x)}\int\frac{\text{d}}{\text{d}t}p_t(x|z)\,q(z)\text{d}z\\ &=\frac{1}{\mathfrak{Z}_t(x)}\int\frac{\text{d}}{\text{d}t}\log(p_t(x|z))\,p_t(x|z)q(z)\text{d}z\\ &=\mathbb{E}\left[\left.\frac{\text{d}}{\text{d}t}\log(p_t(x|Z))\right| X=x\right]\end{align*} Therefore, since $$\log(\mathfrak{Z}_1(x)/\mathfrak{Z}_0(x)) = \int_0^1 \frac{\text{d}}{\text{d}t} \log(\mathfrak{Z}_t(x))\,\text{d}t$$ and $\mathfrak{Z}_0(x)=1$ , a remarkable identity is that $$\log(\mathfrak{Z}_1(x))=\log\left\{\int p(x|z) q(z)\text{d}z\right\}=\int_0^1 \mathbb{E}\left[\left.\frac{\text{d}}{\text{d}t}\log(p_t(x|Z))\right| X=x\right]\,\text{d}t$$ Hence, assuming simulations $z_i=\zeta(x,t,\epsilon_i)$ ( $i=1,\ldots,I$ ) from $$q(z|x)=\frac{q(z) p(x|z)}{\mathfrak{Z}_1(x))}$$ are available (e.g. by MCMC), an unbiased estimator of $\log(\mathfrak{Z}_1(x))$ is $$\int_0^1 \frac{1}{I}\sum_{i=1}^I\frac{\text{d}}{\text{d}t}\log(p_t(x|\zeta(x,t,\epsilon_i)))\,\text{d}t$$
