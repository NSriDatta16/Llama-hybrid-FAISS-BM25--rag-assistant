[site]: crossvalidated
[post_id]: 206853
[parent_id]: 
[tags]: 
Derive ditribution for $\mu | Y_1,...Y_h,\rho $ (Bayesian stats)

I am trying to understand the following paper ( http://www.ncbi.nlm.nih.gov/pubmed/20156954 ). Imagine we have H clinical trials with historical data on control group. $ Y_1, ... Y_h $ - are estimates of true parameters $Q_1,...,Q_h$ of control group response rate. $Q^*$ - is a control group response rate for the new trial. We would like to extract from the historical data information relevant to $Q^*$. I have the following info: \begin{align} Y_h |Q_h &\sim N(Q_h, s_h^2) \tag{1} \\ Q_1, Q_2, ...,Q_h, Q^*|\mu, \rho^2 &\sim N(\mu,\rho^2) \tag{2} \end{align} Given (1) and (2), the information about $\mu$ can be summarised by the posterior distribution or MLE. Using a locally uniform 'noninformative' prior for $\mu$, the posterior will be: $$\mu|Y_1, ..., Y_h, \rho \sim N(\frac{\sum(w_h Y_h)}{\sum(w_h)},\frac{1}{\sum(w_h)}) \tag{3}$$ where $w_h = \frac{1}{s_h^2+\rho}$. Also, the predictive distribution for $Q^*$ will be: $$Q^*|Y_1,...,Y_h,\rho \sim N(\frac{\sum(w_h Y_h)}{\sum(w_h)},\frac{1}{\sum(w_h)+\rho^2}) \tag{4}$$ I do not understand how formulae $(3)$ and $(4)$ were derived.
