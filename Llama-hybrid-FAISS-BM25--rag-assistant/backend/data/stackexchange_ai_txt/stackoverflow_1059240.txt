[site]: stackoverflow
[post_id]: 1059240
[parent_id]: 1053763
[tags]: 
I had to implement disk initialization, partitioning, and formatting for one of my company's products. I can't share the code but I can point you in the right direction. The API you want is called VDS - Virtual Disk Service . It's a COM API, but I've used it successfully from C++ (with ATL) and C# (COM interop). Sadly the documentation is quite lacking; you just have to immerse yourself in the object model, write some code, and gradually you get a feel for it. Windows Server 2008 ships with an undocumented but quite usable C# wrapper around VDS. Look for a DLL called Microsoft.Storage.Vds.dll. You can use Reflector to discover its various classes and methods. I found out about this when I read this blog post , in which the author is trying to initialize a disk from PowerShell using the aforementioned DLL. VDS includes APIs that could be implemented by SAN vendors to provision a LUN and do other SAN things; suggest you avoid those and focus on the basic software provider, which will create basic (as opposed to dynamic) partitions on either an MBR or GPT disk. Note that the Microsoft wrapper I mentioned is a bit light on GPT support; I had to modify it a bit to get GPT disks working. VDS is a complex and finicky API, but if you're just looking to initialize a disk, create a partition, format it, and mount it to a drive letter, most of what you need is there and fairly easy to do. Good luck.
