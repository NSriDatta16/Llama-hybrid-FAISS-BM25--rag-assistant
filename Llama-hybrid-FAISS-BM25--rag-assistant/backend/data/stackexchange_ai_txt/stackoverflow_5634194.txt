[site]: stackoverflow
[post_id]: 5634194
[parent_id]: 5633392
[tags]: 
You can use a permanent number table that has enough numbers for your need instead of the recursive cte. create table NumberTable(Num int primary key) You can use your recursive cte to populate the number table. Since it is just a one time thing the performance should not be that big deal and if it is you can have a look here . WITH q AS ( SELECT 0 AS num UNION ALL SELECT num + 1 FROM q ) insert into NumberTable(Num) select top 10000 num from q option (maxrecursion 0) Use the number table in your query with the offset. declare @n int = 200 declare @k int = 50000 SELECT top (@n) num+@k FROM NumberTable --where convert(bigint, num+k) not in (select ...
