[site]: stackoverflow
[post_id]: 2119899
[parent_id]: 2119117
[tags]: 
The kind of Windows API functions that can give you some insight in this are VirtualQueryEx() to enumerate the virtual memory sections and discover unused space, GetProcessHeaps() to find what heaps are created inside the process and HeapWalk() to discover how blocks in each heap are used. This is not going to be easy, particularly HeapWalk() is a troublesome function in a running program. You ought to take a look at the SysInternals' VMMap utility , it provides excellent virtual memory diagnostics. The downfall with this is that it doesn't really help you solve a memory fragmentation problem. There is nothing you can do to affect the way the Windows memory manager sub-allocates the virtual memory space. Short from not allocating memory. If you are struggling now with OOM, you really ought to consider re-architecting your app. Or switching to a 64-bit operating system, the two hundred dollar solution.
