[site]: crossvalidated
[post_id]: 517415
[parent_id]: 
[tags]: 
ARIMA with external regressors for district heating load time-series imputation

TL;DR ARIMA model does not work as expected. There is a load for district heating with some external regressors like temperature and wind speed. There is missing data which we like to impute. We work with the fable framework in R . > ts_heat_district # A tsibble: 70,176 x 7 [15m] datetime power_district temp wind radiation wm_1w wm_4w 1 2019-01-01 00:00:00 NA 8 8.18 0 6.71 5.02 2 2019-01-01 00:15:00 NA 8.02 8.26 0 6.72 5.02 3 2019-01-01 00:30:00 NA 8.05 8.34 0 6.72 5.02 4 2019-01-01 00:45:00 NA 8.07 8.43 0 6.73 5.02 5 2019-01-01 01:00:00 NA 8.1 8.51 0 6.73 5.03 6 2019-01-01 01:15:00 NA 8.1 8.58 0 6.73 5.03 7 2019-01-01 01:30:00 NA 8.1 8.66 0 6.74 5.03 8 2019-01-01 01:45:00 NA 8.1 8.73 0 6.74 5.03 9 2019-01-01 02:00:00 NA 8.1 8.8 0 6.75 5.04 10 2019-01-01 02:15:00 NA 8.07 8.97 0 6.75 5.04 # ... with 70,166 more rows I started with a simple linear regression model which works quite ok. The fourier term should capture the daily pattern. The yearly pattern is captured by temperature and weighted averages from the temperature (variable wm_1w and wm_4w ). fit_heat_district % model( lm = TSLM(power_district ~ temp + I(pmax(15-temp, 0)) + wind + radiation + wm_1w + wm_4w + fourier(period = "1 day", K = 24*4/2)), arima_fourier = ARIMA(power_district ~ PDQ(0, 0, 0) + temp + I(pmax(15-temp, 0)) + wind + radiation + wm_1w + wm_4w + fourier(period = "1 day", K = 12)), arima_seasonal = ARIMA(power_district ~ PDQ(0, 0, 0, period = 24*4) + temp + I(pmax(15-temp, 0)) + wind + radiation + wm_1w + wm_4w) ) The imputation looks like expected: fit_heat_district %>% select("lm") %>% fabletools::interpolate(ts_heat_district) %>% autoplot() + ggtitle("Linear model") The residuals from external regressors from the linear model seems ok: ts_heat_district %>% mutate(temp_15 = ifelse(temp > 15, 0, 15-temp)) %>% left_join(residuals(select(fit_heat_district, lm)), by = "datetime") %>% pivot_longer(temp:temp_15, names_to = "regressor", values_to = "x") %>% ggplot(aes(x = x, y = .resid)) + geom_point() + facet_wrap(. ~ regressor, scales = "free_x") + labs(y = "Residuals", x = "") There seems to be some autocorrelation left which should be captured by ARIMA. fit_heat_district %>% select(lm) %>% gg_tsresiduals() I tried a seasonal ARIMA model and a non-seasonal ARIMA model with a Fourier term because the period is relatively long (24*4=96). fit_heat_district % model( lm = TSLM(power_district ~ temp + I(pmax(15-temp, 0)) + wind + radiation + wm_1w + wm_4w + fourier(period = "1 day", K = 24*4/2)), arima_fourier = ARIMA(power_district ~ PDQ(0, 0, 0) + temp + I(pmax(15-temp, 0)) + wind + radiation + wm_1w + wm_4w + fourier(period = "1 day", K = 12)), arima_seasonal = ARIMA(power_district ~ PDQ(0, 0, 0, period = 24*4) + temp + I(pmax(15-temp, 0)) + wind + radiation + wm_1w + wm_4w) ) The interpolated data from the ARIMA models don't look as expected: fit_heat_district %>% select("arima_fourier") %>% fabletools::interpolate(ts_heat_district) %>% autoplot() + ggtitle("arima model with fourier") fit_heat_district %>% select("arima_seasonal") %>% fabletools::interpolate(ts_heat_district) %>% autoplot() + ggtitle("seasonal arima model") What is wrong with the ARIMA models? What am I missing? EDIT 2021-04-07 Some additional information: tried versions with box-cox transformation to stabilize variance (got lambda via Guerrero's method); at least both AIC and MAE for linear model improved slightly KPSS test: one time differencing is necessary for seasonal differencing p-value would be 0.0723 tried solutions from similiar posts on CV like setting D = 1 and period = 96 tried models without external regressors (keep it simple): ARIMA w/ fourier ARIMA(box_cox(heat_output, lambda = lambda) ~ pdq(0:5, 1, 0:5) + PDQ(0, 0, 0) + fourier(period = "1 day", K = 12)) Forecast and imputation values are still a straight line. ARIMA w/o fourier ARIMA(box_cox(heat_output, lambda = lambda) ~ pdq(0:5, 1, 0:5) + PDQ(0:2, 1, 0:2, period = 96)) Interpolation looks strange and model is very slow: I am wondering wether ARIMA is just not an appropriate method for this kind of time series. Any information is very welcome.
