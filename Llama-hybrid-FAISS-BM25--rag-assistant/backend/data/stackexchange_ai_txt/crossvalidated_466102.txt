[site]: crossvalidated
[post_id]: 466102
[parent_id]: 
[tags]: 
Tfp.sts unexpected wights prior behavior

I am trying to build a time series structural model and get the coefficients of the external factor. here is the structure of the model observed_time_series=ts, name='LLT' ) day_of_week = tfp.sts.Seasonal( num_seasons=7, num_steps_per_season=1, observed_time_series=ts, name='day_of_week', ) month_of_year = tfp.sts.Seasonal( num_seasons=12, num_steps_per_season=30, observed_time_series=ts, name='month_of_year', ) yearweek = tfp.sts.Seasonal( num_seasons=52, num_steps_per_season=7, observed_time_series=ts, name='yearweek', ) x_var = tfp.sts.LinearRegression( design_matrix=design_matrix_fb, weights_prior=tfd.Exponential(rate=2), name='external_factor') model_components_base = [ local_linear_trend, day_of_week, month_of_year, x_var ] model_base = tfp.sts.Sum( components=model_components_base, observed_time_series=ts ) then I am sampling and plotting the prior distribution using this function variational_posteriors = tfp.sts.build_factored_surrogate_posterior( model=direct_model_base, seed=42 ) q_prior_samples = variational_posteriors.sample(200) num_parameters = len(direct_model_base.parameters) fig, ax = plt.subplots(num_parameters, 1, figsize=(12, 21)) for i, param in enumerate(direct_model_base.parameters): param_mean = np.mean(q_prior_samples[param.name], axis=0) param_median = np.median(q_prior_samples[param.name], axis=0) param_std = np.std(q_prior_samples[param.name], axis=0) sns.distplot(a=q_prior_samples[param.name], rug=True, ax=ax[i]) ax[i].set(title=param.name) ax[i].axvline(x= param_median, linestyle='--', label='median') ax[i].axvline(x= param_mean, linestyle='--', label='mean') ax[i].axvline(x= param_mean + param_std, linestyle='--', label=r' $\mu \pm 2\sigma$ ') ax[i].axvline(x= param_mean - param_std, linestyle='--') ax[i].legend() plt.tight_layout(pad=3.0) plt.suptitle('PRIOR DISTRIBUTIONS', y=0.99); Even tho the weight_prior of the external factor is setted to an exponential distribution i get this plot for the external factor's weight normal dist with negative values ! Am I missing something or understanding something wrongly here Weights prior distribution result
