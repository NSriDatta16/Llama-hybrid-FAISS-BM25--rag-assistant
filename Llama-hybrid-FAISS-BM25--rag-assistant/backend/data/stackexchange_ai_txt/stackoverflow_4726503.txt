[site]: stackoverflow
[post_id]: 4726503
[parent_id]: 4725245
[tags]: 
Select U.name , user_inspections.inspection_date , Min( Case When user_inspections.area = 'Concrete' Then 'X' End ) As Concrete , Min( Case When user_inspections.area = 'Soils' Then 'X' End ) As Soils , Min( Case When user_inspections.area = 'Earthwork' Then 'X' End ) As Earthwork From users As U Join ( Select area, inspection_date, inspection_agent1 As user_id From inspections Union All Select area, inspection_date, inspection_agent2 As user_id From inspections Union All Select area, inspection_date, inspection_agent3 As user_id From inspections ) As user_inspections On user_inspections.user_id = U.id Group By U.name, user_inspections.inspection_date This is effectively a static crosstab. It means that you will need to know all areas that should be outputted in the query at design time. One of the reasons this query is problematic is that your schema is not normalized. Your inspection table should look like: Create Table inspections ( id int... , area varchar... , inspection_date date ... , inspection_agent int References Users ( Id ) ) That would avoid the inner Union All query to get the output you want.
