[site]: stackoverflow
[post_id]: 2594606
[parent_id]: 2594554
[tags]: 
In your callback the caplen member of the pkthdr variable (see struct pcap_pkthdr) contains the size of the captured packet. For example assume a packet is captured. The total length of the frame is 1024 bytes. However the capture driver only captured the first 128 bytes of the frame and made it available to your callback. In this case you should expect pkthdr->caplen to be 128 and header->len to be 1024.
