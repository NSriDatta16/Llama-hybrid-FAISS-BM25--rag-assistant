[site]: stackoverflow
[post_id]: 1053039
[parent_id]: 
[tags]: 
zend search lucene

I have a database that I would like to leverage with Zend_Search_Lucene . However, I am having difficulty creating a "fully searchable" document for Lucene. Each Zend_Search_Lucene document pulls information from two relational database tables ( Table_One and Table_Two ). Table_One has basic information ( id , owner_id , title , description , location , etc.), Table_Two has a 1:N relationship to Table_One (meaning, for each entry in Table_One , there could be one or more entries in Table_Two ). Table_Two contains: id, listing_id , bedrooms , bathrooms , price_min , price_max , date_available . See Figure 1. Figure 1 Table_One id (Primary Key) owner_id title description location etc... Table_Two id (Primary Key) listing_id (Foreign Key to Table_One) bedrooms (int) bathrooms (int) price_min (int) price_max (int) date_available (datetime) The problem is, there are multiple Table_Two entries for each Table_One entry. [Question 1] How to create a Zend_Search_Lucene document where each field is unique? (See Figure 2) Figure 2 Lucene Document id:Keyword owner_id:Keyword title:UnStored description:UnStored location: UnStored date_registered:Keyword ... (other Table_One information) bedrooms: UnStored bathrooms: UnStored price_min: UnStored price_max: UnStored date_available: Keyword bedrooms_1: Next, I need to be able to do a Range Query on the bedrooms , bathrooms , price_min and price_max fields. (Example: finding documents that have between 1 and 3 bedrooms) Zend_Search_Lucene will only allow ranged searches on the same field. From my understanding, this means each field I want to do a ranged query on can only contain one value (example: bedrooms:"1 bedroom"); What I have now, within the Lucene Document is the bedrooms , bathrooms , price_min , price_max , date_available fields being space delimited. Example: Sample Table_One Entry: | 5 | 2 | "Sample Title" | "Sample Description" | "Sample Location" | 2008-01-12 Sample Table_Two Entries: | 10 | 5 | 3 | 1 | 900 | 1000 | 2009-10-01 | 11 | 5 | 2 | 1 | 800 | 850 | 2009-08-11 | 12 | 5 | 1 | 1 | 650 | 650 | 2009-09-15 Sample Lucene Document id:5 owner_id:2 title: "Sample Title" description: "Sample Description" location: "Sample Location" date_registered: [datetime stamp YYYY-MM-DD] bedrooms: "3 bedroom 2 bedroom 1 bedroom" bathrooms: "1 bathroom 1 bathroom 1 bathroom" price_min: "900 800 650" price_max: "1000 850 650" date_available: "2009-10-01 2009-08-11 2009-09-15" [Question 2] Can you do a Range Query search on the bedroom , bathroom , price_min , price_max , date_available fields as they are shown above or does each range query field have to contain only one value (e.g. "1 bedroom")? I have not been able to get the Range Query to work in its current form. I am at a lose here. Thanks in advance.
