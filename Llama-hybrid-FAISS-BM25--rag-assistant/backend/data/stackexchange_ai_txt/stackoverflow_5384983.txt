[site]: stackoverflow
[post_id]: 5384983
[parent_id]: 
[tags]: 
Generate Time Segment Labels, Smallest Timespan to Increment DateTime Format

I came up with what I thought was a good question: How do I get every label between two DateTimes for a specified Date Format. Wondered if anyone had a more elegant solution than what I came up with. (Other than knowing the format at compile time) Or any ways to optimize this. I'm using this to generate a graph where not all time segments have a value (so .GroupBy(date => date.ToString(dateFormat)) results in skipping any time period that has zero elements) For example: Output every label between 2011/01/01 and 2011/03/21 with the date format "yyyyMM" GetTimeSegmentLables(new DateTime(2011,1,1), new DateTime(2011,3,21), "yyyyMM").Dump(); This should also supports a format such as "yyyy MM 'Month' dddd\\'\\s" This is What I came up with: public static List GetTimeSegmentLabels(DateTime startDate, DateTime endDate, string dateFormat) { DateTime incrementedDate = startDate; TimeSpan increment = GetSmallestUnitInDateFormat(dateFormat); int estimatedCount = (int)((endDate - startDate).TotalMilliseconds / increment.TotalMilliseconds + 1); List Formats = new List (estimatedCount); string LastFormat = ""; while (incrementedDate
