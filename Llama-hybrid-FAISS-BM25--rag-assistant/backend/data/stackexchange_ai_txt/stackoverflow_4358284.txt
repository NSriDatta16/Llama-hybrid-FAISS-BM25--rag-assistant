[site]: stackoverflow
[post_id]: 4358284
[parent_id]: 
[tags]: 
libpcap: how to get active network interface (Mac OSX)

I am using libpcap to sniff traffic. I would like to do it on the currently active network device (e.g. one that has an assigned IP address, etc). What's the best way to do this? I'm assuming I would have to do the following: pcap_findalldevs(&alldevs, errbuf) to get all the network devices, then loop through and check which one is currently active. Edit: The following function (pcap_lookupnet(dev, &net, &mask, errbuf) returns the network address and subnet mask for a network device. I ran some tests with the different ethernet adapters on my computer and it returns -1 when I call it on an adapter that is not connected to a network. Would this be the bulletproof way to get an active interface? Are there any edge cases it would miss?
