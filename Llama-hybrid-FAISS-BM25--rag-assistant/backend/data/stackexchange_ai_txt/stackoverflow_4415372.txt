[site]: stackoverflow
[post_id]: 4415372
[parent_id]: 4415350
[tags]: 
If all you need is the module name, the simplest way is to use EnumProcessModules to get a list of all the loaded the modules, then use GetModuleInformation on each of them. One of the things that GetModuleInformation returns is the base address where that module is loaded. Technically, the integer value of the HMODULE itself is the same as the base address, but that seems a little fragile to me... Then it's simply a matter of finding the module with a base address just below the thread's current (or start) address. Oh, and to get the actual name of the module, there's GetModuleBaseName .
