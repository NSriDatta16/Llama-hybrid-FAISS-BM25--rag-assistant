[site]: stackoverflow
[post_id]: 4829738
[parent_id]: 
[tags]: 
Speed up a program that calculate the average of the neighbors in a huge array

I have a problem with the speed of my program. I want to calculate the average of four neighbors in a huge array. Here is a part of my code. Do you have any ideas how to change the last line? Or should I use another array? for a in np.arange(100000): for x in np.arange(size): for y in np.arange(size): if unchangeableflag[x*size+y] == 0: vnew[x*size+y] = (v[(x+1)*size+y] + v[(x-1)*size+y] + v[x*size+y+1] + v[x*size+y-1]) / 4.0
