[site]: crossvalidated
[post_id]: 618183
[parent_id]: 
[tags]: 
How to restrict the covariance between all interaction dummies to 0 in a linear-mixed effects model with crossed random effects?

I have a question regarding crossed random effects. Thank you for any suggestions in advance. In Chapter 13 ("Imperfect Hierarchies") of SNIJDERS and BOSKER's book, "Multilevel Analysis: An Introduction To Basic And Advanced Multilevel Modeling" (2nd edition), the authors gave an example on crossed random effects. As the dataset used for the example in the book is not publicly avaiable, the authors used another data set from Rabe-Hesketh and Skrondal (2008) Multilevel and Longitudinal Modeling Using Stata, Second Edition. Data is available online http://www.stata-press.com/data/mlmus2/fife.dta /*The dependent var is attainment score at age 16 for pupils that attended various combinations of primary and secondary schools. pid - primary school identifier sid - secondary school identifier vrq - verbal reasoning score sex - sex */ We need to center the variable "vrs" via (R code) c_vrq In order to investigate the association between attain and a couple of predictors, the authors in the supplementary materials (using Stata code): . *Let's try to include a random slope (c_vrq) on both levels. . *It's a bit complicated. For primary schools, we just include it after pid: . . * But for the secondary school level, we have to generate interaction terms of c_vrq and all secondary schools. Create dummies for each secondary school: tab sid, gen(id_sid) sid | Freq. Percent Cum. 1 | 219 6.38 6.38 2 | 199 5.79 12.17 3 | 156 4.54 16.71 4 | 139 4.05 20.76 5 | 175 5.09 25.85 6 | 250 7.28 33.13 7 | 109 3.17 36.30 8 | 107 3.11 39.42 9 | 114 3.32 42.74 10 | 92 2.68 45.41 11 | 234 6.81 52.23 12 | 253 7.37 59.59 13 | 216 6.29 65.88 14 | 290 8.44 74.32 15 | 147 4.28 78.60 16 | 134 3.90 82.50 17 | 233 6.78 89.29 18 | 257 7.48 96.77 19 | 111 3.23 100.00 Total | 3,435 100.00 unab idvar: id_sid* foreach v of local idvar{ 2. gen inter`v' = c_vrq*`v' 3. } *Now we can include a random slope on both levels *We restrict the covariance between all interaction dummies to 0 . *We also could specify random slopes for different variables on each level. xtmixed attain c_vrq sex || _all: R.sid || /// > _all:inter*, cov(identity) nocons || pid: c_vrq, var mle I am wondering how to restrict the covariance between all interaction dummies to 0 . Here is the 3 sets of R code I wrote: a0$inter (m4 (m4 (m4 However, none of the 3 gave the same output as the one the authors generated. Here is the output from using the authors' Stata code: Performing EM optimization: Performing gradient-based optimization: Iteration 0: log likelihood = -7424.774 Iteration 1: log likelihood = -7421.3878 Iteration 2: log likelihood = -7421.3786 Iteration 3: log likelihood = -7421.3786 Computing standard errors: Mixed-effects ML regression Number of obs = 3435 | No. of Observations per Group Group Variable | Groups Minimum Average Maximum _all | 1 3435 3435.0 3435 pid | 148 1 23.2 72 Wald chi2(2) = 2902.56 Log likelihood = -7421.3786 Prob > chi2 = 0.0000 attain | Coef. Std. Err. z P>|z| [95% Conf. Interval] c_vrq | .1597335 .0029859 53.50 0.000 .1538813 .1655856 sex | .1151836 .0714303 1.61 0.107 -.0248171 .2551843 _cons | 5.569957 .07478 74.48 0.000 5.423391 5.716523 Random-effects Parameters | Estimate Std. Err. [95% Conf. Interval] _all: Identity | var(R.sid) | .0124141 .0230308 .0003272 .4710613 _all: Identity | var(inter~d1..inter~19)(1) | .000021 .0000514 1.73e-07 .0025454 pid: Independent | var(c_vrq) | 1.68e-18 1.17e-15 0 var(_cons) | .2750255 .0614916 .1774422 .4262742 var(Residual) | 4.245761 .1051668 4.044561 4.456969 (1) interid_sid1 interid_sid2 interid_sid3 interid_sid4 interid_sid5 interid_sid6 interid_sid7 interid_sid8 interid_sid9 interid_sid10 interid_sid11 interid_sid12 interid_sid13 interid_sid14 interid_sid15 interid_sid16 interid_sid17 interid_sid18 interid_sid19 Here is the link to the Stata code the authors used: https://www.stats.ox.ac.uk/~snijders/chap13.do
