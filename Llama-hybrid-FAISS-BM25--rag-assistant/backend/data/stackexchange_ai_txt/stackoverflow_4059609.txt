[site]: stackoverflow
[post_id]: 4059609
[parent_id]: 4059173
[tags]: 
For the Average you can do without arrays: =AVERAGEIFS(D2:D$1000,A2:A$1000,A2,B2:B$1000,B2,C2:C$1000," As there is also a COUNTIFS and a SUMIFS, I think your slopes could be calculated the same way. For the rest of the functions (max, min, etc), we should analyze case by case. I did a slight performance test, and this is apparently better, but of course my datasets are just mocked. HTH! Note: Excel 2007 and up only! Edit - Answering your comment. Without knowing the dimensions of the problem is difficult to give advice, but I'll risk one anyway: You could write a VBA function that: 1) Generates a new sheet for each company-generation pair 2) Sorts the data in those sheets by date 3) Adds the formulas to those sheets (no conditionals needed in this context) 4) Recalculates and Gets the results from those formulas and populates the original sheet 5) Deletes the auxiliary sheets
