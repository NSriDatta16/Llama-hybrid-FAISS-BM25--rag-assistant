[site]: stackoverflow
[post_id]: 3141442
[parent_id]: 3141384
[tags]: 
This loop: expect { "*yes/no*" { send "yes\r" ; exp_continue } "*assword:" { send "${password}\r" ; exp_continue } } Can't terminate any way except timeout or EOF; the two matching lines will exp_continue , so do round the loop again. Going into the background means basically forking; the parent dies, and the child continues the connection. Personally, I'd solve the interactive elements differently: Host keys: Either connect once manually, or insert the key directly in the ssh known_hosts file. Password: I'd use private/public key authentication. Either use an agent to store the key, or have a password-less key.
