[site]: crossvalidated
[post_id]: 60563
[parent_id]: 60557
[tags]: 
Trying a moving average filter was a good first attempt, and it's probably what I would have tried first. It looks to me like you could do some simple thresholding and either set the threshold relatively high and "fill in" the gaps created when the signal gets too low, or set the threshold low ignore it when the signal only goes over the threshold briefly. You may want to look up binary image operations for inspiration. Instead of the moving average filter, you could try are: Gaussian filter Median Filter (I think you will have good luck with this) IIR low pass filter
