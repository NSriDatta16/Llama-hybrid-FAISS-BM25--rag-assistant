[site]: stackoverflow
[post_id]: 733206
[parent_id]: 
[tags]: 
Find which drive corresponds to which USB mass storage device in WinXP

I have several USB drives connected to a WinXP SP3 computer, and I need to tell them apart programatically - I need to find which drive letter corresponds to which device (in this case, one device ~ one volume). I can get their Volume IDs and drive letters using mountvol , looking something like this: C:\WINDOWS\> mountvol \\?\Volume{bdb681b2-1ddf-11dd-bf71-806d6172696f}\ C:\ \\?\Volume{6a8784f8-7406-11dd-a8c3-001e8c829b67}\ A:\ Also, using devcon or the Device Manager, I can see the device IDs: C:\WINDOWS\> devcon resources *STOR* STORAGE\REMOVABLEMEDIA\7&190C24E5&0&RM Name: Generic volume STORAGE\VOLUME\1&30A96598&0&SIGNATURED84ED84EOFFSET7E00LENGTH2543150400 Name: Generic volume USBSTOR\DISK&VEN_KINGSTON&PROD_DATATRAVELER2.0&REV_1.00\0803240752536&0 Name: Kingston DataTraveler2.0 USB Device However, I haven't found a way to link the device ID and the volume ID/letter, like the "Safely remove hardware" dialog does (therefore I assume it's possible): (source: piskvor.org ) As you may see, these are the same devices that I see in devcon and the same volume that mountvol sees; but so far I haven't found the link between them. I've found some related questions , but those seem to use the approach "whatever you find first is your USB device", which is not very useful in my case, since there will be several similar devices (same vendor, often same product type) connected. Edit: @MSalters ' answer looks promising: On XP, HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices has REG_BINARY values \DosDevices\x: (where x is [A-Z]); the comment is (UTF-16) name of the correct device (e.g. \DosDevices\A: = " \??\STORAGE#RemovableMedia#7&190c24e5&0&RM#{53f5630d-b6bf-11d0-94f2-00a0c91efb8b}\" , which corresponds to STORAGE\REMOVABLEMEDIA\7&190C24E5&0&RM seen above in the device list). Will see if that's the way to go.
