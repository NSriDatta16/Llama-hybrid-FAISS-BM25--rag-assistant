[site]: stackoverflow
[post_id]: 3500473
[parent_id]: 3495892
[tags]: 
EDIT : %# load the signal [y, fs, nb] = wavread('Three.wav'); y = mean(y,2); %# stereo, take avrg of 2 channels %# Calculate frame energy fWidth = round(fs*10e-3); %# 10ms numFrames = floor(length(y)/fWidth); energy = zeros(1,numFrames); for f=1:numFrames energy(f) = sum( y((f-1)*fWidth+1:f*fWidth).^2 ); end %# smooth the signal (moving average with window size = 1% * length of data) WINDOW_SIZE = round(length(energy) * 0.01); %# 200 XX = filtfilt(ones(1,WINDOW_SIZE)/WINDOW_SIZE, 1, energy); %# auto-correlation [r,lags] = xcorr(XX, 'biased'); %# find extrema points dr = diff(r); eIdx = find(dr(1:end-1) .* dr(2:end) and the lag values corresponding to the marked peaks: >> lags( eIdx(loc) ) ans = 0 -6316 6316 Note that we smoothed the signal prior to computing the derivative of the autocorrelation function in order to find the extrema points
