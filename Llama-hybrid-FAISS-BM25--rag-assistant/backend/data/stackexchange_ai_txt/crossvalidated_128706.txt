[site]: crossvalidated
[post_id]: 128706
[parent_id]: 125908
[tags]: 
This kind of problem was studied in the paper "Data Augmentation in Multi-way Contingency Tables With Fixed Marginal Totals" by Dobra et al (2006). Let $\theta$ denote the parameters of the model, let $\mathbf{n}$ denote the unobserved integer table of counts for each $(x,y)$ pair, and let $C(S,T)$ be the set of integer tables whose marginal counts equal $(S,T)$. Then the probability of observing the marginal counts $(S,T)$ is: $$ p(S,T | \theta) = \sum_{\mathbf{n} \in C(S,T)} p(\mathbf{n} | \theta) $$ where $p(\mathbf{n} | \theta)$ is the multinomial sampling distribution. This defines the likelihood function for ML, but direct evaluation is infeasible except for small problems. The approach they recommend is MCMC, where you alternately update $\mathbf{n}$ and $\theta$ by sampling from a proposal distribution and accepting the change according to the Metropolis-Hastings acceptance ratio. This could be adapted to find an approximate maximum over $\theta$ using Monte Carlo EM. A different approach would use variational methods to approximate the sum over $\mathbf{n}$. The marginal constraints can be encoded as a factor graph and inference over $\theta$ could be carried out using Expectation Propagation. To see why this problem is difficult and does not admit a trivial solution, consider the case $S=(1,2), T=(2,1)$. Taking $S$ as the row sums and $T$ as the column sums, there are two possible tables of counts: $$ \begin{bmatrix} 0 & 1 \\ 2 & 0 \end{bmatrix} \qquad \begin{bmatrix} 1 & 0 \\ 1 & 1 \end{bmatrix} $$ Therefore the likelihood function is $$ p(S,T|\theta) = 3 p_{12} p_{21}^2 + 6 p_{11} p_{21} p_{22} $$ The MLE for this problem is $$ \hat{p}_{x,y} = \begin{bmatrix} 0 & 1/3 \\ 2/3 & 0 \end{bmatrix} $$ which corresponds to assuming the table on the left. By contrast, the estimate that you would get by assuming independence is $$ q_{x,y} = \begin{bmatrix} 1/3 \\ 2/3 \end{bmatrix} \begin{bmatrix} 2/3 & 1/3 \end{bmatrix} = \begin{bmatrix} 2/9 & 1/9 \\ 4/9 & 2/9 \end{bmatrix} $$ which has a smaller likelihood value.
