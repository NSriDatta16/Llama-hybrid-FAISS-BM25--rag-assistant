[site]: stackoverflow
[post_id]: 4412062
[parent_id]: 
[tags]: 
SSRS - How can I determine which column is being accessed in a matrix control?

Here's the situation. The details cell of my matrix calls a custom function that determines an average of the values passed in. Those are converted to a percentage and returned by the Code.Function(). The matrix also has a subtotal column that averages out the columns as expected. Everything works great. However, the requirements changed and the matrix was converted to a hierarchy with summary 'roll-ups' if you will. Now, when you collapse the rows, the data being averaged is still correct on the detail level. However, the same logic will no longer suffice for the subtotal column. Ideally, I would like to be able to determine in the function which column is currently be referenced and perform a different calculation based on that parameter. While there is a lot of talk about scope, which is the primary issue, I have no way to pass a string scope value into the function. So the questions are: Can you determine which column you are currently in at runtime? Can you determine and pass the scope name you are in around in the report somehow? (passing a bool around doesn't help) Any suggestions would be appreciated. Thanks!!
