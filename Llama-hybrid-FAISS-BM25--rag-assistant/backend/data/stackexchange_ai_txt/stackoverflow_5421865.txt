[site]: stackoverflow
[post_id]: 5421865
[parent_id]: 5420302
[tags]: 
Things seem to work with DotNetZip: // http://stackoverflow.com/questions/4717605/asp-net-vb-kml-generator [AcceptVerbs(HttpVerbs.Get)] public void GetKMZ() { Response.AppendHeader("Connection", "close"); Response.ContentType = "application/vnd.google-earth.kmz"; Response.Cache.SetCacheability(System.Web.HttpCacheability.NoCache); ZipOutputStream outzip = new ZipOutputStream(Response.OutputStream); outzip.EnableZip64 = Zip64Option.Never; outzip.CompressionLevel = Ionic.Zlib.CompressionLevel.BestCompression; outzip.PutNextEntry("doc.kml"); XmlTextWriter xmlTW = new XmlTextWriter(outzip,Encoding.UTF8); xmlTW.Formatting = Formatting.Indented; xmlTW.WriteStartDocument(); xmlTW.WriteStartElement("kml"); xmlTW.WriteAttributeString("xmlns", "http://www.opengis.net/kml/2.2"); xmlTW.WriteStartElement("Document"); xmlTW.WriteStartElement("Style"); xmlTW.WriteAttributeString("id", "s1"); xmlTW.WriteStartElement("LineStyle"); xmlTW.WriteElementString("color", "7f0000ff"); xmlTW.WriteElementString("width", "3"); xmlTW.WriteEndElement(); xmlTW.WriteEndElement(); xmlTW.WriteElementString("name", "Chicago Transit Map"); xmlTW.WriteElementString("description", "Chicago Transit Authority train lines"); xmlTW.WriteStartElement("Placemark"); xmlTW.WriteElementString("styleUrl", "#s1"); xmlTW.WriteElementString("name", "Chicago Transit Map"); xmlTW.WriteStartElement("LineString"); xmlTW.WriteElementString("altitudeMode", "relative"); xmlTW.WriteElementString("coordinates", "-87.89289951324463,41.97881025520548,0 -87.89184808731079,41.97788506340239,0 -87.89150476455688,41.97762983571196,0"); xmlTW.WriteEndElement(); xmlTW.WriteEndElement(); xmlTW.WriteEndElement(); xmlTW.WriteEndElement(); //Document xmlTW.WriteEndDocument(); // kml xmlTW.Flush(); outzip.Close(); }
