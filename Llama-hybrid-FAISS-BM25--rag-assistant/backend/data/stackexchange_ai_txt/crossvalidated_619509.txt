[site]: crossvalidated
[post_id]: 619509
[parent_id]: 
[tags]: 
Finding subgroups in population, using individual effects of hierarchical model

I want to know how to look for effects both at a population level, and at an individual level in an experiment. I was wondering if I can do this with hierarchical Bayesian models as follows. In a simplified problem, I measure from a population of individuals across 2 conditions. I also do repeated measurements in both conditions. My dataset looks something like this: Subject Trial Condition Response 0 1 0 23.402547 0 2 0 23.540197 0 3 0 24.775906 0 4 0 23.671897 0 5 0 18.848266 ... ... ... ... 59 46 1 19.423985 59 47 1 18.978680 59 48 1 18.665743 59 49 1 19.865276 59 50 1 18.536674 We believe some things about the data: There is a difference in responses across the two conditions There is between-individual heterogeneity in effect magnitude. Many individuals will have ~0 effect, some will have positive effect, and some negative (the ratio of positive/negative will likely be different to 1). The effect is small relative to individual variability. It should be noticeable at a population level, but it will be noisy at an individual level. For my analysis, I would be interested in doing two things: A) Quantify the effect at a population level (both the average response effect, but also something that takes into account absolute effect across individuals, ignoring sign of effect). B) Characterize the distribution of individual-level effects (I.e. identify and estimate the prevalence of individuals unaffected, positive effect, and negative effect). If possible, I would like to label each individual as showing an effect or not. The ultimate goal is to compare the effect across populations, to see how population effect changes, and how this is driven by changes in the 3 subgroups. The first approach I thought for this is to fit a hierarchical Bayesian model to the data (I use Stan), where I have a distribution $D$ of effect of the manipulation on individuals $\beta_{i} \sim D(\hat{\beta}, \sigma)$ , where $\beta_{i}$ is the effect on individual $i$ , and $\hat{\beta}$ and $\sigma$ the parameters of the distribution (e.g. describing mean and spread). This would give a posterior distribution on each individual's effect $\beta_{i}$ , besides the average effect of the population and the spread. Then, to characterize the distribution of responses I could look at the individual $\beta_{i}$ 's posteriors, classifying each individual $i$ as showing an effect or not (and its sign) by looking at whether 97.5% of the samples are > or However, this approach seems a bit crude, and I have 2 main doubts at the moment. First, I would like to know if there's some way in which I can automatically assign the individuals to these 3 types within Stan. I imagine for example using a mixture distribution with negative, 0 and positive effects, and letting Stan assign the probability for each individual to belong to each. The second, question is how one should think about multiple comparisons in this context. I tried this approach in a simulation, and at least with the parameters I tried, the approach above didn't seem to many false positives, but rather the opposite. Is testing for a 'significant effect' across multiple individuals using the approach above already accounting for multiple comparisons, since it's a hierarchical model? Any other ideas are welcome.
