[site]: stackoverflow
[post_id]: 2665399
[parent_id]: 2661469
[tags]: 
Here is an alternative to RRUZ's example: program SendMailWithCalendarRequest; {$APPTYPE CONSOLE} uses IdSMTP, Classes, DateUtils, IdMessage, SysUtils; procedure SendCalendarRequest; var SMTP : TIdSMTP; MailMessage : TIdMessage; begin SMTP:= TIdSMTP.Create(nil); MailMessage := TIdMessage.Create(nil); try SMTP.Host := 'smtp.mailserver.com'; SMTP.Port := 25; SMTP.Username := 'the account'; SMTP.Password := 'the password'; SMTP.AuthType := satDefault; MailMessage.From.Address := 'mail@server.com'; MailMessage.Recipients.EMailAddresses := 'the Recipient'; MailMessage.Subject := 'Send calendar'; MailMessage.Body.Add('BEGIN:VCALENDAR'); MailMessage.Body.Add('VERSION:1.0'); MailMessage.Body.Add('BEGIN:VEVENT'); MailMessage.Body.Add('ORGANIZER:MAILTO:'+SenderMail); MailMessage.Body.Add('DTStart:'+FormatDateTime('YYYY-DD-DD',Now)); MailMessage.Body.Add('DTEnd:'+FormatDateTime('YYYY-DD-DD', Tomorrow)); MailMessage.Body.Add('Location;ENCODING=QUOTED-PRINTABLE: My home'); MailMessage.Body.Add('UID:'+FormatDateTime('YYYY-DD-DD',Now)+FormatDateTime('YYYY-DD-DD', Tomorrow)); MailMessage.Body.Add('SUMMARY:Appointment Reminder'); MailMessage.Body.Add('DESCRIPTION:Test message'); MailMessage.Body.Add('PRIORITY:5'); MailMessage.Body.Add('END:VEVENT'); MailMessage.Body.Add('END:VCALENDAR'); MailMessage.ContentType := 'text/calendar'; SMTP.Connect; try try SMTP.Send(MailMessage) ; Writeln('OK') except on E:Exception do Writeln(0, 'ERROR: ' + E.Message) ; end; finally SMTP.Disconnect; end; finally SMTP.Free; MailMessage.Free; end; end; begin try SendCalendarRequest; readln; except on E: Exception do Writeln(E.ClassName, ': ', E.Message); end; end.
