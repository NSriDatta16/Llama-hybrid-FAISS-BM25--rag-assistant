[site]: stackoverflow
[post_id]: 4526576
[parent_id]: 
[tags]: 
How do i capture MAC address of Access points and hosts connected to it?

I know that i have to use the libpcap library to capture IEEE 802.11 frames to show their MAC addresses,for example my wireless adapter is in monitor mode, and only supports "802.11 plus radiotap radio header" when i do a pcap_datalink. In the callback function of pcap_loop what should i do to extract the MAC addresses from the packets? How i differentiate between different types of packets? Googling around doesn't me much answers,mostly on how to extract packets from wired interfaces. void procPacket(u_char *arg, const struct pcap_pkthdr *pkthdr, const u_char *packet) { //what should i do here? } pcap_t *handler=pcap_open_live ("wlan0", BUFSIZ,1,-1,errbuff); if(pcap_datalink(handler) == DLT_IEEE802_11_RADIO) { pcap_loop(handler, -1 ,procPacket, NULL ); }
