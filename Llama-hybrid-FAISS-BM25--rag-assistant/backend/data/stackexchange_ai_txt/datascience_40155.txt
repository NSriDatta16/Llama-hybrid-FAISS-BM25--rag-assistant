[site]: datascience
[post_id]: 40155
[parent_id]: 
[tags]: 
Tuning neural network loss function for space physics

I am trying to work on neural network classification (with python, Keras) for space physics purposes, where I want to identify specific planetary regions based on multivariate temporal data and multi class classification. Given my objectives, I would like to use a loss function that minimizes such a parameter: absolute_difference_between_predicted_and_real_class * temporal_distance_to_closest_real_class_change More precisely: I have 3 classes corresponding to specific regions around planets, i.e. close planetary environment (class 1), shock (a physical thin boundary at the limit of inner environment; class 2), solar wind (particle flow due to the Sun; class 3). With classic algorithms I have 2 issues: I get predicted class variations that are physically impossible such as class 3 $\rightarrow$ class 1 or vice-versa, and predicted classes too different from real ones (3 instead of 1 or vice-versa, while 2 instead of 1 or 3 is less problematic for me) ; hence I would like to introduce the absolute_difference_between_predicted_and_real_class in the loss function I have significant uncertainties on the exact time of class changes (3 $\rightarrow$ 2, 2 $\rightarrow$ 1 or vice-versa), so that a wrong predicted class transition may not be a problem if not too far from the "real" (but actually always uncertain) transition; hence I would like to introduce the temporal_distance_to_closest_real_class_change in the loss function I know I could use post-treatment but I would prefer, if possible, to introduce these constraints directly inside the loss function. In principle I could write a loss function doing that but I don't know how to cope with the constraints of derivability and others needed for the loss function. I also read a bit on ordinal classification, that would correspond to my issue #1, but not sure not adapted to issue #2. For issue #2 I heard about time warping techniques, but not sure to understand to use that in my case. Overall I'm a bit lost! Any idea or advice?
