[site]: stackoverflow
[post_id]: 1043393
[parent_id]: 1043127
[tags]: 
First, I'm going to be mean and provide a anti-answer: A test case for you that is a bugger to code against. What happens if I have the terms: Web Browser Browser History And I run it against the phrase: Now, clean the web browser history by ... Do you get Now, clean the web browser history by ... I've recently been wrestling with the same problem, but I don't think my solution would help you - http://github.com/jarofgreen/TaggedWiki/blob/d002997444c35cafecd85316280a896484a06511/taggedwikitest/taggedwiki/views.py line 47 onwards. I ended up putting a marker infront of the tag and not wrapping the text. However I may have one part of the answer for you: in order to avoid catching words in the HTML ( the problem of what happens if you have a tag of "title" you identified in your last paragraph ) I did 2 passes. In the first searching pass I stored the location of the phrases to wrap, then in my second non-searching pass I put in the actual HTML. This way, there is no HTML in the text while you are doing your actual searching.
