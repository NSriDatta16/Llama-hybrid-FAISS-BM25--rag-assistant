[site]: stackoverflow
[post_id]: 1624936
[parent_id]: 1611760
[tags]: 
Since you put only a fragment of your code I'm not sure whether you put both statements. There should be 2 calls: objWorkbook2.Save objWorkbook2.Close You can also use the following code isolated in a function. Origin: http://automation-beyond.com/2009/05/25/excel-vbscript/ Public Function ExcelWorksheetCompare(ByVal sWorkbook1, ByVal sWorksheet1, ByVal sWorkbook2, ByVal sWorksheet2, ByVal objParameter) Dim boolRC, boolSheetExists Dim FSO, XLHandle Dim XLBook1, XLBook2, XLSheet1, XLSheet2 Dim Iter, objCell ‘Verify both files exist Set FSO = CreateObject(”Scripting.FileSystemObject”) boolRC = FSO.FileExists(sWorkbook1) If Not boolRC Then ExcelWorksheetCompare = FALSE Exit Function End If boolRC = FSO.FileExists(sWorkbook2) If Not boolRC Then ExcelWorksheetCompare = FALSE Exit Function End If Set FSO = Nothing Set XLHandle = CreateObject(”Excel.Application”) XLHandle.DisplayAlerts = False ‘Open workbook1 Set XLBook1 = XLHandle.WorkBooks.Open(sWorkbook1) ‘Verify sheet exists (1) If isNumeric(sWorksheet1) Then sWorksheet1 = CInt(sWorksheet1) If (sWorksheet1 > 0) AND (sWorksheet1 0) AND (sWorksheet2 XLSheet1.Range(objCell.Address).Value Then objCell.Interior.ColorIndex = 3 Else objCell.Interior.ColorIndex = 0 End If Next ‘Save and close XLBook1.Close XLBook2.Save XLBook2.Close XLHandle.Quit Set XLSheet1 = Nothing Set XLSheet2 = Nothing Set XLBook1 = Nothing Set XLBook2 = Nothing Set XLHandle = Nothing ExcelWorksheetCompare = TRUE End Function Thank you, Albert Gareev http://automation-beyond.com/
