[site]: crossvalidated
[post_id]: 643408
[parent_id]: 
[tags]: 
Long-run variance for an AR(1), with simulation

For a stationary (and absolutely summable), mean-zero (just to make this easier) time series $y_t$ , with $\gamma_j=\mathrm{Cov}(y_t,y_{t-j})$ , the long-run variance $$\mathcal{J}=\sum_{j=-\infty}^{\infty}\gamma_j,$$ and it can be shown that $$ \sqrt{T} \bar{y}_T \rightarrow \mathcal{N}(0,\mathcal{J}).$$ For a stationary AR(1) $y_t = \phi y_{t-1} + \varepsilon_t$ , with $\varepsilon_t \sim \mathcal{WN}(0,\sigma^2)$ , $$\mathrm{Var}(y_t)=\gamma_0=\frac{\sigma^2}{1-\phi^2}$$ and $$\gamma_j = \phi^j\gamma_0$$ and $$\mathcal{J}=\frac{\sigma^2}{(1-\phi)^2}$$ Everything I said so far should be true and can be verified or found discussed in: Limit Theorems, OLS, and HAC Hayashi (2000). Econometrics , p. 403 Can long run variance of a time series be used to test mean of the series? What is the long run variance? Long-run variance of ARMA(p,q) I'd like to check this via a simple simulation below. I consider an AR(1) with $\phi=0.9$ and $\sigma^2=1$ so that $\mathrm{Var}(y_t)=\gamma_0=\frac{1}{1-0.9^2}=5.263158$ and $\mathcal{J}=\frac{1}{(1-0.9)^2}=100$ . You can see the sandwich::lrv() function seems to get the long-run variance right (although, this function reporting $\frac{1}{T}\mathcal{J}$ surprised me) Q : But, why do I have var(mean_hat_stab[(n-window):(n)]) coming out as 0.001800713 !? This calculation is just the variance of the sample mean for very large n . This should be near 100, right? Did I just make a goof in my calculation? Did I miss something fundamental about LRV? Is this just a number of simulations thing? set.seed(10) n = 1e7 window = 1000 phi = 0.9 # AR(1) parameter sig2 = 1 srv = sig2 / (1 - phi^2) # [1] 5.263158 lrv = sig2 / (1 - phi)^2 # [1] 100 eps N(0,lrv) var(mean_hat_stab[(n-window):(n)]) # [1] 0.001800713, Why not 100!? qqnorm(mean_hat_stab[(n-window):n]) # Why not normal, on a perfect line!? lrv_hat_a
