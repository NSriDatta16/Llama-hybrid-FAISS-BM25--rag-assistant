[site]: crossvalidated
[post_id]: 606988
[parent_id]: 
[tags]: 
Computation of ratio with Dirichlet distribution

I would like to compute ratio of proportions coming from a Dirichlet distribution. My understanding is that each proportion should be treated as a random variable and therefore I should use Taylor expansion to compute mean and variance of ratio. However when I follow this procedure I seem to obtain very different results between the first and second order Taylor expansion, and more importantly the second order Taylor results are difficult to interpret (ie they dont seem to make sense). As I am not very familiar with the Dirichlet distribution, I was wondering whether I missed something. Here is an illustration of the problem on simulated data (using R and the DirichletReg package for the modelling) - In this example, we simulate 6 proportions for 10,000 individuals using a Dirichlet distribution. # load R package library(DirichletReg) # simulate data (6 proportions, 10000 individuals) pct0 = (1:6)/sum(1:6) set.seed(12345) data = rdirichlet(10000,pct0) data = as.data.frame(data) colnames(data) = paste0('pct',1:6) # model estimation data$Y = DR_data(data[,paste0('pct',1:6)]) fit = DirichReg(Y ~ 1, data=data, model='common') # retrieve model estimates mle = as.numeric(fit$coefficients) names(mle) = paste0('pct',1:6) # compute average a0 = sum(exp(mle)) pct1 = exp(mle)/a0 # compare estimated vs true proportions cbind(pct0,pct1) # compute mean (mu), variance (va) and covariance (cov) of Dirichlet distribution for proportion_1 and proportion_2 # source: https://en.wikipedia.org/wiki/Dirichlet_distribution mu1 = pct1[1] mu2 = pct1[2] va1 = (mu1*(1-mu1))/(1+a0) va2 = (mu2*(1-mu2))/(1+a0) cov12 = -(mu1*mu2)/(1+a0) # compute average of ratio of proportion_1/proportion_2 # source: https://www.stat.cmu.edu/~hseltman/files/ratio.pdf # with first order taylor expansion muratio1 = mu1/mu2 # with second order taylor expansion muratio2 = (mu1/mu2) - (cov12/(mu2**2)) + (mu1*va1/(mu2**3)) # compare results c(muratio1,muratio2) I would have 2 questions for you: (1) Is it ok to obtain average proportions from the Dirichlet regression (DR) that are quite different from the true values? For example, true proportion for proportion_1 was 0.04761905, and when we compute the mean over 10000 individuals we obtain 0.04866258, but with the DR model the corresponding average would be 0.09224526 (so almost twice the size of the true value!). (2) The average ratio obtained with 1st Taylor expansion is 0.7919314 and I would say is in line with the true values (The ratio of true values is 0.5). However the 2nd Taylor expansion gives us a very different result (3.239524). If I understand this value correctly, this is telling us that average of proportion_1/proportion_2 ratio is 3.24, which would suggest that on average the proportion_1 is larger than proportion_2, but we know that this is not true.
