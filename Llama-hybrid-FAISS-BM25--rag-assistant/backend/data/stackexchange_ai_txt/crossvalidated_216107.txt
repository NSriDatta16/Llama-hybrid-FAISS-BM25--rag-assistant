[site]: crossvalidated
[post_id]: 216107
[parent_id]: 215971
[tags]: 
My guess is that this is a difference in how the two-sided p-value is computed. In exact tests with non-symmetric distributions (as in your unbalanced example), there are different conceivable ways to accomplish this. See for example the discussion of the two-sided Binomial test and Sign test on Wikipedia: One strategy is compute the left-sided $\mbox{Pr}(S \le s)$ and the right-sided $\mbox{Pr}(S \ge s)$ and then take twice the minimum out of these. My guess is that this is what MATLAB uses. A different approach is to add to the smaller of these p-values the probability of observing an at least as extreme statistic on the other tail. If the test statistic S is standardized (as in the R/coin package) then one can do this via $\mbox{Pr}(S \le -|s|) + \mbox{Pr}(S \ge |s|)$. Finally, one can some over all possible $\mbox{Pr}(S = s_i)$ that are at least as unlikely as the $\mbox{Pr}(S = s)$ for the observed statistic $s$. In your example, we can easily carry out all approaches explicity in R. First, we generate the data, all 126 permutations, and the rank sums (using average ranks). y To be able to apply strategy 2, we scale the rank sums (which makes no difference at all for strategies 1 and 3): rss which replicates the test statistic reported by R/coin. The exact distribution is given by: prop.table(table(rs)) ## rs ## 17.5 22 26.5 31 ## 0.04761905 0.35714286 0.47619048 0.11904762 prop.table(table(rss)) ## rss ## -2.23606797749979 -0.894427190999916 0.447213595499958 1.78885438199983 ## 0.04761905 0.35714286 0.47619048 0.11904762 Then, the first strategy gives this p-value (as reported by MATLAB): 2 * min(c(mean(rss = rss[1]))) ## [1] 0.0952381 The second strategy gives the following p-value (as reported by R/coin): mean(rss = abs(rss[1])) ## [1] 0.04761905 And the third strategy gives p While strategy 1 is discussed in the literature - specifically for sign tests and rank tests (see the Wikipedia "Sign test" link above) - something like 2 or 3 is typically preferred (as argued in the Wikipedia "Binomial test" link above).
