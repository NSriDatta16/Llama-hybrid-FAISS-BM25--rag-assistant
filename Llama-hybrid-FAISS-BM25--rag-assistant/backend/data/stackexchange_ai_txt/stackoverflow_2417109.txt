[site]: stackoverflow
[post_id]: 2417109
[parent_id]: 1825886
[tags]: 
Thanks a lot Markus for finding a solution to this. Here are some slightly more detailed instructions for the benefit of OpenOffice Basic newbies like myself. This applies to version 3.1: Tools -> Macros -> Organize Macros -> OpenOffice.org Basic... Now select from the explorer tree where you want your function live, e.g. it can be in your own macro library (My Macros / Standard) or stored directly in the current spreadsheet. Now enter a new Macro name and click New to open the OO.org Basic IDE. You'll see a REM statement and some stub Sub definitions. Delete all that and replace it with: Function STRJOIN(range, Optional delimiter As String, Optional before As String, Optional after As String) Dim row, col As Integer Dim result, cell As String result = "" If IsMissing(delimiter) Then delimiter = "," End If If IsMissing(before) Then before = "" End If If IsMissing(after) Then after = "" End If If NOT IsMissing(range) Then If NOT IsArray(range) Then result = before & range & after Else For row = LBound(range, 1) To UBound(range, 1) For col = LBound(range, 2) To UBound(range, 2) cell = range(row, col) If cell <> 0 AND Len(Trim(cell)) <> 0 Then If result <> "" Then result = result & delimiter End If result = result & before & range(row, col) & after End If Next Next End If End If STRJOIN = result End Function The above code has some slight improvements from Markus' original: Doesn't start with a delimiter when the first cell in the range is empty. Allows optional choice of the delimiter (defaults to ","), and the strings which go before and after each non-blank entry in the range (default to ""). I renamed it STRJOIN since "join" is the typical name of this function in several popular languages, such as Perl, Python, and Ruby. Variables all lowercase Now save the macro, go to the cell where you want the join to appear, and type: =STRJOIN(C3:C50) replacing C3:C50 with the range of strings you want to join. To customise the delimiter, instead use something like: =STRJOIN(C3:C50; " / ") If you wanted to join a bunch of email addresses, you could use: =STRJOIN(C3:C50; ", "; " ") and the result would be something like , , ,
