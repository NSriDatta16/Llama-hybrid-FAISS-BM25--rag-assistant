[site]: crossvalidated
[post_id]: 295920
[parent_id]: 
[tags]: 
Logistic Regression is a Convex Problem but my results show otherwise?

I know that logistic regression is a convex problem. Furthermore, from Lemma 1.17 in these optimization lecture notes , if a function $f : \mathbb{R}^n \rightarrow \mathbb{R}$ is convex, then the function over a restricted domain (as it were) should be convex. For example, if $f(x,y,z)$ is convex, then $g(x,y) = f(x,y,2)$ should be convex (assuming $f$ is defined at $z=2$), right? However, I have been experimenting with my own implementation of logistic regression and have found that the loss function (ie opposite of log-likelihood) is not convex. All my code is at the bottom I have created the following fake dataset which can be perfectly classified: I defined a loss function as the negative log likelihood, scaled by $1/n$: $$ L(\beta) = - \frac{1}{n}\sum_{i=1}^{n} y_i \log(p_i) + (1-y_{i})\log(1-p_i) $$ where $$p_i = \dfrac{\exp(\beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i})}{1+\exp(\beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i})}$$ My optimization function gives the following solution (which seems to be right because it can perfectly classify the data), $$\hat{\mathbf{\beta}} = (0, -20, 23)$$ If I plot the loss function at a fixed value of the third parameter $g(a,b) = L( (a, b, 23)$, it does not appear convex. I have tried this for multiple values of the third parameter. What is going on here? # # Create dataset # x1 18){return(1)} if(arg 0.5, 1, 0) table(preds, dat$y) # # Plot the loss # lossPlot Thanks!
