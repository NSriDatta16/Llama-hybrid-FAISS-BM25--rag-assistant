[site]: crossvalidated
[post_id]: 583867
[parent_id]: 
[tags]: 
Obtaining log-likelihood value of a Markov chain when probability transition matrix contains exact-zero entries

I have a $n$ sequences $\boldsymbol{X}_1, \dots, \boldsymbol{X}_n$ of varying lengths arising from a Markov chain with a large state space $\mathcal{S} = \{ 1, 2, \dots, s \}$ . Suppose the initial state probabilities are $\boldsymbol{\pi} = (\pi_1, \dots, \pi_s)^\top$ and the transition probability matrix is denoted by $$\boldsymbol{P} = \begin{bmatrix} P_{11} & P_{12} & \cdots & P_{1s} \\ P_{21} & P_{22} & \cdots & P_{2s} \\ \vdots & \vdots & \ddots & \vdots \\ P_{s1} & P_{s2} & \cdots & P_{ss} \end{bmatrix}.$$ Herein, I am interested in obtaining the maximum likelihood estimates for $\boldsymbol{\pi}$ and $\boldsymbol{P}$ . The log-likelihood function for $\boldsymbol{\pi}$ and $\boldsymbol{P}$ can be written as $$l (\boldsymbol{\pi}, \boldsymbol{P}; \boldsymbol{x}_1, \dots, \boldsymbol{x}_n) = \sum_{i = 1}^n \left[ \sum_{j = 1}^s I (x_{i1} = j) \log \pi_j + \sum_{h = 1}^s \sum_{k = 1}^s c_{ihk} \log P_{hk} \right],$$ where $x_{i1}$ is the first state of sequence $\boldsymbol{x}_i$ and $c_{ihk}$ is the number of transitions from state $h$ to state $k$ within sequence $\boldsymbol{x}_i$ . So, basically, for each sequence, we will have a transition frequency matrix $\boldsymbol{C}_i$ . I was able to obtain the MLEs for $\boldsymbol{\pi}$ and $\boldsymbol{P}$ but in my case, because I have a large state space with some transitions occurring very rarely, I want to further impose a constraint that some entries in $\boldsymbol{P}$ to be exactly 0. I was then able to tweak the traditional MLE formulas to fulfill the constraint, but I ran into the problem of obtaining the log-likelihood value since $\log(0)$ is undefined. Computation-wise, I can replace those exact zeros with some small number like $0.0001$ , but I think this approach is quite arbitrary and context-dependent (works in some cases but not all). Does anyone have any ideas on this matter? Please help me if you can. Thank you so much.
