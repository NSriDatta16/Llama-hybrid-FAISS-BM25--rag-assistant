[site]: crossvalidated
[post_id]: 242212
[parent_id]: 
[tags]: 
How do you write this covariance equation in matlab without any loops

How would you implement the following in Matlab without loops: $$ \Sigma = \frac{1}{m}\sum_{i=1}^{m}(\mathbf x_i - \mu_{yi})(\mathbf x_i - \mu_{yi})^T $$ Where $\mathbf x \in \mathbb{R}^{m\times n}$ is your input matrix, $\mathbf y \in \{0,1\}$ is your label column vector. Additionally, you need to have already calculated parameters $\mu_0$ and $\mu_1$ which are the means of $\mathbf x$ for samples of class 0 and 1 (according to vector $\mathbf y$). The tricky part is $\mu_{yi}$. In the equation, you cannot simply multiply the input with its mean, since $\mu_{yi}$ is a conditional mean. If class of $\mathbf x_i$ is 0, then $\mu_{yi}=\mu_0$, otherwise $\mu_{yi}=\mu_1$. How can you do this elegantly in Matlab without loops and checking for $y_i$ at every sample?
