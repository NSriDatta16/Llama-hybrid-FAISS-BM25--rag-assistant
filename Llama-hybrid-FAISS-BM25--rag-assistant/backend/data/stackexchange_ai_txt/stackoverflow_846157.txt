[site]: stackoverflow
[post_id]: 846157
[parent_id]: 
[tags]: 
Open Microsoft Word in Java

I'm trying to open MS Word 2003 document in java, search for a specified String and replace it with a new String. I use APACHE POI to do that. My code is like the following one: public void searchAndReplace(String inputFilename, String outputFilename, HashMap replacements) { File outputFile = null; File inputFile = null; FileInputStream fileIStream = null; FileOutputStream fileOStream = null; BufferedInputStream bufIStream = null; BufferedOutputStream bufOStream = null; POIFSFileSystem fileSystem = null; HWPFDocument document = null; Range docRange = null; Paragraph paragraph = null; CharacterRun charRun = null; Set keySet = null; Iterator keySetIterator = null; int numParagraphs = 0; int numCharRuns = 0; String text = null; String key = null; String value = null; try { // Create an instance of the POIFSFileSystem class and // attach it to the Word document using an InputStream. inputFile = new File(inputFilename); fileIStream = new FileInputStream(inputFile); bufIStream = new BufferedInputStream(fileIStream); fileSystem = new POIFSFileSystem(bufIStream); document = new HWPFDocument(fileSystem); docRange = document.getRange(); numParagraphs = docRange.numParagraphs(); keySet = replacements.keySet(); for (int i = 0; i I call this function with following arguments: HashMap replacements = new HashMap (); replacements.put("AAA", "BBB"); searchAndReplace("C:/Test.doc", "C:/Test1.doc", replacements); When the Test.doc file contains a simple line like this : " AAA EEE ", it works successfully, but when i use a complicated file it will read the content successfully and generate the Test1.doc file but when I try to open it, it will give me the following error: Word unable to read this document. It may be corrupt. Try one or more of the following: * Open and repair the file. * Open the file with Text Recovery converter. (C:\Test1.doc) Please tell me what to do, because I'm a beginner in POI and I have not found a good tutorial for it.
