[site]: stackoverflow
[post_id]: 2592492
[parent_id]: 2592068
[tags]: 
WireShark says (of the FIN packet): Broken TCP: The acknowledge field is nonzero while the ACK flag is not set I don't know for sure that's what's causing your problem, but if WireShark doesn't like that packet, maybe the client doesn't either. So, it should be FIN+ACK, or you should set the acknowledge field to 0. If that doesn't solve it, you might also try sending the data first, then a separate FIN packet. It's valid to include data with the FIN, but it's more common to send the FIN by itself (as seen in the other pcap trace you posted earlier). Also, you should probably be setting the PUSH flag in the packet with the 200 OK Finally, I don't see any retransmission attempts for the FIN packet - is that because you stopped the capture right away?
