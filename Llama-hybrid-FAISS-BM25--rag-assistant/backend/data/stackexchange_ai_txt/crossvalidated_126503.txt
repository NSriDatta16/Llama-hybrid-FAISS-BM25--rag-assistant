[site]: crossvalidated
[post_id]: 126503
[parent_id]: 
[tags]: 
Obtaining conditional distribution from mixed model

Suppose you have the following mixed model: $$y_{it} =X_{it} \beta + Z_{it}b_{i} + u_{it} \tag{1}$$ where $y_{it}$ is the response for a subject $i$ and time $t$, $X_{it}$ is a vector of features, $\beta$ is a coefficient, $Z_{it}$ describes random effects, $b_{i}$ are permanent effects and $u_{it}$ is a variable from a normal distribution $u_{i} \sim N(0, I\sigma^{2})$ Basically, I want to obtain the conditional distribution $p(y_{it}|\beta,b_{i})$. As far as I know, equation $(1)$ for $y_{it}$ can be described as a normal distribution: $$y_{it} \sim N(X_{it}\beta+Z_{it}b_{i},u_{it})$$ In order to obtain the conditional distribution, I would get the joint distribution $$p(y_{it},u_{it}|\beta,b_{i}) = p(y_{it}|\beta, b_{i},u_{it} )p(u_{it})$$ and then integrate out $u_{it}$ $$\int p(y_{it},u_{it}|\beta,b_{i})du_{it} = p(y_{it}|\beta,b_{i})$$ However, I haven't been able to obtain the correct distribution: $$y_{it}|b_{i} = N(X_{it}\beta+Z_{it}b_{i}, \sigma^{2})$$ (I'm guessing the dependency on $\beta$ is implicit in this notation) What am I missing? This is the relevant part in Congdon's book "Applied Bayesian Hierarchical Methods": UPDATE : I just realized there is something very wrong with the normal prior for the variance. The variance can't be negative but the prior is centered on $0$. Maybe a change of distribution of $y_{it}$ is needed.
