[site]: crossvalidated
[post_id]: 221334
[parent_id]: 
[tags]: 
Bayesian estimation of Dynamic Linear Models with RStan

I'm reading the Dynamic Linear Models with R book, where most of chapter 4 is devoted to bayesian estimation of parameters. They code most of it manually though, and it seems it can get quite tricky for complicated models. I wonder if this can be more easily done in Stan/Bugs. For example, on p.186, the model to be estimated consists of local linear trend and AR(2) components: \begin{align*} \mathbf{y}_t &= \mathbf{F}\boldsymbol{\Theta}_t + \boldsymbol{\nu}_t, \qquad \boldsymbol{\nu}_t \sim \mathcal{N}(0, \mathbf{V})\\ \boldsymbol{\Theta}_t &= \mathbf{G}\boldsymbol{\Theta}_{t-1} + \boldsymbol{\Omega}_t, \qquad \boldsymbol{\Omega}_t \sim \mathcal{N}(0, \mathbf{W}) \end{align*} where $$F = [1, 0, 1, 0]$$ $$G = \left[\begin{array}{ccc} 1 & 1 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & \phi_1 & 0 \\ 0 & 0 & \phi_2 & 0\end{array}\right]$$ $$ V = [0] $$ $$ W = diag(\sigma_e^2,\sigma_z^2,\sigma_u^2,0 )$$ Priors for ($\phi_1$, $\phi_2$) are $ N(0,(2/3)^2)$ and $ N(0,(1/3)^2)$ and the inverses of variances are assumed to be independent with Gamma priors $g(a^2/b, a/b)$ where a = 1 and b =1000. My question is, can this model be estimated using Stan/Bugs, without manual tweaking of the gibbs sampler? EDIT: Here is my attempt at it using Stan ( data ). Has a lot of convergence problems. data { int N; matrix [1, N] y; } transformed data { matrix [4, 1] F; vector [4] m0; cov_matrix [4] C0; F [1, 1] phi2; real phi1; real sigma ; // for V real W1; real W2; real W3; // vector [4] W_diag; } transformed parameters { vector [1] V; matrix [4, 4] W; matrix [4, 4] G; G [1, 1]
