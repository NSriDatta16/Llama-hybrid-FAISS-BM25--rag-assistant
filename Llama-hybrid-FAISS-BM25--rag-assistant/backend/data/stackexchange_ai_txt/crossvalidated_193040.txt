[site]: crossvalidated
[post_id]: 193040
[parent_id]: 
[tags]: 
Testing Markov Property of transition matrix sequence with markovchain package in R

Related: Check memoryless property of a Markov chain I try to expand the verifyMarkovProperty function of the markovchain package to assess the Markov Property of transition matrices by assigning each unique realised state in the sequence of matrices an ID and testing the sequence of these IDs. However, I am not sure if my approach does make sense statistically. My question is: Is the method I use to test the Markov Property of a sequence of matrices theoretically valid? If so, would it also work for a sequence of matrices where the unique realised states only occur once or at maximum a few times (because of a large amount of possible states compared to a short observation period)? To see if this works I wrote a short script in which I use the verifyMarkovProperty function in four different scenarios: sequence of single states depending only on t sequence of single states depending on t and t-1 sequence of multiple states depending only on t sequence of multiple states depending on t and t-1 For simplicity I use only two possible states ( a and b ) and my matrices for scenarios 3 and 4 only consist of two elements. For each transition combination I report the test statistic, p-value and whether the null hypothesis of the Markov Property holding should be rejected on the 95 and 99 confidence level. Now, using the below code, I get the expected results for scenarios 1 and 2, with only a few runs of scenario 1 yielding false-positive results. Running scenarios 3 and 4, I get a feq more false-positives for scenario 3 which worries me a bit. Furthermore, for scenario 4 I get quite a few false-negatives, even though the generation process clearly does not comply to the Markov Property. Load packages: require(markovchain) require(data.table) Scenario 1: #Scenario 1 #Markov Property OK (depends only on t): #Sequence generation: if t="a" use pA for sampling, if t="b" use pB for sampling pA Scenario 2: #Scenario 2 #Markov Property not OK (depends on t and t-1): #Sequence generation: if t="a" and t-1="a" use pA for sampling, if t="b" and t-1="b" use pB for sampling pA Scenario 3: #Scenario 3 #Markov Property OK (depends only on t): #Sequence generation: if t="a,a" use pA, if t="b,b" use pB, else use (0.5, 0.5) pA Scenario 4: #Scenario 4 #Markov Property not OK (depends on t and t-1): #Sequence generation: if t="a,a" and t-1="a,a" use pA, if t="b,b" and t-1="b,b" use pB, else use (0.5, 0.5) pA
