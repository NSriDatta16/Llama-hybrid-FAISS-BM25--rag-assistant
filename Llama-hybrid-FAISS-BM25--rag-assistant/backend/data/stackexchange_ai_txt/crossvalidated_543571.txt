[site]: crossvalidated
[post_id]: 543571
[parent_id]: 543536
[tags]: 
You can do it by progressing conditionally through the categories. I'm going to work from the last category backward (for a particular reason) but it can be done in any order as long as you're consistent in how you go about it. Equal probability case : Sample the count in the $n$ -th category, $X_n\sim\text{bin}(n,\frac{1}{n})$ . Sample the count in the $n-1$ -th category conditionally on $X_n=x_n$ , i.e. $X_{n-1}\sim\text{bin}(n-x_n,\frac{1}{n-1})$ . Sample the count in the $n-2$ -th category conditionally on $X_{n-1}+X_n=s_{n-1:n}$ , i.e. $X_{n-2}\sim\text{bin}(n-s_{n-1:n},\frac{1}{n-2})$ , ... and so on. Naturally, if $s_{i:n}$ hits $n$ , all lower $X$ 's are $0$ for that sample. Unequal probability case : Sample the count in the $n$ -th category, $X_n\sim\text{bin}(n,p_n)$ . Sample the count in the $n-1$ -th category conditionally on $X_n=x_n$ , i.e. compute $p_{n-1:n} = \frac{p_{n-1}}{{1-p_n}}$ (i.e. scaling up the remaining probabilities since we no longer have the last category) and draw $X_{n-1}\sim\text{bin}(n-x_n,p_{n-1:n})$ . Sample the count in the $n-2$ -th category conditionally on $X_{n-1}+X_n=s_{n-1:n}$ , i.e. compute $p_{n-2:n} = \frac{p_{n-2}}{{1-p_{n-1}-p_n}}$ and draw $X_{n-2}\sim\text{bin}(n-s_{n-1:n},p_{n-2:n})$ , ... and so on. Naturally, if $s_{i:n}$ hits $n$ , all lower $X$ 's are $0$ for that sample. So you progress through, adjusting both the "n" and "p" to account for the conditioning on what categories are already drawn and what's left to draw from. If there are a very large number of categories and so typically very small values of $p_i$ you may need to pay attention to numerical error in the scaling of those $p$ values as you progress.
