[site]: crossvalidated
[post_id]: 381289
[parent_id]: 
[tags]: 
Fitting a multivariate AR(1) with covariates?

I have time series data where my main question of interest is making inference on predictive covariates, and accounting for the correlation (one observation each day) is just a nuisance issue. The model I would like to fit is: $$ y_t = X_t\beta + \Psi\epsilon_{t-1}+\omega_t $$ where $y_t$ is a 1x3 vector of responses, $\omega_t$ is a 1x3 normal error term with diagonal covariance matrix (uncorrelated errors), and $\epsilon_{t-1}= \Psi \epsilon_{t-2}+\omega_{t-1}$ . Every package I can find on R either doesn't handle the covariates at all, or replaces $\Psi\epsilon_{t-1}$ with $\Psi y_{t-1}$ . This is what the vars package for vector autoregression does and leads to incorrect inference on my coefficients. I am looking for one of three things: Why fitting $\Psi y_{t-1}$ makes more sense than what I am trying to do. A package that will fit the model as specified. Advice on how to get the MLEs manually using optim or similar functions.
