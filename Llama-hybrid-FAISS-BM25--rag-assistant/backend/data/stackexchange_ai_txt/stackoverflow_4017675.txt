[site]: stackoverflow
[post_id]: 4017675
[parent_id]: 3846304
[tags]: 
The ZmEu attacks were annoying me too, so I looked into this. It can be done with an HttpModule. Add the following class to your project: using System; using System.Collections.Generic; using System.Linq; using System.Web; using System.Security.Principal; //using log4net; namespace YourProject { public class UserAgentBlockModule : IHttpModule { //private static readonly ILog logger = LogManager.GetLogger(typeof(UserAgentBlockModule)); public void Init(HttpApplication context) { context.BeginRequest += new EventHandler(context_BeginRequest); } void context_BeginRequest(object sender, EventArgs e) { HttpApplication application = (HttpApplication)sender; HttpRequest request = application.Request; if (request.UserAgent.Contains("ZmEu")) { //logger.InfoFormat("ZmEu attack detected from IP {0}, aiming for url {1}", request.UserHostAddress, request.Url.ToString()); HttpContext.Current.Server.Transfer("RickRoll.htm"); } } public void Dispose() { // nothing to dispose } } } and then add the following line to web.config ... ... and then add a suitable htm page to your project so there's somewhere to redirect them to. Note that if you're using log4net you can comment in the log4net lines in the code to log the occasions when the filter kicks in. This module has worked for me in testing (when I send the right userAgent values to it). I haven't tested it on a real server yet. But it should do the trick. Although, as I said in the comments above, something tells me that returning 404 errors might be a less conspicuous response than letting the hackers know that you're aware of them. Some of them might see something like this as a challenge. But then, I'm not an expert on hacker psychology, so who knows.
