[site]: crossvalidated
[post_id]: 406192
[parent_id]: 404669
[tags]: 
Stating your model and hypotheses in their proper form: Firstly, let me note that your own formulation of your model is problematic, insofar as the "parameter" $\theta_K$ depends on $z_i$ and thus depends on the index $i$ . It therefore cannot be a single value, and must instead be a set of values $\theta_{K1},...,\theta_{Kn}$ , which then feeds into the vector $\theta$ to create a similar set of vector "parameters". This is quite a horrible way to write the model, and it can be greatly simplified by substituting each $\theta_{Ki}$ with its underlying expression in terms of $z_i$ and $\alpha$ . If we let $\phi = \theta_{-K}$ be the remaining parameters, then we can write the regression function as: $$g(x_i, z_i, \phi, \alpha) = f(x_i, z_i, \theta_{-K}, \theta_{Ki}(z_i,\alpha)).$$ You can then write your more general model in standard nonlinear regression form as: $$Y_i = g(x_i, z_i, \phi, \alpha) + \varepsilon_i \quad \quad \quad \quad \quad \varepsilon_i \sim \text{IID Noise Dist},$$ and your hypotheses of interest are: $$H_0: \alpha = 0 \quad \quad \quad \quad \quad H_A: \alpha \neq 0.$$ Since $z_i$ affects the regression function only through $\theta_{Ki}$ , according to your specified expression, your null hypothesis is that the response variable $Y_i$ is unrelated to the explanatory variable $z_i$ conditional on the other explanatory variable $x_i$ , which is a standard regression hypothesis. To test this hypothesis, all you need to do is to formulate a test statistic that measures how conducive the data is to the alternative hypothesis, and then compute the p-value of the test from the null distribution of that test statistic. Attempted goodness-of-fit tests via permutation simulation: What you propose in your question appears to be an attempt to conduct a kind of goodness-of-fit test, where you use the "fit improvement" from the coefficients-of-determination for your test statistic. (Your question does not specify the specific test statistic you propose, but I assume it is the statistic $R_1^2 - R_0^2$ , with larger values more conducive to the alternative hypothesis.) You propose to simulate the null distribution of the test statistic using random permutations of the vector $\mathbf{z}$ . This type of simulation method is set out in various papers, but I would recommend reading the summary paper Anderson and Robinson (2001) for an example of how it applies in multiple linear models (nonlinear models are a simple extension). This paper gives a good explanation of the requirements of a permutation test in multivariate regression. Unfortunately, the procedure you have proposed does not appear to me to work correctly, since it does not take account of the relationship between $\mathbf{y}$ and $\mathbf{x}$ . Merely permuting the elements of the vector $\mathbf{z}$ does not simulate the uncertainty in $\mathbf{Y}$ arising from differences in $\mathbf{x}$ , so I don't think this will work. If you want to develop this method and check that it works, one thing you will definitely have to do is to spell out the method more clearly, including specifying the test statistic, p-value function, and your simulated estimator of the p-value. To advance this process, I will attempt to do that here. Given your model and the proposed test statistic (which I am assuming, since it was not specified clearly), we can write the true p-value function for your test as: $$\begin{equation} \begin{aligned} p \equiv p(\mathbf{y}, \mathbf{x}, \mathbf{z}) &= \mathbb{P} \Big( R_1^2(\mathbf{Y}, \mathbf{x}, \mathbf{z}) - R_0^2(\mathbf{Y}, \mathbf{x}) \geqslant R_1^2(\mathbf{y}, \mathbf{x}, \mathbf{z}) - R_0^2(\mathbf{y}, \mathbf{x}) \Big| H_0 \Big) \\[6pt] &= \mathbb{P} \Big( R_1^2(\mathbf{Y}, \mathbf{x}, \mathbf{z}) - R_0^2(\mathbf{Y}, \mathbf{x}) \geqslant R_1^2(\mathbf{y}, \mathbf{x}, \mathbf{z}) - R_0^2(\mathbf{y}, \mathbf{x}) \Big| \alpha = 0 \Big). \\[6pt] \end{aligned} \end{equation}$$ Your proposed procedure generates random permutations $\stackrel\frown{\mathbf{z}}_1,...,\stackrel\frown{\mathbf{z}}_M \sim \pi(\mathbf{z})$ and then estimates the true p-value function as: $$\begin{equation} \begin{aligned} \hat{p} \equiv \hat{p}(\mathbf{y}, \mathbf{x}, \mathbf{z}) &= \frac{1}{M} \sum_{k=1}^M \mathbb{I} \Big( R_1^2(\mathbf{y}, \mathbf{x}, \stackrel\frown{\mathbf{z}}_k) - R_0^2(\mathbf{y}, \mathbf{x}) \geqslant R_1^2(\mathbf{y}, \mathbf{x}, \mathbf{z}) - R_0^2(\mathbf{y}, \mathbf{x}) \Big) \\[6pt] &= \frac{1}{M} \sum_{k=1}^M \mathbb{I} \Big( R_1^2(\mathbf{y}, \mathbf{x}, \stackrel\frown{\mathbf{z}}_k) \geqslant R_1^2(\mathbf{y}, \mathbf{x}, \mathbf{z}) \Big). \\[6pt] \end{aligned} \end{equation}$$ This does not seem to me to be a valid approximation of the true p-value function, and I see no reason that it would even possess basic consistency properties for $M \rightarrow \infty$ . It does not appear to appeal to any known pivotal quantity, and the fact of averaging over permutations of $\mathbf{z}$ does not appear to me to incorporate the effect of $\mathbf{x}$ .
