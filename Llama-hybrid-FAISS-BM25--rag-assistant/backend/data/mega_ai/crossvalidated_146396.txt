[site]: crossvalidated
[post_id]: 146396
[parent_id]: 
[tags]: 
EM algorithm: With prior vs. not prior

I have a working EM algorithm without prior. I am asking for some advice on how to add prior on latent variables. Define: $t_i \in \{ +1, -1 \} $: variables of interest to be predicted $p_j \in [0,1]$: Latent variable $A_{ij}\in \{+1, -1\}$: Observations $ g_{ij}(t_i,p_j) = p_j^ { \mathbf{I} \lbrace A_{ij} = t_i \rbrace } \times (1-p_j)^{ \mathbf{I} \lbrace A_{ij} \neq t_i \rbrace} $ Without Prior: Likelihood: $L(p; t) = \prod_{i,j} g_{ij}(t_i,p_j) $ E-step: Suppose $t_i \sim q_i$. Then: $$ Q_j(p) =\mathbb{E}_{t}\left[ \ln L(p; t) \right] = \sum_{i} \sum_{t_i} \left[ { q_i(t_i)} \left\lbrace \ln p_j \mathbf{I} \lbrace A_{ij} = t_i \rbrace + \ln(1-p_j) \mathbf{I} \lbrace A_{ij} \neq t_i \rbrace \right\rbrace \right] $$ where $$ q_i(t_i) = \frac{ \prod_{j} g_{ij}(t_i, p_j) }{ \sum_{t_i} \prod_{j} g_{ij}(t_i, p_j) } \quad \quad (1) $$ M-step: $$ p_j^* = \arg\max_p Q_j(p) \Rightarrow p_j^* = \frac{\sum_{i}q(A_{ij})}{ \sum_{i}[ q(A_{ij}) + q(-A_{ij}) ] } $$ With Prior: Now suppose each of the latent variables come from [conjugate] prior: $p_j \sim Beta( \alpha_j, \beta_j)$ I modify $Q_j() $ and average over $p_j$ using its Beta distribution: $$ Q_j(\alpha_j, \beta_j) = \mathbb{E}_{p_j} \mathbb{E}_{t}\left[ \ln L(p; t) \right] = \sum_{i} \sum_{t_i} \left[ { q_i(t_i)} \left\lbrace \mathbb{E}_{p_j}[\ln(p_j)] \mathbf{I} \lbrace A_{ij} = t_i \rbrace + \mathbb{E}_{p_j}[\ln(1-p_j)] \mathbf{I} \lbrace A_{ij} \neq t_i \rbrace \right\rbrace \right] $$ where: $$ \mathbb{E}_{p_j}[\ln(p_j)] = \psi(\alpha_j) - \psi(\alpha_j+\beta_j) $$ and $$ \mathbb{E}_{p_j}[\ln(1-p_j)] = \psi(\beta_j) - \psi(\alpha_j+\beta_j) $$ and $q_i()$ is defined based on (1). M-step: $$ (\alpha^*, \beta^*) = \arg\max_{(\alpha, \beta)} Q_j(\alpha_j, \beta_j) $$ Unfortunately the M-step here doesn't seem to lead to a closed form solution. Suspicious part is that, I don't see where I am using the conjugacy of Bernoulli and Uniform distribution (by choosing the prior on $p_j$ to be Beta. ). Any idea where I am doing wrong in incorporating prior into EM?
