[site]: stackoverflow
[post_id]: 2232543
[parent_id]: 2217289
[tags]: 
I will add my own solution, which seems to be quite slow as well. First parameter is a function that returns Int32 - which is unique identifier of the parameter. If you want to uniquely identify it by different means (e.g. by 'id'), you have to change the second parameter in H.new to a different hash function. I will try to find out how to use Data.Map and test if I get faster results. import qualified Data.HashTable as H import Data.Int import System.IO.Unsafe cache :: (a -> Int32) -> (a -> b) -> (a -> b) cache ident f = unsafePerformIO $ createfunc where createfunc = do storage return res Nothing -> do result
