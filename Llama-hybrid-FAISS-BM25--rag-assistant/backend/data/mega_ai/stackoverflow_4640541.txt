[site]: stackoverflow
[post_id]: 4640541
[parent_id]: 4640514
[tags]: 
You are mixing compile-time evaluation of pragma with run-time execution of code. Obviously this won't work. It's possible to keep a manifest for the application in "PutYourProgramNameHere.exe.manifest" file. So if you need different manifests for XP and Vista/Win7, then you can install different manifest files when you install the application on the target computer. I.e. your installer checks OS version and installs matching manifest.
