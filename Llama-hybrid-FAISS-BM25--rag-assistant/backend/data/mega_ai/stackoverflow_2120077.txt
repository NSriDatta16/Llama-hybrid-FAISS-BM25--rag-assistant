[site]: stackoverflow
[post_id]: 2120077
[parent_id]: 2104030
[tags]: 
UTF-16 is not very common in plain text files. UTF-8 is much more common because it is back compatible with ASCII and is specified in standards like XML. 1) Check for BOM of various Unicode encodings. If found, use that encoding. 2) If no BOM, check if file text is valid UTF-8, reading until you reach a sufficient non-ASCII sample (since many files are almost all ASCII but may have a few accented characters or smart quotes) or the file ends. If valid UTF-8, use UTF-8. 3) If not Unicode it's probably current platform default codepage. 4) Some encodings are easy to detect, for example Japanese Shift-JIS will have heavy use of the prefix bytes 0x82 and 0x83 indicating hiragana and katakana. 5) Give user option to change encoding if program's guess turns out to be wrong.
