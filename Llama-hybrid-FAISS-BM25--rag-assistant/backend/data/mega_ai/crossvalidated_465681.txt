[site]: crossvalidated
[post_id]: 465681
[parent_id]: 462134
[tags]: 
You would expect slight differences. The Rao-Scott tests were developed (according to Alastair Scott) to give approximately correct inference for estimated population tables, so the code estimates the population table, calls chisq.test() on it, and rescales the statistic. Even for simple random sampling, this will introduce slight variations. When comparing proportions in the two strata under case-control sampling there is no need to use the Rao-Scott test. The test is for the 2-way association parameter in a loglinear model, and this association parameter is preserved by case-control sampling (for the same reason that logistic regression coefficients are). [I don't think this has anything to do with the linked Stratified survey calculations by hand and with survey package don't agree. Simulation results
