[site]: crossvalidated
[post_id]: 253846
[parent_id]: 253756
[tags]: 
The issue, which I overlooked initially, is that you fitted an additive model (no interaction). year as a factor I will illustrate, but for reasons to be explained later, I'm using fyear , a factor version of year : > simdat = transform(simdat, fyear = factor(year)) > msim doBy::LSmeans(msim, "treat") estimate se df t.stat p.value treat 1 2.571429 0.4400255 5 5.843817 0.002076749 t1 2 3.714286 0.5729889 5 6.482299 0.001302694 t2 > msimi doBy::LSmeans(msimi, "treat") estimate se df t.stat p.value treat 1 2.625 0.4419417 4 5.939697 0.004028851 t1 2 3.875 0.5929271 4 6.535374 0.002832366 t2 Your calculations are thus correct for the interaction model msimi . That's because the fitted values for that model are the cell means. Least-squares means are averages of predictions , equally weighted. Here they are obtained by hand for the additive model, msim : First, obtain the predictions: > grid = expand.grid(treat = c("t1","t2"), fyear = factor(c(1,2))) > pred = predict(msim, newdata = grid) > cbind(grid, pred=pred) treat fyear pred 1 t1 1 1.214286 2 t2 1 2.357143 3 t1 2 3.928571 4 t2 2 5.071429 Now, average those predictions: > (pred[1] + pred[3])/2 1 2.571429 > (pred[2] + pred[4])/2 2 3.714286 These are the same as the results that LSmeans obtained. year as numeric There is a subtle difference when we use the model with year as a numeric predictor: > msimq = lm(y ~ treat + year, data = simdat) Least-squares means are obtained from a "reference grid" defined by the model. The lsmeans package allows obtaining that reference grid explicitly: > library(lsmeans) > summary(ref.grid(msim)) treat fyear prediction SE df t1 1 1.214286 0.5190258 5 t2 1 2.357143 0.7340133 5 t1 2 3.928571 0.6086117 5 t2 2 5.071429 0.6086117 5 > summary(ref.grid(msimq)) treat year prediction SE df t1 1.5 2.571429 0.4400255 5 t2 1.5 3.714286 0.5729889 5 As you see, the reference grid for msim consists of the four combinations of the two factors, whereas the reference grid for msimq has only two points, with year set to its average. The least-squares means for treat are the same for both models, because the linear effect of year is used, which implies that the mean at the average is the average of the means of years 1 and 2. Summary To understand least-squares means correctly, focus on the fact that they are based on predictions from a model -- not directly on data without a model context. You might want to take a look at the documentation and vignettes in the lsmeans package, which has more comprehensive support for obtaining least-squares means from various models.
