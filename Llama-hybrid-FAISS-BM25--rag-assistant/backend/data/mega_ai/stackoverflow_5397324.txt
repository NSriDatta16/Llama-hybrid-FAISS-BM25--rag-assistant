[site]: stackoverflow
[post_id]: 5397324
[parent_id]: 
[tags]: 
how to write tests that impersonates different users?

My Winforms app set permissions based on the group membership found in the current process. I just made a unit test in MSTEST. I'd like to run it as other users so I can verify the expected behavior. Here's what I'm kind of shooting for: [TestMethod] public void SecuritySummaryTest1() { Impersonate(@"SomeDomain\AdminUser", password); var target = new DirectAgentsSecurityManager(); string actual = target.SecuritySummary; Assert.AreEqual( @"Default=[no]AccountManagement=[no]MediaBuying=[no]AdSales=[no]Accounting=[no]Admin=[YES]", actual); } [TestMethod] public void SecuritySummaryTest2() { Impersonate(@"SomeDomain\AccountantUser", password); var target = new DirectAgentsSecurityManager(); string actual = target.SecuritySummary; Assert.AreEqual( @"Default=[no]AccountManagement=[YES]MediaBuying=[no]AdSales=[no]Accounting=[YES]Admin=[NO]", actual); }
