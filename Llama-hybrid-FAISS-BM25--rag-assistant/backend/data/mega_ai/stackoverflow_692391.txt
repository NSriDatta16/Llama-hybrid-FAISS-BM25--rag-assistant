[site]: stackoverflow
[post_id]: 692391
[parent_id]: 681011
[tags]: 
Robert Edmonds, author of pcaputils, mentioned to me that there is already a program doing what I want, capinfos, in the Wireshark package. It displays various indications about a pcap file, including the number of packets it contain. Reading the code source, it appears to work by walking the whole file, sequentially.
