[site]: stackoverflow
[post_id]: 1434534
[parent_id]: 1432573
[tags]: 
As a plan-B, if you can't figure the proper SQL statement to use you can read the whole thing into a memory construct (array, class, etc) and loop it that way. If the data is sufficiently small and memory available sufficiently large this would let you do only one query. Not elegant, but may work for you.
