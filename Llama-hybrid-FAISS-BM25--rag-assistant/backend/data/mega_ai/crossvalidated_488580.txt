[site]: crossvalidated
[post_id]: 488580
[parent_id]: 210622
[tags]: 
There is a lot of literature on the subject and there is also some R Code available. The method Todd D described is known as average method and it is conceptually and empirically biased (See for example Nieto (1996) . It is generally recommended to use direct adjustment or conditional adjustment instead. The survminer package contains a function called ggadjustedcurves which implements direct adjustment (given a cox model) in the method marginal . A non-parametric method to adjust survival curves, which is based on a weighted kaplan-meier estimator, can be found in Xie (2000) . This method and a corresponding weighted log-rank test are implemented in the R-Package RISCA .
