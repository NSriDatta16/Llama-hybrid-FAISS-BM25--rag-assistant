[site]: crossvalidated
[post_id]: 611249
[parent_id]: 
[tags]: 
Estimation of $\mathrm{ARMAX}(1,1,2)$ using panel data

I'm have an application that after some manipulation boils down to an $\mathrm{ARMAX}(1,1,2)$ with some parametric restrictions: $$y_{i,g,t}= k + \beta y_{i,g,t-1} + \epsilon_{i,t}+\beta_e \epsilon_{i,t-1}+\sum_{s=1}^2(\eta_{x,s}x_{i,t+1-s}+\eta_{\bar{x},s}\bar{x}_{i,t-s}+\eta_{z,s}z_{i,t+1-s}) \tag{1} \label{1}$$ with parametric restrictions $\beta_e=-\beta$ $\eta_{\bar{x},1}=-\eta_{x,2}=\beta\eta_{x,1}$ $\eta_{\bar{x},2}=\eta_{z,2}=0$ and $\epsilon_{i,t}\sim N(0,\sigma^2)$ , and for all $s,\,t$ , $\mathrm{cov}(\epsilon_{i,t},\epsilon_{i,t-s})=0$ . Also, $-1 is assumed. The problem: I have panel data and don't know how to estimate \eqref{1} (or implement it in, say, Stata for instance). Background: motivation and what I have tried. The original setting is a dynamic linear model with social interactions as follows: $$y_{i,g,t}= k + c x_{i,t} + d z_{g,t} + \beta m_{g,t-1} + \epsilon_{i,t} \tag{2} \label{2}$$ with $\epsilon_{i,t}\sim N(0,\sigma^2)$ and for all $s,\,t$ , $\mathrm{cov}(\epsilon_{i,t},\epsilon_{i,t-s})=0$ . Also, $-1 is assumed. where $y_{i,g,t}$ corresponds to an individual $i$ action (member of group $g$ ) in time $t$ . It depends of individual-specific characteristics $x_{i,t}$ , group-specific characteristics $z_{g,t}$ , and the average choice in that group in the previous period $m_{g,t-1}$ . Brock and Durlauf (2001) show that the model is identified (i.e. there is no reflection problem ): taking expectations and using the lag operator $\mathrm{L}$ : $$m_{g,t}= k + c \bar{x}_{g,t} + d z_{g,t} + \beta \mathrm{L} m_{g,t} $$ $$\Rightarrow m_{g,t}=\dfrac{ k + c \bar{x}_{g,t} + d z_{g,t} }{1-\beta \mathrm{L}}$$ So, model \eqref{2} can be rewritten as: $$y_{i,g,t}= \dfrac{k}{1-\beta} + c x_{i,t} + \sum_{s=1}^{\infty}\beta^{s}(c \bar{x}_{g,t-s} +\beta^{-1} d z_{g,t+1-s}) + \epsilon_{i,t} \tag{3}\label{3}$$ Thus, $y_{i,g,t}$ depends on the entire history $\{\bar{x}_{g,s},z_{g,s}\}_{s=0}^{t}$ . The model is identified, because (i) $c$ is identified by the coefficients on $x_{i,t}$ , (ii) then $\beta$ is identified by the ratio of coefficients on $\bar{x}_{g,t-1}$ and $\bar{x}_{g,t-2}$ , (iii) then $k$ is identified by the constant and $d$ by the ratio of coefficients on $\bar{z}_{g,t}$ and $\bar{z}_{g,t-1}$ . Model \eqref{3} is reminiscent of the Koyck (1954) model in its infinite part and parametric restriction (geometric progression in the coefficients). Subtracting $\beta y_{i,g,t-1}$ from \eqref{3} (Koyck transformation): $$y_{i,g,t}= k +\beta y_{i,g,t-1} + c x_{i,t}-\beta c x_{i,t-1} + \beta c \bar{x}_{g,t-1} +d z_{g,t} + \epsilon_{i,t}-\beta\epsilon_{i,t-1} \tag{4}\label{4}$$ which can be cast as the general ARMAX(1,1,2) in \eqref{1} with the parametric restrictions I included.
