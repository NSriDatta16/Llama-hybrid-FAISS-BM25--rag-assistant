[site]: stackoverflow
[post_id]: 3446440
[parent_id]: 
[tags]: 
How can I avoid refresh with TWebBrowser

I have a TWebBrowser component that show a Google maps page. The problem is that when user press F5 the page refresh and page reloads. This cause javascript variables to reinitialize and get out of sync with Delphi and a scripting error dialog appear, 'undefined' is null or not an object. I want to stop refresh from the user. I tried this event for OnBeforeNavigate2: procedure TNewOrganizationForm.mapAddressBeforeNavigate2(ASender: TObject; const pDisp: IDispatch; var URL, Flags, TargetFrameName, PostData, Headers: OleVariant; var Cancel: WordBool); begin inherited; Cancel := Assigned(fMapEngine) and not fMapEngine.Loading; end; But when I set a breakpoint it is not even called. Is there another way ?
