[site]: stackoverflow
[post_id]: 5301646
[parent_id]: 
[tags]: 
Rails average - collect only if value <> 0

I'm using this code to calculate the average of some numbers - note that the rankings column is serialized and contains a hash: @reviews.collect{|review| review.rankings[label].to_i}.sum.to_f/@reviews.length if @reviews.length > 0 The drawback with this code is this: if one of the values is nil , the average calculates as if it existed as a zero. The problem is basically that the @reviews.length denominator assumes every review has a relevant value. How do I exclude from the denominator those reviews that don't count? Thank you very much for your answers. The problem ended up being with the denominator, i.e. the /@reviews.length part. When I used reject on both numerator and denominator, the equation stopped dividing by total length and started dividing by (length - no of nils). End result - 2 scores [0 and 100] average to 50; [nil and 100] average to 100.
