[site]: stackoverflow
[post_id]: 1215471
[parent_id]: 
[tags]: 
WMI/VBS/HTML System Information Script

havin' a problem with this code here; can't seem to work out whats goin' wrong with it. All other variables seem to print fine in the HTML ouput; but I get an error that relates to the cputype variable. I get the following error C:\Users\Methical\Desktop\sysinfo.vbs(235,1) Microsoft VBScript runtime error: Invalid procedure call or argument I think it has somethin' to do with this line here fileOutput.WriteLine " CPU " & cputype & " " If i delete this line; the script compiles and outputs with no errors. Here is the full code below Dim strComputer, objWMIService, propValue, objItem Dim strUserName, strPassword, colItems, SWBemlocator ' This section queries for the workstation to be scanned. UserName = "" Password = "" strComputer = "127.1.1.1" ImgDir = "C:\Scripts\images\" 'Sets up the connections and opjects to be used throughout the script. Set SWBemlocator = CreateObject("WbemScripting.SWbemLocator") Set objWMIService = SWBemlocator.ConnectServer(,"root\CIMV2",strUserName,strPassword) 'This determines the current date and time of the PC being scanned. Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_LocalTime", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly) For Each objItem in colItems If objItem.Minute " fileOutput.WriteLine " " fileOutput.WriteLine " System Information for '" & WKID & "' " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " System Information for " & WKID & " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " WKInfo - General information on the Workstation. " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine" " fileOutput.WriteLine " Date and Time " fileOutput.WriteLine" " fileOutput.WriteLine " Date/Time " & DateTime & " " fileOutput.WriteLine " System Uptime " & Uptime & " hours " fileOutput.WriteLine " Time Zone " & Zone & " " fileOutput.WriteLine" " fileOutput.WriteLine " General Computer Information " fileOutput.WriteLine" " fileOutput.WriteLine " Manufacturer " & Manufacturer & " " fileOutput.WriteLine " Model " & Model & " " fileOutput.WriteLine " System Based " & SysType & " " fileOutput.WriteLine " Operating System " & WKOS & " " & CSD & " " & Architecture & " " fileOutput.WriteLine " Operating System Install Date " & InstallDate & " " fileOutput.WriteLine " UserName " & UserName & " " fileOutput.WriteLine " Workstation Name " & WKID & " " fileOutput.WriteLine " Domain " & Domain & " " fileOutput.WriteLine " System Drive " & SysDrive & " " fileOutput.WriteLine " System Directory " & SysDir & " " fileOutput.WriteLine " Windows Directory " & WinDir & " " fileOutput.WriteLine " ShadowStorage Allocated Space " & Allocated & " MB " fileOutput.WriteLine " ShadowStorage Used Space " & UsedSpace & " MB " fileOutput.WriteLine " ShadowStorage Max Space " & MaxSpace & " MB " fileOutput.WriteLine" " fileOutput.WriteLine " General Hardware Information " fileOutput.WriteLine" " fileOutput.WriteLine " CPU " & cputype & " " fileOutput.WriteLine " Memory " & TotalMemory & " MB " fileOutput.WriteLine " Total HDD Space " & TotalHDSpace & " GB " fileOutput.WriteLine " Free HDD Space " & FreeHDSpace & " GB " fileOutput.WriteLine" " fileOutput.WriteLine " General Video Card Information " fileOutput.WriteLine" " fileOutput.WriteLine " Video Card " & VideoCard & " " fileOutput.WriteLine " Resolution " & Resolution & " " fileOutput.WriteLine " Memory " & VideoMemory & " MB " 'This section lists all the current services and their status. fileOutput.WriteLine " Current Service Information " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " Service Name Service State " Set colRunningServices = objWMIService.ExecQuery("Select * from Win32_Service") For Each objService in colRunningServices fileOutput.WriteLine " " & objService.DisplayName & " " & objService.State & " " wscript.echo " " & objService.DisplayName & " " & objService.State & " " Next fileOutput.WriteLine " " fileOutput.WriteLine " " 'This section lists all the current running processes and some information. fileOutput.WriteLine " Current Process Information " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " PID Process Name Owner Memory " Set colProcessList = objWMIService.ExecQuery("Select * from Win32_Process") For Each objProcess in colProcessList colProperties = objProcess.GetOwner(strNameOfUser,strUserDomain) fileOutput.WriteLine " " & objProcess.Handle & " " & objProcess.Name & " " & strUserDomain & "\" & strNameOfUser & " " & objProcess.WorkingSetSize/1024 & " kb " Next fileOutput.WriteLine " " fileOutput.WriteLine " " 'This section lists all the currently installed software on the machine. fileOutput.WriteLine " Installed Software " fileOutput.WriteLine " " Set colSoftware = objWMIService.ExecQuery ("Select * from Win32_Product") For Each objSoftware in colSoftware fileOutput.WriteLine" " fileOutput.WriteLine" Name Vendor Version " fileOutput.WriteLine" " & objSoftware.Name & " " & objSoftware.Vendor & " " & objSoftware.Version & " " fileOutput.WriteLine" " fileOutput.WriteLine" " Next fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.WriteLine " " fileOutput.close WScript.Quit
