[site]: stackoverflow
[post_id]: 2907874
[parent_id]: 2905430
[tags]: 
First, you should know that PCAP give you packets, and will not reconstruct the TCP stream so you won't be able to read full HTTP TCP streams without first reconstructing the data. Assuming all the data is available in one packet try and look at my answer for a similar question . All you need to do different is to parse the HTTP header and get the user agent. If you don't limit yourself to C, and if you can use Windows, you can write a .NET application and use Pcap.Net to parse Ethernet, IPv4 and TCP perfectly.
