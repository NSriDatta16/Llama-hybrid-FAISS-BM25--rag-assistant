[site]: crossvalidated
[post_id]: 51770
[parent_id]: 
[tags]: 
Using STAN (related to BUGS/JAGS) to do linear regression with with ARMA(1,1) noise?

EDIT: I've modified my STAN code and it looks like I am getting numbers close to using R's arima . The original code, now moved to the end, was incorrect. I've been using STAN for simple things, but want to do a linear regression that has ARMA(1,1) noise. I've heard that this is basically equivalent to AR(1) + White Noise. I've made an attempt that gives reasonable numbers but I can't tell if I'm actually doing what I think I'm doing. The reason I'm attempting to do this is that the data is a climate temperature time series, which is thus serially correlated, and so I believe OLS regression -- used to calculate a trend -- will underestimate the uncertainty in the regression, which is reflected in the SE's of the slope and intercept coefficients. (And also in the residual error?) My code, using rstan : temps N ; real x[N] ; real y[N] ; } parameters { real alpha ; real beta ; real kappa ; real sigma0 ; } model { real sigma[N] ; alpha ~ cauchy (0, 5) ; beta ~ cauchy (0, 5) ; kappa ~ gamma (1.2, 1) ; sigma0 ~ gamma (3, 1) ; sigma[1] The alpha, beta, and sigma appear to be reasonable if I use them to throw lines onto the data using abline . QUESTIONS: Have I really done a linear regression with AR(1) noise plus white noise? That is ARMA(1,1) noise? I believe $\kappa={{1-\theta}\over{1-\phi}}$. Given that it is done properly -- either I lucked out, or someone will post a correct version of the STAN code -- how would I use kappa in calculating the larger uncertainty interval around the regression? EDIT: Original code I used, with rstan : temps N ; real x[N] ; real y[N] ; } parameters { real alpha ; real beta ; real kappa ; real sigma ; } model { alpha ~ cauchy (0, 5) ; beta ~ cauchy (0, 5) ; kappa ~ cauchy (0, 5) ; sigma ~ gamma (3, 1) ; y[1] ~ normal (alpha + beta * x[1], sigma) ; for (n in 2:N) { y[n] ~ normal (alpha + beta * x[n] + kappa * y[n-1], sigma) ; } }" stan.list1
