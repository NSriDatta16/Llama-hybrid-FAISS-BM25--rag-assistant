[site]: crossvalidated
[post_id]: 493719
[parent_id]: 
[tags]: 
Generating Poisson-Gamma data for empirical parameter estimation in r

I'm currently trying to learn parameter estimation and want to illustrate and compare different credibility methods (limited fluctuation, Bühlmann, Bühlmann-Straub) using both Bayesian and Empirical parameter estimation (non-parametric, semi-parametric, fully parametric). What I am having trouble with is generating my own data using a Poisson-Gamma in R. For example, if $X_{ij}|\Theta_i$ is Poisson distributed with mean $\Theta_i$ where $\Theta$ is gamma distributed with parameters $\alpha$ and $\beta$ . I want to generate $r$ ( $i=1,...,r$ ) policyholders for $n$ ( $j=1,...,n$ ) years but also want to be able to add past exposures $m_{ij}$ for some simulations but I'm unsure how to code this correctly. Any help would be greatly appreciated! EDIT: I believe I've worked it out but I'm not entirely sure. Below is my code. I am still confused on whether or not I am doing the replications correct. I originally had the first set of code but thought I should keep $\Theta_i$ consistent and also found the function rgpois from the extraDistr package. Any clarification would be greatly appreciated! library(dplyr) set.seed(5) reps I also removed the rgamma and replaced rpois from the above code with the rgpois function. library(dplyr) set.seed(5) reps ```
