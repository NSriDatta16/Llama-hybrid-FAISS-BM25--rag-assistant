[site]: stackoverflow
[post_id]: 3585935
[parent_id]: 3585369
[tags]: 
I guess you need to use the AfterRefresh event. Here is a forum discussion with a happy ending and examples. Pasting the example from the referred page, just for link independence (you should add your timer storage and arithmetic): This code goes on a Module: Dim X As New Class1 Sub Initialize_It() Application.DisplayAlerts = False Application.ScreenUpdating = True diropen = "C:\Desktop\" Workbooks.Open diropen & "Test.xls" , UpdateLinks:=0 Set X.qt = Workbooks("Test.xls").Sheets("Sheet1").QueryTables(1) ActiveWorkbook.RefreshAll End Sub This code goes on a Class Module: Public WithEvents qt As QueryTable Private Sub qt_AfterRefresh(ByVal Success As Boolean) ' Declare variables. Dim a As Integer Dim My_Prompt As String ' Initialize prompt text for message box. My_Prompt = "Data refreshed or canceled." ' Displays message box before refresh (or cancel) occurs. MsgBox My_Prompt ActiveWorkbook.Save Workbooks("Test.xls").Close End Sub
