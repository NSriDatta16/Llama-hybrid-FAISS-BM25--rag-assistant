[site]: crossvalidated
[post_id]: 632611
[parent_id]: 
[tags]: 
What is the expectation of P(x|z) under distribution of z parameterized by x?

This question stems from Section 2.1 of this VAE tutorial . The problem stated in the paper is to compute the data likelihood using law of total probability: $$ P(X) = \int P(X,z) \,\mathrm dz = \int P(X \mid z;\theta) P(z) \,\mathrm d z\,. $$ Paragraph quoted here: For most $z$ , $P(x \mid z)$ will be nearly zero ... This means that we need a new function $Q(z \mid X)$ which can take a value of $X$ and give us a probability over $z$ values that are likely to produce $X$ ... This lets us, for example, compute $\mathbb E_{z \sim Q} P(X \mid z)$ relatively easily. But from the original VAE paper , we know that $Q(z \mid X)$ is used to approximate the posterior $P(z \mid X)$ . So if the approximation is successful, then we may replace $Q(z \mid X)$ with $P(z \mid X)$ and vice versa everywhere. Therefore, the expectation in the quote becomes: $$ \mathbb E_{z \sim Q}[P(X \mid z)] = \int P(X \mid z) Q(z \mid X) \,\mathrm d z = \int P(X \mid z) P(z \mid X) \,\mathrm d z\,. $$ I can't even imagine what the right hand side is!
