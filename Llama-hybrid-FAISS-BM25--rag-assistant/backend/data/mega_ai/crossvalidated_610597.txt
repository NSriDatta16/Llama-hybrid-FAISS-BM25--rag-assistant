[site]: crossvalidated
[post_id]: 610597
[parent_id]: 
[tags]: 
Generalized Difference-In-Difference with join in and drop outs across span of time periods

I have some 23 months of longitudinal data for around 22,000 users. Approximately 2,000 of those users received an intervention during that period - with the intervention occurring during any one of those 23 months. I have mocked up what this data looks like below: The Period represents the usage for that month the User is active, the demographics ( Sex , Age , and BaseUsageScore ) are static throughout the dataset for a particular user, then Trt_Group represents group assignment and Trt_Month represents if that period reflects a period after treatment. Usage is the outcome variable. UserID Period Usage ($) Sex Age BaseUsageScore Trt_Group Trt_Month 56A783 2021-Jan 50 M 52 0.5 1 0 56A783 2021-Feb 80 M 52 0.5 1 0 56A783 2021-Mar 100 M 52 0.5 1 0 56A783 2021-Apr 75 M 52 0.5 1 1 56A783 2021-May 0 M 52 0.5 1 1 30Z790 2021-Jan 65 F 33 0.2 0 0 30Z790 2021-Feb 30 F 33 0.2 0 0 30Z790 2021-March 0 F 33 0.2 0 0 310X17 2022-June 100 M 80 0.8 1 0 310X17 2022-July 124 M 80 0.8 1 1 310X17 2022-Aug 186 M 80 0.8 1 1 310X17 2022-May 184 M 80 0.8 1 1 Some other things to know about the dataset: A user may become active and then de-activate at any point in that 23 month period (though almost all have a continuous string of periods). This coverage is similar across treatment and control. The control group is not demographically representative of the treatment group (younger with less males with lower BaseUsage scores), but I believe these individual differences are handled by the fixed effects model. I am new to DiD, but with what I learned so far I've been toying with the plm package. Below is how I set up my model - since Trt_Month is always 0 for the control group I did not include the Trt_Month*Trt_Group interaction term: plm(Usage ~ Trt_Month, index = c("UserID", "Period"), method = "within", effect = "twoways", data = df) One concern is, since users' span of activity do not universally cover the observed periods that the assumption of parallel trends is violated - or would that only be the case if the span of activity differs between the groups? Another concern (but from my understanding it should be handled by the fixed effects approach) is that a user's group assignment is to some degree influenced by BaseUsageScore . Should I be trying to control for this disparity outside of the model above? Please let me know if any of this needs more clarification or detail.
