[site]: stackoverflow
[post_id]: 4035460
[parent_id]: 4033901
[tags]: 
I'd tell my boss to stop micromanaging. But seriously, sort the data by class, city, and then country. Then compute the running average for each by keeping a running total and count for class, city, and country. When you encounter a different class, write the class name and average to a file. Do the same for cities and countries only use different files for each. Then you can open the sorted data file and the average files and insert rows in the database one by one. If you want to use a framework that will handle all the writing to disk, I would look into using Hadoop for the processing.
