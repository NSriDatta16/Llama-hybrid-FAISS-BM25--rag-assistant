[site]: crossvalidated
[post_id]: 416187
[parent_id]: 
[tags]: 
Bayesian fitting with very noisy data

I am trying to fit a response curve through noisy data. The curve is supposed to model a saturating return, which takes the analytical form: $$ x \to y(x) = \alpha( 1- e^{-\frac{x}{\beta}})$$ where $\alpha$ and $\beta$ are the unknowns, to which we assign normal priors. I am using PyMC3 to sample the prior. The model is: $$ \alpha \propto N(a,b)\\ \beta \propto N(c,d)\\ \varepsilon \propto N(0, \sigma)\\ y(x) = \alpha( 1- e^{-\frac{x}{\beta}}) + \varepsilon $$ This is the output I get from the posterior sampling: I am unhappy with the fact that most data points are not in the 50% confidence band. In my mind, more points (~50%) should fall inside this area. I have played with the parameters $a,b,c,d,\sigma$ with little effect. I am suspecting that the model is wrong. Precisely the culprit could be the distribution I assume for $\varepsilon$ , the departure. I am running out of ideas to debug this. What can I try? As asked this is my model: (mle_alpha, mle_beta), (mle_alpha_unc, mle_beta_unc) = robust_clean_curve_fit(func, x, y_obs ) mle_alpha_unc = min(mle_alpha_unc, 1e5) mle_beta_unc = min(mle_beta_unc, 1e5) obs_std = (func( x, mle_alpha, mle_beta) - y_obs).std() pessimism_factor = 1e2 #5. n_samples = int(1e4) tune_steps = int(1e5) confidence_quartile = 0.5 with pm.Model() as mod: alpha = pm.Normal('alpha', mle_alpha, mle_alpha_unc*pessimism_factor) beta = pm.Normal('beta', mle_beta, mle_beta_unc*pessimism_factor, ) sigma = pm.HalfNormal('sigma', sd=obs_std*pessimism_factor) #sd better be too high than too low!! y = alpha * ( 1. - tt.exp(-x/beta)) Y_obs = pm.Normal('Y_obs', mu=y, sigma=sigma, observed=y_obs) step = pm.NUTS() trace = pm.sample( n_samples, step, tune=tune_steps, chains=12, cores=12) summary_df = pm.summary( trace, var_names=['alpha','beta'], alpha=1-confidence_quartile) FYI robust_clean_curve_fit returns the MLE fitted parameters and rough uncertainties evaluated on the numerical Hessian matrix + chi2 of the fit.
