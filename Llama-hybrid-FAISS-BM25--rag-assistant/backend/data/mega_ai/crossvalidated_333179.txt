[site]: crossvalidated
[post_id]: 333179
[parent_id]: 
[tags]: 
is the computed Hoteling's T square correct?

I am testing the Hoteling Tsquare test on a toy example using scikit learn. I am following the description in this this link . Is the size of the obtained Tsquare values correct? Shouldn't it be a simple vector of size 13? import numpy as np from sklearn.decomposition import PCA from sklearn import preprocessing hald_text = """Y X1 X2 X3 X4 78.5 7 26 6 60 74.3 1 29 15 52 104.3 11 56 8 20 87.6 11 31 8 47 95.9 7 52 6 33 109.2 11 55 9 22 102.7 3 71 17 6 72.5 1 31 22 44 93.1 2 54 18 22 115.9 21 47 4 26 83.8 1 40 23 34 113.3 11 66 9 12 109.4 10 68 8 12 """ hald = np.loadtxt(hald_text.splitlines(), skiprows=1) pca_sklearn=PCA(n_components=4) data=hald data=preprocessing.scale(data) output=pca_sklearn.fit_transform(data) output=pca_sklearn.transform(data.reshape(-1,1)) hoteling_metric=data.dot(pca_sklearn.components_.T).dot(np.diag(1/pca_sklearn.explained_variance_)).dot(pca_sklearn.components_).dot(data.T) print(hoteling_metric)
