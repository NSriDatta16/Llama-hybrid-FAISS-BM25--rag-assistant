[site]: stackoverflow
[post_id]: 319693
[parent_id]: 319672
[tags]: 
You should define GetWindowLongPtr using an IntPtr. In C/C++ a LONG_PTR is 32-bits on a 32-bit system and 64-bits on a 64-bit system (see here ). IntPtr in C# is designed to work the same way (see here ). So what you want is: [DllImport("user32.dll")] private static extern IntPtr GetWindowLongPtr(IntPtr hWnd, int nIndex);
