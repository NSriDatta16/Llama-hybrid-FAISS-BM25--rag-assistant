[site]: datascience
[post_id]: 52393
[parent_id]: 
[tags]: 
How to calculate the elapsed time of a flag status per day?

I'd like to figure out the elapsed time between flag status changes. Simplified example : a person can only be sad or happy. I'd like to know how long each mood was active until it changed. I'm using common storage and a script to loop the records, which is very expensive. I'm looking for a general best practice . I'm open to use any technology in combination or as a replacement. I'm new to data science and probably miss the right terms. Related advices are very appreciated. Index: user_mood_log | changed_at | mood | user | ------------------------------ | yyyy-mm-dd 12:00 | sad | John | | yyyy-mm-dd 15:00 | happy | John | | yyyy-mm-dd 18:00 | happy | John | | ... | ... | ... | Index: user_mood_log_daily | date | sad | happy | user | ------------------------------------- | 2019-05-22 | 3 | 21 | John | | 2019-05-21 | 5 | 19 | John | | ... | ... | ... | ... | Challenges: The last record of yesterday (or even older) needs to be considered. Means I can't simply group by day. A mood might not change for several days. Duplicated mood logs are possible. Any advice? Thanks in advance!
