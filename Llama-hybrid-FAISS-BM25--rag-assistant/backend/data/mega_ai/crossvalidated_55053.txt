[site]: crossvalidated
[post_id]: 55053
[parent_id]: 52109
[tags]: 
The difficulty with doing three t-tests is that one of the null hypotheses is redundant: if we know there is no difference between phenotypes in the proportions of green and blue cells then there can also be no difference between phenotypes in the proportion of red cells, otherwise the proportions would not add up to 1. Solutions are typically based on the log of the relative proportions, i.e. the log of the ratio of the proportion of red cells and green cells, and the log of the ratio of the proportion of blue cells and green cells. This still leaves two strategies: one can model the average proportions, but transform those averages to log relative proportions or one can transform the variables and model the mean log relative proportions. One way to perform the test following the first strategy would be to assume that these proportions are from a Dirichlet distribution , fit the parameters of this distribution with maximum likelihood while allowing those parameters to differ by phenotype, and than test whether those parameters are the same using a Wald test. In Stata this could be done with dirifit . See the example below: . // enter the data . drop _all . . input /// > phen green blue red phen green blue red 1. 1 .3 .28 .42 2. 1 .32 .27 .41 3. 1 .33 .28 .39 4. 2 .10 .50 .40 5. 2 .09 .49 .42 6. 2 .11 .47 .42 7. end . . // test based a Dirichlet distribution . dirifit green blue red, mu(phen) nolog ML fit of Dirichlet (mu, phi) Number of obs = 6 Wald chi2(2) = 867.56 Log likelihood = 38.955704 Prob > chi2 = 0.0000 ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- mu2 | phen | 1.717543 .0583315 29.44 0.000 1.603215 1.83187 _cons | -1.851818 .0841125 -22.02 0.000 -2.016675 -1.68696 -------------+---------------------------------------------------------------- mu3 | phen | 1.169845 .0570941 20.49 0.000 1.057942 1.281747 _cons | -.9195806 .0794159 -11.58 0.000 -1.075233 -.7639284 -------------+---------------------------------------------------------------- /ln_phi | 7.518719 .4081268 18.42 0.000 6.718805 8.318633 -------------+---------------------------------------------------------------- phi | 1842.206 751.8535 827.8277 4099.551 ------------------------------------------------------------------------------ mu2 = blue mu3 = red base outcome = green . test [mu2]_b[phen] = [mu3]_b[phen] = 0 ( 1) [mu2]phen - [mu3]phen = 0 ( 2) [mu2]phen = 0 chi2( 2) = 867.56 Prob > chi2 = 0.0000 An alternative and related approach which still follows the first strategy would be to estimate a fractional multinomial logit using maximum quasi-likelihood followed by a Wald test. In Stata this could be done with fmlogit . . // test based on a fractional multinomial logit . fmlogit green blue red, eta(phen) nolog ML fit of fractional multinomial logit Number of obs = 6 Wald chi2(2) = 670.05 Log pseudolikelihood = -6.0943944 Prob > chi2 = 0.0000 ------------------------------------------------------------------------------ | Robust | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- eta_blue | phen | 1.717445 .0697378 24.63 0.000 1.580762 1.854129 _cons | -1.852482 .085893 -21.57 0.000 -2.020829 -1.684135 -------------+---------------------------------------------------------------- eta_red | phen | 1.16894 .0690569 16.93 0.000 1.033591 1.304289 _cons | -.9187959 .1022304 -8.99 0.000 -1.119164 -.718428 ------------------------------------------------------------------------------ . test [eta_blue]_b[phen] = [eta_red]_b[phen] = 0 ( 1) [eta_blue]phen - [eta_red]phen = 0 ( 2) [eta_blue]phen = 0 chi2( 2) = 670.05 Prob > chi2 = 0.0000 Alternatively, one could follow the second strategy and first transform the variables to log relative proportions and than model model those. This is a strategy proposed by Aitchison (1986[2003]). In Stata that would look like this: . gen blue_green = ln( blue / green ) . . gen red_green = ln( red / green ) . . manova blue_green red_gree = phen Number of obs = 6 W = Wilks' lambda L = Lawley-Hotelling trace P = Pillai's trace R = Roy's largest root Source | Statistic df F(df1, df2) = F Prob>F -----------+-------------------------------------------------- phen | W 0.0074 1 2.0 3.0 201.29 0.0006 e | P 0.9926 2.0 3.0 201.29 0.0006 e | L 134.1916 2.0 3.0 201.29 0.0006 e | R 134.1916 2.0 3.0 201.29 0.0006 e |-------------------------------------------------- Residual | 4 -----------+-------------------------------------------------- Total | 5 -------------------------------------------------------------- e = exact, a = approximate, u = upper bound on F The difference between the two strategies is mainly whether one wants to investigate the relationship among the proportions or the relationship between the proportions and a set of explanatory variables. The challenge when investigating the relationship among proportions is that independence cannot mean a correlation of zero; if the proportion of red cells increases the proportion of other cells has to decrease, otherwise the proportions would no longer add up to 1. So independence means a negative correlation among proportions. The Dirichlet distribution assumes such independence: the proportions are negatively correlated, but only to the extend necessary to fulfill the "mechanical" requirement that proportions add up to 1. The fractional multinomial logit explicitly does not model this correlation among the proportions and solely focuses on the average proportions. So neither model is suited when studying the relationship among proportions. The problem with the second strategy is that in that case one models the mean log relative proportion, rather than the proportions. This makes the interpretation of the model, e.g. the computation of marginal effects, a lot harder than it is in the first strategy. So there are valid uses for both strategies, it just (as always) depends on the research question which one is most useful. My interpretation of the OP is that is closer to a problem fit for the first strategy than the second. J. Aitchison (1986 [2003]) The Statistical Analysis of Compositional Data. Caldwell, NJ: The Blackburn Press.
