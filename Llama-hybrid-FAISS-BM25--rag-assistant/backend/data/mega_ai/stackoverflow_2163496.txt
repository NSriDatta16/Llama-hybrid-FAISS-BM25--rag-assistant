[site]: stackoverflow
[post_id]: 2163496
[parent_id]: 
[tags]: 
Need help with not displaying folders that do not contain anything

I have the following code that displays all folders and files within each folder. The script is within the /intranets/fs/course_outlines/ folder -> default.asp All the folders that this script is looking at are within the /intranets/fs/course_outlines/documents folder Within the script below, it prints the "documents" folder and I am trying to remove that from displaying when it runs thru the for loop. I am familiar with php, so I would know how to stop that from displaying the documents folder from printing with a conditional but I am unfamiliar with ASP Also, the script prints out the html to be in this format: Folder name File name File name etc.. Folder name File name File name etc.. etc.. I ran into some invalid html, which conflicts with a jQuery accordion effect I have applied to each folder & its contents. So any help on it ending with the appropriate closing tag after it prints the very last folder & its contents would be very helpful. Thank you in advanced. Course Outlines "& folder.Name &" " & vbCrLf) 'Display a list of sub folders. for each item in folder.SubFolders ListFolderContents(item.Path) next 'Display a list of files. Response.Write(" " & vbCrLf) for each item in folder.Files url = MapURL(item.path) Response.Write(" " & item.Name & " " & vbCrLf) next Response.Write(" " & vbCrLf) end sub function MapURL(path) dim rootPath, url 'Convert a physical file path to a URL for hypertext links. rootPath = Server.MapPath("/") url = Right(path, Len(path) - Len(rootPath)) MapURL = Replace(url, "\", "/") end function %> Screenshot of how it looks: http://grab.by/23Fq Sample of some of the html it outputs Course Outlines documents APPROVED-2009-Business BU 111 - Nagle.doc BU 112 - Ciccarelli.doc BU 114 - Testa H-Cronauer.doc BU 115 - Testa H-Cronauer.doc TT 251-252-253-254 - Sutton.doc APPROVED-2009-Humanities ED 100 - List.doc ED 110 - List.doc ED 150 - Kelley.doc APPROVED-2009-MAHPES HE 121 - Aragon-Dommer A.doc HE 128 - Howell.doc HE 130 - Aragon.doc SC 261 - Mezik.doc It displays an empty It has nothing within the the ul's, so it seems to run once more before it knows to quick, can you help w/ the code to prevent that. Last Folder to display SS 240 - Verri.doc SS 241 - Verri.doc SS 245 - Elwood.doc SS 246 - Hack Polkosnik.doc
