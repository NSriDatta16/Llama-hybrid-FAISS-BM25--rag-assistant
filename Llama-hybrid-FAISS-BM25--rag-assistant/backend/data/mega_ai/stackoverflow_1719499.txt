[site]: stackoverflow
[post_id]: 1719499
[parent_id]: 1719235
[tags]: 
Try using a CTE (common table expression) that will first define the data you want to get from the sttable table - in the CTE, filter, join, group, etc. on whatever you want to do within the sttable table. Not sure if this will work specifically for what you are trying to do, but it most likely will. If you can provide some additional detail on what you are trying to do (i.e. what are you wanting to do specifically within sttable, filter on certain fields, etc.). Would look something like this: with stData as ( select st.ID, st.field from sttable st where st.field <> 0 -- Add additional filters here and st.someOtherField = something ) SELECT ROW_NUMBER() OVER(ORDER BY orderField) AS RowNum, mt.ID AS mt_ID, mt.title AS mt_title, MAX(st.title) AS st_title, -- Other aggregates (MAX, MIN, AVERAGE, ...) for all other columns -- from sttable, whatever is appropriate. FROM mttable AS mt INNER JOIN stData AS st on mt.ID =st.ID WHERE st.field <> 0 AND mt.title = @title GROUP BY mt.ID, mt.title -- Group by everything else from mttable.
