[site]: crossvalidated
[post_id]: 633142
[parent_id]: 633116
[tags]: 
You want model If you want participant random effects and random "slopes" of difference per participant, as per your stated requirement. The "fs" smooths does much more than add random intercepts; it represents a fully penalized spline basis where all smooths share the one smoothing parameter. As it is fully penalized, s(x, f, bs ="fs") has a penalty for the constant term in the basis (which means we have a random intercept for each level of the f ), another penalty for the linear term in the basis (se we have random slopes of x per level of f ), and then a random smooth function of x per level of f , noting that the x in these smooths must be continuous. The "re" basis only gives a random "slope" if you add a grouping variable and the variable you want random slopes for. In your case you have two factors ( participant and difference ) but this still works, you'll just get a different estimate of difference for each level of participant . If you want a smooth of Learning_stage , you have to state what you want that smooth to do. Right now you have a model that asks for: ~ difference fixed effect for levels of difference, + s(Learning_rate) an average smooth effect of Learning_rate (assuming difference is a normal factor? If it is an ordered factor, things are different), + s(Learning_rate, by = difference) a separate smooth effect of Learning_rate for each level of difference . This smooth almost certainly needs m=1 adding to it to make it more easily identifiable from the "average" smooth effect (2.), and + s(Learning_rate, participant, bs = "fs") a random smooth effect of Learning_rate per participant, with smooths sharing the one wiggliness parameter for the smooths. This term also includes random intercepts per participant and a random slope of Learning_rate as constant and linear terms are in this basis and are fully penalized. You likely don't need m=1 here. This is a lot of smooth effects of Learning_rate ; do you need all of them? There's nothing wrong with the model as you have it, but it is quite a complex starting model.
