[site]: stackoverflow
[post_id]: 4123031
[parent_id]: 
[tags]: 
Deserialize InnerXML to an Object in .NET

I am working with a large xml file containing unbounded collections. The idea is to use XmlReader to read the file and to deserialize the inner xml into an object and do further processing. The XML structure is something like this: 10000 1 Red 2 Green ... 10000 Green Everything goes well using XMLReader wrapping around XMLTextReader to read the file. However when I tried to deserialize individual apple into an object it throws InvaildOperationException. Anyone knows whats the problem? Is there a better way to do it? Here are the code fragments //Deserialize code public object Deserialize(XmlDocument doc, Type type){ using(XmlNodeReader reader - new XmlNodeReader(doc.DocumentElement)){ XmlReaderSetting settings = new XmlReaderSettings(); settings.ValidationType = ValidationType.None; using(XmlReader xReader = XmlReader.Create(reader, settings)){ XmlSerializer serializer = new XmlSerializer(type); object obj = serializer.Deserialize(xReader); } } } public void GetApples(string filepath){ XmlTextReader reader = new XmlTextReader(filepath); while(reader.Read()){ while(reader.NoteType == XmlNodeType.Element && reader.Name == "Apple"){ XmlDocument doc = new XmlDocument(); doc.LoadXml(reader.ReadOuterXml()); Apple a = (Apple)Deserialize(doc, typeof(Apple)); //... } } } //Deserialize code end //Apple class [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")] [System.SerializableAttribute()] [System.Diagnostics.DebuggerStepThroughAttribute()] [System.ComponentModel.DesignerCategoryAttribute("code")] [System.XmlSerialization.XmlTypeAttribute(Namespace="http://AppleFarm.com/Basket")] public partial class Apple{ private string idField; private string colorField; public string Id{ get{ return this.idField; } set{ this.idField = value; } } public string Color{ get { return this.colorField; } set { this.colorField = value; } } } //Apple class end
