[site]: crossvalidated
[post_id]: 282931
[parent_id]: 282789
[tags]: 
It seems a very common misconception about the definition of activation ($a_j$) in neural networks. It is defined in formula 5.48 and 5.49 that $a_j = \sum_i w_{ji}z_i$ and $z_j=h(a_j)$, so it follows $a_j = \sum_i w_{ji}h(a_i)$ instead of the first formula in the post. Then $$\frac{\partial a_k}{\partial a_j}=w_{kj}h'(a_j)$$ $$\frac{\partial E}{\partial a_j}=\sum_k\frac{E}{\partial a_k}\frac{\partial a_k}{\partial a_j}=h'(a_j)\sum w_{kj}\delta_k$$
