[site]: crossvalidated
[post_id]: 108383
[parent_id]: 
[tags]: 
Averaging z scores when doing a "group by"

I have a dataset where each row is an hourly measurement of certain fields (columns). For each column I then add another column that is its respective z score relative to the entire population. If I then group by month by calculating the aggregate mean for all merging rows, are my z scores still valid, or do I need to recalculate the z score for each month? EDIT I realize I wasn't clear enough in my question. I have a dataset like this of hourly weather measurements going back several years: In panda I groupby and average each respective hour (So I average and group all the Jan 1st 2pm rows over all years... etc.) df['hour'] = df['Date'].apply(lambda t: "%d-%d-%d" % (t.month, t.day,t.hour)) g = np.round(df.groupby('hour').mean(),decimals=4).reset_index() which returns this: I then merge the grouped dataframe (g) onto the original df adding a column for each avg, reset the index to be of Date, and drop the 'hour' column from the grouped df: new_df = pd.merge(left=df, right=g, on='hour', suffixes=('','_avg') ) new_df.set_index('Date').drop('hour',axis=1,inplace=False).head() This returns: What I would like however is to also add a "z score" column for each respective month/day/hour using the standard deviation of the entire population. I'm actually now sure how to do this but I think it would be similar to how the other "_avg" columns were computed. Assuming that is all possible and each row-hour has additional z-score columns for each metric this finally leads me to my original question... Later on outside the context of python/panda let's say I take only one year of the data, groupby month, and aggregate by mean. Will those averaged z scores by month still be representative of the original entire population? For example let's say I took the averages of June 2011 and found the temperature z-score to be 1.2. Can I say that the average temperature of June 2011 was 1.2 standard deviations away from the normal (total population) mean?
