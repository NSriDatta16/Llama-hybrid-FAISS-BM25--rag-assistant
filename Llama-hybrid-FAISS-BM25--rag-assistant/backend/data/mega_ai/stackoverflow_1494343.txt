[site]: stackoverflow
[post_id]: 1494343
[parent_id]: 1494253
[tags]: 
Maybe it helps to look at the problem a little differently. Instead of trying to match the line after/before with a regex, try grabbing the entire using "paragraph" itself. Append to that, and finish the file. BEGIN { RS = ""; # Read by "paragraphs". # Records are separated by blank lines. } { if ( NR == 1 ) { print $0,"\n\nnamespace MyNameSpace;\n{"; RS = "\n"; } else { print "\t", $0; # For indenting } } END { print "}"; } Edit: Originally I inserted a "using" directive. He wanted "namespace" (and appropriate syntax): an almost identical problem. Fixed.
