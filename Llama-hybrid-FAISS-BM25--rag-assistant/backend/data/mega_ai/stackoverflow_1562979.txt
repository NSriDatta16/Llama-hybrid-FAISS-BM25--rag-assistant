[site]: stackoverflow
[post_id]: 1562979
[parent_id]: 
[tags]: 
Java JVMTI doesn't work alongside -Xdebug -Xrunjdwp

I spent the last 4 hours trying to set up Eclipse TPTP memory profiling on a Tomcat instance that must be run remotely (i.e. not in Eclipse). This should be possible according to the TPTP and Agent Controller docs. I installed the TPTP components (4.6.0) into my Eclipse (Galileo) workbench, along with the Agent Controller according to the instructions on the website. To enable the agent, I added the following options to the command line that starts the Tomcat instance: -agentlib:JPIBootLoader=JPIAgent:server=enabled;HeapProf:allocsites=true and added the following directories to the front of the PATH: D:\dev\tools\ac\plugins\org.eclipse.tptp.javaprofiler D:\dev\tools\ac\bin When attempting to start Tomcat I consistently got the following error message: ERROR: JDWP unable to get necessary JVMTI capabilities. ["debugInit.c",L279] I did a lot of Googling but found nothing relevant; I tried reinstalling TPTP and various versions of the Agent Controller. In the end the problem turned out to be that I was starting Tomcat with the "jpda" option, which catalina.bat translates into -Xdebug -Xrunjdwp:transport=..... Removing the "jpda" command argument caused JVMTI to start working. SO, the question is: I found nothing during any of my searches to indicate that a JVMTI agent is incompatible with debugging. Can someone explain what is going on and why JVMTI + JDWP is not a valid setup?
