[site]: stackoverflow
[post_id]: 1604558
[parent_id]: 1604476
[tags]: 
See also: http://www.w3schools.com/vbscript/vbscript_looping.asp paxdiablo's answer is right - you don't use End While in VBScript. Your code should look like this: Sub SetText(tx, lw) Dim t, l, r, a t = -1 l = Len(tx) r = "" a = 0 While t = 160 or a=60 or a=62 or a=38 or a=34 or a=39 or a=32 Then If a = 32 Then r = r + "&nbsp;" Else r = r + "&#" + Cstr(a) + ";" End If Else r = r + Mid(tx,t,1) End If Wend ' " + r + " " End If r = " " + r + " " objExplorer.document.body.innerHTML = r End Sub Last I checked, its a legacy control structure and is generally discouraged. Your code should probably really look like this: Sub SetText(tx, lw) Dim t, l, r, a t = -1 l = Len(tx) r = "" a = 0 Do While t = 160 or a=60 or a=62 or a=38 or a=34 or a=39 or a=32 Then If a = 32 Then r = r + "&nbsp;" Else r = r + "&#" + Cstr(a) + ";" End If Else r = r + Mid(tx,t,1) End If Loop If Not lw Then r = " " + r + " " End If r = " " + r + " " objExplorer.document.body.innerHTML = r End Sub Actually, there are probably more changes, but not being familiar with the context of this code that's as far as I'll advise.
