[site]: stackoverflow
[post_id]: 3830739
[parent_id]: 
[tags]: 
Show window with progressbar while doing work

Because I have a tool that needs to do a lot of work at one point, I want to show a window with some text and a progressbar while doing the work. My problem is, that because of the huge load of the work, the window never gets drawn or updated. I know that I usually should use an extra thread for the work, but I have to use 2 collections and the database service from the current thread. The current code is something like StatusWindow SW = new StatusWindow(); StatusViewModel SVM = new StatusViewModel(); SVM.MaxNum = BigNumber; SW.Show(); for (int i=0; i ItemsToCreate = Func1(); List ItemsToDelete = Func2(); foreach (AType cItem in ItemsToCreate) DB.CreateItem(cItem); foreach (AType cItem in ItemsToDelete) DB:DeleteItem(cItem); SVM.CurrentNum = i; } SW.Close(); I also read about the Dispatcher, but i don't think it is very usable in this scenario, since there would be too much access to the main thread. Any suggestions? Thanks
