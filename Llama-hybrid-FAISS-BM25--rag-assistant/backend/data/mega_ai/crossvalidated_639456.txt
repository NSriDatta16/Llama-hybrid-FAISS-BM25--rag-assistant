[site]: crossvalidated
[post_id]: 639456
[parent_id]: 
[tags]: 
Comparing two p-value distributions and obtaining aggregate significance and effect size

PROBLEM DESCRIPTION My data is a population of entities. Each entity is a convex set with a border and an interior, which in turn contain two types of cells. For illustrative purposes, let's say I have green and red balls which can be positioned in the border or interior of a given entity. Each entity can be characterized by the numbers: - $N$ : total number of balls - $G$ : number of green balls - $R$ : number of red balls - $B$ : number of balls at the border - $I$ : number of balls in the interior - $R_B$ : number of red balls at the border - $R_I$ : number of red balls in the interior These numbers satisfy: $N=I+B=R+G$ . I want to test if the data indicate whether there is a tendency of red balls to be at the border. The example entity below has $N=25, G=11, R=14, B=13, I=12, R_B=8, R_I=6$ . NULL DISTRIBUTION AND P-VALUE In general, the border and interior each have a Bernoulli proportion of their balls being red. If there is no relation between colour and placement at the border, then these two proportions are the same, providing us with the null hypothesis $$H_0:\text{ proportion of balls red at the border = proportion of balls red in the interior}=\pi$$ Under $H_0$ , the conditional probability of having $k$ red border balls given that there are $R$ red balls in total is $$P(R_B=k \mid R_B+R_I=R)=\frac{\binom{B}{k} \pi^k (1-\pi)^{B-k}\binom{N-B}{R - k}\pi^{R-k} (1-\pi)^{N-B-R+k}}{\binom{N}{R}\pi^R (1-\pi)^{N-R}}=\frac{\binom{B}{k} \binom{N-B}{R - k}}{\binom{N}{R}}, $$ where $R_B,R_I$ are now random variables and $N,B,R$ are fixed. If red balls prefer the border, then the above hypergeometric distribution should give a small probability for values that are at least as extreme as the observed $R_B$ . We use the p-value $$p=\sum_{k\ge\tilde{R}_B} P(R_B=k \mid R_B+R_I=R),$$ where $\tilde{R}_B$ is the observed value. P-VALUE DISTRIBUTION Note that the above is for a single entity, so if there are $n$ entities, this will result in $n$ p-values. If the null distribution were continuous and identical for all entities, then the distribution of p-values under $H_0$ should be uniform. Then, under $H_0$ , $\alpha$ % of p-values should be below $\alpha$ . If there is more than $\alpha$ % below $\alpha$ , then this would indicate that red balls prefer the border more than in the random (uncorrelated) case. However, we have a discrete probability distribution and each entity has a different null distribution due to differing $N,B,R$ . So instead of assuming a uniform p-value distribution, we first need to construct a reference p-value distribution that is to be expected under the null hypothesis. We did this by drawing a realisation of $R_B$ from the above hypergeometric distribution for each entity (i.e. for each of the $N,B,R$ in the data). So now we have two p-value distributions, one based on the observed $R_B$ and the other based on a randomly drawn $R_B$ . Comparing these should then give an indication of the strength of the tendency of red balls to be at the border. COMPARING OBSERVED AND RANDOM P-VALUE DISTRIBUTIONS One way of doing this is with a Kolmogorov-Smirnov test. However, we are only interested in the left tail of the p-value distribution. More precisely, for a given significance level $\alpha$ , we want to know the proportion of p-values below $\alpha$ . Therefore, we can use the test statistic $$D=F_o(\alpha)-F_r(\alpha),$$ where $F_o,F_r$ are the empirical distribution functions of the observed and random p-value distributions. Positive values mean that red balls are more likely to be at the border. We don't know if this statistic has a closed functional form, so we generated many p-value distributions for the random case and plotted the histogram of $D$ . Doing this for the data, we observe (orange histogram below) that there are only positive values of $D$ and that its histogram does not overlap with the value $D=0$ . So: (1) we can reject the random case, and (2) the positivity of $D$ indicates that red balls are more likely to be at the border than in the random case. QUESTIONS (1) Our choice of performing the test on the scale of the entity was motivated by the availability of an exact (hypergeometric) model for the random (uncorrelated) case. The disadvantage of this choice is that we end up with many p-values, which need interpretation. We managed to do this but the approach feels quite unconventional. Are there any problems with our approach and is there a stronger case for pooling all the borders and interiors together, despite the possibility that this might introduce spurious correlations? Or is there perhaps a more standard method for this? (2) It is also not immediately clear how we should calculate the aggregate effect size. Is this simply the average of the difference in proportions (proportion red at the border minus proportion red in the interior), or should the average be weighted by something related to the sample sizes in each entity?
