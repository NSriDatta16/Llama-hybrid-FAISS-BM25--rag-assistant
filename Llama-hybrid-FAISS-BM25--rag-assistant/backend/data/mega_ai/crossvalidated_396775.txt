[site]: crossvalidated
[post_id]: 396775
[parent_id]: 
[tags]: 
Average Sample Number using Page's CUSUM procedure?

I am trying reproduce the Table 1 results from the page 12 using the equation given the page 13.To access the journal article please click https://arxiv.org/pdf/math/0605322.pdf . The corresponding equation is given below. $$T(\theta_{0},a) = \inf\{n\geq 1 : \max_{1\leq k\leq n}\sum_{i=k}^{n}\log\frac{g_{\lambda}(X_{i})}{f_{\theta_{0}}(X_{i})}\geq a\}$$ When $g_{\lambda}(X_{i})\sim N(0,1)$ and $f_{\theta_{0}}(X_{i}) \sim N(\theta_{0},1)$ where $\theta_{0} = (-0.5,-1.0)$ $$T(\theta_{0},a) = \inf\{n\geq 1 : \max_{1\leq k\leq n}\sum_{i=k}^{n}(-\theta_{0})[X_{i} - \theta_{0}/2]\geq a\}$$ My r code is give below. Am I programmed correctly? mytest=function(n,s,c1){ t = sum(s) k=which.max(s[19:n]>=c1) if(k==1 && s[19] But I am getting the following errors. Error in if (k == 1 && s[19] Thank you very much for your suggestion.
