[site]: stackoverflow
[post_id]: 5109699
[parent_id]: 
[tags]: 
C#: Setting ComboBox text value in SelectedIndexChange event handler?

I have a winform containing a DropDown combobox, where the user can enter a purchase date. The items in the combobox are 'select date', which brings up a calendar so the user can choose a date, 'today' and 'last week'. If the user chooses 'today' or 'last week', I want to set the text value of the dropdown control to that date string. I'm trying to do this in the SelectedIndexChanged handler, but no dice. The DropDown list just shows a blank field. Any ideas? private void comboBoxPurchased_SelectedIndexChanged(object sender, EventArgs e) { Types.ComboInfo info = (Types.ComboInfo)comboBoxPurchased.SelectedItem; DateTime newDate = stock.PurchaseDate; switch ((Types.PurchasedDate)info.id) { case Types.PurchasedDate.PickCustom: //popup a date dialog and let the user choose the date PopupCalendar p = new PopupCalendar(); if (p.ShowDialog() == DialogResult.OK) // show date in combobox newDate = p.Date; break; case Types.PurchasedDate.Today: newDate = DateTime.Now; break; case Types.PurchasedDate.WithinLastWeek: newDate = DateTime.Now.AddDays(-7); break; case Types.PurchasedDate.WithinLastMonth: newDate = DateTime.Now.AddMonths(-1); break; } // re-create combobox items with new purchase date //PopulatePurchaseDateCombo(newDate); comboBoxPurchased.SelectedText = date.ToString("MMMM d, yyyy"); comboBoxPurchased.Text = date.ToString("MMMM d, yyyy"); }
