[site]: stackoverflow
[post_id]: 4282145
[parent_id]: 
[tags]: 
Faster textual data processing in BASH

I've got a speed question. I have a bash script which parses information from TheTvDb.com. It downloads nearly 40,000 lines of data, then reduces it down to about 5000 lines of data which gets written to the hard disk. Then it reads the file and parses it into several files which are used later as a lookup table. It's basically taking all the information it sees before each "/Episode" and writing it to a specific file, then resetting for the next one. It has to synchronize on the "/Episode" tag because there is a "FirstAired" tag outside of the episode tags. This ensures that the data is drawn in sequence rather then depending on each individual tag to be relating to a episode. here is the code in question. if [ -f "$mythicalLibrarian/$NewShowName/$NewShowName.xml" ]; then Ename="" actualEname="" FAired="" SeasonNr="" EpisodeNr="" recordNumber=0 echo "Parsing Downloaded information: $NewShowName.xml " while read line do if [[ $line == \ ]]; then (( ++recordNumber )) echo -ne "Building Record:$recordNumber ${actualEname:0:20} \r" 1>&2 echo "$actualEname" >> "$mythicalLibrarian/$NewShowName/$NewShowName.actualEname.txt"& Ename=`echo "$actualEname" |sed 's/;.*//'` echo "$Ename" >> "$mythicalLibrarian/$NewShowName/$NewShowName.Ename.txt"& echo "$FAired" >> "$mythicalLibrarian/$NewShowName/$NewShowName.FAired.txt"& echo "$SeasonNr" >> "$mythicalLibrarian/$NewShowName/$NewShowName.S.txt"& echo "$EpisodeNr" >> "$mythicalLibrarian/$NewShowName/$NewShowName.E.txt"& Ename="" actualEname="" FAired="" SeasonNr="" EpisodeNr="" #Get actual show name elif [[ $line == \ * ]]; then actualEname=`echo "$line" | sed -e s/' '// -e s/' '// -e s/'\&amp\;'/'\&'/ -e s/'\&quot\;'/'\"'/ -e s/'\&amp\;'/'\&'/ -e s/'\&ndash\;'/'-'/ -e s/'\&lt\;'/'\ '/' |tr -d '|\?\*\ \+\\\[\]\/'` #Get OriginalAirDate elif [[ $line == \ * ]]; then FAired=`echo "$line" | sed -e s/' '//g -e s/' '//g` #Get Season number elif [[ $line == \ * ]]; then SeasonNr=`echo "$line" |sed -e s/' '// -e s/' '//` #Get Episode number elif [[ $line == \ * ]]; then EpisodeNr=`echo "$line" |sed -e 's/ //' -e 's/ //'` fi done >"$mythicalLibrarian"/output.log fi Here is some of the data it is processing |Fred Rogers|Adair Roth|Bert Lloyd|Bud Alder|Carol Saunders|Carole Switala|Deborah Neal Stampo|Don Brockett|Elsie Neal|Emilie Jacobson|Fred Michael|John Reardon|Jos|Judy Rubin|Keith David|Lenny Meledandri|Michael Horton|Robert Trow|Yoshi Ito| 1968-02-01 |Children| PBS &quot;In a little toy neighborhood, a tiny trolley rolls past a house at the end of a street. 30 6843 Mister Rogers' Neighborhood Ended graphical/77750-g.jpg fanart/original/77750-1.jpg SH002930 Change (1) 1 1968-02-19 1 Change (2) 2 1968-02-20 1 Change (3) 3 1968-02-21 1 Change (4) 4 1968-02-22 1 Change (5) 5 1968-02-23 1 Show 6 6 1968-02-26 1 Show 7 7 1968-02-27 1 Show 8 8 1968-02-28 1 Show 9 9 1968-02-29 1 Show 10 10 1968-03-01 1 Show 11 11 1968-03-04 1 Show 12 12 1968-03-05 1 Show 13 13 1968-03-06 1 Show 14 14 1968-03-07 1 Show 15 15 1968-03-08 1 Welcome Donkey Hodie (1) 16 1968-03-11 1 Welcome Donkey Hodie (2) 17 1968-03-12 1 Welcome Donkey Hodie (3) 18 1968-03-13 1 Welcome Donkey Hodie (4) 19 1968-03-14 1 Welcome Donkey Hodie (5) 20 1968-03-15 1 Show 21 21 1968-03-18 1 Show 22 22 1968-03-19 1 Show 23 23 1968-03-20 1 Show 24 24 1968-03-21 1 Show 25 25 1968-03-22 1 Show 26 26 1968-03-25 1 Show 27 27 1968-03-26 1 Show 28 28 1968-03-27 1 Show 29 29 1968-03-28 1 Show 30 30 1968-03-29 1 Red Monster (1) 31 1968-04-01 1 Red Monster (2) 32 1968-04-02 1 Red Monster (3) 33 1968-04-03 1 Red Monster (4) 34 1968-04-04 1 Red Monster (5) 35 1968-04-05 1 Show 36 36 1968-04-08 1 Show 37 37 1968-04-09 1 Show 38 38 1968-04-10 1 Show 39 39 1968-04-11 1 Show 40 40 1968-04-12 1 Show 41 41 1968-04-15 1 Show 42 42 1968-04-16 1 Show 43 43 1968-04-17 1 Show 44 44 1968-04-18 1 Show 45 45 1968-04-19 1 Show 46 46 1968-04-22 1 Show 47 47 1968-04-23 1 Show 48 48 1968-04-24 1 Show 49 49 1968-04-25 1 Show 50 50 1968-04-26 1 Show 51 51 1968-04-29 1 Show 52 52 1968-04-30 1 Show 53 53 1968-05-01 1 Show 54 54 1968-05-02 1 Show 55 55 1968-05-03 1 Show 56 56 1968-05-06 1 Show 57 57 1968-05-07 1 Show 58 58 1968-05-08 1 Show 59 59 1968-05-09 1 Show 60 60 1968-05-10 1 Show 61 61 1968-05-13 1 Show 62 62 1968-05-14 1 Show 63 63 1968-05-15 1 Show 64 64 1968-05-16 1 Show 65 65 1968-05-17 1 Show 66 66 1968-05-20 1 Show 67 67 1968-05-21 1 Show 68 68 1968-05-22 1 Show 69 69 1968-05-23 1 Show 70 70 1968-05-24 1 Show 71 71 1968-05-27 1 Show 72 72 1968-05-28 1 The problem is that on a i7 processor this takes 14.5 seconds. It is about 10x slower on my media center. I tried using a case statement which takes 15 seconds on the fast processor. I would like to know about how to speed this process up. It seems that this is ridiculously slow for BASH which is supposed to be designed around data manipulation and file operations.
