[site]: stackoverflow
[post_id]: 1319849
[parent_id]: 
[tags]: 
Setting dllimport programmatically in C#

I am using DllImport in my solution. My problem is that I have two versions of the same DLL one built for 32 bit and another for 64 bit. They both expose the same functions with identical names and identical signatures. My problem is that I have to use two static methods which expose these and then at run time use IntPtr size to determine the correct one to invoke. private static class Ccf_32 { [DllImport(myDllName32)] public static extern int func1(); } private static class Ccf_64 { [DllImport(myDllName64)] public static extern int func1(); } I have to do this because myDllName32 and myDllName64 must be constant and I have not found a way to set it at run time. Does anyone have an elegant solution for this so I could get rid of the code duplication and the constant IntPtr size checking. If I could set the file name, I would only have to check once and I could get rid of a ton of repeated code.
