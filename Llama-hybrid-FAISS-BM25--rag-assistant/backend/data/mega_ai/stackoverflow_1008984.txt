[site]: stackoverflow
[post_id]: 1008984
[parent_id]: 
[tags]: 
Implement file dragging to the desktop from a .net winforms application?

I have a list of files with their names in a listbox and their contents stored in an SQL table and want the user of my app to be able to select one or more of the filenames in the listbox and drag them to the desktop, yielding the actual files on the desktop. I can't find any documentation on how to do this. Can anyone explain or point to an explanation? Added later: I've been able to make this work by handling the DragLeave event. In it I create a file in a temporary directory with the selected name and the contents pulled from SQL Server. I then put the path to the file into the object: var files = new string[1]; files[0] = "full path to temporary file"; var dob = new DataObject(); dob.SetData(DataFormats.FileDrop, files); DoDragDrop(dob, DragDropEffects.Copy); But this seems very inefficient and clumsy, and I have not yet figured out a good way to get rid of accumulated temp files.
