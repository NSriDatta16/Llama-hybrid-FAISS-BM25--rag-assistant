[site]: crossvalidated
[post_id]: 638588
[parent_id]: 
[tags]: 
Regression model with 3 outputs and different dataset to train each of them

In general I want to predict 3 parameters ISO, aperture and exposure from photo. I was thinking about using cnn with regression. Despite of fact that this is hard task, my minor problem is with datasets, because it is difficult to find or even create a one balanced dataset where each value of each parametr will be represented by similar amount of pictures. So I create a 3 of them, they depends on the same pictures, but are balanced depends on value for parameter. So for example, ISO dataset has balanced amount of pictures for 100, 120, 160, 200 etc. In structure they are looking the same. I had an idea, and i feel that it isn't good one, to learn model on 3 different database, but separate for each of label. So I chose pre-trained model, added separate prepare module for each of label to generate output, each of label had own optimizer dedicated to their regression module. Something like this: optimizer_iso = optim.Adam(model.head_iso.parameters(), lr=0.00003) optimizer_aperture = optim.SGD(model.head_aperture.parameters(), lr=1e-6, momentum=0.9) optimizer_exposure = optim.SGD(model.head_exposure.parameters(), lr=0.00003, momentum=0.8) ###### for batch in iso_train: # there are getting images and labels from dataset iso_out, aperture_out, exposure_out = model(images) loss_iso = criterion_iso(iso_out, labels_iso) mae_iso = calculate_mae(iso_out, labels_iso) total_mae_iso += mae_iso for batch in aperture_train: # there are getting images and labels from dataset iso_out, aperture_out, exposure_out = model(images) loss_aperture = criterion_aperture(aperture_out, labels_aperture) mae_aperture = calculate_mae(aperture_out, labels_aperture) total_mae_aperture += mae_aperture for batch in exposure_train: # there are getting images and labels from dataset iso_out, aperture_out, exposure_out = model(images) loss_exposure = criterion_iso(exposure_out, labels_exposure) mae_exposure = calculate_mae(exposure_out, labels_exposure) total_mae_exposure += mae_exposure I tried to find similar problem in Internet, but find nothing special. I have some questions: Do I should have one optimizer for whole model or just leave it as is it? I mean, right now i am thinking that i should train this pre-trained model too Did I made mistake to not train whole parameters set with each of datasets? Learning on one non balanced datasets will be better than this? Maybe someone has something related with this problem which I could read.
