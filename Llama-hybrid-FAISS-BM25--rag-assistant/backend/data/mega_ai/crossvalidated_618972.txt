[site]: crossvalidated
[post_id]: 618972
[parent_id]: 
[tags]: 
How to write the likelihood for a multivariate gaussian linear model

I have a lasso-like bayesian graphical model where we try to estimate precision matrices between two conditions (0 and 1), $\Sigma_0^{-1}$ and $\Sigma_1^{-1}$ , respectively. The model can be summarized as a multivariate linear model with J outcomes. Thus, we want to estimate diagonal elements ( $s_{jj}$ ) and off-diagonal elements ( $s_{jj'}$ ) of the matrices $\Sigma_0^{-1}$ and $\Sigma_1^{-1}$ , the variance and covariance between the J outcomes in the two conditions. Mathematically $\Sigma_0^{-1}$ and $\Sigma_1^{-1}$ are of dimensions JxJ. Formally the likelihood for the model can be expressed as: $$ \prod_{i=1}^N |((1-z_i)\Sigma_0^{-1}+z_i\Sigma_1^{-1})|^{\frac{1}{2}}\exp\{(W_{i.}-X_{i.}\beta)((1-z_i)\Sigma_0^{-1}+z_i\Sigma_1^{-1})(W_{i.}-X_{i.}\beta)^T\} $$ with $i = 1,2..,N$ is the number of individuals, $z_i = 0$ if the individual i belongs to the condition 0, 1 otherwise. Also, $W_{i.} = [W_{i1}, W_{i2}, ..., W_{iJ}]$ and $X_{i.} = [X_{i1}, X_{i2}, ..., X_{iK}]$ are vectors of size J and K, corresponding to the J outcomes and the K adjusting variables, respectively. $\beta$ is a matrix of size KxJ of variable effect. We put an exponential prior on variance elements and a double exponential prior on covariance elements. We assume the same prior in both $\Sigma_0^{-1}$ and $\Sigma_1^{-1}$ . Formally for the jth outcome the variance $s_{jj} \sim \exp(\lambda0.5)$ and for the jth and j'th outcome the covariance $s_{jj'} \sim Laplace(0, \lambda^{-1})$ . My aim here is to re-express the model with respect to pairwise covariance elements. Indeed, I would like to reconciliate the notation between the original model and the prior for variance and covariance terms. I firstly proposed to rewrite the original model multiplying over the J outcomes: $$ \prod_{i=1}^N \prod_{j=1}^J ((1-z_i)s_{0_{jj}}+z_is_{1_{jj}})^{-\frac{1}{2}}\exp\{(W_{ij}-X_{i.}\beta_{.j})((1-z_i)s_{0_{jj}}^{-1}+z_is_{1_{jj}}^{-1})(W_{ij}-X_{i.}\beta_{.j})^T\} $$ Thus, following https://www.math.wustl.edu/~sawyer/handouts/multivar.pdf I tried to re-express the model by multiplying over index j and j', while putting index K in the notation: $$ \prod_{i=1}^N \prod_{j=1}^J \prod_{j'=1}^J \prod_{k=0}^{K+1} ((1-z_i)s_{0_{jj'}}+z_is_{1_{jj'}})^{-\frac{1}{2}}\exp\{(W_{ij'}-X_{ik}\beta_{kj'})((1-z_i)s_{0_{jj'}}^{-1}+z_is_{1_{jj'}}^{-1})(W_{ij}-X_{ik}\beta_{kj})\} $$ However I have some trouble to tell whether the original model is the same as the last equation i.e., a quadruple product. If not, how can I re-express this model in terms of index? I am not used to work with these models I find difficult to grab. Please let me know if anything is unclear. Any guidance will be appreciated.
