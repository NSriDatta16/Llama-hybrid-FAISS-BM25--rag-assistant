[site]: datascience
[post_id]: 33468
[parent_id]: 
[tags]: 
How to prevent pd.ewma from changing the index?

I am resampling my time series data using the following code: bars = transactions.price.resample('4H', base = 3).ohlc() This allows me to account for DST correctly. The output is: timestamp 2017-12-31 07:00:00 12668.5 2017-12-31 11:00:00 13183.0 2017-12-31 15:00:00 13124.0 2017-12-31 19:00:00 13178.5 2017-12-31 23:00:00 13130.5 I now want to calculate moving average using pandas .rolling function and trying the following: ma_rolling = pd.ewma(bars['close'], span=20, freq='4H') This messes up the time interval, shifting it to even hours: timestamp 2017-12-31 04:00:00 14006.251358 2017-12-31 08:00:00 13927.838526 2017-12-31 12:00:00 13851.275461 2017-12-31 16:00:00 13787.196295 2017-12-31 20:00:00 13724.649100 Is it possible to specify a base / shift in ewma functions and to preserve the original indices? The .rolling function does not act like this and preserves original indices.
