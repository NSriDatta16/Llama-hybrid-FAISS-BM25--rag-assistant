[site]: stackoverflow
[post_id]: 5003336
[parent_id]: 5003077
[tags]: 
You are mixing Rhino mock syntaxes. I would use the new AAA syntax. It's much easier. INotifyMessageSender messageSenderMock = MockRepository.GenerateMock (); NotificationAgent notificationAgent = new NotificationAgent(Guid.NewGuid(), messageSenderMock); notificationAgent.Start(); messageSenderMock.AssertWasCalled(x => x.SendRegisterNodeMessage(machineID));
