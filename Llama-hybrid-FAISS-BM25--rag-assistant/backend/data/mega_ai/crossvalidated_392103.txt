[site]: crossvalidated
[post_id]: 392103
[parent_id]: 
[tags]: 
Plot confidence interval of average polynomial fit from coefficients

I am studying the propagation of a wave and to do that I want to follow the position of my maxima over time. In order to do that I thought to fit a polynomial on the data of each replicate, then save the coefficients of each polynomial and then calculate an average polynomial by averaginf the coefficients. I am doing this in this way: First I fit a 6th grade polynomial on my data model0 $meand ~ poly(tdfmean2$ alltimes,6, raw = T) -1) the -1 forces the poly to pass from 0,0 ,tdfmean2 is my data frame, meand is the mean position of the max at each time point and alltimes in the column with the time then I can extract the coefficients of my model cf0 = coef(model0) cf0 and then I can rebuild an equation and save some value to plot my curve for this replicate. xm What I want to do next is to store the coefficients of each replicate and then calculate the average coefficients across all replicates: NA. genotype sample_name condition coeff1 coeff2 coeff3 coeff4 coeff5 coeff6 1 1 col0 2 no treatment 10.645219 -0.27991785 0.0046284484 -4.157269e-05 1.822185e-07 -3.048687e-10 2 2 col0 3 no treatment 10.553457 -0.21942501 0.0020468207 -4.675756e-06 -3.078219e-08 1.234126e-10 3 3 col0 5 no treatment 11.318681 -0.22596993 0.0028321289 -2.070399e-05 7.901194e-08 -1.206557e-10 4 4 col0 6 no treatment 10.416127 -0.19350901 0.0023198163 -1.613161e-05 5.853231e-08 -8.562595e-11 5 5 col0 7 no treatment 10.365075 -0.24591990 0.0036110039 -2.861296e-05 1.131259e-07 -1.757093e-10 6 6 col0 8 no treatment 8.073907 -0.13986866 0.0015194720 -9.020292e-06 2.749597e-08 -3.435694e-11 7 7 col0 9 no treatment 10.951157 -0.23504111 0.0031379152 -2.335273e-05 8.910691e-08 -1.361389e-10 8 8 col0 11 no treatment 7.907365 -0.12264808 0.0005476001 8.681364e-06 -8.824417e-08 2.153590e-10 9 9 col0 12 no treatment 7.956929 -0.08984904 0.0005133731 -6.733359e-07 -5.829500e-09 1.836931e-11 10 10 col0 13 no treatment 10.092490 -0.18451556 0.0021726107 -1.450010e-05 4.973589e-08 -6.802710e-11 11 11 col0 15 no treatment 7.752161 -0.09695462 0.0008062611 -3.613068e-06 6.129860e-09 1.226553e-12 12 12 col0 16 no treatment 9.158635 -0.16035016 0.0018217135 -1.214841e-05 4.368299e-08 -6.493449e-11 13 13 col0 18 no treatment 9.816227 -0.19022842 0.0023592866 -1.664531e-05 6.099036e-08 -9.028776e-11 14 14 col0 19 no treatment 10.460419 -0.17301229 0.0018772190 -1.259279e-05 4.806232e-08 -7.796818e-11 15 15 col0 20 no treatment 8.989490 -0.20399518 0.0030250021 -2.412503e-05 9.513354e-08 -1.459567e-10 16 16 col0 21 no treatment 6.971790 -0.10011748 0.0010670835 -6.887514e-06 2.416397e-08 -3.570303e-11 17 17 col0 22 no treatment 7.408617 -0.11316713 0.0009324162 -2.494966e-06 -5.535340e-09 2.669259e-11 18 18 col0 23 no treatment 6.975045 -0.02370698 -0.0009177655 1.306468e-05 -6.568632e-08 1.154866e-10 19 19 col0 25 no treatment 7.505218 -0.02504451 -0.0008343186 1.173565e-05 -5.824071e-08 1.010885e-10 20 20 col0 27 no treatment 7.885268 -0.08297538 0.0002999775 2.714420e-06 -2.549118e-08 5.613721e-11 dfcol0_long % group_by(key)%>% summarise(mean= mean(value), sd= sd(value), max = max(value),min = min(value))) > dfcol0_m key mean sd max min 1 coeff1 9.060164e+00 1.469654e+00 1.131868e+01 6.971790e+00 2 coeff2 -1.553108e-01 7.210264e-02 -2.370698e-02 -2.799179e-01 3 coeff3 1.688303e-03 1.420367e-03 4.628448e-03 -9.177655e-04 4 coeff4 -1.007772e-05 1.393039e-05 1.306468e-05 -4.157269e-05 5 coeff5 2.987906e-08 6.639202e-08 1.822185e-07 -8.824417e-08 6 coeff6 -3.412303e-11 1.207775e-10 2.153590e-10 -3.048687e-10 At this point, I can rebuild my average polynomial using those coeffficients and plot it. But I would also like it to have a shaded area around the curve that denotes the confidence interval. Is that possible to do starting from these data? I tried to plot wit a ribbon using the code below, but the result is a disaster and the shaded area in unreasonably wide, covering an aread that is well far away from the place where all my replicates are. Any idea why is this happening? upperCF $mean + dfcol0_m$ sd lowerCF $mean - dfcol0_m$ sd dfcol0_m dfcol0_m key mean sd max min upperCF lowerCF 1 coeff1 9.060164e+00 1.469654e+00 1.131868e+01 6.971790e+00 1.052982e+01 7.590510e+00 2 coeff2 -1.553108e-01 7.210264e-02 -2.370698e-02 -2.799179e-01 -8.320817e-02 -2.274135e-01 3 coeff3 1.688303e-03 1.420367e-03 4.628448e-03 -9.177655e-04 3.108670e-03 2.679360e-04 4 coeff4 -1.007772e-05 1.393039e-05 1.306468e-05 -4.157269e-05 3.852664e-06 -2.400811e-05 5 coeff5 2.987906e-08 6.639202e-08 1.822185e-07 -8.824417e-08 9.627107e-08 -3.651296e-08 6 coeff6 -3.412303e-11 1.207775e-10 2.153590e-10 -3.048687e-10 8.665450e-11 -1.549006e-10 xm
