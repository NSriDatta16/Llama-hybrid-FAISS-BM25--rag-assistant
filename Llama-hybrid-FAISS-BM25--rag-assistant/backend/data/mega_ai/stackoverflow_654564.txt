[site]: stackoverflow
[post_id]: 654564
[parent_id]: 654425
[tags]: 
Say we want to have 3 timespand and the average of "value" in that span. First we determine the periods.. start-end,start-end,start-end etc This you can do in your own code so I use parameters. In this example we also group by 'server' but you can add extra columns or remove it. DECLARE @startdate1 as DateTime DECLARE @enddate1 as DateTime DECLARE @startdate2 as DateTime DECLARE @enddate2 as DateTime DECLARE @startdate3 as DateTime DECLARE @enddate3 as DateTime SELECT CASE WHEN time >= @startdate1 AND time = @startdate2 AND time = @startdate3 AND time = @startdate1 AND time = @startdate2 AND time = @startdate3 AND time
