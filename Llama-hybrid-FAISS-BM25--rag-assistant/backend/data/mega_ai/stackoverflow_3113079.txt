[site]: stackoverflow
[post_id]: 3113079
[parent_id]: 3105664
[tags]: 
== Assumed Tables == orders (id, country_id, state_id) orders_products (id, order_id, product_id, price) == Queries == Total sales: SELECT country_id, state_id, SUM(price) FROM orders_products op, orders o WHERE op.order_id = o.id GROUP BY country_id, state_id Average Sale Amount: SELECT country_id, state_id, AVG(price) * COUNT(order_id) FROM orders_products op, orders o WHERE op.order_id = o.id GROUP BY country_id, state_id, order_id The % of total sales per state/country: SELECT country_id, state_id, SUM(price) * 100 / (SELECT SUM(price) FROM orders_products op2) FROM orders_products op, orders o WHERE op.order_id = o.id GROUP BY country_id, state_id
