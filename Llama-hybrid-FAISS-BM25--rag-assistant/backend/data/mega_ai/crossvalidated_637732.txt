[site]: crossvalidated
[post_id]: 637732
[parent_id]: 
[tags]: 
Do you change the mean / standard deviation when calculating the unbiased normalised autocorrelation function?

I am trying to calculate the unbiased normalised autocorrelation function. I think this field is a little complicated as different sources appear to use different nomenclature to describe the same thing, and the same nomenclature to describe different things, so I will try to be specific in what I mean. I want to perform the autocorrelation for a discrete time series $x[n]=(x_1,x_2,x_3...x_N)$ as a function of time-lag $\tau$ , where $\tau$ is an integer. The autocorrelation function I would use is $$\mathrm{AC}[\tau]=\frac{1}{N-\tau}\sum_{n=1}^{N} \frac{(x[n]-\bar{x})*(x[n+\tau]-\bar{x})}{\sigma_x^2}$$ where $\bar{x}=\frac{1}{N}\sum_{n=1}^N x[n]$ and $\sigma_x=\sqrt{\frac{1}{N}\sum_{n=1}^N(x[n]-\bar{x})^2}$ are the mean and standard deviation, respectively $^\mathrm{*}$ . For $\tau=0$ there is no time lag, the signal perfectly overlaps with itself, and the value is normalised to 1. For a lag of $\tau=1$ , there is now an element from each side of the signal that no longer overlaps, for $\tau=2$ there are now two elements that don't overlap, etc. Should I just use the same value of $\bar{x}$ and $\sigma_x$ for all $\tau$ , or should I recalculate $\bar{x}$ and $\sigma_x$ to only include the elements that overlap? So in my image below, when $\tau=2$ , should I re-calculate the mean and standard deviation using only elements 3-11 and 1-9? Diagram showing signal overlap in autocorrelation calculation for a signal with 11 elements, and $\tau$ = 0, 1, and 2. My instinct is no, and use elements 1-11 for all $\tau$ , but when I do, I no longer have an autocorrelation function that is bound between -1 and 1, see my specific example below. Autocorrelation function using the same mean and standard deviation for all $\tau$ which is not bound between 1 and -1. Note here, $\tau$ in the x-axis is not number of elements, but is instead time. As sampling frequency is 4MHz, a displacement of 4 elements is 1 $\mu$ s. $N$ =4096 in this example. *I know that if I'm using a sample of the time series rather tha the whole thing I should divide by $N-1$ in the calculation of the standard deviation, but N>>1 in my work, so I leave that out for simplicity's sake).
