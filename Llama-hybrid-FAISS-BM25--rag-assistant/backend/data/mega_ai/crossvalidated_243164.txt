[site]: crossvalidated
[post_id]: 243164
[parent_id]: 
[tags]: 
Computing the marginal MAP estimate

Suppose I have some IID Gaussian data with priors for mean and standard deviation: \begin{align} P(x|\mu,\sigma)&=\prod_{i=1}^n\frac{1}{\sqrt{2\pi\sigma^2}}e^\frac{-(x_i-\mu)^2}{2\sigma^2}\\ p(\mu) &= e^{-\mu},\hspace{3mm}\mu\in(0,\infty)\\ p(\sigma) &= \frac{1}{\sigma^2},\hspace{3mm}\sigma\in(1,\infty) \end{align} Then suppose I want to evaluate the marginal MAP estimate: $$\max_{\mu}p(\mu|x)$$ Then I need to compute said marginal distribution \begin{align} p(\mu|x)\propto p(x|\mu)p(\mu)&=\int p(x|\mu,\sigma)p(\mu)p(\sigma)d\sigma\\ &=\frac{e^{-\mu}}{(2\pi)^\frac{n}{2}}\int_1^\infty\frac{1}{\sigma^{n+2}}\prod_{i=1}^ne^\frac{-(x_i-\mu)^2}{2\sigma^2}d\sigma \end{align} Supposing that this integral is intractable to compute analytically, I instead apply Laplace's method: \begin{align} \frac{e^{-\mu}}{(2\pi)^\frac{n}{2}}\int_1^\infty\frac{1}{\sigma^{n+2}}\prod_{i=1}^ne^\frac{-(x_i-\mu)^2}{2\sigma^2}d\sigma&=\frac{e^{-\mu}}{(2\pi)^\frac{n}{2}}\int_1^\infty e^{(n+2)(-\log\sigma-\frac{1}{2(n+2)\sigma^2}\sum_{i=1}^n(x_i-\mu)^2)}d\sigma\\ &=\frac{e^{-\mu}}{(2\pi)^\frac{n}{2}}\int_1^\infty e^{(n+2)f(\sigma)}d\sigma \end{align} where $$f(\sigma)=-\log\sigma-\frac{1}{2(n+2)\sigma^2}\sum_{i=1}^n(x_i-\mu)^2$$ The minimum value of $f(\sigma)$ is given by $$\sigma_0=\sqrt{\frac{1}{n+2}\sum_{i=1}^n(x_i-\mu)^2}$$ and furthermore, \begin{align} f(\sigma_0) &= -\log\sigma_0 - \frac{1}{2}\\ f''(\sigma_0) &= \frac{-2}{\sigma_0^2} \end{align} Thus by Laplace's method: \begin{align} \frac{e^{-\mu}}{(2\pi)^\frac{n}{2}}\int_1^\infty e^{(n+2)f(\sigma)}d\sigma&\approx\frac{e^{-\mu}}{(2\pi)^\frac{n}{2}}\sqrt{\frac{2\pi}{(n+2)\left|f''(\sigma_0)\right|}}e^{(n+2)f(\sigma_0)}\\ &=\frac{e^{-\mu}}{(2\pi)^\frac{n}{2}}\sqrt{\frac{\pi\sigma_0^2}{(n+2)}}e^{-(n+2)(\log\sigma_0+\frac{1}{2})} \end{align} Optimizing this last expression for $\mu$, we obtain: $$\hat{\mu}=\frac{2\sum_{i=1}^nx_i-n^2Â±\sqrt{(n^2-2\sum_{i=1}^nx_i)^2-4n(\sum_{i=1}^nx_i^2-n\sum_{i=1}^nx_i)}}{2n}$$ My point with all this is I would now like to use some other method to verify the correctness of Laplace's method, but I have had trouble finding relevant information on how to use MCMC or some EM, VB or message passing variant for calculating marginal MAP estimates. Can anyone show me another way to calculate this?
