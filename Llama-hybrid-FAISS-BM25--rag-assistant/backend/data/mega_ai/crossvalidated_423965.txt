[site]: crossvalidated
[post_id]: 423965
[parent_id]: 423850
[tags]: 
Let $\mathbf{K} = \{ K_h | h \in \mathbb{N}_{0+} \}$ denote the stochastic time-series showing the number of infected people after each handshake, and let $K_0 = 1$ at the start of the series. This is a Markov chain that falls within the category of discrete "pure birth" processes". A single random handshake gives the transition probabilities: $$p_{k,k+r} \equiv \mathbb{P}( K_{h+1} = k+r | K_h = k ) = \begin{cases} 1-\frac{2k(N-k)}{N(N-1)} & & \text{if } r=0, \\[6pt] \frac{2k(N-k)}{N(N-1)} & & \text{if } r=1, \\[8pt] 0 & & \text{otherwise}. \\[6pt] \end{cases}$$ Thus, the transition matrix for the chain is: $$\mathbf{P} \equiv \begin{bmatrix} 1-\frac{2}{N} & \frac{2}{N} & \cdots & 0 & 0 & 0 \\ 0 & \frac{4(N-2)}{N(N-1)} & \cdots & 0 & 0 & 0 \\ \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\ 0 & 0 & \cdots & 1-\frac{4(N-2)}{N(N-1)} & \frac{4(N-2)}{N(N-1)} & 0 \\ 0 & 0 & \cdots & 0 & 1-\frac{2}{N} & \frac{2}{N} \\ 0 & 0 & \cdots & 0 & 0 & 1 \\ \end{bmatrix}.$$ After $h$ random handshakes, the probability that $k$ people are infected is: $$\mathbb{P}(K_{h} = k) = [\mathbf{P}^{h}]_{1,k}.$$ You can compute this probability by programming the transition probability matrix into an appropriate piece of mathematical software (e.g., R ) and then obtaining the first row of the appropriate power of the matrix. If you would like to try to get a closed-form expression for the probability, I would recommend deriving the eigen-decomposition or Jordan decomposition of the matrix to see if this simplifies the problem. Computing the probability vector: It is quite simple to program this Markov chain in R . In the code below I create a function to compute the vector of probabilities (or log-probabilities) for arbitrary input values for the number of people and the number of handshakes. #Load required library library(expm); #Create a function to compute the probability vector COMPUTE_PROBS We can use this function to compute the vector of probailities (or log-probabilities) for arbitrary values of N and h . Here is an example using some chosen values for the parameters. #Compute an example of this probability vector N Monte-Carlo simulation: We can confirm that the above result is correct by comparing the theoretical probabilities to Monte-Carlo simulations of the process. To do this, we can program a simulation function in R . (Hat tip to user2974951 for suggesting this approach, and writing the initial code.) In the code below I create a function to simulate outcomes of the chain and take empirical estimates of the vector of probabilities for arbitrary input values for the number of people and the number of handshakes. #Create a function to simulate the chain SIMULATE_CHAIN Using this function we can simulate the Markov chain and take empirical estimates of the probabilities of each outcome. The plot confirms the same shape we obtained in our theoretical analysis, which confirms that the calculations are correct. #Simulate the chain set.seed(1) SIMS
