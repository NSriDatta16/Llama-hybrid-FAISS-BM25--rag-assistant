[site]: stackoverflow
[post_id]: 1809383
[parent_id]: 1809174
[tags]: 
You do have a tough (but not uncommon) situation. As far as organizing the code to minimize bugs, all I can give is a tip of the cap to DRY. For performance issues, those are easy to find, because their very slowness shows them to you, by this technique .
