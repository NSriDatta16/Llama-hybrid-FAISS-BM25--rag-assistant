[site]: stackoverflow
[post_id]: 5613773
[parent_id]: 5613728
[tags]: 
You need to alias your derived table, you must also use a group by with a having clause. SELECT q1.Period, q1.PCC, SUM(q1.BasicHits), SUM(q1.FareHits), SUM(q1.SearchHits) FROM (SELECT AAAPeriod AS Period, AAAFromPCC AS PCC, - SUM(AAABasic) AS BasicHits, - SUM(AAAFare) AS FareHits, - SUM(AAASearch) AS SearchHits FROM HitsAaa GROUP BY AAAPeriod, AAAFromPCC HAVING (AAAPeriod = N'2010-10') UNION ALL SELECT AAAPeriod AS Period, AAAtoPCC AS PCC, SUM(AAABasic) AS BasicHits, SUM(AAAFare) AS FareHits, SUM(AAASearch) AS SearchHits FROM HitsAaa GROUP BY AAAPeriod, AAAtoPCC HAVING (AAAPeriod = N'2010-10') UNION ALL SELECT AgtPeriod AS Period, AgtPcc AS PCC, SUM(AgtBasic) AS BasicHits, SUM(AgtFare) AS FareHits, SUM(AgtSearch) AS SearchHits FROM HitsAgent GROUP BY AgtPeriod, AgtPCC HAVING (AgtPeriod = N'2010-10')) q1 GROUP BY q1.Period, q1.PCC
