[site]: stackoverflow
[post_id]: 3958199
[parent_id]: 3856002
[tags]: 
To send email notifications from agent jobs in SQL Server Agent, the alarm system must be activated. We did that. After restarting the agent, the Database Mail system should be used. Unfortunately, this does not work. The agent was still trying to reach a Mapi profile (as in SQL 2000). The following registry value wasn't set: "UseDatabaseMail"=dword:00000001 After setting it to 1 , the database mail system was used. You can do that in SQL server, directly: EXEC master.dbo.xp_instance_regwrite N'HKEY_LOCAL_MACHINE', N'SOFTWARE\Microsoft\MSSQLServer\SQLServerAgent', N'UseDatabaseMail', N'REG_DWORD', 1
