[site]: stackoverflow
[post_id]: 1441426
[parent_id]: 1441399
[tags]: 
I'm not sure if I get it right but If you'd like to get the average of sales for last 10 days for you products you can do as follows : SELECT Product_Id,Sum(Sales)/Count(*) FROM (SELECT ProductId,Sales FROM Table WHERE SaleDAte>=@Date) table GROUP BY Product_id HAVING Count(*)>0 OR You can use AVG Aggregate function which is easier : SELECT Product_Id,AVG(Sales) FROM (SELECT ProductId,Sales FROM Table WHERE SaleDAte>=@Date) table GROUP BY Product_id Updated Now I got what you meant ,As far as I know it is not possible to do this in one query.It could be possible if we could do something like this(Northwind database): select a.CustomerId,count(a.OrderId) from Orders a INNER JOIN(SELECT CustomerId,OrderDate FROM Orders Order By OrderDate) AS b ON a.CustomerId=b.CustomerId GROUP BY a.CustomerId Having count(a.OrderId) but you can't use order by in subqueries unless you use TOP which is not suitable for this case.But maybe you can do it as follows: SELECT PorductId,Sales INTO #temp FROM table Order By Day select a.ProductId,Sum(a.Sales) /Count(a.Sales) from table a INNER JOIN #temp AS b ON a.ProductId=b.ProductId GROUP BY a.ProductId Having count(a.Sales)
