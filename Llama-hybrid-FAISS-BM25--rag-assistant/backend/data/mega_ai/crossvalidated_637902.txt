[site]: crossvalidated
[post_id]: 637902
[parent_id]: 
[tags]: 
Assessing surrogacy for 2 treatment effects

I'm interested in analyzing whether an intervention's effect on an outcome, X , qualifies as a surrogate for its effect on another outcome, Y . By the end of the analysis, I would like to have: A) An estimate of the slope (for every change in X, we can expect this much change in Y). B) An estimate of R-squared (how much of the variance in Y is explained by X). C) The surrogate threshold effect (a decrease in X by this much would correspond to a 95% prediction interval that excludes the null). An example of what I'd want to emulate: https://www.thelancet.com/journals/landia/article/PIIS2213-8587(18)30314-0/ Now, onto the data and approaches I've tried: Suppose I have a dataset of N trials containing treatment effects on X and Y , the standard errors of these treatment effects, and the within-trial correlation of treatment effects on X and Y . A simulated example: #Load foreach and data.table require("foreach") require("data.table") #Sequence over range of (somewhat) plausible surrogate treatment effects "stes" stes My initial impulse based on previous literature ( https://10.0.3.233/jamainternmed.2021.5726 among other examples) was to just run a weighted linear regression, with the weights being equal to the inverse of the sum of the variances of treatment effects (such that we let more precise estimates shape our results): #Run weighted least squares with weights equal to the precision of the observed #treatment effect #Run weighted least squares with weights equal to the precision of the observed #treatment effect weighted_model The 2 problems with this are (I think) that: first, it does not take within-trial correlation into account at all. Second, it does not take into account the uncertainty of the treatment effects (to my understanding, it only uses their relative weights to shape the estimates but treats them as "certain"/"known"). Other approaches I've tried include: 1) Incorporating error in the treatment effects using the se and me functions of brms (similar to: https://bookdown.org/ajkurz/Statistical_Rethinking_recoded/missing-data-and-other-opportunities.html ): #Model 1 m1 But this would not account for within-trial correlation. 2) Using a multivariate normal in brms and modeling the correlation between the residuals (similar to: https://solomonkurz.netlify.app/blog/2019-02-16-bayesian-correlations-let-s-talk-options/ ): #Model 2 m2 But again, this would not account for within-trial correlation. 3) Reframing the problem and viewing the two types of outcomes (surrogate and true) as being random effects nested within trials (inspired by Paul Buerkner's reply here: https://discourse.mc-stan.org/t/brms-multivariate-meta-analysis-syntax/6801 ): #Convert tes to long format first tes_long $trial_id, each = 2), intra_cor = rep(tes$ intra_cor, each = 2) ) #Create a variance-covariance matrix cov_matrix Any help for which of these models (if any) are most suitable would be greatly appreciated! Pardon the lengthy post.
