[site]: stackoverflow
[post_id]: 4158022
[parent_id]: 
[tags]: 
Exchange Web Services GetAttachment will not stream to disk

We are using Exchange Web Services from java (jaxws). Here's the issue. To get an attachment, you execute the GetAttachment soap call (logical enough :) ). Here's the problem: the entire attachment is returned (with no access to attachment size) in a base64 packet tucked deep inside a soap response along with other info. As a result the entire attachment contents is buffered into memory. With potentially 2GB attachments, this can get the entire java client to blow up out of memory. There appears to be no way to get just pieces of attachments from EWS. MTOM, etc does not appear to be supported. In short there appears to be no provisions in EWS for streaming. The only way around this situation would seem to be a very low level proxy to intercept these calls, and stream the contents to disk, replacing it with a "marker flag" to the file on disk. But there appears to be no elegant way to do this? Any ideas
