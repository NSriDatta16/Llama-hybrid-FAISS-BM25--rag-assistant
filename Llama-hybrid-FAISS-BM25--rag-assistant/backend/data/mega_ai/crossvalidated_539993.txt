[site]: crossvalidated
[post_id]: 539993
[parent_id]: 197726
[tags]: 
These models should be equivalent but the gamm function gives different outputs. I'll use as an example the Hawaii dataset from the book you have mentioned (mainly, paragraph 6.2). In the book you have: BM2 = gamm(Birds ~ Rain + ID + s(Time, by = as.numeric(ID == "Stilt.Oahu"))+ s(Time, by = as.numeric(ID == "Stilt.Maui"))+ s(Time, by = as.numeric(ID == "Coot.Oahu"))+ s(Time, by = as.numeric(ID == "Coot.Maui")), corretalion = corAR1(form =~Time|ID), weights = varIdent(form = ~1 |ID)) I get an error here Error in MEestimate(lmeSt, grps) : Singularity in backsolve at level 0, block 1 Instead I decided to use BM2 Now, the output of anova(BM2$gam) differs from the output in the book. Note also that the output of AIC(BM1$lme, BM2$lme) , where BM1 , is df AIC BM1 $lme 17 2362.142 BM2$ lme 17 2362.142 which should not happen and drives concerns. The outputs differ, so the models are not equivalent for the gamm function.
