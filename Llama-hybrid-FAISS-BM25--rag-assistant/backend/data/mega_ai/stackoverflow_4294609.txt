[site]: stackoverflow
[post_id]: 4294609
[parent_id]: 4294461
[tags]: 
From your link: Each element of the list of addresses is of type pcap_addr_t, and has the following members: ... addr a pointer to a struct sockaddr containing an address ... Now, what is a struct sockaddr ? See here: http://www.retran.com/beej/sockaddr_inman.html So where you are doing this: printf("address: %s\n",(char *) inet_ntoa(list.addr)); You should be doing something like this: printf("address: %s\n", inet_ntoa(((struct sockaddr_in*)list.addr)->sin_addr)); That is, you need to extract the "IP address" (if indeed the family is AF_INET ), else you are giving inet_ntoa the wrong type of argument.
