[site]: crossvalidated
[post_id]: 403937
[parent_id]: 
[tags]: 
MCMC sampling with a probability density function that have potential negative values

My question might be quite strange, but I will expose you the complete issue in order for you to help me. I am in the context of a parallel randomized clinical trial which aim is to compare two treatment options (a reference one denoted $T=0$ , and an innovative one denoted $T=1$ ). Let's also define a marker that is measured before any treatment allocation $X$ . The context of clinical trial leads to what I call the randomization constraint that states: \begin{equation} P(X \leq c|T=0)=P(X\leq c|T=1) \ \forall c \end{equation} This equation may be expressed as: \begin{equation} P(X \leq c|T=0,E=1)P(E=1|T=0)+P(X \leq c|T=0,E=0)P(E=0|T=0)=P(X \leq c|T=1,E=1)P(E=1|T=1)+P(X \leq c|T=1,E=0)P(E=0|T=1) \end{equation} For simplicity, I will note that $F_{tk}(c)=P(X \leq c|T=t, E=k)$ the cumulative distribution function of the marker $X$ in the group $tk$ , and $\rho_t=P(E=1|T=t)$ so that the previous equation is expressed as: \begin{equation} F_{01}(c)\times \rho_0+F_{00}(c)\times (1-\rho_0)=F_{11}(c)\times \rho_1+F_{10}(c)\times (1-\rho_1) \end{equation} So using this randomization constraint, it is possible to express one of the four CDF as a function of the three other ones, for example, let's express $F_{01}(c)$ as a function of the three other CDF, $\rho_0$ , and $\rho_1$ : \begin{equation} F_{01}(c) = [F_{11}(c)\times \rho_1+F_{10}(c)\times (1-\rho_1)-F_{00}(c)\times (1-\rho_0)]/ \rho_0 \end{equation} Note: The same equation is used to obtain $f_{01}(.)$ the probability density function Well, I need to estimate a function, let's call it $U(.)$ , that depends on $F_{01}(.)$ , $F_{00}(.)$ , $F_{10}(.)$ , and $F_{11}(.)$ and whose expression relies on the randomization constraint. I was thinking of a way to include this constraint in the estimation method of $U(.)$ , so I wanted to express the $F_{01}(.)$ as a function of the three other CDF as I presented it above. The estimation process would use the Bayesian inference by sampling from the posterior distribution of $\rho_0$ , $\rho_1$ , and the parameters of $F_{00}(.)$ , $F_{10}(.)$ , and $F_{11}(.)$ . The issue is that, for some combination of sampled parameters in the MCMC, $f_{01}(.)$ (the probability density function) might not be well-defined and could lead to a function that accepts negative values (which is quite embarassing when dealing with a probability density function), so that my estimation of $U(.)$ is not good. What could be the solutions ? For example I was thinking of a way to exclude the parameter combinations that lead to bad-defined $f_{01}(.)$ . But I am not sure this is a correct solution. By advance thank you for your help, I hope my problem is well-exposed here. If you need more details do not hesitate to ask.
