[site]: stackoverflow
[post_id]: 5292277
[parent_id]: 5291432
[tags]: 
You have to create a class that implements the IBindStatusCallback interface. You can return E_NOTIMPL for most of the methods. Use OnProgress() to show progress. Here's a sample program that gets this done: #include "stdafx.h" #include #include #pragma comment(lib, "urlmon.lib") using namespace std; class DownloadProgress : public IBindStatusCallback { public: HRESULT __stdcall QueryInterface(const IID &,void **) { return E_NOINTERFACE; } ULONG STDMETHODCALLTYPE AddRef(void) { return 1; } ULONG STDMETHODCALLTYPE Release(void) { return 1; } HRESULT STDMETHODCALLTYPE OnStartBinding(DWORD dwReserved, IBinding *pib) { return E_NOTIMPL; } virtual HRESULT STDMETHODCALLTYPE GetPriority(LONG *pnPriority) { return E_NOTIMPL; } virtual HRESULT STDMETHODCALLTYPE OnLowResource(DWORD reserved) { return S_OK; } virtual HRESULT STDMETHODCALLTYPE OnStopBinding(HRESULT hresult, LPCWSTR szError) { return E_NOTIMPL; } virtual HRESULT STDMETHODCALLTYPE GetBindInfo(DWORD *grfBINDF, BINDINFO *pbindinfo) { return E_NOTIMPL; } virtual HRESULT STDMETHODCALLTYPE OnDataAvailable(DWORD grfBSCF, DWORD dwSize, FORMATETC *pformatetc, STGMEDIUM *pstgmed) { return E_NOTIMPL; } virtual HRESULT STDMETHODCALLTYPE OnObjectAvailable(REFIID riid, IUnknown *punk) { return E_NOTIMPL; } virtual HRESULT __stdcall OnProgress(ULONG ulProgress, ULONG ulProgressMax, ULONG ulStatusCode, LPCWSTR szStatusText) { wcout (&progress)); return 0; } Output: 0 of 0 sstatic.net 0 of 0 64.34.119.12 0 of 0 0 of 0 image/x-png 3550 of 16542 http://sstatic.net/stackoverflow/img/sprites.png?v=3 3550 of 16542 C:\Users\hpassant\AppData\Local\Microsoft\Windows\Temporary Inter et Files\Content.IE5\NRPH4KHK\sprites[1].png 7330 of 16542 http://sstatic.net/stackoverflow/img/sprites.png?v=3 8590 of 16542 http://sstatic.net/stackoverflow/img/sprites.png?v=3 12370 of 16542 http://sstatic.net/stackoverflow/img/sprites.png?v=3 13630 of 16542 http://sstatic.net/stackoverflow/img/sprites.png?v=3 16542 of 16542 http://sstatic.net/stackoverflow/img/sprites.png?v=3
