[site]: crossvalidated
[post_id]: 627764
[parent_id]: 
[tags]: 
Is my custom loss function differentiable?

Consider the following loss function. loss = ( ( torch.where(d > threshold, torch.sqrt(d), 0) * t ) + ( torch.where(d where d is a vector of distances and t is a binary vector for targets. My rationale behind this custom loss is that I want a distance-based loss that encourages the distances of the points to be close to a certain threshold value if the corresponding binary vector element is 1 and far if the corresponding binary vector element is 0. However, the loss function does not work when I use it in my deep-learning model. Basically, the model does not learn anything with this loss function. I think the torch.where() parts make the loss function non-differentiable. I wonder if there is an alternative way to implement this loss.
