[site]: stackoverflow
[post_id]: 3542168
[parent_id]: 3542149
[tags]: 
a cookie just holds the Session ID, an id is always created upon session_start(); so if your calling that within your script the user will always have a session id. your best bet is too add a second cookie: setcookie('session_key',md5 ($token . $userAgent . $ip)); then within nginx: if ($http_cookie ~* "session_key") { break; } to check if that cookie is set. If the hash is sensitive then do this: setcookie('session_key_active','1'); Then in Nginx: if ($http_cookie ~* "session_key_active") { break; } But this is still vulnerable , always check server side values match!
