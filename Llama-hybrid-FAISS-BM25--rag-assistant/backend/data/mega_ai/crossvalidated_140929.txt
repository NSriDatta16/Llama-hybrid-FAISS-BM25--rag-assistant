[site]: crossvalidated
[post_id]: 140929
[parent_id]: 
[tags]: 
R logistf - how to define case control penalized logistic regression model with PCA eigenvectors as covariates

I wish to carry out logistic regression analysis using Firth's method, as implemented in R logistf package, to analyse SNP case/control data, for rare variants, whilst controlling for stratification using PCA eigenvectors as covariates. I wish to obtain p-values for each SNP (additive model). Previously I have performed logistic regression analysis using PLINK: plink --bfile snpdata --logistic --ci 0.95 --covar plink2_pca.eigenvec --covar-number 1-2 --out snpout I would like to perform similar analysis, but wish to handle quasi-complete separation of the rare variants in my data sets. I have followed a SNP analysis example provided with logistf and been able to obtain P values: A very small sample of the snpdata (cases: case 1, control 0; SNP additive allele counts for minor allele: 0, 1, 2): PC01 PC02 case exm226_A exm401_A exm4584_A exm146_A 1 -0.003092320 -0.002737810 1 0 0 0 0 2 0.015637300 0.008232330 1 0 0 0 0 3 0.006746730 0.008704400 1 0 1 0 1 4 0.001438270 0.000875751 0 0 0 0 0 5 -0.004161490 0.011407500 0 0 0 2 0 for(i in 1:ncol(snpdata)) snpdata[,i] =2)] fitsnp But I am not clear on how to pass the eigenvectors in as covariates, or whether I can used the eigenvector values as is, or need to convert to these as factors? fitsnp I'm not sure if I am on the right track here and can't find a sufficiently similar example on-line to follow. I would appreciate any assistance, or explanation if I am going completely wrong here.
