[site]: crossvalidated
[post_id]: 584589
[parent_id]: 
[tags]: 
Updating the Posterior Psi parameter for an Inverse Wishart Distribution

I am fitting a Mixed Multivariate Normal Distribution where the mixing occurs over the mean $\mu_j$ and the covariance matrix $H$ with mixing parameter $B_j$ . The number of mixing elements is denotes by $j$ (and $n_j$ the number of observations assigned to a particular cluster mix). In order to optimize for $\mu_j$ and $B_j$ I perform an MCMC, where the posterior distribution for parameter $B$ equals: $B_{j} \mid r_{1: T}, s_{1: T}, \mu_{j}, \Gamma \sim \mathcal{W}^{-1}\left(n_{j}+\nu_{0}, B_{0}+\sum_{s_{t}=j}\left(H_{t}^{-1 / 2}\mathbf{x_{t}}-H_{t}^{-1 / 2} \mathbf{\mu}_{j}\right)\left(H_{t}^{-1 / 2}\mathbf{x_{t}}-H_{t}^{-1 / 2} \mathbf{\mu}_{j}\right)^{\prime}\right)$ However I run into a problem of the updating of the $\Psi$ parameter of the inverse Wishart distribution. $\Psi = \sum_{s_{t}=j}\left(H_{t}^{-1 / 2}\mathbf{x_{t}}-H_{t}^{-1 / 2} \mu_{j}\right)\left(H_{t}^{-1 / 2}\mathbf{x_{t}}-H_{t}^{-1 / 2} \mu_{j}\right)^{\prime}$ The problem is that the update is not positive definite. The data that I am working with are financial returns which sometimes are negative, hence for some cross multiplications, the result will be negative. In addition, taking the inverse of the cholesky decomposition $(H_t^{-1/2})$ of $H$ does not return a symmetric matrix, thus also fails to keep $\Psi$ positive definite. Does someone perhaps have an idea what could alleviate this problem?
