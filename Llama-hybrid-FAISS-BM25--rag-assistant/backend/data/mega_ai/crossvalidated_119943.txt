[site]: crossvalidated
[post_id]: 119943
[parent_id]: 
[tags]: 
Correct numerical result in Bayesian model comparison

I was wondering how to calculate the following Bayesian model comparison. Suppose you have a couple of models: $$M_{1}: x \sim Bin(n, \pi); p \sim Be(1,1)$$ $$M_{2}: x \sim Bin(n, \pi); p \sim Be(30,30)$$ Congdon's book says this: As a toy example, consider comparing two beta priors, $p ∼ Be(\alpha, \beta)$, for a binomial probability, when the data are x = 1 sucesses in n = 10 trials. This choice can be solved analytically to give $P(M_1 |x) = 0.8634$. In particular, integrating $\pi$ out from the binomial-beta mixture model, $x \sim Bin(n, π)$, $π \sim Be(\alpha, \beta)$, gives a beta-binomial distribution, $x ∼ Beta−Bin(n, \alpha, \beta)$, with density: $$p(x|n,\alpha, \beta)= \frac{Be(x+\alpha, n-x+\beta)}{Be(\alpha, \beta)}Bin(n, x)$$ which can be evaluated at $p(x|10, 1, 1)$ and $p(x|10, 30, 30)$ where $Beta-Bin$ is the Beta-Binomial distribution. I was assuming that $P(M_{1}|x)$ was calculated in the following way: $$P(M_{1}|x) \propto P(M_{1})p(x|M_{1}) = P(M_{1})\int _{0}^{1}p(x|\pi,M_{1})p(\pi|M_{1})d\pi$$ In the equation above, $p(x|\pi,M_{1})$ should be the likelihood $Bin(n,\pi)$ and the second term $p(\pi|M_{1})$ is the prior $Beta(1,1)$ under model $M_{1}$. The integral $\int _{0}^{1}p(x|\pi,M_{1})p(\pi|M_{1})d\pi$ is simply $$\int _{0}^{1}Bin(n,\pi)Beta(1,1)d\pi=\int_{0}^{1}\binom{n}{x}p^{x}(1-p)^{n-x}\frac{p^{\alpha-1}(1-p)^{\beta-1}}{B(\alpha,\beta)}dp = \frac{Be(x+\alpha, n-x+\beta)}{Be(\alpha,\beta)}\binom{n}{x}$$ However, even though I obtain the result described in the quote as $p(x|n,\alpha, \beta)$ after solving the integral, I don't get the correct numerical result (assuming $P(M_{1})=0.5$ and after normalizing both $P(M_{1}|x)$ and $P(M_{2}|x)$) Does anyone know how to obtain the correct result?
