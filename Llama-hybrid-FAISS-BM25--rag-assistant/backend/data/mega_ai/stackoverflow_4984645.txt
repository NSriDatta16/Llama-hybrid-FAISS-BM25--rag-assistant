[site]: stackoverflow
[post_id]: 4984645
[parent_id]: 4981324
[tags]: 
Overriding renderLayout is overkill. Instead create a block that outputs your img tag and include it in the base theme, perhaps for the area before_body_end , that will safely place it on all pages. Inventing your own token is also overkill since Magento is using the PHP session identifier and places it automatically for foreign domains. Your custom block might generate the URL with this: $this->getUrl('OTHER/STORE/PATH', array('_store' => 'YOUR_STORE_CODE')) If you think your script is going to need Mage::app() then you might as well use a controller which is a similar effort. On encountering a SID value the session will be updated behind the scenes, cookies set etc. It using an iframe it doesn't need to output anything and if a small image can be static like this: print "GIF89a\1\0\1\0\x80\0\0\xff\xff\xff\xff\xff\xff!\xf9\4\1\n\0\1\0,\0\0\0\0\1\0\1\0\0\2\2L\1\0;"; P.S. When creating the URL of the foreign store without an SID use the _nosid parameter to force a clean URL.
