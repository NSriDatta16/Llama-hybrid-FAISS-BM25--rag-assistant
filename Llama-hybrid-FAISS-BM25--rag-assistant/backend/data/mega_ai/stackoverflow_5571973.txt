[site]: stackoverflow
[post_id]: 5571973
[parent_id]: 
[tags]: 
SetWindowLongPtr doesnt work properly

I want to subclass RichEdit in my program (here is c++ code: http://dumpz.org/46182/ ). _native_log is a hwnd of richedit. At first all works fine and LogWindow::wndProc callback called normal, but if i set some text in RichEdit or click on them LogWindow::wndProc stops work (there no any further calls of it). Is there any thoughts what's i do wrong? void LogWindow::replaceNativeLog(HWND native_log_handle) { _native_log = native_log_handle; SendMessage(_native_log, EM_GETOLEINTERFACE, 0, (LPARAM) &_rich_edit_ole); _old_wnd_proc = (WNDPROC) SetWindowLongPtr(_native_log, GWLP_WNDPROC, (LONG) &wndProc); } LRESULT LogWindow::wndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam) { switch (Msg) { case EM_STREAMIN: break; case WM_SETTEXT: break; }; return CallWindowProc(_old_wnd_proc, _native_log, Msg, wParam, lParam); }
