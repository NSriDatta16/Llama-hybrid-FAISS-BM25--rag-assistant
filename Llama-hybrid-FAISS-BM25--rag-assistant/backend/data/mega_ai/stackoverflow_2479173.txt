[site]: stackoverflow
[post_id]: 2479173
[parent_id]: 2479097
[tags]: 
So, the hard part is to detect the angle of the page. If you have full control over the template, the simplest way to do this is probably to come up with an easily-detectable symbol (e.g. a solid black circle) and stick 3 of them on the template. Then, detect them (just look for big blocks of pixels with high saturation, in the case of a solid black circle). So, you'll then have 3 sets of coordinates. If you have a top circle, a left circle, and a right circle with all 3 circles at difference distances from one another, detecting which circle is the top circle should be pretty easy. Then just call a rotation function. This part is easy and has been done before (e.g. http://www.switchonthecode.com/tutorials/csharp-tutorial-image-editing-rotate ). Edit: I suggested a circle because it's easier to find the center, but a rectangle should work, too. To be more explicit about how to actually locate the rectangles/circles, take the average Brightness value of every a × a group of pixels. If that value is greater than b, then that a × a group of pixels is part of a rectangle. a and b are varables you'll want to come up with yourself. Use flood-fill (or, more precisely, Connected Component Labeling ) group the resulting pixels together. The end result should give you your rectangles.
