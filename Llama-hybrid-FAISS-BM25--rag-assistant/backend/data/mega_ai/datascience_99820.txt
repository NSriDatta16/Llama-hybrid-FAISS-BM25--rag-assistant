[site]: datascience
[post_id]: 99820
[parent_id]: 99696
[tags]: 
There are a couple ways to fix your code. One option is to write customs functions that contain the feature engineering code. Then call the functions before both training ( model.fit ) and prediction ( model.predict ). Another option is use a framework that is designed to apply the appropriate transformations during training and prediction, an example is scikit-learn's Pipeline .
