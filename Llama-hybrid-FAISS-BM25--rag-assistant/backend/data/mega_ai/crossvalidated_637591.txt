[site]: crossvalidated
[post_id]: 637591
[parent_id]: 
[tags]: 
Mixed-effects model of nested time series

I have time series data for a variable from different climate models, each with multiple runs using different initial conditions (ensemble members). A small subset of the data to see how its laid out (the compete dataset includes 36 years and 19 models with between 5 and 49 members each). #> member model time hgt #> #> 1: 1.1.1.1 ACCESS-CM2 1979 -0.045225795 #> 2: 1.1.1.1 ACCESS-CM2 1980 -0.009871858 #> 3: 1.1.1.1 ACCESS-CM2 1981 -0.062349852 #> 4: 2.1.1.1 ACCESS-CM2 1979 -0.051631382 #> 5: 2.1.1.1 ACCESS-CM2 1980 -0.043643211 #> 6: 2.1.1.1 ACCESS-CM2 1981 -0.029604119 #> 7: 1.1.1.1 ACCESS-ESM1-5 1979 -0.009869267 #> 8: 1.1.1.1 ACCESS-ESM1-5 1980 -0.014024862 #> 9: 1.1.1.1 ACCESS-ESM1-5 1981 -0.016568455 #> 10: 2.1.1.1 ACCESS-ESM1-5 1979 -0.008007551 #> 11: 2.1.1.1 ACCESS-ESM1-5 1980 -0.009915181 #> 12: 2.1.1.1 ACCESS-ESM1-5 1981 -0.015526597 #> 13: 1.1.1.1 AWI-CM-1-1-MR 1979 -0.030887150 #> 14: 1.1.1.1 AWI-CM-1-1-MR 1980 -0.036778999 #> 15: 1.1.1.1 AWI-CM-1-1-MR 1981 -0.028872595 #> 16: 2.1.1.1 AWI-CM-1-1-MR 1979 -0.046219117 #> 17: 2.1.1.1 AWI-CM-1-1-MR 1980 -0.024323372 #> 18: 2.1.1.1 AWI-CM-1-1-MR 1981 -0.024374409 I want to model the linear trend, considering uncertainty in both ensemble members and models. To do this, I plan to use mixed-effects modeling, treating ensemble members as random effects (because they are a random sample of the population of possible model runs) and models as fixed effects (models are not random and not sampled from a larger population). First question : Is my reasoning reasonable? Am I missing something? So, now to code that in R. I’m using lme4 and if I understood the documentation correctly, I think I need to use a formula like this: library(lme4) model boundary (singular) fit: see help('isSingular') So, fixed effect of time interacting with model, so that the slope (and intercept) can vary among models, plus a random effect for member , which are nested in model so that each member can have also a random slope (and intercept). Second question : Is this formula correct? Two issues I have with this approach is that I don’t get an average time effect, instead I get a single slop for each model. Third question : How can I get an average slope and its uncertainty? Do I need to consider model effects as random since I’m somewhat assuming that there is a “mean slope” that governs the distribution of the model effect? The second issue is that I get a warning that the fit is singular. I tested for collinearity and found some duplicated members in a model, but I removed it in this data, so that is not the issue. # Highest four correlations between all time series data %>% data.table::copy() %>% .[, member := interaction(model, member)] %>% widyr::pairwise_cor(member, time, hgt, sort = TRUE, upper = FALSE) %>% data.table::as.data.table() %>% head(4) #> item1 item2 correlation #> #> 1: ACCESS-ESM1-5.14.1.1.1 CanESM5.11.1.1.1 0.6410348 #> 2: ACCESS-ESM1-5.40.1.1.1 MIROC6.5.1.1.1 0.6364663 #> 3: CNRM-CM6-1.10.1.1.2 MPI-ESM1-2-HR.5.1.1.1 0.6300627 #> 4: CESM2.10.1.1.1 NESM3.2.1.1.1 0.6281228 Fourth question : Is this serious? What could be causing the issue? Created on 2024-01-23 with reprex v2.0.2
