[site]: stackoverflow
[post_id]: 5134371
[parent_id]: 
[tags]: 
Date Checking (COBOL)

As part of an assignment I need to create a "shipping" program that checks a certain field which tells the date an item is to be shipped. Any record with a date greater than 6 months away is to be omitted while sorting the rest of the data. The problem is no matter what I try I get bad results. I figured an EVALUATE statement would be the best route to go, but I just can't seem to get it right. This is what I have down: DATA DIVISION. FILE SECTION. COPY ORDERS-FILE-NEW-IN.COP. FD ORDERS-FILE-NEW-IN. 01 ORDERS-RECORD-NEW-IN. 05 PART-NUMBER-N-IN PIC X(8). 05 QUANTITY-N-IN PIC 9(4). 05 REQUEST-DATE-N-IN. 10 REQUEST-YEAR-N-IN PIC X(4). 10 REQUEST-MONTH-N-IN PIC XX. 10 REQUEST-DAY-N-IN PIC XX. 05 CUST-NUMBER-N-IN PIC X(5). 05 CUST-ORDER-NUMBER-N-IN PIC X(10). 05 STOCK-AVAILABLE-N-IN PIC X. COPY ORDERS-FILE-PRIOR-IN.COP. FD ORDERS-FILE-PRIOR-IN. 01 ORDERS-RECORD-PRIOR-IN. 05 PART-NUMBER-P-IN PIC X(8). 05 QUANTITY-P-IN PIC 9(4). 05 REQUEST-DATE-P-IN. 10 REQUEST-YEAR-P-IN PIC X(4). 10 REQUEST-MONTH-P-IN PIC XX. 10 REQUEST-DAY-P-IN PIC XX. 05 CUST-NUMBER-P-IN PIC X(5). 05 CUST-ORDER-NUMBER-P-IN PIC X(10). 05 STOCK-AVAILABLE-P-IN PIC X. COPY ORDERS-FILE-SORT.COP. SD ORDERS-FILE-SORT. 01 ORDERS-RECORD-SORT. 05 PART-NUMBER-S PIC X(8). 05 QUANTITY-S PIC 9(4). 05 REQUEST-DATE-S. 10 REQUEST-YEAR-S PIC X(4). 10 REQUEST-MONTH-S PIC XX. 10 REQUEST-DAY-S PIC XX. 05 CUST-NUMBER-S PIC X(5). 05 CUST-ORDER-NUMBER-S PIC X(10). 05 STOCK-AVAILABLE-S PIC X. FD ORDERS-FILE-OUT. 01 ORDERS-RECORD-OUT PIC X(80). WORKING-STORAGE SECTION. 01 ARE-THERE-MORE-RECORDS PIC X(3) VALUE 'YES'. 01 REPORT-START PIC X VALUE 'Y'. 01 LINE-COUNT PIC 99 VALUE ZEROS. 01 LINE-JUMP PIC X VALUE 'Y'. 01 PAGE-NUMBER PIC 99 VALUE ZEROS. 01 MONTH-TOTAL PIC 99 VALUE ZEROS. 01 YEAR-TOTAL PIC 99 VALUE ZEROS. 01 YEAR-CHECK PIC 99 VALUE ZEROS. 01 SPACE-LINE PIC X VALUE SPACE. 01 WS-DATE. 05 RUN-MONTH PIC XX. 05 RUN-DAY PIC XX. 05 RUN-YEAR PIC XX. 01 HEADING-LINE-1. 05 PIC X(15) VALUE SPACES. 05 PIC X(43) VALUE 'OPEN ORDERS REPORT - NEXT SIX MONTHS'. 05 HL-1-DATE. 10 MONTH-1 PIC 99. 10 PIC X VALUE '/'. 10 DAY-1 PIC 99. 10 PIC X VALUE '/'. 10 YEAR-1 PIC 99. 05 PIC X(3) VALUE SPACES. 05 PAGE-1 PIC X(5) VALUE 'PAGE'. 05 NUMBER-PAGE PIC Z9. 01 HEADING-LINE-2. 05 PIC X(14) VALUE 'REQUEST DATE'. 05 PIC X(12) VALUE 'CUSTOMER #'. 05 PIC X(16) VALUE 'CUSTOMER ORD #'. 05 PIC X(10) VALUE 'PART #'. 05 PIC X(11) VALUE 'QUANTITY'. 05 PIC X(8) VALUE 'AVAIL'. 05 PIC X(5) VALUE 'SHIP?'. 01 DETAIL-LINE. 05 REQUEST-DATE. 10 REQUEST-MONTH PIC XX. 10 PIC X VALUE '/'. 10 REQUEST-DAY PIC XX. 10 PIC X VALUE '/'. 10 REQUEST-YEAR PIC X(4). 05 PIC X(4) VALUE SPACES. 05 CUST-NUMBER PIC X(5). 05 PIC X(7) VALUE SPACES. 05 CUST-ORDER-NUMBER PIC X(10). 05 PIC X(6) VALUE SPACES. 05 PART-NUMBER PIC X(8). 05 PIC X(5) VALUE SPACES. 05 QUANTITY PIC Z,ZZZ. 05 PIC X(3) VALUE SPACES. 05 STOCK-AVAILABLE PIC X(3). 05 PIC X(5) VALUE SPACES. 05 SHIP-MESSAGE PIC X(4). PROCEDURE DIVISION. 100-MAIN. SORT ORDERS-FILE-SORT ON ASCENDING KEY REQUEST-DATE-S ON ASCENDING KEY CUST-NUMBER-S ON ASCENDING KEY CUST-ORDER-NUMBER-S ON ASCENDING KEY PART-NUMBER-S INPUT PROCEDURE 200-SORT-SELECTION OUTPUT PROCEDURE 300-FILE-START STOP RUN. 200-SORT-SELECTION. OPEN INPUT ORDERS-FILE-NEW-IN ORDERS-FILE-PRIOR-IN ACCEPT WS-DATE FROM DATE MOVE RUN-MONTH TO MONTH-1 MOVE RUN-DAY TO DAY-1 MOVE RUN-YEAR TO YEAR-1 PERFORM UNTIL ARE-THERE-MORE-RECORDS = 'NO ' READ ORDERS-FILE-PRIOR-IN AT END MOVE 'NO' TO ARE-THERE-MORE-RECORDS NOT AT END PERFORM 210-SORT-ADD-PRIOR END-READ END-PERFORM MOVE 'YES' TO ARE-THERE-MORE-RECORDS PERFORM UNTIL ARE-THERE-MORE-RECORDS = 'NO ' READ ORDERS-FILE-NEW-IN AT END MOVE 'NO' TO ARE-THERE-MORE-RECORDS NOT AT END PERFORM 220-SORT-ADD-NEW END-READ END-PERFORM MOVE 'YES' TO ARE-THERE-MORE-RECORDS CLOSE ORDERS-FILE-NEW-IN ORDERS-FILE-PRIOR-IN. 210-SORT-ADD-PRIOR. MOVE ORDERS-RECORD-PRIOR-IN TO ORDERS-RECORD-SORT MOVE MONTH-1 TO MONTH-TOTAL MOVE YEAR-1 TO YEAR-TOTAL MOVE REQUEST-YEAR-P-IN TO YEAR-CHECK ADD 6 TO MONTH-TOTAL IF MONTH-TOTAL > 12 SUBTRACT 12 FROM MONTH-TOTAL END-IF EVALUATE REQUEST-MONTH-P-IN WHEN 01 IF MONTH-TOTAL = 1 OR (MONTH-TOTAL > 6 AND 7 AND 0 AND 8 AND 0 AND 9 AND 0 AND 0 AND 1 AND 2 AND 3 AND 4 AND 5 AND 6 AND
