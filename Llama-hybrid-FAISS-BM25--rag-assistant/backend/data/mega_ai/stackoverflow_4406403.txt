[site]: stackoverflow
[post_id]: 4406403
[parent_id]: 
[tags]: 
Preserve registry settings when upgrade

I am using WiX 3.0. I am trying to preseve all my registry settings when doing upgrade. I found the following link http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg28844.html I prefer to use Property and RegistrySearch approach rather than custom action approach because I thought it looks simpler. Unfortunately, this approach doesn't work very well for me. My projects got some DWORD and SZ type registry value. For all DWORD type registry values, it appends a # in the front. I checked the WiX refernce manual. This is how RegistrySearch works. So, after the upgrade, the result is all my DWORD type registry is changed to SZ. The value looks the same except it has a # appended in the front. For example, I got value 2 in the registry value "LogLevel" with type DWORD. After upgrade, I get value "#2" in the registry value "LogLevel" with type SZ in the same location. Here is the code fragment I wonder if there is any string function that can help me trim off the "#" from LOG_LEVEL property before I put it back. Or is there any smarter way to preserve the registry keys when doing upgrade? Should I go for Custom Action approach?
