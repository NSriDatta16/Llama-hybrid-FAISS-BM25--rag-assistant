[site]: stackoverflow
[post_id]: 5446845
[parent_id]: 5446833
[tags]: 
First of all, run the user's input through a strict XML parser. Reject any invalid markup. You should use a whitelist of HTML tags and attributes (in the parsed XML). Do not allow tags, s, or style attributes. Run all URLs ( href and src attributes) through a URI parser (eg, .Net's Uri class), and ensure that the protocol is http , https , or perhaps mailto . Again, reject any invalid URLs. If you want to allow YouTube embedding, add your own tag that takes a URL or video ID as a parameter (content or attribute), and transform it into a script on the server (after validating the parameter). After you finish, make sure that you're blocking everything on this giant list .
