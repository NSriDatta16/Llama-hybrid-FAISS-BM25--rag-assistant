[site]: crossvalidated
[post_id]: 415908
[parent_id]: 
[tags]: 
Equation 16.9 from Deep Learning Book

I recently came across the following equation $$\log p(v) = \mathop{\mathbb{E}}\sideset{_{h\sim p(h\mid v)}}{}{}\left [ \log p(h,v) - \log p(h|v) \right ] = \mathop{\mathbb{E}}\sideset{_{h\sim p(h|v)}}{}{}\left [\log\frac{p(h,v)}{p(h|v)}\right ]$$ I was trying to prove this myself, so: $$ \begin{align*} \log p(v) &= \log \sum_h p(h,v) \\ &= \log \sum_h p(v)p(h|v) \\ &= \log\mathop{\mathbb{E}}\sideset{_{h\sim p(h|v)}}{}{} p(v)&& \\ &= \log\mathop{\mathbb{E}}\sideset{_{h\sim p(h|v)}}{}{}\left [\frac{p(v)p(h|v)}{p(h|v)}\right ] \\ &= \log\mathop{\mathbb{E}}\sideset{_{h\sim p(h|v)}}{}{}\left [\frac{p(h,v)}{p(h|v)}\right ] \\ &\geq \mathop{\mathbb{E}}\sideset{_{h\sim p(h|v)}}{}{}\left [\log\frac{p(h,v)}{p(h|v)}\right ] \end{align*} $$ where the last step uses the fact that $\mathop{\mathbb{E}}\log()â©½\log\mathop{\mathbb{E}}$ Am I missing something that collapses this inequality to an equality? Or is the last step just wrong? Can't quite wrap my head around this. Source: Page 580 of Deep Learning Book
