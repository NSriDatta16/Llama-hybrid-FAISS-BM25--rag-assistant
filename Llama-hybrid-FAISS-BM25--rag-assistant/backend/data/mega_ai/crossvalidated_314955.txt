[site]: crossvalidated
[post_id]: 314955
[parent_id]: 
[tags]: 
Using mixed models to treat time series data in R

I have a 4 year long daily time series for the gross margin (GROSS_MARGIN) of six different production plants (PLANTS, factor). For one of these plants, a treatment was applied at some point in time (so it has a before/after set of observations, TREATMENT). This plant was marked as case , the others as control (factor, CASE_CONTROL). The dates were decomposed in fiscal years (FY, factor) and months (MONTH, factor) So, I came up with a model like this (I´m using R/lme4): GROSS_MARGIN ~ TREATMENT + (CASE_CONTROL|FY) + (CASE_CONTROL|MONTH) The idea is to generate a hierarchy of models able to isolate the effects of changes associated to fiscal year (e. g. long term market effects) and seasonality (monthly basis), which are uncontrollable from the effects of the treatment. Here´s a data sample: PLANT GROSS_MARGIN FY DATE MONTH CASE_CONTROL TREATMENT B 191.5964372 1516 2016-04-19 Apr 0 0 U 216.8121963 1617 2017-04-03 Apr 1 0 U 166.4315772 1617 2016-07-21 Jul 1 0 U 135.5415243 1415 2015-02-24 Feb 1 0 U 58.11040508 1718 2017-08-28 Aug 1 1 U 101.5804414 1516 2015-08-18 Aug 1 0 P 177.0904659 1415 2014-11-21 Nov 0 0 U 75.4058245 1415 2015-05-28 May 1 0 P 100.4976949 1718 2017-07-19 Jul 0 0 U 201.7031536 1415 2014-10-08 Oct 1 0 P 286.5572358 1415 2015-04-06 Apr 0 0 B 300.6485076 1415 2014-08-18 Aug 0 0 P 167.4768055 1617 2016-11-29 Nov 0 0 R 91.08332248 1516 2015-09-15 Sep 0 0 U 372.4720477 1617 2017-02-21 Feb 1 0 P 166.4502071 1516 2016-02-12 Feb 0 0 R 233.8138379 1415 2015-04-24 Apr 0 0 U 53.47271932 1617 2017-05-08 May 1 0 P 144.6495899 1415 2015-03-03 Mar 0 0 Is this the adequate approach to this kind of data?
