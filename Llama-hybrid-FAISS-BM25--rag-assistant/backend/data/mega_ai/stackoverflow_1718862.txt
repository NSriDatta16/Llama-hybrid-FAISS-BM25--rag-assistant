[site]: stackoverflow
[post_id]: 1718862
[parent_id]: 58510
[tags]: 
I think the right answer is a combination of Steve Morgan's and Serguei's answers. That's how Internet Explorer does it. The pinvoke call to FindMimeFromData works for only 26 hard-coded mime types. Also, it will give ambigous mime types (such as text/plain or application/octet-stream ) even though there may exist a more specific, more appropriate mime type. If it fails to give a good mime type, you can go to the registry for a more specific mime type. The server registry could have more up-to-date mime types. Refer to: http://msdn.microsoft.com/en-us/library/ms775147(VS.85).aspx
