[site]: crossvalidated
[post_id]: 26611
[parent_id]: 
[tags]: 
How to test the effect of a grouping variable with a non-linear model?

I have a question regarding the use of a grouping variable in a non-linear model. Since the nls() function does not allow for factor variables, I have been struggling to figure out if one can test the effect of a factor on the model fit. I have included an example below where I want to fit a "seasonalized von Bertalanffy" growth model to different growth treatments (most commonly applied to fish growth). I would like to test the effect of the lake where the fish grew as well as the food given (just an artificial example). I am familiar with a workaround to this problem - applying an F-test comparing models fit to pooled data vs. separate fits as outlined by Chen et al. (1992) (ARSS - "Analysis of residual sum of squares"). In other words, for the example below, does the fitting of two models significantly reduce sum of the squared residuals (in this example, yes): I imagine there is a simpler way to do this in R using nlme(), but I am running into problems. First of all, by using a grouping variable, the degrees of freedom is higher than I obtain with my fitting of separate models. Second, I am unable to nest grouping variables - I don't see where my problem is. Any help using nlme or other methods is greatly appreciated. Below is code for my artificial example: ###seasonalized von Bertalanffy growth model soVBGF Reference: Chen, Y., Jackson, D.A. and Harvey, H.H., 1992. A comparison of von Bertalanffy and polynomial functions in modelling fish growth data. 49, 6: 1228-1235.
