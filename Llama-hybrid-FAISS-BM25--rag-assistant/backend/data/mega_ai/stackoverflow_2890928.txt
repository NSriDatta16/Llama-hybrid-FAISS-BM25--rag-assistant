[site]: stackoverflow
[post_id]: 2890928
[parent_id]: 2890190
[tags]: 
There is most likely a more elegant way to do this. First read in the data: h next we calculate the lagged variables. This line of code splits up the data by PROD, then puts NAs as the top row, and drops the last row, resulting in a lag of 1. new_vars Show them in the console: > cbind(dat,new_vars) row PRODID PROD Year Week QTY SALES INVOICES QTY SALES INVOICES Dolie12.1 1 20001 Dolie12 2010 12 1 15.46 1 NA NA NA Dolie12.2 2 20001 Dolie12 2010 18 1 0.00 1 1 15.46 1 Dolie12.3 3 20001 Dolie12 2010 19 0 -13.88 2 1 0.00 1 CageFreeEggs.1 4 100001 CageFreeEggs 2009 14 135 243.00 5 NA NA NA CageFreeEggs.4 5 100001 CageFreeEggs 2009 15 300 540.00 11 135 243.00 5 CageFreeEggs.5 6 100001 CageFreeEggs 2009 16 270 486.00 11 300 540.00 11 CageFreeEggs.6 7 100001 CageFreeEggs 2009 17 300 540.00 10 270 486.00 11 CageFreeEggs.7 8 100001 CageFreeEggs 2009 18 270 486.00 11 300 540.00 10 CageFreeEggs.8 9 100001 CageFreeEggs 2009 19 315 567.00 11 270 486.00 11 CageFreeEggs.9 10 100001 CageFreeEggs 2010 9 315 569.25 12 315 567.00 11
