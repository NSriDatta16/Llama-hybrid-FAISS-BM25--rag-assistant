[site]: stackoverflow
[post_id]: 2833212
[parent_id]: 
[tags]: 
Parsing HTML fragments with libxml SAX

I need to parse HTML fragments, by which I mean the files lack , and elements, otherwise having well-formed XHTML syntax, UTF8 encoding guaranteed. It looks like libxml is ideal for this task, but I have certain constraints which I just don't know how to implement. htmlSAXParseFile() does its job well enough, but it seems to create DOM itself, inserting body and html elements in the process. I would like to create DOM myself because I may need to skip some elements and modify others on the fly. Is it possible to somehow tell libxml not to create DOM at all and just parse HTML and call my handlers? If that's not possible for libxml HTML parser, I might as well use xmlSAXUserParseFile() which doesn't seem to create DOM. However, since the files have a structure like ... ... , the parser just spits "Extra content at the end of the document" too early. Is there a way to suppress some parsing errors while still getting notified about them (just because nobody guarantees there will never be other errors in those files)? There is a whole heck of parsing functions in libxml, some of which accept xmlParserOption as a parameter. Alas, xmlSAXUserParseFile() does not. And those which do all seem to create DOM for some irrelevant API design reasons. Am I missing an obvious candidate? Oh, and I confess that my reluctance to use libxml's DOM looks like a quirk. I am extremely constrained with RAM, so I desperately need total control over DOM to be able to drop some nodes on low memory conditions and re-read them if necessary. Thanks in advance.
