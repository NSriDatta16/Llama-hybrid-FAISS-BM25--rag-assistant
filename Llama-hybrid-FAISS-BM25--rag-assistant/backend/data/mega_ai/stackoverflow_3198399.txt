[site]: stackoverflow
[post_id]: 3198399
[parent_id]: 3197878
[tags]: 
Probably a function that Magento uses doesn't support multiple sql statements. Call each statement separately. exec("LOCK TABLES mytable AS mytable_write WRITE, mytable AS mytable_read READ"); exec("SELECT @val := unique_field_to_grab FROM mytable AS mytable_read ORDER BY last_used ASC LIMIT 1"); exec("UPDATE mytable AS mytable_write SET last_used = unix_timestamp() WHERE unique_field_to_grab = @val LIMIT 1"); exec("UNLOCK TABLES"); exec("SELECT @val AS val"); Use appropriate functions instead of exec().
