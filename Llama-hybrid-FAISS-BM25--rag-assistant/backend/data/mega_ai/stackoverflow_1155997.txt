[site]: stackoverflow
[post_id]: 1155997
[parent_id]: 91840
[tags]: 
Using a shared schema approach requires you to intercept and decorate all of your queries with additional information to restrict the results. NHibernate provides interceptors to do this, and event listeners are also available from NHibernate 2.0 Aplpha 1. See http://elegantcode.com/2008/05/15/implementing-nhibernate-interceptors/ and http://www.codinginstinct.com/2008/04/nhibernate-20-events-and-listeners.html for discussions on these. Also have a look at Ayende's Rhino Security component as he does a lot of work in this to modify queries with additional restrictions based on security descriptors. You can browse the source at https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/security
