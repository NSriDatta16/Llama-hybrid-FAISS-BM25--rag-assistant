[site]: stackoverflow
[post_id]: 4719403
[parent_id]: 
[tags]: 
C libpcap resolve DLT entries, some nasty bug

while sort of writing my own sniffer, I found one example that only starts if it is talking ethernet. Other DLT_types have been ignored. They can be found in pcap-bpf.h I wrote some lines, that try to implement a missing pcap_resolve_dlt(). It's really nasty code(1), seems to work, though I hit a nasty bug, where one needs to give a space to the corresponding number like: user@debian:~/tmp$ ./resolve_dlt 114 DLT_LTALK 114 user@debian:~/tmp$ ./resolve_dlt 14 DLT_ATM_RFC1483 11 user@debian:~/tmp$ ./resolve_dlt " 14" DLT_RAW 14 Maybe the approach itself is totally wrong and one should grep the pcap-bpf.h directly. 1) http://nopaste.info/4a2470cc83.html , uses strstr() Kind Regards, Charles Tags: C libpcap DLT_
