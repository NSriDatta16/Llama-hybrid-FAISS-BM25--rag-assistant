[site]: stackoverflow
[post_id]: 1119556
[parent_id]: 
[tags]: 
How to tie-out with VBA, Oracle, and Excel using INDEX & MATCH functions?

I am trying to create a program using VBA that queries my oracle database data (in this case pipelines) against a spreadsheet and produces an output of the tie-out on the same workbook (but on another sheet). I would like to use the INDEX and MATCH functions on the tie-out page but have trouble figuring it out. Here is what I have so far (graphical representation below) and here are my questions: WHAT I HAVE: I have 4 tabs on my workbook: 1. Spreadsheet Data 2. Instructions (where user is prompted for Pipeline, end/start dates for the query) 3. Database output data (the VBA script will pull up the data from Oracle database) 4. Tie out data tab (this is where I have trouble) QUESTIONS: 1) How to make the tie out page, using INDEX and MATCH, lookup values from my oracle database sheet and my spreadsheet? 2) Instead of PROMPTING the user for the pipeline, how may I create a drop down box so that the user selects ONE pipeline? This will reduce any user input errors (such as spelling, and etc). Thank you! MY CODE: Option Explicit Option Base 1 'user is prompted for dates and pipeline name 'click button will prompt query Dim cnnObject As ADODB.Connection Dim rsObject As ADODB.Recordset Dim strGPOTSConnectionString As String 'this will remove old sql data upon new query Dim ws As Worksheet Dim Pipeline As String Dim DateStart As Date Dim DateEnd As Date Dim strQuery As String Sub Say(s As String) Debug.Print s End Sub Sub ClickButton2() Debug.Print ("Button has been clicked") 'KGK Set ws = Worksheets("ZaiNet Data") ws.UsedRange.Clear '' remove results of previous query if any 'this will fill in null values in query as "data not available" Pipeline = InputBox("Enter PipeLine", "My Application", "Default Value") DateStart = InputBox("Enter Start Date", "My Application", DateTime.Date) DateEnd = InputBox("Enter End Date", "My Application", DateTime.Date + 1) Range("B1").Value = Pipeline Range("B2").Value = DateStart Range("B3").Value = DateEnd 'KGK: call to function to populate the IN() part of the SQL statement Dim dtInDate As String dtInDate = GetIN(DateStart, DateEnd) Debug.Print (" ") 'strQuery = "select pipelineflow.lciid lciid, ldate, volume, capacity, status, " & _ "pipeline, station, stationname, drn, state, county, owneroperator, companycode, " & _ "pointcode, pointtypeind, flowdirection, pointname, facilitytype, pointlocator, " & _ "pidgridcode from pipelineflow, pipelineproperties " & _ "where pipelineflow.lciid = pipelineproperties.lciid " & _ "and pipelineflow.audit_active = 1 " & _ "and pipelineproperties.audit_active =1 " & _ "and pipelineflow.ldate >= '" & Format(DateStart, "m/d/yyyy") & "' and pipelineflow.ldate
