[site]: stackoverflow
[post_id]: 1702339
[parent_id]: 1702298
[tags]: 
WITH data AS ( SELECT 1 AS id, 1 AS value UNION ALL SELECT 1 AS id, 2 AS value UNION ALL SELECT 2 AS id, 5 AS value ) SELECT id, COUNT(*) AS cnt, AVG(VALUE) AS a FROM data GROUP BY id WITH ROLLUP This query will return an extra row with NULL in id field and superaggregates in the corresponding fields.
