[site]: stackoverflow
[post_id]: 3732873
[parent_id]: 3728071
[tags]: 
The crash is caused by MFC referring invalid window handle (which passed in as parent) during creation. As a general rule, a thread can access only MFC objects that it created. This is because temporary and permanent Windows handle maps are kept in thread local storage to help maintain protection from simultaneous access from multiple threads. http://msdn.microsoft.com/en-us/library/h14y172e(VS.71).aspx an easy fix stated in the MSDN involves changing the code into ... m_pProdThread->PostThreadMessage(WM_INITPRODTHREADMESSAGE, PROD_CREATE_DLG, (LPARAM)this->GetSafeHwnd()); ... CScrollProductionView* pView = (CScrollProductionView*)CScrollProductionView::FromHandle((HWND)lParam); m_pProduction->Create(IDD_DLG_PROD, pView); m_pProduction->ShowWindow(SW_SHOW); Edit : Fixed the link to msdn.
