[site]: stackoverflow
[post_id]: 3504126
[parent_id]: 3499011
[tags]: 
Normally, I would just try to answer the way you are trying to do it, but since you asked for any better ideas, what I would do is have the Captcha actually on the login page and use the AuthComponents builtin methods and properties like loginRedirect, autoRedirect, and allow(). Then, just turn the captcha on/off based on the Captchas.loginAttempts variable. For your current method, I don't think you're going to get an elegant way of doing this. However, you might be able to change the properties of the AuthComponent to get what you want. You could change loginRedirect and loginAction so that /captchas/index is the new login form, then on successful captcha, set loginAction back to /users/login or whatever. This way, if someone were to attempt to hit /users/login directly without doing the captcha, then the AuthComponent logic would kick in and redirect to /captchas/index. Here are some relevant manual pages: http://book.cakephp.org/view/392/loginRedirect http://book.cakephp.org/view/382/allow http://book.cakephp.org/view/395/autoRedirect http://book.cakephp.org/view/391/loginAction Hope this helps!
