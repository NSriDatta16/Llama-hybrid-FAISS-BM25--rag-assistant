[site]: crossvalidated
[post_id]: 441125
[parent_id]: 
[tags]: 
Unbiased Metropolis-Hastings estimator of the form $\frac{\sum_{i=1}^nW_if(Y_i)}{\sum_{i=1}^nW_i}$. How do we need to choose $W_i$?

Let $(X_n)_{n\in\mathbb N_0}$ be the Markov chain generated by the Metorpolis-Hastings algorithm with proposal kernel $Q$ and target distribution $\mu$ and $(Y_n)_{n\in\mathbb N}$ denote the corresponding proposal sequence. Say we want to consider an estimator $A_nf$ for $\mu f$ , $f\in L^1(\mu)$ , of the form $$A_nf=\frac{\sum_{i=1}^nW_if(Y_i)}{\sum_{i=1}^nW_i}.$$ How do we need to choose the weights $W_i$ if $A_nf$ is supposed to be an unbiased estimator? Assume $Q$ and $\mu$ admit densities $q$ and $p$ with respect to a common reference measure $\lambda$ . In this paper , it is claimed that, assuming $\{p>0\}\subseteq\{q(x,\;\cdot\;)>0\}$ for all $x$ , $W_i=\rho(X_{i-1},Y_i)$ , where $$\rho(x,y):=\begin{cases}\displaystyle\frac{p(y)}{q(x,y)}&\text{, if }p(y)>0\\0&\text{, otherwise}\end{cases},$$ is a possible choice. How do we prove that the estimator is unbiased with this choice of $W_i$ ? And are other choices of $W_i$ possible? I could imagine that $W_i$ might depend on $X_0,\ldots,X_{i-1},Y_1,\ldots,Y_i$ .
