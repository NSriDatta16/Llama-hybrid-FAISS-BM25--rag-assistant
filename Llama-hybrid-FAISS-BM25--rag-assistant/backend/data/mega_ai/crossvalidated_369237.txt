[site]: crossvalidated
[post_id]: 369237
[parent_id]: 
[tags]: 
Drawing ROC curves from RFE() training results in caret

I want to generate ROC curves using the training data and results from the rfe function in caret. I have managed to do this with the code below but there is some inconsistency between the ROC value that caret gives me and the one that I calculate with proc package. I have read in a different forum that this is somewhat expected but I thing that the difference in my dataset is bigger (caret ROC 92.2%, pROC 89.15%)( ROC curve from training data in caret ) So my question is, is it normal to observe this difference, or the way I am calculating the ROC is wrong? I am posting a reproducible example below, any help or explanation is very much appreciated! data(PimaIndiansDiabetes) require(caret) require(pROC) rfFuncs$summary >rfe_rf Recursive feature selection Outer resampling method: Cross-Validated (10 fold, repeated 3 times) Resampling performance over subset size: Variables ROC Sens Spec ROCSD SensSD SpecSD Selected 1 0.7256 0.8680 0.3914 0.05285 0.06025 0.11233 2 0.7695 0.8380 0.5523 0.05231 0.04649 0.09403 3 0.8009 0.8367 0.5759 0.04652 0.06036 0.07620 4 0.8111 0.8313 0.6096 0.04365 0.05698 0.07724 5 0.8196 0.8353 0.5958 0.04531 0.05551 0.08942 6 0.8258 0.8513 0.5997 0.04613 0.05399 0.09011 7 0.8274 0.8467 0.5897 0.04363 0.05973 0.09633 8 0.8307 0.8620 0.6132 0.04679 0.05235 0.10762 * The top 5 variables (out of 8): glucose, mass, age, pregnant, insulin selectedIndices $pred$ Variables == rfe_rf $optsize require(pROC) ROC = plot.roc(rfe_rf$ pred $obs[selectedIndices], rfe_rf$ pred$neg[selectedIndices], legacy.axes = TRUE) ROC Call: plot.roc.default(x = rfe_rf $pred$ obs[selectedIndices], predictor = rfe_rf $pred$ neg[selectedIndices], legacy.axes = TRUE) Data: rfe_rf $pred$ neg[selectedIndices] in 1500 controls (rfe_rf $pred$ obs[selectedIndices] neg) > 804 cases (rfe_rf $pred$ obs[selectedIndices] pos). Area under the curve: 0.8287 I can reproduce the ROC given by caret by averaging the ROC values from each resample for the optimal subset. mean(rfe_rf $resample$ ROC[which(rfe_rf $resample$ Variables == 8)]) [1] 0.830746
