[site]: crossvalidated
[post_id]: 576934
[parent_id]: 
[tags]: 
Find correlation of complex data - xcorr and corrcoef vs direct multiplication

I'm coding a paper (on turbulent statistics) where it says find the time series correlation of complex data. It does that by taking the product of the vector and its complex conjugate (a velocity signal with the mean subtracted out called $\mathbf{u}$ ), then ensemble averaging spatially (weieghted by $r$ radially because its polar coordinates), ie $$C(t,t') = \frac{1}{T}\int_{[0,1]} \mathbf{u}(r,t) \mathbf{u}^*(r,t')\, r dr$$ where $u(r,t)$ is a complex vector and the $u^*$ indicates its complex conjugate. The end result needs to be a matrix - as later, I must do operations on a matrix, such as find eigenvectors. Implementing in Matlab, can I call corrcoef(u,ctranspose(u)) to achieve this? And specifically, I must call it on u and its complex conjugate, correct? Not just on u and u because $u\in\mathbb{C}$ . It seems I dont use xcorr, as I want to form a matrix (and not an array). But, could I conceivably use xcorr(u,u^*) (on u and u*, it seems) and then manually form a matrix from that (ie, the zero lag would live on the diagonals and the positive lags extend outward along each row)? I've read other posts (here and elsewhere) that claim the direct multiplication is equivalent to xcorr, and I examined xcorr to see what it does, which is just: take fft, pair multiply, then inverse fft. However, I seem to get much smooth results (which I desire anyhow), when I use xcorr and corrcoef, vs the direct multiplication! I hope I'm not conflating too many concepts here.
