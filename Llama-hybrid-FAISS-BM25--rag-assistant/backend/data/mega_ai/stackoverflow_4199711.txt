[site]: stackoverflow
[post_id]: 4199711
[parent_id]: 
[tags]: 
Complex average calculation

I have in my table values as the following: MONTH | value1 | value2| -------|--------|-------| 2010/08| 0 | 700 | 2010/08| 0 | 0 | 2010/08| 41166 | 1500 | 2010/09| 0 | 700 | 2010/09| 0 | 1500 | 2010/09| 0 | 0 | 2010/10| 0 | 0 | 2010/10| 0 | 1500 | 2010/10| 0 | 700 | 2010/11| 0 | 700 | 2010/11| 0 | 0 | 2010/11| 0 | 1500 | 2010/11| 0 | 0 | now this query returns me the sum of value2/value1 grouped by month SELECT month, SUM(value2) / SUM(value1)*100 as percent GROUP BY month ------------------------ MONTH | PERCENT --------|--------------- 2010/08 |5,3442161006656 2010/09 | 0 2010/10 | 0 2010/11 | 0 what i want is to calculate the average which can be done this way : SELECT AVG(percent) FROM ( SELECT month, SUM(value2) / SUM(value1)*100 as percent GROUP BY month) ------------- |AVG(percent)| -------------| |1,336 | but my problem is that i should not use a sub_query and should not use GROUP BY , is it possible? Thank you in advance for your answers
