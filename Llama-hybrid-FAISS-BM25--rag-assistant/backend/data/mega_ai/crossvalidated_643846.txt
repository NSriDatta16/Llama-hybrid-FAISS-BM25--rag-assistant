[site]: crossvalidated
[post_id]: 643846
[parent_id]: 326405
[tags]: 
Here is a second approach to correct for age heaping and estimate the true population frequencies, without using splines. The gist of this approach is to model the age heaping process explicitly. Age heaping occurs when a person doesn't know their age exactly and rounds up/down to the nearest "milestone" age. For example, a person who is 41 rounds down and reports 40; a person who is 44 rounds up and reports 45. So the observed frequencies $\hat{\mathbf{p}}$ are a "corrupted" version of the true frequencies $\mathbf{p}$ . I came across this method in Bayesian Statistical Modeling with Stan, R, and Python by Kentaro Matsuura. The data and scripts can be found in this GitHub repo . The age heaping example is covered in Section 12.3; see model 12—4. The first step is to code up the "flow" from true age to milestone age. (The flow is partial as many people report correctly their age and their child's age.) I started with milestone ages every 5th year (ie. ..., 40, 45, 50, ...) but it's clear from the OP's plot of the raw population frequencies that in this case the age heaping process is less regular; for example there is some heaping on 42 and 48 as well. So I ended up with allowing flow into every age that has a local peak. I also make a strong assumption about the direction of the flow: there is some probability (to be estimated) that a person mis-reports their age but if the age is mis-reported it's always assigned to the same milestone age. For example: 41→40, 43→42, 44→45, 46→45. This seems too rigid of an assumption but keeps (the model of) the age heaping process simple. To complete the model, I also put an informative normal(0, 1) prior on the second-order differences of the true population proportions $\mathbf{p}$ . This encourages smoothness but some traces of age heaping do remain. The dip at ages 0 and 1 also remains; this detail probably cannot be addressed satisfactorily by modeling the census data alone; it requires understanding the reasons, if any, why babies may be under-counted.
