[site]: stackoverflow
[post_id]: 4170803
[parent_id]: 
[tags]: 
Programmatically reading VS .coveragexml file in C#

So I have some code that can read the methods out of a .coverage file... using (CoverageInfo info = CoverageInfo.CreateFromFile(this.myCoverageFile)) { CoverageDS ds = info.BuildDataSet(); foreach (ICoverageModule coverageModule in info.Modules) { CodeModule currentModule = new CodeModule(coverageModule.Name); byte[] coverageBuffer = coverageModule.GetCoverageBuffer(null); using (ISymbolReader reader = coverageModule.Symbols.CreateReader()) { Method currentMethod; while (reader.GetNextMethod(out currentMethod, coverageBuffer)) { if (currentMethod != null) { currentModule.Methods.Add(currentMethod); } } } returnModules.Add(currentModule); } } ... but I want to be able to read .coverage files that have been exported to xml too. The reason for this is that .coverage files require the source dlls be in the exact location they were when code coverage was measured, which doesn't work for me. When I try to load a coveragexml file using CreateFromFile(string) I get the following exception. Microsoft.VisualStudio.Coverage.Analysis.InvalidCoverageFileException was unhandled Message=Coverage file "unittestcoverage.coveragexml" is invalid or corrupt. The coveragexml file opens in Visual Studio just fine, so I don't believe there's any issue with the file's format. I know that CoverageDS can import an xml file, but the API is less than intuitive and the only example I can find of its use is... using(CoverageInfo info = CoverageInfo.CreateFromFile(fileString)) { CoverageDS data = info.BuildDataSet(); data.ExportXml(xmlFile); } ...which tells me nothing about how to actually read the coverage data from that file. Does someone know how to process code coverage data from a .coveragexml file?
