[site]: stackoverflow
[post_id]: 3990501
[parent_id]: 3989992
[tags]: 
Here's some quick and dirty C# code. Basically just primitive file IO stuff. It's not great, but I did whip it up in around 3 minutes. This code implies that function blocks are demarcated with a comment line of "//FunctionStart" at the beginning and "//FunctionEnd" at the end. There are more elegant ways of doing this, this is the fast/dirty/hacky approach. Using a managed app to do this task is probably overkill, but you can do a lot of custom stuff by simply adding on to this function. private void InsertMacro(string filePath) { //Declrations: StreamReader sr = new StreamReader(filePath); StreamWriter sw = new StreamWriter(filePath + ".tmp"); string line = ""; bool validBlock = false; //Go through source file line by line: while ((line = sr.ReadLine()) != null) { if (line == "//FunctionStart") validBlock = true; else if (line == "//FunctionEnd") validBlock = false; sw.WriteLine(line); if (validBlock) sw.WriteLine("MYMACRO"); } //Replace legacy source with updated source: File.Delete(filePath); File.Move(filePath + ".tmp", filePath); //Clean up streams: sw.Close(); sr.Close(); }
