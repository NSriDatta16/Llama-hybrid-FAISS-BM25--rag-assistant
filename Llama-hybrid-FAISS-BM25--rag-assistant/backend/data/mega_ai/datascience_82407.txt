[site]: datascience
[post_id]: 82407
[parent_id]: 
[tags]: 
How to balance dataset using fit_generator() in Keras?

I am trying to use keras to fit a CNN model to classify 2 classes of data . I have imbalanced dataset I want to balance my data equally. How I can do that ?? Any help would be appreciated The main code: def generate_arrays_for_training(indexPat, paths, start=0, end=100): while True: from_=int(len(paths)/100*start) to_=int(len(paths)/100*end) for i in range(from_, int(to_)): f=paths[i] x = np.load(PathSpectogramFolder+f) x = np.expand_dims(x, axis=0) if('P' in f): y = np.repeat([[0,1]],x.shape[0], axis=0) else: y =np.repeat([[1,0]],x.shape[0], axis=0) yield(x,y) history=model.fit_generator(generate_arrays_for_training(indexPat, filesPath, end=75), validation_data=generate_arrays_for_training(indexPat, filesPath, start=75), steps_per_epoch=int((len(filesPath)-int(len(filesPath)/100*25))), validation_steps=int((len(filesPath)-int(len(filesPath)/100*75))), verbose=2, epochs=15, max_queue_size=2, shuffle=True, callbacks=[callback]) ```
