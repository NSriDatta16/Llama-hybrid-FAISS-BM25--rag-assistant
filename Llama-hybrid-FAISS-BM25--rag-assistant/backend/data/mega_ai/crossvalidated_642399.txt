[site]: crossvalidated
[post_id]: 642399
[parent_id]: 
[tags]: 
Protein conservation analysis with trident scores in R script

I am currently working on analyzing protein conservation across amino acid positions using Trident scores as output from the MstatX tool. I have 40,000 Trident score files, each containing amino acid positions and their respective scores. To streamline my analysis, I initially wrote a bash script to loop through each file and then implemented an R script for the calculations. The R script calculates moving averages with different spans to identify regions with high deviation in local protein conservation, referred to as "hotspots." These hotspots are then analyzed to determine the strongest deviation, its position, and related metrics. Here is a snippet of my R script: # assign input files to a vector args = commandArgs(trailingOnly = T) # put sample name in variable sample $AA.pos Entropy.Score Entropy.Score # make sample name nicer sub("_entropyscores", "", sample)->sample # load ggplot library(ggplot2) # calculate short and long moving averages mydata $y rolling_mean_50 y ratios = 0.9*median(raw.entropy$Entropy.Score)){ lowerbound = 0.9*median(raw.entropy$Entropy.Score)){ upperbound hotspot ratios[hotspot]->cutoff layer_data(mydata, 3) $x[hotspot]->x percentile AA.pos)*100 # write relevant items to standard output # order is cluster name, strongest deviation, rounded amino acid position, percentile where deviation occurred cat(sprintf("%s %s %s %s %s\n", sample, cutoff, round(x), round(percentile, 2)), file="./output_deviation.txt", append=TRUE) After writing the output file, I aim to create a density plot with the x-axis representing the strongest deviation of each input file. However, the current method does not capture the expected bimodal distribution. I am seeking advice on alternative ways to calculate small but strong deviations beyond using simple moving averages. Some options I've explored include EMA, z-scores, step detection, and anomaly detection. I would greatly appreciate any insights or suggestions.
