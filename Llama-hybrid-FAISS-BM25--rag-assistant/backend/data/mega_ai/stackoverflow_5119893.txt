[site]: stackoverflow
[post_id]: 5119893
[parent_id]: 4281531
[tags]: 
you need to read the source for ifconfig(8), which describes how to get the status of every attached network interface. pay particular attention to in_status(), which gets the inet address and netmask of an interface. when the source or destination address in the traffic has the same host as a local interface int is_local = (src && netmask) == (ifaddr && netmask) || (dst && netmask) == (ifaddr && netmask) then you can be sure that it is local http://www.opensource.apple.com/source/network_cmds/network_cmds-307/ifconfig.tproj/ifconfig.c
