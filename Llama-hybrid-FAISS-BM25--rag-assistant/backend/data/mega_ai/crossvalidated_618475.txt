[site]: crossvalidated
[post_id]: 618475
[parent_id]: 618436
[tags]: 
The R time-dependence vignette is a useful resource on this type of problem, deserving careful study to help figure out what to do in such situations. A few thoughts that might help. First, sometimes an apparent violation or proportional hazards (PH) comes from a poorly specified model. Two answers on this page provide (1) an explanation of how this can happen with a poorly modeled continuous covariate and (2) a brief outline of how to proceed. Even though the predictor in question here seems to be categorical, if there is a poorly modeled continuous predictor in the model that is correlated with this predictor you could end up in the same trouble. This might also represent a missing predictor or interaction term in the model. For example, if these are criminal recidivism data, might there be a change in the association of this predictor with outcome when an individual is released from probation or parole? Then the model might need to include a time-varying covariate for the probation/parole status, which could fix this apparent violation of PH. Second, decide whether the violation of PH is big enough to worry about. If PH is violated, the reported coefficient is a type of event-averaged hazard that can sometimes be good enough to use in practice. The dashed lines are supposed to represent the error estimate for the smooth, in which case you can see if the trend is large compared to the error in estimating the trend. If other predictors are more strongly associated with outcome, you might decide, based on your understanding of the subject matter, not to worry about a PH violation for this particular predictor. Unfortunately, it's hard to gauge that from the plot you show, which seems to be based on software in the survminer package that had a serious error in this type of plot for many years. In this plot, unlike what you would get from a standard plot of cox.zph() output directly, those lines are much too far apart and the y-axis limits make it difficult to see details in the pattern of residuals. Although that error might have been fixed in more recent versions, the extraordinary delay in removing two erroneous characters from a single line of code has led me not to trust the package at all. Use the standard plot of cox.zph() output instead. Third, I think that what you really want to add (if necessary) is a time-varying coefficient for the predictor rather than a time-varying covariate . Yes, a time-varying coefficient is effectively modeled by constructing a time-varying covariate within the model, but thinking in terms of the coefficient is simpler. Apply your understanding of the subject matter to gauge whether there is some reason why the association of the predictor with outcome might change over time. For example, is something happening at 365 days that might change the association of the predictor with outcome? If so, then a step-change coefficient as demonstrated in Section 4.1 of the time-dependence vignette might be a good choice. Otherwise, a continuously varying coefficient might be needed, as in Section 4.2. Either way, focus on how you think the form of the association over time should change, and let the software (via the tt() term in a coxph() model) construct the time-varying covariate that underlies the estimation of the time-varying coefficient.
