[site]: crossvalidated
[post_id]: 610046
[parent_id]: 
[tags]: 
Functional analysis in R with fda

I'm working with time series data for drug response. And, I wanted to as is there are some alternative ways to analyse it since the FDA package in R is not working in my case. The type of my data is as follows: > head(subset_df) # A tibble: 6 × 4 # Groups: Model, Drug [1] Model Day AUC Drug 1 AB050 1 0.241 (+)-KT5 2 AB050 3 0.505 (+)-KT5 3 AB050 4 0.598 (+)-KT5 4 AB050 5 0.675 (+)-KT5 5 AB050 6 0.712 (+)-KT5 6 AB050 7 0.734 (+)-KT5 > str(subset_df) gropd_df [102 × 4] (S3: grouped_df/tbl_df/tbl/data.frame) $ Model: chr [1:102] "AB050" "AB050" "AB050" "AB050" ... $ Day : int [1:102] 1 3 4 5 6 7 0 1 2 3 ... $ AUC : num [1:102] 0.251 0.515 0.608 0.685 0.722 ... $ Drug : chr [1:102] "(+)-KT5" "(+)-KT5" "(+)-KT5" "(+)-KT5" ... - attr(*, "groups")= tibble [17 × 3] (S3: tbl_df/tbl/data.frame) .. $ Model: chr [1:17] "AB050" "AB666K" "AB8789" "AB1578" ... ..$ Drug : chr [1:17] "(+)-KT56" "(+)-KT56" "(+)-KT56" "(+)-KT56" ... ..$ .rows: list [1:17] xyplot(AUC ~ Day, data = subset_df, groups = Model, type = "l", xlim = c(0,7), auto.key = list(columns = 4)) This plot represents a subset data for a single drug; each line depicts a Model tested with that single drug across time and the y-axis is the AUC value estimated at that time. In general, we have 50 drugs with different models as well. So what I would like to do is an analysis of each Model across time in a functional analysis way in R. In the sense of representing each Model curve as a function and be able to kind of estimate a pattern of the drugs based on the estimated functions for each model. This is what I have tried so far, but without luck: #Tried to create a list of functional data objects that the fda package requires for each curve: fdobj_list $Model), function(model) { model_df AUC, fdPar = fdParobj) }) But I cannot make it work:. I do not know if I am missing the convergence of the fda or the data set is weird. I am quite lost hehe Do you know if this a good way to analyse this data or is it better to approach it with B-spline, or how can I analyse it. Thanks in advance. Update Ok, reading the paper https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-019-0666-3 I tried to implement the Bspline approach: library(bspline) library(spline) model_names $Day, knots = c(min(model_data$ Day), median(model_data $Day), max(model_data$ Day))) # Create a data frame with the fitted curve and model name bspline_model $Day, AUC = predict(bspline_fit)) bspline_model$ Model I get bizarre results.... Do you know what happened here? : Another simpler approach is just by plotting the smooth lines: library(splines) library(lattice) # Get unique Model names model_names $Day, model_data$ AUC, df = 5) # Add the fitted curve to the list spline_list[[i]] But I got problems plotting this...: Update I tried to follow this lecture: https://www.r-users.gal/sites/default/files/fda_usc.pdf But the fda.usc package showed tons of errors... Update plot_obj $x, spline_fit$ y, col = "red") }, add = plot_obj) } print(plot_obj) But I am not getting the smooth line... Sorry for the problems.... Any insights and help is very welcome... Thanks...
