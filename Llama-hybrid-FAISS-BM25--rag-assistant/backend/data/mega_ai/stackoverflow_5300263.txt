[site]: stackoverflow
[post_id]: 5300263
[parent_id]: 5296515
[tags]: 
If you know the sum of the kernel, why not correct the brightness after convolution by dividing by the correct factor? (For example you can take a 3x3 average with the kernel [1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9] , but also with [2, 2, 2, 2, 2, 2, 2, 2, 2] then divide the resulting values by 18 ...) EDIT: As stated in my comment, h1 sums to 0. It appears that h0 and h1 are reversed / inverse of each other, so some of the h0 coefficients may have the wrong sign. EDIT2: Please read comments. I know this post does not answer the question, I am leaving it here for the comments.
