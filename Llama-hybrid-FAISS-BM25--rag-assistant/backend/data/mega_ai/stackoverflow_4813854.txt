[site]: stackoverflow
[post_id]: 4813854
[parent_id]: 4813440
[tags]: 
An inverted use of a read/write lock may work. In this idiom, the read lock holders perform concurrent writes to the data structure (e.g. independent slots in an array). The write lock is used to acquire exclusive access to perform a consistent read (e.g. summing the array). This is a rarely used idiom, but elegant in those oddball cases. Your problem is a bit hard to grok, but this may at least offer some inspiration for a concrete solution. I suspect with a deeper understanding, the problem could be simplified so that a classical solution is more appropriate.
