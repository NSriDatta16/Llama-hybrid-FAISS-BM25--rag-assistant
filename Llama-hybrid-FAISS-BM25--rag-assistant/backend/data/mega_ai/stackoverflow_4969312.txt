[site]: stackoverflow
[post_id]: 4969312
[parent_id]: 4959768
[tags]: 
A solution! AdomdCommand cmdPDC = conPDC.CreateCommand(); cmdPDC.CommandText = "SELECT NON EMPTY [Dim Unit].[All Units].[Category Name].Members ON 0 FROM [MY CUBE] WHERE (StrToMember(@CompanyId),StrToMember(@LocationId))"; string companyid = "[123]"; string locationid = "[1]"; string sCompanyId = "[Dim Company].&" + companyid; string sLocationId = "[Dim Location].&" + companyid + "&" + locationid; cmdPDC.Parameters.Add(new AdomdParameter("CompanyId", sCompanyId)); cmdPDC.Parameters.Add(new AdomdParameter("LocationId", sLocationId)); And a few little pointers. You may receive this error: "X parameter could not be resolved because it was referenced in an inner subexpression" Resolution: When inserting the @CompanyId in the quoted string, make sure the parameter is not enclosed in apostrophes (') - c# is clever and will convert the data type and add these apostrophes in for you. However, you won't be able to see it in a watch window and all would appear to be fine. All items are returned and it would appear that your parameters are being ignored. Resolution: Check the very first SELECT and make sure it is SELECT NON EMPTY .
