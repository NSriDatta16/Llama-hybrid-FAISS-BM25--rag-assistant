[site]: stackoverflow
[post_id]: 1674262
[parent_id]: 1670690
[tags]: 
If you don't want to read from the socket anymore, just don't read from the socket. If you want to close the socket, just close it. If you want the server to close the connection when it's done serving your request, ensure you send the 'Connection: close' header with your request. If you think you might hurt the server's feelings, you can just read everything that's left and not do anything with it. However, this gives the server a chance to stream endless gobs of data at you, keeping your socket open forever. If you really need to process it yourself in your code, you probably want to handle the header and message body separately. Once you see the complete header, you can check that it had the fields you need. If not, you close the sock and return: sub read_sock { HEADER: while( ) { last if /^[\r\n]+$/; # blank line terminating header ... parse header lines into %headers... } unless( exists $headers{'content-length'} ) { warn "No Content-Length! Stopping!\n"; close SOCK; return; } MESSAGE_BODY: while( ) { ... read(), etc ... } return $message_body; } There's probably a better way to do that with LWP::UserAgent though. You can define your own content handler and do whatever you like in it.
