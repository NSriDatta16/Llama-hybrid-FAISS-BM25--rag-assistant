[site]: crossvalidated
[post_id]: 135219
[parent_id]: 
[tags]: 
Is this a job for mixture of experts regression or semi-hidden markov models or something else?

Data I have several thousand timeseries each comprising around 365 data points. Browsing through a few of them, it looks like each timeseries consists of several regimes (different number f regimes per series). I think each regime could be adequately modelled using a GLM, i.e. within each regime, the data looks like it is either normally or poisson distributed around a mean which is itself a linear function of time. Question I am looking for a technique that can automatically run across all thousand timeseries and identify the best start and end points for each regime, as well as fit a GLM to each regime. If there was no trend in each regime, I could do this using a semi-hidden markov model. I'm wondering if there is a technique that extends semi-hidden markov models so that the emission distribution accepts covariates? And if so, is there an R package that implements this? Or is this a mixture of experts regression? I've had a look at {mixtools} and it doesn't seem encouraging. I've looked into Bai & Parson's work from econometrics, but this seems like it will only work if the regime can be modeled with a GLM with gaussian link, and I don't love that this procedure requires a 'run in' period within each regime - i'd like to be able to discover arbitrarily short regimes. Software I'm working in R, but can probably use Python to do this in a pinch. Worst case, MATLAB.
