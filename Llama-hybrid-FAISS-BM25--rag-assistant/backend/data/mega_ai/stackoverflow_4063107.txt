[site]: stackoverflow
[post_id]: 4063107
[parent_id]: 4061966
[tags]: 
I suggest you try Ragel , It can generate efficient scanners that can do longest match/backtracking. See chapter 6.3 in the Ragel user guide for more information. I've created a tiny test which I think matches your specification, this is only the state machine description, without the code to feed input: %%{ machine test; main := |* 's' => { puts("s-val");}; 'stack' => { puts("stack-val");}; 'over' => { puts("over-val");}; 'overflow' => { puts("overflow-val");}; # Anything else matches to any, outputs a '?' and continues any => {putc('?');}; *|; }%%
