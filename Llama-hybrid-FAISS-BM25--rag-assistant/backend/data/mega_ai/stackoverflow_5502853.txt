[site]: stackoverflow
[post_id]: 5502853
[parent_id]: 
[tags]: 
Rx DragBehavior -> Why is my Element not moving

I wrote a DragBehavior based on the general Drag and Drop examples. While this is working without being in a Behavior, it is not moving when I place the code in a behavior. Behavior: public class DragBehavior : Behavior { protected override void OnAttached() { Window mainCanvas = Application.Current.MainWindow; var mouseDown = from evt in AssociatedObject.GetMouseLeftButtonDown() select evt.EventArgs.GetPosition(mainCanvas); var mouseUp = from evt in AssociatedObject.GetMouseLeftButtonUp() select evt.EventArgs.GetPosition(mainCanvas); var mouseMove = from evt in AssociatedObject.GetMouseMove() select evt.EventArgs.GetPosition(mainCanvas); var q = from start in mouseDown from delta in mouseMove.StartWith(start).TakeUntil(mouseUp) .Let(mm => mm.Zip(mm.Skip(1),(pre,cur) => new{ X= cur.X - pre.X, Y= cur.Y - pre.Y})) select delta; q.Subscribe(value => { Canvas.SetLeft(AssociatedObject, Canvas.GetLeft(AssociatedObject) + value.X); Canvas.SetTop(AssociatedObject, Canvas.GetTop(AssociatedObject) + value.Y); }); } } Helper Methods: public static IObservable > GetMouseMove( this UIElement inputElement) { return Observable.FromEvent( (EventHandler h) => new MouseEventHandler(h), h => inputElement.MouseMove += h, h => inputElement.MouseMove -= h); } public static IObservable > GetMouseLeftButtonDown(this UIElement inputElement) { return Observable.FromEvent( (EventHandler genericHandler) => new MouseButtonEventHandler(genericHandler), h => inputElement.MouseLeftButtonDown += (h), h => inputElement.MouseLeftButtonDown -= (h)); } public static IObservable > GetMouseLeftButtonUp(this UIElement inputElement) { return Observable.FromEvent( (EventHandler genericHandler) => new MouseButtonEventHandler(genericHandler), h => inputElement.MouseLeftButtonUp += h, h => inputElement.MouseLeftButtonUp -= h); }}
