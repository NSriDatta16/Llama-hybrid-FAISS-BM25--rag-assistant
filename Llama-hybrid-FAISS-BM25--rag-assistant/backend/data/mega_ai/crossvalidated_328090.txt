[site]: crossvalidated
[post_id]: 328090
[parent_id]: 250440
[tags]: 
In R, the 'cartels.test' option 'positive.correlated' is for too few runs alternative hypotheses, and 'negative.correlation' for too many runs. Thus for a linear time series 'positive.correlated' will be significant: > require(lawstat) > plot(1:100+rnorm(100), type="b",xlim=c(0,100), xlab="Run", ylab="Data", pch=20) > bartels.test(1:100, alternative = "positive") Bartels Test - Positive Correlated data: 1:100 Standardized Bartels Statistic = -9.9941, RVN Ratio = 0.0011881, p-value bartels.test(1:100, alternative = "negative") Bartels Test - Negative Correlated data: 1:100 Standardized Bartels Statistic = -9.9941, RVN Ratio = 0.0011881, p-value = 1 For oscillatory time series, 'negative.correlation' will be significant: > plot(sin(pi/2*(seq(1,100,2)))+rnorm(100), type="b",xlim=c(0,100), xlab="Run", ylab="Data", pch=20) > bartels.test((sin(pi/2*(seq(1,100,2)))+rnorm(100)), alternative = "positive") Bartels Test - Positive Correlated data: (sin(pi/2 * (seq(1, 100, 2))) + rnorm(100)) Standardized Bartels Statistic = 5.2674, RVN Ratio = 3.0535, p-value = 1 > bartels.test((sin(pi/2*(seq(1,100,2)))+rnorm(100)), alternative = "negative") Bartels Test - Negative Correlated data: (sin(pi/2 * (seq(1, 100, 2))) + rnorm(100)) Standardized Bartels Statistic = 4.7944, RVN Ratio = 2.9589, p-value = 8.16e-07 But oscillatory for the Bartels test means that 'diff(X)' changes sign for every run. If the oscillation takes more than one data point, it will yield 'less' runs than expected. This is the case with your example above where the from a minimum to a maximum takes 3 runs (I used only 100 points to avoid a cluttered plot): > plot(sin(1:100), type="b",xlim=c(0,100), xlab="Run", ylab="Data", pch=20) > bartels.test((sin(1:100)), alternative = "positive") Bartels Test - Positive Correlated data: (sin(1:100)) Standardized Bartels Statistic = -5.285, RVN Ratio = 0.94299, p-value = 6.284e-08 > bartels.test((sin(1:100)), alternative = "negative") Bartels Test - Negative Correlated data: (sin(1:100)) Standardized Bartels Statistic = -5.285, RVN Ratio = 0.94299, p-value = 1
