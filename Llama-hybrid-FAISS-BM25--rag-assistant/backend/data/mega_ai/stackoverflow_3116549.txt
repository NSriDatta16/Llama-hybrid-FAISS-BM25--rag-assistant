[site]: stackoverflow
[post_id]: 3116549
[parent_id]: 3114671
[tags]: 
I suggest doing that using pcap_t since using WinPcap is better than writing it yourself. The following steps is how to do it: Use pcap_open_dead() function to create a pcap_t . Read the function description here . The linktype for Ethernet is 1. Use pcap_dump_open() function to create a pcap_dumper_t . Use pcap_dump() function to write the packet to the dump file. I hope this would help you.
