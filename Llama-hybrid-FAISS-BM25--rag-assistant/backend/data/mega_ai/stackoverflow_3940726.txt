[site]: stackoverflow
[post_id]: 3940726
[parent_id]: 
[tags]: 
new XMLHttpRequest cannot run on Firefox

The script below work perfectly in IE for the XML respond. But seems i cant figured out how to run on Firefox or Chorme. Try few modification but still not able to run it. Kindly need assistant. var xmlhttp; var timeStamp; var currentTime = new Date() var month = currentTime.getMonth() + 1 var day = currentTime.getDate() //remove the + 1 afterwards var year = currentTime.getFullYear() var hour = currentTime.getHours() var minutes = currentTime.getMinutes() var second = currentTime.getSeconds() + 1 timeStamp = day + "/" + month + "/" + year + " " + hour + ":" + minutes + ":" + second; function on_click() { var xmlToSend = " "; xmlToSend += " "; xmlToSend += " "; xmlToSend += " "; / var xmldoc = new ActiveXObject("Microsoft.XMLDOM"); xmldoc.loadXML(xmlToSend); if (window.XMLHttpRequest) {/ / code for IE7 + , Firefox, Chrome, Opera, Safari xmlhttp = new XMLHttpRequest(); } else { // code for IE6, IE5 xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); } xmlhttp.onreadystatechange = state_Change; xmlhttp.open("POST", "http://SENDERDDRESS:4509/resd", false); xmlhttp.setRequestHeader("SOAPAction", "http://www.mhe.com/SRP/requestVinRequest"); xmlhttp.setRequestHeader("Content-Type", "text/xml"); xmlhttp.setRequestHeader("User-Agent", "Jakarta Commons-HttpClient/3.0.1"); xmlhttp.setRequestHeader("Host", "SENDERDDRESS:4509"); xmlhttp.setRequestHeader("Content-Length", "391"); xmlhttp.send(xmldoc); var objResponse = document.getElementsByTagName("Appointment"); objResponse.innerText = xmlhttp.responseXML.xml; } function state_Change() { if (xmlhttp.readyState == 4) { if (xmlhttp.status == 200) { txt = " Time Plate No. Status "; x = xmlhttp.responseXML.documentElement.getElementsByTagName("Appointment"); for (i = 0; i " + xx[0].firstChild.nodeValue + " "; } catch (er) { txt = txt + " "; } } xx = x[i].getElementsByTagName("NumberPlate"); { try { txt = txt + " " + xx[0].firstChild.nodeValue + " "; } catch (er) { txt = txt + " "; } } xx = x[i].getElementsByTagName("statusCode"); { try { txt = txt + " " + xx[0].firstChild.nodeValue + " "; } catch (er) { txt = txt + " "; } } txt = txt + " "; } txt = txt + " "; document.getElementById('txtCDInfo').innerHTML = txt; } else { } } }
