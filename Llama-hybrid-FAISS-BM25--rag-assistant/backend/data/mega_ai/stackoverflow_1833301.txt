[site]: stackoverflow
[post_id]: 1833301
[parent_id]: 1832562
[tags]: 
Here is something that should work.... select avg(mon+tues+weds+thur+fri) as averageall, sum(mon+tues+weds+thur+fri) as sumall, avg(mon) as avgmon, avg(tues) as avgtues, avg(weds) as avgweds, avg(thurs) as avgthurs, agv(fri) as avgfri, MAX((SIGN(spots)-1) + 1) AS beds from ( SELECT rooms.name, rooms.id, CASE WHEN EXTRACT(DOW FROM availables.bookdate) = 1 THEN (availables.price) ELSE 0 END) AS mon, CASE WHEN EXTRACT(DOW FROM availables.bookdate) = 2 THEN (availables.price) ELSE 0 END) AS tues, CASE WHEN EXTRACT(DOW FROM availables.bookdate) = 3 THEN (availables.price) ELSE 0 END) AS weds, CASE WHEN EXTRACT(DOW FROM availables.bookdate) = 4 THEN (availables.price) ELSE 0 END) AS thur, CASE WHEN EXTRACT(DOW FROM availables.bookdate) = 5 THEN (availables.price) ELSE 0 END) AS fri, spots, rooms.id, rooms.name FROM availables INNER JOIN rooms ON availables.room_id=rooms.id WHERE availables.room_id = '1780' AND availables.price > 0 ) GROUP BY rooms.id, rooms.name ) note I did not test so there might be typos.
