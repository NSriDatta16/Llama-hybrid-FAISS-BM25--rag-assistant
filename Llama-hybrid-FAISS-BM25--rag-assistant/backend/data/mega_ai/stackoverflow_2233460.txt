[site]: stackoverflow
[post_id]: 2233460
[parent_id]: 
[tags]: 
Mechanize not recognizing anchor tags via CSS selector methods

(Hope this isn't a breach of etiquette: I posted this on RailsForum, but I haven't been getting much response from there recently.) Has anyone else had problems with Mechanize not recognizing anchor tags via CSS selectors? The HTML looks like this (snippet with white space removed for clarity): 10 Current Events Banks and the Fed 10:30am- 11:45am I'm trying to collect the data from these events. Everything is working except getting the anchor within the . There's clearly an tag inside the , and I'm going to need to follow that link to get further details on this event. In my rake task, I have: agent.page.search(".calendarCell,.calendarToday").each do |item| day = item.at("a").text item.search("p").each do |e| anchor = e.at("a") puts anchor puts e.inner_html end end What's interesting is that the item.at("a") always returns the anchor. But the e.at("a") returns nil. And when I do inner_html on the p element, it ignores the anchor entirely. Example output: nil Photo Club Indexing Slide Collections 2:00pm- 3:00pm However, when I run the same scrape directly with Nokogiri: doc.css(".calendarCell,.calendarToday").each do |item| day = item.at_css("a").text item.css("p").each do |e| link = e.at_css("a")[:href] puts e.inner_html end end It recognizes the inside the , and it will return the href, etc. Bridge Party Party Bridge 7:00pm- 9:00pm Mechanize is supposed to use Nokogiri, so I'm wondering if I have a bad version or if this affects others as well. Thanks for any leads.
