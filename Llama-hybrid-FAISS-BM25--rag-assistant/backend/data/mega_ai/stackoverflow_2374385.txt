[site]: stackoverflow
[post_id]: 2374385
[parent_id]: 2370530
[tags]: 
Did you try overriding window proc of the console window? ie once you have obtained the window handle with GetConsoleWindow and then hooked its window proc with SetWindowLongPtr , you have to listen the WM_SYSCOMMAND message. See this article on how to process menu items from system menu.
