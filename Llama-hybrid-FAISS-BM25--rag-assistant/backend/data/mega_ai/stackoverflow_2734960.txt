[site]: stackoverflow
[post_id]: 2734960
[parent_id]: 2734905
[tags]: 
You haven't mentioned the customer data anywhere so I'll assume it's in the Sales table You need to filter and restrict the Sales table first to the customers with more the 3 sales, then join to get product category and get the average across categories select Products.Category, AVG(SalePrice) from (SELECT ProductID, SalePrice FROM Sales GROUP BY CustomerID HAVING COUNT(*) > 3) S inner join Products on Products.ProductID = S.ProductID group by Products.Category
