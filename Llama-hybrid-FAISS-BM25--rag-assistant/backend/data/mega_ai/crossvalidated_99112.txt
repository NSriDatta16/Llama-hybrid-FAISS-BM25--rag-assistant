[site]: crossvalidated
[post_id]: 99112
[parent_id]: 97899
[tags]: 
I realised that my comparisons of fitted and actual proportions in the first graph, top right-hand corner, are not the best way to assess model fit, since in the big data I can caclulate proportions for ABC categories, but with the model fit where all four variables are included, proportions are predicted for each ABCD category. I fitted a new model on the subdata, where I removed D: glm(R~A+B+C, family=binomial, data=subdata) So that I can compare the predictions of this model fitted with the subdataset, and the true proportions in the big dataset, and assess wether my weighting does what I expect it to do. The result is: Predictions of the new model against proportions in the big dataset. Now I think the answer is: yes, definitely. Hence, this answered to my questions 1 (I properly understand King and Zheng (2001), at least the weighting method) and 3 (I can apply King and Zheng's (2001) weighting correction despite the fact that I have a value of $\tau$ and a value of $\bar{y}$ for each ABC category instead of global values). The two other questions were: Why is it so important to include A, B, and C in the model to get a good fit and why their effect is significant. Is it due as I suggested to the fact I deparse a lot from the half / half proportions of 0 and 1 in my subset and differently in the different ABC categories? -> I think my expectation that including A+B+C in the model should have no effect because all ABC categories should contain approximately half of 0 and 1 observation would be true with a non-weighted linear model (actually, when you compare my two top left-hand corner graphics, there is not a lot of difference between them... but still, B and C have a significant effect in this non-weighted linear model.. I will consider this is because the departure from the 50/50), but not necessarily with a weighted linear model. Is it an issue that my D variable is so unbalanced, and if it is, how can I handle it? (Is "double weighting", i.e. weighting the weights, possible?). -> I think about using the Anova function of the 'car' library for a logistic regression (specifying 'test.statistic="LR"' ). In that case, the function weights the cells directly to make type II SS, so I can keep the 'weight' option for the rare events correction.
