[site]: stackoverflow
[post_id]: 5401181
[parent_id]: 5401158
[tags]: 
val is your time column, x and y are two references to the data table (you can write data AS x, data AS y ). EDIT: To avoid computing your sums twice, you can store the intermediate results. CREATE TEMPORARY TABLE average_user_total_time (SELECT SUM(time) AS time_taken FROM scores WHERE created_at >= '2010-10-10' and created_at Then you can compute median over these values which are in a named table. EDIT: Temporary table won't work here. You could try using a regular table with "MEMORY" table type. Or just have your subquery that computes the values for the median twice in your query. Apart from this, I don't see another solution. This doesn't mean there isn't a better way, maybe somebody else will come with an idea.
