[site]: stackoverflow
[post_id]: 5565664
[parent_id]: 
[tags]: 
Query tuning SQL Server 2008

I have a view name "vw_AllJobsWithRecruiter". ALTER VIEW dbo.vw_AllJobsWithRecruiter AS SELECT TOP(SELECT COUNT(iJobID_PK) FROM dbo.tbUS_Jobs) iJobId_PK AS JobId, dbo.ufn_JobStatus(iJobId_PK) AS JobStatus, dbo.ufn_RecruiterCompanyName(iJobId_PK) AS CompanyName, sOther AS OtherCompanyName FROM dbo.tbUS_Jobs WHERE bDraft = 0 ORDER BY dtPostedDate DESC This view contains only 3278 number of rows. If I execute the below query : SELECT * FROM vw_AllJobsWithRecruiter WHERE OtherCompanyName LIKE '%Microsoft INC%' It is taking less than a second to execute. Now my problem is: If I use the query below query: SELECT * FROM vw_AllJobsWithRecruiter WHERE CompanyName LIKE '%Microsoft INC%' OR OtherCompanyName LIKE '%Microsoft INC%' It is taking 30 seconds to execute and from the front end it is throwing timeout error. The function is here: CREATE Function [dbo].[ufn_RecruiterCompanyName] (@JobId bigint) RETURNS nvarchar(200) AS BEGIN DECLARE @ResultVar nvarchar(200) DECLARE @RecruiterId bigint select @RecruiterId = iRecruiterId_FK from dbo.tbUS_Jobs with (Nolock) where iJobId_PK = @JobId; Select @ResultVar = sCompanyName from dbo.tbUS_RecruiterCompanyInfo with (Nolock) where iRecruiterId_FK = dbo.ufn_GetParentRecruiterID(@RecruiterId) return isnull(@ResultVar,'') END The other function CREATE Function [dbo].[ufn_GetParentRecruiterID](@RecruiterId bigint) returns bigint as begin declare @ParentRecruiterId bigint SELECT @ParentRecruiterId = iParentId FROM dbo.tbUS_Recruiter with (Nolock) WHERE iRecruiterId_PK = @RecruiterId IF(@ParentRecruiterId = 0) SET @ParentRecruiterId = @RecruiterId RETURN @ParentRecruiterId end My questions are Why it is taking so much time to execute? How can I reduce the execution time? Thanks a lot for your attention.
