[site]: stackoverflow
[post_id]: 3449684
[parent_id]: 
[tags]: 
PDFCreator will print TIFF instead of PDF

I am trying to convert a RTF document to PDF. I have this code: // TestCOMPDF.cpp : Defines the entry point for the console application. // #include #include #include #include #import "MSVBVM60.DLL" rename ( "EOF", "VBEOF" ), rename ( "RGB", "VBRGB" ) //if you don't use this you will be in BIG trouble #import "PDFCreator.exe" int _tmain(int argc, _TCHAR* argv[]) { CoInitialize(NULL); { CComPtr pdfObject; HRESULT hr = pdfObject.CoCreateInstance(L"PDFCreator.clsPDFCreator"); pdfObject->cStart("/NoProcessingAtStartup", 1); PDFCreator::_clsPDFCreatorOptionsPtr opt = pdfObject->GetcOptions(); opt->UseAutosave = 1; opt->UseAutosaveDirectory = 1; opt->AutosaveDirectory = "c:\\temp\\"; opt->AutosaveFormat = 0; // for PDF opt->AutosaveFilename = "gigi13"; pdfObject->PutRefcOptions(opt); pdfObject->cClearCache(); _bstr_t DefaultPrinter = pdfObject->cDefaultPrinter; pdfObject->cDefaultPrinter = "PDFCreator"; hr = pdfObject->cPrintFile("c:\\temp\\RTF\\garage.rtf"); pdfObject->cPrinterStop = false; while(true) { printf("sleep\n"); Sleep(1000); if(pdfObject->cCountOfPrintjobs == 0) break; } printf("done\n"); pdfObject->cPrinterStop = true; pdfObject->cDefaultPrinter = DefaultPrinter; } CoUninitialize(); return 0; } When running this code sample instead of creating directly the PDF it prompts me with a Save dialog offering me the option to the output only with the option of choosing a TIFF file (which is not wanted). Can someone point me into the right direction or offer some suggestions? Thanks, Iulian
