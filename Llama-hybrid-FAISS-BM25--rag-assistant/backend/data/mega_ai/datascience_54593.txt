[site]: datascience
[post_id]: 54593
[parent_id]: 
[tags]: 
NLTK pos-tag fails to recognize names

I'm trying to identify all the names in a novel (fed as a text file) using NLTK. On a smaller scale, the POS tagging works perfectly. However, when I feed a large body of text, by which I mean three or four paragraphs, the system fails miserably. How can I fix this? I read the file, split it into lines, sentences and then words. What I get is a list of lists where each internal list contains words of a sentence. Then, I use NLTK to tag each sentence. def process_file(_file, tagger, stemmer, stopwords, filename, printinfo): sentences = [] _nnp = set() words = dict() for line in _file: for sentence in nltk.tokenize.sent_tokenize(line): sentences.append(nltk.tokenize.word_tokenize(sentence)) sent_count = 0 for sentence in sentences: sent_count+=1 tags = tagger.tag(sentence) for tag in tags: if tag[1] == "NNP" or tag[1] == "NNPS": _nnp.add(tag[0]) else: if tag[0] not in stopwords: stemmed_word = stemmer.stem(tag[0]) if stemmed_word not in words.keys(): words[stemmed_word] = 1 else: words[stemmed_word] += 1 print("\r[{0}] Reading file '{1}'[{2:>3.1%}] ".format(printinfo, filename, sent_count/len(sentences)), end='') return _nnp, words Main code: dictionary = dict() nnp = set() # Initialize tagger and stemmer pos_tagger = nltk.tag.PerceptronTagger() ps = nltk.PorterStemmer() stopwords = nltk.corpus.stopwords.words('english') file_count = 0 # For each file, extract words and named entities for file in files: file_count += 1 _nnp, _dictionary = process_file(open(file, 'r', encoding='utf-8'), pos_tagger, ps, stopwords, file, str(file_count)+"/"+str(len(files))) # Extend dictionary for word in _dictionary.keys(): if word in dictionary.keys(): dictionary[word] += _dictionary[word] else: dictionary[word] = _dictionary[word] # Join sets nnp = nnp.union(_nnp) end = time.time() print("COMPLETED: Step 2 completed in {0:.3f}s".format(end-start)) Here's a sample of what the text might look like: In slow motion, afraid of what he was about to witness, Langdon rotated the fax 180 degrees. He looked at the word upside down. Instantly, the breath went out of him. It was like he had been hit by a truck. Barely able to believe his eyes, he rotated the fax again, reading the brand right-side up and then upside down. "Illuminati," he whispered. ```
