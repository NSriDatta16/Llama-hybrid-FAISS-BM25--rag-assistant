[site]: crossvalidated
[post_id]: 630182
[parent_id]: 
[tags]: 
Test of Group Invariance with 3 Groups

Say, we have three groups and we want to run a test of group invariance with the following data. set.seed(1234) df $dv x1 + .30*df$x2+ rnorm(300, 0, 1),2) The model with configural invariance is as follows: library(lavaan) m1 The output we get is lavaan 0.6.15 ended normally after 52 iterations Estimator ML Optimization method NLMINB Number of model parameters 12 Number of observations per group: a 100 b 100 c 100 Model Test User Model: Test statistic 0.000 Degrees of freedom 0 Test statistic for each group: a 0.000 b 0.000 c 0.000 Model Test Baseline Model: Test statistic 6.897 Degrees of freedom 6 P-value 0.330 User Model versus Baseline Model: Comparative Fit Index (CFI) 1.000 Tucker-Lewis Index (TLI) 1.000 Loglikelihood and Information Criteria: Loglikelihood user model (H0) -409.471 Loglikelihood unrestricted model (H1) -409.471 Akaike (AIC) 842.943 Bayesian (BIC) 887.388 Sample-size adjusted Bayesian (SABIC) 849.331 Root Mean Square Error of Approximation: RMSEA 0.000 90 Percent confidence interval - lower 0.000 90 Percent confidence interval - upper 0.000 P-value H_0: RMSEA = 0.080 NA Standardized Root Mean Square Residual: SRMR 0.000 Parameter Estimates: Standard errors Standard Information Expected Information saturated (h1) model Structured Group 1 [a]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 0.033 0.188 0.176 0.860 x2 0.143 0.180 0.798 0.425 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 0.873 0.718 1.215 0.224 Variances: Estimate Std.Err z-value P(>|z|) .dv 0.863 0.122 7.071 0.000 Group 2 [b]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 0.364 0.195 1.872 0.061 x2 0.047 0.180 0.259 0.796 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 0.285 0.806 0.354 0.724 Variances: Estimate Std.Err z-value P(>|z|) .dv 0.999 0.141 7.071 0.000 Group 3 [c]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 -0.291 0.192 -1.513 0.130 x2 -0.148 0.199 -0.747 0.455 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 2.847 0.861 3.306 0.001 Variances: Estimate Std.Err z-value P(>|z|) .dv 0.838 0.119 7.071 0.000 Now, let's impose to the above model a path-equality constraint with the following group ordering Group 1 = [a] Group 2 = [b] Group 3 = [c] Let's call this model, Model abc fit_abc The output is as follows: lavaan 0.6.15 ended normally after 28 iterations Estimator ML Optimization method NLMINB Number of model parameters 12 Number of equality constraints 4 Number of observations per group: a 100 b 100 c 100 Model Test User Model: Test statistic 6.665 Degrees of freedom 4 P-value (Chi-square) 0.155 Test statistic for each group: a 0.387 b 2.699 c 3.579 Model Test Baseline Model: Test statistic 6.897 Degrees of freedom 6 P-value 0.330 User Model versus Baseline Model: Comparative Fit Index (CFI) 0.000 Tucker-Lewis Index (TLI) -3.458 Loglikelihood and Information Criteria: Loglikelihood user model (H0) -412.804 Loglikelihood unrestricted model (H1) -409.471 Akaike (AIC) 841.608 Bayesian (BIC) 871.238 Sample-size adjusted Bayesian (SABIC) 845.867 Root Mean Square Error of Approximation: RMSEA 0.082 90 Percent confidence interval - lower 0.000 90 Percent confidence interval - upper 0.187 P-value H_0: RMSEA = 0.080 0.590 Standardized Root Mean Square Residual: SRMR 0.045 Parameter Estimates: Standard errors Standard Information Expected Information saturated (h1) model Structured Group 1 [a]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 (.p1.) 0.043 0.111 0.384 0.701 x2 (.p2.) 0.032 0.108 0.293 0.770 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 1.179 0.461 2.557 0.011 Variances: Estimate Std.Err z-value P(>|z|) .dv 0.867 0.123 7.071 0.000 Group 2 [b]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 (.p1.) 0.043 0.111 0.384 0.701 x2 (.p2.) 0.032 0.108 0.293 0.770 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 1.302 0.470 2.768 0.006 Variances: Estimate Std.Err z-value P(>|z|) .dv 1.026 0.145 7.071 0.000 Group 3 [c]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 (.p1.) 0.043 0.111 0.384 0.701 x2 (.p2.) 0.032 0.108 0.293 0.770 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 1.294 0.469 2.760 0.006 Variances: Estimate Std.Err z-value P(>|z|) .dv 0.869 0.123 7.071 0.000 Now, let's rerun the same model - let's call it Model bac - by changing the order of groups by Group 1 = [b] Group 2 = [a] Group 3 = [c] ``` fit_bac The output will be exactly the same as above, with the only difference the ordering of the groups lavaan 0.6.15 ended normally after 28 iterations Estimator ML Optimization method NLMINB Number of model parameters 12 Number of equality constraints 4 Number of observations per group: b 100 a 100 c 100 Model Test User Model: Test statistic 6.665 Degrees of freedom 4 P-value (Chi-square) 0.155 Test statistic for each group: b 2.699 a 0.387 c 3.579 Model Test Baseline Model: Test statistic 6.897 Degrees of freedom 6 P-value 0.330 User Model versus Baseline Model: Comparative Fit Index (CFI) 0.000 Tucker-Lewis Index (TLI) -3.458 Loglikelihood and Information Criteria: Loglikelihood user model (H0) -412.804 Loglikelihood unrestricted model (H1) -409.471 Akaike (AIC) 841.608 Bayesian (BIC) 871.238 Sample-size adjusted Bayesian (SABIC) 845.867 Root Mean Square Error of Approximation: RMSEA 0.082 90 Percent confidence interval - lower 0.000 90 Percent confidence interval - upper 0.187 P-value H_0: RMSEA = 0.080 0.590 Standardized Root Mean Square Residual: SRMR 0.045 Parameter Estimates: Standard errors Standard Information Expected Information saturated (h1) model Structured Group 1 [b]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 (.p1.) 0.043 0.111 0.384 0.701 x2 (.p2.) 0.032 0.108 0.293 0.770 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 1.302 0.470 2.768 0.006 Variances: Estimate Std.Err z-value P(>|z|) .dv 1.026 0.145 7.071 0.000 Group 2 [a]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 (.p1.) 0.043 0.111 0.384 0.701 x2 (.p2.) 0.032 0.108 0.293 0.770 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 1.179 0.461 2.557 0.011 Variances: Estimate Std.Err z-value P(>|z|) .dv 0.867 0.123 7.071 0.000 Group 3 [c]: Regressions: Estimate Std.Err z-value P(>|z|) dv ~ x1 (.p1.) 0.043 0.111 0.384 0.701 x2 (.p2.) 0.032 0.108 0.293 0.770 Intercepts: Estimate Std.Err z-value P(>|z|) .dv 1.294 0.469 2.760 0.006 Variances: Estimate Std.Err z-value P(>|z|) .dv 0.869 0.123 7.071 0.000 If we inspect the equality constraints for Model abc through lavTestScore lavTestScore(fit_abc) we get this $test total score test: test X2 df p.value 1 score 6.565 4 0.161 $uni univariate score tests: lhs op rhs X2 df p.value 1 .p1. == .p10. 3.899 1 0.048 2 .p1. == .p19. 4.054 1 0.044 3 .p2. == .p11. 0.008 1 0.930 4 .p2. == .p20. 0.856 1 0.355 My take is that for this model ( Model abc , where the group order is a, b, c), line #1 compares the first regression coefficient of group a with group b and line #2 compares the first regression coefficient of group a with group c If, however, we inspect the equality constraints for Model bac through lavTestScore lavTestScore(fit_bac) we get this $test total score test: test X2 df p.value 1 score 6.565 4 0.161 $uni univariate score tests: lhs op rhs X2 df p.value 1 .p1. == .p10. 0.002 1 0.963 2 .p1. == .p19. 4.054 1 0.044 3 .p2. == .p11. 0.610 1 0.435 4 .p2. == .p20. 0.856 1 0.355 Based on the above logic, line #1 compares the first group with the second (so, again, "b" with "a"), and line #2 compares the first with the third group (i.e., now "b" with "c"). I would expect lines #1 from the two lavTestScore outputs to be the same and lines #2 to differ. But it seems that this is not the case. Instead, lines #2 are the same, and lines #1 differ. Obviously, I miss a piece of critical information about how comparisons are conducted, but I could not find any hint about this issue. Any hint or help will be much appreciated. Thanks for your consideration.
