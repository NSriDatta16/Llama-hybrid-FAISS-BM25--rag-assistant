[site]: crossvalidated
[post_id]: 629109
[parent_id]: 629028
[tags]: 
In twangContinuous , the variable named treat is (maybe confusingly) a confounder, not the treatment variable, so you should not focus on it. It has nothing to do with the analysis except that it is a confounder that needs to be balanced by the weights with respect to the actual treatment variable, tss_0 . If you have a continuous treatment, no matter what you final model or comparison is, you need to estimate weights that ensure the treatment is independent of the covariates. GBM as implemented in twangContinuous is one way to estimate the weights, but not the only or even best way. Many options (including GBM) are available in WeightIt , so I'll demonstrate how to run an analysis using WeightIt . First you need to estimate the balancing weights. We'll let A be the continuous treatment, x1 , x2 , and x3 be the confounders, and Y be the outcome. We'll use energy balancing which tends to work very well. W Next you can assess balance using cobalt::bal.tab() : cobalt::bal.tab(W, un = TRUE) If balance is achieved, you can move forward with modeling the outcome. Otherwise, try a different weighting method until you have achieved balance. We can model the outcome however you want, but here we'll use a restricted cubic spline. #Bring weights into the dataset data $weights weights #Fit the outcome model fit You can also add the covariates into the model for precision. Finally, we can estimate and plot the dose-response curve using functions in marginaleffects : values You can compare the average outcomes for less than 12 vs greater than or equal to 12 by creating a new variable and examining the average values of the outcome between those two groups. data $treat_12 treat Finally, we can use a similar method to test the difference between having less than 12 years of education and each individual value of the treatment greater than or equal to 12. data $treat_12b treat So, from this analysis, you get the dose-response curve and a test for whether on average having a treatment value less than 12 yields a different outcome on average from having a treatment value of 12 or greater. We did all this by respecting the original scale of the treatment and creating auxiliary variables to supply to avg_predictions() to get the quantities we want. Now I will warn you that your question is poorly defined. What if there is a huge difference between people with 8 years of eduction and those with 11 years of education? Does it really make sense to lump all those people together in a single group? Maybe for a simple comparison, but the dose-response curve is the only output that fully captures the relationship you are studying.
