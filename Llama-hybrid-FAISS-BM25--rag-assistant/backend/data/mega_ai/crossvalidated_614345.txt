[site]: crossvalidated
[post_id]: 614345
[parent_id]: 614339
[tags]: 
brms is a fine solution. If you want to do something more NLMIXED-like, you can use glmmTMB . Advantages : don't have to mess around with priors, MCMC diagnostics, etc. Disadvantages : if your model is too complex for the data to handle, you have fewer options for using priors to regularize the solution (i.e., you'll probably have to simplify the model by throwing things away rather than using a continuous prior to downweight unlikely parameter combinations). glmmTMB(data=mydata, formula = behavior ~ 1 + meds + time + x1 + x2 + x3 + offset(log_numTOs) + (1 + meds + time|subject), ziformula ~ 1 + meds + time + x1 + x2 + x3, family = nbinom2) The (1|p|subject) terms in the brms formula are doing something that glmmTMB can't (currently) do, i.e. modeling correlations between the random intercept in the conditional (count) model and the random intercept in the zero-inflation model (e.g., do children who have higher behavioral counts than the population average also have higher (or lower) zero-inflation probabilities than average? I've made a few other modeling choices here: assuming that meds can vary within children (i.e., individual children go on and off meds over the course of the observation period), I've allowed for a random-slope model where in addition to allowing each child to vary in their baseline expected count, the model also allows for different time trends (the time in (1 + meds + time | subject) and different responses to medication for each child I did not add a subject-level random effect to the zero-inflation component of the model In general, it is a good idea to identify the maximal model , i.e. the model that allows all possibly observable effects (i.e., all effects that varied within children over the observation period) to vary among children, and for all of those random effects to be correlated with each other. If we assume temporarily that x1 , x2 , x3 vary only across subjects (i.e. they're constant for each child over the observation period), then the maximal model is that the intercept ( 1 ), effect of medication ( med ), and effect of time ( time ) of both the count model and the zero-inflation model all vary across children. This would mean each child had a vector of 6 latent variables, all potentially correlated with each other, so estimating a 6x6 covariance matrix. (In glmmTMB you have to model this as two separate 3x3 covariance matrices, with the count effects independent of the z-i effects; in brms I think you would write this as (1+med+time|p|subject) in both formulas.) Unless you have a very large data set, this complex a model isn't likely to work out of the box. If you're using brms you can choose between simplifying the model (leaving out some random effects terms, using || instead of | to specify uncorrelated random effects, etc.) or using narrow/more informative priors to keep the model out of trouble; if using glmmTMB simplification is your only option. I second Bj√∂rn's caution about causal effects if (for example) meds are given non-randomly, to children who show more severe behavioural problems ...
