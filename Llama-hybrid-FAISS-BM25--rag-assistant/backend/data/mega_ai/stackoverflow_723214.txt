[site]: stackoverflow
[post_id]: 723214
[parent_id]: 709308
[tags]: 
Do you have the option of writing your output streams as a single stream with inline metadata to identify each 'chunk'? If you were to read a 'chunk,' run your threshhold function on it, then instead of writing it to a particular output stream you would just write which stream it belonged to (1 byte) followed by the original data, you'd seriously reduce your thrashing. I would not suggest this except for the fact that you have said that you have to process these data many times. On each successive run, you read your input stream to get the bin number (1 byte) then do whatever you need to do for that bin on the next 8 bytes. As far as the cacheing behavior of this mechanism, since you are only sliding through two streams of data and, in all but the first case, writing as much data as you are reading, the hardware will give you all the help you could possibly hope for as far as prefetching, cache line optimization, etc. If you had to add that extra byte every time you processed your data, your worst case cache behavior is the average case. If you can afford the storage hit, it seems like a win to me.
