[site]: stackoverflow
[post_id]: 177676
[parent_id]: 
[tags]: 
Using .NET's UserControl as an embedded control via COM

I'm porting an existing .NET 3.5 application into a plug-in for Eclipse. I want to have my custom UserControl, written in C#, embedded within Eclipse; I've exported it successfully as a COM Control, and it works well in Eclipse Europa. In Ganymede, it seems the OLE load code has changed, and what originally worked in Europa, fails. The specific error is when Ganymede loads my control, it queries for IOleObject, receives the proper interface, and then calls SetClientSite on it, which causes my object to lose both its references, and become de-allocated (Ganymede will then crash). The exact same control works flawlessly in both Visual C++ designer and in Europa. Apart from the obvious .NET attributes and UserControl, is there any specific class I need to inherit from? Specific interfaces I need to implement, or specific behavior change between Europa/VC and Ganymede? Thanks!
