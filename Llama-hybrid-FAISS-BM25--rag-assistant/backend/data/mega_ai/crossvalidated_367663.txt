[site]: crossvalidated
[post_id]: 367663
[parent_id]: 
[tags]: 
Problem fitting multinomial model with MCMCglmm

I am trying to fit the following model with MCMCglmm $$Y_i \sim \text{Multinomial}(\pi_i)$$ $$\pi_i = \phi^{-1}(\eta_i)$$ $$\eta_i = \Lambda X_i + E_i\quad E_i \sim N(0, \Sigma)$$ $$\Lambda \sim MN(\Theta, \Sigma, \Gamma)$$ $$\Sigma \sim IW(\upsilon, \Xi)$$ where $\phi^{-1}$ is just the standard multivariate inverse logit function (e.g., $\eta_{ij}=\log\frac{\pi_{ij}}{\pi_{iD}}$ where $D$ is the reference multnomial category). I have simulated data of the form > head(dat) x1 x2 c1 c2 c3 c4 c5 s1 1 -1.3387739 392 563 0 3156 2901 s2 1 -0.4005976 2426 350 15 310 2327 s3 1 0.6293866 17 3628 141 724 1373 s4 1 -0.6451888 4273 424 4 1964 2042 s5 1 -0.4268794 4354 328 8 4628 487 s6 1 0.2956439 38 78 963 5861 796 where dat[,1:2] is equal to $X$ and dat[,3:7] is equal to $Y$. Also, $\upsilon$, $\Xi$, $\Gamma$, and $\Theta$ are all hyperparameters that are known. I would like to get posterior estimates for parameters $\Lambda$ and $\Sigma$. The following code runs but, it appears that MCMCglmm is treating the parameter x1 and x2 as a categorical rather than as a random regression so it seems I am doing something wrong. Xi To see this problem note the following: > colnames(fit$Sol) [1] "(Intercept)" [2] "traitc1.x1.1" [3] "traitc2.x1.1" [4] "traitc3.x1.1" [5] "traitc4.x1.1" [6] "traitc1.x2.-2.25911592309736" [7] "traitc1.x2.-1.63720609464487" [8] "traitc1.x2.-1.59267367181186" [9] "traitc1.x2.-1.56412084769096" [10] "traitc1.x2.-0.95082277449964" [11] "traitc1.x2.-0.932257410701136" [12] "traitc1.x2.-0.890450208808333" [13] "traitc1.x2.-0.61423815058367" [14] "traitc1.x2.-0.588496370538988" [15] "traitc1.x2.-0.407602583801291" [16] "traitc1.x2.-0.402096369564711" [17] "traitc1.x2.-0.311114176597146" [18] "traitc1.x2.-0.264621221050592" (The output should have length 4+4+1; 4 from each column of $\Lambda$ and one extra from the intercept that MCMCglmm seems to reqire. Instead the output has length 125 because it is treating x1 and x2 as categorical and grouping with respect to it). Note : I realize that in the above code I am treating $\Gamma$ (which I think is $G$ in the MCMCglmm notation as random. How would I treat it as fixed? Thank you very much for your help!
