[site]: crossvalidated
[post_id]: 511138
[parent_id]: 
[tags]: 
Explain the expected value of an indicator variable in section 9.3.1 of PRML

The posterior distribution in Bishop's "Pattern Recognition and Machine Learning" book is written as: $$ p(\textbf{Z} \mid \textbf{X}, \mu, \pi) \approx \Pi_n \Pi_k [\pi_k \mathcal{N}(x_n \mid \mu_k, \Sigma_k)]^{z_{nk}} $$ where $z_n$ is a 1-of-K binary rperesentation in which a particular element $z_{nk} \in \{0,1 \}$ and $\sum_k z_{nk} = 1$ and $z_{nk}$ denotes the indicator for a data point $x_n$ . Then the author states that: The expected value of the indicator variable $z_{nk}$ under this posterior distribution is then given by, $$\begin{align} \mathbb{E}[z_{nk}] &= \frac{\sum_{z_{nk}} z_{nk} [\pi_k \mathcal{N}(x_n \mid \mu_k, \Sigma_k)]^{z_{nk}}}{\sum_{z_{nj}} [\pi_j \mathcal{N}(x_n \mid \mu_j, \Sigma_j)]^{z_{nj}}} \\[1em] &= \frac{\pi_k \mathcal{N}(x_n \mid \mu_k, \Sigma_k)}{\sum^K_j \pi_j \mathcal{N}(x_n \mid \mu_j, \Sigma_j)} \\[1em] &= \gamma(z_{nk}) \end{align}$$ I am aware of similar question , but the answer assumed the posterior distribution is $p(z_n | x_n)$ , which is unlikely the assumption of Bishop. At first I agreed because that explained nicely the expression, but when Bishop used the expression to explain the expected value of the log likelihood below, I think the answer may not be correct, $$ \ln p(X, Z | \mu, \Sigma, \pi) = \sum^N_n \sum^K_k z_{nk} \Big\{ \ln \pi_k + \ln \mathcal{N}(x_n | \mu_k, \Sigma_k) \Big\} $$ $$ E_Z [\ln p(X, Z | \mu, \Sigma, \pi)] = \sum^N_n \sum^K_k \gamma(z_{nk}) \Big\{ \ln \pi_k + \ln \mathcal{N}(x_n | \mu_k, \Sigma_k) \Big\} $$ So, how can I obtain the expression of $\mathbb{E}[z_{nk}]$ under the posterior distribution $p(Z | X, \mu, \Sigma, \pi)$ ? Update : the "corrected version" of $\mathbb{E}[z_{nk}]$ , by Bishop, $$\begin{align} \mathbb{E}[z_{nk}] &= \frac{\sum_{\mathbf{z}_n} z_{nk} \prod_{k'} \left[\pi_{k'} \mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_{k'}, \boldsymbol{\Sigma}_{k'}) \right]^{z_{nk'}}}{\sum_{\mathbf{z}_n} \prod_{j} \left[\pi_{j} \mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_{j}, \boldsymbol{\Sigma}_{j}) \right]^{z_{nj}}} \end{align}$$ I don't replace the version with the original because I don't see} the version will make my question easier to answer, and they are both equivalent if we assume the posterior distribution of interest is p(z_n | x_n) (The original version is not correct because the nominator in the first equation is not equal to that in the second)
