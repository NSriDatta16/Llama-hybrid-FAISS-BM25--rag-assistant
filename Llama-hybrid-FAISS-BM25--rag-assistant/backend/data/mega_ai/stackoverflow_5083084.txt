[site]: stackoverflow
[post_id]: 5083084
[parent_id]: 
[tags]: 
Rails - force field uppercase and validate uniquely

Airports have four-letter ICAO codes. By convention, these are always uppercase. I'm creating a form for receiving user input, but this form needs to be able to accept user input in mixed case, and prevent them from creating dupes. The default :uniqueness is case-sensitive, of course. I figured out how to transform the user's input to uppercase before it gets saved, but the problem is that this appears to be post-validation, instead of pre-validation. For example, if there is already an Airport with ICAO of KLAX , a user can enter klax , it will get validated as unique, and then transformed to uppercase and stored, resulting in duplicates. Here's my model code at present. class Airport true validates :icao, :uniqueness => true before_save :uppercase_icao def uppercase_icao icao.upcase! end end
