[site]: crossvalidated
[post_id]: 497751
[parent_id]: 496757
[tags]: 
Build a common regression model with age and year as predictors. Since the response is binary (reading or not ...), logistic regression is a natural starting point. That is, $$ \DeclareMathOperator{\P}{\mathbb{P}} \P(Y_i=1 \mid a, t) =p_{a,t} $$ where $a$ is age and $t$ is timepoint. Since the expectation of a binary (0/1) variable is its expectation, $p_{a,t}$ corresponds to your $E(read|age=age_t)$ (I find that notation ambiguous so avoid it.) With a binomial distribution for $Y_i$ and a logistic link function (you could try other links) we get $$ \operatorname(logit)(p_{a,t} = \mu + \alpha a + \beta t ) $$ for a linear model, but you could try other models. I will simulate from a linear model, but show a fit with a spline for $t$ , using glm in R. An alternative could be mgcv which is more automatic. n Then we fit a model, and show a plot of the fitted spline: library(splines) mod0 |z|) (Intercept) -4.60462 0.89591 -5.140 2.75e-07 *** age 0.38446 0.06806 5.649 1.61e-08 *** ns(year, df = 4)1 0.28385 0.78697 0.361 0.7183 ns(year, df = 4)2 1.46611 0.75326 1.946 0.0516 . ns(year, df = 4)3 0.16797 1.45083 0.116 0.9078 ns(year, df = 4)4 -0.06443 0.65292 -0.099 0.9214 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 271.40 on 203 degrees of freedom Residual deviance: 226.88 on 198 degrees of freedom AIC: 238.88 Number of Fisher Scoring iterations: 4 > Analysis of Deviance Table Model: binomial, link: logit Response: Y Terms added sequentially (first to last) Df Deviance Resid. Df Resid. Dev Pr(>Chi) NULL 203 271.40 age 1 38.626 202 232.78 5.133e-10 *** ns(year, df = 4) 4 5.893 198 226.88 0.2073 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 ### Let us get terms predictions to plot the estimated spline Yhat.terms The code for the plot is: library(ggplot2) ggp
