[site]: crossvalidated
[post_id]: 610260
[parent_id]: 
[tags]: 
EDF and basis functions in GAMs with factor-smooth interactions

I am trying to use a GAM to model average daily water temperature against day and habitat type in an estuary. I have temperature logger data over 115 days across three habitat types. I am using a GAM with a factor-smooth interaction to see how habitat-level smooths differ from the global-smooth for day. Habitat is included as a random effect to allow for varying-intercepts and I also included a random effect for site (where each temperature logger was placed): gam(avg_temp ~ s(day, bs = "tp", m = 2) + s(day, by = hab, bs = "tp", m = 1) + s(hab, bs = "re" + s(site, bs = "re") I am having trouble selecting the number of basis functions. When I use the default values (k = 10), this is the output I get from the summary() function: The plots look good (i.e. represent the observed relationship), however gam.check() indicates I need to increase the number of basis functions. So, I tried 30 knots. When I do this, the gam fits a linear relationship for the global smooth of day, as indicated by the edf of 1 in the summary output: gam.check() tells me I have used a sufficient number of basis functions. I don't know why the model does this. Logically, it does not make sense to have a linear relationship between temperature and day, as there is a clear, nonlinear trend of day across all habitat types when you visualize the data. Because of this, I don't know whether the first or second model specification is better. Any help would be much appreciated.
