[site]: crossvalidated
[post_id]: 273307
[parent_id]: 272800
[tags]: 
As far as I can see, while you do define a convolution function convpool , you do not use it. Your entire model is this: # define the model Z1 = tf.nn.relu( tf.matmul(X, W1) + b1 ) Z2 = tf.nn.relu( tf.matmul(Z1, W2) + b2 ) Yish = tf.matmul(Z2, W3) + b3 This is not convolution, this is just matrix multiplication, with very large matrices. Your very small data size (100 samples per class) is not likely to be sufficient to train a CNN, and even more so an entire matrix to multiply the data. I would consider doing 2-3 CNN layers with max-pooling, followed by a single fully connected layer to reduce the dimension to that of the output (i.e. number of classes), and see how it goes. It would also be helpful to see the training error and testing error vs. minibatch iteration / epochs, to see what happens (if you overfit, underfit, etc.).
