[site]: stackoverflow
[post_id]: 4212475
[parent_id]: 4203736
[tags]: 
One thing you may want to bear in mind - there will be a DataAvailable callback after the call to StopRecording (or during, depending on the callback model used), so you might want to delay closing the WaveFileWriter until you have written everything. Have a look at the VoiceRecorder sample project which uses NAudio and stops recording after 60 seconds. I explain in this article how recording is automatically stopped. long maxFileLength = this.recordingFormat.AverageBytesPerSecond * 60; int toWrite = (int)Math.Min(maxFileLength - writer.Length, bytesRecorded); if (toWrite > 0) writer.WriteData(buffer, 0, bytesRecorded); else Stop();
