[site]: datascience
[post_id]: 85078
[parent_id]: 67321
[tags]: 
yes it is clear data leakage, actually it's a tricky one that many DS's are missing. The count feature logic you were referring to, for each row (regardless of which dataset it belongs to) should be based only on rows that are "older" than the current one you calculate the count for. It makes your experimentation and feature engineering more complex but that's the only way to really reflect the data that you had (or will have) in reality.
