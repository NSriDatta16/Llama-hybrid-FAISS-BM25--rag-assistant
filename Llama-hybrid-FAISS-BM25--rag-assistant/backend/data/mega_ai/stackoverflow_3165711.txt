[site]: stackoverflow
[post_id]: 3165711
[parent_id]: 3160144
[tags]: 
You can do all this much more briefly with some more modern code: Use the built-in TextFieldParser to read the comma-separated file, and access each row as a string array. It's simpler and more robust than using Split . And then use IEnumerable extension methods to calculate the average all in one line. a. Skip(1) skips the first entry. b. Average() lets you convert the remaining entries to Double and then take the average. Like this: Sub Main() Using MyReader As New _ Microsoft.VisualBasic.FileIO.TextFieldParser("ExamMarks.txt") MyReader.TextFieldType = FileIO.FieldType.Delimited MyReader.SetDelimiters(",") Dim currentRow As String() While Not MyReader.EndOfData Try ' Read row as an array of strings ' currentRow = MyReader.ReadFields() ' Calculate average ' Dim dAverage As Double = _ currentRow.Skip(1).Average(Function(s) Convert.ToDouble(s)) ' Write out result ' Console.WriteLine(currentRow(0) & "'s average is " & _ Convert.ToString(dAverage)) Catch ex As Microsoft.VisualBasic.FileIO.MalformedLineException MsgBox("Line " & ex.Message & "is not valid and will be skipped.") End Try End While End Using Console.ReadLine() End Sub
