[site]: stackoverflow
[post_id]: 2200481
[parent_id]: 2199442
[tags]: 
You're missing a single character: my $mail = $sa->parse(\@lines); From the docs (with emphasis added): parse($message, $parse_now [, $suppl_attrib]) Parse will return a Mail::SpamAssassin::Message object with just the headers parsed. When calling this function, there are two optional parameters that can be passed in: $message is either undef (which will use STDIN ), a scalar of the entire message, an array reference of the message with 1 line per array element , or a file glob which holds the entire contents of the message; and $parse_now , which specifies whether or not to create the MIME tree at parse time or later as necessary. With the change above, I get the following output (HTML stripped): pts rule name description ---- ---------------------- -------------------------------------------------- -2.6 BAYES_00 BODY: Bayesian spam probability is 0 to 1% [score: 0.0000] As the docs mention, parse is flexible. You could instead use my $mail = $sa->parse(join "" => ); # scalar of the entire message or my $mail = $sa->parse(\*FILE); # a file glob with the entire contents or my $mail; { local $/; $mail = $sa->parse( ) } # scalar of the entire message or even open STDIN, " parse(undef); # undef means read STDIN You'd remove my @lines = for these last four examples to function as expected.
