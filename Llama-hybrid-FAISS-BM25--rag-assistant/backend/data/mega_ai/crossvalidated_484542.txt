[site]: crossvalidated
[post_id]: 484542
[parent_id]: 
[tags]: 
The cumulative sum of the difference between dependent Gamma variables

I want to know if it is possible to find an expression for the PDF of the storage in a linear reservoir system as described below. I am aware that there are some numerical methods that would allow me to compute an approximate distribution for $Z_t$ , but this is time consuming and what I describe below suggests this may be achieved more directly - but I am not able to quite figure out how. I am interested in the output ( $Y_t$ ) behaviour of a linear system driven by a stochastic input ( $X_t$ ). This is conceptualised in the form of a simple linear reservoir (see below) where the output at any time ( $Y_t$ ) is directly proportional to the storage at that time ( $Z_t$ ) as: \begin{equation} Y_t = \frac{1}{k}Z_t \end{equation} It is of particular interest to derive the probability density of $Z$ and $Y$ for different types of $X$ - and I am looking at the case where $X$ is Gamma-distributed $X_t \sim\Gamma\left(\alpha_X,\,\theta_X\right)$ . There are existing results that define relationships between the moments of $X$ , $Z$ and $Y$ to the reservoir constant $k$ thus: \begin{equation} \mu_Z = k\mu_X, \quad \sigma_Z^2 = \frac{k^2}{2k+1}\sigma_X^2, \quad \mu_Y = \mu_X, \quad \sigma_Y^2 = \frac{1}{2k+1}\sigma_X^2, \quad \mbox{and} \quad \gamma_Y = \frac{\left(2k+1\right)^{3/2}}{3k^2+3k+1} \end{equation} The system can be discretised so that for a time step $\Delta t = 1$ : \begin{equation} Z_t - Z_{t-1} = X_t - Y_t \quad \mbox{or} \quad Z_t - Z_{t-1} = X_t - \frac{1}{k}Z_t \quad \mbox{so} \quad \left(1+\frac{1}{k}\right)Z_t = X_t+Z_{t-1} \end{equation} Is there any way to use this relationship to then specify the distributional form of $Z_t$ ? It is almost Gamma, but not quite - the skewness is too small. I had a few ideas: simulations showed that for a gamma input, then gamma distributions fitted to $Z_t$ and $Y_t$ had the same shape factor but different scale factors but these could not be derived from the moment relationships with $X_t$ above. Conceptually, starting from $Z_0 = 0$ , one could imagine that the reservoir starts to fill until such a time as it reaches the mean water level, after which the mean output matches the mean input. Until that condition is reached there will be a steady accumulation of water in the storage which would approximate to the cumulative sum of the difference of random variables $\left(X_t - Y_t\right)$ . Any thoughts and or/suggestions would be much appreciated! N.B When I wrote code to simulate this system, I assumed $X$ was Gamma random variable with shape factor $\alpha_X = 1$ and scale factor $\theta_X = 1$ . I generated 1,000,000 values, used these as the input to the linear system, and looked to find a suitable distribution to represent $Z_t$ and $Y_t$ .
