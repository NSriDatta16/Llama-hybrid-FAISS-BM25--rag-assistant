[site]: crossvalidated
[post_id]: 584894
[parent_id]: 
[tags]: 
Cox survival PH violated variable is part of an interaction

One of my main predictors violates the PH assumption. I've been reading different ways to deal with this for a while and have decided on an interaction with time after making a person-period file (using something like the unfold function, so a separate line for each individual for each at-risk time), as suggested by other questions on here. Now, this fixes the PH issues in my model, but the issue I have is that this variable is also part of an interaction term with another variable. This interaction term does NOT violate the PH assumption (see this similar question of a few years ago: Violation of proportional hazard for covariate but not for interaction it's part of in a Cox Proportional Hazards model ). Can I continue as planned or do I need to make a three-way interaction with var1:var2:Time? Is there any literature on this? test2 $DurationStay, Newcomers$ Censoring) ~ Newcomers $Gender + Newcomers$ Power + Newcomers $Gender:Newcomers$ Power , method = "efron") summary(test2) print(zph $Gender 0.93 1 0.33496 Newcomers$ Power 14.09 1 0.00017 Newcomers $Gender:Newcomers$ Power 5.88 1 0.01529 GLOBAL 18.55 3 0.00034 ggcoxzph(zph) plot(zph[2],lwd=2) abline(0,0,col=1,lty=3,lwd=2) abline(h=test2$coef[2],col=3,lwd=2,lty=2) legend("topright", legend=c('Reference line null effect', "Average hazard over time", "Time-varying hazard"), lty=c(3,2,1), col=c(1,3,1), lwd=2) SURV2
