[site]: stackoverflow
[post_id]: 3030545
[parent_id]: 3030254
[tags]: 
ok here's the answer - it works and I tested it in MySQL. create table tab1 ( pk int not null default 0 primary key, col char(1) not null ); create table tab2 ( pk int not null default 0 primary key, col char(1) not null ); delimiter | create trigger tab1_pk before insert on tab1 for each row begin set new.pk = greatest(coalesce((select max(pk) from tab1), 0), coalesce((select max(pk) from tab2), 0)) + 1; end; | delimiter | create trigger tab2_pk before insert on tab2 for each row begin set new.pk = greatest(coalesce((select max(pk) from tab1), 0), coalesce((select max(pk) from tab2), 0)) + 1; end; | delimiter ; As usual with MySQL solutions are a bit convoluted. So here we check the max pk value in both tables (which might be null). The greatest function (a MySQL thing) picks the largest value but results in null if either or both are null. So we coalesce to 0 and add 1. Note the bizzaro delimiter shenanigans. This is necessary because MySQL developers are C / Perl programmers that think all things must end in a semicolon and thus the need for a delimiter in SQL creeped in. The semicolons idiotically terminate the definition of a trigger or stored procedure early unless you change the delimiter to something else - a | in this case. Why is MySQL so popular? I guess it's like asking why PHP, Perl and Java are too - ugh. Anyway stepping off of the rant box now so here are the tests: dbserver/mydb> insert tab1(col) values('a'); Query OK, 1 row affected (0.06 sec) dbserver/mydb> select * from tab1; +----+-----+ | pk | col | +----+-----+ | 1 | a | +----+-----+ 1 row in set (0.00 sec) dbserver/mydb> insert tab1(col) values('b'); Query OK, 1 row affected (0.05 sec) dbserver/mydb> select * from tab1; +----+-----+ | pk | col | +----+-----+ | 1 | a | | 2 | b | +----+-----+ 2 rows in set (0.00 sec) dbserver/mydb> insert tab2(col) values('a'); Query OK, 1 row affected (0.07 sec) dbserver/mydb> select * from tab2; +----+-----+ | pk | col | +----+-----+ | 3 | a | +----+-----+ 1 row in set (0.00 sec) dbserver/mydb> insert tab1(col) values('c'); Query OK, 1 row affected (0.07 sec) dbserver/mydb> select * from tab1; +----+-----+ | pk | col | +----+-----+ | 1 | a | | 2 | b | | 4 | c | +----+-----+ 3 rows in set (0.00 sec) dbserver/mydb> insert tab2(col) values('b'); Query OK, 1 row affected (0.05 sec) dbserver/mydb> select * from tab2; +----+-----+ | pk | col | +----+-----+ | 3 | a | | 5 | b | +----+-----+ 2 rows in set (0.00 sec)
