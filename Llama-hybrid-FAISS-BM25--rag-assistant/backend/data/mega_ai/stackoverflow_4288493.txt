[site]: stackoverflow
[post_id]: 4288493
[parent_id]: 
[tags]: 
WPF/MVVM: Re-use a ViewModel in multiple Controller and Separation of Concerns

In my AdministrationController I use a PupilViewModel like: _adminRepo.GetSchoolclassPupilList().ForEach(s => { SchoolclassViewModel sVM = new SchoolclassViewModel(s, _adminRepo); foreach (PupilViewModel pVM in sVM.PupilListViewModel) { pVM.Documents.DeleteDocumentDelegate += new Action >(OnDeleteDocument); pVM.Documents.AddDocumentDelegate += new Action(OnAddDocument); pVM.Documents.OpenDocumentDelegate += new Action (OnOpenDocument); } SchoolclassList.Add(sVM); }); The PupilViewModel is created that way: public SchoolclassViewModel(Schoolclass schoolclass, IAdministrationRepository adminRepo) { _schoolclass = schoolclass; _adminRepo = adminRepo; PupilListViewModel = new ObservableCollection (); schoolclass.Pupils.ForEach(p => PupilListViewModel.Add(new PupilViewModel(p, _adminRepo))); } As you surely noticed the PupilViewModel takes 2 paramter in its Constructor. The important one is the 2nd paramter which is a service/repository to be specific its the IAdministrationRepository instance. There exists now another Controller called IncidentReportingController . In its Constructor I do the same as in the AdministrationController: // When I now try to wrap my pupils into a ViewModel I have a problem: IEnumerable pupils = incidentRepo.GetPupilIncidentReportDocumentList(); PupilViewModels = new ObservableCollection (pupils.Select(p => new PupilViewModel(p, ???))); A.) Either I do not want to pass a Service to the PupilViewModel because there is no reason to update a property i the PupilViewModel as it is readonly in the View. B.) In my AdministrationController I get data from the service from this Aggregation : 1 Schoolclass has N Pupils and 1 Pupil has N Documents . Those entities are wrapped into SchoolclassViewmodels , PupilViewModels and DocumentViewModels ... Now in my IncidentController I get data from the service too and my Aggregation is pretty similar: 1 Pupil has N IncidentReports and 1 IncidentReport has N Documents . Those entities are wrapped into PupilViewModels , IncidentReportViewModels , DocumentViewModels ... PROBLEM is => In the PupilViewModel class it wraps already a DocumentListViewModel. Now I need the PupilViewModel again to wrap a IncidentReportListViewModel and Later again I have 1 Pupil has 1 SeatingChair and wrap those again. That means I have to pass THREE Services to the PupilViewModel although I do not always need them. Its hard for me to cut right to the chase with the problem but somehow I feel that is not the right way. So How do I re-use the same ViewModel which wrap entities with different aggregations having different services?
