[site]: stackoverflow
[post_id]: 2226887
[parent_id]: 2226824
[tags]: 
I'm fairly confident that this should work: SELECT `typeID`, AVG(IF(`bid`, `price`, 0)) AS `average_buy_price`, AVG(IF(`bid`, 0, `price`)) AS `average_sell_price`, AVG(IF(`bid`, `price`, 0)) - AVG(IF(`bid`, 0, `price`)) AS `difference` FROM `orders` GROUP BY `typeID` LIMIT 100 ORDER BY `difference` DESC;
