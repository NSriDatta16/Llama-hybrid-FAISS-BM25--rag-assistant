[site]: crossvalidated
[post_id]: 243373
[parent_id]: 
[tags]: 
R - generating bi-variate correlated t-student with specific mean and variance

I have two correlated time series (stock returns a and b). The two stock return series have empitical correlation rho, averages mu.a/mu.b, and standard deviation sd.1/sd.b. I am getting the degree-of-freedom fit with QRM package, and have nu.a and nu.b degrees of freedom What I am trying to do : generate two correlated t-student distributions with the same mean and variance than in the sample. Coding is in R. What I have done thus far: Generated two independent Gaussians [0,1] Turned them into correlated uniforms (with the empirical correlation rho) Transformed them in t-student distributions by feeding the uniforms to the CDF of t-student Code: # draw standard normal samples z1 = rnorm(N) ; z2 = rnorm(N) # generate correlated uniforms u1 = pnorm(z1) u2 = pnorm(rho*z1 + sqrt (1-rho)*z2 ) # feeding to student-t t1 = qt(u1,nu.a) t2 = qt(u1,nu.b) My question is, how do I "scale" those to the empirical data that I am trying to simulate? I am using a linear transformation but I'm not sure it's the correct way a.ret = a.mu + sd.a * t1 b.ret = b.mu + sd.b * t1 Any help much appreciated. Thank you
