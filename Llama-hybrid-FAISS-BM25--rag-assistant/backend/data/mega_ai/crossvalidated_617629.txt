[site]: crossvalidated
[post_id]: 617629
[parent_id]: 
[tags]: 
Modifying the Variance of the Sample Mean

I am trying to teach myself more about the mathematical background, properties and theory involved with calculating different types of "weighted mean estimators" - specifically, if I have sample means from different experiments, how can I combine these sample means together and create an estimate of the "mean of means" (i.e. "weighted mean"). As I understand, there are different types means that can be calculated. For example, a "weighted mean" based on sample size counts can be calculated in such a way that places more emphasis on individual means that were calculated with larger sample sizes. On the other hand, a different type of "weighted mean" can be calculated based on the variances associated with each mean, such that individual means with smaller variances influence the final estimate of the "weighted mean" more compared to means with larger variances. In a hypothetical example where we have access to the Population Variances of each mean and all individual means themselves are Normally Distributed with a common mean (but different variances) - this approach can be shown to provide a final estimate of the "weighted mean" having the overall lower variance ( https://en.wikipedia.org/wiki/Inverse-variance_weighting ). Note that when the assumption of Population Variances are relaxed and we only have access to Sample Variances, the following paper ( https://www.jstor.org/stable/3001633 ) shows how to adjust the estimates of the "weighted mean" accordingly. I am interested in further studying the mathematical properties of the "weighted mean" in more "realistic situations" where various of the above assumptions are not satisfied (e.g. unequal sample means and sample variances). I found the following paper ( https://www.jstor.org/stable/3001666 ) in which a "weighted mean estimator" is presented. Part 1: First, lets consider an instance where the variances of all means are the same. Suppose we collected sample data (e.g. heights) on $k$ different countries. For some given country $i$ , we can estimate the average height of country $i$ using $x_i$ - where $\mu_i$ is the actual mean of the population for country $i$ and $\mu$ is the mean of the population for all countries. In this case, the unweighted mean of all means $\bar{x}$ is still the "best estimator" of $\bar{x}$ (and $s_b^2$ is an unbiased estimator of $\sigma_{\mu}^2 + \sigma^2$ ) : $$x_i = \mu_i + e_i = \mu + (\mu_i - \mu) + e_i$$ $$Var(x_i) = \sigma_{\mu}^2 + \sigma^2$$ $$\bar{x} = \frac{\sum_{i=1}^{k} x_i}{k}$$ $$s.e.(\bar{x}) = \frac{s_b}{\sqrt{k}} = \sqrt{\frac{\sum(x_i - \bar{x})^2}{k(k-1)}}$$ Part 2: Now, lets consider a more realistic case where the variances of each mean is different: $$x_i = \mu_i + e_i = \mu + (\mu_i - \mu) + e_i$$ $$Var(x_i) = \sigma_{\mu}^2 + \sigma_i^2$$ In this situation, we can consider a new type of "semi-weighted estimator" (sw) : $$\bar{x}_{sw} = \frac{\sum_{i=1}^{k} \hat{W_i} x_i}{\sum \hat{W_i}}$$ $$\hat{W_i} = \frac{1}{S_{\mu}^2 + S_i^2}$$ $$S_{\mu}^2 = \frac{\sum_{i=1}^{k} (x_i - \bar{x})^2}{k-1} - \bar{\sigma}^2$$ My Question: On page 122 (page 23 on the PDF - https://www.jstor.org/stable/3001633 ), in (22), the author writes that the Variance of this semi-weighted mean ( provided population variances ) can be written as: $$W_i = \frac{1}{\sigma_{\mu}^2 + \sigma_i^2}$$ $$V(\bar{x}_{sw}) = \frac{1}{\sum W_i}$$ (Note: In the following paper https://www.jstor.org/stable/1267323 , the above weights are demonstrated to be the "optimal weights", i.e. produce the lowest variance) I am interested in adjusting this variance formula when we have sample variances $S_{\mu}^2$ and $S_i^2$ . In this paper ( https://www.jstor.org/stable/3001633 ), a similar adjustment is provided for estimating the variance of the weighted mean when sample variances are provided and all sample means are same (note that a different notation is being used here, e.g. here $\mu$ is actually the sample mean) : $$\hat{w_i} = \frac{n_i}{s_i^2}$$ $$\hat{w} = \sum \hat{w_i}$$ $$\bar{\mu} = \sum_{i=1}^{k} \hat{\theta}_i u_i$$ $$\hat{\theta}_i = \frac{(s_i^2)^{-1}}{\sum_{i=1}^{k}(s_i^2)^{-1}}$$ $$\text{Var}(\bar{\mu}) = V^* = \frac{1}{\hat{w}}\left(1 + 4\sum_{i=1}^{k}\frac{1}{n_i}\hat{\theta}_i(1-\hat{\theta}_i)\right)$$ Using a similar logic - I want to apply a similar adjustment factor to the situation where the sample means are different and the weights are now given by: $$\hat{W_i} = \frac{1}{s_{\mu}^2 + s_i^2}$$ $$\text{Var}(\bar{x}_{sw}) = V^* = \frac{1}{\hat{w}}\left(1 + 4\sum_{i=1}^{k}\frac{1}{n_i}\hat{\theta}_i(1-\hat{\theta}_i)\right)$$ $$\text{Var}(\bar{x}_{sw}) = V^* = \frac{1}{\sum \frac{1}{s_{\mu}^2 + s_i^2}}\left(1 + 4\sum_{i=1}^{k}\frac{1}{n_i}\hat{\theta}_i(1-\hat{\theta}_i)\right)$$ Is this modification correct? Thanks!
