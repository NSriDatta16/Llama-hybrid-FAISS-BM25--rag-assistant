[site]: stackoverflow
[post_id]: 4600144
[parent_id]: 4599420
[tags]: 
You could create a VIEW with the following definition SELECT CASE WHEN gender = 'M' THEN rating END AS AllM, CASE WHEN gender = 'F' THEN rating END AS AllF, CASE WHEN gender = 'M' AND UserAge(birth_date) Then SELECT from that SELECT ROUND(AVG(AllM), 1) avgAllM, COUNT(AllM) countAllM, ROUND(AVG(AllF), 1) avg, COUNT(AllF) countAllF, ROUND(AVG(U18M), 1) avgU18M, COUNT(U18M) countU18M, ROUND(AVG(U18F), 1) avgU18F, COUNT(U18F) countU18F FROM yourview Might simplify things slightly?
