[site]: stackoverflow
[post_id]: 1767218
[parent_id]: 
[tags]: 
How would you refactor this bit of code?

This bit of code runs on Windows Compact Framework and what it does is obvious. It looks as it should be refactored (especially considering that I may want to add cmd.ExecuteResultSet() later), but I can't see an elegant way to do it. Any ideas appreciated. internal void RunNonQuery(string query) { string connString = GetLocalConnectionString(); using (SqlCeConnection cn = new SqlCeConnection(connString)) { cn.Open(); SqlCeCommand cmd = cn.CreateCommand(); cmd.CommandText = query; cmd.ExecuteNonQuery(); } } internal int RunScalar(string query) { string connString = GetLocalConnectionString(); using (SqlCeConnection cn = new SqlCeConnection(connString)) { cn.Open(); SqlCeCommand cmd = cn.CreateCommand(); cmd.CommandText = query; return int.Parse(cmd.ExecuteScalar().ToString()); } }
