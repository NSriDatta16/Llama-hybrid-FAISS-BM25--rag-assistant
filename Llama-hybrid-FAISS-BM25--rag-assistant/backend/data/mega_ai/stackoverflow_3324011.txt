[site]: stackoverflow
[post_id]: 3324011
[parent_id]: 3306133
[tags]: 
I finally worked out a decent solution. It involves saving the ado recordset from memory to an excel file using the copyFromRecordset function, and then linking the file programmatically to a table in excel using the TransferSpreadsheet()... Sub saveToExcel() Dim cnn As ADODB.Connection 'declare variables Dim rs As ADODB.Recordset Dim strSQL As String Dim decision As Integer Dim colIndex As Integer ' Dim fso As New FileSystemObject ' Dim aFile As File 'set up connection to foxpro database Set cnn = New ADODB.Connection cnn.ConnectionString = "Provider=vfpoledb;" & _ "Data Source=s:\jobinfo\data\jobinfo.dbc;" & _ "Mode=ReadWrite|Share Deny None;" & _ "Collating Sequence=MACHINE;" & _ "Password=''" cnn.Open Set rs = cnn.Execute("Select * from clients") 'Create a new workbook in Excel Dim oExcel As Object Dim oBook As Object Dim oSheet As Object Set oExcel = CreateObject("Excel.Application") Set oBook = oExcel.Workbooks.Add Set oSheet = oBook.Worksheets(1) oSheet.Name = "clients" ' Copy the column headers to the destination worksheet For colIndex = 0 To rs.Fields.Count - 1 oSheet.Cells(1, colIndex + 1).Value = rs.Fields(colIndex).Name Next 'Transfer the data to Excel oSheet.Range("A2").CopyFromRecordset rs ' Format the sheet bold and auto width of columns oSheet.Rows(1).Font.Bold = True oSheet.UsedRange.Columns.AutoFit 'delete file if it exists - enable scripting runtime model for this to run 'If (fso.FileExists("C:\Documents and Settings\user\Desktop\clients.xls")) Then ' aFile = fso.GetFile("C:\Documents and Settings\user\Desktop\clients.xls") ' aFile.Delete 'End If 'Save the Workbook and Quit Excel oBook.SaveAs "C:\Documents and Settings\user\Desktop\clients.xls" oExcel.Quit 'Close the connection rs.Close cnn.Close MsgBox ("Exporting Clients Done") 'link table to excel file DoCmd.TransferSpreadsheet acLink, acSpreadsheetTypeExcel5, "clientsTest", "C:\Documents and Settings\user\Desktop\clients.xls", True End Sub
