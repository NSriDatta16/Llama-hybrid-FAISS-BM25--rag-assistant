[site]: stackoverflow
[post_id]: 3698734
[parent_id]: 
[tags]: 
Locbaml error when using VisualStateManager in Framework 3.5

When I translated the Tester.WPF.resources.dll, I get an error. It's like the baml file have modified VisualStateGroup to an collection. I don't understand. The poject starts up without any problem in the default language, but if I change the culture, it crashes. I Rebuild it, still that error, even when a start from scratch. With this small test project and still get the same error: Object of type 'System.Windows.VisualStateGroup' cannot be converted to type 'System.Collections.ObjectModel.Collection`1[System.Windows.VisualStateGroup]'. StackTrace at System.Windows.Markup.XamlParseException.ThrowException(String message, Exception innerException, Int32 lineNumber, Int32 linePosition, Uri baseUri, XamlObjectIds currentXamlObjectIds, XamlObjectIds contextXamlObjectIds, Type objectType) at System.Windows.Markup.XamlParseException.ThrowException(ParserContext parserContext, Int32 lineNumber, Int32 linePosition, String message, Exception innerException) at System.Windows.Markup.BamlRecordReader.ThrowExceptionWithLine(String message, Exception innerException) at System.Windows.Markup.BamlRecordReader.SetClrComplexProperty(Object parentObject, MemberInfo memberInfo, Object o) at System.Windows.Markup.BamlRecordReader.SetPropertyValueToParent(Boolean fromStartTag, Boolean& isMarkupExtension) at System.Windows.Markup.BamlRecordReader.ReadElementEndRecord(Boolean fromNestedBamlRecordReader) at System.Windows.Markup.BamlRecordReader.ReadRecord(BamlRecord bamlRecord) at System.Windows.Markup.BamlRecordReader.Read(Boolean singleRecord) at System.Windows.Markup.TreeBuilderBamlTranslator.ParseFragment() at System.Windows.Markup.TreeBuilder.Parse() at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream) at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator) at Tester.WPF.Window1.InitializeComponent() TestWindow App code private void Application_Startup(object sender, StartupEventArgs e) { Thread.CurrentThread.CurrentUICulture = new CultureInfo("fr-BE"); Thread.CurrentThread.CurrentCulture = new CultureInfo("fr-BE"); var dictionaryList = new List (); foreach (ResourceDictionary dictionary in Application.Current.Resources.MergedDictionaries) dictionaryList.Add(dictionary.Source); Application.Current.Resources.MergedDictionaries.Clear(); foreach (Uri uri in dictionaryList) Application.Current.Resources.MergedDictionaries.Add(new ResourceDictionary { Source = uri }); } } Thanks for any suggestion.
