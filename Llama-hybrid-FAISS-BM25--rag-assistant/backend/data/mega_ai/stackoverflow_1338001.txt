[site]: stackoverflow
[post_id]: 1338001
[parent_id]: 
[tags]: 
Verifying equivalence of a secret

Alice & Bob are both secret quadruple agents who could be working for the US, Russia or China. They want to come up with a scheme that would: If they are both working for the same side, prove this to each other so they can talk freely. If they are working for different sides, not expose any additional information about which side they are on. Oh, and because of the sensitive nature of what they do, there is no trusted third party who can do the comparison for both of them. What protocol would be able to satisfy both of these needs? Ideally, any protocol would also be able to generalize to multiple participants and multiples states but that's not essential. I've puzzled over it for a while and I can't find a satisfactory solution, mainly owing to condition 2. edit: Here's the original problem that motivated me to look for a solution. "Charlie" had some personal photos that he shared with me and I later discovered that he had also shared them with "Bob". We both wanted to know if we had the same set of photos but, at the same time, if Charlie hadn't shared a certain photo with either of us, he probably had a good reason not to and we didn't want to leak information. My first thought would be for each of us to concatenate all the photos and provide the MD5 sum. If they matched, then we had the same photos but if they didn't, neither party would know which photos the other had. However, I realized soon after that this scheme would still leak information because Bob could generate an MD5 for each subset of photos he had and if any of them matched my sum, he would know which photos I didn't have. I've yet to find a satisfactory solution to this particular problem but I thought I would generalize it to avoid people focusing on the particulars of my situation.
