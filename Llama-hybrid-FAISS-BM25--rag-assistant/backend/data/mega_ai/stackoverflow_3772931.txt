[site]: stackoverflow
[post_id]: 3772931
[parent_id]: 3772767
[tags]: 
Assuming that (personid, category, createts) is unique... SELECT ppc.personid, ppc.category, ppc.phonenumber, ppc.createts FROM person_phone_contacts AS ppc INNER JOIN ( SELECT personid, category, MAX(createts) AS newest_createts FROM person_phone_contacts WHERE CURRENT_TIMESTAMP BETWEEN createts AND endts AND CURRENT_DATE BETWEEN effectivedate AND enddate GROUP BY personid, category ) AS ppc2 ON ppc.personid = ppc2.personid AND ppc.category = ppc2.category AND ppc.createts = ppc2.newest_createts I'm not familiar with Postgres' SQL dialect (using MSSQL myself, where this could be solved more elegantly), but since this is pretty much standard SQL I think it should work.
