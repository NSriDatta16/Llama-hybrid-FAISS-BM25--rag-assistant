[site]: crossvalidated
[post_id]: 505021
[parent_id]: 
[tags]: 
mgcv and cyclic smoothers, am I doing it right?

TLDR: Need advice on implementation of model, particularly cyclical smoothers I'm constructing a model that has around 3 months of daily data (a few days missing) for a response variable that falls between 0 and 400 ( MR_dist ; around 800 data points). This is representative of mean distance in meters of sound propagation (should mention that each datapoint is taken from the midpoint of a series of logistic regression models). I want to know how this variable is influenced by a variety of environmental variables, some of these relationships will definitely be non-linear. As a result I've decided to use mgcv in r to fit the model. The explanatory variables are both continuous and factors. Here is the head of the data: They are: date = date on which the measurement is taken section = categorical variable of 11 levels indicating site at which measurements were taken habitat = factor variable indicating whether the measurement falls under one of four habitat types mean_wh = continuous variable of wave height mean_wind_speed = continuous variable of wind speed tidal_reach = tide strength on that day I've thus far fitted the following model: m = mgcv::bam(MR_dist ~ section + s(date, k = 15, bs = 'cc') + s(mean_wh, k = 3) + s(mean_wind_speed, k = 3) + s(tidal_reach, k = 15, bs = 'cc'), data = df, method = 'REML') I decided to fit date and tidal reach using a cyclical smoothers, and after some initial visualization I've decided to set quite low k-values for some of the vars. As you may note habitat isn't included in the above model as it was causing problems with outputs (I have no idea why): These are just the model outputs: I have lots of questions, but main ones are: Have I specified the model somewhat correctly, including the use of the cyclical smoothers? Why is it that if I included habitat (which is basically a factor which breaks down section into four groups) I have missing outputs? To the best of my knowledge the relationship between some of the explanatory variables and the response seems linear, is this an issue if I use mgcv (quite clearly some of the relationship are non-linear, such as date), do I need to add something to say they are linear (I've just kept the k value low)? Thank you. update 26/01/2021 I've decided to drop habitat from the model as it was making things difficult to interpret. Site is still within the model and it represents an 11 level categorical variable. I've also dropped the cyclic smoothers as I had misunderstood their use. Here is the model structure as it stands in equation form: and here is the code used in mgcv: m1 = mgcv::bam(MR_dist ~s_site + s(date, bs = "gp", k = 20) + s(mean_wh) + s(mean_wind_speed, k = 15) + s(daily_rain, k = 15) + s(ship_count) + s(tidal_range) + s(mean_wh, by = s_site) + s(mean_wind_speed, by = s_site) + s(daily_rain, by = s_site) + s(ship_count, by = s_site)+ s(tidal_range, by = s_site), data = df, method = 'fREML', select = TRUE) Any feedback on the structure would be really appreciated. Does this seems suitable? Another change I've made was to use a gaussian process smooth as base function for date (given there might be temporal autocorrelation in response). Is this correct?
