[site]: crossvalidated
[post_id]: 601966
[parent_id]: 
[tags]: 
Correct renormalization of the product of two probabilistic models

I came across these two papers combining an energy-based model (EBM) with a probabilistic generative model: [Xiao et al., 2020] and [Xiao et al., 2021] . In [Xiao et al., 2020] , the new model is defined as: \begin{equation} p_{\phi, \theta}(x) = \frac{p_{\phi}(x)e^{-E_{\theta}(x)}}{\int p_{\phi}(x)e^{-E_{\theta}(x)} dx} = \frac{p_{\phi}(x) e^{-E_{\theta}(x)}}{Z_{\phi, \theta}} \end{equation} where $p_{\phi}(x)$ is a probabilistic generative model and $p_{\theta}(x) = \frac{e^{-E_{\theta}(x)}}{\int e^{-E_{\theta}(x)} dx}$ is an EBM. In [Xiao et al., 2021] , the authors use a VAE generator $p_{\phi}(x, z) = p_{\phi}(z)p_{\phi}(x|z)$ and define the new model as: \begin{equation} h_{\phi, \theta}(x,z) = \frac{p_{\phi}(x, z) e^{-E_{\theta}(x)}}{\int p_{\phi}(x)e^{-E_{\theta}(x)}dx} = \frac{p_{\phi}(x, z) e^{-E_{\theta}(x)}}{Z_{\phi, \theta}} \end{equation} My question is: shouldn't the renormalization in the second case be $Z_{\phi, \theta} = \int p_{\phi}(x, z)e^{-E_{\theta}(x)}dx$ ?
