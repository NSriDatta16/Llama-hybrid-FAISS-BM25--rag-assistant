[site]: crossvalidated
[post_id]: 108790
[parent_id]: 
[tags]: 
Markov blanket conditional distribution derivation

I am trying to derive the formula for the conditional distribution for a variable in a Bayesian network: $$p(x_j|x_{-j})=p(x_j|x_{pa(j)})\prod_{k\in ch(j)}p(x_k|x_{pa(k)})$$ I understand D-separation and why these variables are the only ones involved, but I just can't seem to get the derivation right. In particular, the integral in the denominator must evaluate to 1, and I don't see why. Anyway, here's my attempt: $$p(x_j|x_{-j})=\frac{p(x)}{p(x_{-j})}=\frac{\prod_i p(x_i|x_{pa(i)})}{\int \prod_i p(x_i|x_{pa(i)})dx_j} $$ $$=\frac{p(x_j|x_{pa(j)})\prod_{i\neq j} p(x_i|x_{pa(i)})}{\prod_{k\neq j, k\notin ch(j)} p(x_k|x_{pa(k)})\int p(x_j|x_{pa(j)})\prod_{l\in ch(j)}p(x_l|x_{pa(l)})dx_j}$$ $$ \frac{p(x_j|x_{pa(j)})\prod_{k\in ch(j)}p(x_k|x_{pa(k)})}{\int p(x_j|x_{pa(j)})\prod_{l\in ch(j)}p(x_l|x_{pa(l)})dx_j}$$ In order to get the right answer, the integral must equal 1, but I don't see why that should be.
