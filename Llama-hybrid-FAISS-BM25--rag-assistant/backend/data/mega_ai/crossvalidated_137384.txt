[site]: crossvalidated
[post_id]: 137384
[parent_id]: 
[tags]: 
Confidence Interval calculation for Power Density Estimation in MATLAB

First of all, I am new to these statistics stuff but very interested in the background. I try to understand the confidence interval calculation for a power spectral density estimate in MATLAB. For the estimation I use the pwelch function which uses Welch's Method . When a confidence level is specified, the function calls chi2conf(conf,k) where k is the number of independent measurements. In my case the number of independent measurements is the number of periodograms that are obtained by Welch's method. The different periodograms are averaged to get the power density spectrum. The function chi2conf which is implemented in MATLAB's statistics toolbox does the following: v = 2*k; alfa = 1 - conf; c = chi2inv([1-alfa/2 alfa/2], v); c = v./c; chi2inv is the inverse chi squared function, v is the degree of freedom, $c=X^2$ and conf is the confidence level, for example 0.95. My question is, why is there the factor 2 between k and v. Is this, because the periodograms are complex and therefore has two parameters? The second question is, why do they not subtract one degree of freedom, as I saw here . So MATLAB calculates $$\frac{2k\cdot s^2}{X^2_{0.975}}\lt\sigma^2\lt\frac{2k\cdot s^2}{X^2_{0.025}}$$ and the theory says $$\frac{(k-1)\cdot s^2}{X^2_{0.975}}\lt\sigma^2\lt\frac{(k-1)\cdot s^2}{X^2_{0.025}}$$ and the third, maybe correct option would be $$\frac{(2k-1)\cdot s^2}{X^2_{0.975}}\lt\sigma^2\lt\frac{(2k-1)\cdot s^2}{X^2_{0.025}}$$ The sampling variance $s^2$ is here the power spectral density estimate itself, because it is obtained by calculating the auto-correlation which is closely related to the variance, if I understand correctly. I hope, I am not too confusing. Thanks for your help!
