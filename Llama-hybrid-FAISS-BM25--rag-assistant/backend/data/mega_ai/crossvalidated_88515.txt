[site]: crossvalidated
[post_id]: 88515
[parent_id]: 
[tags]: 
Analytical formulation of a Hierarhical Bayes problem

In the free online book Bayesian Methods for Hackers , the last figure shows the estimation of the expected value of $\lambda$ for any given day: It looks like the author is calculating the expected value of the posterior for $\lambda$ for a given day. To do so, the author re-uses the MCMC samples from the full estimation of $\lambda_1$ and $\lambda_2$. But how does the posterior of $\lambda$ for a given day relate to $\lambda_1$ and $\lambda_2$? And why can one re-use the samples from the full MCMC calculation? In case it matters, below is the Python code in question that calculates the red line in the graph above. figsize(12.5, 5) # tau_samples, lambda_1_samples, lambda_2_samples contain # N samples from the corresponding posterior distribution N = tau_samples.shape[0] expected_texts_per_day = np.zeros(n_count_data) for day in range(0, n_count_data): # ix is a bool index of all tau samples corresponding to # the switchpoint occurring prior to value of 'day' ix = day
