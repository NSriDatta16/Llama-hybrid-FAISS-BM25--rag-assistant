[site]: crossvalidated
[post_id]: 93495
[parent_id]: 
[tags]: 
Ignorability in Rubin's theory of missing data mechanisms

I am trying to understand Rubin's theory of bayesian inference with missing data, specifically how the missing data mechanism affects the inference on a superpopulation parameter. The theory is exposed for example in the chapter 7 of [1]. The complete $N$-dimensional data vector $y$ is splitted into an observed and unobserved components: $y = (y_{\mathrm{obs}}, y_{\mathrm{nob}})$ and $I$ is the $N$-vector of indicators whose components $I_{i}$ equal 0 when $y_{i}$ is unobserved and 1 when it is observed. The sample space is thus the product of the $y$ space and the $I$ space. For simplicity, I consider a missing data mechanism $p(I ~|~ y_{\mathrm{obs}})$ which does not depend on a fully observed covariate $x$ or an unknown parameter $\phi$. The key result in Rubin is that when $p(I ~|~ y) = p(I ~|~ y_{\mathrm{obs}})$, the missing data mechanism is ignorable and the analysis can proceed as usual. This can be seen in the following development: $$ \begin{align*} p(\theta ~|~ y_{\mathrm{obs}}, I) &~=~ \frac{p(\theta) \int p(y~|~\theta)\, p(I ~|~ y)~d y_{\mathrm{nob}}~}{\int\int p(y~|~\theta)\,p(\theta) ~d\theta p(I ~|~ y)~d y_{\mathrm{nob}}~} \\ \end{align*} $$ If $p(I ~|~ y) = p(I ~|~ y_{\mathrm{obs}})$, it can be taken out of the integrals and cancelled out such that the posterior distribution $p(\theta ~|~ y_{\mathrm{obs}}, I) = p(\theta ~|~ y_{\mathrm{obs}})$. So far so good. But what I don't understand is the following derivation that contradicts the preceding result: $$ \begin{align*} p(\theta ~|~ y_{\mathrm{obs}}, I) &~=~ \frac{p(y_{\mathrm{obs}}, I, \theta)}{p(y_{\mathrm{obs}}, I)} \\ &~=~ \frac{p(y_{\mathrm{obs}} ~|~ \theta) p(\theta) p(I ~|~ y_{\mathrm{obs}})}{\int p(y_{\mathrm{obs}} ~|~\theta)p(\theta) ~d\theta~ p(I ~|~ y_{\mathrm{obs}})} \\ &~=~ \frac{p(y_{\mathrm{obs}} ~|~ \theta)p(\theta)}{\int p(y_{\mathrm{obs}} ~|~\theta)p(\theta) ~d\theta} \\ &~=~ p(\theta ~|~ y_{\mathrm{obs}}). \end{align*} $$ Here the sampling mechanism cancels out no matter what. It does not matter if $p(I ~|~ y) = p(I ~|~ y_{\mathrm{obs}})$. I must be doing something wrong, but I can't see what. [1] Gelman, A., Carlin, J. B., Stern, H. S., & Rubin, D. B. (2004). Bayesian Data Analysis (2nd ed.). Boca Raton: Chapman & Hall/CRC.
