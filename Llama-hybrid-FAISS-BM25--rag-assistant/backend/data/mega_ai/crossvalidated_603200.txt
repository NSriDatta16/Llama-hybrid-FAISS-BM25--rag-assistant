[site]: crossvalidated
[post_id]: 603200
[parent_id]: 
[tags]: 
Simulating a mixture model in time series

Let $\Phi (\cdot)$ be the cdf of the standard normal distribution. Given $(y_t)_{t \in \mathbb N}$ a time series. Suppose $F(y_t | \mathcal{F}_{t-1})$ is the conditional cumulative distribution function of $y_t$ given the past information, evaluated at $y_t$ , where $\mathcal{F}_t$ is the information set up to time $t$ . I would like to simulate the following model: \begin{equation} F(y_t | \mathcal{F}_{t-1}) = 0.75 \, \Phi \left(\frac{y_t- 0.5 \, y_{t-1} }{5.0}\right) + 0.25 \, \Phi \left(\frac{y_t- 0.4 \, y_{t-1} }{1.0}\right) \end{equation} Note that defining $u_t = \frac{y_t- 0.5 \, y_{t-1} }{5.0} $ and $v_t = \frac{y_t- 1.4 \, y_{t-1} }{1.0} $ , we have \begin{equation}\label{AR123}\tag I y_t = 0.5 y_{t-1} + 5 u_t, \quad u_{t} \overset{iid}{\sim} N(0,1) \end{equation} and \begin{equation}\label{AR1234}\tag{II} y_t = 0.4 y_{t-1} + v_t, \quad v_{t} \overset{iid}{\sim} N(0,1) \end{equation} At first I thought this was to draw a Bernoulli(0.75) and then choose a realization of (\ref{AR123}) or (\ref{AR1234}): # My function simulating an AR ar_sim = function(n, a, b) { # Normal errors e = b*rnorm(n, mean=0, sd=1) # my simulation x = rep(0,n) for (t in 2:n) { x[t] = a*x[t-1] + e[t] } return(x) } # Size of my sample T = 1000 # Bernoulli d = sample(c(1,0), 1, prob=c(0.75,0.25)) if (d==1) { x = ar_sim(T,.5, 10) } else{ x = ar_sim(T,0.4, 1) } ts.plot(x) But I believe I'm making mistakes in this simulation. Could you help me to do the simulation correctly?
