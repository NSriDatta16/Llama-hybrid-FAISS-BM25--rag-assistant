[site]: crossvalidated
[post_id]: 308130
[parent_id]: 
[tags]: 
Linearity of Expectations - Repeated Card Draw

Scenario: You are given a standard deck of cards and told to draw one card at a time from the deck and record the color of that card. Continue until all the cards have been drawn without replacing any cards. Let the random variable $Z$ represent the number of times that you see a red card followed by a black card. Question: What is $\mathbb{E}(Z)$? Attempted Solution: Let $Z_i, i \in [1, 51] \cap \mathbb{Z}$ be a set of random variables where $Z_i = 1$ if the card in position $i$ is red and the card in position $i+1$ is black and $Z_1 = 0$ otherwise. Since $Z = \sum_{i = 1}^{51}Z_i$, we have the following by linearity of expectations: $$\mathbb{E}(Z) = \sum_{i = 1}^{51}\mathbb{E}(Z_i)$$ Moreover, since the probability of drawing a red card followed by a black card without replacement from a standard deck is $\frac{26}{52} \cdot \frac{26}{51}$, we have: $$\mathbb{E}(Z) = \sum_{i = 1}^{51}\bigg(\frac{26}{52} \cdot \frac{26}{51}\bigg) = 51 \cdot \bigg(\frac{26}{52} \cdot \frac{26}{51}\bigg) = \frac{26^2}{52} = 13$$ Issue: The fact that linearity of expectations holds even when the random variables are dependent seemed like witchcraft to me, so I wrote a Python script to determine an experimental value of Z. This program gives me that on average $Z \approx 11.8$. Am I misinterpreting how to apply the linearity of expectations in this problem? Here's the script I used: from random import * output_values = []; n = 0; while n 0 and black > 0: choose = randint(0,1); if choose == 0: draw[i] = "R"; red = red - 1; else: draw[i] = "B" black = black - 1; elif red == 0: draw[i] = "B" black = black - 1; elif black == 0: draw[i] = "R" red = red - 1; i += 1; #count appearances of red followed by black count_rb = 0; j = 0 while j
