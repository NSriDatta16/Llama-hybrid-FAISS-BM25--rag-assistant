[site]: stackoverflow
[post_id]: 5098493
[parent_id]: 
[tags]: 
Why Do I Get SQL Syntax Errors In My Query?

I am trying to retrieve data in the following format: Story | Story Type | Creation Date | Company Role | Tag 1 | Tag 2 | Tag 3 negative iii | Negative | 21/02/2011 | Business Analyst | Project Duration | Team Size | Process negative ccc | Negative | 22/02/2011 | Admin | Workspace Layout | Organisational | Process instead of: Story | StoryCategoryID | CreationDate | CompanyRole | Name negative iii | 1 | 21/02/2011 | Business Analyst | Project Duration negative iii | 1 | 21/02/2011 | Business Analyst | Team Size negative iii | 1 | 21/02/2011 | Business Analyst | Process negative ccc | 1 | 22/02/2011 | Admin | Workspace Layout negative ccc | 1 | 22/02/2011 | Admin | Organisational and Reporting Structure negative ccc | 1 | 22/02/2011 | Admin | Process But am getting the following errors: 1) Incorrect syntax near keyword AS, 2) Incorrect syntax near Z Here's my SQL, please help! SELECT Story, CASE StoryCategoryID WHEN 1 THEN 'Negative' WHEN 0 THEN 'Positive' ELSE CAST(StoryCategoryID as varchar(10)) as StoryCategoryID, CreationDate, CompanyRole, MAX(CASE WHEN Z.MinName = af2.Name THEN af2.Name ELSE '' END) as Tag1 , MAX(CASE WHEN Z.MinName <> af2.Name AND Z.MaxName <> af2.Name THEN af2.Name ELSE '' END) as Tag2, MAX(CASE WHEN Z.MaxName = af2.Name THEN af2.Name ELSE '' END) as Tag3 FROM ( SELECT s.Story , s.StoryCategoryID , CONVERT(VARCHAR(10), s.CreationDate, 103) AS CreationDate , m.CompanyRole , af.AgileFactorID , MIN(af.Name) MinName , MAX(af.Name) MaxName FROM Story s INNER JOIN ProjectIterationMember pm ON pm.ProjectIterationMemberID = s.ProjectIterationMemberID INNER JOIN Iterations i ON i.ProjectIterationID = pm.ProjectIterationID INNER JOIN Member m ON m.MemberID = pm.MemberID INNER JOIN ProjectStoryFactors psf ON psf.StoryID = s.StoryID INNER JOIN AgileFactors af ON af.AgileFactorID = psf.AgileFactorID WHERE i.ProjectID = '" + proj_id + "'" GROUP BY s.Story, s.StoryCategoryID, CONVERT(VARCHAR(10), s.CreationDate, 103), m.CompanyRole, af.AgileFactorID ) Z INNER JOIN AgileFactors af2 ON af2.AgileFactorID = Z.AgileFactorID GROUP BY Story, StoryCategoryID, CreationDate, CompanyRole
