[site]: stackoverflow
[post_id]: 4821831
[parent_id]: 
[tags]: 
sql server: generate primary key based on counter and another column value

I am creating a customer table with a parent table that is company. It has been dictated(chagrin) that I shall create a primary key for the customer table that is a combination of the company id which is an existing varchar(4) column in the customer table, e.g. customer.company The rest of the varchar(9) primary key shall be a zero padded counter incrementing through the number of customers within that company. E.g. where company = MSFT and this is a first insert of an MSFT record: the PK shall be MSFT00001 on subsequent inserts the PK would be MSFT00001, MSFT00002 etc. Then when company = INTL and its first record is inserted, the first record would be INTL00001 I began with an instead of trigger and a udf that I created from other stackoverflow responses. ALTER FUNCTION [dbo].[GetNextID] ( @in varchar(9) ) RETURNS varchar(9) AS BEGIN DECLARE @prefix varchar(9); DECLARE @res varchar(9); DECLARE @pad varchar(9); DECLARE @num int; DECLARE @start int; if LEN(@in) How would I write my instead of trigger to insert the values and increment this primary key. Or should I give it up and start a lawnmowing business? Sorry for that tmpvarchar variable SQL server was giving me strange results without it.
