[site]: crossvalidated
[post_id]: 641234
[parent_id]: 639694
[tags]: 
The data structure looks fine except Day needs recoding. I guess Day = 1 for Treatment = Before and Treatment = After are different days. Assuming Day = 5 when Treatment = Before is the last day before treatment, we can redefine Day = ifelse(Treatment == "Before", Day - 5, Day) so that Day ranges -4 to 5. Bj√∂rn gave the Bayesian approach. In frequentist mixed-effects modeling, there are also options to incorporate error-variance heterogeneity. Using nlme , a model could be lme(Y ~ Treatment * Day + X1 + X2, random = ~ 1 | Subject, weights = varIdent(form = ~ 1 | Treatment)) gls(Y ~ Treatment * Day + X1 + X2, correlation = corAR1(form = ~ Day | Subject), weights = varIdent(form = ~ 1 | Treatment)) Random slopes of Day before and after treatment by Subject are worth testing. The random-intercept model is equivalent to GLS with a compound-symmetry correlation structure where correlation = corCompSymm(form = ~ 1 | Subject) . glmmTMB also estimate heteroscedasticity with random effects and correlated errors. See tutorials https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html . glmmTMB(Y ~ Treatment * Day + X1 + X2 + (1 | Subject), dispformula = ~ Treatment, family = gaussian) glmmTMB(Y ~ Treatment * Day + X1 + X2 + ar1(0 + factor(Day) | Subject), dispformula = ~ Treatment, family = gaussian) See a tutorial https://hbiostat.org/rmsc/long that includes both frequentist and Bayesian longitudinal data analysis.
