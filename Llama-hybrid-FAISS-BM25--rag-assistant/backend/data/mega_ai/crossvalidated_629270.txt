[site]: crossvalidated
[post_id]: 629270
[parent_id]: 
[tags]: 
mgcv gam P-value vs plotted confidence intervals

I am trying to figure out how to explain the apparent discrepancy between P-values and plotted confidence intervals in mgcv. See for example the plot below that comes from a model that considers the association between a serum marker of diabetes and pregnancy complications. The P-value for the smooth term based on the GAM output is 0.01, but the partial effect plot clearly shows a confidence band that spans the null value of zero. Couple of questions: I read that in the mgcv implementation of GAM, computation of p-values for the smooth terms does not take into account uncertainty of the smoothness parameter. What does that mean exactly? In practical terms, my understanding is that this means that the observed P-values might be too low compared to where they should be. Relatedly, for plotting, using the seWithMean option in the plotting allows one to show the component smooths with confidence intervals that include the uncertainty about the overall mean – which should result in better coverage performance. However, choosing this does not seem to affect the P-value calculations.Correct? But shouldn't the P-value take into account all uncertaintly for the term in the model? I am unclear about the use of the ‘unconditional’ option. The vignette suggests that if set to TRUE, the smoothing parameter uncertainty corrected covariance matrix is used to compute uncertainty bands, if available. Otherwise the bands treat the smoothing parameters as fixed. What does it mean “if available”? and what does it all mean in general? Finally, for the bottom line – when using splines, we often use plotting as the primary mean of showing the result. However, people often request a p-value as well. When the P-value doesn’t agree with the plots, what does one do? Thank you!
