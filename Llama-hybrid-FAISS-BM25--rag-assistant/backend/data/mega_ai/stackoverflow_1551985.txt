[site]: stackoverflow
[post_id]: 1551985
[parent_id]: 
[tags]: 
Retrieve the last id from the SQL Server database table

How do I get the last id created in the policy table and store it into a variable so that I can use it for another table called backupspec table. System.Data.SqlClient.SqlConnection dataConnection = new SqlConnection(); dataConnection.ConnectionString = @"Data Source=JAGMIT-PC\SQLEXPRESS;Initial Catalog=SumooHAgentDB;Integrated Security=True"; System.Data.SqlClient.SqlCommand dataCommand = new SqlCommand(); dataCommand.Connection = dataConnection; //tell the compiler and database that we're using parameters (thus the @first, @last, @nick) dataCommand.CommandText = ("Insert Policies ( PolicyName, PolicyDesc, TimeAdded,OSFlag, CreateVSSSnapshot, CreateAuditLogForRecoveries, AllowUsersToOverwriteFiles, AutoHandleEnvErrors, NotifyOnEnvErrorCount, NotifyOnFileFailure, NotifyOnFileFailureCount, NotifyOnLackOfPCContact, NotifyOnLackOfPCContactDays, NotifyOnRecoveryFailures, NotifyOnRecoveryFailureReason) values (@pn,@pd,@TimeAdded,@os,@vss,@al,@uow,@hee,@oeec,@off,@offc,@oloc,@olocd,@orf,@orfr)"); dataCommand.Parameters.AddWithValue("@pn",pn); dataCommand.Parameters.AddWithValue("@pd",pd); dataCommand.Parameters.AddWithValue("@TimeAdded",TimeAdded); dataCommand.Parameters.AddWithValue("@os",os); dataCommand.Parameters.AddWithValue("@vss",vss); dataCommand.Parameters.AddWithValue("@al",al); dataCommand.Parameters.AddWithValue("@uow",uow); dataCommand.Parameters.AddWithValue("@hee",hee); dataCommand.Parameters.AddWithValue("@oeec",oeec); dataCommand.Parameters.AddWithValue("@off",off); dataCommand.Parameters.AddWithValue("@offc",offc); dataCommand.Parameters.AddWithValue("@oloc",oloc); dataCommand.Parameters.AddWithValue("@olocd",olocd); dataCommand.Parameters.AddWithValue("@orf",orf); dataCommand.Parameters.AddWithValue("@orfr",orfr); dataConnection.Open(); dataCommand.ExecuteNonquery(); dataConnection.Close(); ArrayList jaja = (ArrayList)Session["BackupSpecList"]; for (int i = 0; i I am getting error with the label id... can some 1 help me with this..?? I am not getting the last policyID created after inserting please help... Please help
