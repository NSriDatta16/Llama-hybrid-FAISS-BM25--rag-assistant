[site]: stackoverflow
[post_id]: 3905876
[parent_id]: 3903797
[tags]: 
Thanks guys who visited this question i have solved the problem my self there is only a array of imaged required in the following code works fine $magentoProductModel = Mage::getModel('catalog/product'); $magentoProductModel->setWebsiteIds(array(Mage::app()->getStore()->getId())); $magentoProductModel->setAttributeSetId(4);//old //$magentoProductModel->setAttributeSetId(1); $magentoProductModel->setTypeId('simple'); $magentoProductModel->setName($data[name]); $magentoProductModel->setDescription($data[description]); $magentoProductModel->setPrice($data[price]); $magentoProductModel->setShortDescription($data[short_description]); $magentoProductModel->setWeight($data[weight]); $magentoProductModel->setStatus(1); $magentoProductModel->setCategoryIds(array(3)); $magentoProductModel->setTaxClassId('None'); //$magentoProductModel->setSku('rand-sku-' .rand(1,20000) ); /* upload product image*/ $customerProductId=34; $mediDir = Mage::getBaseDir('media'); $imagesdir = $mediDir . '/customersproducts/' . $customerProductId . '/'; if(!file_exists($imagesdir)){ return false; } foreach (new DirectoryIterator($imagesdir) as $fileInfo) { //print_r($fileInfo); if($fileInfo->isDot() || $fileInfo->isDir()) continue; $visibility = array ( 'thumbnail', 'small_image', 'image' ); if($fileInfo->isFile()) { $fileInfo->getPathname(); $magentoProductModel->addImageToMediaGallery($fileInfo->getPathname(), $visibility, false, false); } //else //{ //echo "no"; //} } /*upload script end */ $saved = $magentoProductModel->save(); $lastId = $saved->getId(); $customerProduct = Mage::getModel('customerpartner/customerpartner_product')->load($lastId); $customerProduct->setProductId($lastId); $logged_in_user=Mage::getSingleton('customer/session')->getCustomer()->getId(); $customerProduct->setCustomerId($logged_in_user); $customerProduct->setCustomerId(); $customerProduct->save(); } catch(Exception $e){ echo $e; Mage::getSingleton('adminhtml/session')->addError($e->getMessage()); $this->_redirectReferer(); }
