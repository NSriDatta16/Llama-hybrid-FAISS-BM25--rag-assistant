[site]: crossvalidated
[post_id]: 592745
[parent_id]: 
[tags]: 
why is VQ-VAE considered a variational encoder?

I'm reading about VQ-VAE and I'm not sure why do they say we can view it as a VAE . Can you explicitly show: what is the latent z-space - is it the discrete space where z can take the integers 1..K where K is the number of embedding vectors? what is the true posterior p(z|x)? is it indeed intractable to use for calculating the marginal p(x), if we are dealing just in a scalar that can hold integers 1..K where K is a moderate 128? why do we need to sample from z's distribution in VAE while in VQ-VAE we just take a deterministic distribution and just use the closest embedding to the encoder output? can you show the ELBO formulation, and show how it boils down to only $log p(x|z_q(x))$ ?
