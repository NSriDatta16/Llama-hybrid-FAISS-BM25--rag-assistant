[site]: stackoverflow
[post_id]: 2727822
[parent_id]: 2723458
[tags]: 
Private Sub UpdateAmount(ByVal Acc_No As Integer, ByVal Amt As Double, ByVal Acc_Type As String) 'Retrieve columns from accounts table Dim cnntStr As String = "Data Source=DUC-91D85F3F8C2\SQLEXPRESS;Initial Catalog=BasicAccounting;Integrated Security=True" Dim cn As New SqlConnection(cnntStr) cn.Open() Dim da As SqlDataAdapter Dim ds As New Data.DataSet Dim stmt As String = "SELECT Amount, Acc_Type FROM ACCOUNTS WHERE Acc_No = " & Acc_No da = New SqlDataAdapter(stmt, cn) da.Fill(ds, "ACCOUNTS") 'To modify the amount Dim type As String type = ds.Tables(0).Rows(0).Item("Acc_Type") Dim amount As Decimal amount = ds.Tables(0).Rows(0).Item("Amount") If type = Acc_Type Then amount = amount + Amt ElseIf type <> Acc_Type Then amount = amount - Amt End If 'To update the amount stmt = "UPDATE ACCOUNTS SET Amount = " & amount & " WHERE Acc_No = " & Acc_No da = New SqlDataAdapter(stmt, cn) da.Fill(ds, "ACCOUNTS") da.Update(ds, "ACCOUNTS") End Sub
