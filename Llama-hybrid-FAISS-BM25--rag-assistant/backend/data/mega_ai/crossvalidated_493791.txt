[site]: crossvalidated
[post_id]: 493791
[parent_id]: 
[tags]: 
How to Generalize functional Autoregressive model

I am working with the multivariate hourly electricity price data, data consist of six years hourly electricity data in which the first five years are use as testing set and the last year as validation set. I want to forecast the last year through functional autoregressive model of model more than one, check the accuracy of the model. As per my knowledge or if I wrong then please correct me that their no statistical package available in R. for functional autoregressive model of order more than one. So, I trickle my problem as i transform the multivariate data into functional data through Fourier basis function, then i calculate the functional principle components as dimensional reduction, choosing the first six functional principle components explaining a given a mount of variation. then taking the corresponding functional principle scores and apply vector autoregressive model order more than one, choosing the dimensional and the order through functional final prediction error, the forecast function is used to forecast the next day price, Know as i choose the first functional principle components so i obtained the six forecast values is their is any way that how to obtained these 24 forecasted values of a single day and then transform the vector autoregressive into functional form KL transform, how i check the accuracy of the model or if wrong then please suggest me how to trickle my problem. i sharing my code to understand my problem easily. #where the mat is matrix of order 24*1461 fdata $coef) D = nrow(fdata1$ coef) #center the data mu = mean.fd(fdata1) data = center.fd(fdata1) ffpe = fFPE(fdata1, Pmax=10) d.hat = ffpe[1] #order of the model p.hat = ffpe[2] #lag of the model #fPCA fpca = pca.fd(data,nharm=D) scores = fpca $scores[,1:d.hat] # to avoid warnings from vars predict function below colnames(scores) fcst } prediction.ffpe = function(fdata1){ n = ncol(fdata1 $coef) D = nrow(fdata1$ coef) #center the data mu = mean.fd(fdata1) data = center.fd(fdata1) # ffpe Criterion ffpe = fFPE(fdata1, Pmax=5) # d.hat = ffpe[1] #p.hat = ffpe[2] d.hat=6 # 6 fPCA are selected explaining the 99% amount of variation in the data fpca = pca.fd(data, nharm=6, centerfns=TRUE) scores = fpca $scores[, 1:d.hat] # we need to give colnames to the scores # to avoid warnings from vars predict function below colnames(scores) fcst yhat=c() for(i in 1:d.hat){ yhat=c(yhat,VAR.pre[[i]][1]) } FAR.pre = fpca $harmonics[1]*0 for(i in 1:d.hat){ FAR.pre = FAR.pre + yhat[i]*fpca$ harmonics[i] } # I obtained the forecast value of the first six functional principle scores, but I need the 24 hours forecast how to convert the result into 24 hours forecast value and then transform to original variables and generalize the result to one year and also check the accuracy of the model. ```
