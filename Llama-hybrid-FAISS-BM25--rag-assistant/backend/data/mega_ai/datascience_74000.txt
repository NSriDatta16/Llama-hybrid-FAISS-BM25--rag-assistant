[site]: datascience
[post_id]: 74000
[parent_id]: 
[tags]: 
How to Find the Average of the Input Vectors

I want to find the average of input vectors . I tried to use tf.math.reduce_mean, but it went error. If I have to use keras.layers.Average, I have to make a list of the hidden states. Does anyone know how to solve this? Using tf.math.reduce_mean # Input inputs = Input(shape=(max_length,), name="Input") # Embedding embed = Embedding(input_dim=n_words+1, output_dim=embedding_size, input_length=max_length, name="Embedding")(inputs) # Bi-LSTM encoder = Bidirectional(LSTM(units=hidden_state_encoder_size, return_sequences=True, dropout=dropout_rate, name="LSTM"), name="Bi-LSTM") hidden_states = encoder(embed) # Average average = tf.math.reduce_mean(hidden_states) # Outputs outputs = Dense(n_tags, activation="softmax", name="Output")(average) Error: ValueError: Input 0 is incompatible with layer Output: expected min_ndim=2, found ndim=0 Using Average layer # Input inputs = Input(shape=(max_length,), name="Input") # Embedding embed = Embedding(input_dim=n_words+1, output_dim=embedding_size, input_length=max_length, name="Embedding")(inputs) # Bi-LSTM encoder = Bidirectional(LSTM(units=hidden_state_encoder_size, return_sequences=True, dropout=dropout_rate, name="LSTM"), name="Bi-LSTM") hidden_states = encoder(embed) # Average average = Average()(hidden_states) # Outputs outputs = Dense(n_tags, activation="softmax", name="Output")(average) Error: ValueError: A merge layer should be called on a list of inputs.
