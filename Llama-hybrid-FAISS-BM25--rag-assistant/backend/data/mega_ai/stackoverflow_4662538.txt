[site]: stackoverflow
[post_id]: 4662538
[parent_id]: 
[tags]: 
How to filter duplicates within row using Distinct/group by with JOINS

For simplicity, I will give a quick example of what i am trying to achieve: Table 1 - Members ID | Name -------------------- 1 | John 2 | Mike 3 | Sam Table 1 - Member_Selections ID | planID -------------------- 1 | 1 1 | 2 1 | 1 2 | 2 2 | 3 3 | 2 3 | 1 Table 3 - Selection_Details planID | Cost -------------------- 1 | 5 2 | 10 3 | 12 When i run my query, I want to return the sum of the all member selections grouped by member. The issue I face however (e.g. table 2 data) is that some members may have duplicate information within the system by mistake. While we do our best to filter this data up front, sometimes it slips through the cracks so when I make the necessary calls to the system to pull information, I also want to filter this data. the results SHOULD show: Results Table ID | Name | Total_Cost ----------------------------- 1 | John | 15 2 | Mike | 22 3 | Sam | 15 but instead have John as $20 because he has plan ID #1 inserted twice by mistake. My query is currently: SELECT sq.ID, sq.name, SUM(sq.premium) AS total_cost FROM ( SELECT m.id, m.name, g.premium FROM members m INNER JOIN member_selections s USING(ID) INNER JOIN selection_details g USING(planid) ) sq group by sq.agent Adding DISTINCT s.planID filters the results incorrectly as it will only show a single PlanID 1 sold (even though members 1 and 3 bought it). Any help is appreciated. EDIT There is also another table I forgot to mention which is the agent table (the agent who sold the plans to members). the final group by statement groups ALL items sold by the agent ID (which turns the final results into a single row).
