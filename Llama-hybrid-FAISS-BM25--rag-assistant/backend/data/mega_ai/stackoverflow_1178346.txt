[site]: stackoverflow
[post_id]: 1178346
[parent_id]: 1178267
[tags]: 
You are trying to combine two queries into one and trying to get the data from three rows of data from two tables. Both need to be fixed. First of all, you should not attempt to mix aggregate data (such as averages) with the details for single items - you need separate queries for that. You can do it, but the output is repetitious and therefore wasteful (all the single items in a group will have the same aggregate data). Secondly, you need to find the first message and the last message for a given ticket. Hence, that query is: SELECT t.id, t.subject, tm1.creation_date as start, tm2.creation_date as end, tm2.creation_date - tm1.creation_date as close_interval FROM tickets AS t INNER JOIN ticket_messages AS tm1 ON t.last_message = tm1.id INNER JOIN ticket_messages AS tm2 ON t.last_message = tm2.id WHERE t.closed = true This gives you three rows of data per result row - as required. The computed value should be an interval type - assuming that PostgreSQL actually has that type. (In Informix, the type would effectively be INTERVAL DAY(n) for a suitable n, such as 9.) You can average those intervals, now. You can't average dates because dates cannot be added together and cannot be divided; averaging involves both summing and dividing. Intervals can be added and divided.
