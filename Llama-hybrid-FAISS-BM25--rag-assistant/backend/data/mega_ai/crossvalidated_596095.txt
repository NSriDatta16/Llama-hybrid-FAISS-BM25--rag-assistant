[site]: crossvalidated
[post_id]: 596095
[parent_id]: 596035
[tags]: 
My guess is that this is a combination of factors. at() vs. datagrid() vs. datagridcf() In Stata , the at() syntax duplicates the whole dataset for each value supplied in parentheses, computes contrasts for every rows, and then takes the average estimate. In marginaleffects() , calling datagrid(yearsdg = 10) sets yearsd to 10 and every other regressor to their means. So we only compute a contrast for one row of data. We can mimic the Stata process by using datagridcf() instead of datagrid() (where “cf” stands for “counterfactual”). See here for a detailed comparison of Stata and marginaleffects : https://vincentarelbundock.github.io/marginaleffects/articles/alternative_software.html#stata Average contrasts As noted above, the datagridcf() will produce one estimate of the contrast per row of the dataset. Stata ’s margins command computes those unit-level estimates, but then takes their average. To do this in marginaleffects , we can use the tidy() or summary() functions, or the by argument. Degrees of freedom By default, marginaleffects uses the normal distribution to build set critical values for the confidence intervals. Using the very latest development version from Github, you can now set a df argument. I can’t recommend this experimental argument now because its behavior might change before the next release, but I use it here because it helps us bring our results closer to Stata . Transcription? Are you sure that you transcribed those confidence intervals correctly in the question? It looks like marginaleffects produces very similar digits, but the lower bound is off by 10x. library(tidyverse) library(marginaleffects) library(haven) faculty mutate(marketc = market - mean(market)) mod summary() Term Contrast Effect Std. Error z value Pr(>|z|) 2.5 % 97.5 % 1 male 1 - 0 1678 792.9 2.117 0.034299 124.1 3232 Model type: lm Prediction type: response
