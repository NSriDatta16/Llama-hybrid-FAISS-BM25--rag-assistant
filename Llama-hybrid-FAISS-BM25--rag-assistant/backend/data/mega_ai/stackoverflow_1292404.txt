[site]: stackoverflow
[post_id]: 1292404
[parent_id]: 1260833
[tags]: 
I have similar (not equals) problem. I've solved it with this piece of code: using( SPSite site = ConnectToSharepointAsSystem() ) { // now should be all ok } // somewhere in helper class -> public static SPUserToken GetSystemToken(SPSite site) { SPUserToken token = null; bool tempCADE = site.CatchAccessDeniedException; try { site.CatchAccessDeniedException = false; token = site.SystemAccount.UserToken; } catch (UnauthorizedAccessException) { SPSecurity.RunWithElevatedPrivileges(() => { using (SPSite elevSite = new SPSite(site.ID)) token = elevSite.SystemAccount.UserToken; }); } finally { site.CatchAccessDeniedException = tempCADE; } return token; } public static Microsoft.SharePoint.SPSite ConnectToSharepoint() { string urlSharepointSite; var ret = ConnectToSharepoint(out urlSharepointSite); return ret; } public static Microsoft.SharePoint.SPSite ConnectToSharepoint(out string urlSharepointSite) { urlSharepointSite = "http://www.domain.org"; var site = new Microsoft.SharePoint.SPSite( urlSharepointSite ); return site; } public static Microsoft.SharePoint.SPSite ConnectToSharepointAsSystem() { string urlSharepointSite; Microsoft.SharePoint.SPUserToken userToken = null; using (var tmpSite = CSharepointNastroje.PripojitNaSharepoint( out urlSharepointSite )) { userToken = GetSystemToken(tmpSite); } var site = new Microsoft.SharePoint.SPSite(urlSharepointSite, userToken); return site; }
