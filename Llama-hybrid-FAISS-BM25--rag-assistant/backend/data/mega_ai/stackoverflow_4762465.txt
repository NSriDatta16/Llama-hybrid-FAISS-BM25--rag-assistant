[site]: stackoverflow
[post_id]: 4762465
[parent_id]: 4760623
[tags]: 
Here it is, in all of its glory. #!/usr/bin/env python import base64 import zlib import cgi import urlparse def getValue(raw): args = urlparse.parse_qs(urlparse.urlparse(raw).query) keys = ['SAMLResponse', 'SAMLRequest', 'LogoutRequest', 'LogoutResponse'] for key in keys: if key in args: return args[key][0] def decode(raw): message = getValue(raw) message = message + "=" * (4 - len(message) % 4) base64decoded = base64.b64decode(message) try: base64decoded = zlib.decompressobj().decompress('x\x9c' + base64decoded) except zlib.error: pass # may want to handle this error return cgi.escape(base64decoded, True) data = 'PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIElEPSJwZnhkYTAxMjkzOC03MDkxLWNjZjQtZTc2Ny0wZWQ4OGVhN2Q1YmYiIFZlcnNpb249IjIuMCIgSXNzdWVJbnN0YW50PSIyMDExLTAxLTIxVDEyOjI4OjI5WiIgRGVzdGluYXRpb249Imh0dHBzOi8vd2F5Zi5teWRvbWFpbi5kay9zaW1wbGVzYW1sL3NhbWwyLW15bG9naW4ucGhwIiBJblJlc3BvbnNlVG89Il82ZDhmNDAxZDUzYTg1NDkzMzY2N2FiNWU5NzE1NWNmMzJjYWExMjBkZDciPjxzYW1sOklzc3Vlcj5odHRwczovL3Rlc3RicmlkZ2Uud2F5Zi5kazwvc2FtbDpJc3N1ZXI' url = "http://www.google.com?SAMLResponse=" + data print decode(url) The reason you were getting an error when trying to b64decode your string, is because the string is not a TRUE base64 encoding. base64 encoded data is always a length that is evenly divisible by 4. Your string is not. In order to make the string length evenly divisible by 4, '=' characters are appended to the end of the string. In your case, the length % 4 == 3. So, we need to add one '=' to the end of the string to get it to decode correctly.
