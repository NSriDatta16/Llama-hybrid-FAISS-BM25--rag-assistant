[site]: stackoverflow
[post_id]: 1600181
[parent_id]: 1600012
[tags]: 
How is your shuffle-routine implemented? Especially the exchange-routine? If you have written your own, along these lines: vTempSrting := vStringList[I]; vStringList.Delete(I); vStringList.Insert(J,vTempString); it will be very slow. Use the exchange-method on the stringlist. This code took 78 ms on my pretty average (3 year old) computer: program Project1; {$APPTYPE CONSOLE} uses SysUtils,Classes,uIntegerList,Windows,Math; procedure Shuffle(aSL : TStringList); var I,J : integer; begin for I := 0 to aSL.Count-1 do begin J := randomrange(I,aSL.Count); aSL.Exchange(I,J); end; end; procedure CreateTestFile; var vSL : TStringList; I : integer; begin vSL := TStringList.Create; try for I := 1 to 100000 do vSL.Add('Sample text #'+inttostr(I)); vSL.SaveToFile('c:\test.txt'); finally vSL.Free; end; end; function TestShuffle : longword; var vSL : TStringList; vTick0 : longword; begin vSL := TStringList.Create; try vTick0 := gettickcount; vSL.LoadFromFile('c:\test.txt'); Shuffle(vSL); vSL.SaveToFile('c:\test.txt'); Result := gettickcount - vTick0; finally vSL.Free; end; end; begin CreateTestFile; writeln(TestShuffle,' ms'); readln; end.
