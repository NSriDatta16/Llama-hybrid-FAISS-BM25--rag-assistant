[site]: stackoverflow
[post_id]: 4348129
[parent_id]: 4345643
[tags]: 
I'm going to take a stab at psychic debugging here; You say it "doesn't work any more" implying that it worked at some point. While you haven't mentioned which OS you're using, I'm also going to divine that you're using Windows Vista or Windows 7 (or a correlating Server version). What I suspect is happening is that your application is running as a different user or privilege level than the shell. Windows doesn't allow drag (especially file drag) data to go from an application at one privilege level to another. If you're running this from the IDE, and the IDE is running as Administrator, then the spawned processes are also running at that level. Check to make sure your application is actually running as the logged in user. I've been bitten by this too many times to count and is so subtle that it is never immediately obvious as to what is going on.
