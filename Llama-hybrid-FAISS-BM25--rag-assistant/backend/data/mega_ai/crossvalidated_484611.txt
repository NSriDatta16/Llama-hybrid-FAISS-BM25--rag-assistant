[site]: crossvalidated
[post_id]: 484611
[parent_id]: 484596
[tags]: 
To add to @ChristophHanck's comment, you can check the source code for bptest and in it you see that a formula and a data frame can be applied: bptest(mpg~disp+hp, data=mtcars) studentized Breusch-Pagan test data: mpg ~ disp + hp BP = 4.0861, df = 2, p-value = 0.1296 Underneath the code, there's two parts. If you provide a lm object, it will extract the x and y, refit the formula using lm.fit. After which, it extracts the residuals from the lm.fit object and calculates the relevant statistics. These are the relevant lines: resi $fitted.values^2)/sum(w^2) method fitted.values^2) method
