[site]: stackoverflow
[post_id]: 4914068
[parent_id]: 
[tags]: 
How to achieve smooth animated effect when dragging an object in WPF

I am trying to learn some WPF and I was hoping to be able to implement a simple game. In this game, there are a few items on a Canvas . For the purpose of this question, let’s say there’s just one, and it’s an Ellipse : The user needs to be able to drag these items around arbitrarily. So I implemented the following code and it seems to work: public MainWindow() { InitializeComponent(); Canvas.SetLeft(ellipse, 0); Canvas.SetTop(ellipse, 0); ellipse.MouseDown += new MouseButtonEventHandler(ellipse_MouseDown); ellipse.MouseMove += new MouseEventHandler(ellipse_MouseMove); ellipse.MouseUp += new MouseButtonEventHandler(ellipse_MouseUp); } void ellipse_MouseDown(object sender, MouseButtonEventArgs e) { if (e.LeftButton != MouseButtonState.Pressed) return; ellipse.CaptureMouse(); ellipse.RenderTransform = new ScaleTransform(1.25, 1.25, ellipse.Width / 2, ellipse.Height / 2); ellipse.Opacity = 0.75; } void ellipse_MouseMove(object sender, MouseEventArgs e) { if (e.LeftButton != MouseButtonState.Pressed || !ellipse.IsMouseCaptured) return; var pos = e.GetPosition(canvas); Canvas.SetLeft(ellipse, pos.X - ellipse.Width * 0.5); Canvas.SetTop(ellipse, pos.Y - ellipse.Height * 0.5); } void ellipse_MouseUp(object sender, MouseButtonEventArgs e) { if (!ellipse.IsMouseCaptured) return; ellipse.ReleaseMouseCapture(); ellipse.RenderTransform = null; ellipse.Opacity = 1; } Now, if you try this, you’ll see that the movements are very jagged. When you mouse down, the ellipse grows instantly and changes its transparency instantly. I want to smoothen this out so that there are no sudden jumps. I’ve tried the obvious things using a DoubleAnimation on Ellipse.OpacityProperty , ScaleTransform.ScaleXProperty and (notably) Canvas.LeftProperty/TopProperty . However, I run into the following problems: As soon as I begin an animation on Canvas.LeftProperty/TopProperty , I can never use Canvas.SetLeft/Top again, so the ellipse doesn’t move when it is dragged. I couldn’t find a way to remove the animation from the object. If the user releases the mouse while the animation is still happening, the “shrinking” animation on the ScaleTransform starts from the full size before the “growing” animation has reached it, which causes a sudden jump. If you click the mouse frantically, the object’s size jumps frantically, which it shouldn’t. If you need to, you can look at my failed code, which doesn’t work . How do you implement these smooth motions properly in WPF? Please do not post an answer without trying it out first. If there are any sudden jumps, the result is unsatisfactory. Thanks!
