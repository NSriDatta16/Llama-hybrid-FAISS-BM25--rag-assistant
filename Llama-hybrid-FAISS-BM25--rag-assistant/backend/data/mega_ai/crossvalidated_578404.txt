[site]: crossvalidated
[post_id]: 578404
[parent_id]: 578291
[tags]: 
You can estimate bias as the difference between the mean or median weight measurements. Variability is more challenging as it has two components: Intra-variability quantifies the repeatability of measurements taken with the same instrument. Inter-variability quantifies the disagreement between measurements taken with two different instruments. NB Intra- and inter-measurement variability is discussed in a lot more detail in Chapter 16 of Biostatistics for Biomedical Research course notes. Available online . First let's look at the weight measurements for the 10 samples you've provided. We learn a lot from this plot. The two most interesting observations are: instrument G has almost no intra-variability and instrument P is consistently over-biased. Let's put these observations into numbers. I'll use the procedure described in BBR. The R code is attached at the end. First we consider intra-variability. The standard instrument, V, measures the weight of sample 1 as [56.3, 56, 56.2]. We pair the measurements and compute the absolute differences: |56.3 - 56| = .3, |56.3 - 56.2| = .1, |56 - 56.2| = .2. The average (.3 + .1 + .2) / 3 = .2 is a measure of variability known as Gini's mean difference. Below I've plotted the intra-instrument variability for each sample. Take the average across samples to estimate the overall intra-varibility. #> instrument intra-variability #> G 0.0133 #> P 0.293 #> V 0.280 Second we consider inter-variability. The standard instrument, V, measures the weight of sample 1 as [56.3, 56, 56.2] while the alternative instrument, P, measure its weight as [56.3, 56.1, 56.9]. We pair each V measurement with each P measurement and compute the absolute differences: 0, 0.2, 0.6, 0.3, 0.1, 0.9, 0.1, 0.1, 0.7. The average 0.33 is measure of the disagreement between V and P about the weight of sample 1. Below I've plotted the inter-instrument variability between V and either P or G, for each sample. Again, take the average across samples to estimate the overall inter-variability. #> instrument1 instrument2 inter-variability #> V P 0.85 #> V G 0.883 #> P G 0.867 And finally let's estimate weight as the median measurement by an instrument. #> bias G - V P - V #> 0.39 0.830 The computations confirm and elaborate on the observations we made at the start by plotting the raw measurements: Instrument G has little intra-variability (0.013) while instruments V and P have about the same intra-variability (0.28 and 0.29 respectively). Instrument G has less bias than instrument P (0.39 and 0.83 respectively). Instrument G has slightly higher inter-disagreement with instrument V (0.88) than instrument P (0.85). On the given 10 samples, instrument P is consistently over-biased while instrument G has two "modes": it has low bias for samples 1,2,4,8,10 and high bias for samples 3,5,6,7,9. R code in all its gory details. data % group_by(...) %>% summarise( variability = sum(N * variability) / sum(N), N = sum(N) ) } Estimate % group_by( sample, instrument ) %>% summarise( measurement = median(measurement) ) %>% ungroup() %>% pivot_wider( id_cols = sample, names_from = instrument, values_from = measurement ) } IntraVariability % group_by( sample, instrument ) %>% summarise( N = choose(n(), 2), variability = GiniSd(measurement) / N ) %>% ungroup() %>% drop_na() list( intra_var = intra_var, by_sample = Aggregate(intra_var, sample), by_instrument = Aggregate(intra_var, instrument) ) } InterVariability % chop(measurement) inter_var % rename(instrument1 = instrument, x = measurement), nested %>% rename(instrument2 = instrument, y = measurement), by = "sample" ) %>% filter( instrument1 > instrument2 ) %>% rowwise() %>% mutate( N = length(x) * length(y), variability = GiniSd(x, y) / N ) %>% select( -c(x, y) ) %>% drop_na() list( inter_var = inter_var, by_sample = Aggregate(inter_var, sample), by_instrument_pairs = Aggregate(inter_var, instrument1, instrument2) ) } plot_measurements % arrange( sample, instrument, {{ measurement }} ) %>% mutate( id = cumsum(sample != lag(sample, default = "")) ) %>% group_by( sample, instrument ) %>% mutate( h = cumsum({{ measurement }} == lag({{ measurement }}, default = 0)), y = id + 0.1 * h ) %>% ggplot( aes({{ measurement }}, y, shape = instrument, color = instrument ) ) + geom_hline( aes(yintercept = y), linetype = 3, color = "gray", size = 0.5, data = tibble(y = seq(1, 10, 1)) ) + geom_point( stroke = 1, size = 2 ) + scale_shape_manual( values = c(0, 1, 2) ) + theme( axis.title = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank(), ) } measurements % unite( "sample", c(Trial, Year, Plot) ) %>% pivot_longer( -sample, names_to = "instrument", names_transform = list(instrument = ~ str_sub(., 1, 1)) ) estimates $sample, measurements$ instrument, measurements$value ) estimates %>% summarise( `G - V` = mean(G - V), `P - V` = mean(P - V) ) intra_var $sample, measurements$ instrument, measurements $value ) intra_var$ by_instrument inter_var $sample, measurements$ instrument, measurements $value ) inter_var$ by_instrument_pairs # Make scatterplots p % pivot_longer(c(G, P, V), names_to = "instrument", values_to = "estimate"), estimate ) p + ggtitle("Estimated weight") p % filter(instrument1 == "V") %>% rename(instrument = instrument2), variability ) p + ggtitle("Inter variability (V - ?)")
