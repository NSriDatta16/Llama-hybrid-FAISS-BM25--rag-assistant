[site]: crossvalidated
[post_id]: 365597
[parent_id]: 32238
[tags]: 
A bit late to the party, as usual, but I see some recentish activity so I'll my two yen. First, I can't fault the OPs attempt - it looks right to me. The discrepancies could be due to issues with finite samples, for example positive bias of signal power estimation. However, I think that there are simpler ways to generate time series from the cross spectral density matrix (CPSD, this is what the OP called covariance matrix). One parametric approach is to use the CPSD to obtain an autoregressive description and then use that to generate the time series. In matlab you can do this using the Granger causality tools (e.g. Multivaraite Granger causality toolbox, Seth, Barnett ). The toolbox is very easy to use. Since the existence of the CPSD guarantees an autoregressive description this approach is exact. (for more info about the CPSD and autoregression see "Measurement of Linear Dependence and Feedback between Multiple Time Series" by Geweke, 1982, or many of the Aneil Seth + Lionel Barnett papers, to get the full picture). Potentially simpler, is noting the the CPSD can be formed by applying the fft to the auto covariance (giving the diagonal of CPSD, i.e. the signals' power) and the cross covariance (giving the off diagonal elements, i.e. the cross-power). Thus by applying the inverse fft to the CPSD we can get the autocorrelation and auto covariance. We can then use these to generate samples of our data. Hope this helps. Please leave any requests for info in the comments and I'll try to address.
