[site]: stackoverflow
[post_id]: 4479552
[parent_id]: 4479065
[tags]: 
Apache server is setup such that requests for example.com shows up as www.example.com in the client browser address bar if that is related to the issue ? I am not 100% sure, but this looks like the root of the problem. How does Apache make the client browser to display www.example.com instead of example.com? Most probably, by redirecting each request for example.com to www.example.com. When the browser processes redirection, it sends a request for www.example.com and from that point on thinks that it is working with www.example.com. Now, what happens when there is a Set-Cookie in the response header? It will obviously treat it as coming from www.example.com. There is no way a browser would allow such cookie to set its domain to .example.com because it would be a security problem. Imagine that mysite.somefreehosting.com sets a cookie for the domain .somefreehosting.com. Then someothersite.somefreehosting.com would receive this cookie which may lead to a lot of trouble. The standard specifies that such cookie should be rejected, but I wouldn't be surprised if some browsers are smart enough to handle such cases and to treat .example.com as www.example.com. To be sure, I recommend that you check what exactly your site sends to the browser by sending a request with something like lwp-request script. You'll see what redirections are happening and what headers are actually set in the response, like this: alqualos@ubuntu:~$ lwp-request -sSed http://google.com/ GET http://google.com/ --> 301 Moved Permanently GET http://www.google.com/ --> 302 Found GET http://www.google.co.il/ --> 200 OK Cache-Control: private, max-age=0 Connection: close Date: Sat, 18 Dec 2010 18:54:57 GMT Server: gws Content-Type: text/html; charset=windows-1255 Content-Type: text/html; charset=windows-1255 Expires: -1 Client-Date: Sat, 18 Dec 2010 18:54:57 GMT Client-Peer: 173.194.37.104:80 Client-Response-Num: 1 Set-Cookie: PREF=ID=368e9cfd56643257:FF=0:TM=1292698497:LM=1292698497:S=s-Jur84NgaNH5Mzx; expires=Mon, 17-Dec-2012 18:54:57 GMT; path=/; domain=.google.co.il Set-Cookie: NID=42=bZ6goDV_b2MiWlTMONwiijaON5U_TBGB2_yNheonEwA1GVLU77EhyfUhk9Wvj70xTFrpvGy4s_aBp1UZtvRRnsnYjacjz_UVx0_iSr9R3nYXMyRtwkS5qV98_Egb16pZ; expires=Sun, 19-Jun-2011 18:54:57 GMT; path=/; domain=.google.co.il; HttpOnly Title: Google X-XSS-Protection: 1; mode=block
