[site]: crossvalidated
[post_id]: 632100
[parent_id]: 
[tags]: 
Is it possible to estimate effects using Bayesian modelling after matching?

I am following [Greifer 2023][1] to estimate the effect size after (genetic) matching, where I am using bootstrapping to estimate the confidence intervals. Since I have a hierarchical setup with repeat measures (harvests) from fields and fields nested within sites, a frequentist approach (using lmer) resulted in a singular variance-covariance matrix. Thus, I am exploring Bayesian options, namely the brms package. However, it does not appear possible to incorporate the matching weights when using the brm function. Is a Bayesian approach possible in this setup and if so how? Specifically, this is the code I am trying: (but it is not working: "Error in weighted.mean.default(p1, md1$weights) : 'x' and 'w' must have the same length") boot_fun
