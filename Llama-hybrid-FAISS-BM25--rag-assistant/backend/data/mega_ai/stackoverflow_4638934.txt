[site]: stackoverflow
[post_id]: 4638934
[parent_id]: 
[tags]: 
C++ Linux getpeername and getsockname return only port

In my Linux C++ application I'm using getpeername and getsockname. when IPv6 enabled on the OS, both getpeername and getsockname return only port! code: int GetSockAndPeer(int sock) { struct sockaddr_storage ss; socklen_t salen = sizeof(ss); struct sockaddr *sa; struct addrinfo hints, *paddr, *paddrp; sa = (struct sockaddr *)&ss; if (getpeername(sock, sa, &salen) != 0) { return -1; } if (getsockname(sock, sa, &salen) != 0) { return -1; } } sa variable hold after the systemcalls in sa_data only the sa_data[0] and sa_data[1] which means port. all the other bytes are 0; Any help???
