[site]: crossvalidated
[post_id]: 568524
[parent_id]: 
[tags]: 
R function to compute variance of average of correlated random variables

I want to calculate the variance of the average of n correlated variables. I found a formula for that in Borenstein et al. (2009) Introduction to Meta-Analysis . $$\operatorname{Var}\left(\frac{1}{m}\sum_{i=1}^mY_i\right)=\left(\frac{1}{m}\right)^2\operatorname{Var}\left(\sum_{i=1}^m Y_i\right) = \left(\frac{1}{m}\right)^2\left(\sum_{i=1}^m V_i + \sum_{i\ne j}r_{ij}\sqrt{V_i}\sqrt{V_j}\right).$$ I think that this the same formula as here Variance of average of $n$ correlated random variables , except it is based on correlations instead of variances. I've implemented the formula in R like this # Estimates est My questions are: Does the implementation look correct? Better yet, is there is an R library that accepts variances and correlations of estimates and returns the variance of average (or sum) of estimates?
