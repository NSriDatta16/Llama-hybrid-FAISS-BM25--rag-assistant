[site]: stackoverflow
[post_id]: 5478639
[parent_id]: 5476694
[tags]: 
Alright, well I found an answer that basically works through the lack of working and/or multiple category filtering. It's dirty, but works. It's based off a blog post from here: http://asia-connect.com.vn/2009/07/magento-filter-by-multiple-categories/ I can't say I'm happy with this solution. I can't figure out why Magento would remove the ability to do filtering on Categories in a useful manner. The fact that it didn't appear to filter anything at all just compounded my issues. Feel free to chime in with a more sensible solution. I'd gladly replace this solution with it. $products = Mage::getResourceModel('reports/product_collection') ->addOrderedQty() ->addAttributeToSelect('*') ->addAttributeToSelect(array('name','small_image')) ->setStoreId($storeId) ->addStoreFilter($storeId) // ->addCategoryFilter($category) ->addViewsCount() ->setPageSize($productCount); $alias = 'cat_index'; $categoryCondition = $products->getConnection()->quoteInto( $alias.'.product_id=e.entity_id AND '.$alias.'.store_id=? AND ', $storeId ); $cats = array( $category->getId() ); foreach($category->getChildren() as $catChild) { $cats[] = $catChild->getId(); } $categoryCondition.= $alias.'.category_id IN ('.implode(',',$cats).')'; $products->getSelect()->joinInner( array($alias => $products->getTable('catalog/category_product_index')), $categoryCondition, array('position'=>'position') ); $products->_categoryIndexJoined = true;
