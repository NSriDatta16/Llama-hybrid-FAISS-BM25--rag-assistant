[site]: stackoverflow
[post_id]: 1885521
[parent_id]: 1594524
[tags]: 
If I understand correctly, it looks like you just need to take out " - DAYOFWEEK('2009-12-10')" since DAYOFWEEK(availables.bookdate) is already returning you a number representing the day of the week. Also, DAYOFWEEK returns a number 1 through 7, not 0 through 6, so you would need to adjust accordingly. It may be more efficient to do a "GROUP BY room_id, DAYOFWEEK(availables.bookdate)" to group the average prices by room and day in an inner subquery, and then do the pivoting in an outer query.
