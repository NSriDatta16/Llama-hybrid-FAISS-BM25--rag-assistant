[site]: crossvalidated
[post_id]: 340864
[parent_id]: 
[tags]: 
"Undefined real result" with inverse() function in WinBUGS

Using WinBUGS, I'd like to generate the posterior distribution for a function of several other variables (stochastic nodes). One step in building up this function involves taking the inverse of a matrix, using the inverse() command. However, when I run the code with this line included, the model immediately generates the TRAP error "undefined real result". As this indicates likely numerical overflow , I assume that a number with a very large number of decimal places is being generated. I have therefore tried to round numbers to only a few decimal places to see if it avoids the problem, but - so far - to no avail. How can I avoid numerical overflow when taking the inverse of a matrix in WinBUGS? The model runs fine without this line. I can obtain posterior distributions for all the separate variables that comprise this function, but not the function itself. In case it is important info, here are the specific details: The value I want to estimate in WinBUGS is the expected first passage time of a Markov chain, using the so-called 'fundamental matrix' method (I am following the matrix methods in the Grinstead & Snell 2006 online textbook). To generate this matrix of interest, I subtract a 7-by-7 matrix Q of probabilities from a 7-by-7 identity matrix I , generating a new matrix called IminusQ and then take the inverse of this. The code for this step is: FundamentalMatrix[SAMPLE,1:7,1:7] The first part of the TRAP error that is generated is this: undefined real result Math.Sqrt [00000120H] .x REAL -11.23763793679807 MathMatrix.LUDecomp [00000384H] .a ARRAY 20, 20 OF REAL Elements .i INTEGER 5 .j INTEGER 5 .k INTEGER -1 .size INTEGER 7 .sum REAL -11.23763793679807 MathMatrix.Invert [000004DFH] .a ARRAY 20, 20 OF REAL Elements .i INTEGER 6415876 .j INTEGER 0 .k INTEGER 0 .size INTEGER 7 .sum REAL 0.0
