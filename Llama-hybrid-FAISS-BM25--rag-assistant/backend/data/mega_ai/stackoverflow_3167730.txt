[site]: stackoverflow
[post_id]: 3167730
[parent_id]: 3167708
[tags]: 
preg_match("#Safari(\s+|/\s*)([^)(;]+)#i", $_SERVER['HTTP_USER_AGENT'], $results); The i at the end means "case insensitive", which answers criteria one. (\s+|\s*/\s*)? matches either at least one whitespace character or a slash preceded and followed by an arbitrary number of whitespace characters (from zero to infinity and beyond), which addresses criteria two. [^)(;]+ will match as many characters as possible that are not inside the set, which addresses criteria three.
