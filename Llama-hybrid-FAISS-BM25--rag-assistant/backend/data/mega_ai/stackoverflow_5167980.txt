[site]: stackoverflow
[post_id]: 5167980
[parent_id]: 5166716
[tags]: 
This block double total = 0; for (int x = i; x > (i - period); x--) total += series.Values[x]; double average = total / period; can be rewritten as: double average = series.Values.Skip(i - period + 1).Take(period).Sum() / period; Your method may look like: series.Skip(period - 1) .Select((item, index) => new { item.Key, series.Values.Skip(index).Take(period).Sum() / period }); As you can see, linq is very expressive. I recommend to start with some tutorial like Introducing LINQ and 101 LINQ Samples .
