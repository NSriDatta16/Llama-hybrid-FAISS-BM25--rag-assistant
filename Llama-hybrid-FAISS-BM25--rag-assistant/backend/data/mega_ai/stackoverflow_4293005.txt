[site]: stackoverflow
[post_id]: 4293005
[parent_id]: 
[tags]: 
Apache mod_mem_cache vary-deflate buq FIx but need rewrite rule advice

IF query string ?g and type css or js - gzip-deflate disabled RewriteCond %{REQUEST_URI} \.(css|js)$ RewriteCond %{REQUEST_METHOD} GET RewriteCond %{QUERY_STRING} ^g$ RewriteRule ^(.*)$ $1 [QSA,E=no-gzip:1,PT,L] If no gzip suport by user agent redirecto to file witch query string ?g eq. style.css?g RewriteCond %{REQUEST_URI} .(css|js)$ RewriteCond %{REQUEST_METHOD} GET RewriteCond %{HTTP:Accept-Encoding} !^gzip\,deflate$ RewriteCond %{QUERY_STRING} !^g$ RewriteRule "^([a-zA-Z0-9_-]*)\.(css|js)$" $1.$2?g [R=301] My problem is that for 301 need to rel path but go to default dir http:// localhost/style/style.js -> http://d:\some\path/style.js?g http:// localhost/js/e.js -> http://d:\some\path/e.js?g To fix that i think need to know real path eq RewriteRule "^([a-zA-Z0-9_-]*)\.(css|js)$" http://%{HOST}/%{PATH}/$1.$2?g [R=301] But i dont know how do name this
