[site]: crossvalidated
[post_id]: 612413
[parent_id]: 612389
[tags]: 
There are two problems with your approach. One is a simple oversight in the way that you set up your example. The second is fundamental, in that your approach doesn't provide a true marginal estimate over the population of interest. First, the parametric survival estimate needs to include all predictor variables that contribute to the linear predictor. The distribution of survival times $T$ in an exponential model conditional on a vector $X$ of covariate values can be written as: $$\log T \sim X'\beta +W $$ where $\beta$ is the corresponding vector of coefficients and $W$ has a standard minimum extreme value distribution. In your construction of the baseline hazard you omitted entries for age or sex , effectively setting age to 0 and sex to the reference level of m . That's certainly not a "marginal" survival estimate. If you plot your "baseline" survival against the corresponding raw data, you will see that your "baseline" survival estimates are much too high, probably because of effectively setting age=0 . Second, you might think that you can get around that problem by specifying values for age and sex . But which to choose? The pbc data set illustrates the problem nicely: with(pbc,coef(lm(age~sex))) # (Intercept) sexf # 55.710721 -5.553778 The average age for females is over 5 years less than that for males. What single combination of age and sex could possibly be used to get anything like a marginal survival estimate this way? Would you use the average sex representation of 0.89 of a female in the pbc data set? Furthermore, the survival of an "average" individual, even if you could define such an individual, can be far from the true marginal survival, an average of survival versus time over the population of interest. For example, based on your model you can determine $S_i(t)$ for an appropriate set of $N$ individuals $i$ representing the population, and calculate the Ederer estimate: $$S_e(t)=\frac{1}{N}\sum_{i=1}^N S_i(t) .$$ There's a survexp() function in the R survival package to do that, or to provide other estimates of cohort survival. Each of those has potential problems, however, discussed in detail in Chapter 10 of Therneau and Grambsch . In particular, after decades of effort, the authors of the package still don't have a reliable way to calculate standard errors for these estimates. However you end up trying to get marginal survival estimates, be very careful in how you interpret them. Finally, consider whether marginal estimates are needed at all. As this post by Frank Harrell documents, they are highly problematic in binomial or survival regression models and depend on the composition of the population used to build the model. Such marginal estimates might not carry over well to a different population. Furthermore, a treatment decision in clinical practice should always be conditional upon a particular patient's situation, not some estimated population-average treatment effect. Illustrating survival curves conditional upon particular typical covariate values and treatment choices is a more useful way to document a model's results, unless a treatment is being applied to an entire population (as in the water-fluoridation example noted in that post).
