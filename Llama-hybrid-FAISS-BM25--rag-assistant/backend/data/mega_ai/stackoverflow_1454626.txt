[site]: stackoverflow
[post_id]: 1454626
[parent_id]: 
[tags]: 
Where should I place code which generates Excel spreadsheet?

I am using spreadsheet gem to generate native Excel file. This is not CSV, XML file. Ordinary Ruby code is used to create the file. The generated Excel file (kept in StringIO ) is forwarded to a client using send_data method. I need send_data method because of its parameters like disposition . The data for the Excel is retrieved in controller method just like for ordinary HTML, JS requests. However I placed the code to generate the spreadsheet in controller protected method. Not in a view as I should. Is there an elegant solution to above problem compliant with MVC design pattern? Update: There is no popular and accepted by all solution to above problem but at least I know all possible ideas.
