[site]: stackoverflow
[post_id]: 3675387
[parent_id]: 3675148
[tags]: 
I guess the problem is the integer division (if row consists of integers only) average_row=sum(row)/len(row) which will give you an average of 0 if the length of the row is greater than the sum. Try average_row=sum(row)/float(len(row)) instead.
