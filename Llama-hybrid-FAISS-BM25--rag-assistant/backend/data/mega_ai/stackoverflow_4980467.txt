[site]: stackoverflow
[post_id]: 4980467
[parent_id]: 
[tags]: 
EXPORT Dataset to EXCEL

I am using the following code to export fields from a database table into excel. What I want to do is be able to write a SQL statement to retrieve fields from multiple tables and export them into excel. This code only allows me to export one table. Also, how can I display a save prompt dialog? Sample code would be appreciated - many thanks! protected void export_Click(object sender, EventArgs e) { string sql = null; string data = null; string path = save_as.Text; int i = 0; int j = 0; Excel.Application xlApp; Excel.Workbook xlWorkBook; Excel.Worksheet xlWorkSheet; object misValue = System.Reflection.Missing.Value; xlApp = new Excel.ApplicationClass(); xlWorkBook = xlApp.Workbooks.Add(misValue); xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1); //connectionString = "data source=servername;initial catalog=databasename;user id=username;password=password;"; SqlConnection cnn = new SqlConnection(GetConnectionString()); cnn.Open(); sql = "SELECT Story, CreationDate FROM Story"; SqlDataAdapter dscmd = new SqlDataAdapter(sql, cnn); DataSet ds = new DataSet(); dscmd.Fill(ds); for (i = 0; i
