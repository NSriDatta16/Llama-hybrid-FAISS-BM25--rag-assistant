[site]: stackoverflow
[post_id]: 4521498
[parent_id]: 
[tags]: 
Dragstart and textarea: how to catch that user started dragging some selected text?

I need a way to detect text dragging start from textarea to be able to replace event.dataTransfer contents on certain condition. The obvious solution is to add "dragstart" handler on textarea and it perfectly works in IE. But not in other browsers - I tested FF, Chrome, Opera, Safari - all of them ignore dragstart on textarea or input[type=text] while perfectly calling it on div or p. I've also tried to add attribute draggable="true" to textarea - it didn't help as well (and even made text non-selectable in Chrome). Please note that emulating drag&drop isn't a case - drop may be in another window and event.dataTransfer has to hold a link in certain case (while initially selected source text isn't a link at all). Below is the big HTML example adapted from another non-textarea related one (http://help.dottoro.com/external/examples/ljpncnwi/ondragstart_2.htm) ondragstart event example function Init () { var source = document.getElementById ("source"); var target = document.getElementById ("target"); if (source.addEventListener) { // Firefox, Opera, Google Chrome and Safari source.childNodes[0].addEventListener("dragstart", DumpInfo, false); source.parentNode.addEventListener("dragstart", DumpInfo, false); source.addEventListener ("dragstart", DumpInfo, false); // Google Chrome, Safari, Firefox from version 3.5 source.addEventListener ("draggesture", DumpInfo, false); // Firefox earlier than version 3.5 source.addEventListener ("drag", DumpInfo, false); // Firefox, Google Chrome, Safari source.addEventListener ("dragend", DumpInfo, false); // Firefox, Google Chrome, Safari target.addEventListener ("dragenter", DumpInfo, false); // Firefox, Google Chrome, Safari target.addEventListener ("dragover", DumpInfo, false); // Firefox, Google Chrome, Safari target.addEventListener ("dragleave", DumpInfo, false); // Google Chrome, Safari, Firefox from version 3.5 target.addEventListener ("dragexit", DumpInfo, false); // Firefox target.addEventListener ("drop", DumpInfo, false); // Google Chrome, Safari, Firefox from version 3.5 target.addEventListener ("dragdrop", DumpInfo, false); // Firefox earlier than version 3.5 } else { source.attachEvent ("ondragstart", DumpInfo); source.attachEvent ("ondrag", DumpInfo); source.attachEvent ("ondragend", DumpInfo); target.attachEvent ("ondragenter", DumpInfo); target.attachEvent ("ondragover", DumpInfo); target.attachEvent ("ondragleave", DumpInfo); target.attachEvent ("ondrop", DumpInfo); } } function DumpInfo (event) { if (event === undefined) { event = window.event; } var firedOn = event.target ? event.target : event.srcElement; if (firedOn.tagName === undefined) { firedOn = firedOn.parentNode; } var info = document.getElementById ("info"); if (firedOn.id == "source") { info.innerHTML += " " + event.type + " , "; } else { info.innerHTML += " " + event.type + " , "; } if (event.type == "dragover") { // the dragover event needs to be canceled in Google Chrome and Safari to allow firing the drop event if (event.preventDefault) { event.preventDefault (); } } } ondragstart event example blabla Select and drag some text from this field and drop it into the target. This is the target element. &copy; 2009 Dottoro.com. All rights reserved. Terms of use.
