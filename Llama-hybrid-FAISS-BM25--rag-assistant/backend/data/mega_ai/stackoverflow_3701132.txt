[site]: stackoverflow
[post_id]: 3701132
[parent_id]: 
[tags]: 
SQL sorting , paging, filtering best practices in ASP.NET

I am wondering how Google does it. I have a lot of slow queries when it comes to page count and total number of results. Google returns a count value of 250,000,00 in a fraction of a second. I am dealing with grid views. I have built a custom pager for a gridview that requires an SQL query to return a page count based on the filters set by the user. The filters are at least 5 which includes a keyword, a category and subcategory, a date range filter, and a sort expression filter for sorting. The query contains about 10 massive table left joins. This query is executed every time a search is performed and a query execution last an average of 30 seconds - be it count or a select. I believe what's making it slow is my query string of inclusive and exclusive date range filters. I have replaced ( =) to BETWEEN and AND but still I experience the same problem. See the query here: http://friendpaste.com/4G2uZexRfhd3sSVROqjZEc I have problems with a long date range parameter. Check my table that contains the dates: http://friendpaste.com/1HrC0L62hFR4DghE6ypIRp UPDATE [9/17/2010] I minimized my date query and removed the time. I tried reducing the joins for my count query (I am actually having a problem with my filter count which takes to long to return a result of 60k rows). SELECT COUNT(DISTINCT esched.course_id) FROM courses c LEFT JOIN events_schedule esched ON c.course_id = esched.course_id LEFT JOIN course_categories cc ON cc.course_id = c.course_id LEFT JOIN categories cat ON cat.category_id = cc.category_id WHERE 1 = 1 AND c.course_type = 1 AND active = 1 AND c.country_id = 52 AND c.course_title LIKE '%cook%' AND cat.main_category_id = 40 AND cat.category_id = 360 AND ( (2010-09-01' = esched.date_start OR '2010-09-25' >= esched.date_end) ) I just noticed that my query is quite fast when I have a filter on my main or sub category fields. However when I only have a date filter and the range is a month or a week it needs to count a lot of rows and is done in 30seconds in average. These are the static fields: AND c.course_type = 1 AND active = 1 AND c.country_id = 52 UPDATE [9/17/2010] If a create a hash for these three fields and store it on one field will it do a change in speed? These are my dynamic fields: AND c.course_title LIKE '%cook%' AND cat.main_category_id = 40 AND cat.category_id = 360 // ?DateStart and ?DateEnd UPDATE [9/17/2010]. Now my problem is the leading % in LIKE query Will post an updated explain
