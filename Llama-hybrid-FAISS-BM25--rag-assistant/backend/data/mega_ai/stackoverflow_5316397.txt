[site]: stackoverflow
[post_id]: 5316397
[parent_id]: 5305020
[tags]: 
Source Here is some code to pass parameters from PHP to JasperReports automatically, based on a naming convention for user input fields. $value ) { if( strpos( $name, 'report_' ) === 0 ) { $length = strlen( 'report_' ); if( strpos( $name, 'report_int_' ) === 0 ) { $value = intval( $value ); $length = strlen( 'report_int_' ); $value = convertValue( $value, 'java.lang.Integer' ); $params->put( substr( $name, $length ), $value ); } else if( strpos( $name, 'report_arr_' ) === 0 ) { $length = strlen( 'report_arr_' ); $arrays = array_filter( explode( ',', $_POST[ $name ] ) ); # Map the values of the array form parameter to a java.util.ArrayList. $arrayList = new java( 'java.util.ArrayList' ); foreach( $arrays as $value ) { $arrayList->add( $value ); } # Pass values into the report (without the "report_arr_" prefix). $params->put( substr( $name, $length ), $arrayList ); } else { $params->put( substr( $name, $length ), $value ); } } } return $params; } function report_execute( $filename = 'FILENAME' ) { global $dbhost; global $dbname; global $dbuser; global $dbpass; $conn = null; $report = realpath( '/PATH/TO/REPORT.jasper' ); try { $params = report_parse_post_parameters(); # Load the PostgreSQL database driver. java( 'java.lang.Class' )->forName( 'org.postgresql.Driver' ); # Attempt a database connection. $conn = java( 'java.sql.DriverManager' )->getConnection( "jdbc:postgresql://$dbhost/$dbname?user=$dbuser&password=$dbpass" ); # Use the fill manager to produce the report. $fm = java('net.sf.jasperreports.engine.JasperFillManager'); $pm = $fm->fillReport($report, $params, $conn); header('Cache-Control: private'); header('Content-Description: File Transfer'); header("Content-Disposition: attachment, filename=$filename.pdf"); header('Content-Type: application/pdf'); header('Content-Transfer-Encoding: binary'); java_set_file_encoding('ISO-8859-1'); $em = java('net.sf.jasperreports.engine.JasperExportManager'); $result = $em->exportReportToPdf($pm); $conn->close(); header('Content-Length: ' . strlen( $result ) ); echo $result; } catch( Exception $ex ) { if( $conn != null ) { $conn->close(); } throw $ex; } } ?> Usage Change this line: function report_execute( $filename = 'FILENAME' ) { Change this line: $report = realpath( '/PATH/TO/REPORT.jasper' ); Change these lines to match your database software: java( 'java.lang.Class' )->forName( 'org.postgresql.Driver' ); $conn = java( 'java.sql.DriverManager' )->getConnection( "jdbc:postgresql://$dbhost/$dbname?user=$dbuser&password=$dbpass" ); Edit db-account.php : Example Form Input Use a report_ prefix for user inputs, such as: These values are then passed automatically into the report. Note You should not have to change the code for checkjavaExtension() .
