[site]: stackoverflow
[post_id]: 5454814
[parent_id]: 5362730
[tags]: 
The PCap library could do this for sure, the only problem residing in the fact that the end user would need PCap installed (unless you're willing to create a standalone version). If you really need to avoid extra additions like this, you could also just write separate cases for each target platform. I know it's messy, but sometimes it's inescapable. Best of luck.
