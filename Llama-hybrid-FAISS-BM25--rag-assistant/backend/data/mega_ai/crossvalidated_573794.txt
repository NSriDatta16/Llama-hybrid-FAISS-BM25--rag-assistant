[site]: crossvalidated
[post_id]: 573794
[parent_id]: 573759
[tags]: 
Partial answer: The code below does the following: Determine the test statistic for the given tallies of 990, 1050, 960. The result is 4.2. Determine the test statistic for each row of tallies in the simulation of random tallies. Compute the average number of rows where the test statistic is greater or equal to 4.2. The final step gives us (an estimate of) the probability of getting a set of tallies whose distance from the expected distribution is at least as extreme as the target set of tallies (990, 1050, 960). ref.test.stat % mutate(test.stat. = (1000-x1)^2/1000 + (1000-x2)^2/1000 + (1000-x3)^2/1000) %>% mutate(ind = ifelse(test.stat.>=ref.test.stat,1,0)) %>% summarise(mean(ind)) %>% pull() # 0.1246
