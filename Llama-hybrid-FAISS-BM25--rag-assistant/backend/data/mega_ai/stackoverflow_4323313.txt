[site]: stackoverflow
[post_id]: 4323313
[parent_id]: 
[tags]: 
SQL calculations: Perform AVERAGE using THIS year, LAST year and NEXT year data?

I’m struggling to recreate a certain calculation in SQL that I can do in Excel. It concerns averages. We collect data over many years. One table we create is a three year average. Below are tables that show: 1) the RAW data, and 2) a new table with the AVERAGE data. The ‘Dimensions’ are [Year] & [ItemCode]. The average data is based on averaging a year’s figure with the 2 years either side. i.e. 1991 average figure = Average (1990,1991,1992). =AVERAGE(B2:D2) 1) RAW 2) AVERAGE alt text http://tinypic.com/images/404.gif In Excel this seems simple to do: an average formula that is then dragged into the other cells, or in VBA using R1C1 referencing. But what is it in SQL? How do you say use ‘this’ year & the year before & the year after data? Also, I realise that if there’s an empty cell it would throw my calculations, so how do you manage NULL values so it only calculates when there are three figures to use?...and then do it all again until finished (many years and many, many ItemCodes) Any help would be greatly appreciated.
