[site]: stackoverflow
[post_id]: 2050610
[parent_id]: 
[tags]: 
Creating a facet_wrap plot with ggplot2 with different annotations in each plot

I am using ggplot2 to explore the result of some testing on an agent-based model. The model can end in one of three rounds per realization, and as such I am interested in how player utilities differ in terms of what round the game ends and their relative position in 2D space. All this is to say that I have generated a facet_wrap plot to show this for each round, but I would also like to annotate each plot with the cor(x,y) for the subset of data represented in each facet. Is there a way to tell ggplot2 that I would like the annotation to use the subset of data generated by facet_wrap? Here is the code I have so far, and what it is producing library(ggplot2) # Load data abm.data (source: drewconway.com ) As you can see, there are two problems: The \rho value is of the full dataset, rather than the subsets by 'round'. Is there a way to get the cor(x,y) to print based on only the data shown in each plot? The annotation should read "\rho=some_value" but instead I get "=(\rho,value);" is there a way to fix this?
