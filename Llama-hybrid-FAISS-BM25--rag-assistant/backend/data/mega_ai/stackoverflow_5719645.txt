[site]: stackoverflow
[post_id]: 5719645
[parent_id]: 4850116
[tags]: 
I had to clean out a hacked Joomla install recently. My tip is to grep all the files base64_decode: some hacks consist of decoding a huge string that emits php. find ./ | xargs grep base64_decode The hack looked like this: error_reporting(0);eval(base64_decode('JGxMOXdGMWFZNHpY..... This particular piece of code detected googlebot and other crawlers, and then emitted a list of spam links heavy on viagra. If a normal user agent string was used it showed a normal site. I had to use a firefox extension that changes the user agent to debug this. The next step would be getting rid of the exploit and then either patching Joomla and waiting for the next exploit or switching to something more secure, like static html or a well-maintained CMS.
