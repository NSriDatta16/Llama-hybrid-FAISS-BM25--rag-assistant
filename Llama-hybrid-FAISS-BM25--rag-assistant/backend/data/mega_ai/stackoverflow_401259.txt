[site]: stackoverflow
[post_id]: 401259
[parent_id]: 400359
[tags]: 
Following Ole's advice above, I re-worked my implementation to look at a threshold. It seems to handle most scenarios I throw at it well enough without me having to go nuts and write code that actually understand the English language. Basically, I first scan through the input string and record the longest line length in the variable inputMaxLineLength . Then as I'm rewrapping, if I encounter a newline that has an index between inputMaxLineLength and 85% of inputMaxLineLength , then I replace that newline with a space because I think it's a hard wrap newline--unless it's immediately followed by another newline, because then I assume that it's just a one-line paragraph that just happens to within that range. This can happen if someone types out a short bulleted list, for example. Certainly not perfect, but "good enough" for my scenario, considering the text is usually half-mangled by a previous e-mail client to begin with. Here's some code, my a-few-hours-old implementation that probably still underwraps in a few edge cases (using C#). It's a lot less complicated than my previous solution, which is nice. Source Code And here's some unit tests that exercise that code (using MSTest): Test Code If anyone has a better implementation (and no doubt a better implementation exists), I'll be happy to read your thoughts! Thanks.
