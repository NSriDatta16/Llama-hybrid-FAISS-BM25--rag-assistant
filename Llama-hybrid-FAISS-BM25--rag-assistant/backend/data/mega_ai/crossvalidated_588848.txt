[site]: crossvalidated
[post_id]: 588848
[parent_id]: 588347
[tags]: 
First , the model CausalForestDML presumes that the outcome Y depends linearly on the treatment T . That means this relation is independent of the treatment T . The proportionality factor $\theta(\mathbf X)$ (the "effect") depends solely on the feature covariates $\mathbf X$ . Thus, it is the same for all your three discounts (0%, 5%, 10%). Second , in your code you ask for the const_marginal_ate() , which is $E_{\mathbf X}[\theta(\mathbf X)]$ , i.e. it is the average over all possible feature covariates $\mathbf X$ and thus doesn't even depend on $\mathbf X$ anymore. Third , in this model, you can have multiple treatments $\mathbf T$ , and multiple outcomes $\mathbf Y$ , and for each treatment-outcome pair, you can compute the constant marginal ATE. Thus, you have a matrix of effects. But from your post, I could not figure out whether this is the case in your situation. It seems like you have just one treatment variable discount% , which can take on three possible values (0%, 5%, 10%), and only one outcome variable purchase_amount , in which case the return type of const_marginal_ate() should be a scalar, see the part Returns in the documentation . I am also not sure about your posted output table: on the one hand, you say you compute the constant marginal ATE (because you use const_marginal_ate() ), but on the other hand the column header in your posted output table is CATE . And maybe the column header User_id is your covariate W , but this is also not clear. Summary : In general, for d_y outcomes Y and d_t treatments T , the result of const_marginal_ate() is a d_y x d_t matrix $M$ , constant in the particular values of the treatments and of the covariates X , which gives in each cell $M_{ij}$ the effect of the $j$ -th treatment on the $i$ -th outcome.
