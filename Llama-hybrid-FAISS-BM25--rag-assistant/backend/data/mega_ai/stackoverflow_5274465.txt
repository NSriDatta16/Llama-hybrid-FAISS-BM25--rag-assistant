[site]: stackoverflow
[post_id]: 5274465
[parent_id]: 5274434
[tags]: 
You've just got it a bit the wrong way round IF NOT EXISTS(SELECT * FROM dashboardtasks WHERE ( @tour = dashboardtasks.tour and @taskname = dashboardtasks.taskname and @deptdate = dashboardtasks.deptdate and @duedate = dashboardtasks.duedate and @tourname = dashboardtasks.tourname and @agent = dashboardtasks.agent ) ) BEGIN INSERT INTO dashboardtasks ([tour] ,[tourname] ,[taskname] ,[deptdate] ,[tasktype] ,[desc] ,[duedate] ,[agent] ,[graceperiod]) VALUES (@tour, @tourname, @taskname , @deptdate, @tasktype , @desc , @duedate , @agent , @graceperiod ) END
