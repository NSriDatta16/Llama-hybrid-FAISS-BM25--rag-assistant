[site]: stackoverflow
[post_id]: 3684219
[parent_id]: 3641835
[tags]: 
Private Sub cmdBuy_Purchase_Click() Debtor = Purchase_Select_Debtor.Value Amount = CSng(txtPrice.Value) Balance = CSng(txtBalance.Value) If Debtor = "" Then MsgBox "Select Debtor" Exit Sub End If DebtorRow = 1 Do TempDebtor = Worksheets("Debtor_list").Range("A" & DebtorRow).Value If TempDebtor = Debtor Then DebtorBalance = CSng(Worksheets("Debtor_List").Range("B" & DebtorRow).Value) Exit Do End If DebtorRow = DebtorRow + 1 Loop Until TempDebtor = "" If TempDebtor = "" Then MsgBox "Debtor not found" Exit Sub End If Worksheets("Debtor_List").Range("B" & DebtorRow).Value = DebtorBalance - Amount Balance = Application.VLookup(Purchase_Select_Debtor.Value, Sheets("Debtor_list").Range("A2:B13"), 2, 0) MsgBox "You have just Purchased " & Purchase_Select_Quantity.Value & " For $" & Amount & vbCrLf & "Your Account Balance is now: " & Balance Unload FrmPurchase End Sub & Sub cmdPay_Balance_Click() Debtor = Pay_Balance_Select_Debtor.Value Amount = CSng(txtCredit.Value) If Debtor = "" Then MsgBox "Select Debtor" Exit Sub End If DebtorRow = 1 Do TempDebtor = Worksheets("Debtor_list").Range("A" & DebtorRow).Value If TempDebtor = Debtor Then DebtorBalance = CSng(Worksheets("Debtor_List").Range("B" & DebtorRow).Value) Exit Do End If DebtorRow = DebtorRow + 1 Loop Until TempDebtor = "" If TempDebtor = "" Then MsgBox "Debtor not found" Exit Sub End If Worksheets("Debtor_List").Range("B" & DebtorRow).Value = DebtorBalance + Amount txtBalance.Value = Application.VLookup(Pay_Balance_Select_Debtor.Value, Sheets("Debtor_list").Range("A2:B13"), 2, 0) MsgBox "You have just Credited $" & Amount & vbCrLf & "Your Account Balance is now: " & txtBalance Unload frmPay_Balance End Sub
