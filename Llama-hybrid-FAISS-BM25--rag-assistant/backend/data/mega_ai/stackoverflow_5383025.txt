[site]: stackoverflow
[post_id]: 5383025
[parent_id]: 
[tags]: 
Where in my code have I broken the Mat equivalence rule?

I'm trying to achieve background subtraction in openCV 2.2 using the cv namespace (Qt4.7). I have the following code which compiles fine but when running the program breaks because one mat doesn't equal the other but I can't find out where it is and I'm currently going through the API reference to try and find it. cvtColor( mcolImage, mcolImage, CV_BGR2RGB); cvtColor( mcolImage, gscaleImage, CV_RGB2GRAY); acc = Mat(Size(440,320), CV_32FC3); accSQ = Mat(Size(440,320), CV_32FC3); //we accumulate into a Mat to get an frames average Mat avg; accumulateWeighted(gscaleImage, acc, 3.0, Mat()); accumulateSquare(gscaleImage, accSQ, Mat()); multiply(acc, acc, avg, 1); Mat sigma, sigmaSQRT; subtract(accSQ, avg, sigmaSQRT, Mat()); sqrt(sigmaSQRT, sigma); //Holds the standard deviation Mat fgImage; //hold the foreground image cv::absdiff(avg,gscaleImage, fgImage); //GaussianBlur(gscaleImage, gscaleImage, Size(7,7), 2, 2 ); Mat buff ; //convert to black and white threshold(fgImage, buff, 75, THRESH_BINARY, 100); dilate(buff, buff, Mat(3, 3, CV_8UC1), Point(-1, -1), 1, BORDER_CONSTANT, Scalar(1.0, 1.0, 1.0, 0)); erode(buff, buff, Mat(3, 3, CV_8UC1), Point(-1, -1), 1, BORDER_CONSTANT, Scalar(1.0, 1.0, 1.0, 0)); //rectangle(gscaleImage, cvPoint(100, 300), cvPoint(200, 100), cvScalar(255, 255, 255, 0), 1); QImage colImagetmp((uchar*)mcolImage.data, mcolImage.cols, mcolImage.rows, mcolImage.step, QImage::Format_RGB888 ); //Colour QImage gscaleImagetmp ((uchar*)gscaleImage.data, gscaleImage.cols, gscaleImage.rows, gscaleImage.step, QImage::Format_Indexed8); //Greyscale. I hope QImage bwImagetmp((uchar*)buff.data, buff.cols, buff.rows, buff.step, QImage::Format_Indexed8); //Setup a colour table for the greyscale image QVector colorTable; for (int i = 0; i setPixmap(QPixmap::fromImage(bwImagetmp)); ui.bwDisplay->setPixmap(QPixmap::fromImage(gscaleImagetmp)); ui.colDisplay->setPixmap( QPixmap::fromImage(colImagetmp )); Thanks for the help in advanced. Edit: After going through the code I found that the absdiff(avg, gscaleImage, fgImage); is where the program is crashing. I think it maybe crashing on the second parameter but not sure.
