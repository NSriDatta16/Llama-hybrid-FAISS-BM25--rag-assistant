[site]: stackoverflow
[post_id]: 4563517
[parent_id]: 4385728
[tags]: 
Here's my complete working code based on dipu's suggestion: private Uri saveToFileAndUri() throws Exception{ long currentTime = System.currentTimeMillis(); String fileName = "MY_APP_" + currentTime+".jpg"; File extBaseDir = Environment.getExternalStorageDirectory(); File file = new File(extBaseDir.getAbsoluteFile()+"/MY_DIRECTORY"); if(!file.exists()){ if(!file.mkdirs()){ throw new Exception("Could not create directories, "+file.getAbsolutePath()); } } String filePath = file.getAbsolutePath()+"/"+fileName; FileOutputStream out = new FileOutputStream(filePath); bitmap.compress(Bitmap.CompressFormat.JPEG, JPEG_QUALITY, out); //control the jpeg quality out.flush(); out.close(); long size = new File(filePath).length(); ContentValues values = new ContentValues(6); values.put(Images.Media.TITLE, fileName); // That filename is what will be handed to Gmail when a user shares a // photo. Gmail gets the name of the picture attachment from the // "DISPLAY_NAME" field. values.put(Images.Media.DISPLAY_NAME, fileName); values.put(Images.Media.DATE_ADDED, currentTime); values.put(Images.Media.MIME_TYPE, "image/jpeg"); values.put(Images.Media.ORIENTATION, 0); values.put(Images.Media.DATA, filePath); values.put(Images.Media.SIZE, size); return ThisActivity.this.getContentResolver().insert(Images.Media.EXTERNAL_CONTENT_URI, values); }
