[site]: crossvalidated
[post_id]: 116354
[parent_id]: 
[tags]: 
Why do my boostrapped CI's (using boot.ci in R) not include the point estimate?

I'm interested in estimating an average treatment effect $$ \operatorname{ATE}\left(A', A''\right) = \mathbb{E}\left( Y\ |\ A'' \right) - \mathbb{E}\left( Y\ |\ A' \right) $$ with a generalized linear model (GLM), and I would like to know if that treatment effect is significantly different from zero. However, I don't think this has a closed form in general*, so I wanted to bootstrap a confidence interval for it using the R package boot . However, I ended up with CI's that looked like this: where the black line is the density of bootstrapped ATE's, the red line is the mean of those estimates, and the gray box (is supposed to) represent the CI for the mean. The title corresponds to the "type" argument passed to boot.ci . Obviously, these intervals make no sense. What am I missing? Is it code, or theory? This is the code I'm using: # first, download www.columbia.edu/~gw2286/for_stackexchange.txt # and run it as an R script. library(boot) # Set b; eventually I will loop over `centers` b = centers[[2]] predict_difference *I could probably also do this analytically. Since $(Y | X) \sim \operatorname{Bernoulli}\left(\hat p \right)$, it should be the case that $\mathbb{E}\left(Y | X\right) \sim \operatorname{binomial}\left(p, n\right)$, but then the distribution of $\mathbb{E}\left(Y | X' \right) - \mathbb{E}\left(Y | X'' \right)$ is messy , although I'll use it if I have to. I would use the normal approximation $\mathbb{E}\left(Y | X \right) \sim N\left(p, \sqrt{\frac{p(1-p)}{n}}\right)$, but obviously I don't know $p$ for computing the variance, unless I can substitute it with $\hat p$. And I guess $n$ in this case is the number of observations I used to fit the model. However I also want to be able to use this for another model, with a lognormal (rather than Bernoulli) response. Unless that one has an exact formula as well?
