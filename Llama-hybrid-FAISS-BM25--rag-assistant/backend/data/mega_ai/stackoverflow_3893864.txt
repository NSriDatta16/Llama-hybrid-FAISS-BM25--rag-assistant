[site]: stackoverflow
[post_id]: 3893864
[parent_id]: 
[tags]: 
Need help speeding up this jQuery process

I've created the following process. Basically it loops through a gigantic unordered list with multiple level nested lists and creates a 2 level nested unordered list. It works well but is very slow in IE7. FireFox and Safari have no big problems with it. Not very good at jQuery I was wondering if I could speed up this by using better/faster/smarter functions. Due to the CMS I am using I can not change the output nor jQuery version I'm using which is 1.2.6. Here's what I've got; $('ul#mainnav li ul li').each(function() { // add level class $(this).addClass('depth-'+$(this).parents('ul').length); // make uls siblings in stead of children $($(this).children('ul')).insertAfter($(this)); }); // take all lis out of their uls $('ul#mainnav li ul').each(function() { $(this).replaceWith($(this).children()); }); // wrap chidlren lis with div $('ul#mainnav li').each(function() { $(this).children('li:first').before(' '); $(this).children('.megamenu').append($(this).children('li')); }); // apply plugin easyLisSplitter $('.megamenu').easyListSplitter({ colNumber: 5 }); Any ideas? If more info is needed let me know! Cheers EDIT: Thanx for all the replies. Haven't tried everyting yet. Using var $this = $(this); sped up things by 20 milliseconds. Well I'll take those. All help is still welcome! Here's the before markup: A-1 A-1-1 A-1-1-1 A-1-1-2 A-1-1-3 A-1-2 A-1-3 A-1-3-1 A-1-3-2 A-1-3-3 A-1-4 A-1-4-1 A-1-4-2 A-1-4-3 A-1-4-4 A-1-4-5 A-1-5 A-1-5-1 A-1-5-2 A-1-5-3 A-1-5-4 A-1-5-5 B-1 B-1-1 B-1-1-1 B-1-1-2 B-1-1-3 B-1-2 B-1-3 B-1-3-1 B-1-3-2 B-1-3-3 B-1-4 B-1-4-1 B-1-4-2 B-1-4-3 B-1-4-4 B-1-4-5 B-1-5 B-1-5-1 B-1-5-2 B-1-5-3 B-1-5-4 B-1-5-5 And here's the after; A-1 A-1-1 A-1-1-1 A-1-1-2 A-1-1-3 A-1-2 A-1-3 A-1-3-1 A-1-3-2 A-1-3-3 A-1-4 A-1-4-1 A-1-4-2 A-1-4-3 A-1-4-4 A-1-4-5 A-1-5 A-1-5-1 A-1-5-2 A-1-5-3 A-1-5-4 A-1-5-5 B-1 B-1-1 B-1-1-1 B-1-1-2 B-1-1-3 B-1-2 B-1-3 B-1-3-1 B-1-3-2 B-1-3-3 B-1-4 B-1-4-1 B-1-4-2 B-1-4-3 B-1-4-4 B-1-4-5 B-1-5 B-1-5-1 B-1-5-2 B-1-5-3 B-1-5-4 B-1-5-5
