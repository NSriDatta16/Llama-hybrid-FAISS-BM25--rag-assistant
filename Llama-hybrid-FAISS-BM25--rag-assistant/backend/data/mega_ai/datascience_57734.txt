[site]: datascience
[post_id]: 57734
[parent_id]: 
[tags]: 
I am having issues with the output dimensions of my neural network

I am trying to make an image denoiser using a neural network in keras. I have 2 sets of images, un-noised images, and the same images with noise. All the images have the dimensions of (200,200,3). I cant use one-hot encoding, as I have memory issues with it; So I am using the sparse_categorical_crossentropy loss. This is the model: x_train, x_test, y_train, y_test = train_test_split(x,y, test_size=0.1, random_state=1) y_train = y_train.reshape(180, 120000) y_test = y_test.reshape(20, 120000) model = Sequential() model.add(Conv2D(32, (3,3), activation='sigmoid', input_shape=(200,200,3))) model.add(MaxPooling2D((2, 2))) model.add(Flatten()) model.add(Dense(120000, activation='relu')) model.add(Dense(120000, activation='tanh')) model.compile(loss='sparse_categorical_crossentropy', optimizer='SGD') print(model.summary()) model.fit(x_train, y_train, validation_data=(x_test, y_test), epochs=2) I get this error when I try to train it: Error when checking target: expected dense_2 to have shape (1,) but got array with shape (120000,). How can I fix this?
