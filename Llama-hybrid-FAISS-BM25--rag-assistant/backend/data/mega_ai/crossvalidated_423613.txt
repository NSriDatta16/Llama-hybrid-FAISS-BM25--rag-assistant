[site]: crossvalidated
[post_id]: 423613
[parent_id]: 423542
[tags]: 
I’ll answer myself with help from these other questions in the math section: https://math.stackexchange.com/questions/3333220/expected-average-depth-in-random-binary-tree-constructed-top-to-bottom https://math.stackexchange.com/questions/52572/do-harmonic-numbers-have-a-closed-form-expression From the answer above, the actual expected depth when splitting at random a remaining sample size $n$ is given by $2 (H(n) – 1)$ , where $H(n)$ is the harmonic number for $n$ . The paper gives the formula $2 H(n – 1) – 2 \frac{n-1}{n}$ , which gives the same result ( https://en.wikipedia.org/wiki/Harmonic_number#Identities_involving_harmonic_numbers ). In addition, the paper uses an approximation for the harmonic number $H(n)$ which is the limit as $n$ tends to infinite ( https://en.wikipedia.org/wiki/Harmonic_number#Calculation ). As such, if the sample size for which the approximate depth is determined is large, the actual vs. approximated results will be very close, and it’s not a big deal to use it for the expected average depth (from which the scores are calculated as $2^{-\frac{E[d]}{c}}$ ) in the whole data. However, the paper also uses it to determine the expected sample size at the end of each node that reaches the height limit, which will be smaller numbers and might be within a range in which the approximation is far from the real results – this usage of the approximation seems quite wrong to me. The difference between the paper’s approximation and the true value actually differ by less than $10^{-5}$ for values of $n > 5000$ , and by less than $10^{-3}$ for values of $n > 500$ , but for $n = 4$ , which is reasonable to expect when reaching a height limit, the difference is rather large ( $2.166667 - 1.85 = 0.317$ ).
