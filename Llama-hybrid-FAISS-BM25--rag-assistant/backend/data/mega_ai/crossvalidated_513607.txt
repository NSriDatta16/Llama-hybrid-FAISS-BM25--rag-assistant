[site]: crossvalidated
[post_id]: 513607
[parent_id]: 513575
[tags]: 
This only works if all the correlations are known and the observations from the data with known means are independent of the observations from the data with unknown means. Outside of that scenario, everything becomes more complicated and you would have to post the details of the specific scenario for any answers about that. I'm assuming you want two-sided symmetric 95% confidence intervals. Suppose the covariance matrix for the first $100$ is $\sigma^2R$ where $R$ a known positive definite matrix with $1$ 's on the diagonal and suppose the means, $\mu_i$ , are known. First, find a matrix $B$ such that $BRB'=I$ where $B'$ denotes the transpose of $B$ and $I$ denotes the identity matrix. $$Y=B\left((X_1,...,X_{100})'-(\mu_1,...,\mu_{100})\right)$$ is multivariate normal with mean $(0,...,0)$ and variance $\sigma^2I$ . Now, $\hat{\sigma}^2=\frac{1}{100}\sum_{i=1}^{100}Y_i^2$ is an unbiased estimate of $\sigma^2$ . $\frac{1}{\sigma^2}\sum_{i=1}^{100}Y_i^2$ has a chi-square distribution with $100$ degrees of freedom. For the remaining $900$ means $\mu_{101},...,\mu_{1000}$ , you can construct the 900 confidence intervals in different ways depending on what statement you want to make about the confidence. The confidence intervals $x_i \pm t_{100}(0.025) \hat{\sigma}$ each contain the true mean with probability 0.95. So, on average 45 of the 900 will not contain the true mean and the remaining 855 will contain the true mean. The per comparison error rate is 0.05. Suppose you want to control the familywise error rate. All $900$ confidence intervals $x_i \pm q \hat{\sigma}$ must simultaneously contain the true mean with probability $0.95$ . So, there will be a 5% chance that at least one of them does not contain the true mean. Let $\sigma^2 S$ denote the covariance matrix for the $900$ random variables where $S$ is a symmetric matrix with $1$ 's on the diagonal. You want $$-q to hold simultaneously for all $i=101,...,1000$ with probability 0.95. Note $Z=(\frac{X_{101}-\mu_{101}}{\sigma},...,\frac{X_{1000}-\mu_{1000}}{\sigma})'$ and $u=\frac{1}{\sigma^2}\sum_{i=1}^{100}Y_i^2=100\frac{\hat{\sigma}^2}{\sigma^2}$ are independent with $Z\sim N(0,S)$ and $u\sim \chi_{100}^2$ . Also, $$\frac{Z}{\sqrt{u/100}}=(\frac{X_{101}-\mu_{101}}{\hat{\sigma}},...,\frac{X_{1000}-\mu_{1000}}{\hat{\sigma}})'$$ Therefore, $$(\frac{X_{101}-\mu_{101}}{\hat{\sigma}},...,\frac{X_{1000}-\mu_{1000}}{\hat{\sigma}})'$$ has a multivariate t-distribution . You can then use pmvt package in R for example to find $q$ . Here is an example assuming $S$ is the identity matrix. Note: it takes a long time to run using $m=1000$ , I only checked that it works for smaller $m$ . For the case where $S$ is the identity, there is an easier way to calculate $q$ . library(mvtnorm) q=qmvt(0.975,df=100,mean=rep(0,900),sigma=diag(900))$quantile pmvt(lower=rep(-q,900),upper=rep(q,900),df=100) #check that it works
