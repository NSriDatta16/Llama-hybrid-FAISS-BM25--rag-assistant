[site]: stackoverflow
[post_id]: 2493312
[parent_id]: 2485962
[tags]: 
I notice that you passed -O instead of -O2 . You might get some speed up from -O2 . As others mention, this is not the same algorithm in C and Haskell because the data structures differ--Haskell uses an immutable linked list of Unicode characters. What is your purpose? The fastest sort of any kind in many languages? The fastest bubble sort in many languages? The fastest idiomatic bubble sort in many languages? I guess (1) is not the case since you are using bubble sort in C as well. If (2), then you should be using STUArray of Word8 s, which will give you an algorithm close to the C version (though probably uglier and slower). If (3), I am sort of confused, because bubble sort only really looks idiomatic in BASIC (the old kind, where you capitalise the entire word, not like VisualBasic with only two capitals). You should expect elegance and performance to degrade in direct proportion with the language's similarity to BASIC. Whatever the case, it would be interesting to see the performance of a immutable linked-list recursive bubble sort of Unicode strings in C.
