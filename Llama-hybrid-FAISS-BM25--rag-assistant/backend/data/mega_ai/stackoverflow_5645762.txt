[site]: stackoverflow
[post_id]: 5645762
[parent_id]: 
[tags]: 
WORD VBA Count Word Occurrences

i have a code below that is already working. However i need to simplify the code even further. The code i have below counts the word occurrences in a document. The code is as follows: Option Base 1 Sub arrangepara() Dim r As Range Set r = activedocument.Range If (r.Characters.Last.text = vbCr) Then r.End = r.End - 1 sortpara r End Sub Function sortpara(r As Range) Dim sWrd As String Dim Found As Boolean Dim N As Integer, i As Integer, j As Integer, k As Integer, WordNum As Integer N = r.Words.count ReDim Freq(N) As Integer ReDim Words(N) As String Dim temp As String i = 1 WordNum = 0 Do While r.Find.Execute(findtext:=" ", MatchWildcards:=True, Wrap:=wdFindStop) = True If i = N Then Exit Do Found = False For j = 1 To WordNum If Words(j) = r.text Then Freq(j) = Freq(j) + 1 Found = True Exit For End If Next j If Not Found Then WordNum = WordNum + 1 Words(WordNum) = r.text Freq(WordNum) = 1 End If i = i + 1 Loop Set r = activedocument.Range r.Collapse wdCollapseEnd r.InsertParagraphBefore r.Collapse wdCollapseEnd r.InsertAfter "Occurrence List:" r.Collapse wdCollapseEnd r.InsertParagraphBefore r.Collapse wdCollapseEnd For j = 1 To WordNum r.InsertAfter Words(j) & " (" & Freq(j) & ")" & vbCr Next j r.Select Selection.sort SortFieldType:=wdSortFieldAlphanumeric, SortOrder:=wdSortOrderAscending r.Font.Color = wdColorAqua End Function I need to simply this part and i dont know how. Are there any good samaritans out there that can simplify the codes for me? Thanks much! Below is what i need to simplify: Do While r.Find.Execute(findtext:=" ", MatchWildcards:=True, Wrap:=wdFindStop) = True If i = N Then Exit Do Found = False For j = 1 To WordNum If Words(j) = r.text Then Freq(j) = Freq(j) + 1 Found = True Exit For End If Next j If Not Found Then WordNum = WordNum + 1 Words(WordNum) = r.text Freq(WordNum) = 1 End If i = i + 1 Loop
