[site]: datascience
[post_id]: 67100
[parent_id]: 
[tags]: 
SHAP Kernel explainer for my pipeline model

I am trying to use SHAP kernel explainer to understand my XGBOOST model. My data is the lending club data and I am trying to predict the Grade of each customer. The data contains different types of data (Objects, float) so I use one hot encoding for object features and scaling for numerical features. When I try to use the kernel explainer with the below code I get the following error. #creating training and validation sets X_train, X_test, y_train, y_test = train_test_split(features, eh, test_size=0.2,random_state=777) #%% preprocess = make_column_transformer(((make_pipeline(IterativeImputer(initial_strategy='median',add_indicator=True,verbose=2,max_iter=100),StandardScaler())),numerical_features),((make_pipeline(SimpleImputer(strategy='constant',fill_value="Not Available",add_indicator=True),OneHotEncoder(handle_unknown='ignore'))),categorical_features)) grid_clf = make_pipeline(preprocess,RandomOverSampler(random_state=777),XGBClassifier(n_jobs=-1,verbosity=3, objective= 'multi:softprob', nthread=-1, scale_pos_weight=1, seed=27,tree_method='hist',n_estimators = 125, max_depth = 15, learning_rate = 0.2, gamma = 0.24, min_child_weight =6.0, subsample = 0.8200000000000001, colsample_bytree = 0.96)) clf=grid_clf.fit(X_train, y_train) import shap shap.initjs() def model_predict(data_asarray): data_asframe = pd.DataFrame(data_asarray, columns=X_test.columns) return grid_clf.predict_proba(data_asframe) #%% explainer = shap.KernelExplainer(model_predict,X_test2).shap_values(X_test2.sample(1)) The Error I get: TypeError: ufunc 'isfinite' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe'' How I can Solve this problem
