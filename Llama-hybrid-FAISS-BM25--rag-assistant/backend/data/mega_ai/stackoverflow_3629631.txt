[site]: stackoverflow
[post_id]: 3629631
[parent_id]: 3628919
[tags]: 
I think you can get somewhere with the forbidden NtQuerySystemInformation() API. A sample project that ab/uses this API is available here . Lots of warning flags need to be raised with this, you're monkeying with intentionally undocumented internal kernel data structures. You most definitely do not want to do what that article proposes, closing file handles involuntarily is a great way to cause random file system corruption. And you'll have a hard time keeping this kind of code compatible with future versions of Windows. A possibly better, but not more elegant solution is to rely on the SysInternals' Handle utility. It is likely to be maintained for a while to come. Run this program from yours, redirecting the output. Parsing the text is doable.
