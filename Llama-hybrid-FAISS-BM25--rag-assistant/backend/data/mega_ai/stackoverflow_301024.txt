[site]: stackoverflow
[post_id]: 301024
[parent_id]: 
[tags]: 
Validate Authenticode signature on EXE - C++ without CAPICOM

I'm writing a function for an installer DLL to verify the Authenticode signature of EXE files already installed on the system. The function needs to: A) verify that the signature is valid. B) verify that the signer is our organization. Because this is in an installer, and because this needs to run on older Win2k installations, I don't want to rely on CAPICOM.dll, as it may not be on the target system. The WinVerifyTrust API works great to solve (A). I need to find a way to compare a known certificate (or properties therein) to the one that signed the EXE in question.
