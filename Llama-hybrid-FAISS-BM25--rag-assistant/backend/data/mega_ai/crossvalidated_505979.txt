[site]: crossvalidated
[post_id]: 505979
[parent_id]: 505932
[tags]: 
The relevant question is: Within each treatment group, how many observations would I need to draw until I find 2 observations with the very same characteristic? To avoid potential confusion, I'd prefer to use the word "characteristic" to represent a set of distinct values from which each individual has exactly one value (like the set of colors of a group of single-colored balls, or the set of possible birthdays) and ask about a match of the value of the characteristic between 2 cases (e.g., 2 balls having the same color, 2 people having the same birthday). For one particular value of the characteristic to match This can be considered in the context of the negative hypergeometric distribution , when "sampling from a finite population without replacement in which each sample can be classified into two mutually exclusive categories." The distribution is described on that linked Wikipedia page as representing the number $k$ of "successes" until a specified number $r$ of "failures" is found. For the negative hypergeometric distribution, the mean number of "successes" $\bar k$ until $r$ "failures" depends on the total population size $N$ and the number of "success" cases, $K$ , in the population: $$ \bar k = r \frac{K}{N-K-1}$$ To keep in line with that description, in your situation consider your requirement for finding 2 cases with a particular value of the characteristic as being $r=2$ "failures." Your finite population size is $N=300$ for each group. If you draw on the average 7 times to get 2 cases with that value of the characteristic ("failures"), then you have on average 5 "successes" without that value. The above formula indicates K=215 for the total number without that value and thus 85 with it. If you need to draw 90 times to get 2 "failures" then $K$ is about 294, or only about 6 cases with that value of the characteristic. For any value of the characteristic to match This is related to the birthday problem . That's the classic question about how small a group can be such that there's a 50% chance of 2 individuals sharing a birthday: 23, for 365 possible birthdays evenly distributed. The generalized birthday problem extends that to any set of $d$ values of a characteristic evenly distributed in the population. The minimum sample size needed to have a 50% chance of some match between 2 individuals, $n(d)$ , up to $d=99$ values of a characteristic, is:* $d$ 1–2 3–5 6-9 10–16 17–23 24–32 33–42 43–54 55–68 69–82 83–99 $n(d)$ 2 3 4 5 6 7 8 9 10 11 12 In your example, your "characteristic" is an ordered set of 4 symbols chosen with replacement from the set $\{A,B,C\}$ , for a total of $3^4=81$ distinct values of the characteristic. If all values are equally probable, a sample of size 11 has at least a 50% probability of having 2 cases that match. If all values aren't equally probable, the probability of a match is even greater . If you have in mind a particular distribution of the values of the characteristic among cases, it's not hard to simulate the specific situation. Implications for sampling First, if you're planning to re-sample only 5 out of 300 cases then you probably don't need to worry too much about sampling with versus without replacement. Sampling with replacement has only about a 3.3% chance of having any duplicate case in that situation. Second, it's not clear why you seem to be worried about ending up with a match of a value of your characteristic within your re-sample of 5 cases. The underlying population from which you drew the 300 cases for each arm of your trial will necessarily have multiple matches of all values of the characteristic. Insofar as you are trying to use sampling to represent what's going on in the underlying population, it's not clear why such a value match should be a problem. Even duplicate cases in a re-sample don't necessarily pose a problem. Re-sampling with replacement has the advantage that the selection of cases from the original sample is independent; each case always has its original probability of being selected at each step. In contrast, sampling without replacement means that the cases already chosen alter the probabilities of selecting subsequent cases, so that sampling isn't independent. Bootstrapping , to estimate a distribution of parameter values or the generalizability of a modeling process in the underlying population from which the original sample was taken, typically uses re-sampling with replacement of the same size as the original data sample. In that method, over 1/3 of each re-sample usually are cases that are at least duplicates of others. Nevertheless, all selections within each re-sample are independent. Having replicate cases in a re-sample doesn't by itself lead to bias; the process of re-sampling with replacement from the data sample mimics the independent -case sampling used to get the original data sample from the population. You can think about duplicate cases in the re-sample as representing members of the underlying population that are "nearby" in some sense. If you're worried about bias, you thus might be better off sampling with replacement (although in your example of re-sampling 5 out of 300 the difference is small). *The table is copied from the Wikipedia page. The R functions qbirthday() and pbirthday() provide calculations of minimum sample size to have a desired probability of a match, and the probability of a match for a given sample size.
