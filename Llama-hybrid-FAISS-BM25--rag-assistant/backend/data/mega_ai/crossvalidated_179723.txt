[site]: crossvalidated
[post_id]: 179723
[parent_id]: 179720
[tags]: 
My understanding of what you are doing differently is that in the paper, they are taking an average of averages (i.e. for each set of 4)...regardless of how many samples (i.e. how many leading H's). To demonstrate the difference: suppose you saw these two sequences: HHHH HTTT The way you are counting it (I believe, only skimmed your code), it would be 4 H's that have a following flip, 3 for which have a following H, so $\hat p = 0.75$. But from my understanding, they would calculate this as the first trial had 3 H's with a following flip, all of which are followed by an H, so $\hat p_1 = 1$ and in the next trial there is one H, followed by a T, so $\hat p_2 = 0$, making $\hat p_. = 0.5$, where $\hat p_.$ is the ( unweighted ) average of averages. I'm guessing that if they took a weighted average of the $\hat p_i$'s, the answer would probably be the same. But that's gut feeling, not actually having sat down to work it out.
