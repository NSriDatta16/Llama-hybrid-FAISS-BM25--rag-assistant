[site]: stackoverflow
[post_id]: 3918306
[parent_id]: 
[tags]: 
Problem setting up unit testing when using app engine patch on google app engine

I'm having a lot of trouble writing unit tests for my app engine patch solution. I've asked this question on experts exchange (http://www.experts-exchange.com/Programming/Languages/Scripting/Python/Q_26509115.html) but it's been there for two weeks with no answer - hopefully the SO crew can improve on that!! I've tried everything I've found on the internet, my current setup is using nose-aep, but I have also tried the standard unit test framework but it gives pretty much the same problem (the issue seems to be app engine patch, but it's not clear how to fix it). Using the simplest test: def test(): #pass assert False Both the pass and fail run as expected but I'm getting an exception shown which isn't affecting the outcome: Exception exceptions.AttributeError: "'NoneType' object has no attribute 'print_exc'" in > ignored As soon as I import the models, or any other file which references the models e.g. from application.models import * I get an error which suggests app engine patch isn't setting up correctly. I've included the log output below. Any help appreciated!! When using nose-aep the error is : /System/Library/Frameworks/Python.framework/Versions/2.5/bin/python2.5 /Applications/PyCharm-96.1063.app/helpers/pydev/pydevd.py --client 127.0.0.1 --port 61552 --file /usr/local/bin/nosetests-script.py --with-gae --without-sandbox -w tests/ Connected to pydevd (version 1.1) pydev debugger: warning: psyco not available for speedups (the debugger will still work correctly, but a bit slower) pydev debugger: starting nose.config: INFO: Set working dir to /Users/craigedmunds/Documents/Source/reciply/webapplication/trunk/tests Running on app-engine-patch 1.1 Failure: AttributeError ('module' object has no attribute 'User') ... ERROR ====================================================================== ERROR: Failure: AttributeError ('module' object has no attribute 'User') ---------------------------------------------------------------------- Traceback (most recent call last): File "/Library/Python/2.5/site-packages/nose-0.11.4-py2.5.egg/nose/loader.py", line 382, in loadTestsFromName addr.filename, addr.module) File "/Library/Python/2.5/site-packages/nose-0.11.4-py2.5.egg/nose/importer.py", line 39, in importFromPath return self.importFromDir(dir_path, fqname) File "/Library/Python/2.5/site-packages/nose-0.11.4-py2.5.egg/nose/importer.py", line 86, in importFromDir mod = load_module(part_fqname, fh, filename, desc) File "/Users/craigedmunds/Documents/Source/reciply/webapplication/trunk/tests/tests.py", line 5, in from application.models import * File "/Users/craigedmunds/Documents/Source/reciply/webapplication/trunk/application/models.py", line 4, in from ragendja.auth.hybrid_models import User File "/Users/craigedmunds/Documents/Source/reciply/webapplication/trunk/common/appenginepatch/ragendja/auth/hybrid_models.py", line 3, in from ragendja.auth.google_models import GoogleUserTraits File "/Users/craigedmunds/Documents/Source/reciply/webapplication/trunk/common/appenginepatch/ragendja/auth/google_models.py", line 5, in from ragendja.auth.models import EmailUserTraits File "/Users/craigedmunds/Documents/Source/reciply/webapplication/trunk/common/appenginepatch/ragendja/auth/models.py", line 1, in from django.contrib.auth.models import * File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/dist/py_zipimport.py", line 213, in load_module exec code in mod.__dict__ File "/Users/craigedmunds/Documents/source/reciply/webapplication/trunk/common/zip-packages/django-1.1.zip/django/contrib/auth/models.py", line 457, in User = cache.app_models['auth']['user'] = module.User AttributeError: 'module' object has no attribute 'User' -------------------- >> begin captured logging > end captured logging > ignored When using the standard python unit test framework: /System/Library/Frameworks/Python.framework/Versions/2.5/bin/python2.5 /Applications/PyCharm-97.8.app/helpers/pycharm/utrunner.py /Users/craigedmunds/Documents/source/reciply/webapplication/trunk/tests// Testing started at 9:22 PM ... Traceback (most recent call last): File "/Applications/PyCharm-97.8.app/helpers/pycharm/utrunner.py", line 58, in modules = loadModulesFromFolderRec(a[0]) File "/Applications/PyCharm-97.8.app/helpers/pycharm/utrunner.py", line 42, in loadModulesFromFolderRec os.path.walk(folder, walkModules, modules) File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/posixpath.py", line 290, in walk func(arg, top, names) File "/Applications/PyCharm-97.8.app/helpers/pycharm/utrunner.py", line 38, in walkModules modules.append(loadSource(os.path.join(dirname, name))) File "/Applications/PyCharm-97.8.app/helpers/pycharm/utrunner.py", line 31, in loadSource module = imp.load_source(moduleName, fileName) File "/Users/craigedmunds/Documents/source/reciply/webapplication/trunk/tests//tests.py", line 6, in from application.models import * File "/Users/craigedmunds/Documents/Source/reciply/webapplication/trunk/application/models.py", line 4, in from ragendja.auth.hybrid_models import User ImportError: No module named ragendja.auth.hybrid_models Process finished with exit code 1 Empty test suite.
