[site]: datascience
[post_id]: 45941
[parent_id]: 
[tags]: 
Keras value error: Operands could not be broadcast with with shapes(100,100) - GRU

I am trying to use Hierarchical Attention Networks for classification of news articles using 20 newsgroup dataset that i downloaded from the internet. I came across this code of the implementation and tried using it on 20 newsgroup dataset as i was curious to see the results and couldn't hold back. Like he showed in the example i followed same steps and got the error "ValueError: Operands could not be broadcast together with shapes (100, 200) (None, Elemwise{mul,no_inplace}.0)". I have never used keras,can anyone help me with what is wrong with the dimensions of the word encoding and sentence encoding. import re import numpy as np import pandas as pd import sys import os from keras.preprocessing.text import Tokenizer from keras.preprocessing.sequence import pad_sequences from keras.callbacks import ModelCheckpoint from keras.utils import to_categorical from nltk.tokenize import sent_tokenize from sklearn.model_selection import train_test_split from keras_han.model import HAN MAX_WORDS_PER_SENT = 100 MAX_SENT = 15 MAX_VOC_SIZE = 20000 GLOVE_DIM = 100 TEST_SPLIT = 0.2 def remove_quotations(text): text = re.sub(r"\\", "", text) text = re.sub(r"\'", "", text) text = re.sub(r"\"", "", text) text = re.sub(r"[^A-Za-z0-9]+", " ", text) return text def remove_html(text): tags_regex = re.compile(r' ') return tags_regex.sub('', text) print('Processing text dataset') TEXT_DATA_DIR = "E:/Thesis/20news-bydate-test" df = pd.DataFrame(columns=['Text','Labels']) texts = [] # list of text samples labels_index = {} # dictionary mapping label name to numeric id labels = [] # list of label ids for name in sorted(os.listdir(TEXT_DATA_DIR)): path = os.path.join(TEXT_DATA_DIR, name) if os.path.isdir(path): label_id = len(labels_index) labels_index[name] = label_id for fname in sorted(os.listdir(path)): if fname.isdigit(): fpath = os.path.join(path, fname) if sys.version_info Here is the Stack trace:
