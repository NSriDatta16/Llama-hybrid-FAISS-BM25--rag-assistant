[site]: stackoverflow
[post_id]: 4821886
[parent_id]: 4821509
[tags]: 
I would use the following two-pass approach : $vAverage)"> when applied on the provided XML document : 1 2 3 3 1 5 3 3 5 3 6 5 3 3 5 3 7 5 33 4 5 34 3 5 5 1 2 3 3 9 5 3 2 3 3 5 the wanted, correct result is produced : 1 2 3 3 1 5 3 3 5 3 6 5 3 3 5 3 7 5 5 1 2 3 3 9 5 3 2 3 3 5
