[site]: crossvalidated
[post_id]: 202331
[parent_id]: 
[tags]: 
PACF MA(1) via correlation of prediction errors

It is known (see e.g., Brockwell and Davis, Introduction to Time Series and Forecasting, p. 95 ) that the $h$th partial autocorrelation $\phi_{hh}$ of a stationary process can be derived by first finding the prediction errors of $Y_h$ given $Y_{h-1},\ldots,Y_1$ and of $Y_0$ given $Y_{h-1},\ldots,Y_1$, and then finding the correlation of the prediction errors. (The second errors are thus "backcast" errors resulting from predicting $Y_0$ by future $Y_t$.) (Note that I am aware that we may also compute $\phi_{hh}$ as the last element of $\Gamma^{-1}\widetilde\gamma_h$ where $\Gamma$ is the Toeplitz matrix of the autocovariances $\gamma_0,\ldots,\gamma_{h-1}$ and $\widetilde\gamma_h=(\gamma_1,\ldots,\gamma_{h})'$, but that is not the point of the question.) I want to verify this for $h=2$ for the MA(1) case $Y_t=\epsilon_t+\theta\epsilon_{t-1}$, where we know that the second partial autocorrelation is $$ \phi_{22}=-\frac{\theta^2}{1+\theta^2+\theta^4} $$ So for $h=2$ I find the optimal prediction of $Y_2$ given $Y_1$ to be $Y_2^1=\rho Y_1$ (see e.g. slides 12-16 here ), where $$ \rho=\frac{\theta}{1+\theta^2} $$ is the autocorrelation. Likewise, $Y_0^1=\rho Y_1$. Plugging in for the $Y_t$ yields prediction errors \begin{align*} Y_2-Y_2^1&=\epsilon_2+\theta\epsilon_{1}-\frac{\theta}{1+\theta^2}\left(\epsilon_{1}+\theta\epsilon_{0}\right)\\ &=\epsilon_2+\frac{\theta^3}{1+\theta^2}\epsilon_1-\frac{\theta^2}{1+\theta^2}\epsilon_0 \end{align*} and likewise \begin{align*} Y_0-Y_0^1&=\epsilon_0+\theta\epsilon_{-1}-\frac{\theta}{1+\theta^2}\left(\epsilon_{1}+\theta\epsilon_{0}\right)\\ &=-\frac{\theta}{1+\theta^2}\epsilon_1+\frac{1}{1+\theta^2}\epsilon_{0}+\theta\epsilon_{-1} \end{align*} Some manipulation then gives me \begin{align*} Corr(Y_2-Y_2^1,Y_0-Y_0^1)&=Corr\left(\frac{\theta^3}{1+\theta^2}\epsilon_1-\frac{\theta^2}{1+\theta^2}\epsilon_0,-\frac{\theta}{1+\theta^2}\epsilon_1+\frac{1}{1+\theta^2}\epsilon_{0}\right)\\ &=-\frac{\theta^4}{(1+\theta^2)^2}-\frac{\theta^2}{(1+\theta^2)^2}\\ &=-\frac{\theta^2(1+\theta^2)}{(1+\theta^2)^2}\\ &=-\frac{\theta^2}{1+\theta^2}, \end{align*} which evidently is not the correct result. Is it an algebraic mistake, a misunderstanding of this approach to compute $\phi_{22}$ or some intermediate mistake in implementing, e.g., backcasting?
