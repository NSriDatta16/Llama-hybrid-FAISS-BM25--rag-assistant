[site]: stackoverflow
[post_id]: 4764770
[parent_id]: 
[tags]: 
How to convert a DBNULL to double?

im getting a value from the database. it came out an error saying "Conversion from DBNULL to Double is not Valid." anyone, pls help me? Public Function Total() As Double Dim Total As Double Dim strConn As String strConn = ConfigurationManager.ConnectionStrings("***").ToString Dim conn As New SqlConnection(strConn) Dim strSql As String strSql = "SELECT SUM (p.Price * c.Quantity) as 'Total' " & _ "FROM CartItem sci INNER JOIN Product p ON c.ProductID=p.ProductID " & _ "WHERE c.CartID=@CartID " Dim cmd As New SqlCommand(strSql, conn) cmd.Parameters.AddWithValue("@CartID", CartID) Dim da As New SqlDataAdapter(cmd) Dim ds As New DataSet conn.Open() da.Fill(ds, "CartItem") conn.Close() If (ds.Tables("CartItem").Rows.Count) <> 0 Then **Total = ds.Tables("ShopCartItem").Rows(0)("Total")** Else Total = 0.0 End If Return Total End Function
