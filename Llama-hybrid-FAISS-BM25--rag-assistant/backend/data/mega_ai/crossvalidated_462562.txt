[site]: crossvalidated
[post_id]: 462562
[parent_id]: 461943
[tags]: 
You don't really provide much to go with here. For example you say the periodicity is monthly but there's nothing in the model to account for any seasonal effect, and you conflate LOCATION , COUNTRY , and "location". Also, what's X ? If LOCATION indexes the subjects that are measured over time, you could imagine having the smooth equivalent of random trends (slopes) for each LOCATION rather than having them grouped at the COUNTRY level as you have here. gamm(Y ~ X + s(time) + s(time, LOCATION, bs = 'fs') data = dat, correlation = corAR1(form = ~ 1 | LOCATION), method = "REML", ...) Would give a similar model to your's, but with smooth trends for each LOCATION instead of COUNTRY , with the s(time) term representing the average trend over all observations. The random intercept is contained in the random smooth of time for LOCATION s, so you don't need a separate random effect smooth just for LOCATION . If you are going to use a factor by term then you should also include COUNTRY (the factor) in the model as a fixed (or random effect), so i would suggest you add + COUNTRY to your model if you want smooth trends at the COUNTRY level. Also, to fit models with correlation structures via argument correlation and using corAR1() you have to use the gamm() function. You can fit a nested AR(1) with bam() but you have to specify the $\rho$ you want, as it won't be estimated. In the corAR1() you should perhaps consider passing it an integer time variable rather than relying on the order of the data in dat .
