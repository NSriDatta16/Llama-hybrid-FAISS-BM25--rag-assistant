[site]: crossvalidated
[post_id]: 626550
[parent_id]: 
[tags]: 
SMC sampler weights when $K_n$ leaves $\pi_{n-1}$ invariant

I cannot seem to find this proof anywhere. Suppose I choose $K_n$ to leave $\pi_{n-1}$ invariant, and $L_{n-1}$ to be the reversal kernel. I want to show that the incremental weights $$ w_n(x_{n-1}, x_n) = \frac{\pi_n(dx_n) L_{n-1}(x_n, dx_{n-1})}{\pi_{n-1}(dx_{n-1})K_n(x_{n-1}, dx_n)} = \frac{\pi_n(x_{n-1})}{\pi_{n-1}(x_{n-1})}. $$ Attempt Invariance $K_n$ leaving $\pi_{n-1}$ invariant means $$ \pi_{n-1}K_n = \pi_{n-1} $$ This is known as "global balance". Reversibility In MCMC context, usually one cannot verify global balance directly. Instead, one makes sure that $K_n$ is $\pi_{n-1}$ -reversible, which is a much stronger condition. $$ \pi_{n-1}(dx_{n-1}) K_n(x_{n-1}, dx_n) = \pi_{n-1}(dx_n) K_n(x_n, dx_{n-1}). $$ This is known as "detailed balance", or "local balance". It is easy to show that detailed balance implies global balance. Reversal $L_{n-1}$ being the reversal kernel of $K_n$ means $$ \pi_{n-1}(dx_{n-1}) K_n(x_{n-1}, dx_n) = \pi_n(dx_n) L_{n-1}(x_n, dx_{n-1}) $$ "Wrong" Proofs Using only $L_{n-1}$ reversal : If I use directly the fact that $L_{n-1}$ is the reversal kernel, I get constant incremental weights $$ w_n(x_{n-1}, x_n) = \frac{\pi_{n-1}(dx_{n-1})K_n(x_{n-1}, dx_n)}{\pi_{n-1}(dx_{n-1})K_n(x_{n-1}, dx_n)} = 1 $$ Using $L_{n-1}$ reversal and reversibility : Perhaps, I'm thinking, people write $K_n$ leaving $\pi_{n-1}$ invariant, but they actually mean $K_n$ being $\pi_{n-1}$ -reversible. In that case, using these two conditions together leads to $$ w_n(x_{n-1}, x_n) = \frac{\pi_{n-1}(dx_n)K_n(x_n, dx_{n-1})}{\pi_{n-1}(dx_{n-1}) K_n(x_{n-1}, dx_n)}$$ which seems wrong. Feynman-Kac : Integrating $x_{n-1}$ out of the two-step Feyman-Kac formula we get an expression for $\pi_n$ $$\pi_n(dx_n) = \int_{x_{n-1}\in X} w_n(x_{n-1}, x_n) \pi_{n-1}(dx_{n-1}) K_n(x_{n-1}, dx_n)$$ an alternative expression is given by the change of variables $$\pi_n(dx_n) = \frac{\pi_n(dx_n)}{\pi_{n-1}(dx_n)} \pi_{n-1}(dx_n)$$ Assuming $K_n$ leaves $\pi_{n-1}$ invariant we get $$ \begin{align} \pi_n(dx_n) &= \frac{\pi_n(dx_n)}{\pi_{n-1}(dx_n)} \pi_{n-1}(dx_n) \\ &= \frac{\pi_n(dx_n)}{\pi_{n-1}(dx_n)} \pi_{n-1} K_n(dx_n) \\ &= \frac{\pi_n(dx_n)}{\pi_{n-1}(dx_n)} \int_{x_{n-1}\in X} \pi_{n-1}(dx_{n-1}) K_n(x_{n-1}, dx_n) \\ &= \int_{x_{n-1}\in X} \frac{\pi_n(dx_n)}{\pi_{n-1}(dx_n)} \pi_{n-1}(dx_{n-1}) K_n(x_{n-1}, dx_n). \end{align} $$ where we can identify $$ w_n(x_{n-1}, x_n) = \frac{\pi_n(x_n)}{\pi_{n-1}(x_n)}, $$ which is different from what has been suggested in the literature. Only proof I could find The only proof I could generate assumes $K_n$ leaves $\pi_n$ invariant, and not $\pi_{n-1}$ . In that case, $L_{n-1}$ being the reversal of $K_n$ means $$ \pi_n(dx_{n-1}) K_n(x_{n-1}, dx_n) = \pi_n(dx_n) L_{n-1}(x_n, dx_{n-1}). $$ Plugging this into the expression for the incremental weights lead to the correct incremental weight $$ w_n(x_{n-1}, x_n) = \frac{\pi_n(x_{n-1})}{\pi_{n-1}(x_{n-1})}. $$
