[site]: crossvalidated
[post_id]: 347804
[parent_id]: 
[tags]: 
Low-variance estimate for the mean of the sotfmax transformation of a variable

Consider a set of infintiely-differentiable convex functions real-valued functions $f_i: \mathcal X \rightarrow \mathbb R$, where $i$ varies from $1$ to $m$, and suppose we know all the moments of $f_i(x)$ (and of all the derivatives of $f_i$) for all $i$, as $x$ is sampled from some distribution $P$ on a Hilbert space $\mathcal X$. Question: What is a low-variance estimate for the quantities $$\mathbb E_{x \sim P}\left[\frac{\exp(f_i(x))}{\sum_{j=1}^m\exp(f_j(x))}\right] ?$$ Particular case: For simplicity, take $f_i(x) \equiv \|x-a_i||_2^2 + b_i$, for some vectors $a_1,\ldots,a_m \in \mathcal X$ and scalars $b_1,\ldots,b_m \in \mathbb R$.
