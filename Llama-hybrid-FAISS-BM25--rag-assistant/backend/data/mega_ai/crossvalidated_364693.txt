[site]: crossvalidated
[post_id]: 364693
[parent_id]: 364421
[tags]: 
The problem This Markov chain has three states, distinguished by whether the worm is $0,$ $1,$ or $2$ spaces away from $C.$ Let $X_i$ be the random variable giving how many steps the worm will take to reach $C$ from state $i\in\{0,1,2\}.$ Their probability generating functions are a convenient algebraic way to encode the probabilities of these variables. It is unnecessary to worry about analytic issues like convergence: just view them as formal power series in a symbol $t$ given by $$f_i(t) = \Pr(X_i=0) + \Pr(X_i=1)t^1 + \Pr(X_i=2)t^2 + \cdots + \Pr(X_i=n)t^n + \cdots$$ Since $\Pr(X_0=0)=1,$ it is trivial that $f_0(t)=1.$ We need to find $f_2.$ Analysis and solution From state $1,$ the worm has equal chances of $1/2$ of moving back to state $2$ or reaching $C$. Accounting for taking this one step adds $1$ to all powers of $t$, tantamount to multiplying the pgf by $t$, giving $$f_1 = \frac{1}{2}t\left(f_2 + f_0\right).$$ Similarly, from state $2$ the worm has equal chances of staying in state $2$ or reaching state $1,$ whence $$f_2 = \frac{1}{2}t\left(f_2 + f_1\right).$$ The appearance of $t/2$ suggests our work will be made easier by introducing the variable $x=t/2,$ giving $$f_1(x) = x(f_2(x) + f_0(x));\quad f_2(x) = x(f_2(x) + f_1(x)).$$ Substituting the first into the second and recalling $f_0=1$ gives $$f_2(x) = x(f_2(x) + x(f_2(x) + 1))\tag{*}$$ whose unique solution is $$f_2(x) = \frac{x^2}{1 - x - x^2}.\tag{**}$$ I highlighted the equation $(*)$ to emphasize its basic simplicity and its formal similarity to the equation we would obtain by analyzing only the expected values $E[X_i]:$ in effect, for the same amount of work it takes to find this one number, we get the entire distribution. Implications and simplification Equivalently, when $(*)$ is written out term-by-term and the powers of $t$ are matched it asserts that for $n\ge 4,$ $$2^n\Pr(X_2=n) = 2^{n-1}\Pr(X_2=n-1) + 2^{n-2}\Pr(X_2=n-2).$$ This is the recurrence for the famous sequence of Fibonacci numbers $$(F_n) = (1,1,2,3,5,8,13,21,34,55,89,144,\ldots)$$ (indexed from $n=0$). The solution matching $(**)$ is this sequence shifted by two places (because there is no probability that $X_2=0$ or $X_2=1$ and it is easy to check that $2^2\Pr(X_2=2)=1=2^3\Pr(X_2=3)$). Consequently $$\Pr(X_2 = n) = 2^{-n-2}F_{n-2}.$$ More specifically, $$\eqalign{ f_2(t) &= 2^{-2}F_0t^2 + 2^{-3}F_1 t^3 + 2^{-4} F_2 t^4 + \cdots \\ &= \frac{1}{4}t^2 + \frac{1}{8}t^3 + \frac{2}{16}t^4 + \frac{3}{32}t^5 + \frac{5}{64}t^6 + \frac{8}{128}t^7 +\frac{13}{256}t^8 + \cdots. }$$ The expectation of $X_2$ is readily found by evaluating the derivative $f^\prime$ and substituting $t=1,$ because (differentiating the powers of $t$ term by term) this gives the formula $$f^\prime(1) = \Pr(X_2=0)(0) + \Pr(X_2=1)(1)1^0 + \cdots + \Pr(X_2=n)(n)1^{n-1} + \cdots$$ which, as the sum of the probabilities times the values of $X_2,$ is precisely the definition of $E[X_2].$ Taking the derivative using $(**)$ produces a simple formula for the expectation. Some brief comments By expanding $(**)$ as partial fractions, $f_2$ can be written as the sum of two geometric series. This immediately shows the probabilities $\Pr(X_2=n)$ will decrease exponentially. It also yields a closed form for the tail probabilities $\Pr(X_2 \gt n).$ Using that, we can quickly compute that $\Pr(X_2 \ge 100)$ is a little less than $10^{-9}.$ Finally, these formulas involve the Golden Ratio $\phi = (1 + \sqrt{5})/2.$ This number is the length of a chord of a regular pentagon (of unit side), yielding a striking connection between a purely combinatorial Markov chain on the pentagon (which "knows" nothing about Euclidean geometry) and the geometry of a regular pentagon in the Euclidean plane.
