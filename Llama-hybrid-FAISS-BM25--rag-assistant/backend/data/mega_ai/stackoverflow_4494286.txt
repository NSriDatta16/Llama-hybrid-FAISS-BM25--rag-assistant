[site]: stackoverflow
[post_id]: 4494286
[parent_id]: 
[tags]: 
How to programmatically do a switch user on macosx

I am working on a security agent plugin on Mac OS X and would like to allow the user to do a switch user (in the same way of the button "switch user" that is displayed when you lock your account). After some research, I found this thread with the following solution from the command line: /System/Library/CoreServices/Menu\ Extras/User.menu/Contents/Resources/CGSession -suspend Launching this command line works well when the user is logged in. However, in the context of a Security Agent plugin: "The Security Agent runs with restricted permissions so that the user must be physically present, using the graphical user interface, in order to be authenticated. The graphical user interface elements canâ€™t be used through a command-line interface such as the Terminal application or a secure shell (ssh) remote session" So the command line call fails to execute. Is there any other solution to simulate a switch user, like sending an apple event? I didn't find any other solution. Thanks in advance for any idea. Best regards
