[site]: crossvalidated
[post_id]: 594392
[parent_id]: 
[tags]: 
Post-hoc pairwise comparison in `anova.cca` (package `vegan`)

Is there a way to perform a post-hoc pairwise comparison following anova.cca , for categorical independent variables with >2 levels, in the same sense as TukeyHSD following aov ? For example, please consider the following result (modified from vegan documentation): library(vegan) data(dune) data(dune.env) fit = cca(dune ~ Management, dune.env) anova(fit, by = "terms") ## Permutation test for cca under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 999 ## ## Model: cca(formula = dune ~ Management, data = dune.env) ## Df ChiSquare F Pr(>F) ## Management 3 0.60384 2.1307 0.002 ** ## Residual 16 1.51143 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 According to the output, we conclude that the effect of Management on species composition in dune is significant. However, what is we want to furthermore evaluate whether the pairwise differences between levels of Management dune.env$Management ## [1] SF BF SF SF HF HF HF HF HF BF BF SF SF NM NM SF NM NM NM NM ## Levels: BF HF NM SF are significant? That is, whether species composition differs between BF and HF , between BF and NM , etc., for all possible pairs of the four Management levels? This answer: Constrained ordination (CAP) pairwise ANOVA by vegan package author offers (in "Third alternative") a promising pathway, using model.matrix to generate dummy variables for the pairwise comparisons and then using them as independent variables, as in: dune.env2 = data.frame(model.matrix(~ Management, data=dune.env)) fit = cca(dune ~ ., dune.env2) anova(fit, by = "terms") ## Permutation test for cca under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 999 ## ## Model: cca(formula = dune ~ X.Intercept. + ManagementHF + ManagementNM + ManagementSF, data = dune.env2) ## Df ChiSquare F Pr(>F) ## ManagementHF 1 0.14772 1.5638 0.121 ## ManagementNM 1 0.28927 3.0622 0.002 ** ## ManagementSF 1 0.16685 1.7663 0.050 * ## Residual 16 1.51143 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 which suggests that species composition in BF differs from NM and SF , but not from species composition in HF . My questions thus are: Is the above solution correct? Would it be correct to repeat it (three more times, in this case) to obtain the significance of the pairwise comparisons against each of the possible "reference" levels other than BF ? If not, is there another way to obtain pairwise comparisons following anova.cca ?
