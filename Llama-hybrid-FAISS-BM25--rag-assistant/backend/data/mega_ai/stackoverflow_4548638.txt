[site]: stackoverflow
[post_id]: 4548638
[parent_id]: 
[tags]: 
Django beginner: How to query in django ORM to calculate fields based on dates

Task: Querying a model in Django ORM so that I can calculate fields based on dates. Specifically, extract months from a model.datefield and calculate values based on these months. Example model: class PersonProjectHours(models.Model): project = models.ForeignKey('projects.Project') person = models.ForeignKey('projects.Person') rate = models.ForeignKey('PersonIncome') work_date = models.DateField(help_text=_('Enter date')) hours = models.IntegerField(help_text=_('Enter hours worked on this day.')) class PersonIncome(models.Model): person = models.ForeignKey('projects.Person') income = models.DecimalField(help_text=_('Enter new income'), max_digits=10, decimal_places=2) validdate = models.DateField(help_text=_('Enter date from which new income is valid.')) In my views.py, I can extract the months and hours worked per month like this (I use a range because I couldn't figure out how to query for month in months in ORM). And I can calculate the cost of the hours worked by the different people who worked on the project by looping through the entries in each month (just doesn't work right now because entry.rate is a unicode and I somehow can't covert it to an integer...): for month in range(1, 13): entries_per_month = PersonProjectHours.objects.filter(work_date__month=month) hours = entries_per_month.aggregate(value=Sum('hours')) cost = 0 for entry in entries_per_month: cost = cost + (entry.hours * entry.rate) work_per_year.append([month,hours,cost]) Just to complete this example, I loop through the entries in my templates like this: {% for month, hours, cost in work_per_year %} {{ month }} {{ hours.value }} {{ cost }} {% endfor %} What I have done in views.py doesn't seem very elegant, is there a better way to pull date ranges like years, months or days from datefields? And on the sidelines, how do I get entry.rate to be an integer I can calculate? Thanks for your input! (yes, I am very new to coding, python, and django... took me a week to write this up) :-)
