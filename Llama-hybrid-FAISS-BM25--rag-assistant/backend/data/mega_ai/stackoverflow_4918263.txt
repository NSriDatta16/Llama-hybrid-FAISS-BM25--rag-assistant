[site]: stackoverflow
[post_id]: 4918263
[parent_id]: 4918137
[tags]: 
I'd have the counter be updated every time through the loop, then periodically have something read that and update the database. That makes a simpler main loop because it doesn't have to pay attention to how long it's needed to wait before exporting the value. And, it's very common and normal to have a periodic task that samples a value and does something with it. Creating a simple socket would work well. Ruby's Socket code RDoc has some samples for echo servers that might get you started.
