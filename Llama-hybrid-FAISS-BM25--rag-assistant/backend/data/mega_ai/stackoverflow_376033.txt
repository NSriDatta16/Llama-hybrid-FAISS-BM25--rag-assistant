[site]: stackoverflow
[post_id]: 376033
[parent_id]: 375895
[tags]: 
What about this: Store XML as your fragment: Pull it out, replace the placeholders with the "real" strings (that you have carefully XML-escaped of course), ...and use a simple XML transformation to produce HTML output: Other fragment types could be added because of the type attribute. There is much room to improve this, so look at it as an example of how it could be done. Output: %CAPTIONTEXT% and, if the link href is empty in the XML: %CAPTIONTEXT%
