[site]: stackoverflow
[post_id]: 2535607
[parent_id]: 
[tags]: 
How to use Java on Google App Engine without exceeding minute quotas?

A very simple java code inside a doGet() servlet is getting more than a second of cpu time on GAE. I have read some quota related documentation and apparently I am not doing anything wrong. //Request the user Agent info String userAgent = req.getHeader("User-Agent"); I wanted to know what was using the CPU the most, I use a google help recommendation. //The two lines below will get the CPU before requesting User-Agent Information QuotaService qs = QuotaServiceFactory.getQuotaService(); long start = qs.getCpuTimeInMegaCycles(); //Request the user Agent info String userAgent = req.getHeader("User-Agent"); //The three lines below will get the CPU after requesting User-Agent Information // and informed it to the application log. long end = qs.getCpuTimeInMegaCycles(); double cpuSeconds = qs.convertMegacyclesToCpuSeconds(end - start); log.warning("CPU Seconds on geting User Agent: " + cpuSeconds); The only thing that the code above tells me is that inspecting the header will use more than a second (1000ms) of cpu time, which for Google is a warning on the log panel. That seems to be a very simple request and still is using more than a second of cpu. What I am missing? Below the image of the logs for everyone's entertainment. I am posting the full code, for the benefit of all. @SuppressWarnings("serial") public class R2CComingSoonSiteServlet extends HttpServlet { private static final Logger log = Logger.getLogger(R2CComingSoonSiteServlet.class.getName()); public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException { //The two lines below will get the CPU before requesting User-Agent Information QuotaService qs = QuotaServiceFactory.getQuotaService(); long start = qs.getCpuTimeInMegaCycles(); //Request the user Agent info String userAgent = req.getHeader("User-Agent"); //The three lines below will get the CPU after requesting User-Agent Information // and informed it to the application log. long end = qs.getCpuTimeInMegaCycles(); double cpuSeconds = qs.convertMegacyclesToCpuSeconds(end - start); log.warning("CPU Seconds on geting User Agent: " + cpuSeconds); userAgent = userAgent.toLowerCase(); if(userAgent.contains("iphone")) resp.sendRedirect("/mobIndex.html"); else resp.sendRedirect("/index.html");} }
