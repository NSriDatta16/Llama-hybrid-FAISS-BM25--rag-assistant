[site]: crossvalidated
[post_id]: 433977
[parent_id]: 433635
[tags]: 
I will give a proof for a general GMM test statistic of overidentifying restrictions, which evaluates the GMM criterion function at the GMM estimate. The Sargan statistic is a special case of this statistic under conditional homoskedasticity. The notation and exposition follow Hayashi (2000) Econometrics, so that, unlike in your question, instruments are denoted by $X$ (there are $K$ of them) and regressors by $Z$ (there are $L$ of them). $S_{xz}$ etc. are then corresponding sample moment matrices. $\widehat{\delta}_{GMM}$ is the GMM estimate of the true coefficient $\delta$ . $\widehat{S}^{-1}$ is the efficient weighting matrix. $g_i(\tilde{\delta}):=x_{i}(y_i-z_i'\tilde{\delta})$ and $g_n(\tilde{\delta})=\frac{1}{n}\sum_{i=1}^{n}g_{i}(\tilde{\delta})$ \begin{equation*} J\bigl(\widehat{\delta}_{GMM},\widehat{S}^{-1}\bigr)\to_d\chi^{2}(K-L). \end{equation*} Proof: First, note that \begin{eqnarray*} g_n(\widehat{\delta}_{GMM})&=&s_{xy}-S_{xz}\widehat{\delta}_{GMM}\\ &=&s_{xy}-S_{xz}(S_{xz}'\widehat{S}^{-1}S_{xz})^{-1}S_{xz}'\widehat{S}^{-1}s_{xy}\\ &=&\bigl(I-S_{xz}(S_{xz}'\widehat{S}^{-1}S_{xz})^{-1}S_{xz}'\widehat{S}^{-1}\bigr)s_{xy}\\ &=:&\widehat{B}s_{xy} \end{eqnarray*} Further, \begin{eqnarray} \widehat{B}s_{xy}&=&(I-S_{xz}(S_{xz}'\widehat{S}^{-1}S_{xz})^{-1}S_{xz}'\widehat{S}^{-1})s_{xy}\notag\\ &=&(I-S_{xz}(S_{xz}'\widehat{S}^{-1}S_{xz})^{-1}S_{xz}'\widehat{S}^{-1})(S_{xz}\delta+g_n(\delta))\notag\\ &=&\underbrace{(S_{xz}-S_{xz}\underbrace{(S_{xz}'\widehat{S}^{-1}S_{xz})^{-1}S_{xz}'\widehat{S}^{-1}S_{xz}}_{I})}_{0}\delta+\widehat{B}g_n(\delta)\notag\\ &=&\widehat{B}g_n(\delta)\label{bgndelta} \end{eqnarray} Using the decomposition $\widehat{S}^{-1}=C'C$ we obtain $\widehat{B}'\widehat{S}^{-1}\widehat{B}=(C\widehat{B})'(C\widehat{B})$ . Now, \begin{eqnarray*} C\widehat{B}&=&C(I-S_{xz}(S_{xz}'\widehat{S}^{-1}S_{xz})^{-1}S_{xz}'\widehat{S}^{-1})\\ &=&C-CS_{xz}(S_{xz}'C'CS_{xz})^{-1}S_{xz}'C'C\\ &=&C-A(A'A)^{-1}A'C\\ &=&(I-A(A'A)^{-1}A')C\\&=:&MC, \end{eqnarray*} where $A:=CS_{xz}$ and, as usual, $M$ is symmetric and idempotent, so that \begin{equation}\label{Jtestproof3} \widehat{B}'\widehat{S}^{-1}\widehat{B}=C'M'MC=C'MC. \end{equation} Then, \begin{eqnarray*} tr(M)&=&tr(I-A(A'A)^{-1}A')\\&=&K-tr((A'A)^{-1}A'A)\\ &=&K-tr(I_L)\\&=&K-L. \end{eqnarray*} Now, take $D'D=S^{-1}$ so that $C\to_pD$ . With the baseline assumption that, at true value, the sample moment conditions satisfying a CLT, $\sqrt{n}g_n(\delta)\to_dN(0,S)$ it holds that \begin{eqnarray} C\sqrt{n}g_n(\delta)&\to_d&N(0,DSD')\notag\\&=&N(0,D(D'D)^{-1}D')\notag \\&=&N(0,DD^{-1}D'^{-1}D')\notag \\&=&N(0,I)\label{hansenovern} \end{eqnarray} Hence, \begin{eqnarray} J\bigl(\widehat{\delta}_{GMM},\widehat{S}^{-1}\bigr)&=&n\cdot g_n(\widehat{\delta}_{GMM})'\widehat{S}^{-1}g_n(\widehat{\delta}_{GMM})\notag\\ &=&n\cdot g_n(\delta)'\widehat{B}'\widehat{S}^{-1}\widehat{B}g_n(\delta)\notag\\ &=&n\cdot g_n(\delta)'C'MCg_n(\delta)\notag\\ &=&\sqrt{n}\cdot(Cg_n(\delta))'M\sqrt{n}Cg_n(\delta)\label{hansenoveridasy} \end{eqnarray} Thus, this is asymptotically is a quadratic form in normally distributed vectors and an idempotent matrix $M$ with $tr(M)=rk(M)=K-L$ . Thus, (see e.g. Thm. A.87 in Toutenburg and Rao (1999) Linear Models: Least Squares and Alternatives) $$J\bigl(\widehat{\delta}_{GMM},\widehat{S}^{-1}\bigr)\to_d\chi^{2}(K-L) $$
