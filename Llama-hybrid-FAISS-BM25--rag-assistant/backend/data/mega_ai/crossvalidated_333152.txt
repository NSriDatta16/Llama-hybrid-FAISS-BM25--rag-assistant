[site]: crossvalidated
[post_id]: 333152
[parent_id]: 
[tags]: 
Convergence and acceptance rate in MCMC

I am trying to fit a cubeoid to data approximately containing one (or many) 2D sigmoids using MCMC. Assuming trying to fit one model cuboid, it has 5 parameters: position, size and height. $$\theta = \{x,y,dx,dy,h\}$$ My likelihood function is assumed to be inversely proportional to the absolute height difference between data and model. Due to all parameters being positive my proposed parameter is a lognormal distribution with $\mu_i=\log(\theta_i)$ for $i=1,...,5$. I have also tried my likelihood being $\exp(-\Delta z)$ where $\Delta z$ is the sum of the absolute height differences with no improvement. With a small variance my acceptance ratio is close to one all the time, meaning that my algorithm is almost always accepting my proposed parameters. With larger variances the algorithm makes jumps around the parameter space without converging to place the cuboid in approximately the right place on one of the sigmoids in the data. How should I change my likelihood function or variances to make the algorithm converge? EDIT, additional information in matlab syntax. My variances: variances = [0.1 0.1 0.1 0.1 0.01]; Two of the tried likelihoods, where datasz is the size of data matrix in each dimension and the parameters is in the same order as $\theta$ above. Of course only one of the l is used at the time. yvec = round(parameters(2)-parameters(4):parameters(2)+parameters(4)); xvec = round(parameters(1)-parameters(3):parameters(1)+parameters(3)); l = datasz(1) * datasz(2) / sum(sum(abs(data-model))); % or l = 1/(2*sum(sum(abs(data(yvec,xvec)-model(yvec,xvec))))/(parameters(3)*parameters(4)*4) - (parameters(3)*parameters(4)*4)^0.1); My proposal distribution is lognormal and random('logn', $\mu$,$\sigma$) generates one sample from the lognormal distribution with $\mu$ and $\sigma$. param(1) = random('logn', log(parameters(1)), variances(1)); EDIT2, psuedo algorithm with data $D$. initalize $\theta_i$ giving model $M_i$. propose new parameters $\theta_p$ giving model $M_p$ calculate likelihood: $l = \frac{1}{|D-M|}$ for $i$ and $p$. acceptance ratio by $\alpha = min\{1, \frac{l_{p}}{l_{i}}\}$ if $u
