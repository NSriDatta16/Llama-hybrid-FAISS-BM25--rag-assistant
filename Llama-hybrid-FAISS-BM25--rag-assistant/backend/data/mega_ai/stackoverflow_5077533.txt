[site]: stackoverflow
[post_id]: 5077533
[parent_id]: 5077370
[tags]: 
I suggest starting with file scan_engine.cc from nmap source code; follow the isRawScan() function. My quick scan through the source seems to indicate that you need to create SOCK_RAW sockets and install a pcap packet capture filter to read the response packets. (Perhaps the pcap filter is just for convenience/speed sake, but if the nmap team decided to go this route, they probably had good reasons.)
