[site]: stackoverflow
[post_id]: 913788
[parent_id]: 
[tags]: 
Powershell being too clever

Apologies for what is probably a newbish question. I am writing some Powershell scripts that run various queries against AD. They will usually return a bunch of results, which are easy to deal with, ie: $results = myQuery write-host "Returned " + $results.Count + " results." foreach ($result in $results) { doSomething } No worries. However, if there is only 1 result, Powershell automagically translates that result into a single object, rather than an array that contains 1 object. So the above code would break, both at the Count and the foreach. I'm sure the same problem would occur with 0 results. Could someone suggest an elegant way to handle this? Perhaps some way to cast the results so they are always an array?
