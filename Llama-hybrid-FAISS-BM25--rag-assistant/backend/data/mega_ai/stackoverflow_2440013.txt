[site]: stackoverflow
[post_id]: 2440013
[parent_id]: 2439747
[tags]: 
EDIT: You can restrict the type of affiliation with intersects_with(&block) : has_permission_on [:organizations], :to => :edit do if_attribute :affiliations => intersects_with { user.affiliations.with_type_3 } end Why not create a named_scope to find affiliations whose affiliationtype_id = 3? From declarative_authorization documentation : To reduce redundancy in has_permission_on blocks, a rule may depend on permissions on associated objects: authorization do role :branch_admin do has_permission_on :branches, :to => :manage do if_attribute :managers => contains {user} end has_permission_on :employees, :to => :manage do if_permitted_to :manage, :branch # instead of #if_attribute :branch => {:managers => contains {user}} end end end
