[site]: crossvalidated
[post_id]: 574476
[parent_id]: 
[tags]: 
Multiplying (or averaging) effect of independent Bayes Factors

I want to know how to combine the effect of Bayes Factors calculated on subsets of a dataset. Note, this is not the case of replication BF, where I have, say a BF from a previous study (which acts now as a prior), and I do a new study and want to combine the prior and posterior BFs into a single one. Here I want to compose the BFs from different group subsets (or features) into a single BF on the entire sample. I am measuring a numeric variable (call it $x_i$ ) on observations $i$ , which depends on some group variable (call it $G_i$ ). Individuals $i$ belong to one of groups A, B, C... For simplicity, let's just use two groups, A and B. Each observation's, group membership $G_i\in\{A, B\}$ is independent of the others, and $x_i$ depends on $G_i$ only and not on the other $x$ s. Ex: I observe a set of males ( $G_i=A$ ) and females ( $G_i=B$ ) and the heights ( $x_i$ ) of the people. Each time there is a fixed probability of the person being male ( $\alpha$ ) or female ( $1-\alpha$ ). $x_i$ is modeled as $x_i \sim p(x\mid G_i)$ . Say there is a parameter of interest $\theta$ that is modeled separately for each group (e.g., the average height of individuals who are male or female). So if $G_i=A$ , $x_i\sim p(x\mid \theta_A)$ , otherwise $\sim p(x\mid \theta_B)$ . Let's say I have $n$ and $m$ observations of each group, respectively. The joint likelihood of $\{x_1,\dots,x_{n+m}\}$ and $\{G_1,\dots,G_{n+m}\}$ is thus: $(\prod_{i=1}^np(G_i=A)p(x_i\mid \theta_A))\times(\prod_{i=n+1}^{n+m}p(G_i=B)p(x_i\mid \theta_B))$ I am doing a Bayesian analysis, so my goal is to update the posteriors of $\theta_A$ and $\theta_B$ separately each time I see e.g. a male or a female. The posterior-prior ratio is $\frac{\prod_{i=1}^np(x_i\mid\theta^{post}_A)}{\prod_{i=1}^np(x_i\mid\theta^{prior}_A)}\times \frac{\prod_{i=n+1}^{n+m}p(x_i\mid\theta^{post}_B)}{\prod_{i=n+1}^{n+m}p(x_i\mid\theta^{prior}_B)}$ where the group probabilities cancel. Now, assume that the prior odds on each of $\theta_A$ and $\theta_B$ are 1. The two ratios above should be the Bayes Factor on $\theta_A$ and $\theta_B$ , respectively (call them $BF_A$ and $BF_B$ ). Recall that a BF=1 is equal likelihood to the prior and posterior (i.e., distribution hasn't changed). Now for the questions: Assuming my setup above is correct, say I am able to calculate $BF_A$ and $BF_B$ . I now want to calculate a single BF which combines the effects of the individual group BFs. If each BF indicates the probability that group $x$ distribution has changed vs the prior, I want this BF to measure the overall change in $x$ across all groups. From the above it seems (since the likelihood is decomposed as a product of the two group likelihoods) that likewise the overall BF is a product of the group BFs, without any weighting. In this article from 1995 ("Multiple Bayes Factors for Testing Hypotheses"; https://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476504?journalCode=uasa20 ), they formulate that each of these group BFs is a "partial BF", and they can be combined by taking their weighted harmonic mean (a way to take the average of things that are multiplied, like ratios), where the weights are the probabilities assigned to each group $A$ or $B$ . Say I just multiply them. Say that $BF_A=5$ and $BF_B=1$ . The product is unchanged by group $B$ . Now, say I had more than two groups, and say that each of their BFs were also 1 (e.g. $BF_C=BF_D=BF_E=1$ ), the product would be 1, but I would have expected that the additional evidence of multiple groups saying there is no change vs the prior would actually decrease the BF (e.g. to 2). The harmonic mean (since the weights would change with more groups) would do this, but not the straight multiplication. Now, say I in addition model the group probabilities $G$ (they are not fixed), as following a Dirichlet distribution with parameter $\Omega$ , and so the new likelihood ratio of the sample ( $G$ is now a variable) would be $\frac{\prod_{i=1}^np(x_i\mid\theta^{post}_A)}{\prod_{i=1}^np(x_i\mid\theta^{prior}_A)}\times \frac{\prod_{i=n+1}^{n+m}p(x_i\mid\theta^{post}_B)}{\prod_{i=n+1}^{n+m}p(x_i\mid\theta^{prior}_B)}\times\frac{\prod_{i=1}^{n+m}p(G_i\mid\Omega^{post})}{\prod_{i=1}^{n+m}p(G_i\mid\Omega^{prior})}$ This last ratio should be a new Bayes Factor for the groups only, let's call it $BF_G$ . Say I now wanted to combine $(BF_A,BF_B)$ and $BF_G$ into a new BF which took into account the effects of changes both in groups $G$ and in $x$ (which is affected by the changes in $G$ if the group $x$ distributions differ). That is, if my data has a higher ratio of males to females than expected under the prior, if men are taller on average, the distribution of $\{x_i\}$ should change as well to be higher. However, if there was no change in the parameter $\theta$ vs the prior, I would want this to only be reflected in $BF_G$ and not in $BF_A$ and $BF_B$ which should each be near 1. Similarly, if the group probabilities stay the same but the posterior height distributions differ from teh prior (i.e. $\theta_A^{post}\ne\theta_A^{prior}$ and/or $\theta_B^{post}\ne\theta_B^{prior}$ significantly), I want this reflected in $BF_A$ and/or $BF_B$ , but not in $BF_G$ , which should be near 1. How can I combine these new BFs for different features? For clarification: I am trying to do it this way because I am using an established technique that provides a BF on the group memberships (i.e. $BF_G$ ), and I am trying to extend it using a technique that can provide second BFs on $x$ for $A$ and $B$ that reflects the degree that each group posterior differs from the prior. But I can't figure out how to combine the BFs into a single one that will indicate that the posterior parameters overall differ from the prior.
