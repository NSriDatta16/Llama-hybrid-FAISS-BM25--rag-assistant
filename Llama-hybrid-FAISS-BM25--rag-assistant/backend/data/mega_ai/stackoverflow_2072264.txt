[site]: stackoverflow
[post_id]: 2072264
[parent_id]: 2072193
[tags]: 
The problem is that you're trying to use do -notation for Parser , but it's not exactly a Monad . It is sort of, because there's a Monad instance for r -> , but that makes the type on the right-hand side of the -> the "element" type of the Monad , and here you want the element type to be the a in [(a,String)] . You need to make the definition of Parser a newtype , and write a custom Monad instance for it (or compose it out of exising monads/transformers like ListT and StateT ).
