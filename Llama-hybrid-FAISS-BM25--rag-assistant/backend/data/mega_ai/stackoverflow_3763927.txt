[site]: stackoverflow
[post_id]: 3763927
[parent_id]: 3755303
[tags]: 
Read this question and answer first. Here's what's happening in your scenarios. "The install works fine for first-time users..." Actually, this would work for any user that went to the html page, not just first-time users. The html page has some script that checks their user-agent string for the 4.0 framework. If they don't have it, it gives them an explanation and tells them to install it from a link to the bootstrapper that Visual Studio created (setup.exe). This is all separate from ClickOnce; ClickOnce does nothing until they click on the link to the .application file or they run the setup.exe which launches the .application file when it finishes. "Users who already have the application installed and attempt to run it via the start menu..." What happens here, is that the application updates correctly. They get the latest version. Only they can't run the latest version because it's a .Net 4.0 executable and they don't have the 4.0 framework. At this point you have a few options... Live with it. Tell users they need to visit the html page to get the 4.0 Framework. Roll-back to 3.5 and add custom code to your app that checks whether 4.0 is installed or not, warns the user, and gives them a link to the new 4.0 setup.exe file. Then upgrade to 4.0 a few weeks later once people have had the chance to install it. This may not work well if your users only run the app occasionally. Roll-back to 3.5 and change your ClickOnce updates to happen after the application starts rather than before. This will give you the chance to write custom code to determine if the update can happen or not and tell the user.
