[site]: crossvalidated
[post_id]: 628938
[parent_id]: 628856
[tags]: 
Let's consider a simpler mixed effects model without an illness effect: (Illness varies within surgeon and so is irrelevant to the core of this question.) $$ Y_{ij} = \beta_0 + \beta_1\operatorname{I}_{h(i) = \text{right}} + \left(\epsilon_i + \epsilon_{ij}\right) $$ This model has an intercept, a fixed handedness effect $\beta_1$ (the expected difference in speed between a surgery performed by a right-handed surgeon and a left-handed one), random surgeon effects $\epsilon_i$ and residual effects (or errors) $\epsilon_{ij}$ . The $\beta$ coefficients specify $\operatorname{E}(Y)$ and the random effects (in parentheses) specify $\operatorname{Var}(Y)$ . The random variables $\epsilon_i$ are independent and identically distributed with zero mean and variance $\theta^2$ and the residuals are iid $\text{Normal}(0, \sigma^2)$ . The $\epsilon_i$ s and $\epsilon_{ij}$ s are also mutually independent. The definition of the random effects implies that in expectation half the left-handed surgeons have positive $\epsilon_i$ and the other half — negative $\epsilon_i$ . Same for the right-handed surgeons. (The $\epsilon_i$ s do not depend on handedness.) Since the average surgeon effect is 0 for both left-handed and right-handed surgeons, we can estimate the handedness effect even though handedness is a group-level variable (ie. each surgeon is either left-handed or right-handed): we calculate a (weighted) average of the observed speed of right handed surgeons and subtract from it a (weighted) average of the observed speed of left handed surgeons. Here the design is balanced — there are three observations from each surgeon and two surgeons in each group, so there is no need to weight the observations and we take the difference between the two simple averages. (Check that this calculation gives 15.5 - 9.33 = 6.17, the same coefficient estimate reported in the summary table.) This is the theory but then there is the practice of estimating the parameters: the coefficients $\beta=(\beta_0,\beta_1)$ and the variances $\theta^2$ and $\sigma^2$ . For the sample dataset of 4 surgeons with 3 observations per surgeon, the lme4::lmer fitting procedure estimates the surgeon variance $\theta$ as 0. It also prints a "singular fit" warning. This means that the surgeon variance $\theta^2$ is much smaller than the residual variance $\sigma^2$ and difficult to estimate with only 4 surgeons. A simulation may help to illustrate the theory. I use the lme4::simulate.merMod function to simulate $Y_{ij}$ for the 4 surgeon × 3 observations dataset. I specify $\theta = \sigma = 1$ and repeat the simulation three times. I show only the estimate random effects; keep in mind that the first and fourth surgeons are left handed and the second and third surgeons are right handed. 2 out of 3 simulations the estimated $\widehat{\epsilon}_i$ are non-zero and once we get all 0s with a singular fit message. Note that when the surgeon effects are non-zero, one left-handed surgeon has a positive effect and the other one negative, with the same absolute value. So simulation matches theory: the average random effect for left-handed surgeons is 0, and so for right-handed surgeons. The population-level fixed handedness effect is estimable with this mixed effects model. library("lme4") data $Speed sim_1 data } #> Surgeon Handed #> 1 Left #> 2 Right #> 3 Right #> 4 Left ranef( lmer(Speed ~ Handed + (1 | Surgeon), data = simulate_surgery_speed(seed = 2)) ) #> $Surgeon #> (Intercept) #> 1 0.5055828 #> 2 -1.0915321 #> 3 1.0915321 #> 4 -0.5055828 ranef( lmer(Speed ~ Handed + (1 | Surgeon), data = simulate_surgery_speed(seed = 5)) ) #> $Surgeon #> (Intercept) #> 1 -0.109308 #> 2 1.025426 #> 3 -1.025426 #> 4 0.109308 ranef( lmer(Speed ~ Handed + (1 | Surgeon), data = simulate_surgery_speed(seed = 3)) ) #> boundary (singular) fit: see help('isSingular') #> $Surgeon #> (Intercept) #> 1 0 #> 2 0 #> 3 0 #> 4 0
