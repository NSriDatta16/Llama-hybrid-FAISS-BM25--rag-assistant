[site]: stackoverflow
[post_id]: 5237141
[parent_id]: 
[tags]: 
SQL: Finding the average number of days between runs for each runners

So if we have the following table given: runner ran Carol 2011-02-01 Alice 2011-02-01 Bob 2011-02-01 Carol 2011-02-02 Bob 2011-02-02 Bob 2011-02-03 Bob 2011-02-04 Carol 2011-02-07 Alice 2011-02-08 How can I write a query (without any subquery) to find the average number of days each runner has to wait between runs (i.e, Carol waited 1 day, then 5, so average is 3; Bob runs everyday; Alice waited 7 days)? I was thinking about a join on the table itself, then finding the max and min for each runner, subtracting them and dividing by the number of runs - 1. But how do I combine all these without any subquery?
