[site]: crossvalidated
[post_id]: 428536
[parent_id]: 428346
[tags]: 
The solution space (valid bomb configurations) can be viewed as the set of bipartite graphs with given degree sequence. (The grid is the biadjacency matrix.) Generating a uniform distribution on that space can be approached using Markov Chain Monte Carlo (MCMC) methods: every solution can be obtained from any other using a sequence of "switches," which in your puzzle formulation look like: $$ \begin{pmatrix} x & - \\ - & x \end{pmatrix} \to \begin{pmatrix} - & x \\ x & - \end{pmatrix} $$ It's been proven that this has a fast mixing property. So, starting with any valid configuration and setting a MCMC running for a while, you should end up with an approximation of the uniform distribution on solutions, which you can average pointwise for the probabilities you're looking for. I'm only vaguely familiar with these approaches and their computational aspects, but at least this way you avoid enumerating any of the non-solutions. A start to the literature on the topic: https://faculty.math.illinois.edu/~mlavrov/seminar/2018-erdos.pdf https://arxiv.org/pdf/1701.07101.pdf https://www.tandfonline.com/doi/abs/10.1198/016214504000001303
