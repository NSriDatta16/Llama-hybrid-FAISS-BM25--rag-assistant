[site]: stackoverflow
[post_id]: 2335166
[parent_id]: 
[tags]: 
How to freeze the header row in an Excel spreadsheet exported from ASP.NET

I'm exporting an ASP.NET gridview to Excel using the following function. The formatting is working really well, except I need to freeze the header row in Excel on the export. I'm really trying to avoid using a 3rd party Excel plugin for this, but unless there's some archaic excel markup in my AddExcelStyling function. Public Sub exportGrid(ByVal psFileName As String) Response.Clear() Response.Buffer = True Response.Cache.SetCacheability(HttpCacheability.NoCache) Response.ContentType = "application/vnd.ms-excel" Response.AddHeader("content-disposition", "attachment;filename=PriceSheet.xls") Response.Charset = "" Me.EnableViewState = False Dim sw As New StringWriter() Dim htw As New HtmlTextWriter(sw) sfggcPriceSheet.RenderControl(htw) Response.Write(" " + Environment.NewLine) Response.Write(AddExcelStyling()) Response.Write(sw.ToString()) Response.Write(" ") Response.Write(" ") Response.End() End Sub And the formatting black magic: Private Function AddExcelStyling() As String Dim sb As StringBuilder = New StringBuilder() sb.Append(" " + Environment.NewLine + _ " ") sb.Append(" " + Environment.NewLine) sb.Append("@page") sb.Append("{margin:.25in .25in .25in .25in;" + Environment.NewLine) sb.Append("mso-header-margin:.025in;" + Environment.NewLine) sb.Append("mso-footer-margin:.025in;" + Environment.NewLine) sb.Append("mso-page-orientation:landscape;}" + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" PriceSheets " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" 9 " + Environment.NewLine) sb.Append(" 600 600 " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" False " + Environment.NewLine) sb.Append(" False " + Environment.NewLine) sb.Append(" False " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" 12780 " + Environment.NewLine) sb.Append(" 19035 " + Environment.NewLine) sb.Append(" 0 " + Environment.NewLine) sb.Append(" 15 " + Environment.NewLine) sb.Append(" False " + Environment.NewLine) sb.Append(" False " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) sb.Append(" " + Environment.NewLine) Return sb.ToString() End Function
