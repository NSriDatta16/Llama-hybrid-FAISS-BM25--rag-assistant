[site]: crossvalidated
[post_id]: 595509
[parent_id]: 595436
[tags]: 
@ttnphns could you compute the average distance with example for my code I'll give the general guide for that. Average distance between every point and every group of points Let $\bf D$ be the square symmetric matrix n x n of distances (dissimilarities) between n points, with zero diagonal. Let $\bf G$ be the n x k indicator matrix of group (cluster) membership of the points. With value 1 = belongs to the group, value 0 = doesn't belong to the group. (In general case, a point may belong to one, to more than one group or belong to none; that is, an individual row sum can be any up to k , even 0.) Let $\bf f$ be the row vector of frequencies in the groups, $\text {csum}(\mathbf {G})$ , "csum" meaning the column sum. And populate that row into the matrix: $\bf F = [1]f$ , where [1] is the column of ones of length n . Then $\bf \frac{DG}{F}$ is the n points x k groups matrix of average distances: element ij in it is the average distance between point i and points of group j. If you want the average distances be "leave-one-out", that is, the zero distance of a point to itself not participating in the averaging (when the point i belongs to group j containing >1 points), the $\bf F$ in the formula is first modified as follows: 1) $\bf F'= F-G$ ; 2) $\mathbf {F= F'}+ \text{not}(\mathbf F')$ , where "not" here means this complement recoding operation: positive element -> 0; nonpositive element -> 1 .
