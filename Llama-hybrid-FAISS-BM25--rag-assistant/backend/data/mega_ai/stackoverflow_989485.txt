[site]: stackoverflow
[post_id]: 989485
[parent_id]: 
[tags]: 
Has anyone been able to get Confluence.pm to add attachments?

If so can you provide the code. I am able to do almost everything else from creating new pages, modifying page attributes etc.. But I cannot seem to add attachments. I have read the official conflunce Perl XML-RPC site and discussions but all the code fragments they show there don't seem to work for me. Here is my hacked up attempt at it: # The following command sort of worked: # ~/bin/wikitool.pl -action attach_file -url $MYURL # IT attached something but the file was empty sub attach_file { my $confluence = XMLRPC::Lite->proxy($opts{server}."rpc/xmlrpc"); my $token = $confluence->call("confluence1.login", $opts{login}, $opts{password})->result(); # Fetch page my $page = FetchPage($opts{title}); if (not $page) { dbg("$opts{title} page is missing.","FATAL"); } my $pageId = SOAP::Data->type( string => $$page{id} ); my $filename = "$ENV{HOME}/tmp/tmp0.gif"; my $metadata = { fileName => $filename, contentType => "image/gif", comment => "Some random GIF", }; if (not open FILE, " ); my $call = $confluence->addAttachment($pageId, $metadata, $data); my $fault = $call->fault(); if (defined $fault) { dbg("could not attach $filename" . $call->faultstring(), "FATAL"); } else { print "attached $filename\n"; } }
