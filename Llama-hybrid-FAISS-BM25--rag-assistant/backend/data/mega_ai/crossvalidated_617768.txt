[site]: crossvalidated
[post_id]: 617768
[parent_id]: 
[tags]: 
Properties of a distribution obtained by filtering normal distributed variables by the result of a t-test

Two sample t-test Consider the following t-test Let $x_1, \dots, x_n \sim N(\mu_1,\sigma^2)$ and $y_1, \dots, y_n \sim N(\mu_2,\sigma^2)$ be independent samples. Let's define The raw effect $\begin{align}\theta = \mu_2-\mu_1\end{align}$ The estimate of the raw effect $\begin{align}\hat{\theta} = \bar{Y} - \bar{X} \sim N \left(\theta,\frac{2}{n} \sigma^2 \right)\end{align}$ The standard error of the raw effect $\begin{array}{RCL}\text{se}(\hat\theta) &=& \sqrt\frac{2}{n} \hat\sigma \\&= &\sqrt\frac{2}{n} \sqrt{\frac{\sum_{i=1}^n (X_i-\bar{X})^2 + \sum_{i=1}^n (Y_i-\bar{Y})^2}{2n -2}} \\&\sim &\sigma\sqrt{\frac{2}{n}} \sqrt{\frac{1}{2n-2}} \chi_{2n-2}\end{array}$ where $a\chi_{2n-2}$ means a scaled chi distribution (also known as a case of the gamma distribution). The t-statistic is defined as $$t = \frac{\hat\theta}{\text{se}(\hat\theta)} \sim t_{2n-2,\theta\sqrt{n/2}}$$ Distribution of the effect conditional on significance A null hypothesis test will consider estimates $\hat\theta$ significant or not significant according to the value of the t-statistic and some cutoff value $t_c$ $$\begin{array}{rl} \text{significant: }&|t| \geq t_c\\ \text{non-significant: }&|t| we consider the distribution of the effect size conditional on the null hypothesis test to be significant $$f(\hat{\theta} \text{ given } |t| \geq t_c)$$ where additional parameters are the the significance level $\alpha$ , sample size $n$ and true effect size $d$ . A simulation shows that this distribution looks as follows for $\alpha = 0.05$ , $n = 5$ and $d = 0.5$ . Aside from making a histogram we can also compute the distribution based on the PDF of the normal distribution $\phi(x)$ and CDF of the chi-squared distribution $F_{\chi^2_\nu}(x)$ $$f(\hat\theta;d,n,t_c) \propto \phi\left(\frac{\hat\theta-d}{\sqrt{2/n}}\right)F_{\chi^2_\nu}\left(\frac{(n-1) n\hat\theta^2}{t_c^2}\right)$$ Question Can we compute or estimate (in a way that is more efficient than Monte Carlo sampling or integration) the following two properties? The CDF $\begin{align}\int_{-\infty}^0 f(\hat{\theta}) d\hat\theta\end{align}$ and the mean absolute value $\begin{align}\int_{-\infty}^\infty |\hat\theta| f(\hat{\theta}) d\hat\theta\end{align}$ The motivation is that these relate to the type S and type M errors, as described in the questions: The probability of making a Type S error, and the average amount of magnification (type M error) as a function of power Power paradox: overestimated effect size in low-powered study, but the estimator is unbiased Understanding Gelman & Carlin "Beyond Power Calculations: ..." (2014) R-code for image ### settings set.seed(1) d = 0.2 n = 5 nu = 2*n-2 alpha = 0.05 n.sim = 10^5 ### boundary for alpha level t-test tc = qt(1-alpha/2, df = nu) #### simulations of t-test effect = rep(NA,n.sim) significant= rep(NA,n.sim) for (i in 1:n.sim) { X = rnorm(n) Y = rnorm(n,d) significant[i] = t.test(X,Y)$p.value tc ### plot histogram hist(effect[significant], breaks = seq(-3.5,3.5,0.1), freq = 0) ### add computation of density curve power = pt(-tc,nu,d/sqrt(2/n)) + 1-pt(tc,nu,d/sqrt(2/n)) power xs = seq(-4,4,0.01) #lines(xs,dnorm(xs,d, sqrt(2/n))/power) pfilter = (xs/tc)^2*(nu*n/2) lines(xs,dnorm(xs,d, sqrt(2/n))*pchisq(pfilter,nu)/power)
