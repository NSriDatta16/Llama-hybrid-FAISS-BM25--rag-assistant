[site]: crossvalidated
[post_id]: 362858
[parent_id]: 
[tags]: 
How to fit a line to data using weighted least squares (WLS) regression?

I am newbie to WLS regression topic. I am being asked to fit a line to a data using WLS. I am working in minitab. My data is as follows: cost (independent variable) (x-axis); production (dependent variable) (y-axis). A small sample of the data is as follow: Cost Production 200 4000 50 1000 350 3500 1000 1000 500 3500 100 500 800 2000 What I have done till now is: (1) Outlier detection. (2) Using, cost and production data, I have found unstandardized residuals. (3) Then, absolute of the residuals. (4) Using cost as x-axis (independent) and absolute residuals as y-axis (or dependent data), I have found unstandardized predicted values. (5) Then, I have found weights as reciprocal of the square of the predicted values. Now I want to plot the data and fit a line to it using WLS. This can be very basic and simple thing to most of you. But I am not able to figure it out that what I need to do after step (5) and how to fit a line using WLS? After reading over web, I have understood that in minitab, I need to run regression>>regression>>fit regression model and there, I need to provide x and y axis data and the estimated weights . And in storage tab, I need to check the 'fits' . Once regression model is done, I need to plot the scatterplot and there I should add a 'calculated line' with fits and the relevant x or y- axis. Q1. Now, firstly, I would like to ask if I am doing the entire process, upto estimating weights and fits, correctly? Q2. Secondly, if I am fitting the line using WLS correctly? i.e. Do fits need to be plotted in the graph to fit a line using WLS? Q3. In the plot, should *'fits'* be assigned in the place of dependent variable or independent variable? Wheresoever, I am not doing it right, it shall be helpful if someone can tell me the relevant steps to follow in spss or minitab. [For more details about the kind of graph/ plot that I need][1] [1]: https://web.archive.org/web/20150926002928/https://onlinecourses.science.psu.edu/stat501/node/397/ On the above URL, look at the 4th Figure i.e., scatterplot between cost vs num.responses, where black line shows OLS and red line shows WLS. I need such a scatterplot with two lines. For this, I need to construct or fit a line to my data using WLS.
