[site]: stackoverflow
[post_id]: 4977038
[parent_id]: 
[tags]: 
Can I use NHibernate Criteria to project an entity and its child collection onto a class?

I'm using NH Criteria to retrieve an entity and project selective fields onto a custom class (a bit like projecting data onto a ViewModel for display on an MVC view). This is easy enough using ProjectionList: var emailCriteria = mSession.CreateCriteria (); emailCriteria.SetProjection( Projections.ProjectionList() .Add(Projections.Property("Subject"), "Subject") ); emailCriteria.SetResultTransformer(Transformers.AliasToBean ()); var result = emailCriteria.List (); However, my entity contains a collection, and I want to bring that back too, and project it as a collection onto my custom class. My domain model looks (in simplified form) like this: public class Email { public string Subject public List Attachments etc... } public class EmailAttachment { public UploadedFile File } public class UploadedFile { public string Filename public UploadedFileData Data } public class UploadedFileData { public byte[] Data } Here's the "data model" classes I want to project onto: public class EmailDataModel { public string Subject public List Attachments } public class EmailAttachmentDataModel { public string Filename public byte[] Data } Now I know these models look very similar, and you'd be forgiven for thinking "what's the point?", but that's because I've simplified them. It's nice to be able to flatten my domain objects into handy data models. My big problem is figuring out how to access the necessary fields from deep down in my child objects (in this case, UploadedFile.Filename and UploadedFileData.Data), and project them as an EmailAttachmentDataModel collection onto my EmailDataModel. I've read a lot of articles online which discuss accessing child collections - using either EmailCriteria.CreateAlias or EmailCriteria.CreateQuery - but I haven't found anything which explains how to project a child collection AS a collection. I hope this will be a useful exercise for anyone interested in tinkering with NH Criteria queries.
