[site]: stackoverflow
[post_id]: 2620815
[parent_id]: 2619502
[tags]: 
To extend Test01 to allow for array constants and multiple function calls in one statement: =SUM({1,2,3,4,5},{1,2})+SUM({1,2,3,4,5}) Code: Sub Test02() sStr = Sheets("Sheet1").Range("A2").Formula For n = 1 To Len(sStr) strChar = Mid(sStr, n, 1) If strChar = "(" Then nLParen = nLParen + 1 If nLParen = 1 Then nArgs = nArgs + 1 End If If strChar = ")" Then nLParen = nLParen - 1 If nLParen = 1 And strChar = "{" Then blArray = True If blArray And strChar = "}" Then blArray = False If nLParen = 1 And Mid(sStr, n, 1) = "," And Not blArray Then nCommas = nCommas + 1 Next nArgs = nArgs + nCommas MsgBox nArgs End Sub
