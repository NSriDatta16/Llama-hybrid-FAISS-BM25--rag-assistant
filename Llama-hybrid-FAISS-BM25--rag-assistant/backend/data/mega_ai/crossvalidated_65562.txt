[site]: crossvalidated
[post_id]: 65562
[parent_id]: 
[tags]: 
Weighting FE regression with full matching

I have a dataset that has been partitioned into propensity-score-based matching groups using the optmatch package in R. We used full matching, so this allows any number of treatment observations to be matched with any number of control observations. I am attempting to estimate an average treatment effect on the treated for this sample. I know that I can calculate the matching ATT estimate directly by calculating the within-group difference in the outcome variable, and then taking a weighted average of this quantity across groups. However, there is another natural layer of grouping within this dataset, and I want to cluster the standard errors at this level. As far as I know, this is easiest to do via regression. My PI suggests just doing a fixed-effects regression without worrying about weighting, but I think this relies on the assumption of constant treatment effects across groups, since some groups are very over-represented in the dataset (some treatments are matched with 25 controls, e.g., while others with only 1). So I am wondering: is there a way to weight a fixed-effects regression to properly account for the unbalanced nature of the matching groups? If somebody knows how to do this in Stata, that is preferred, but any advice or references will be greatly appreciated.
