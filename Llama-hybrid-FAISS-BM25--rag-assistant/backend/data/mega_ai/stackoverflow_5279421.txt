[site]: stackoverflow
[post_id]: 5279421
[parent_id]: 5279253
[tags]: 
This may sound harsh, but you need to ditch the script. It's holding you back! PHP has built-in session handling with extensive configuration options . In fact, you're actually using it inside your own code... and then you're adding on an unnecessary layer of complexity. Call session_start at the top of your script to open a session. PHP will do the rest. It will keep track of the user with it's own cookie. You can set all the cookie options using the configuration. To log a user in, just set a value in the $_SESSION array, just like you're doing now. All of the things you're keeping as properties of your class -- the user id, the user agent and IP, etc -- can just be stored in the array. You can even regenerate the session id on login/logout, just as your current code does.
