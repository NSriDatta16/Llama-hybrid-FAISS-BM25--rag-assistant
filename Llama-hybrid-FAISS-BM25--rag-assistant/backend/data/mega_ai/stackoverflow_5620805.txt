[site]: stackoverflow
[post_id]: 5620805
[parent_id]: 
[tags]: 
Long transaction in WebSphere 6.1 results in OutOfMemoryException

I’m running a synchronization / batch job (synchronizeXXX() that inserts 111821 records in an Oracle database using Hibernate 3.2.5GA / Spring 2.5.6 in one long running transaction (>4 hours) but it fails after approx. 2 hours / 50000 records with an OutOfMemory exception. Although i do clear and flush every 20 inserts, it still looks like Hibernate/Websphere/Spring (?) is holding on to a gazillion objects in the session. The funny thing is: the memory usage is initially normal, but after approx. 20/30 minutes the memory usage starts to increase and grows until the OutOfMemory occurs (not shown in PDF because it was scrolled out/cleared or something). I tried upgrading Hibernate from 3.2.5 to 3.3.2GA but the same problem remained. When I increase the max heap size, the OutOfMemory just comes later. I googled and found some ‘similar’ issues, but they used Hibernate to manage the transaction instead of Spring, so I guess the fix mentioned is not relevant to me(?). See Simular issues I analysed the heap dumps and did some analysis with the IBM Support Agent 4.1. All results/screenshots and more details are included in a PDF : see OutOfMemory analysis (PDF 586KB) Any help is appreciated!
