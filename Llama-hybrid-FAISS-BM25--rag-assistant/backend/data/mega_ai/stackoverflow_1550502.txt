[site]: stackoverflow
[post_id]: 1550502
[parent_id]: 1549145
[tags]: 
Instead 'AnsiUpperCase' you can use Table it is much faster. I have reshape my old code. It is very simple and also very fast. Check it: type TAnsiUpCaseTable = array [AnsiChar] of AnsiChar; var AnsiTable: TAnsiUpCaseTable; procedure InitAnsiUpCaseTable(var Table: TAnsiUpCaseTable); var n: cardinal; begin for n := 0 to SizeOf(TAnsiUpCaseTable) -1 do begin AnsiTable[AnsiChar(n)] := AnsiChar(n); CharUpperBuff(@AnsiTable[AnsiChar(n)], 1); end; end; function UpCasePosEx(const SubStr, S: string; Offset: Integer = 1): Integer; var n :integer; SubStrLength :integer; SLength :integer; label Fail; begin SLength := length(s); if (SLength > 0) and (Offset > 0) then begin SubStrLength := length(SubStr); result := Offset; while SubStrLength AnsiTable[s[result + n -1]] then goto Fail; exit; Fail: inc(result); end; end; result := 0; end; initialization InitAnsiUpCaseTable(AnsiTable); end.
