[site]: stackoverflow
[post_id]: 5527698
[parent_id]: 
[tags]: 
Magento save order total in checkout page

We have a system like gift cards balance usage in the checkout page.While customers on the checkout page customers can use their Gift card balance amount to buy products. So i have added a a tab before payment tab in which customers have option to enter the amount o use from their gift card balance amount so when they say proceed am getting the entered value in custom Onepage controller and pass it to Onepage.php(Model class) to reduce the total amount. This is what am doing on the model class. public function saveCustomDiscount($discount=0) { $this->getQuote()->setGrandTotal($this->getQuote()->getGrandTotal() - $discount); $this->getQuote()->setBaseGrandTotal($this->getQuote()->getBaseGrandTotal() - $discount); $this->getQuote()->save(); //$this->getQuote()->collectTotals()->save(); $order = $this->getQuote()->getData(); Zend_Debug::dump($order); return array(); } And am calling this function from the controller Action function were am getting the user input. Here what ever am passing as discount the total amount and base total is not reducing. Its same as original. Note : Before custom order save. array(51) { --------------- ["grand_total"] => string(8) "243.7200" ["base_grand_total"] => string(8) "243.7200" ----------------- } After custom order save. array(51) { --------------- ["grand_total"] => float(223.72) ["base_grand_total"] => float(223.72) ----------------- } The data type is changed from string to float when am doing debug. What i have to do, to reduce the order total from the custom discount. Please help me. Thanks
