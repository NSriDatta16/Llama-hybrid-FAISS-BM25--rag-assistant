[site]: crossvalidated
[post_id]: 579254
[parent_id]: 
[tags]: 
How can I modify the mean absolute percentage error to account for the curve direction?

I am trying to predict the trend of a certain curve in the future (whether it will be increasing, decreasing, or remain constant). For evaluating my prediction, I am using the mean absolute percentage error (MAPE). However, I noticed that the direction really matters in this case, not only the value. For instance, when the actual curve is fluctuating over time, and my prediction is a straight line being the average of that fluctuation, I am getting a small MAPE, which is not fair (or that is what I assume). So I tried to modify the MAPE by including a penalization term that accounts for the difference between subsequent values, which I show below in a piece of python code: def trendLoss(yTrue,yPred): loss=0 mape=0 alpha=0.5 beta=0.5 for i in range(len(yTrue)): mape+= abs((yTrue[i]-yPred[i])/statistics.mean(yTrue)) mape/=len(yTrue) mean_diff=0 for i in range(len(yTrue)-1): mean_diff+=abs(yTrue[i+1]-yTrue[i]) mean_diff/=len(yTrue)-1 made=0 for i in range(len(yTrue)-1): made+= abs(((yTrue[i+1]-yTrue[i])- (yPred[i+1]-yPred[i]))/(mean_diff)) made/=len(yTrue)-1 return alpha*mape+beta*made I would like to verify if the above code will give me what I need. I have run it but I saw unexpected results sometimes.
