[site]: crossvalidated
[post_id]: 229436
[parent_id]: 
[tags]: 
Neural Network probabilities converging to biases

I'm creating an Android app which can use a variety of classification formula, and while I have normal Softmax done correctly, I keep having an issue with the Softmax Neural Network. After about 10 iterations, all of the dot values on the forward pass become negatives, so their values are stored as 0, causing the resulting layers of h1, h2, and scores to become 0+bias. This means that every result is the same, regardless of input. I feel like somewhere there is a typo in my code, but I've repeatedly compared and contrasted it with my partner's code (which is written for iOS) and can't find any differences. Hopefully someone here can tell me where I've gone wrong. public List gradient(List weights, double[] X, int Y, int D, int K, double L, int nh){ int length = D nh + nh + nh nh + nh + nh*K + K; List grad = new ArrayList(length); List W01 = new ArrayList (D*nh); List b1 = new ArrayList (nh); List W12 = new ArrayList (nh*nh); List b2 = new ArrayList (nh); List W23 = new ArrayList (nh*K); List b3 = new ArrayList (K); //Parse Parameters int count = 0; int end = count + D*nh; while(count h1 = new ArrayList (nh); for(int i = 0; i 0) { h1.add(sum); } else{ h1.add(0.0); } } List h2 = new ArrayList (nh); for(int i = 0; i 0) { h2.add(sum); } else{ h2.add(0.0); } } List scores = new ArrayList (K); for(int i = 0; i scoreMax){ scoreMax = score; } } //denom = Σ(i:k) exp(Θ_i · X) double denom = 0; for(int i = 0; i probs = new ArrayList (K); for(int i = 0; i dProbs = new ArrayList (K); for(int i = 0; i dW01 = new ArrayList (D*nh); List db1 = new ArrayList (nh); List dh1 = new ArrayList (nh); List dW12 = new ArrayList (nh*nh); List db2 = new ArrayList (nh); List dh2 = new ArrayList (nh); List dW23 = new ArrayList (nh*K); List db3 = new ArrayList (K); for(int i = 0; i 0){ dh2.add(dot); } else{ dh2.add(0.0); } } for(int i = 0; i 0){ dh1.add(dot); } else{ dh1.add(0.0); } } for(int i = 0; i
