[site]: stackoverflow
[post_id]: 3571713
[parent_id]: 
[tags]: 
Splitting Multi-page Tiff into Single Tiff's on Windows 7 / .Net 4.0

I recently moved to a new development box from Windows XP 32 Bit to Windows 7 64 bit. Both machines are running .Net Framework version 4.0 for development with Visual Studio 2010. After upgrading to Windows 7 64 Bit, my code to split a multi-page Tiff image into separate images is now broken (worked fine previously on XP 32 Bit, except for the MS fill order bug). After debugging, the Bitmap Metadata appears to be read correctly by the .Net Framework, however, some component in the stack is incorrectly persisting the some Tiff Tags (273, 278, and 279). I have tried several methods to accomplish the split, including GDI+, and the FreeImage library, but all fail within .Net. I was able to successful split the Tiff using Image Magick and another 3rd party tool with valid tag values. Specifically, Tiff Tags 273, 278 (should match 257 but does not), and 279 have incorrect values. Is this a known Microsoft issue? Is there a workaround? Am I doing this task wrong? Very frustrated as this was working on XP 32 just fine and that OS is not a deployment option. // Copy bytes into our memory using (MemoryStream ms = new MemoryStream()) { using (BinaryWriter bw = new BinaryWriter(ms)) { // Get the multi page tiff image's size, and allocate a place to put it. int size = RdmInstance.ImageSize; byte[] imgContents = new byte[size + 1]; // Create the pointer and assign the Rdm image address to it IntPtr pointerToImage = new IntPtr(RdmInstance.ImageData); // Copy the bytes from unmanaged memory to managed memory Marshal.Copy(pointerToImage, imgContents, 0, size); // Now, write that contents into our memory stream bw.Write(imgContents); // Check for multiple tiff pages, split them out and write them out correctly for the Fed TiffBitmapDecoder decoder = new TiffBitmapDecoder(ms, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); if (decoder.Frames.Count > 0) { // check for multi page tiff for (int i = 0; i
