[site]: crossvalidated
[post_id]: 332395
[parent_id]: 
[tags]: 
How to construct confidence limits based on small stratified samples of finite populations?

Imagine a business wishes to audit its transactions. It has a database summarizing the transactions, which constitute a sampling frame for the population. It would be time-consuming and expensive to examine each transaction in detail, so the standard of care in this situation is to sample the population. Using characteristics found in this database (such as amount or type of transaction), the auditor has (a) partitioned the population into nonoverlapping strata and (b) sampled randomly without replacement from each stratum. Suppose the purpose of the audit is to estimate $M,$ the total number of transactions in the population that have a certain characteristic when examined; for instance, perhaps they do not conform to certain business rules. One hopes $M$ is small! Our data therefore consist of three counts for each stratum: the size of the stratum $N_i,$ the sample size $n_i,$ and the number of observed nonconforming transactions $x_i.$ There are obvious ways to estimate the total number of nonconforming transactions in each stratum $i$; for instance, we might multiply the observed proportion $x_i/n_i$ by the stratum size $N_i$: $$\hat M_i = \frac{x_i N_i}{n_i}.$$ The sum of these is one possible estimator of $M.$ It is of great interest to have an accurate, defensible confidence limit (upper or lower) for $M.$ Ordinarily--at least according to the textbooks I have examined--one simply estimates the variance of $M$ by aggregating estimated variances of the $\hat M_i$ (using appropriate weights) and applies a Normal approximation. This approximation begins to fail when there are small sample sizes $n_i$, small observed counts $x_i$ (especially when $x_i=0$) or samples are large compared to the stratum sizes (roughly, when $n_i$ exceeds about 10% of $N_i$). How can we construct confidence limits with good coverage when all three problematic conditions apply in one or more strata?
