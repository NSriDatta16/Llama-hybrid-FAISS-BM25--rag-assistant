[site]: crossvalidated
[post_id]: 444793
[parent_id]: 
[tags]: 
Experimental Design with two treatment levels, random effects, and technical constraints

I'm trying to plan an experiment and the experimental design is giving me headaches because it's too complex to wrap my only-statistics-101-capable head around. Basically I want to subject plants of different genotypes to drought stress or not (treatment) but also pay attention to positional random factors (position of the plant in the greenhouse). I have a total of 384 spaces in the greenhouse organized in 12 lanes (longitudinal position) and 8 columns (latitudinal position). Each of the spaces will be occupied by 1 tray that holds 6 plants, and treatment (watering) can only be applied to the whole tray of 6 plants. I have 48 genotypes, so there'll be 24 replicates per genotype and treatment. It appears to me that a split-plot design would be most appropriate, because I have two "treatment" levels (watering and genotype), and watering can only be applied to a tray of 6 plants whereas genotype can be "applied" to each plant individually. Since I have two random factors, a Latin Squares design within the split-plot design seemed sensible to me. Of course I don't want to do this by hand, so I installed the agricolae package in R that can create such layouts for me: library(agricolae) treatments = c("Drought", "Well Watered") genotypes = seq(1, 48) design.split(treatments, genotype, r=24, design="lsd") And indeed, that does create an experimental layout, just unfortunately it doesn't know/care about my constraints: it wants to put each genotype in every tray, but I only have space for 6 plants per tray Latin Square design of course assumes my longitudinal and latitudinal effects have an equal number of levels, but I have 12 lanes and 8 columns (on a more technical level) it seems to ignore my r option and is only giving me one replicate per treatment, genotype and position. Now, my question is: What would be a good experimental design for this situation and does anyone know of a software package (R, python, Julia, whatever) that can generate an experimental plan?
