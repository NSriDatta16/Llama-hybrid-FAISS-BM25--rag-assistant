[site]: stackoverflow
[post_id]: 3548063
[parent_id]: 
[tags]: 
How to load a class into the current instance within Sub New

Long term lurker, first time poster here. I have written a class to model an object in vb.net, using vs2008 and framework 2.0. I am serializing the class to an XML file for persistent storage. I do this with a method in the class like this: Public Sub SaveAs(ByVal filename As String) Dim writer As New Xml.Serialization.XmlSerializer(GetType(MyNamespace.MyClass)) Dim file As New System.IO.StreamWriter(filename) writer.Serialize(file, Me) file.Close() End Sub I now want to do a similar thing but reading the class from file to the current instance, like this: Public Sub New(ByVal filename As String) Dim reader = New Xml.Serialization.XmlSerializer(GetType(MyNamespace.MyClass)) Dim file = New System.IO.StreamReader(FullPath) Me = CType(reader.Deserialize(file), MyNamespace.MyClass) End Sub However, I cannot assign anything to “Me”. I’ve tried creating a temporary object to hold the file contents then copying each property and field over to the current instance. I iterated over the properties (using Reflection), but this soon gets messy, dealing with ReadOnly collection properties, for example. If I just copy each property manually I will have to remember to modify the procedure whenever I add a property in the future, so that sounds like a recipe for disaster. I know that I could just use a separate function outside the class but many built-in .NET classes can instantiate themselves from file e.g. Dim bmp As New Bitmap(filename As String) and this seems very intuitive to me. So can anyone suggest how to load a class into the current instance in the Sub New procedure? Many thanks in advance for any advice.
