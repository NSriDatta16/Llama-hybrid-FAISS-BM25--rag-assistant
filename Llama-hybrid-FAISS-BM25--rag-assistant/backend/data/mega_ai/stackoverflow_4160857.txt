[site]: stackoverflow
[post_id]: 4160857
[parent_id]: 
[tags]: 
How can I rewrite this query without sub-queries?

So what I want to do: I have a table that has some prices of some items of a store, what I want to do is to find the average price of all the items sold from that store, AND the sum of all similar items sold in store. My columns are: item_no branch totalamount What is really important is that I have to avoid sub-queries so I couldn't do something like: SELECT DISTINCT branch AS postcode, item_no, avg_price FROM Prices NATURAL JOIN (SELECT branch, AVG(totalamount) avg_price FROM Prices GROUP BY branch) av WHERE sum > avg_price ORDER BY turnover DESC , branch; Which does exactly what I want to do, nevertheless I have to do it without sub-queries. edit 1 QUESTION: IS THERE A DIFFERENCE between derived and temporary tables? so for the assignment , i am not allowed to use subqueries, OR temporary tables, so does my answer have any of those 2?
