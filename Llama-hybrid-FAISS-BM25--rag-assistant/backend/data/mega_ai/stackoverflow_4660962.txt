[site]: stackoverflow
[post_id]: 4660962
[parent_id]: 
[tags]: 
xPath insert before and after - With DOM and PHP

I need to add a class to a HTML structure. My class is called " container " and should start right after (the child of ul and its simblings, not grandchilds) and should end right before the closing of the same element. My whole code looks like this: Title Test Test Paragraf New title Some text Some text åäö '; $doc = new DOMDocument(); $doc->loadHTML($content); $x = new DOMXPath($doc); $start_text = ' '; $end_text = ' '; foreach($x->query('//div/ul/li') as $anchor) { $anchor->insertBefore(new DOMText($start_text),$anchor->firstChild); } echo $doc->saveXML($doc->getElementsByTagName('ul')->item(0)); ?> It works as far as i can add the class opening but not the closing element. I also get strange encoding doing this. I want the output to be the same encoding as the input. The result should be Title Test Test Paragraf New title Some text Some text åäö
