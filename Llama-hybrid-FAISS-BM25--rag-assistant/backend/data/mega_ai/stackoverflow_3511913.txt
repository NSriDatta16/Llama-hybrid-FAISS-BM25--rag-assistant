[site]: stackoverflow
[post_id]: 3511913
[parent_id]: 3509246
[tags]: 
You can refer to the fields by name, but first rss should be an object, so use Set, also the string concatenator is & : Set rss = cnn.Execute (""select UnitPrice, Quantity " _ & " from ProductProfilePrices where MfPartNumber ='" & mfgprt & "'") ''Let us say that only one row is returned for mfgprt : varUnitPrice = rss("UnitPrice") varQuantity = rss("Quantity") EDIT re comments Connect_to_db "AAA", Val1, Val2 MsgBox Val1 & " " & Val2 Function Connect_to_db(ByVal mfgprt, ByRef Val1, ByRef Val2) Dim cnn, rss Set cnn = CreateObject("ADODB.Connection") Set rss = CreateObject("ADODB.recordset") cnn.ConnectionString = "DSN=QTPDSN;Description=desc;" _ & "UID=;PWD=;APP=QuickTest Professional;WSID=;DATABASE=;" cnn.Open rss = cnn.Execute("select UnitPrice, Quantity " _ & " from ProductProfilePrices where MfPartNumber ='" & mfgprt & "'") Val1 = rss(0) Val2 = rss(1) End Function
