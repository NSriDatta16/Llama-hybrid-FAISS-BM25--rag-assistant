[site]: crossvalidated
[post_id]: 635198
[parent_id]: 
[tags]: 
Calculating the Orthogonal Distance to Kernel PCA subspace (with a new data)

I am studying Kernel PCA methods and now I'm trying to calculate orthogonal distances (OD) on the feature space. What I've found is, you can calculate ODs with a kernel trick if you are interested in one of the training observations. However, I could not find a way to calculate OD between a new observation and the previously created kernel PCA subspace. Let $X$ be our training set with rows as observations, $\phi$ mapping to the feature space, $k$ our mercer kernel and $K$ our kernel matrix with $K_{i,j} = k(x_i, x_j)$ . The OD for a single observation is given by the below equation. $$ OD_i = \| \phi(x_i) - \widehat{\phi(x_i)} \|, $$ where $\widehat{\phi(x)}$ is the image of $\phi(x)$ on the kernel PCA subspace. With kernel tricks and Pythagoras theorem we can get the following result. \begin{eqnarray*} OD_i^2 &=& \| \phi(x_i) - \widehat{\phi(x_i)} \|^2 = \| \phi(x_i) - \hat\mu \|^2 + \| \widehat{\phi(x_i)} - \hat\mu \|^2 \text{ (Pythagoras)} \\ &=& \langle \phi(x_i) - \hat\mu, \phi(x_i) - \hat\mu \rangle - \sum_{j=1}^k {t_{ij}^2} \\ &=& (K_c)_{i,i} - \sum_{j=1}^k {t_{ij}^2} \end{eqnarray*} $\hat\mu$ is the center estimate of the KPCA subspace. In the summations part $t_{ij}$ are just the elements of first $k$ principal components. The derivation just follows from Pythagoras theorem but you can ignore it. My problem here is, when I use an $x_{\text{test}}$ that is not used in the creation of $K$ , I cannot find $(K_c)_{i,i}$ . What can I do to change the equation to a form without $(K_c)_{i,i}$ ? I tried replacing $\frac{1}{n} \sum_{l=1}^n \phi(x_l)$ with $\hat\mu$ and found a reasonable result but numerically I was not able to replicate my previous results. However, the results were interestingly correlated, with correlation parameter of $0.85$ (it was even higher when I used lesser number of samples in my simulation). My two resources: http://dx.doi.org/10.1016/j.patcog.2006.07.009 (page 6) https://doi.org/10.1007/s11634-010-0068-1 (page 160)
