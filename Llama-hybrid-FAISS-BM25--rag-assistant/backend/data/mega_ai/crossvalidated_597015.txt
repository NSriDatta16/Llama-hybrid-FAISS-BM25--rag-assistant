[site]: crossvalidated
[post_id]: 597015
[parent_id]: 597009
[tags]: 
I thought input_features is set to None because I did not set validate=True . That is indeed the case. The docs imply it, based on the descriptions of other attributes (e.g feature_names_in_ ), but don't state it explicitly. Adding a note about this behavior might be an easy and useful contribution to Scikit-learn. As for the error message... unfortunately that's a baked-in part of the validate=True logic. This validation logic is generic and re-used in several different places. Its implementation is in sklearn.utils.validation._assert_all_finite . This seems to be an oversight/bug in FeatureTransformer . There is an allow_nan= option in this internal function, but the user is not given an opportunity to change its value. The validation logic in FeatureTransformer eventually flows to sklearn.utils.validation.check_array , which calls _assert_all_finite with allow_nan=False unconditionally . As with the omission in the docs, I think the only solution here (other than your workaround) is to file an issue on the Scikit-learn issue tracker. It's very likely that they never considered using FunctionTransformer for imputation like this, since imputation is very often not "stateless", and FunctionTransformer is meant to be used for "stateless" transformations.
