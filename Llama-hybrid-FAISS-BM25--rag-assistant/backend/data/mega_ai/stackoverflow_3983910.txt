[site]: stackoverflow
[post_id]: 3983910
[parent_id]: 3983217
[tags]: 
A pure XPath 1.0 solution : substring(/*,1,150) where the parent of the provided XHTML fragment is the top element ( /* or /html ). A very exact XPath 2.0 solution exists : for $t in (//text())[not(sum((.| preceding::text())/string-length(.)) gt 150)] return ($t, '&#xA;') Do note : The XML document must be parsed in a mode that discards the white-space-only text nodes. Otherwise string-length(.) must be replaced by string-length(normalize-space(.))
