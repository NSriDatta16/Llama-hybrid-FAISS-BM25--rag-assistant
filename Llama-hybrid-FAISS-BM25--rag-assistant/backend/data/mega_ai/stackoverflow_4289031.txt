[site]: stackoverflow
[post_id]: 4289031
[parent_id]: 4287984
[tags]: 
There's a few things you can do to improve your code : like said previously, use OrderBy for sort write your request as a LINQ expression rather than successive method calls : var files = (from file in Directory.GetFiles ( path, "*.*", SearchOption.AllDirectories ) where file.EndsWith ( ".bmp", StringComparison.OrdinalIgnoreCase ) || file.EndsWith ( ".jpg", StringComparison.OrdinalIgnoreCase ) orderby new FileComparer() select file); The code above does the same than yours but is more elegant. To get path, extension, file name... I strongly recommend you to use System.IO.Path helpers methods rather than perform string operations like substring or contains !! Rather than use Directory.GetFiles you could instantiate a DirectoryInfo and call the GetFiles method : this one has the advantage to return an array of FileInfo, which exposes directly properties like extension, file name... Hope this helps
