[site]: crossvalidated
[post_id]: 224591
[parent_id]: 
[tags]: 
Why doesn't my code for extracting the first principal component work?

Following the Wikipedia article on PCA , I extract the weights of the first principal component by calculating $$\textbf{w}_1 = \mathrm{\arg\ max} \left\{ \frac{\textbf{w}^\intercal \textbf{X}^\intercal \textbf{X} \textbf{w}}{\textbf{w}^\intercal \textbf{w}} \right\}.$$ However, my R code for doing so with doesn't seem to correspond with the output of R's prcomp() function. # Set seed set.seed(1) # Initialize and scale data X = diag(10) X = scale(X) # Define objective function objec = function(w){ (t(w)%*%t(X)%*%X%*%w)/(t(w)%*%w) } # Run optimization with Nelder--Mead method o = optim(c(0, 0, 1, 0, 0, 0, 0, 0, 0, 0), objec, control=list(maxit=10000, fnscale=-1), method="Nelder-Mead") # Check output print(o) # Print out output of optimization o$par # Print out output of prcomp()'s first principal component prcomp(X)$rotation[, 1] What's going on?
