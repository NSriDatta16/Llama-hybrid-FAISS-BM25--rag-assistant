[site]: stackoverflow
[post_id]: 4765489
[parent_id]: 
[tags]: 
Rails 2.3.9 Sessions Won't Work In Integration Tests Anymore

For some reason, my integration tests that are testing my login controller suddenly won't work. Just upgraded to 2.3.9 and been having weird problems. Everything was perfectly fine in 2.3.5 and even 2.3.8! Here's some code that no longer passes: def login_user visit login_url assert_response :success assert_template "new" post session_url, :email => "abc@123.com", :password => "secret" assert_response :redirect follow_redirect! assert_response :success assert_template "sessions/organizations" post organizations_session_url, :id => organizations(:ace).id assert_response :redirect follow_redirect! assert_response :success assert_template "mission_control/index" end When a user logs in their id gets saved to session[:user_id]. When I run the test above it fails after the first follow_redirect!. It appears that session[:user_id] is getting cleared and then asking the user to log in again when they just did. What could be causing my sessions to get cleared? I haven't touched anything. Rails 2.3.5 was fine. Is there a bug in Rails? Thanks (Btw, the site runs fine. It's just the integration tests that appear to be messing with my sessions.)
