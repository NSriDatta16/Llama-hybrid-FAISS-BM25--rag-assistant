[site]: datascience
[post_id]: 36539
[parent_id]: 
[tags]: 
Matlab: setting static iterations per epoch in a CNN

I'm building a convolutional neural network using Matlab's neural network toolbox. I have code designed to cross-train the network with different data sets, using the previous network's layers in training the new network (this provides the same functionality as saving and resuming training on a network). However, after a few training sessions (generally session 3), Matlab begins increasing the iterations per epoch. I have set the iterations per epoch to be 1, with a maximum of 10 epochs. However, Matlab will increase this to 2 iterations per epoch, then 3, and so on until the full training process is finished. Is there something I'm missing when I set up my network options? OR, is there a way to hard-set iterations per epoch to stop Matlab increasing the value? Code for setting the network options (this is the same per training session, but the data inside the validation set changes): options = trainingOptions('sgdm', ... 'InitialLearnRate', 0.03, ... 'MaxEpochs',10, ... 'ValidationData',set9, ... 'ValidationFrequency',5, ... 'Verbose',false, ... 'ValidationPatience',Inf,... 'Plots','training-progress'); Also included images of the network visualisation in stages 1 and 3 of training, to demonstrate difference:
