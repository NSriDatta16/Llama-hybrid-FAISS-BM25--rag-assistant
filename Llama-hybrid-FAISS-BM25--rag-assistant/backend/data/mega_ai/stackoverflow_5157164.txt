[site]: stackoverflow
[post_id]: 5157164
[parent_id]: 5157088
[tags]: 
Just run your code in Win machine - everything is OK. Try to add ignore( System.Console.ReadKey() ) as a last line, because agent.Post is non-blocking and after posting 10000 messages control flow will move forward, possibly exiting the program.
