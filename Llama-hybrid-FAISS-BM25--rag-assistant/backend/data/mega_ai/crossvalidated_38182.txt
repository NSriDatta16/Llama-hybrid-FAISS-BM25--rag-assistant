[site]: crossvalidated
[post_id]: 38182
[parent_id]: 38174
[tags]: 
Your bootstrap function is not correct. I know why all of your p values are between 0.4 and 0.6 and are averaging 0.5: half of your resamples give you a test statistic below and half of your resamples give you a test statistic above the original. You will always get that result from that function - I tried it out with some other data. You aren't randomly switching up the pre and post data. To get the bootstrap p value, you compare your observed test statistic, t.test(x=data[,1], y=data[,2], paired=TRUE)$statistic with a random shuffling of pre and post data. So, you need to sample from your original data AND randomly mix up pre and post data (maintaining pairs though). I'll try to post some code later if you still need help.
