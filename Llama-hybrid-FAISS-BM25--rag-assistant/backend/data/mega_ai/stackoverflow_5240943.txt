[site]: stackoverflow
[post_id]: 5240943
[parent_id]: 5216451
[tags]: 
Can you screenshot counters for PrivateBytes, LOH size, #Gen 2 collections? What type of application is this? How deep is this into your application code? How many objects do you have on the LOH? Since the buffer that is being returned definitely qualifies as a Large Object. Have you looked at the call stack, the state of the heap, and fragmentation when this call fires? FWIW, you might try the same code in a C or C++ version that uses the GDI. Every one of the graphics related functions you are using is a wrapper around the GDI and testing that in a test application on the failing machines would help narrow things down to the .Net Framework and not something else. I was not able to get an OOM Exception, but the largest value I could pass was around 19866x19866 before the function would throw an InvalidParameterException. This is on a 64bit Win7 targeting .Net 4 w/VS2010.
