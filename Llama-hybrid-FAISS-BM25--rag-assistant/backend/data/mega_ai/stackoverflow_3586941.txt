[site]: stackoverflow
[post_id]: 3586941
[parent_id]: 3586909
[tags]: 
Edited following update in question SQL Server does not support dynamic pivoting. To do this you could either use dynamic SQL to generate a query along the following lines. SELECT Id ,Name, ISNULL(MAX(CASE WHEN Line='Z' THEN 1 END),0) AS Z, ISNULL(MAX(CASE WHEN Line='Y' THEN 1 END),0) AS Y, ISNULL(MAX(CASE WHEN Line='X' THEN 1 END),0) AS X, ISNULL(MAX(CASE WHEN Line='W' THEN 1 END),0) AS W FROM T GROUP BY Id ,Name Or an alternative which I have read about but not actually tried is to leverage the Access Transform function by setting up an Access database with a linked table pointing at the SQL Server table then query the Access database from SQL Server!
