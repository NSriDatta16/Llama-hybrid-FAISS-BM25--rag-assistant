[site]: stackoverflow
[post_id]: 5425499
[parent_id]: 5425378
[tags]: 
Try this: ;WITH CTE AS ( SELECT *, ROW_NUMBER() OVER(ORDER BY CustomerId) Corr FROM DataTable ) UPDATE CTE SET CTE.ControlNumber = B.Number FROM CTE JOIN ( SELECT Number, ROW_NUMBER() OVER(ORDER BY Number) Corr FROM NumberTable) B ON CTE.Corr = B.Corr
