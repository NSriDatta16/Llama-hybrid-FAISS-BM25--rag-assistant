[site]: stackoverflow
[post_id]: 4272754
[parent_id]: 
[tags]: 
Unable to set CURLOPT_NOBODY without crashing curl_exec

I've been killing myself all day for this one bug. I can't tell you enough how much I'd appreciate any possible help on this. Basically, I have a very simple script. It logs into a website, looks at a file's header to see if it is an image type and then it downloads it. It then repeats this three times. The problem here is that I cannot set CURLOPT_NOBODY without curl_exec crashing the entire script with -no- errors. (I can't even call or get an curl_error!)It would seem that it is impossible for me to go from CURLOPT_NOBODY, true to CURLOPT_NOBODY, false. The loop below runs one time and then dies(). What could possibly be causing this bug? Here is the script: // Log into the Website curl_setopt($ch, CURLOPT_URL, 'http://myexample.com/login'); curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.12) Gecko/2009070611 Firefox/3.0.12"); curl_setopt($ch, CURLOPT_POSTFIELDS, $post_fields); curl_setopt($ch, CURLOPT_POST, 1); curl_setopt($ch, CURLOPT_HEADER, 0); curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($ch, CURLOPT_COOKIEJAR, "cookie.txt"); curl_setopt($ch, CURLOPT_COOKIEFILE, "cookie.txt"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5); curl_exec($ch); // Begin the Loop for Finding Images for($i = 0; $i ' . $output; // (Normally checks for content type here) Download the File curl_setopt($ch, CURLOPT_URL, 'http://myexample.com/file.php?id=' . $i); curl_setopt($ch, CURLOPT_HEADER, false); curl_setopt($ch, CURLOPT_NOBODY, false); $filename = 'downloads/test-' . $i . '.jpg'; $fp = fopen($filename, 'w'); curl_setopt($ch, CURLOPT_FILE, $fp); curl_exec($ch); fclose($fp); } I'm running apache 2.2 and PHP version 5.2.13. Thanks for any help- I can't tell you how much I'd appreciate it. I'm completely stuck here. :(
