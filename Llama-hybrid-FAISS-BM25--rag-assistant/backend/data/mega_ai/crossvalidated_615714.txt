[site]: crossvalidated
[post_id]: 615714
[parent_id]: 
[tags]: 
Seeking advice on a Bayesian hierarchical model for count data with overdispersion and instrumental variable:

Dear members of the statistics forum, I am interested in a process that selects genes from a gene pool and divides them into two groups according to the treatment. My objective is to estimate the "real" read count of each gene. in order to identify the most enriched gene group per treatment. My model accounts for an unmeasured underlying effect that influences both treatment and read counts, which is crucial for detecting real enrichment. The data is organized into clusters of gene groups, where each gene is further clustered into sgRNA (specific inhibitors of each gene). I am using a model with various parameters, where X is the response variable that indicates 0 for no treatment and 1 for treatment. I would like to seek your advice and suggestions on the model I have developed, which seems to provide results in the right direction. $$ \begin{align} read_count &\sim \text{NB}(\mu,\theta_s)\tag{11} \\ \theta_s &\sim \text{Gamma} (1,\bar{\theta_s} \sim \text{Gamma}(1,1))\\ ln(\mu) &= \alpha + \beta_{gene} + (\alpha_{intercept} + \beta_{gene}) \times X + \lambda_{sgRNA} +( \alpha_{intercept} + \lambda_{sgrna}) \times X\\ \beta_{gene} &\sim \text{MvNormal}(\beta, \Sigma)\\ \beta &= \text{Student-t}(\bar{\nu} = 5, \bar{\mu} = 0, \bar{\sigma} = 1)\\ \Sigma &= lkj(3,\sim Exp(1))\\ \lambda_{sgrna} &\sim \text{MvNormal}(\lambda, \Sigma')\\ \lambda &= \text{Student-t}(\tilde{\nu} = 5, \tilde{\mu} = 0, \tilde{\sigma} = 1)\\ \Sigma' &= lkj(3,\sim Exp(1))\\ \end{align} $$ \beta and \lambda represent the slopes describing the change in read counts between treatment groups (X). Since my variance is much higher than the mean, I am fitting my data to a negative binomial model. To improve detection, I believe that an instrumental variable should be included. The response variable, read-pool, influences sgRNA and gene reads but not the treatment condition. therefore, read-pool can be a good instrumental variable with covariate \epsilon. Here is the model I have tried which was preforming very poorly: Model 13- Studentâ€™s T (varying efffect proir) with erorr $$ \begin{align} read_count &\sim \text{NB}(\mu,\theta_s)\tag{12} \\ \theta_s &\sim \text{HalfNormal}(0.5) \\ ln(\mu) &\sim \text{MvNormal}(\begin{bmatrix}\mu_{y}\\ \mu_{\epsilon}\ \end{bmatrix}, \Sigma_{y,sgrna})\\ ln(\mu_{y}) &= \alpha + \beta_{gene} + (\alpha_{intercept} + \beta_{gene}) \times X + ( \alpha_{intercept} + \lambda_{sgrna}) \times X \\ ln(\mu_{\epsilon}) &= \lambda_{sgRNA} + (\epsilon_{sgrna} + \epsilon_{sgrna}) \times Pool\\ \epsilon_{gene} &= \kappa_{gene} + \kappa_{gene} \times Pool \\ \beta_{gene} &\sim \text{MvNormal}(\beta, \Sigma)\\ \beta &= \text{Student-t}(\nu = 5, \bar{\mu} = 0, \bar{\sigma_{\beta}} = 1)\\ \Sigma &= lkj(3,\sim Exp(1))\\ \lambda_{sgrna} &\sim \text{MvNormal}(\lambda, \Sigma') \\ \lambda &= \text{Student-t}(\nu = 5, \tilde{\mu} = 0, \tilde{\sigma_{\lambda}} = 1)\\ \Sigma' &= lkj(3,\sim Exp(1))\\ \end{align} $$ I would like to mention that I have generated synthetic data and am using the PyMC library for fitting the Bayesian hierarchical model. I am seeking advice on the model I have developed and any suggestions for potential improvements, considering the nature of the data and the use of PyMC for fitting the model.
