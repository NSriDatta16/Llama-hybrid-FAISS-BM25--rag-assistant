[site]: stackoverflow
[post_id]: 2517933
[parent_id]: 2516869
[tags]: 
In XSLT 2, you can do this very elegantly. Say you have a template for formatting each thing before it is wrapped in an element: Then you can apply that to each thing of some $type to build the elements via a function: Then you can call that function for each unique type (a, b, d in your sample input) to build the entire output and you're done:
