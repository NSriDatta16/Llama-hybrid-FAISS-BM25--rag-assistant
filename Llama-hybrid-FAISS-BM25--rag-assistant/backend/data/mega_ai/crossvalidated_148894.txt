[site]: crossvalidated
[post_id]: 148894
[parent_id]: 124873
[tags]: 
Several things could be wrong; I can only suggest some things to look at. What's the smallest $N$ to debug with â€” 5, 10 ? Plot that with $N_r = N/2, N, 2N$ . Follow the steps, with rug plots or quantiles of $|p_i - q_j|, exp_{ij}$, row sums. (It's not clear to me if $1 / M_r$ scaling is correct, maybe row sums 1 in the $N \times N_r$ array of $exp_{ij}$ ?) $exp^{ - |p - q|^2 / r }$ is very sensitive to radius $r$. And it doesn't scale: as $N_r \to \infty$, the $exp$ s crowd near 1 (I believe). There are lots of other metrics between 2d point sets; average nearest-neighbor with nnear say 10 is fast and easy with scipy.spatial.cKDTree . Can the data be viewed as a continuous terrain, 1 at the data points, falling off to 0 in between ? If so, the average error of the $N_r$ points interpolated at the $N$ sounds like a reasonable metric; see (ahem) inverse-distance-weighted-idw-interpolation-with-python . And terrains are nice to plot.
