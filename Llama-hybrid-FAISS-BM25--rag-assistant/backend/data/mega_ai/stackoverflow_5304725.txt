[site]: stackoverflow
[post_id]: 5304725
[parent_id]: 5304696
[tags]: 
You might want to use a group by statement select customer, datediff(D, min(bought), max(bought)) / count(bought) as average from data group by customer Whenever you have an aggregate function in the select list , you have to use grouping on the other fields that are not members of the aggregation. This was tested on SQL Server and the syntax may differ to Postgresql, which I am not using.
