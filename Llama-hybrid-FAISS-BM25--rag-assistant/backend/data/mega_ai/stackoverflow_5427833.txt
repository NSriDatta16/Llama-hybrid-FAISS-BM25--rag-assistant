[site]: stackoverflow
[post_id]: 5427833
[parent_id]: 5427778
[tags]: 
It doesn't strictly have to be pure, it just has to be idempotent . In practice this is basically the same thing. Further, it only has to be idempotent when seen outside of the STM: if the only side effect you produce is writing to some other ref or (I think) sending to an agent, that operation will be held until your transaction has succeeded. It's also not really the case that it has to be any of these things: just that, if your update function isn't pure, the results may not be what you expect. Edit: dosync 's docs tell you that any expressions in the body may be executed more than once. You can't run an alter without running a dosync , so it looks like all the docs you need are there. What would you like changed?
