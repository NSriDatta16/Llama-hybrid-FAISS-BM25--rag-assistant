[site]: crossvalidated
[post_id]: 642545
[parent_id]: 
[tags]: 
Normalized dependent variable in a linear mixed-effects model

I have data (y) from experiment with three drugs (D={D1, D2, D3}) , two treatments (T={T1, T2}) within each drug and several subjects S. The data y were normalized such that within each subject and each drug, the data y were divided by the average value of the first treatment T. Thus, the values y with all drugs with treatment T1 are centered around 1. I did this normalization since the values y actually have no real relation between subjects or between drugs. I'm interested to see if T1 and T2 differ and whether the difference depends on the drug used, but I don't get a nice model fit after doing the normalization, and don't know how I should resolve it. I tried to fit a linear mixed-effects model with: lmer(y ~ treatment + treatment:drug + (0 + treatment:drug|subject), data=data2, control = lmerControl(optimizer="bobyqa")), which results in singularity warning. Here's a summary of the model fit: Linear mixed model fit by REML ['lmerModLmerTest'] Formula: y ~ treatment + treatment:drug + (0 + treatment:drug | subject) Data: data2 REML criterion at convergence: -465.3664 Random effects: Groups Name Std.Dev. Corr subject treatmentT1:drugD1 0.000e+00 treatmentT2:drugD1 2.286e-02 NaN treatmentT1:drugD2 2.841e-09 NaN -0.68 treatmentT2:drugD2 2.852e-03 NaN 0.69 -0.96 treatmentT1:drugD3 4.527e-09 NaN -0.40 0.78 -0.66 treatmentT2:drugD3 6.378e-02 NaN -0.88 0.92 -0.95 0.60 Residual 3.979e-02 Number of obs: 144, groups: subject, 6 Fixed Effects: (Intercept) treatmentT2 treatmentT1:drugD2 treatmentT2:drugD2 treatmentT1:drugD3 treatmentT2:drugD3 1.000e+00 -1.142e-02 -9.669e-16 -5.907e-03 -6.692e-16 8.244e-02 optimizer (bobyqa) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings I get zero or near-zero standard deviation for the random effects T1:D, and the fixed effects show the same pattern. This is expected due to the data normalization. Consequently, I get some NaN values for random effect correlations with regards to this. Can I just ignore the zero variance and NaN correlations and go on with pairwise comparisons using emmeans? I'm guessing that this would produce unreliable estimates for the means and their uncertainty. Maybe the model should be defined differently? It also puzzles me that if I don't do this normalization I don't seem to have 'problems' with the random effects, as there is something (arbitrary) to estimate. I think I should be able to get a result with less uncertainty after removing arbitrary variability in the data.
