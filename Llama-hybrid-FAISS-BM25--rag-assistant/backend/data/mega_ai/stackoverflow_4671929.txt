[site]: stackoverflow
[post_id]: 4671929
[parent_id]: 4667573
[tags]: 
It's possible that your token is not correct. Depending on your authentication type, you may also need to change the token's AuthenticationType. Try the following method to get an instance of the service. private static CrmService GetService(string organization, string server, string domain, string username, string password) { server = server.TrimEnd(new[] {'/'}); // Initialize an instance of the CrmDiscoveryService Web service proxy. var disco = new CrmDiscoveryService { Url = String.Format("{0}/MSCRMServices/2007/SPLA/CrmDiscoveryService.asmx", server) }; //Retrieve a list of available organizations. var orgResponse = (RetrieveOrganizationsResponse) disco.Execute( new RetrieveOrganizationsRequest { UserId = domain + "\\" + username, Password = password }); //Find the desired organization. foreach (var orgDetail in orgResponse.OrganizationDetails) { if (orgDetail.OrganizationName != organization) continue; //Retrieve the ticket. var ticketResponse = (RetrieveCrmTicketResponse) disco.Execute( new RetrieveCrmTicketRequest { OrganizationName = organization, UserId = domain + "\\" + username, Password = password }); //Create the CrmService Web service proxy. var token = new CrmAuthenticationToken { AuthenticationType = 2, OrganizationName = organization, CrmTicket = ticketResponse.CrmTicket }; return new CrmService { CrmAuthenticationTokenValue = token, Url = orgDetail.CrmServiceUrl }; } return null; }
