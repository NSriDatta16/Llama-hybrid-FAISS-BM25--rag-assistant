[site]: crossvalidated
[post_id]: 447308
[parent_id]: 
[tags]: 
How to express the PCA principal components as a linear combination of input data?

In this paper in equation 1 it shows that the principal component vectors are the eigenvectors of the covariance matrix and gives the following equation $$\lambda_l\psi_l=C\psi_l$$ where $C$ is the covariance matrix. Then it says that since eigenvectors lie in the span of data: $$\psi_l = \frac{1}{\lambda_l}C\psi_l= \frac{1}{n\lambda_l}\sum_{i=1}^n\langle\mathbf{x}_i, \psi_l \rangle \mathbf{x}_i$$ I do not understand how the last equality has been obtained. Suppose $C = X^TX$ , then one has $$\psi_l = \frac{1}{\lambda_l}(X^TX)\psi_l=$$ which to me looks different from $$\frac{1}{n\lambda_l}\sum_{i=1}^n\langle\mathbf{x}_i, \psi_l \rangle \mathbf{x}_i = \frac{1}{n\lambda_l}(\mathbf{x}_1^T \psi_l \mathbf{x}_1 + \mathbf{x}_2^T \psi_l \mathbf{x}_2+\cdots)$$ Can please someone explain this passage?
