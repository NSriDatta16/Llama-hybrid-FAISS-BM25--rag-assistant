[site]: stackoverflow
[post_id]: 1331462
[parent_id]: 1330993
[tags]: 
If you need to create a SQL job in SQL Server Agent (assuming you have rights), you have to create the following: 1) The job itself 2) A step in the job to run the SQL code 3) A schedule of when to run it. The following stored procedures are necessary to do this (working example): BEGIN TRY BEGIN TRAN DECLARE @jobId BINARY(16) --Add job EXEC msdb.dbo.sp_add_job @job_name=N'Job Name', @job_id = @jobId OUTPUT --Add step to job EXEC msdb.dbo.sp_add_jobstep @job_id=@jobId, @step_name=N'Do SQL Stuff', @step_id=1, @subsystem=N'TSQL', @command=N'SELECT ''Hello, I am a query'';', @database_name=N'DB_Name', @flags=0 --Add schedule to job EXEC msdb.dbo.sp_add_jobschedule @job_id=@jobId, @name=N'Mon-Fri 6:00AM to 7:00PM, every hour', @freq_type=8, @freq_interval=62, @freq_subday_type=8, @freq_subday_interval=1, @freq_relative_interval=0, @freq_recurrence_factor=1, @active_start_date=20090403, @active_end_date=99991231, @active_start_time=60000, @active_end_time=190000 COMMIT TRAN END TRY BEGIN CATCH SELECT ERROR_Message(), ERROR_Line(); ROLLBACK TRAN END CATCH As for the sprocs themselves, you'll want to check out the syntax here: sp_add_job sp_add_jobstep sp_add_jobschedule It's a little tricky, but that should get you going.
