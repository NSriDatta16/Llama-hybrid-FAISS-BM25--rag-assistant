[site]: crossvalidated
[post_id]: 614714
[parent_id]: 
[tags]: 
Intermediate variables in Bayesian model for binomial data

Let us assume we have the data modeled $D|\pi\sim Binomial (N,\pi)$ , where we assume $N$ is given throughout. We also have that $\pi|\theta \sim V( \theta )$ where $V$ is a known distribution and $\theta$ is a vector of parameters. Let us assume we know $f(\theta)$ and it is easy to compute. I tried applying this model through the following process in Stan: Sample $\theta$ from $f(\theta)$ Sample $\pi$ from $V(\theta)$ given the above value of $\theta$ . Sample $D$ from $Binomial(N,\pi)$ . The following is the code I used in the model part of Stan: theta ~ prior(prior_params); pi ~ V(theta); defaults ~ binomial(credits,pi); However, when I run the chains, the parameters $\theta$ don't seem to respond to the data . In fact, $f(\theta|D) \approx f(\theta)$ . I don't know why this happens, probably due to a misspecification of the model. I think it might have to do with the fact that the likelihood is responding only to $\pi$ , this is, $f(D|\pi,\theta) = f(D|\pi)$ , but I thought that through the sampling of $\pi|\theta$ the model would "take into account" $\theta$ .
