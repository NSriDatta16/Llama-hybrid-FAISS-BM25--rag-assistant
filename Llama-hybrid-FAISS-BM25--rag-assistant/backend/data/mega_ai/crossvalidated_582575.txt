[site]: crossvalidated
[post_id]: 582575
[parent_id]: 
[tags]: 
An aggressive overfitting situation

I gather RNA-seq transcriptomic data from multiple cancer datasets. The datasets are about a treatment of cancer, we check Response vs NoResponse samples. The RNA-seq data I gather is before the patients get the treatment, and I have the labels if they responded or not when they got it. After normalizing and everything, I do a cell type enrichemnt analysis to get the cellular abundance in each sample. I'll dput a sample for you to see. I'm trying to do a random forest madel to predict response to treatment (Response/NoResponse) according to the cell type enrichemnt analysis scores, so the features are the cells. I'm getting a weird overfitting in the training data, it's sensitivity = 1 and Specificity = 1 ! I tried choosing the best features by calculating the correlation between the features and the target feature. The target feature is called response . But it's the same result. Could this be because I have more NoResponse samples than Response ? I'm not sure what can I do. The dataframe containting the predictive features and the target feature: structure(list(response = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c("NoResponse", "Response"), class = "factor"), Adipocytes = c(0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0212089093123119, 0.0710538305419062, 0.0147750026478847, 0.0147750026478847, 0.195566398508194, 0.0147750026478847, 0.03148495177369, 0.0209623568445265, 0.0147750026478847, 0.0385820621362354, 0.457147252643574, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0372385830882117, 0.0147750026478847, 0.0147750026478847, 0.117093492324988, 0.0200139894212207, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0306067823145819, 0.0462209129117783, 0.125890716604622, 0.0147750026478847, 0.0147750026478847, 0.0502428119949542, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0147750026478847, 0.0229195060222161, 0.15774831871811, 0.395015219066425, 0.0147750026478847, 0.023541858915849, 0.00317057945683111), B.cells = c(0.0771628600461939, 0.0348430059727367, 0.166843196901955, 0.029029065282152, 0.0289092657550142, 0.0091727181061411, 0.0545426703298063, 0.198427181109445, 0.0319579612181801, 0.0241296780923663, 0.0801906580436442, 0.0558608580744781, 0.09791207267786, 0.0404539025479183, 0.0091727181061411, 0.0155937860993973, 0.0091727181061411, 0.0192594587343365, 0.117373430716916, 0.0241917574301587, 0.0616606064532115, 0.0091727181061411, 0.0564673805832464, 0.0341838201429177, 0.0571424583441413, 0.0091727181061411, 0.0465817621371234, 0.581924075266777, 0.0091727181061411, 0.0420178342162006, 0.0331049022892378, 0.0453474174910372, 0.0091727181061411, 0.0091727181061411, 0.0091727181061411, 0.0091727181061411, 0.0412974981430819, 0.0596295150736782, 0.0318722986292883, 1.23191849316306, 0.615248059772284, 0.0091727181061411, 0.0371622059132958, 0.0896465301963868, 0.0343231210909967, 0.0322138280154806, 0.132275729276147, 0.0204347819343309, 0.0537335509001392, 0.428832453855609 ), CD4..memory.T.cells = c(0.053430101401256, 0.00519336879475164, 0.00519336879475164, 0.0135894934563294, 0.00519336879475164, 0.00519336879475164, 0.0187854542183181, 0.059374646637494, 0.00519336879475164, 0.0348873259574374, 0.00519336879475164, 0.00519336879475164, 0.0130145033395148, 0.0108243648791272, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.0386774706987467, 0.00519336879475164, 0.0152495735787879, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.0106190577310956, 0.115657236795, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.00519336879475164, 0.0228019225407499, 0.00519336879475164, 0.00519336879475164, 0.285817134588586, 0.0798512249499361, 0.00519336879475164, 0.00519336879475164, 0.0390009602747167, 0.0223520634520687, 0.00519336879475164, 0.0355128010218804, 0.00519336879475164, 0.0361560602089727, 0.10170523542721), CD4..naive.T.cells = c(0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0582606785266521, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0296986764412145, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.215334820624586, 0.0262477838997226, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.0198799983437911, 0.04321827513143), CD4..Tcm = c(0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.0175826566312307, 0.0272165330006038, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, 0.00895339952677872, -0.020498579601533), CD4..Tem = c(0.208321662455138, -0.0224450621066637, 0.244772119192678, 0.113347067043941, -0.0224450621066637, -0.0224450621066637, 0.113090144548323, 0.192577319884908, 0.0403318363283177, 0.00426014693275098, -0.0224450621066637, 0.0366900251228964, 0.0976155810100715, 0.0701591175042694, 0.110909216979828, 0.0329537028021786, -0.0224450621066637, 0.0181771156088271, 0.256462406269812, 0.0737156950816151, 0.200204622833394, 0.010672770537593, 0.169297782424135, -0.0163636187192579, 0.0371038859309021, -0.0129890972060817, 0.0551755573206458, 0.231403895739896, -0.0224450621066637, -0.0224450621066637, 0.0565882705964922, -0.00129392006665355, -0.0224450621066637, 0.0112677752133609, 0.0117718143367369, -0.0147764423475981, 0.13259160786544, 0.098744522086714, -0.0224450621066637, 0.385620663725697, 0.243531638869625, 0.00692025213710247, -0.0224450621066637, 0.218345966295905, 0.0114841832448024, 0.0159665128102054, 0.231159531777702, -0.00247230872474045, 0.145452900874445, -0.022074533854195), CD8..T.cells = c(0.0429803199103541, 0.00891021585783369, 0.040661480211661, 0.0334424972210585, 0.00891021585783369, 0.00891021585783369, 0.0210886399714806, 0.0312508832149443, 0.021399058970034, 0.00891021585783369, 0.0464969956414465, 0.00891021585783369, 0.0597161308248518, 0.00891021585783369, 0.0263391028766116, 0.00891021585783369, 0.00891021585783369, 0.00891021585783369, 0.0289056708330888, 0.00891021585783369, 0.0808976206945492, 0.00891021585783369, 0.0546180306082866, 0.00891021585783369, 0.00891021585783369, 0.00891021585783369, 0.0192938908517714, 0.202961320669328, 0.00891021585783369, 0.00891021585783369, 0.0416687925983116, 0.00891021585783369, 0.00891021585783369, 0.00891021585783369, 0.00891021585783369, 0.00891021585783369, 0.00891021585783369, 0.0963548651255882, 0.00891021585783369, 0.322162037819989, 0.121502208156791, 0.00891021585783369, 0.00891021585783369, 0.144696390491474, 0.0591458822871633, 0.00891021585783369, 0.135462537636314, 0.00891021585783369, 0.024537344899928, 0.20502578132799), CD8..Tcm = c(0.176720101781808, 0.00581102495348059, 0.221945114398147, 0.0639343044432995, 0.0178687119733511, 0.00581102495348059, 0.133883293706604, 0.150735219431638, 0.0136776611433168, 0.00581102495348059, 0.0630130006683658, 0.0182663196214919, 0.107609311940101, 0.0207428571059703, 0.00581102495348059, 0.00581102495348059, 0.00581102495348059, 0.0175670891853529, 0.161276521567139, 0.0241746196982096, 0.141529760439193, 0.0133030196283767, 0.135213572153093, 0.00581102495348059, 0.0458291890386873, 0.00581102495348059, 0.0823638868910431, 0.350372886962457, 0.00581102495348059, 0.0239535257290405, 0.0785239995418782, 0.0405910587213808, 0.00581102495348059, 0.00581102495348059, 0.0145817120934915, 0.00581102495348059, 0.095811246891438, 0.203768998866003, 0.00581102495348059, 0.4892799402034, 0.241912164106039, 0.00581102495348059, 0.00581102495348059, 0.349763543913969, 0.138069586770413, 0.074621072015713, 0.277625484695461, 0.00581102495348059, 0.0771193539361913, 0.266409329836642 ), Class.switched.memory.B.cells = c(0.0186163005631355, 0.0109778090296147, 0.000877811294155487, 0.000877811294155487, 0.000877811294155487, 0.000877811294155487, 0.0219672397563202, 0.0930760958303154, 0.0233118435736233, 0.0253617973333969, 0.0246526603446228, 0.000877811294155487, 0.000877811294155487, 0.0133806302606254, 0.0127253696369109, 0.000877811294155487, 0.000877811294155487, 0.000877811294155487, 0.0686773883896931, 0.0237448744393757, 0.000877811294155487, 0.0264271438018299, 0.0194740843884333, 0.000877811294155487, 0.033257158433109, 0.000877811294155487, 0.000877811294155487, 0.137449067212094, 0.000877811294155487, 0.000877811294155487, 0.000877811294155487, 0.000877811294155487, 0.00699662527499653, 0.0182136870222026, 0.063989521603475, 0.000877811294155487, 0.000877811294155487, 0.000877811294155487, 0.0109235151814757, 0.305416318953345, 0.152030733616603, 0.000877811294155487, 0.000877811294155487, 0.0744399768789527, 0.0087876637113942, 0.000877811294155487, 0.0349885495887569, 0.000877811294155487, 0.00630073936593531, 0.103214460194488), DC = c(0.0627408320157673, -0.00168836726875518, 0.1314456096041, 0.00964228989410464, 0.0739182180290374, -0.00168836726875518, 0.0177762448557483, 0.0303212842246023, 0.00749921280846947, -0.00168836726875518, 0.0150285341587616, 0.0296573328804767, 0.0461693098214835, 0.0686570439022522, 0.038669604759573, -0.00168836726875518, -0.00168836726875518, -0.00168836726875518, 0.0624313618016044, 0.0705174050859654, 0.0106450105986679, 0.0090862010702573, 0.0395164929196793, -0.00168836726875518, 0.0133931577498369, 0.00850685740664131, -0.00168836726875518, 0.0572812545510841, -0.00168836726875518, -0.00168836726875518, 0.0288160607835395, 0.0191992764853916, -0.00168836726875518, -0.00168836726875518, 0.0156471042112208, 0.0196273524064872, 0.0721483517002003, 0.0366149813957128, -0.00168836726875518, 0.0490318433995858, 0.0333066698707157, 0.0066223556808794, -0.00168836726875518, 0.0327736313965906, 0.0519635603762234, 0.0271503935596172, 0.0724328376416021, -0.00168836726875518, 0.0167379571779776, 0.0123655223301404 ), Eosinophils = c(0.00327106587553642, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, 0.00876339214809247, -0.00389550268541235, 0.0333804946909619, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, 0.0148773439391603, 0.00255416166066931, 0.00400863904905059, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, 0.00251515892128217, 0.00263990086574005, 0.00445449445241401, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, 0.00359749972304104, 0.00634709158741494, -0.00389550268541235, 0.00229348890876447, 0.00203923357667011, 0.0156384390061195, -0.00389550268541235, -0.00389550268541235, 0.0197090110194976, -0.00389550268541235, -0.00389550268541235, -0.00389550268541235, 0.00270741190122905, 0.0205921722464569, 0.0681738948692956, -0.00389550268541235, -0.00389550268541235, 0.0409426275489052, -0.00389550268541235, 0.00209768512043047, -0.00389550268541235, -0.00389550268541235, 0.0151700782395075, -0.00468239944448284 ), Fibroblasts = c(0.11762408484995, 0.14382782933029, 0.314602377450022, 0.289162389274534, 0.104566867721627, 0.254531486052156, 0.218363614723363, 0.280713014345311, 0.15355350812186, 0.108751856925431, 0.178759504912724, 0.192063143824822, 0.277626129527884, 0.474037865291267, 0.199356591903083, 0.182064326222487, 0.25477912705766, 0.143412731571524, 0.344861603128791, 0.191727105092441, 0.0935903153903553, 0.23682943154226, 0.20376836698534, 0.153789605065083, 0.164228486845565, 0.116343712372548, 0.104015110176871, 0.236415519619874, 0.170954640603697, 0.141940456441942, 0.289209531592235, 0.229117728023948, 0.339685519101528, 0.141034348250998, 0.220344248785784, 0.177374378854885, 0.0935903153903553, 0.256806363679094, 0.197567366431068, 0.109698100331148, 0.0991158081751921, 0.120280648980638, 0.110452982012897, 0.2408376595761, 0.265397568528309, 0.205124149078304, 0.290116368630962, 0.0935903153903553, 0.223853076829659, -0.0549422959940263), Hepatocytes = c(0.021887151146922, 0.021887151146922, 0.0285696151827946, 0.021887151146922, 0.0274899553596649, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.359127214659253, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.0393053950524979, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.114347973751529, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.48250750826667, 0.021887151146922, 0.021887151146922, 0.021887151146922, 0.015036805962326), ly.Endothelial.cells = c(0.0165442072297054, 0.0165442072297054, 0.0532579511754237, 0.0318042593288582, 0.0165442072297054, 0.0165442072297054, 0.0320935846953594, 0.0516395826364901, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0280997964796057, 0.126363440616145, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0410639459872746, 0.0165442072297054, 0.0165442072297054, 0.0231427455117152, 0.0263474318936666, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0631286101791627, 0.0222401565157868, 0.0165442072297054, 0.0380439364305072, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0578195530512242, 0.0165442072297054, 0.0165442072297054, 0.0388413287164726, 0.0165442072297054, 0.0346786759155522, 0.0389467037757679, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0165442072297054, 0.0493310969961597, 0.0994311409817459, 0.0165442072297054, 0.0745451373433449, -0.0509685926025931 )), row.names = c("Pt1", "Pt10", "Pt103", "Pt106", "Pt11", "Pt17", "Pt2", "Pt24", "Pt26", "Pt27", "Pt28", "Pt29", "Pt31", "Pt36", "Pt37", "Pt38", "Pt39", "Pt4", "Pt46", "Pt47", "Pt5", "Pt52", "Pt59", "Pt62", "Pt65", "Pt66", "Pt67", "Pt77", "Pt78", "Pt79", "Pt8", "Pt82", "Pt84", "Pt85", "Pt89", "Pt9", "Pt90", "Pt92", "Pt98", "Pt101", "Pt18", "Pt3", "Pt30", "Pt34", "Pt44", "Pt48", "Pt49", "Pt72", "Pt94", "EA595454"), class = "data.frame") My code: library(caret) library(MLeval) library(DMwR2) library(predtools) corVec = sapply(scoresWithResponse[-1], ltm::biserial.cor, scoresWithResponse[[1]]) vc = corVec > 0.01 | corVec $response = data$ response training = createDataPartition(y = scoresWithResponse$response, p=0.8, list = FALSE) scoresWithResponse.trn = scoresWithResponse[training, ] scoresWithResponse.tst = scoresWithResponse[-training,] ctrlCV = trainControl(method = 'cv', number = 10 , classProbs = TRUE , savePredictions = TRUE) rfFit The ROC plot: Your help would be very appreciated!
