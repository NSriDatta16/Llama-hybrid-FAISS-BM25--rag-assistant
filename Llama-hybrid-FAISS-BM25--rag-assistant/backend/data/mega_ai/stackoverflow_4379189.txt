[site]: stackoverflow
[post_id]: 4379189
[parent_id]: 4378861
[tags]: 
With so much functionality behind functions that you haven't provided, it's hard to say whether anything needs to be fixed. Are you making sure the input is clean in post() ? Are your database calls secure in user::check() ? Are you using session cookies to simplify user prefs/info storage? Is your template class well-written? When you create a new user, are you logging all the necessary information (time of login, IP address if necessary, etc)? Are you ensuring that the user isn't doubly logged in, if that's important here? The only concrete thing I can tell you about what you wrote is that the sha1 algorithm is completely broken , and you should be using something else instead; see the comments below for suggestions.
