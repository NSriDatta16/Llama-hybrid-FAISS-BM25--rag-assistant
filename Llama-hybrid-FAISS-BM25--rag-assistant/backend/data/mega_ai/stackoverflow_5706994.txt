[site]: stackoverflow
[post_id]: 5706994
[parent_id]: 
[tags]: 
WCF IOutboundHandler Send non xml

I am trying to write a custom WCF Adapter using the WCF LOB Adapter SDK. Everything seems to work ok, except that I need to send a text string to the downstream system over a socket. When the Execute Method of the IOutboundhandler gets exectued I get the following error: System.Xml.XmlException: Data at the root level is invalid. Line 1, position 1. With the following stack trace: at System.ServiceModel.AsyncResult.End[TAsyncResult](IAsyncResult result) at System.ServiceModel.Channels.ServiceChannel.SendAsyncResult.End(SendAsyncResult result) at System.ServiceModel.Channels.ServiceChannel.EndCall(String action, Object[] outs, IAsyncResult result) at System.ServiceModel.Channels.ServiceChannel.EndRequest(IAsyncResult result) Exception rethrown at [0]: at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) at System.ServiceModel.Channels.IRequestChannel.EndRequest(IAsyncResult result) at Microsoft.BizTalk.Adapter.Wcf.Runtime.WcfClient`2.RequestCallback(IAsyncResult result)". Here is my execute Method: /// /// Executes the request message on the target system and returns a response message. /// If there isnâ€™t a response, this method should return null /// public Message Execute(Message message, TimeSpan timeout) { OperationMetadata om = this.MetadataLookup. GetOperationDefinitionFromOutputMessageAction(message.Headers.Action, timeout); if (om == null) { throw new AdapterException("Invalid operation " + message.Headers.Action); } MessageBuffer msgBuffer = message.CreateBufferedCopy(int.MaxValue); XmlDictionaryReader reader = msgBuffer.CreateMessage().GetReaderAtBodyContents(); XmlDocument request = new XmlDocument(); request.LoadXml(reader.ReadOuterXml()); string positionalRs = this.Connection.Send(request.OuterXml); XmlDocument response = new XmlDocument(); response.LoadXml(positionalRs); XmlReader replyReader = XmlReader.Create(new StringReader(response.InnerXml)); return Message.CreateMessage(message.Version, message.Headers.Action + "/Response", replyReader); } How can I access the body of a WCF message that is not xml? here is what my WCF Message looks like: Message: TCPCall urn:uuid:e473f4e4-f6f5-47b5-92a6-123116fafaa5 http://www.w3.org/2005/08/addressing/anonymous ... stream ... the body of the message is not xml. whenever I try and acess it I get the following error: "System.Xml.XmlException: Data at the root level is invalid. Line 1, position 1. I am trying to send data at a socket on the other end using wfc. I seem to have everything working, except the ability to pull out the contents of the WCF message if they are not xml. Does that help?
