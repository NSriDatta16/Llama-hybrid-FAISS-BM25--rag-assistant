[site]: datascience
[post_id]: 114223
[parent_id]: 
[tags]: 
AWS Stepfunctions using SageMaker ScriptProcessor

Hello Data Science/Engineer folks, I need a help in orchestrating a ML model using AWS Step Functions. There are some tutorials on using StepFunction with Python SDKs, but all of them are focused around using built in SageMaker container. For my project, I have a custom containers for pre-processing and training the model. I am having trouble on executing PreProcessing with StepFunctions. Below is my ScriptProcessor code: from sagemaker.processing import ScriptProcessor, ProcessingInput, ProcessingOutput script_processor = ScriptProcessor( command=['python3'], image_uri=preprocessing_image, role=role, instance_count=1, instance_type="ml.m5.xlarge", ) script_processor.run( code="preprocessing_container/preprocessing/preprocessing.py", inputs=[ProcessingInput(source=input_data_path, destination="/opt/ml/processing/input")], outputs=[ ProcessingOutput(output_name="train_data", source="/opt/ml/processing/output/train", destination="{}/{}".format(output_data_path, "train_data")), ProcessingOutput(output_name="test_data", source="/opt/ml/processing/output/test", destination="{}/{}".format(output_data_path, "test_data")), ], arguments=["--train-test-split-ratio", "0.2"] ) Step Function: # Create Processing Step processing_step = ProcessingStep( "SageMaker pre-processing step", processor=script_processor, job_name=execution_input["PreprocessJobName"], inputs=inputs, outputs=outputs, container_arguments=["--train-test-split-ratio", "0.2"], container_entrypoint=["python3", "/opt/ml/processing/input/code/preprocessing.py"], ) This last block of code doesn't seem to accept ScriptProcessor method of SageMaker. Upon executing the StepFunction Workflow as below: workflow_definition = Chain([ processing_step ]) # Next, we define the workflow workflow = Workflow( name="MyWorkflow-preprocess", definition=workflow_definition, role=workflow_execution_role ) workflow.create() I get following errors: ClientError : An error occurred (AccessDeniedException) when calling the CreateStateMachine operation: 'arn:aws:iam::292065629009:role/AmazonSageMaker-StepFunctionsWorkflowExecutionRole' is not authorized to create managed-rule. I initially thought it was permission issue, however, i was able to execute a simple stepfunction workflow using 'hello world' example. I am wondering, if anyone has a way to come around this step. Thank you
