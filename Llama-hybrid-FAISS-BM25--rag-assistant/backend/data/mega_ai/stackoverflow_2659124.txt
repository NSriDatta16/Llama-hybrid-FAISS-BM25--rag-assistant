[site]: stackoverflow
[post_id]: 2659124
[parent_id]: 2548127
[tags]: 
I can't speak to why your technique isn't working, but here's how I accomplished a similar thing. From what I gather in your code examples you only want users that are affiliated with a mission's organization to be able to manage that mission. Furthermore that user must be of type admin. What I've done in the past is created a has_many relationship in your organization model that has a few extra conditions that filter out affiliations that not of type admin: has_many :admins, :source => :user, :through => :affiliations, :conditions => "affiliations.type = 'admin'" Then in your authorization_rules.rb you add in this rule: has_permission_on :missions, :to => [:manage] do { if_attribute :organization => {:admins => contains {user}}}
