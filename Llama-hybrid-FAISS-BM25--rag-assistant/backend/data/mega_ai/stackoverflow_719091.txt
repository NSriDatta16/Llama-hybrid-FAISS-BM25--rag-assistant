[site]: stackoverflow
[post_id]: 719091
[parent_id]: 718757
[tags]: 
they receive 2 php lines that they have to insert into their shop. This is incredibly dodgy. include() drags in code from the given URL and executes it . I would never allow an affiliate network to add PHP code to my application: this gives an external site total control over my application and database. This is especially unacceptable running over unencrypted HTTP: any man-in-the-middle attack can immediately compromise the server. Also if you have a cross-site-scripting hole in your tracker.php, any end user can completely compromise the customer site. I strongly advise finding a less insecure way to interface your network with third-party apps. If you are only intending to return HTML to be shown in the final page, and not PHP code, you can do that using readfile() , or the more usual method which is to have the affiliate insert a client-side tag pointed at your site. You should also be using urlencode() so that any URL-special characters in the parameter are correctly escaped. value="http://www.mydomain.com/ipn.php?xyz= " And here, plus you should, like any time you output any text content to HTML, be using htmlspecialchars() to encode HTML-special characters. Otherwise you are vulnerable to cross-site scripting attacks. There's not really, at the moment, enough information in your question to diagnose exactly what some of your affiliates are doing wrong. More concrete examples would be of use. But from what you've posted so far I have huge concerns about the security of your system at the most basic level.
