[site]: crossvalidated
[post_id]: 510761
[parent_id]: 
[tags]: 
Find latent variable using rSTAN

I have the following simulated data: alpha = c(1,5,-5,0) beta = c(1,2,-1,0) n = 10^3 F I need to estimate the correlation matrix between predictors x1..4 and recover parameters alpha and beta . For correlation matrix I found a way: cor_model [4] Sigma; } model{ vector[4] YY[n]; Sigma ~ exponential( 1 ); Rho ~ lkj_corr( 4 ); mu ~ normal( 0 , 1 ); for ( j in 1:n ) YY[j] = [ x1[j] , x2[j] , x3[j] , x4[j] ]'; YY ~ multi_normal( mu , quad_form_diag(Rho , Sigma) ); } " library(rstan) m1 But, I need to estimate F itself what is equal to alpha ans beta estimation as I understand. I read about Bayesian factor analysis but they use some packages for it and have too complicated examples for me. I tried this code: X=cbind(x1,x2,x3,x4) df2 N; int J; matrix[N, J] y; } parameters{ unit_vector[J] alpha; vector[J] beta; vector [J] sigma; vector[N] x; real x_sigma; } model{ matrix[N,J] mu; x_sigma ~ normal(0, 1); alpha ~ normal(0, 10); beta ~ normal(0, 1); sigma ~ exponential(1); x ~ normal(0, x_sigma); for(i in 1:N){ for(j in 1:J){ mu[i,j] = beta[j] + alpha[j] * x[i]; y[i,j] ~ normal(mu[i,j], sigma[j]); } } } ' fit It gives me a nice estimation of the factor and alpha and beta parameters. Nevertheless, it has a bad chain convergence: Warning messages: 1: There were 33 divergent transitions after warmup. See http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup to find out why this is a problem and how to eliminate them. 2: There were 2 chains where the estimated Bayesian Fraction of Missing Information was low. See http://mc-stan.org/misc/warnings.html#bfmi-low 3: Examine the pairs() plot to diagnose sampling problems 4: The largest R-hat is 1.18, indicating chains have not mixed. Running the chains for more iterations may help. See http://mc-stan.org/misc/warnings.html#r-hat 5: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. Running the chains for more iterations may help. See http://mc-stan.org/misc/warnings.html#bulk-ess 6: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. Running the chains for more iterations may help. See http://mc-stan.org/misc/warnings.html#tail-ess As I understand it happens because of covariance and I should use cholesky_decompose approach. Unfortunately, my math background is rather poor to understand examples, which I found. Could You help me with a link to a SIMPLE example, or write it here? I may imagine another source of bad MCMC results. It is badly constrained factor loadings vector alpha . I defined it as unit_vector[J] alpha . As you may simply revert signs, it will be nice to be able to constrain somehow alpha[1]>0 . This is not optimal solution when alpha[1] is close to zero. Better solution wil be to constrain sum(alpha)>0 . I am new in STAN, so I need help with these constrains. In other words: Could you help me to add in my model constrains for alpha : alpha[1]>0 or sum(alpha)>0 ? Update: I found a way for alpha[1]>0 or sum(alpha)>0 : alpha[1]~exponential(1) or sum(alpha)~exponential(1) but chains are still bad.
