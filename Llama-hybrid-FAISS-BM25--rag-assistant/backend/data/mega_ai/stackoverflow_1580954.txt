[site]: stackoverflow
[post_id]: 1580954
[parent_id]: 
[tags]: 
Finding what is different from VB(MSVisualStudio 2005) and VBA(Excel)

I found code online for something I wanted to do. As usual, I fired it up in Visual Studio and it works no problem. The problem occurs in that, when I try to port it over to Excel, it ceases to work. As I understand, VBA is a watered down version of VB. (Based on reading this article: Difference between Visual Basic 6.0 and VBA ) Therefore, how to I find out what is lost between going between the two programming environments? To give a bit more detail: I wrote a program in Visual Studio that sends me an email when I press a button. I then tried to port it into Excel as a Macro, but that didn't work. EDIT: Adeed additional problem information Here is what I have in Visual Studio Public Class Form1 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click CDO_Mail_Small_Text() End Sub Sub CDO_Mail_Small_Text() Dim iMsg As Object Dim iConf As Object Dim strbody As String Dim Flds As Object iMsg = CreateObject("CDO.Message") iConf = CreateObject("CDO.Configuration") iConf.Load(-1) ' CDO Source Defaults Flds = iConf.Fields With Flds .Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2 .Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") _ = "morgan" .Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25 .Update() End With strbody = "Hi there" & vbNewLine & vbNewLine & _ "This is line 1" & vbNewLine & _ "This is line 2" & vbNewLine & _ "This is line 3" & vbNewLine & _ "This is line 4" With iMsg .Configuration = iConf .To = "Jeremiah.Tantongco@Powerex.com" .CC = "" .BCC = "" .From = """Ron"" " .Subject = "Important message" .TextBody = strbody .Send() End With End Sub End Class Here is what I have running in Excel: Sub Button1_Click() CDO_Mail_Small_Text End Sub Sub CDO_Mail_Small_Text() Dim iMsg As Object Dim iConf As Object Dim strbody As String Dim Flds As Object iMsg = CreateObject("CDO.Message") iConf = CreateObject("CDO.Configuration") iConf.Load (-1) Flds = iConf.Fields With Flds .Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2 .Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") _ = "morgan" .Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25 .Update End With strbody = "Hi there" & vbNewLine & vbNewLine & _ "This is line 1" & vbNewLine & _ "This is line 2" & vbNewLine & _ "This is line 3" & vbNewLine & _ "This is line 4" With iMsg .Configuration = iConf .To = "Jeremiah.Tantongco@Powerex.com" .CC = "" .BCC = "" .From = """Ron"" " .Subject = "Important message" .TextBody = strbody .Send End With End Sub The not working is a: "Run-time error '91': Object variable or With block variable not set" When I debug it takes me to the following line: "iMsg = CreateObject("CDO.Message")" Cheers, -Jeremiah Tantongco
