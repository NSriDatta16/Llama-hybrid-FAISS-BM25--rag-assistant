[site]: crossvalidated
[post_id]: 596582
[parent_id]: 212701
[tags]: 
It seems like you have the formula for the Cochran–Mantel–Haenszel test wrong. ( Disclaimer: I am not a specialist in these type of tests ) Normal distribution approximation Basic background. For a single 2x2 contingency table you have effectively one degree of freedom. $$\begin{array}{cc|c} x_{11}-y & x_{12}+y & R_1 \\ x_{21}+y & x_{22}-y & R_2 \\ \hline C_1 & C_2 & N \\ \end{array}$$ and $$x_{ij} = \frac{R_iC_j}{N}$$ What these type chi-squared type of tests do is approximate the value of $y$ as a normal distributed variable (with a similar covariance as compared to when we consider the distribution as a multinomial distribution) and look at the distribution of the squared value (or a sum of squared values if there are multiple cells). Cochran–Mantel–Haenszel test Then for $I$ different tables with $I$ different $y_i$ and possibly different variances $V_i$ , the test for the hypothesis $E[y_1] = E[y_2] = \dots = E[y_I] = 0$ (which corresponds to risk ratio's equal to 1) can be tested with the statistic $$\chi^2_a = \frac{\left(\sum_{i=1}^I y_i\right)^2}{\sum_{i=1}^I V_i}$$ According to the null hypothesis the variable $\sum_{i=1}^I y_i$ is approximately normal distributed with zero mean and variance equal to $\sum_{i=1}^I V_i$ . So this is different from your statistic $$\chi^2_b = \sum_{i=1}^I \frac{ y_i^2}{ V_i}$$ The difference is in the power. The $\chi^2_a$ is more sensitive to risk ratio's that differ from 1 and point in the same direction. The $\chi^2_b$ also picks up a difference when the the effects are in opposite directions. Breslow-Day test to be continued... I haven't heard of this test before and a quick search shows that it is not widely know or at least not well described in simple sources. What is seems like is that the test is a sort of mix between $\chi^2_a$ and $\chi^2_b$ and looking for the variability in the risk ratio between different groups assuming that the risk ratio is the same. In the expression $$\chi^2 = \sum_{h=1}^{H}\frac{\left( \sum_i a_i - A_i \right)^{2}}{\sum_i V_i}$$ the term $\frac{\left( \sum_i a_i - A_i \right)^{2}}{\sum_i V_i}$ seems a lot like a CMH test statistic like the $\chi^2_a$ computed above. But now it is done for different groups $\sum_{h=1}^{H}$ like the statistic $\chi^2_b$ . Another difference is probably also that the $A_i$ relates to the average risk ratio rather than the assumption that the ratio should be equal to 1.
