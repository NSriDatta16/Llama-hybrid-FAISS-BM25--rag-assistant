[site]: datascience
[post_id]: 27707
[parent_id]: 
[tags]: 
How to match up categorical labels in training and evaluation

I am creating a CNN to categorise a sentence into one of N possible labels. I have used the tutorial from WildML to start the code, and I have modified it to allow multiple outputs instead of just true/false. I am using VocabularyProcessor to convert the words into numbers and then using OneHotEncoder to transform the labels for evaluation. I am currently using the same VocabularyProcessor for converting both X and y Where x_text is the loaded sentences and y_text is the correct labels max_document_length = max([len(x.split(" ")) for x in x_text]) vocab_processor = learn.preprocessing.VocabularyProcessor(max_document_length) X = np.array(list(vocab_processor.fit_transform(x_text))) y_val = np.array(list(vocab_processor.transform(y_text))) from sklearn.preprocessing import OneHotEncoder onehotencoder = OneHotEncoder(categorical_features = [0]) y = onehotencoder.fit_transform(y_val).toarray() y = y[:, 1:] This then goes through the training. The problem that I am finding is that during evaluation, if the labels are not exactly the same then the indexes do not match the prediction that is coming out. Basically what my question is, is how do I match up the output of the evaluation with the text label so that I can use it after training without hard coding the labels up front
