[site]: stackoverflow
[post_id]: 2053877
[parent_id]: 2052653
[tags]: 
You shouldn't need VBA for this. Here's what you do: Create a new worksheet (Sheet3). Set it up to look like this: alt text http://img16.imageshack.us/img16/2451/consolidationsheet.jpg Here are the formulas you will need (paste each one into the proper cell): Note: the first two are "array formulas" -- after you paste in the formula, double-click the cell and do Ctrl-Shift-Enter (braces {} should appear around the formula) ------------------------------------------------------------------------------ Cell Formula ------------------------------------------------------------------------------ B2 =SUM(IF(Sheet1!A:A="",0,1)) "",INDEX(Sheet1!A:A,D2),IF(E2<>"",INDEX(Sheet2!A:A,E2),"")) H2 =IF(D2<>"",-INDEX(Sheet1!B:B,D2),IF(E2<>"",INDEX(Sheet2!B:B,E2),"")) Drag the formulas in D2:H2 down as far as you need to cover all the data for sheets 1 and 2. Select all the data in columns G & H (including the headings). Do Insert > PivotTable and click OK. Click the Pivot Table and drag []Item to the Row Labels box and []QTY to the Values box. That's it. The Pivot Table will contain a summary for each item. No item will be repeated, and no item will be left out. The "Sum of QTY" column will actually contain the difference (since the formula uses negative for all sheet 1 quantities).
