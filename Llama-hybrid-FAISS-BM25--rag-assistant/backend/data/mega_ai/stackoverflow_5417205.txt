[site]: stackoverflow
[post_id]: 5417205
[parent_id]: 5416473
[tags]: 
Does the output fit in RAM, say in a Map (if your average value fits in an Integer) ? If the answer is yes, then the fastest solution is to keep it in memory during the source file traversal and then to write the output file. If the answer is no, you have to partition the problem and create intermediate results and store them to disk, and then you have to merge the intermediate results to create the end result. If you have to partition the problem, ask a new question with some figures because the answer will really depends on the context...
