[site]: stackoverflow
[post_id]: 5225003
[parent_id]: 5222608
[tags]: 
I guess I'm a bit confused, but here's my go at it. It would have been helpful if you showed some sample output with your question. I also don't see any correlation with ardate8n nor do I completely understand how ss.weekno = s.weekno - 1 works for you. I hope this helps somehow. If it isn't working towards your goals please expand you answer to include expected output, table definitions, and what exactly you are trying to accomplish. Basically it sounds like you have a sales , product , and productfamily table and need to report on the average sales of all products in a product family during a given week (whether it is the current week or the previous one). If I understand this correctly, the following SELECT should work out and be pretty fast, however it will get you all products and every week. SELECT p.prodno, f.familycode, s.custno, s.weekno, AVG( s.sell ) as sales_avg FROM sale s JOIN product p USING(prodno) JOIN productfamily f USING(prodno) GROUP BY s.weekno, f.familycode, p.prodno ORDER BY s.weekno Now, turn this into a view. CREATE VIEW "main"."view_weekly_product_sales_avg" AS SELECT p.prodno, f.familycode, s.custno, s.weekno, AVG( s.sell ) as sales_avg FROM sale s JOIN prod p USING(prodno) JOIN prodfamily f USING(prodno) GROUP BY s.weekno, f.familycode, p.prodno ORDER BY s.weekno; Then query the view/report how you need. From your example, I think you would query it like this: SELECT prodno, custno, sales_avg FROM view_weekly_product_sales_avg WHERE familycode = 1 AND custno = 1 AND weekno = 1 For me this reports out the following table: prodno custno sales_avg 1 1 37.3333333333333 2 1 12.0 3 1 78.0 8 1 12.0
