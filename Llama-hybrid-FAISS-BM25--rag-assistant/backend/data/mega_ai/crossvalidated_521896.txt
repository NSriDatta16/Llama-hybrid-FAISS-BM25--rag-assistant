[site]: crossvalidated
[post_id]: 521896
[parent_id]: 
[tags]: 
Distance from centroid infinite in time series clustering (K-Shape)

I am trying to do time series clustering with R library dtwclust , and more specifically the k-Shape algorithm. I have almost 100,000 time series with 28 time points each. Around 65% of these time series are completely flat (constant, with variance 0). kshape_model = tsclust(data, type="partitional", k= 4, distance="sbd",centroid = "shape",preproc=zscore,seed=1234,trace=T, args = tsclust_args(dist = list(window.size = NULL))) I noticed that when I (successfully) run the algorithm, those who have a constant time series also show a value of infinite with respect to its corresponding centroid. kshape_model@cldist I would really appreciate if someone could give some intuition of why this happens since they are assigned to a cluster and when plotting its centroid does not look weird. Does it have something to do with the window size? Thanks for your help! EDIT : To add information regarding the problem: I have almost 100k patients and I have the total number of chronic conditions they have over time, thus each time series can only be either constant or increasing because once you have a chronic condition you cannot get rid of it. The level that each patient starts at can also be different as when I start following them up they might already have 2,3,.. conditions. Then, the objective is to find clusters of patients that evolve similarly such that we can have several progression patterns. Having constant patterns is fine, since for clinical practice it's informative e.g. having 1 chronic condition and not developing any other ever again is something relevant to know. Hence, we care about constant time series. The time series are count data e.g. 1,2,3,4... conditions, and they range 0 to 13 (having 13 chronic conditions is pretty bad).
