[site]: crossvalidated
[post_id]: 408592
[parent_id]: 408547
[tags]: 
AFAIK a full (restricted) maximum likelihood estimation approach for this model is not possible with neither nlme nor lme4 . But you could, for example, do it under a Bayesian approach using either STAN or JAGS. As a alternative you could do a two-stage approach in which you first fit a mixed model for x , and the you plug-in the subject-specific fitted values in a linear regression for y . E.g., fm
