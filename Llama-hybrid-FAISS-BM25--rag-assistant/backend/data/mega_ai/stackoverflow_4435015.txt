[site]: stackoverflow
[post_id]: 4435015
[parent_id]: 4433821
[tags]: 
I think the primary problem is that you're using a CASE improperly in a GROUP BY . I think most SQL platforms would complain if you try something like that, but MySQL will just give you bunk/random results and smile. At any rate, I think you have to use a subquery to get what you want due to the unusual schema. Something like this SELECT sq.memberid, sq.firstname, sq.lastname, SUM(sq.cost) AS total_cost, SUM(sq.commission) AS total_commission FROM ( SELECT m.memberid, m.firstname, m.lastname, g.cost, CASE WHEN g.type = '7' THEN (g.cost * cl.type1) WHEN g.type = '8' THEN (g.cost * cl.type2) WHEN g.type = '9' THEN (g.cost * cl.type3) END as commission FROM members m LEFT JOIN selections s USING(memberid) LEFT JOIN groups g USING(programid) LEFT JOIN comp_levels cl ON cl.level = '2' WHERE m.agent = '123' ) sq GROUP BY sq.memberid You can run the subquery by itself to trace what's going on. Using your data, it gives the result +----------+-----------+----------+------------+------------------+ | memberid | firstname | lastname | total_cost | total_commission | +----------+-----------+----------+------------+------------------+ | 444 | john | smith | 90.00 | 15.800 | | 555 | sarah | stevens | 90.00 | 15.800 | | 777 | harry | tabour | 90.00 | 15.800 | +----------+-----------+----------+------------+------------------+ NB: due to the unusual (lack of) normalization, i.e. mapping the types (7,8,9) to type fields (type1,type2,type3), this an awkward problem to wrap a head around. Moreover, I think you might have had some typos in your test data description; i.e. the type values in your SQL, and the total cost in your query output and desired result.
