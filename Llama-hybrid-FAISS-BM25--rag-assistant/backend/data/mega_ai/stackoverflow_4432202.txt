[site]: stackoverflow
[post_id]: 4432202
[parent_id]: 4431305
[tags]: 
It doesn't work because the DragEnter event handler is missing. You need to set e->Effect to one of the e->AllowedEffects to get the DragDrop event to run. DragOver is only meant to provide feedback. Starting a drag on MouseDown indeed interferes with the Click event, there won't be a mouse up event to trigger the click. If you want to support both then you need to make it more selective and only start the drag when you see the user making a dragging motion. That requires storing the mouse position in the MouseDown event. Use the MouseMove event to check if the left button is still down. And call DoDragDrop() when you see the mouse moved by more than SystemInformation::DoubleClickSize. Furthermore, you should check in the DragEnter event handler that an object is being dragged that you know how to handle. You wouldn't want to, say, accept a drag a file from Explorer.
