[site]: crossvalidated
[post_id]: 256379
[parent_id]: 
[tags]: 
Tests for independence in ragged arrays / bipartite matchings

Let $(Y_i, K_i)$, $i=1,\dotsc,N$ be pairs of observations drawn from discrete labels $L$ and discrete clusters IDs $C$. For example $Y$ could be individual birds, $L$ could be a set of species and $C$ could be the location of bird feeders where the birds are observed. (In this contrived example assume the birds may only visit one feeder.) |species(Y) |feeder(K) | |:------------|:---------| |chickadee |A | |starling |A | |crow |A | |chickadee |B | |chickadee |B | |crow |C | |crow |C | We are interested if $Y \perp K$ conditional on both the number and size of the clusters. One method to test this would be to permute $Y$, and calculate some statistic and estimate the tail probability of the statistic under permutation. Let $\left(\tilde{Y}_i, \tilde{K}_i \right)$ be such as permutation. Then one statistic we might consider is $S\left(\tilde{Y}_i, \tilde{K}_i \right)$, the number of clusters comprised of purely a single species, find its distribution under independence by repeated permutation and then compare to an observed value. Questions: Is there a more powerful test for independence than $S\left(Y_i, K_i \right)$? My intuition that some sort of studentization would lead to a superior test. Is there a way to cast this a GLM somehow? Is there a way to adjust for a covariate, that is, test if $Y \perp K | X$? A naive approach would be to calculate $S$, and permute only within each level of $X$. This would only seem to work when $X$ is discrete and seems hopelessly inefficient when $X$ is sparse. Edit: A contingency table formulation Note this forms a bipartite graph between colored vertices Y and uncolored K, or assuming an IID distribution within each cluster and label pair, we could summarize the data as a $L \times C$ contingency table: $$ \begin{array}[lccc] N & \text{chickadee} & \text{crow} & \text{starling} \\ A & 1 & 1 & 1\\ B & 2 & 0 & 0 \\ C & 0 &2 & 0 \end{array} $$ When written like this, Fisher's exact test for 2-way ($>2\times 2$) tables is now gazing suspiciously in my direction.
