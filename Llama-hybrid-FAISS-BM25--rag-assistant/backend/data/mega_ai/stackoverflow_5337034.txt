[site]: stackoverflow
[post_id]: 5337034
[parent_id]: 
[tags]: 
Intermittent time series. Return first date of last contiguous block of most recent data in T-SQL

10/03/2011 11/03/2011 12/03/2011 13/03/2011 14/03/2011 15/03/2011 QUERYRESULT a a a a a 14/03/2011 b b b 13/03/2011 c c c c 12/03/2011 So for the most recent block of contiguous dates, return the earliest date from that particular block, as shown in the 'queryresult' column. I realise now that I've inadvertently transposed the data in the example I gave For source can assume schema is: [ID] 1,2,3,...; [type] a,b,c..; [date] I can sort of see something with recursive CTE/window/ranking functions, but can't quite figure it out.
