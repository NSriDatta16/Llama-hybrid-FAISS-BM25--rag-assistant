[site]: crossvalidated
[post_id]: 441147
[parent_id]: 
[tags]: 
Variance Estimation for Least Squares with Probability Weights

I'm running a simulation study and finding that the nominal SEs of the estimated coefficients when using weights in lm in R are an underestimate of the simulation SE. I have confirmed that $\hat{\beta}$ is estimated correctly. I believe that this is a well known phenomenon, and that there are many ways to make the SEs robust. One such method is called "HC3" and is estimated using a sandwich estimator that incorporates the residuals and the leverages. The weights that I am using are "Average Treatment Effect" weights that are derived from a propensity score model, which is estimated in each iteration of my simulation (because new data is generated each iteration). So it's not surprising that lm doesn't account for the fact that the weights aren't fixed. My question: Given that I am using propensity score weights in OLS regression, does anyone know about a package in R that will help give me more conservative (hopefully similar to the simulation variance) SE estimates? I see there's a survey package but I am not sure if it applies. A little more info, in case it helps; based on my findings, I don't think that what they are doing in figure 10 on page 6 of this paper produce robust SEs. I am guessing that these SEs are an underestimate (possibly a gross underestimate). https://pareonline.net/getvn.asp?v=20&n=13 Thanks!
