[site]: stackoverflow
[post_id]: 1178267
[parent_id]: 
[tags]: 
Aggregate function with Date on Postgres

I'm kind of rusty on my SQL, maybe you can help me out on this query. I have these two tables for a tickets system (I'm omitting some fields): table tickets id - bigint subject - text user_id - bigint closed - boolean first_message - bigint (foreign key, for next table's id) last_message - bigint (same as before) table ticket_messages creation_date I need to query the closed tickets, and make an average of the time spent between the first message creation_date and the last message creation_date. This is what I've done so far: SELECT t.id, t.subject, tm.creation_date FROM tickets AS t INNER JOIN ticket_messages AS tm ON tm.id = t.first_message OR tm.id = t.last_message WHERE t.closed = true I'm looking for some group by or aggregate function to get all the data from the table, and try to calculate the time spent between last and first, also trying to display the dates for the first and last message. UPDATE I added an inner Join with the second table instead of "OR", now I get both dates, and I can find the sum from my application: SELECT t.id, t.subject, tm.creation_date, tm2.creation_date FROM tickets AS t INNER JOIN ticket_messages AS tm ON tm.id = t.first_message INNER JOIN ticket_messages as tm2 ON tm2.id = t.last_message WHERE t.closed = true I think that did it...
