[site]: stackoverflow
[post_id]: 5465357
[parent_id]: 
[tags]: 
Using MeioUpload with CakePHP 1.3

I'm trying to implement some fairly simple image uploading using the MeioUpload behaviour in CakePHP 1.3, but I can't for the life of me get it to work. When I try to save $this->data in my controller, it tries to save a regular file array (for lack of a better word) rather than just the filename. Here's what I'm doing: I've put meio_upload.php into /app/models/behaviors In my model, I'm doing the following: var $actsAs = array( 'MeioUpload.MeioUpload' => array( 'filename' => array( 'dir' => 'img{DS}upload{DS}brawlers', 'allowedMime' => array('image/png'), 'allowedExt' => array('.png', '.PNG'), 'zoomCrop' => false, 'thumbsizes' => array( 'normal' => array( 'width' => 150, 'height' => 150 ) ), 'default' => 'default.png', 'length' => array( 'minWidth' => 100, 'minHeight' => 100, 'maxWidth' => 150, 'maxHeight' => 150 ) ) ) ); In my view, I've got the following form: Form->create('Brawler', array('type' => 'file')); echo $this->Form->input('name', array( 'label' => 'Name', 'maxLength' => '45' ) ); echo $this->Form->input('comment', array( 'label' => 'Description', 'rows' => '3' ) ); echo $this->Form->input('author', array( 'label' => 'Your name)', 'maxLength' => '45' ) ); echo $this->Form->input('email', array( 'label' => 'Email (will not be shown)', 'maxLength' => '45' ) ); echo $this->Form->input( 'filename', array( 'between'=>' ', 'type'=>'file', 'label' => 'Image (Max 2mb, 150x150 pixels, .png)' ) ); echo $this->Form->end('Submit'); ?> And finally my add action in the associated controller looks like this: function add() { if (!empty($this->data)) { $this->Brawler->create(); if($this->Brawler->save($this->data)) { $this->Session->setFlash('The brawler has been saved', true); $this->redirect(array('action'=>'index')); } else { $this->Session->setFlash('The Brawler could not be saved. Please try again.', true); debug($this->data); debug($this->validationErrors); die(); //$this->redirect(array('action'=>'add')); } } } For posterity, here's my table design: delimiter $$ CREATE TABLE `brawlers` ( `id` int(11) NOT NULL, `name` varchar(45) NOT NULL, `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, `comment` text, `email` varchar(45) NOT NULL, `author` varchar(45) NOT NULL, `filename` varchar(100) NOT NULL, PRIMARY KEY (`id`), ) ENGINE=MyISAM DEFAULT CHARSET=utf8$$ When I try to submit my form, this is the output I get: app/controllers/brawlers_controller.php (line 37) Array ( [Brawler] => Array ( [name] => Viking [comment] => Herp. This is a description. [author] => Me [email] => me@gmail.com [filename] => Array ( [name] => 5.png [type] => image/png [tmp_name] => /storage/configuration/upload_tmp_dir/phpEF2okD [error] => 0 [size] => 15863 ) ) ) app/controllers/brawlers_controller.php (line 37) Obviously, this fails when it tries to save an array to the filename field. The image is never saved in the specified upload directory either. It seems like the meioupload behavior is never actually used. How can I verify this? You'll have to excuse the mass of code that I've posted, but I figure it's better that I show you everything than to have you guess at what I may be doing. If someone can spot the error, that would save me many hours of pulling my hair.
