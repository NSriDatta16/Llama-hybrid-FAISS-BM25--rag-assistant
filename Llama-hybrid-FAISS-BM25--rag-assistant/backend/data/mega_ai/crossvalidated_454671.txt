[site]: crossvalidated
[post_id]: 454671
[parent_id]: 
[tags]: 
Particle Filter for structural credit risk model

Kwon (2012)* proposes a structural credit risk model where the asset value process and the noise are estimated based on the observed equity prices: $S$ - equity prices $V$ - value of the assets $Z$ - noise which contaminates the equity prices. The assumed model for the log equity price is: $$\ln S_t = g_S(V_t,t,\Theta_V) + Z_t$$ with $g_S$ being some function of $V_t$ (value of firm's assets at time $t$ ), $t$ (time) and $\Theta_V$ (parameters governing the asset dynamics) $V_t$ and $Z_t$ are modeled as follows: $$ \begin{align} dV_t &= \mu V_t dt + \sigma_V d W_t^{\mathbb{P}V}\\ dZ_t &= -\theta_Z Z_t dt + \sigma_Z dW_t^{\mathbb{P}Z} \end{align} $$ $W_t^{\mathbb{P}V}$ is assumed to be independent of $W_t^{\mathbb{P}Z}$ ( $\mathbb{P}$ denotes the physical or the real-world probability measure). The author writes: In the process of following the particle filter algorithm steps, we confront the problem that re-sampling weight $w^j \approx f_{t+1}\left(S_{t+1}\mid V_{t+1}^{(*j)},Z_{t+1}^{(*j)}\right)$ is a $\delta$ -function, which takes only 0 and 1 values. In order to solve this problem, the algorithm is adjusted as follows: where: $J$ is the Jacobian transformation of $Z_t=\ln(S_t)-g(V_t,t,\Theta)$ $q_{t+1}$ is the density function of $V_{t+1} \mid V_t$ $k_{t+1}$ is the density function of $Z_{t+1} \mid Z_t$ I don't quite understand how this algorithm solves the "problem" and in particular I don't see why the Jacobian appears in step (3) . My intuition is that since, given $V_{t+1}^{(*j)}$ , there is a one-to-one relationship between $S_{t+1}$ and $Z_{t+1}^{(*j)}$ , if we were to sample $Z_{t+1}^{(*j)}$ along with $V_{t+1}^{(*j)}$ and evaluate the density function $f_{t+1}\left(S_{t+1}\mid V_{t+1}^{(*j)},Z_{t+1}^{(*j)}\right)$ we would simply get a lot of $0$ s (maybe by chance and/or computer rounding error some $1$ s). To sidestep this, we make it look like we've actually sampled the $S_{t+1}$ alongside $V_{t+1}^{(*j)}$ and then evaluate the density of $Z_{t+1}^{(*j)} \mid S_{t+1}, V_{t+1}^{(*j)}$ . However, $Z_{t+1}^{(*j)}$ depends on $S_{t+1}$ only through the auto-correlation with $Z_{t}^j$ . Therefore we are left with $k_{t+1}(Z_{t+1}^{(*j)}\mid Z_t^j)$ which is a normal distribution according to the properties of the Ornstein-Uhlenbeck process. Not 100% sure of this. And I'm still confused about step (3) . It looks very much like a transformation of variables sorcery. * Kwon, T. Y. (2012). Three essays on credit risk models and their Bayesian estimation (Doctoral dissertation)
