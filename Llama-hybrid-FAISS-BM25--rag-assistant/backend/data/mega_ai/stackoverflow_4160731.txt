[site]: stackoverflow
[post_id]: 4160731
[parent_id]: 1703304
[tags]: 
MSDN articles that may assist: * WNetAddConnection2 - [http://msdn.microsoft.com/en-us/library/aa385413%28VS.85%29.aspx][1] * NETRESOURCE - [http://msdn.microsoft.com/en-us/library/aa385353%28VS.85%29.aspx][2] I reckon your problem is the display type where "res.iDisplayType = RESOURCEDISPLAYTYPE_SHARE". Perhaps try changing to a value of "0" (RESOURCEDISPLAYTYPE_GENERIC). So for example, what I generally use to map drives appears: With Res .dwScope = RES_SCOPE_GLOBALNET 'value 2 .dwType = RES_TYPE_DISK 'value of 1 .dwUsage = RES_USE_CONNECT 'value of 1 .localName = "x:" 'leave blank for no drive .RemoteName = "\\\" End With lRes = WNetAddConnection2(Res, sPassword, sDomain & "\" & sPassword, RES_CNN_UPDATE_PROFILE) If lRes = 0 Then 'Success Else 'Error End If Always check your connections before & after calls from command prompt: 1a) From system making connection, list current connections: net use 1b) From system connected too, list current sessions: net session To disconnect session, use API 'WNetCancelConnection2', my code following from above: sServer = "\\\" lRes = WNetCancelConnection2(sServer, RES_CNN_UPDATE_PROFILE, True) If lRes `> 0 Then 'Success Else 'Error End If Alternatively, simply making connections using 'net' command: 1) To map a drive letter: net use `: \\`\` /user:`\` ` 2) To map an IPC connection: net use \\`\` /user:`\` ` Disconnecting using 'net' command: 1) Disconnecting mapped drive: net use `: /delete 2) Disconnecting server share: net use \\`\` /delete
