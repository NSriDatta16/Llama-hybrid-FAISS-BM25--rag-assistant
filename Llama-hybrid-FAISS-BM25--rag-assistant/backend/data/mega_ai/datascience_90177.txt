[site]: datascience
[post_id]: 90177
[parent_id]: 
[tags]: 
Tricky stacking models in keras

I'm trying to write a model with keras, that is built as shown below: | +-----+ +->+------+ | | +--->| NN |------>| | | +------+ | | | | | | | +->+------+ | | +--->| NN |------>| L | | +------+ | S |------+-----> Output value | | T | | | ... | M | | | | | | | | +->+------+ | | | +--->| NN |------>| | | | +------+ | | | | +-----+ | | +-------+ | +----| Delay |-------------------+ +-------+ I have several simple sequential models (marked as NN), that receive two numerical value as input, they calculate some other numeric values (one per each network). These values are passed to LSTM network, which produces a single value as an output and this value additionaly is passed to initial networks (possibly with some delay) as one of two inputs. I work with time series, so calculated final value is passed to network alongside with the next time series value. I use LSTM to store some "state". It is not quite difficult to build separate "sub-models", but I don't realize, how to join them together as I need, i.e. how to make a final output to be passed to initial networks and how to stack them in the described way ( not as a chain). What I've found: I found keras.layers.Concatenate , but it seems not to be what I'm looking for... But maybe (I hope) I'm mistaken.
