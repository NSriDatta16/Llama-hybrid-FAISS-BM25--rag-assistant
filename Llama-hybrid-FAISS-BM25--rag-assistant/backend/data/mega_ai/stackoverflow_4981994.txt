[site]: stackoverflow
[post_id]: 4981994
[parent_id]: 
[tags]: 
Windows Snmp Management Api - Snmp timeout/retry doesn't appear to work

I'm noticing some weird snmp communication behavior when using MS SNMP Mgmt Api in terms of timeout and retries. I was wondering if mgmt api is supported on Win Server 2008 R1 x64. My program is a C++ 64bit snmp extension agent that uses the mgmt api to communicate with other agents as well. This is my pseudo code: SnmpMgrOpen(ip address, 150ms timeout, 3 retries) start = getTickCount() result = SnmpMgrRequest(get request with 3 or 4 OIDs) finish = getTickCount() if (result == some error) { log Error including total time (i.e finish - start ticks) } SnmpMgrClose() When the snmpMgrRequest call times out, the total time equals anywhere from 1014ms to 5000ms. If, I set retries to 0, the total time is still 1014ms to 5000ms. I would expect, with retries to 0 that the SnmpMgrRequest would timeout within 150ms. The documentation seems to imply this. Am I missing something is there a minimum timeout period of at least a second? What could be causing this behavior? Any help would be greatly appreciated. I'm at a lost here. ballerstyle_98@hotmail.com
