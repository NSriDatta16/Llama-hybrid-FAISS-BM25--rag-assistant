[site]: stackoverflow
[post_id]: 5390091
[parent_id]: 5389016
[tags]: 
SELECT tc.catename, count(case when u.ag_code!=0 then 1 end) agnt, count(case when u.ag_code =0 then 1 end) dircus from table1 as u inner join table2 as tc on u.industry_id=tc.tempcatid group by tc.tempcatid, tc.catename
