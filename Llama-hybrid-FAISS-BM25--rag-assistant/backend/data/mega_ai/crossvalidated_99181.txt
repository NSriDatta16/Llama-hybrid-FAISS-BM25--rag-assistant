[site]: crossvalidated
[post_id]: 99181
[parent_id]: 99160
[tags]: 
Afer perusing the documentation for KFAS, it seems to me that KFS() will return what you want in components V_eta and V_eps of the object you name out . (This is the case because you are dealing with a univariate time series, so the only diagonal term of V_eps is the variance you want.) You should expect about the same values from your code and any of the packages. Discrepancies may crop up, however, on account of: i) Different initial conditions (exactly diffuse, as KFAS implements, or setting the variance of the initial state to a very large number, as you probably have done), and ii) Different criteria to stop the likelihood climbing. Discrepancies due to different algorithms (like plain Kalman filter iteration versus square root algorithms, either covariance or information filters) may also appear with longer series and/or more complicated models, but with not the Nile data. Please note my name's spelling: Tusell.
