[site]: stackoverflow
[post_id]: 4305480
[parent_id]: 
[tags]: 
Kml Parsing in Android

I'm working in a project that parses and write a kml file and stores in sd card , but I have a problem, for google maps trace the path I need that the coordinates are all together, and my Activity just do like this kml output: Untitled Path 7f0000ff 4 #RedLine 1 absolute -7.178449630737305,41.48063600063324,274.0 Untitled Path 7f0000ff 4 #RedLine 1 absolute -7.178449630737305,41.48063600063324,274.0 And My Main Class: private void WriteToFile(Location loc) { if (!logToGpx && !logToKml) { return; } try { boolean brandNewFile = false; // if (root.canWrite()){ // File gpxFolder = new File("/sdcard/GPSLogger"); File gpxFolder = new File(Environment.getExternalStorageDirectory(), "GPSLogger"); Log.i("MAIN", String.valueOf(gpxFolder.canWrite())); if (!gpxFolder.exists()) { gpxFolder.mkdirs(); brandNewFile = true; } if (logToGpx) { WriteToGpxFile(loc, gpxFolder, brandNewFile); } if (logToKml) { WriteToKmlFile(loc, gpxFolder, brandNewFile); } } catch (Exception e) { Log.e("Main", "Nao foi possivel criar o ficheiro " + e.getMessage()); SetStatus("Nao e possivel escrever no ficheiro. " + e.getMessage()); } } private void WriteToKmlFile(Location loc, File gpxFolder, boolean brandNewFile) { try { File kmlFile = new File(gpxFolder.getPath(), currentFileName + ".kml"); if (!kmlFile.exists()) { kmlFile.createNewFile(); brandNewFile = true; } Date now = new Date(); //SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss"); //String dateTimeString = sdf.format(now); if (brandNewFile) { FileOutputStream initialWriter = new FileOutputStream(kmlFile, true); BufferedOutputStream initialOutput = new BufferedOutputStream(initialWriter); String initialXml = " "+ " " + " "; initialOutput.write(initialXml.getBytes()); // initialOutput.write("\n".getBytes()); initialOutput.flush(); initialOutput.close(); } long startPosition = kmlFile.length() - 6; String placemark = " " + now.toLocaleString() + " " + now.toLocaleString() + " " + " " + String.valueOf(loc.getLongitude()) + "," + String.valueOf(loc.getLatitude()) + "," + String.valueOf(loc.getAltitude()) + " "; RandomAccessFile raf = new RandomAccessFile(kmlFile, "rw"); raf.seek(startPosition); raf.write(placemark.getBytes()); raf.close(); } catch (IOException e) { Log.e("Main", "Error in writting " + e.getMessage()); SetStatus("Error in writting. " + e.getMessage()); } } What I'm doing wrong?
