[site]: stackoverflow
[post_id]: 757246
[parent_id]: 
[tags]: 
Most Efficient Way To Get A Row Of Data From DB In ASP.NET

I'm writing a method to return an 'asset' row from the database. It contains strings, ints and a byte array (this could be an image/movie/document). Now for most row access I use the following method which returns a NameValueCollection as it is a light weight object, easy to use and cast int and strings. public static NameValueCollection ReturnNameValueCollection(Database db, DbCommand dbCommand) { var nvc = new NameValueCollection(); using (IDataReader dr = db.ExecuteReader(dbCommand)) { if (dr != null) { while (dr.Read()) { for (int count = 0; count Now my apporach for this kind of data access would normally be to get a method to return a datarow. public static DataRow ReturnDataRow(Database db, DbCommand dbCommand) { var dt = new DataTable(); using (IDataReader dr = db.ExecuteReader(dbCommand)) if (dr != null) dt.Load(dr); dbCommand.Dispose(); return dt.Rows.Count != 0 ? dt.Rows[0] : null; } It does seem kind of wastefull to create a DataTable and then return its first datarow. Is there better way to do this? I'm thinking maybe a Dictionary of objects which I then manually cast each member of. Would be interesting to see how others have tackled this. I know this kinda falls into the field of micro optimisation and as long as I'm not returning DataSets for each row query (wish I had a pound for everytime I saw that in a line of code) it should be ok. That said this method is likely to be called for allot of data access queries on allot of sites on one box. Cheers Steve
