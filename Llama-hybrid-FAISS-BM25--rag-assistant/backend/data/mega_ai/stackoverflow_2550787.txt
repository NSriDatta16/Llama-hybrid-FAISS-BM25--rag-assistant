[site]: stackoverflow
[post_id]: 2550787
[parent_id]: 2550731
[tags]: 
//Export the actual dataset if (rds != null && rds.Tables.Count != 0) { #region WriteToTheStringBuilder DataTable dt = rds.Tables[0]; StringBuilder str = new StringBuilder (); //first add the column names for (int j = 0; j http://geekswithblogs.net/brcraju/archive/2005/07/27/48372.aspx HttpContext.Current.Response.Clear(); HttpContext.Current.Response.ClearContent(); HttpContext.Current.Response.ClearHeaders(); HttpContext.Current.Response.Buffer = true; HttpContext.Current.Response.ContentType = "application/vnd." + fileExtension; //HttpContext.Current.Response.Write(@" "); #region IftheExportingServerIsBehindFirewall bool flagUseDnsRemapping = false; flagUseDnsRemapping = Convert.ToBoolean(Convert.ToInt16(Resources.GV.UseSecureConnection)); if (flagUseDnsRemapping == true) HttpContext.Current.Response.AddHeader("Host", Resources.GV.ServerDNSName); #endregion IftheExportingServerIsBehindFirewall HttpContext.Current.Response.AddHeader("content-disposition", "attachment;filename=" + pageName + "." + fileExtension); HttpContext.Current.Response.Charset = " "; //utf will brake thinks ... HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.GetEncoding("windows-1250"); //windows-1250 //HttpContext.Current.Response.Cache.SetCacheability ( HttpCacheability.NoCache ); // System.IO.StringWriter stringWrite = new System.IO.StringWriter (); // System.Web.UI.HtmlTextWriter htmlWrite = //new HtmlTextWriter ( stringWrite ); HttpContext.Current.Response.Write ( str.ToString () ); HttpContext.Current.Response.Flush(); HttpContext.Current.Response.End (); #endregion WriteToResponse userObj.Mc.Msg = "Export to Excel performed successfully "; return true; } //eof if
