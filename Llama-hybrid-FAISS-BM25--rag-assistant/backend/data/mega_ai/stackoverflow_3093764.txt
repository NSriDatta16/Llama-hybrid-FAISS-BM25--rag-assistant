[site]: stackoverflow
[post_id]: 3093764
[parent_id]: 3091468
[tags]: 
I know exactly what you're talking about and the problem is actually with the design of your app disagreeing with the way windows handles the focus. Windows has done this type of thing since win31. It's like a land grab; if you show a window from your app, then hide/disable it, You snooze, you lose according to Bill. The fix: you need a main window! Or switch OS. Just because it works from an EXE doesn't mean it will work when one of your users kicks it off from a batchfile or other than explorer. You CAN kludge your way out of this - run 3 separate exes; try running on 3 Application.Run threads in your sub Main; use to SetTopMost, AppActivate yourself. Or look up how to cause your app to grab the input focus using SDK calls - which successive versions of windows have made difficult in order to mitigate obnoxious apps using it (hence an app that could do this in w98 will flash the taskbar orange in xp) - and then programmers have worked around that of course. You could do that. But you'd be doing it wrong. A refactor is in order and change in stragegy for future apps. This is not a decision I made; the way windows works is set in stone, plus the way users expect it to work is set in millions of brains, which is harder than stone - swim with the flow! Easy refactor with no real impact: Back up your project (or shelve a copy in TFS) In your options dialog, cut all your controls. Put in a form-sized panel named pnlOpts. Paste them back. Make that form your main form. In the form_shown, set pnlOpts.Visible=false, or just default it that way (you can show another panel w/ the app name or a background image if you want to be a little trashy ;-) Call the setup code that also shows the file dlg from this area as well Set your file dlg to have that form as parent, startup position as center-parent (I mean owner not parent). Remember cancel from this = close the settings form When this is done, show pnlOpts. In the OK button, call the code that does the progress bar. You can hide or disable pnlOpts here again. At no point can you hide, set Visible=false, or enabled=false on the ENTIRE window or you will invoke windows' focusing wrath (which is the cause of your misery here). The real key here, the one-line answer: leave a main window visible and enabled at all times, if you want to disable its functionality, just gray or hide all its controls. this is easiest to do with the panel. You can show the user other panels or images to entertain them if you want (especially if graying [.enabled=false] the content doesn't make sense). You won't like that way that looks, or you'd have built it like that to begin with, but millions of lines of windows code and millions of brains of windows users are passive-agressively disagreeing with you right now!
