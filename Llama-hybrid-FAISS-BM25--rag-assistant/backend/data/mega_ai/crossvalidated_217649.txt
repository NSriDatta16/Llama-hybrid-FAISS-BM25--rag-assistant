[site]: crossvalidated
[post_id]: 217649
[parent_id]: 217599
[tags]: 
You could get fancier, but here's a simple, standard way to do it. Say you have a set of spike times for each trial and you want to calculate a binned PSTH. All times are measured relative to the stimulus at time 0. Set up a number of equally-sized, non-overlapping time bins covering the interval from the minimum to the maximum time point in any trial. Let $t_i$ be the center time of bin $i$ and $\Delta t$ be the bin width (both measured in seconds). Let $s_i$ be the total number of spikes that fall into bin $i$ (summing over all trials). Let $o_i$ be the number of trials that are long enough to include $t_i$. The average number of spikes in bin $i$ (averaged across trials) is then $s_i / o_i$. Dividing by $o_i$ instead of the number of trials lets you deal with trials of different lengths. The firing rate in bin $i$ is $f_i = s_i / o_i / \Delta t$ (spikes per second = Hz).
