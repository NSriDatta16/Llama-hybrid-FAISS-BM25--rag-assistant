[site]: crossvalidated
[post_id]: 426768
[parent_id]: 
[tags]: 
Strange substitution in HMC

I try to read paper, MCMC using Hamiltonian dynamics ). The author, Neal states(P28): To begin, Cruetz nodes that the following relationship holds when any Metropolis-style algorithm is used to sample a density $P(x) = (1/Z)\exp(-E(x))$ : $$ 1 = \mathbb{E}(P(x^*)/P(x)) = \mathbb{E}(\exp(-(E(x^*)-E(x)))) = \mathbb{E}(\exp(-\Delta)) \quad (4.17) $$ I can't see why $\mathbb{E}(P(x^*)/P(x))=1$ so I follow the reference, Global Monte Carlo algorithms for many-fermion systems , and found this strange substitution(P3): Some rather useful identities follow from considering expectation values over this distributions. Consider the paritition function $$ Z = \int dA' dp' e^{-H'} = \int dAdp e^{-H}e^{H-H'}, \quad (16) $$ where $H$ and $H'$ denote $H(p,A)$ and $H(p',A')$ , respectively. I can't see why it is valid. $A = A', p = p'$ may works but it will imply $\mathbb{E}(P(x^*)/P(x))=\mathbb{E}(1)=1$ ? It sounds not the point Neal want to present.
