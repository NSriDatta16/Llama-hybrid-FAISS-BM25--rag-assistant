[site]: stackoverflow
[post_id]: 3060979
[parent_id]: 3060946
[tags]: 
Unless you are implementing a state machine for the sake of implementing one, I would highly recommend that you use a state machine generator instead. Ragel is one very good and robust solution. https://github.com/bnoordhuis/ragel
