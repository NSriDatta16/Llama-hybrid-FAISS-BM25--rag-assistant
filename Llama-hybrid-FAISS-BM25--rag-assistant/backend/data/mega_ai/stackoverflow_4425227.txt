[site]: stackoverflow
[post_id]: 4425227
[parent_id]: 
[tags]: 
Forced downloading large file with php

Many users of my site have reported problems downloading a large file (80 MB). I am using a forced download using headers. I can provide additional php settings if necessary. I am using the CakePHP framework, but this code is all regular php. I am using php 5.2 with apache on a dedicated virtual server from media temple, CentOS Linux. Do you see any problems with the following code: set_time_limit(1500); header("Content-Type: application/octet-stream"); header("Content-Disposition: attachment; filename=\"" . basename($file_path) . "\""); header("Content-Length: ".$content_length); header("Content-Transfer-Encoding: binary"); header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); header('Cache-Control: private', false); header('Pragma: public'); header('Expires: 0'); //Change this part $handle = fopen($file_path, 'rb'); while (!feof($handle)) { echo fread($handle, 4096); ob_flush(); flush(); } fclose($handle); exit; Basically, the problem being reported is that the download starts and then stops in the middle. I was thinking it was a problem with the time limit, so I add the set_time_limit code. I was using the php readfile function before, but that also did not work smoothly.
