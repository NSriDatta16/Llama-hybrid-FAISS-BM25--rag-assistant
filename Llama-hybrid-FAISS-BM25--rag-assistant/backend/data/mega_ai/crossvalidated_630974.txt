[site]: crossvalidated
[post_id]: 630974
[parent_id]: 
[tags]: 
R joincount with non-integer counts

I am using the R function joincount.multi from spdep to look for spatial autocorrelation with my data. The joincount column is not an integer which is my expectation. I note that my adjacency matrix (from nb2listw ) is not 0/1: the weights are 1/n, where n is the number of neighbours (so it sums to 1 over the rows). Is this weight what is causing my expected counts to be non-integer? Should I be using non 0/1 weights with joincount.multi ? Thanks. > joincount.multi(fx = as.factor(shape$CM_IMDRANK), listw = queen_shape) Joincount Expected Variance z-value 1:1 744.036 164.140 25.342 115.1930 2:2 376.265 164.140 25.342 42.1374 3:3 297.374 164.240 25.357 26.4389 4:4 274.236 164.140 25.342 21.8699 5:5 242.895 164.240 25.357 15.6201 6:6 255.303 164.140 25.342 18.1091 7:7 248.142 164.040 25.328 16.7109 8:8 275.434 164.240 25.357 22.0819 9:9 323.426 164.140 25.342 31.6413 10:10 566.913 164.240 25.357 79.9664 EDIT: Thanks to Robert's reply I have switched to binary weights: Joincount Expected Variance z-value 1:1 4209.00 965.46 913.80 107.2983 2:2 2174.00 965.46 913.80 39.9793 3:3 1737.00 966.05 914.34 25.4961 4:4 1609.00 965.46 913.80 21.2887 5:5 1449.00 966.05 914.34 15.9717 6:6 1575.00 965.46 913.80 20.1640 7:7 1546.00 964.87 913.26 19.2298 8:8 1680.00 966.05 914.34 23.6110 9:9 1876.00 965.46 913.80 30.1212 10:10 3107.00 966.05 914.34 70.8031
