[site]: crossvalidated
[post_id]: 509998
[parent_id]: 
[tags]: 
Formalizing variable length recurrences of random variables

I'm not a statistician (just a barely proficient user of rudimentary bayesian stuff in the context of ML), so the questions I have below may be very dumb and easily answered by pointing me to lecture notes about some concept I am evidently missing. If that's the case, great! I look forward to learning something new. If not, then I hope people can point me in the direction of where I should look to learn more when providing answers. Basic Setting Say I have a problem whereby $T$ latent variables $Z_1, ..., Z_T$ are distributed conditioned on the previous LV in the sequence (i.e. order-1 Markov assumption), and on $X$ . A graphical model for this is shown below, on the left, and made more compact on the right using a variant of plate notation described by David Rushing Dewhurst (but possibly introduced by someone else). A factorization of the joint probability of $Z_{1:T}$ given $X$ , as expressed by this graphical model, would be written $$ p(Z_{1:T} = z_{1:T} | X=x) = P(Z_1 = z_1 | X=x)\prod_{i=2}^T P(Z_i = z_i | X=x, Z_{i-1} = z_{i-1}) $$ Treating $T$ as a Random Variable What I want to do is express the fact that the number , $T$ , of latent variables is itself a random variable. If it helps simplify things, $P(Z_i | Z_{i-1}, X)$ is assumed to be the same for all $i$ (because we will be approximating this conditional with a parametric function, and share parameters across different $Z_i$ s), i.e. the following is true $$\forall ijabx . P(Z_i = a | Z_{i-1} = b, X = x) = P(Z_j = a | Z_{j-1} = b, X = x)$$ I would awkwardly attempt to formalise this notion of $T$ as an RV as follows: $ p(Z_{1:T} = z_{1:\tau} | X=x, T=\tau) \\ = P(Z_1 = z_1 | X=x) \prod_{i=2}^\infty \mathbf{max}(P(Z_i = z_i | X=x, Z_{i-1} = z_{i-1}), \mathbb{I}_{\leq \tau}(i))\\ = P(Z_1 = z_1 | X=x) \prod_{i=2}^\tau P(Z_i = z_i | X=x, Z_{i-1} = z_{i-1})\\ $ where $\mathbb{I}_{\leq \tau}(i) = 1$ if $i \leq \tau$ and $0$ otherwise (so the $\mathbf{max}$ ignores $P(Z_i | \ldots)$ when $i > \tau$ ). Something about this feels a bit awkward, so the first two questions are: Is this a correct way to express/factorize this dependence on $T$ ? If not, how would I do it? How would you write, in plate notation, this sort of graphical model? Deciding when to stop More loosely, I want to consider the case where every time I sample a value of some $Z_i$ in the series, I also decide (conditional on the values of $Z_i$ and $X$ ) whether I want to sample a value for $Z_{i+1}$ , or whether I'm done (as you would in a recurrence). In other words, I have a Bernoulli $P(\textit{Continue?}_i | Z_i, X)$ (I'll write $C_i$ with support 1 for "yes" and 0 for "no" as shorthand for $\textit{Continue?}_i$ ) which determines whether to sample a value for $Z_{i+1}$ (if $\textit{Continue?}_i = \text{yes}$ ) or stop at $Z_i$ (if $\textit{Continue?}_i = \text{no}$ ). This yields the following three questions: What is the proper way to formalise this? Is it something like $P(Z_{1:\infty},C_{1:\infty}|X)$ ? How does it factorize into components $P(C_i | Z_i, X)$ , $P(Z_i | X_i, C_{i-1}, Z_{i-1})$ ? How do I express the termination condition in this formalization? What is the formal relationship between $C_1, \ldots$ and $T$ ? Is there a graphical/plate notation way to represent sort of variable length recurrence? A general question This all reminds me of things like Dirichlet processes from topic modelling. Is there a name for this kind of variable-number-of-random-variables model? Are they generically stochastic processes, or a specific category of processes?
