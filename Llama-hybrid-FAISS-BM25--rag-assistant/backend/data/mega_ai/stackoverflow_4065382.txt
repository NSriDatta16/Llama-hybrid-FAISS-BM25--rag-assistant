[site]: stackoverflow
[post_id]: 4065382
[parent_id]: 4065355
[tags]: 
Try loading the HTML into the HTML Agilty Pack . It is an HTML parser that can deal with HTML fragments (and will be fine with & in URLs). I am not sure if it can output pretty printed (what you call "formatted") HTML, but that would be my first approach.
