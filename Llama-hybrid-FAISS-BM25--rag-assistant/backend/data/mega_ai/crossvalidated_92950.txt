[site]: crossvalidated
[post_id]: 92950
[parent_id]: 
[tags]: 
How to modify post-hoc power analysis simulation to perform a-priori power analysis?

I am interested in doing a sample size calculation for exacerbation rates. I am drawing my data from a negative binomial distribution and my test statistic is based on a negative binomial glm. Currently, I have a code for a power calculation for a given sample size. How do I modify this code to calculate sample size? The following are the input parameters for the sample size calculation: Alpha level = 0.04, target power = 90%, event rate for reference group (r0) = mu0 , Rate ratio (rr) under ha = mu1/mu0 where mu1 , average exposure time = 48 weeks, sample size allocation ratio = 1 (so each group has equal sample size; i.e., n1 = n0 ), and dispersion parameter ( k = 0.4 ). library(MASS) n
