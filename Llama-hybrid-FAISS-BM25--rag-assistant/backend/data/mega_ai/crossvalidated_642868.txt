[site]: crossvalidated
[post_id]: 642868
[parent_id]: 
[tags]: 
Quantile Regression Detrending

Assume I have a time series, as the black one below. As shown, the quantile regression for 5%, 25%, 50%, 75%, and 95% quantiles show different slopes (in red). Even if not quite visible, the ratio between upper and lower trends is approximatively 2, which makes a critical difference. I would like to fit an ARMA model. This requires to make the series stationary, i.e. to remove the trend and the seasonality. I will not deal with seasonality here, but only with trend. The use of a classical linear regression for the trend would require to estimate that trend, and simply deduct it from the original time series. However, for the quantile regression, I have multiple trend lines. How can I properly remove each of them to my original dataset ? The idea here is to make sure that the upper quantiles are "more detrended" than the lower quantiles. Now, assuming that I've successfully detrended (and deseasoned) my series, and that I'm able to fit and simulate an ARMA process, my simulations will be stationary. How can I re-trend them, taking into account each single trend, to properly simulate something that looks like the black curve ? For the sake of the example, I've just used a data.frame named myts with a Date and a Temperature column : library(quantreg) plot(myts $Date, myts$ Temperature, type = "l", xlab = "Date", ylab = "Temperature") abline(rq(Temperature ~ Date, tau = 0.5, data = myts), col="red", lwd = 2) abline(rq(Temperature ~ Date, tau = 0.25, data = myts), col="red", lwd = 2) abline(rq(Temperature ~ Date, tau = 0.75, data = myts), col="red", lwd = 2) abline(rq(Temperature ~ Date, tau = 0.05, data = myts), col="red", lwd = 2) abline(rq(Temperature ~ Date, tau = 0.95, data = myts), col="red", lwd = 2)
