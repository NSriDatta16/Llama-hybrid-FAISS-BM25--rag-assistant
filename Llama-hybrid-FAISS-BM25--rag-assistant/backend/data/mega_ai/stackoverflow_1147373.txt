[site]: stackoverflow
[post_id]: 1147373
[parent_id]: 
[tags]: 
Error on updating SPPersistedObject from web part

I have written two features in SharePoint 2007. One is scoped at Site level and it basically adds a web part to the site collection where it is activated. This feature assembly is deployed under the 'bin' directory. Second is Farm scoped which is my custom SPPersistedObject and is deployed in Central Administration. The assembly is added to GAC. From the web part I need to update my custom object. This is working fine in most cases. But on some servers that follow the least privilege administration domain accounts ' http://technet.microsoft.com/en-us/library/cc263445.aspx ' I am getting the below error System.Security.SecurityException: Access denied. at Microsoft.SharePoint.Administration.SPPersistedObject.Update() at MyWebPart.<>c__DisplayClass1.b__0() at Microsoft.SharePoint.SPSecurity.CodeToRunElevatedWrapper(Object state) at Microsoft.SharePoint.SPSecurity.<>c__DisplayClass4.b__2() at Microsoft.SharePoint.Utilities.SecurityContext.RunAsProcess(CodeToRunElevated secureCode) at Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(WaitCallback secureCode, Object param) at Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(CodeToRunElevated secureCode) at MyWebPart.RenderWebPart(HtmlTextWriter writer) The Zone of the assembly that failed was: MyComputer Do I need to set any permissions or CAS policies to prevent this error? Below is my current CAS policy set for the web part assembly. Do I need to make any changes here. Please advice. Regards, Jagannath
