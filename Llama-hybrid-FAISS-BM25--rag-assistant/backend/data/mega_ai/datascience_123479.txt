[site]: datascience
[post_id]: 123479
[parent_id]: 
[tags]: 
Need help designing conv-lstm in TensorFlow for longitudinal disease prediction

I am currently trying to develop a conv-lstm to predict disease progression in eye photos of patients. I have a folder of images with a total of 263 images of 144 different patients. I also have an excel file that tells me if a patients ends up progressing to get the disease. For example, patient 1 has 6 total images, 3 for his right eye and 3 for his left. He doesn't develop a disease in the left but does in the right. So the excel file tells me patient 1 is 1 (positive) in his right eye but 0 (negative) in his left. Over the course of the 3 documented photos, the patient develops the disease. Now, not all patients have 3 photos for each of their eyes, so I am not sure how I would be able to input the images as time series (because i am assuming for time series i would need the same number of visits for each patients). I provided the dictionary I created where all the patients and their images are stored. Note OD is right eye, OS is left eye: {'100_OD': ['100_OD_1.jpg', '100_OD_2.jpg', '100_OD_3.jpg', '100_OD_4.jpg', '100_OD_5.jpg'], '100_OS': ['100_OS_1.jpg', '100_OS_2.jpg', '100_OS_3.jpg', '100_OS_4.jpg', '100_OS_5.jpg'], '101_OD': ['101_OD_1.jpg', '101_OD_6.jpg', '101_OD_7.jpg'], '101_OS': ['101_OS_1.jpg', '101_OS_6.jpg', '101_OS_7.jpg'], '102_OS': ['102_OS_1.jpg'], '103_OD': ['103_OD_1.jpg'], '103_OS': ['103_OS_1.jpg'], '104_OD': ['104_OD_1.jpg'], '104_OS': ['104_OS_1.jpg'], '105_OD': ['105_OD_1.jpg', '105_OD_2.jpg', '105_OD_3.jpg', '105_OD_5.jpg', '105_OD_6.jpg', '105_OD_7.jpg', '105_OD_8.jpg'], '105_OS': ['105_OS_1.jpg', '105_OS_2.jpg', '105_OS_3.jpg', '105_OS_4.jpg', '105_OS_5.jpg', '105_OS_6.jpg', '105_OS_7.jpg'], '106_OD': ['106_OD_1.jpg', '106_OD_4.jpg'], '106_OS': ['106_OS_1.jpg', '106_OS_3.jpg'], '107_OD': ['107_OD_1.jpg'], '107_OS': ['107_OS_1.jpg'], '108_OD': ['108_OD_1.jpg', '108_OD_2.jpg', '108_OD_3.jpg'], '108_OS': ['108_OS_1.jpg', '108_OS_2.jpg', '108_OS_3.jpg'], '109_OD': ['109_OD_1.jpg', '109_OD_3.jpg'], '109_OS': ['109_OS_1.jpg', '109_OS_3.jpg'], So along these I will have a 0 or 1 for each patient eye depending if over the course of their following they developed the disease. Any ideas or suggestions? I have something like this in mind, but am not sure what the input_shape should be, nor am i sure if it will work. model = keras.Sequential() model.add(TimeDistributed(Conv3D(filters=64,kernel_size=(3,3,3),activation='relu'), input_shape=?, name="Input_Conv_Layer")) model.add(TimeDistributed(MaxPool3D( pool_size=(2, 2, 2), strides=(2, 2, 2), padding='valid' ), name="Pool_Layer_1")) model.add(TimeDistributed(Flatten(), name="Flatten_Layer")) model.add(LSTM(10, dropout = 0.3, recurrent_dropout = 0.3, name="LSTM_Layer")) model.add(Dense(1, activation = 'sigmoid', name="Output_Dense_Layer")) model.compile(optimizer=optimizers.Adam(lr=0.0001), loss='binary_crossentropy', metrics=['accuracy'])
