[site]: crossvalidated
[post_id]: 519664
[parent_id]: 
[tags]: 
Batches of bayesian updates for gaussian with unknown variance different from computation with all data

I'm working on a project where I continuously (in batches) update the pdf estimation for an event normally distributed. My variance is unknown, so I'm using the equations given in session 4.1.2 of this book : I would expect that multiple small updates would lead to approximately the same parameters to one single big update. This is obviously true for the updates of the means, but not so clear for the standard deviation. If we simulate it: from scipy.stats import norm import numpy as np np.random.seed(42) n_0 = 0 m_0 = 0 s_0 = 0 cum_obs = np.array([]) batch_size = 10 n_batches = 100 for i in range(n_batches): batch_obs = norm.rvs(loc=10, scale=5, size=batch_size) cum_obs = np.concatenate([cum_obs, batch_obs]) n = batch_size nu_0 = -1 + n_0 nu = nu_0 + n x_bar = np.mean(batch_obs) s = np.std(batch_obs) var = ( (1 / nu) * ( (s ** 2) * (n - 1) + (s_0 ** 2) * nu_0 + n_0 * n * ((x_bar - m_0) ** 2) / (n_0 + n) ) ) mult = (1 / nu) * (1 / (n + n_0)) m_0 = x_bar n_0 += n s0 = s s = np.sqrt(var) if i == n_batches - 1: print("...\n") if i Using update rules: 3.429529651472475 Computing the std for all observed data: 3.429529651472475 Using update rules: 4.02186514878462 Computing the std for all observed data: 4.67859979446889 Using update rules: 2.5465800067817965 Computing the std for all observed data: 4.424395957981525 Using update rules: 2.6167707409764502 Computing the std for all observed data: 4.704117427614569 Using update rules: 1.83449085034948 Computing the std for all observed data: 4.621424689362122 Using update rules: 0.4917832154508146 Computing the std for all observed data: 4.893631038736771 I set the priors in a way that the first update in the two computations are equal, but as the batches go, the two get further and further apart and the presented equations get far from the expect value of 5. I would like to know if there's something fundamentally wrong in what I'm doing or even if I should expect similar results for the two computations. Edit: I noticed a typo in my code with s0 vs s_0 and the results make more sense now. But the stds computed with the equation still seems more unprecise
