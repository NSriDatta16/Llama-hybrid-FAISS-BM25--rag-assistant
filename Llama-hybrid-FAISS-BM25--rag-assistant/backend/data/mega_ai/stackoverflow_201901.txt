[site]: stackoverflow
[post_id]: 201901
[parent_id]: 201896
[tags]: 
why not start with this stored procedure and modify it to suit your needs, possibly even convert it to Java using the hashmap as Steve suggested. Personally I like the idea of a stored procedure because different databases may have different keywords so it seems elegant to have the database pass judgement
