[site]: stackoverflow
[post_id]: 4025384
[parent_id]: 4025341
[tags]: 
Try the set based approach - should be faster select min(t1.NumberTaken)+1 as "min_missing" from t t1 where not exists (select 1 from t t2 where t1.NumberTaken = t2.NumberTaken+1) and t1.NumberTaken > @StartingNumber This is Sybase syntax, so massage for SQL server consumption if needed.
