[site]: stackoverflow
[post_id]: 3135744
[parent_id]: 2336162
[tags]: 
Our solution was to reorganize our feature architecture such that we now have a Web Application scoped feature in addition to 2 Farm scoped features and 2 Site Collection scoped features. We moved our code that dealt with WebConfigModifications from our site collection scoped features to our new web application scoped feature. This was the way it should have been done all along (and how we tried to do it initially a while back), but the SharePoint Solution Installer did not support our feature architecture so we worked around it by having a bit of code trying to deal with WebConfigModifications at the site collection level. This had some rough side-effects like requiring the account that activated the site collection feature to also be a farm administrator - and we had to have some smart code to not apply or remove our settings multiple times. So, we had to update the SharePoint Solution Installer for this - and also get it to work in SharePoint 2010. It is not released yet, but watch http://sharepointinstaller.codeplex.com/ for releases that support this scenario for both SharePoint 2007 and SharePoint 2010.
