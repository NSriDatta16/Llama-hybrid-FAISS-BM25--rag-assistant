[site]: stackoverflow
[post_id]: 5762222
[parent_id]: 
[tags]: 
C# drag-drop problem

I have a C# .NET 3.5 application that allows drag items from a tree and drop them to a folder as a file. Here is my code String absolutePathToFile=...get absolute path DataObject dataObject = new DataObject(); StringCollection paths = new StringCollection(); paths.Add(absolutePathToFile); dataObject.SetFileDropList(paths); DoDragDrop(dataObject, DragDropEffects.Copy); This works quite well except when interacts with another C# application that accepts files via drag and drop, Another C# application has the following handler for DragOver if ((e.Data is DataObject) && (e.Data as DataObject).ContainsFileDropList()) { e.Effect = DragDropEffects.Copy; } The block is never executed since e.Data is __ComObject not DataObject. Interestingly when I drag a file from a folder over second application it sees it as DataObject. How to make DataObject from first C# application appear as DataObject in second C# application?
