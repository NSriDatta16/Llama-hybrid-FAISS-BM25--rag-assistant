[site]: stackoverflow
[post_id]: 3703788
[parent_id]: 3702788
[tags]: 
startOffset and endOffset are offsets in current node, to get it you need range.startContainer and range.endContainer . EDIT: It is working good if startContainer and endContainer are on the same level (DOM tree structure is preserved). EDIT2: Now it makes every selected text bold. Also I rewrote the IE part, now it operates on HTML, so it's good. http://jsfiddle.net/FYJtN/11/ if (window.getSelection) { // not IE case var selObj = window.getSelection(); var selRange = selObj.getRangeAt(0); var newElement = document.createElement("b"); var documentFragment = selRange.extractContents(); newElement.appendChild(documentFragment); selRange.insertNode(newElement); selObj.removeAllRanges(); } else if (document.selection && document.selection.createRange && document.selection.type != "None") { // IE case var range = document.selection.createRange(); var selectedText = range.htmlText; var newText = ' ' + selectedText + ' '; document.selection.createRange().pasteHTML(newText); }
