[site]: crossvalidated
[post_id]: 499241
[parent_id]: 26244
[tags]: 
You are on the right track by inspecting the source code. In addition to the spec.ci function you found, the plotting chunk for CI is given by ci.text $spec)/conf.lim[2L] conf.x freq) - x $bandwidth lines(rep(conf.x, 2), conf.y * conf.lim, col = ci.col) lines(conf.x + c(-0.5, 0.5) * x$ bandwidth, rep(conf.y, 2), col = ci.col) Therefore the confidence interval is about a single parameter $f(\omega)$ with $\omega$ taken to be at the fixed frequency conf.x . The confidence interval formula for a given frequency $\omega$ , is (see Eq. (10.5.2) of Brockwell & Davis Time Series: Theory and Methods ): \begin{align*} \left(\frac{\nu \hat{f}(\omega)}{\chi_{1 - \alpha/2}^2(\nu)}, \frac{\nu \hat{f}(\omega)}{\chi_{\alpha/2}^2(\nu)}\right), \quad 0 where $\nu$ is the equivalent degrees of freedom of the estimator $\hat{f}$ , which corresponds to df in the code you pasted in the question.
