[site]: crossvalidated
[post_id]: 642620
[parent_id]: 
[tags]: 
Example in which $E[E[Y|T,X]] \neq E[Y|T, E[X]]$

Context: this question is a follow-up of this other question in which I'm trying to understand why we should use methods for causal inference instead of just training machine learning regressors, especially when dealing with continuous data. I'm working on a causal dose response estimation problem with a continuous treatment $T$ , a confounder $X$ and target $Y$ . In such scenario, we are defining $X=\eta_x$ , $T=f_t(X,\eta_t)$ , and $Y=f_y(T,X,\eta_y)$ where all the $\eta$ terms are independent noise terms and $f$ are generic functions (i.e. they are not necessarily constrained to be linear or to have a specific shape). Question: I'd like to find an example in which a causal dose response function (DRF) estimated with g-computation is able to correctly retrieve the DRF while a naive method for calculating treatment $T$ influence, that just exploits machine learning to predict $E[Y|T,X=\bar X]$ (where $\bar X$ is the empirical sample mean of $X$ ) for different levels of $T$ , is not. To me that translates into looking for an example for which $E_X[E[Y|T,X]] \neq E[Y|T, X=\bar X]$ , where the first quantity is the dose response function estimated with g-computation. Is this statistically possible? If so, is there any example? Some python code or structural equations would be greatly appreciated.
