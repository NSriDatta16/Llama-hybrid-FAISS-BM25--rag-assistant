[site]: crossvalidated
[post_id]: 428888
[parent_id]: 
[tags]: 
Fitting flexible spline using ODEs

I'm fitting a series of ordinary differential equations (describing movement through disease states: susceptible, infected, recovered) to weekly counts of a disease through time. I'm solving the ODEs using deSolve and fitting using nloptr . One of the parameters of this model I'd like to estimate is the rate at which individuals move from the recovered state to the susceptible state (imm, in the code below). I want this rate to vary through time. To do this, I want to fit a flexible/nonparametric spline for this parameter (imm), such that solving the ODEs provides an estimate of the parameters for the spline. I'm familiar with several R packages for conducting spline regression or for estimating the basis functions for a spline, but can't figure out how to integrate these functions into my ODEs in order to estimate the parameters for the spline using my optimization algorithm. Some of my code is below: RM = function(t, x, p) { imm } From here, I'm fitting to the time series data using nloptr and maximum likelihood methods. Any help would be appreciated.
