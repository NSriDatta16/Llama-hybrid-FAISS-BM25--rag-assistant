[site]: stackoverflow
[post_id]: 5086117
[parent_id]: 4956861
[tags]: 
Use SQL Profiler to capture a whole session of queries. When you're done you can save the profiler results and run the whole thing through SQL Server Tuning Advisor. In my experience this gives much better results than tuning based on individual queries and in many ways is easier and more realistic since you can use profiler to capture queries from real application usage. EDIT: Thanks for bringing more attention to the specific issue you're asking about. I didn't realize you were saying that the Tuning Advisor doesn't understand sp_executesql because that simply isn't true. You can run as many queries as you want through sp_executesql and capture them in a profile and then run that profile through Tuning Advisor and it will give you recommendations. To be sure, I just did it with MS SQL Server 2008 R2. I created a table with no indexes, ran a bunch of queries through sp_executesql , captured them in SQL Profiler, and then ran the resulting trace through Tuning Advisor. Tuning Advisor gave appropriate recommendations for the queries embedded within sp_executesql . The exact version of Database Engine Tuning Advisor is 10.50.1600.1, running against Microsoft SQL Server 2008 R2 (RTM) - 10.50.1617.0 (X64) Apr 22 2011 19:23:43 Copyright (c) Microsoft Corporation Developer Edition (64-bit) on Windows NT 6.1 (Build 7601: Service Pack 1).
