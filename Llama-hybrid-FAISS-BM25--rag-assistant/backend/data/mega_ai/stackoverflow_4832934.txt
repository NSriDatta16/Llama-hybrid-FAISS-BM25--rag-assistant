[site]: stackoverflow
[post_id]: 4832934
[parent_id]: 4832802
[tags]: 
You can do it with a common table expression and ROW_NUMBER: WITH OrderDates AS ( SELECT ROW_NUMBER() OVER (ORDER BY OrderDate DESC) AS RowNumber, OrderDate FROM OrdersTable WHERE SKU = 'AA0000' ) SELECT AVG(DATEDIFF(DD, O2.OrderDate, O1.OrderDate)) AS AverageFrequency FROM OrderDates O1 LEFT JOIN OrderDates O2 ON O2.RowNumber = O1.RowNumber + 1
