[site]: stackoverflow
[post_id]: 3823966
[parent_id]: 3823398
[tags]: 
The way you are using it looks very much like how a Queue is used. When you work of the items on the queue they are removed when you treat them. Using one of the Queue classes might make the code more elegant. There are also variants which handle concurrent updates in a predictable way.
