[site]: stackoverflow
[post_id]: 3599156
[parent_id]: 3598772
[tags]: 
This VB.Net code will Create a picture of the form, Add Blur to the picture Add the picture to a picturebox Add a click-handler that removes the picture when clicked. Add the picturebox to the form and set as bringtofront The only thing is that the blur is pretty slow. So I would work on that. Imports System.Drawing.Imaging Public Class Form1 Private Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click ShowBlurredPicture() End Sub Sub ShowBlurredPicture() Dim blurredpic As Bitmap = gausianBlur(False, New Size(5, 5), GetFormPic) Dim p As New PictureBox p.Image = blurredpic p.Location = New Point(-System.Windows.Forms.SystemInformation.FrameBorderSize.Width, -(System.Windows.Forms.SystemInformation.CaptionHeight + System.Windows.Forms.SystemInformation.FrameBorderSize.Height)) p.Size = New Size(Me.Size) Me.Controls.Add(p) p.Visible = True p.BringToFront() AddHandler p.Click, AddressOf picclick End Sub Sub picclick(ByVal sender As Object, ByVal e As System.EventArgs) Me.Controls.Remove(sender) End Sub Function GetFormPic() As Bitmap Dim ScreenSize As Size = Me.Size Dim screenGrab As New Bitmap(Me.Width, Me.Height) Dim g As System.Drawing.Graphics = System.Drawing.Graphics.FromImage(screenGrab) g.CopyFromScreen(Me.Location, New Point(0, 0), Me.Size) Return screenGrab End Function Private Function Average(ByVal Size As Size, ByVal imageSize As SizeF, ByVal PixelX As Integer, ByVal Pixely As Integer, ByVal theimage As Bitmap) As Color Dim pixels As New ArrayList Dim x As Integer, y As Integer Dim bmp As Bitmap = theimage.Clone For x = PixelX - CInt(Size.Width / 2) To PixelX + CInt(Size.Width / 2) For y = Pixely - CInt(Size.Height / 2) To Pixely + CInt(Size.Height / 2) If (x > 0 And x 0 And y 255 Then ' Alpha blur channel check bmp.SetPixel(PixelX, PixelY, Average(blurSize, bmp.PhysicalDimension, PixelX, PixelY, theimage)) End If Application.DoEvents() Next Next Return bmp.Clone bmp.Dispose() End Function End Class I found the code to do the GasuianBlur here: http://www.codeproject.com/KB/GDI-plus/GausianBlur.aspx And the code to Copy a form to a bitmap here: http://www.daniweb.com/forums/thread94348.html
