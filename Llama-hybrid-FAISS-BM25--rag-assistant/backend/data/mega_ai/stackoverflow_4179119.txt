[site]: stackoverflow
[post_id]: 4179119
[parent_id]: 4149810
[tags]: 
What you are working on is called RVA (Relative Virtual Address). Basic formula is Address = Base + Displacement . Naturally, Address and Base are untyped pointers while Displacement is signed integer. Object Pascal disallows pointer arithmetics, so typecasting is required. So: var Address, Base: Pointer; Displacement: Integer; { ... } Address := Pointer(Cardinal(Base) + Displacement); { or, in your case } var Module: HMODULE; { opaque type designates module handle and equals to load address } NTHeaders: PImageNtHeaders; begin NTHeaders := Pointer(Cardinal(Module) + PImageDosHeader(Module)^._lfanew); if NTHeaders^.Signature = ......
