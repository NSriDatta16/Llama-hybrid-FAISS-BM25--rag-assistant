[site]: stackoverflow
[post_id]: 964964
[parent_id]: 964920
[tags]: 
If there is the possibility that some other process - be it the antivirus software, a backup utility or even the user themselves - can open the file, then you must code for that possibility. Your solution, while perhaps not the most elegant, will certainly work as long as ReasonableNumber is sufficiently large - in the past I've used 10 as the reasonable number. I certainly wouldn't go any higher and you could get away with a lower value such as 5. The value of sleep? 100ms or 200ms at most Bear in mind that most of the time your application will get the file first time anyway.
