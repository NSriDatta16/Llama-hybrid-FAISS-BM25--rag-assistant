[site]: crossvalidated
[post_id]: 546795
[parent_id]: 546697
[tags]: 
After some more searching and frustration, I decided to just do the F-test manually (and in a quick and dirty way). Here is how, in case some poor soul will have the same problem at some point in time. First, I wrote a function to manually calculate an F-test for simple linear regression models. ## manual F-test for linear hypothesis testing ## requires the unrestricted and the restricted model manual_LHT $residuals)^2) SSR_r residuals)^2) # number of restrictions (i.e., difference in residual degrees of freedom) q $df.residual - mod_u$ df.residual # number of regressors in unsrestricted model k $model)[2] - 1 # number of observations n residuals) # --- calculate F statistic nominator Second, I did a little sanity check using this standard example . library(AER) library(MASS) data("CASchools") CASchools $size students/CASchools $teachers CASchools$ score $read + CASchools$ math)/2 CASchools $expenditure expenditure/1000 model Both linearHypothesis() and manual_LHT() lead to the same results regarding F-statistic and p-value. Console output for the former: > linearHypothesis(model, c("size=0", "expenditure=0")) Linear hypothesis test Hypothesis: size = 0 expenditure = 0 Model 1: restricted model Model 2: score ~ size + english + expenditure Res.Df RSS Df Sum of Sq F Pr(>F) 1 418 89000 2 416 85700 2 3300.3 8.0101 0.000386 *** --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Console output for the latter. > manual_LHT(mod_u = model, mod_r = model.restricted) $Fval [1] 8.010125 $pval [1] 0.0003859748 Now, one important thing is to adapt the manual_LHT() function to the specifics of the regression model object. Specifically regarding quantile regressions with quantreg , the residual degrees of freedom can be obtained from summary(mod_r)$rdf instead of mod_r$df.residual like it is now in manual_LHT() . So, pay attention to this little adaptation requirement. I am happy for any feedback. Maybe going this way is a big blunder. ;)
