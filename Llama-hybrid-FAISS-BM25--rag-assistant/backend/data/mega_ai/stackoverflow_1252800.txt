[site]: stackoverflow
[post_id]: 1252800
[parent_id]: 
[tags]: 
Zend Framework: How to unit test a model using Zend_Service_Twitter

I have been getting into Unit Testing with Zend Framework. I am getting used to the other things it provide but I am having a hard time understanding Mock Objects. For this example, I am trying to use a Mock Object to test out my model. encryption->salt; $iv_size = mcrypt_get_iv_size(MCRYPT_XTEA, MCRYPT_MODE_ECB); $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND); $password = mcrypt_decrypt(MCRYPT_XTEA, $key, $password, MCRYPT_MODE_ECB, $iv); $this->_twitter = new Zend_Service_Twitter($username, $password); } public function verifyCredentials() { return $this->_twitter->account->verifyCredentials(); } public function friendsTimeline($params) { return $this->_twitter->status->friendsTimeline($params); } } For my unit test: require_once ('../application/models/Twitter.php'); class Model_TwitterTest extends ControllerTestCase { /** * @var Model_Twitter */ protected $_twitter; public function testfriendsTimeline() { $mockPosts = array('foo', 'bar'); //my understanding below is: //get a mock of Zend_Service_Twitter with the friendsTimeline method $twitterMock = $this->getMock('Zend_Service_Twitter', array('friendsTimeline')); /* line above will spit out an error: 1) testfriendsTimeline(Model_TwitterTest) Missing argument 1 for Mock_Zend_Service_Twitter_9fe2aeaa::__construct(), called in /Applications/MAMP/bin/php5/lib/php/PHPUnit/Framework/TestCase.php on line 672 and defined /htdocs/twitter/tests/application/models/TwitterTest.php:38 */ $twitterMock->expects($this->once()) ->method('friendsTimeline') ->will($this->returnValue($mockPosts)); $model = new Twitter_Model_Twitter(); $model->setOption('twitter', $twitterMock); $posts = $model->friendsTimeline(array('count'=>20)); $this->assertEquals($posts, $mockPosts); } } How would you test the following? 1) verifyCredentials() 2) friendsTimeline() Thanks, Wenbert
