[site]: crossvalidated
[post_id]: 447811
[parent_id]: 
[tags]: 
How to reproduce fitted ARIMA(0,1,1) values?

I am using R's forecast package's auto.arima function to forecast the following time series: kappa_fem [1] 2.50594398 2.41561580 2.01398417 1.48457404 2.04769840 2.01201415 1.64096776 1.57316001 [9] 1.52310538 0.59070658 0.39113565 0.05752619 -0.22008153 -0.29964353 -0.74587944 -1.66680655 [17] -1.58850370 -1.45096124 -1.86077396 -1.37769777 -2.23703721 -1.82095112 -2.07108890 -2.91700716 auto.arima gives the following ARIMA(0,1,1) model as output: > kappa_arima_fem kappa_arima_fem Series: kappa_fem ARIMA(0,1,1) with drift Coefficients: ma1 drift -0.4577 -0.2268 s.e. 0.2111 0.0444 sigma^2 estimated as 0.156: log likelihood=-10.34 AIC=26.69 AICc=27.95 BIC=30.1 So if I understand correctly, the time series has the following recursive formula: $$ \kappa_t-\kappa_{t-1}=-0.2268+\epsilon_t-0.4577\epsilon_{t-1}. $$ The model's fitted values are as follows: > kappa_arima_fem$fitted Time Series: Start = 1 End = 24 Frequency = 1 [1] 2.50321121 2.29149831 2.13496208 1.84024726 1.42041545 1.53407498 1.56648427 1.38005488 [9] 1.25795540 1.17492659 0.63126371 0.27421034 -0.07012882 -0.37827790 -0.56245865 -0.88875828 [17] -1.53753883 -1.79200440 -1.83387450 -2.07528881 -1.92379434 -2.32049963 -2.27640843 -2.39188475 I try to reproduce them by hand: fit_kappa_fem which gives me the following similar yet different values: > fit_kappa_fem [1] 2.50594398 2.27911790 2.11476359 1.84181321 1.45148743 1.49753263 1.50617225 1.34103880 [9] 1.22044895 1.13214137 0.65751373 0.30877287 -0.03304272 -0.34547192 -0.55132346 -0.86719309 [17] -1.45998284 -1.74562980 -1.83759324 -2.07502857 -1.98270328 -2.32593183 -2.32164050 -2.43379520 My questions are: 1) How are these fitted values calculated? 2) Why is the first fitted value different then the first value of the original time series kappa_fem? 3) I want to simulate $\kappa_{25}$ with $\epsilon_{25}=-0.3415483$ . How would I go about this correctly? Many thanks!
