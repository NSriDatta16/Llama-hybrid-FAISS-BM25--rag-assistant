[site]: crossvalidated
[post_id]: 40466
[parent_id]: 
[tags]: 
How can I debug and check the consistency of a Kalman filter?

I understand the basic principles involved in Kalman filtering and I have spent some time implementing several algorithms in MATLAB. The problem I'm facing now is to check if the algorithm and my code actually do the right thing. I know that there are statistical tests, such as the normalized estimation error squared (NEES) test and the normalized innovation squared (NIS) test. Their principle is described in the literature, but the description of implementation and interpretation of the results are pretty vague. In the simulations I currently do, I can't get the NEES test to pass even for the perfectly matched model (while the NIS test normally passes)! So my question is: Does anyone have tips, tricks, hints or references on how to check the consistency of the filter and debug the code if needed (especially regarding the interpretation of test outcomes)? (Remark: I first posted this on signal processing but figured it might receive more attention here. If more detailed information is needed, I'm happy to make my post more specific!)
