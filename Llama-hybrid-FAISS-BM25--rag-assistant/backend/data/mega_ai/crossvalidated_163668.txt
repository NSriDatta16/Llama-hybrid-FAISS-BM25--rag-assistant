[site]: crossvalidated
[post_id]: 163668
[parent_id]: 
[tags]: 
Could anyone help me check my gibbs sampling code?

I am now trying to write a Gibbs Sampling code based on the posteriors from a paper "Bayesian Regularization via Graph Laplacian", writer: Fei Liu, et. When I run the code, it always show the error: Error in eta_ii[i] = rinvgauss(n = 1, mean = mu_eta_ii, shape = a^2) : object of type 'closure' is not subsettable Does anyone know why? Or does anyone do this paper's gibbs sampling before? Thank you very much! Here is my code: library(pscl) library(MASS) library(statmod) p=ncol(x) n=nrow(x) In=diag(1,nrow=n,ncol=n) #STEP1. generate variance from the posterior distribution #p(var|lamda,D)~Inverse Gamma(n/2,y'(In-X(X'X+rlamda)^-1X')y/2) variance=function(lamda,X,Y){ var=rigamma(n,n/2,t(Y)%*%(In-X%*%solve(t(X)%*%X+r*lamda)%*%t(X))%*%Y/2) mvar=mean(var) return(mvar) } #STEP2. generate beta from the multivariate normal distribution #here I am not very sure about the meanninng of y_tuter beta=function(var,lamda,X,Y){ mu_beta=solve(t(X)%*%X+r*lamda)%*%t(X)%*%Y sg_beta=var*solve(t(X)%*%X+r*lamda) beta=mvrnorm(n=n,mu_beta,sg_beta) mbeta=colMeans(beta) return(mbeta) } #STEP3. generate the sign of the lamda:c, based on the binomial dist signC=function(beta,var,X,Y){ P=matrix(1,ncol=p,nrow=p) C=matrix(1,ncol=p,nrow=p) for (i in 1:p){ for(j in 1:i){ P[i,j]=1/(1+exp(-r*b*(abs(beta[i]-beta[j]-abs(beta[i]+beta[j]))/2*var)) C[i,j]=rbinom(1, 1, P[i,j]) if (C[i,j]==0){ C[i,j]=-1 } C[j,i]=C[i,j] if(i==j){ C[i,i]=1 } } } return(C) } #STEP4. generate the eta which is from the product of independent inverse Gaussian dists #1. for the eta_ii eta_ii=function(var,beta){ mu_eta_ii
