[site]: stackoverflow
[post_id]: 942381
[parent_id]: 942110
[tags]: 
Is browsing through Program Files and Windows\System32 a use-case for your app? I encourage you to abandon solving this problem, as it gets really ugly. Either stay all in the 32-bit world, or recompile for x64. Living in the "in-between" world of WOW64 will make your code much more complex. If you really want to do this, http://msdn.microsoft.com/en-us/library/aa365743(VS.85).aspx will do the trick.
