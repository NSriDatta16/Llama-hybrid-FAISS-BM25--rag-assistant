[site]: stackoverflow
[post_id]: 5586454
[parent_id]: 
[tags]: 
Simple MySQL query taking far too long

Environment: Rails 2.3.11, MySQL 5.1 (InnoDB) My Rails app has been sporadically encountering issues with simple queries taking far too long to complete and bottlenecking the entire application's ability to be updated. These queries typically are related to the forum, the highest traffic section of the site and the one with (by far) the most updates. Here is an example of a sample query pulled from the MySQL slow log: # Query_time: 46.900202 Lock_time: 0.000030 Rows_sent: 0 Rows_examined: 0 SET timestamp=1302172666; UPDATE `forum_topics` SET `views` = 153, `updated_at` = '2011-04-07 10:36:59' WHERE `id` = 1213305; This is a very simple query and should be extremely fast, though in this case it took almost 47 seconds to complete. The load average on this server never exceeds 2, so that is not the issue. Some other points of interest are: Neither views nor updated_at are indexed. While the auto-increment value may be 1.2M, there are actually only 70K records in this table. Over 90% of all queries in the slow query log are similar to this one. What I am looking for here are some recommendations regarding next steps to take to resolve this issue. Thanks. P.S. Schema/indexes are as follows: CREATE TABLE `forum_topics` ( `id` int(11) NOT NULL AUTO_INCREMENT, `forum_category_id` int(11) DEFAULT NULL, `title` varchar(255) NOT NULL, `sticky` tinyint(1) DEFAULT '0', `views` int(11) DEFAULT '0', `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `last_post_created_at` datetime DEFAULT NULL, `slug` varchar(255) DEFAULT NULL, PRIMARY KEY (`id`), KEY `index_forum_topics_on_created_at` (`created_at`), KEY `index_forum_topics_on_forum_category_id` (`forum_category_id`), KEY `index_forum_topics_on_sticky` (`sticky`) ) ENGINE=InnoDB AUTO_INCREMENT=1215414 DEFAULT CHARSET=utf8;
