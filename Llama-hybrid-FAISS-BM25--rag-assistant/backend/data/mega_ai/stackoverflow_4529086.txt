[site]: stackoverflow
[post_id]: 4529086
[parent_id]: 
[tags]: 
Identifying pinch gesture drag gesture on iPhone?

I have a small image on a view. The view is the object process multi-touch actions. If a finger drag on the view, the image will translate its position. And if user use 2 fingers to make pinch gesture, the image will scale its size. And I do work as section code below: //touch detect methods - (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event { NSLog(@"Touch began"); //Devide into 2 cases: 1 touch and 2 touches. if ([touches count] == 1) { NSLog(@"Touch began cout = 1"); currentImageCenter = focusImage.center; UITouch *touch = [[touches allObjects] objectAtIndex:0]; previousPoint = [touch locationInView:self]; isTwoFingerTouching = FALSE; } else if([touches count] == 2){ NSLog(@"Touch began cout = 2"); UITouch *touch = [[touches allObjects] objectAtIndex:0]; beginFirstPoint = [touch locationInView:self]; touch = [[touches allObjects] objectAtIndex:1]; beginSecondPoint = [touch locationInView:self]; isTwoFingerTouching = TRUE; } } - (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event { if ([touches count] == 1 && isTwoFingerTouching == FALSE) { UITouch *touch = [touches anyObject]; CGPoint currentPosition = [touch locationInView:self]; //Calculate distance double deltaX = currentPosition.x - previousPoint.x; double deltaY = currentPosition.y - previousPoint.y; NSLog(@"Touch move detect 1 touch "); focusImage.center = CGPointMake(currentImageCenter.x+deltaX, currentImageCenter.y+deltaY); } else if([touches count] == 2){ NSLog(@"Touch move detect 2 touches"); CGPoint currentFirstPoint; CGPoint currentSecondPoint; UITouch *touch = [[touches allObjects] objectAtIndex:0]; currentFirstPoint = [touch locationInView:self]; CGPoint previousFirstPoint = [touch previousLocationInView:self]; touch = [[touches allObjects] objectAtIndex:1]; currentSecondPoint = [touch locationInView:self]; CGPoint previousSecondPoint = [touch previousLocationInView:self]; //Compare previous points with current points. //Pinch gesture CGFloat beginDistance = distanceBetweenPoints(previousFirstPoint, previousSecondPoint); CGFloat currentDistance = distanceBetweenPoints(currentFirstPoint, currentSecondPoint); if (currentDistance > 0 && beginDistance > 0) { double scale = currentDistance/beginDistance; NSLog(@"%f", scale); //Rotation CGPoint vector1 = CGPointMake(previousFirstPoint.x - previousSecondPoint.x, previousFirstPoint.y - previousSecondPoint.y); CGPoint vector2 = CGPointMake(currentFirstPoint.x - currentSecondPoint.x, currentFirstPoint.y - currentSecondPoint.y); //[vector1, vector2]. double zValue = vector1.x*vector2.y - vector1.y*vector2.x; CGFloat rotateAngle = angleBetweenLines(previousFirstPoint, previousSecondPoint, currentFirstPoint, currentSecondPoint); //zValue 1 || focusImage.frame.size.width > 30) { CGAffineTransform previousTransform = focusImage.transform; CGAffineTransform mixTransform = CGAffineTransformConcat(CGAffineTransformMakeScale(scale, scale), CGAffineTransformMakeRotation(rotateAngle)); focusImage.transform = CGAffineTransformConcat(previousTransform, mixTransform); } } } } But the problem is: I can't identify whether 1 finger or 2 fingers on screen. When I touch 2 fingers, and I move (for rotate and scale) those fingers, [touches count] in touchesMoved: method still equal 1 occasionally. Any one experienced this, please tell me how to solve my problem?
