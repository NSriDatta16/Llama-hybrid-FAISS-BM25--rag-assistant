[site]: crossvalidated
[post_id]: 104258
[parent_id]: 
[tags]: 
Whitening Transformation using a Hadamard product Variance Matrix

I want to whiten a vector $X$ by transforming the variance-covariance matrix so the variance-covariance matrix of the transformed series will be the identity matrix $I$. $X$ is a time-series column vector with variance-covariance matrix $M$ and mean $0$. If $X$ was a set of correlated data, then the covariance matrix $M$ could be written as the outer product of $X$ with itself: $M=\mathrm{E}\left[XX^T\right]$. $M$ is thus a variance-covariance matrix, symmetric and positive semidefinite, has a square root $M^{{1}/{2}}$, so $M^{{1}/{2}}\left(M^{{1}/{2}}\right)^T=M$. If $M$ is positive definite then $M^{{1}/{2}}$ is invertible, so the vector $Y=M^{-{1}/{2}}X$ has covariance matrix: $\mathrm{Cov}\left[Y\right]=\mathrm{E}\left[YY^T\right] = M^{-{1}/{2}}\mathrm{E}\left[XX^T\right]\left( M^{-{1}/{2}}\right)^T=M^{-{1}/{2}}M\left( M^{-{1}/{2}}\right)^T=\left(M^{-{1}/{2}}M^{{1}/{2}}\right)\left(M^{{1}/{2}}\right)^T\left( M^{-{1}/{2}}\right)^T=I$ However, when $X$ is a time series $M$, the variance-covariance matrix is constructed from the autocovariance function of $X$ as: $\left(\begin{array}{cccc} \gamma\left(0\right) & \gamma\left(1\right) & \cdots & \gamma\left(n-1\right)\\ \gamma\left(1\right) & \gamma\left(0\right) & \cdots & \gamma\left(n-2\right)\\ \vdots & \vdots & \ddots & \vdots \\ \gamma\left(n-1\right) & \gamma\left(n-2\right) & \cdots & \gamma\left(0\right) \end{array}\right)$ which is not the same as $M=\mathrm{E}\left[XX^T\right]$. However, this can be written as the Hadamard product $W \circ M$, where $W$ is a known set of weights. When I apply the method, I can find a square root of $W \circ M$ that decorrelates the dataset $X$. However, the decorrelated dataset does not have unit variance - the varaince is lower because of the effect of $W$. However, after doing this for around 100 different datasets, the required correction factor is 0.75, or thereabouts. Is there a way to derive this correction factor directly from the matrix algebra? Many thanks in advance. Just for the record, this question is not being asked in order to answer to any test or assignment.
