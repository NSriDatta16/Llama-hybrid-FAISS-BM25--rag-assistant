[site]: crossvalidated
[post_id]: 618157
[parent_id]: 
[tags]: 
Matrix Factorization with SGD gets na results

I'm trying to implement MF with SGD to my sample data following thru https://nbviewer.org/github/albertauyeung/matrix-factorization-in-python/blob/master/mf.ipynb . And, it's hard to figure out why the function returns na for RMSE only when I enter bigger numbers in the matrix. In the link, it uses a matrix with relatively small numbers and works fine. But only when I enter bigger numbers, for instance: R = np.array([[12., 0., 18., 15., 12.], [30., 40., 0., 0., 0.], [40., 0., 0., 0., 0.], [22., 30., 35., 20., 30.], [40., 40., 38., 30., 38.], [30., 30., 30., 38., 30.]]) the prediction gets to inf., therefore returning NA for RMSE. It would be greatly appreciated if you could help me understand what to correct and how it works.
