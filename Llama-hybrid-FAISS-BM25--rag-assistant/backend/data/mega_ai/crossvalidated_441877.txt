[site]: crossvalidated
[post_id]: 441877
[parent_id]: 
[tags]: 
Keeping track of the variance of a Metropolis-Hastings estimator

Let $(E,\mathcal E,\lambda)$ and $(E',\mathcal E',\lambda')$ be measure spaces, $p,q$ be probability densities on $(E,\mathcal E,\lambda)$ , and $\varphi:E'\to E$ be bijective and $(\mathcal E',\mathcal E)$ -measurable with $\lambda'\circ\varphi^{-1}=q\lambda$ . Let $(X_n)_{n\in\mathbb N_0}$ denote the Markov chain generated by the Metropolis-Hastings algorithm with proposal kernel $R$ , $$R(x,B)=\int_B\lambda({\rm d}y)q(y)r\left(\varphi^{-1}(x),\varphi^{-1}(y)\right)\;\;\;\text{for all }(x,B)\in E\times\mathcal E\tag1$$ for some $\mathcal E'\otimes\mathcal E'$ -measurable $r:E'\times E'\to[0,\infty)$ , and target distribution $\mu:=p\lambda$ and $(Y_n)_{n\in\mathbb N}$ denote the corresponding proposal sequence. Consider the estimator $$A_ng:=\frac{\sum_{i=1}^n\rho(X_{i-1},Y_i)\frac gp(Y_i)}{\sum_{i=1}^n\rho(X_{i-1},Y_i)}$$ of $\lambda g$ , where $$\rho(x,y):=\frac{p(y)}{q(y)r\left(\varphi^{-1}(x),\varphi^{-1}(y)\right)}\;\;\;\text{for }x,y\in E.$$ The asymptotic variance is given by $$\sigma^2(g):=\int\mu({\rm d}x)\underbrace{\int\lambda({\rm d}y)\frac{|g(y)|^2}{q(y)r\left(\varphi^{-1}(x),\varphi^{-1}(y)\right)}}_{=:\:a_g(x)}.$$ Are we able to estimate the quantity $a_g(x)$ (for fixed $g$ and $x\in E$ ) using the estimate $A_ng$ ? Remark : What I'm trying to achieve is analogous to the way we estimate the variance in importance sampling; see, for example, equation 9.5 in https://statweb.stanford.edu/~owen/mc/Ch-var-is.pdf .
