[site]: stackoverflow
[post_id]: 4604013
[parent_id]: 4603780
[tags]: 
You could split the string into tag ‍/‍ no-tag parts using preg_split : $parts = preg_split('/( ]|"[^" )/', $str, -1, PREG_SPLIT_DELIM_CAPTURE); Then you can iterate the parts while skipping every even part (i.e. the tag parts) and apply your replacement on it: for ($i=0, $n=count($parts); $i $1 ", $parts[$i]); } At the end put everything back together with implode : $str = implode('', $parts); But note that this is really not the best solution. You should better use a proper HTML parser like PHP’s DOM library. See for example these related questions: Highlight keywords in a paragraph Regex / DOMDocument - match and replace text not in a link
