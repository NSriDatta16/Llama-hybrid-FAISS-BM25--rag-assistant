[site]: stackoverflow
[post_id]: 5603538
[parent_id]: 
[tags]: 
group_by using value from other model

Using ROR 2.3.8 I have this in cities_controller.rb : @shops = Shop.published.search params[:keyword], { :conditions => conditions, :star => true, :group_by => 'city_id', :group_function => :attr, :page => params[:page] }.merge(:order => 'rating_average DESC') @cities = @shops.collect { |shop| shopy.city } How can I tell Rails to get the rating_average from City model instead of Shop model? Because the Shop model does not have rating_average . It's actually City model that gets rated. Thank you. UPDATES published namescope in Shop.rb sphinx_scope(:published) { {:conditions => {:status => 'published'}} } Indexes in Shop.rb define_index do indexes city.name, :as => :name, :sortable => true indexes city.duration, :as => :duration indexes city.status, :as => :status #has city.budget, :as => :budget #has city(:created_at), :as => :created_at has city(:rating_average), :as => :rating_average has city_id end UPDATES 2 class City :destroy ... end
