[site]: crossvalidated
[post_id]: 597708
[parent_id]: 
[tags]: 
Weird Adonis2 output in R: by="Margin" results in a R2 of 0, F of -Inf, and no P-value for 1 factor

I'm running a PERMANOVA analysis using vegan's adonis2 . I have (rarefied) fungal community data (18S sequencing) of 24 samples. As treatments I have subplot (1,2,3,4,5 or 6) and state (con and sup). Each subplot has 4 samples and a subplot is seen as either 'con' or 'sup'. Thus metadata looking like: To perform the PERMANOVA analysis and test marginal effect of the variables, I run following command: adonis2(vegan_abundance_mat ~ factor(state) + factor(subplot), by="margin", data=vegan_sample_data, permutations = 1000,method="bray") Which yields: Permutation test for adonis under reduced model Marginal effects of terms Permutation: free Number of permutations: 1000 adonis2(formula = vegan_abundance_mat ~ factor(state) + factor(subplot), data = vegan_sample_data, permutations = 1000, method = "bray", by = "margin") Df SumOfSqs R2 F Pr(>F) factor(state) 0 0.00000 0.00000 -Inf factor(subplot) 4 0.28593 0.28305 1.8711 0.000999 *** Residual 18 0.68767 0.68075 Total 23 1.01017 1.00000 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Why does my "state" variable, get this weird output as stated in the title of this topic? If I add the terms sequentially to the model, the output looks 'normal': adonis2(vegan_abundance_mat ~ factor(state) + factor(subplot), by="terms",data=vegan_sample_data, permutations = 1000,method="bray") Permutation test for adonis under reduced model Terms added sequentially (first to last) Permutation: free Number of permutations: 1000 adonis2(formula = vegan_abundance_mat ~ factor(state) + factor(subplot), data = vegan_sample_data, permutations = 1000, method = "bray", by = "terms") Df SumOfSqs R2 F Pr(>F) factor(state) 1 0.03657 0.03620 0.9571 0.481518 factor(subplot) 4 0.28593 0.28305 1.8711 0.000999 *** Residual 18 0.68767 0.68075 Total 23 1.01017 1.00000 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 What also strikes me: if I first add variable subplot and then state , the output does not show variable state . Also, the R2 value of subplot is the sum of the R2 value of state and subplot of the previous analysis (=0.03620 + 0.28305): adonis2(vegan_abundance_mat ~ factor(subplot) + factor(state), by="terms",data=vegan_sample_data, permutations = 1000,method="bray") yields: Permutation test for adonis under reduced model Terms added sequentially (first to last) Permutation: free Number of permutations: 1000 adonis2(formula = vegan_abundance_mat ~ factor(subplot) + factor(state), data = vegan_sample_data, permutations = 1000, method = "bray", by = "terms") Df SumOfSqs R2 F Pr(>F) factor(subplot) 5 0.32250 0.31925 1.6883 0.000999 *** Residual 18 0.68767 0.68075 Total 23 1.01017 1.00000 --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Does anyone have an idea what is happening with my 'State' variable in my analyses? Thank you!
