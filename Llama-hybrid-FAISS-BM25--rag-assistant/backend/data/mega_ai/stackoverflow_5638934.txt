[site]: stackoverflow
[post_id]: 5638934
[parent_id]: 
[tags]: 
openCV and Threads issue

I'm trying to fit facedetect from openCV on my QT code, all run fine until i decided to create a thread for my openCV code so I can run another things while the face detect is on. the problem is if i call class->start(); my program breaks in the while loop in the run() but if i call the class.run(); (like a normal function) it runs as usual! what can be wrong? code: faceTracker::faceTracker() { qDebug("teste1"); filename = "/Users/marcomartins/Documents/QT/DisplUM/haarcascades/haarcascade_frontalface_alt_tree.xml"; /* load the classifier note that I put the file in the same directory with this code */ cascade = ( CvHaarClassifierCascade* )cvLoad( filename, 0, 0, 0 ); /* setup memory buffer; needed by the face detector */ storage = cvCreateMemStorage( 0 ); /* initialize camera */ capture = cvCaptureFromCAM( 0 ); /* always check */ assert( cascade && storage && capture ); /* create a window */ cvNamedWindow( "video DisplUM", 1 ); } void faceTracker::detectFaces( IplImage *img ) { /* detect faces */ faces = cvHaarDetectObjects( img, cascade, storage, 1.1, 3, 0 /*CV_HAAR_DO_CANNY_PRUNNING*/, cvSize( 40, 40 ) ); /* for each face found, draw a red box */ for( i = 0 ; i total : 0 ) ; i++ ) { CvRect *r = ( CvRect* )cvGetSeqElem( faces, i ); cvRectangle( img, cvPoint( r->x, r->y ), cvPoint( r->x + r->width, r->y + r->height ), CV_RGB( 255, 0, 0 ), 1, 8, 0 ); qDebug("caras: %d", faces->total); } /* display video */ cvShowImage( "video", img ); } void faceTracker::run( ) { qDebug("teste2"); while( key != 'q' ) { /* get a frame */ frame = cvQueryFrame( capture ); qDebug("teste3"); /* always check */ if( !frame ) break; /* 'fix' frame */ cvFlip( frame, frame, 1 ); frame->origin = 0; /* detect faces and display video */ detectFaces( frame ); /* quit if user press 'q' */ key = cvWaitKey( 10 ); } /* free memory */ cvReleaseCapture( &capture ); cvDestroyWindow( "video" ); cvReleaseHaarClassifierCascade( &cascade ); cvReleaseMemStorage( &storage ); } main code: int main(int argc, char *argv[]) { faceTracker * ft = new faceTracker(); ft->start(); } thanks a lot!
