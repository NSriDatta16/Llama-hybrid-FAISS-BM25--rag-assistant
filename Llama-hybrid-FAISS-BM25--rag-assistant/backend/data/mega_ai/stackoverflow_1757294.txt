[site]: stackoverflow
[post_id]: 1757294
[parent_id]: 1757181
[tags]: 
To be honest, something that convoluted is probably confusing TextMate as much as anyone else who has to maintain it, and that includes you in the future. Whenever you see something that rolls up into a single value, it's a good case for using Enumerable#inject. sum = two_dimensional_array.inject(0) do |sum, row| # Convert row to Fixnum equivalent row_i = row.collect { |i| i.to_i } if (row_i.sum > 5) sum += row_i.collect { |i| i ** 2 }.average end sum # Carry through to next inject call end What's odd in your example is you're using select to return the full array, allegedly converted using to_i, but in fact Enumerable#select does no such thing, and instead rejects any for which the function returns nil. I'm presuming that's none of your values. Also depending on how your .average method is implemented, you may want to seed the inject call with 0.0 instead of 0 to use a floating-point value.
