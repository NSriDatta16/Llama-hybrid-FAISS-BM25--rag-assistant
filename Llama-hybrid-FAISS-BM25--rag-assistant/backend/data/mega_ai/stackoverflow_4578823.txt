[site]: stackoverflow
[post_id]: 4578823
[parent_id]: 4578542
[tags]: 
It seems you can't. Alternatively, it works perfectly fine on a regular if condition, and gcc can optimize this nicely. if (!strcmp(__BASE_FILE__, __FILE__)) { // works. } but you can't define new main functions or use other preprocessor tricks. but you could short-circuit main by using static methods, but that's harsh and dirty. But maybe you shouldn't do it. in Ruby/python, this works because usage of files is done at runtime. in C, all files are to be compiled to be used. Keep in mind that most build system will build one file at a time, building them as object files, and rebuilding them only when necessary. So __BASE_FILE__ and __FILE__ will be equals most of the time in sources files, if not always. And i would strongly discourage you to do this in header files. It's easier to just put your tests in separate files, only linking them when needed.
