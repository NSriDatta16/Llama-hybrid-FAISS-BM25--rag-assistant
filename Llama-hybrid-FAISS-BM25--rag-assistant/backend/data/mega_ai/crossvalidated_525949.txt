[site]: crossvalidated
[post_id]: 525949
[parent_id]: 
[tags]: 
Applying outlier adjustment using student's t distribution in a state-space model

I'm exploring performing outlier adjustment in a state-space model by using student's $t$ distribution. The gist of the problem is formulated as follows: $$ \begin{align*} y_t^* &= u_t + o_t - o_{t-1}, \\ u_t &= \rho_1 u_{t-1} + \rho_2 u_{t-2} + \eta_{t}, \\ o_t &\sim t_\nu (\sigma_o). \end{align*} $$ where $y_t^*$ is a time series of observables, modeled as the sum of $u_t$ and the one-period change in $o_t$ , where $o_t$ is the additive outlier component. We let $u_t$ follow the $AR(2)$ process, and $o_t$ follows i.i.d. $t$ distribution. After consulting some literature, I decided to model the $t$ -distributed variables using scale mixtures; i.e., the measurement equation above is equivalent to $$ \begin{align*} y_t^* & = u_t + \sqrt{\varphi_t} z_t - \sqrt{\varphi_{t-1}} z_{t-1},\qquad z\sim N(0, \sigma_o^2) \text{ and } \varphi\sim IG. \end{align*} $$ I then cast the above system in the state-space format, with the following measurement equation: $$ y_t^* = \begin{pmatrix} \sqrt{\varphi_t} & -\sqrt{\varphi_{t-1}} & 1 & 0 \end{pmatrix} \begin{pmatrix} z_t \\ z_{t-1} \\ u_t \\ u_{t-1} \end{pmatrix},$$ and the following transition system $$ \begin{pmatrix} z_t \\ z_{t-1} \\ u_t \\ u_{t-1} \end{pmatrix} = \begin{pmatrix} 0 & 0 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & \rho_1 & \rho_2 \\ 0 & 0 & 1 & 0 \end{pmatrix} \begin{pmatrix} z_{t-1} \\ z_{t-2} \\ u_{t-1} \\ u_{t-2} \end{pmatrix} + \begin{pmatrix} \eta_z \\ 0 \\ \eta_u \\ 0 \end{pmatrix}, $$ where $\eta_z \sim N(0, \sigma_o^2)$ . To draw the outlier component and the hyperparameters, I thought the following Gibbs sampling procedure might be appropriate: Conditional on $\varphi_t^{j-1}$ and $\sigma_o^{j-1}$ , use simulation smoother to draw $z_t$ and $u_t$ ; then it's trivial to compute $o_t^j = \sqrt{\varphi_t} z_t$ ; Given $o_t^j$ and conditional on $\varphi_t^{j-1}$ , draw $\sigma_o^j$ . Conditional on $\sigma_o^j$ and $\nu^{j-1}$ , draw $\varphi_t^j$ . Draw $\nu^j$ . Increment $j$ by 1. Iâ€™m somewhat new to Gibbs sampling and non-Gaussian state-space models. I'm wondering whether there are obvious theoretical issues with this setup.
