[site]: crossvalidated
[post_id]: 365893
[parent_id]: 
[tags]: 
How to calculate WAIC from a JAGS model, and fix p_waic issue?

I am running a logistic regression type model in JAGS, and I noticed that I was getting different DIC scores (more than just a few points difference) between runs of the same model. I have a suspicion it is because I have too few 0’s in my binomial response variable (Status). I wanted to calculate WAIC as I have heard it is more robust for hierarchical models. Below is a simplified version of my JAGS code, I have 3 continuous response variables, Dim.1, Dim.2 and Dim.3, and use partial pooling to allow the coefficients to vary by the Site in which they were measured. I also have an AgeClass variable that is categorical with 4 potential values, with some data values missing. I model these missing values by using a categorical distribution. The JAGS code is; model { for(i in 1:N){ # These lines describe the response distribution and linear model terms: Status[i] ~ dbin(regression_prob[i], 1) regression_residual[i] I use the following code in R to monitor the log.like parameter for each data point and then use the loo package to calculate WAIC. library(jagsUI) data1 For which I get... Computed from 10800 by 1172 log-likelihood matrix Estimate SE elpd_waic -504.3 21.4 p_waic 42.1 2.5 waic 1008.5 42.9 Warning message: 8 (0.7%) p_waic estimates greater than 0.4. We recommend trying loo instead. I notice here that I get a warning about my p_waic estimate, which from the following question ( Warnings during WAIC computation: how to proceed? ) that my model is too flexible and I have a few influential observations. My questions are; Given my JAGS code, am I calculating the log-likelihoods correctly and am I using the correct input to the waic() function? -it’s hard to tell because I see loo used more often with STAN models. Would the best course of action be to start simplifying my model, remove the partial pooling, modelling of missing AgeClass data etc? Would this make the WAIC values more reliable? Could I then use it for model selection of the covariates (Dim1-3)? I think the loo package is very useful but it’s my first time using it and just need to make sure I’m proceeding in the most sensible way. Thanks!
