[site]: stackoverflow
[post_id]: 2909688
[parent_id]: 2894832
[tags]: 
FINALLY!!!!! I got it to work here is the query: SELECT sum( iv.inv_total - iv.inv_discount + iv.taxes ) FROM ( SELECT (SELECT sum(ii.total) FROM si_invoice_items ii where ii.invoice_id = v.id) as inv_total , ( SELECT CASE v.discount_type WHEN 1 THEN v.discount WHEN 2 THEN (v.discount / 100) * ( SELECT inv_total ) ELSE 0 END ) AS inv_discount, (SELECT CASE t.type WHEN '$' THEN t.tax_percentage WHEN '%' THEN ( t.tax_percentage / 100 ) * (SELECT inv_total - inv_discount) ELSE 0 END FROM si_tax as t WHERE t.tax_id = inv_tax_id ) AS taxes FROM si_invoices v ) iv elegant , its a beauty isn't she.. :D thanks Arnie I appreciate your help, and Mike Pelley it would've been better if you gave a positive comment or a little help rather than acting as "man of the law"
