[site]: crossvalidated
[post_id]: 200727
[parent_id]: 200698
[tags]: 
$(\ast)\;\; W_k^{-1}=W_0^{-1}-\color{red}{m_k \beta_k m_k'} + \color{blue}{\mu_o \beta_o \mu_0'} + \color{green}{\sum_n q_{nk} x_n x_n'}$ $W_k^{-1}=W_0^{-1}+\text{all else}=W_0^{-1} - \color{red}{\text{term1}} + \color{blue}{\text{term2}}+\color{green}{\text{term3}}$ For $\color{red}{\text{term1}}$, plug in the defined value of $m_k$: $\color{red}{\text{term1}}=\dfrac{1}{\beta_k}\left(\beta_0^2 \mu_0 \mu_0' + \beta_0 \sum_n q_{nk} \mu_0 x_n' + \beta_0 \sum_n q_{nk} x_n \mu_0' + (\sum_n q_{nk} x_n)^2 \right)$ First, note that just according to definition, we have: $\beta_k=N_k + \beta_0$. Also, by definition, $\sum_n q_{nk} x_n=N_k \bar{x}_k$. $\Rightarrow \color{red}{\text{term1}}=\dfrac{1}{\beta_0 + N_k}\left( \beta_0^2 \mu_0 \mu_0' + \beta_0 N_k \mu_0 \bar{x}_k' + \beta_0 N_k \bar{x}_k \mu_0' + N_k^2 \bar{x}_k \bar{x}_k' \right)$ Therefore, $\text{all else} = \color{blue}{\beta_0 \mu_0 \mu_0'} + \color{green}{\sum_n q_{nk} x_n x_n'} - \dfrac{1}{\beta_k}\left( \beta_0^2 \mu_0 \mu_0' + \beta_0 N_k \mu_0 \bar{x}_k' + \beta_0 N_k \bar{x}_k \mu_0' + N_k^2 \bar{x}_k \bar{x}_k' \right)$ $=\dfrac{\beta_0 N_k}{\beta_k} \color{blue}{\mu_0 \mu_0'}+\dfrac{1}{\beta_k} \left( (\beta_0 + N_k) \color{green}{\sum_n q_{nk} x_n x_n'} - \color{grey}{\beta_0 N_k\mu_0 \bar{x}_k'} - \color{grey}{\beta_0 N_k \bar{x}_k \mu_0'} - N_k^2 \bar{x}_k \bar{x}_k' \right)$ $=\dfrac{\beta_0 N_k}{\beta_k} \left( \color{blue}{\mu_0 \mu_0'} -\color{grey}{\mu_0 \bar{x}_k'} - \color{grey}{\bar{x}_k \mu_0'} + \color{purple}{\bar{x}_k\bar{x}_k'}\right)- \dfrac{\beta_0 N_k}{\beta_k}\color{purple}{\bar{x}_k\bar{x}_k'} +\dfrac{1}{\beta_k} \left( (\beta_0 + N_k) \color{green}{\sum_n q_{nk} x_n x_n'} - N_k^2 \bar{x}_k \bar{x}_k'\right)$ $=\color{magenta}{\dfrac{\beta_0 N_k}{\beta_k} (\bar{x}_k-\mu_0)(\bar{x}_k-\mu_0)'} + \dfrac{\beta_0+N_k}{\beta_k} \left( \sum_n q_{nk} x_n x_n' - N_k \bar{x}_k\bar{x}_k' \right)$ $=\color{magenta}{\dfrac{\beta_0 N_k}{\beta_k} (\bar{x}_k-\mu_0)(\bar{x}_k-\mu_0)'} + \left( \sum_n q_{nk}x_nx_n'-\color{grey}{N_k \bar{x}_k\bar{x}_k'} + \color{grey}{N_k\bar{x}_k\bar{x}_k'} - N_k\bar{x}_k \bar{x}_k' \right)$ (use the definition of $\bar{x}_k$ to get: ) $=\color{magenta}{\ldots} + (\sum_n q_{nk} x_n x_n' - \bar{x}_k \sum_n q_{nk} x_n' - \sum_n q_{nk} x_n \bar{x}_k' - \sum_n q_{nk} \bar{x}_k \bar{x}_k')$ $=\color{magenta}{\ldots} + \sum_n q_{nk} (x_n - \bar{x}_k)(x_n - \bar{x}_k)'$ $=\color{magenta}{\ldots} + N_k S_k$, as required.
