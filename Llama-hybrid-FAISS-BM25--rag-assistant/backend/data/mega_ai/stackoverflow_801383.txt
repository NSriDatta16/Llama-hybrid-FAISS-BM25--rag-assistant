[site]: stackoverflow
[post_id]: 801383
[parent_id]: 673265
[tags]: 
/** * The Hacked NLS (National Language Support) system. * * Singleton. * * @author mima */ public final class HackedNLS { private static final HackedNLS instance = new HackedNLS(); private final Map translations; private final Set knownMissing; /** * Create the NLS singleton. */ private HackedNLS() { translations = new HashMap (); knownMissing = new HashSet (); } /** * Populates the NLS key/value pairs for the current locale. * * Plugin localization files may have any name as long as it is declared in the Manifest under * the Bundle-Localization key. * * Fragments MUST define their localization using the base name 'fragment'. * This is due to the fact that I have no access to the Bundle-Localization key for the * fragment. * This may change. * * @param bundle The bundle to use for population. */ public void populate(Bundle bundle) { String baseName = (String) bundle.getHeaders().get("Bundle-Localization"); populate(getLocalizedEntry(baseName, bundle)); populate(getLocalizedEntry("fragment", bundle)); } private URL getLocalizedEntry(String baseName, Bundle bundle) { Locale locale = Locale.getDefault(); URL entry = bundle.getEntry(getFileName(baseName, locale.getLanguage(), locale.getCountry())); if (entry == null) { entry = bundle.getResource(getFileName(baseName, locale.getLanguage(), locale.getCountry())); } if (entry == null) { entry = bundle.getEntry(getFileName(baseName, locale.getLanguage())); } if (entry == null) { entry = bundle.getResource(getFileName(baseName, locale.getLanguage())); } if (entry == null) { entry = bundle.getEntry(getFileName(baseName)); } if (entry == null) { entry = bundle.getResource(getFileName(baseName)); } return entry; } private String getFileName(String baseName, String...arguments) { String name = baseName; for (int index = 0; index
