[site]: stackoverflow
[post_id]: 2590928
[parent_id]: 2590840
[tags]: 
The issue you are experiencing might be caused by fragmentation of the Large Object Heap rather than a normal out of memory condition where all memory really is used up. See http://msdn.microsoft.com/en-us/magazine/cc534993.aspx The solution might be as simple as growing the array by large fixed increments rather than smaller random increments so that as arrays are freed up the blocks of LOH memory can be reused for a new large array. This may also explain the struct->class issue as the struct is likely stored in the array itself while the class will be a small object on the small object heap.
