[site]: stackoverflow
[post_id]: 3597912
[parent_id]: 3519249
[tags]: 
You have a couple of issues. First, you should download the ClipSpy tool which will show you exactly what Formats are getting drag/dropped or copy/pasted. You will find that image SRC urls are stored in the UniformResourceLocatorW format, and there are various other formats available as well, including CF_HDROP which points to a local copy of the image file. Secondly, you will find that the Drag/Drop doesn't work properly from Protected Mode IE on Vista and Windows 7 due to security restrictions. To enable drag/drop to your application, you must list your application in the registry. You can register your application to accept web content from a drag-and-drop operation by creating a DragDrop policy. DragDrop policies must have a globally unique identifier (GUID) associated with them. Use CreateGuid to create a new GUID for your policy. Next, add a key to the following location. HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Low Rights\DragDrop Set the name of the new key to the GUID created for your policy and then add the following settings to the key. Policy (DWORD) should be set to 3, which tells Protected Mode to allow web content to be silently copied to your application process. AppName (REG_SZ) is the filename of your application executable file. AppPath (REG_SZ) is the user-selected install location of your application's executable file.
