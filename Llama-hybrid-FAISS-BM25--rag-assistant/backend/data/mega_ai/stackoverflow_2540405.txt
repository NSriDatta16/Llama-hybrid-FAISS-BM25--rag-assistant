[site]: stackoverflow
[post_id]: 2540405
[parent_id]: 2540368
[tags]: 
You could iterate over the dataset, but instead of creating the CSV file on your server simply return it through the HTTP response. The following function should do the trick. Public Shared Sub ExportTextFile(ByVal response As System.Web.HttpResponse, ByVal text As String, ByVal fileName As String) response.Clear() response.AddHeader("content-disposition", String.Format("attachment;filename={0}", fileName)) response.Charset = "" response.Cache.SetCacheability(HttpCacheability.NoCache) response.ContentType = "application/vnd.text" Dim stringWrite As New System.IO.StringWriter Dim htmlWrite = New HtmlTextWriter(stringWrite) response.Write(text.ToString) response.End() End Sub
