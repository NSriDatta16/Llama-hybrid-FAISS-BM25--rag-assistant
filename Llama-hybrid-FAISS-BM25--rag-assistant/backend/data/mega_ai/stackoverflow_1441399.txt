[site]: stackoverflow
[post_id]: 1441399
[parent_id]: 
[tags]: 
Can I limit the amount of rows to be used for a group in a GROUP BY statement

I'm having an odd problem I have a table with the columns product_id, sales and day Not all products have sales every day. I'd like to get the average number of sales that each product had in the last 10 days where it had sales Usually I'd get the average like this SELECT product_id, AVG(sales) FROM table GROUP BY product_id Is there a way to limit the amount of rows to be taken into consideration for each product? I'm afraid it's not possible but I wanted to check if someone has an idea Update to clarify: Product may be sold on days 1,3,5,10,15,17,20. Since I don't want to get an the average of all days but only the average of the days where the product did actually get sold doing something like SELECT product_id, AVG(sales) FROM table WHERE day > '01/01/2009' GROUP BY product_id won't work
