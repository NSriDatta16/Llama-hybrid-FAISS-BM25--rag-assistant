[site]: stackoverflow
[post_id]: 3286371
[parent_id]: 3286225
[tags]: 
Corrected: SELECT * FROM (SELECT FiscalMonthYear, 'MyCenter' = CASE EP.Center WHEN 'Livermore Call Center' THEN 'LCC' WHEN 'Natomas Call Center' THEN 'NCC' WHEN 'Concord Call Center' THEN 'CCC' WHEN 'Virtual Call Center' THEN 'VCC' WHEN 'Morgan Hill Call Center' THEN 'MHCC' ELSE Center END, ECH1.segstart, ECH1.consulttime, EP.Queue, (EP.MgrFName +' '+ EP.MgrLName)AS Manager, (EP.SupFName +' '+ EP.SupLName)AS Supervisor, (EP.RepFName +' '+ EP.RepLName)AS Agent, EP.RepPERNR, LEFT(ECH1.segstart, 19) AS SegmentDateTime, ECH1.origlogin, ECH1.dialed_num, ECH1.segment, ECH1.SegStart_Date, ECH1.callid FROM CMS_ECH.dbo.CaliforniaECH ECH1 GROUP BY ECH1.dialed_num HAVING COUNT(ECH1.callid) >= 10) ECH INNER JOIN CAPLESQL02.InfoQuest.dbo.IQ_Employee_Avaya_Id A ON ECH.origlogin = A.AvayaID AND getdate () BETWEEN StartDate AND EndDate INNER JOIN CAPLESQL02.InfoQuest.dbo.IQ_Employee_Profiles_v3 EP ON A.IQID = EP.RepID AND getdate () BETWEEN RepToSup_StartDate AND RepToSup_EndDate AND getdate () BETWEEN SupToMgr_StartDate AND SupToMgr_EndDate AND getdate () BETWEEN RepQueue_StartDate AND RepQueue_EndDate INNER JOIN Cal_RemReporting.dbo.udFiscalMonthTable f ON ECH.SegStart_Date = f.Tdate WHERE dialed_num NOT LIKE '______' AND dialed_num NOT LIKE '' AND dialed_num NOT LIKE '_______' AND EP.Center IS NOT NULL AND EP.Center NOT LIKE 'Comm Ops' AND EP.Center NOT LIKE 'Same Day Group' AND MgrLName NOT LIKE 'Hollman' AND consulttime > 0 AND ECH.SegStart_Date BETWEEN getdate()-90 AND getdate()-1 AND EP.Queue NOT IN ('BST','Collections', 'DST','DSR','Escalations','Cable Store')
