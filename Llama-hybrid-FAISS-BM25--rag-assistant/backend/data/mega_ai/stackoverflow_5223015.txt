[site]: stackoverflow
[post_id]: 5223015
[parent_id]: 4415350
[tags]: 
You can use that code to get module handle (it is faster than GetModuleHandleEx ) and then call GetModuleBaseName . HMODULE GetCallingModule( LPCVOID pCaller ) const { HMODULE hModule = NULL; MEMORY_BASIC_INFORMATION mbi; if ( VirtualQuery(pCaller, &mbi, sizeof(MEMORY_BASIC_INFORMATION)) == sizeof(MEMORY_BASIC_INFORMATION) ) { // the allocation base is the beginning of a PE file hModule = (HMODULE) mbi.AllocationBase; } return hModule; }
