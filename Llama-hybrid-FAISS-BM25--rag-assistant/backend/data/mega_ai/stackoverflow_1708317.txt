[site]: stackoverflow
[post_id]: 1708317
[parent_id]: 
[tags]: 
CertCreateCertificateContext returns ASN1 bad tag value met

I'm loading a .p7b certificate file into memory and then calling CertCreateCertificateContext on it, but it fails with the error "ASN1 bad tag value met.". The call look like this: m_hContext = CertCreateCertificateContext(X509_ASN_ENCODING | PKCS_7_ASN_ENCODING, pbCertEncoded, dwCertEncodedLen); This returns NULL and GetLastError() returns the error mentioned above. I created the certificate file by dragging a certificate out of the settings in IE, which then does an automatic export to a file. What am I doing wrong? Thanks!
