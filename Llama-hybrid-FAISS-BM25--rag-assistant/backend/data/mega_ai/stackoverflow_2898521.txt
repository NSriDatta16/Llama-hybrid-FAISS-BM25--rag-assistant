[site]: stackoverflow
[post_id]: 2898521
[parent_id]: 2898313
[tags]: 
You could try EXEC master.dbo.xp_servicecontrol 'QueryState', 'SQLSERVERAGENT' instead I used to use this back on SQL Server 2000 and it's still there in 2005 There is the possibility that SQL Agent is not running when the stored proc runs because it is dependent. Or tempdb is not ready.
