[site]: crossvalidated
[post_id]: 441108
[parent_id]: 412112
[tags]: 
I'm not an expert in this, but I think you used the wrong formula. Correct me if I'm wrong. Summary of Shanken (1992) Suppose that there are $k$ factors in the model. The number of time periods in months is $T$ . In Shanken (1992), there are two formulae to correct the covariance matrix in the two theorems. In Theorem 1 , which applies to a cross-sectional regression of average returns, the formula is $$(1+c)\Omega+\Sigma_{\bar{F}}^*$$ where $\Omega=A\Sigma A^\top$ is the asymptotic covariance matrix of $\lambda$ in the cross-sectional regression and $c=\lambda^\top\Sigma_F^{-1}\lambda$ . $\Sigma_{\bar{F}}^*$ , a $(k+1)\times (k+1)$ matrix, is the bordered version of $\Sigma_F$ by augmenting the $k\times k$ matrix $\Sigma_F$ with a column and a row of zeros corresponding to the places of the intercept. In Theorem 2 , which applies to the Fama-MacBeth procedure with fixed beta estimated from the whole sample, the formula is $$(1+c)(\hat{W}-\Sigma_{\bar{F}}^*)+\Sigma_{\bar{F}}^*$$ where $\hat{W}$ is the asymptotic covariance matrix of $\lambda$ in the second step of the Fama-MacBeth procedure, i.e. $$\hat{W}=\frac{1}{T}\sum_{t=1}^T(\lambda_t-\bar{\lambda})(\lambda_t-\bar{\lambda})^\top$$ and $c=\lambda^\top\Sigma_F^{-1}\lambda$ . If we use a rolling-window of $y$ years to estimate beta prior to the Fama-MacBeth procedure, in the footnote of the appendix, Shanken (1992) shows that we should use the following $c^*$ in place of $c$ in the previous formula: $$c^*=\left[1-\frac{(y-1)(y+1)}{3yn}\right]c$$ where $T=12n$ . To summarize, if we want to use the Shanken's (1992) correction for the cross-sectional regression, we should use the formula in Theorem 1. If we want to use the correction for the Fama-MacBeth procedure, we should use the formula in Theorem 2. Other evidence There are two clues that the above summary is correct. First, on Page 16 of the Shanken (1992) paper, the author makes an example to correct the standard error from Chen, Roll, and Ross (1986) that use the Fama-MacBeth procedure. In the formula $$(1+0.36)[(0.0318)^2-0.0561/324]+0.0561/324,$$ obviously we can see that the author uses the formula from Theorem 2. Second, in a review paper, Goyal (2012) explicitly gives the formula for Shanken's (1992) correction applied to Fama-MacBeth regression in Eq. (33): $$T\cdot\mathrm{var}_{\mathrm{EIV}}(\hat{\lambda})=(1+c)[T\cdot\mathrm{var}(\hat{\lambda})-\Sigma_F]+\Sigma_F.$$ Finally, many people refer to Cochrane (2005). Actually if you read it carefully, the formula in Eq. (12.19) on page 240 for Shanken's correction is applied to the cross-sectional regression, as in Theorem 1. On page 249 when the author talks about the Fama-MacBeth procedure, he writes If one is going to use them, it is a good idea to at least calculate the Shanken correction factors outlined above, and check that the corrections are not large. However, no formula is provided here for the Fama-MacBeth regression. So I would rather trust the formula in Goyal (2012) for this case. References: Chen, N.F., Roll, R. and Ross, S.A., 1986. Economic Forces and the Stock Market. Journal of Business, 59(3), pp.383-403. Cochrane, J.H., 2005. Asset pricing: Revised edition. Princeton university press. Goyal, A., 2012. Empirical cross-sectional asset pricing: a survey. Financial Markets and Portfolio Management, 26(1), pp.3-38. Shanken, J., 1992. On the Estimation of Beta-Pricing Models. Review of Financial Studies, 5(1), pp.1-33.
