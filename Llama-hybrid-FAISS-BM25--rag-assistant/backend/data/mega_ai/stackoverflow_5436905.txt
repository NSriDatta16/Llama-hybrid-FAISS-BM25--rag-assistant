[site]: stackoverflow
[post_id]: 5436905
[parent_id]: 
[tags]: 
SQL: Avg Per Hour, Between Times, Over Several Days

I have a table that has a START_DATE and an END_DATE column. I want to retrieve the average time difference between these timestamps for each hour, but only between the hours of 9AM to 6PM, over the course of the last few days. I'd like the output to look like this: elapsed hour ------------- 2.5 11 I believe I am quite close, but I just can't get the code to work. Here is what I have: SELECT TRUNCATE(AVG(TIME_TO_SEC(TIMEDIFF(END_DATE, START_DATE))/60), 2) as elapsed, EXTRACT(HOUR FROM END_DATE) as hour FROM TIME_INFO WHERE EXTRACT(HOUR FROM END_DATE) BETWEEN 9 AND 18 AND DATE(END_DATE) > CURDATE() - INTERVAL 3 DAY GROUP BY EXTRACT(HOUR FROM END_DATE) ORDER BY END_DATE DESC It is close, but only returns what I want from three days ago instead of across days like I'd like. I am using mySQL 5.0, anyone have any ideas?
