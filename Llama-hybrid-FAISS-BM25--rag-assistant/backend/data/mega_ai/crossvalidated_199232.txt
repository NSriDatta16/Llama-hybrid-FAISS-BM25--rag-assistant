[site]: crossvalidated
[post_id]: 199232
[parent_id]: 
[tags]: 
How do you cross validate a regression model with a variable derived from historic information

I have a logistic regression model for conversion rate after sending a customer a voucher. The dataset consists of all previous occasions where customers were sent a voucher, with the response whether they used the voucher or not. One of the predictors in the model is a recency-weighted calculation of their spend, on previous occasions where they were sent, and used a voucher, for example, $$\text{previous spend} := \sum_d \frac{1}{d} s_d,$$ where the summation is taken over days $d$ previous to today with a non zero transaction for the customer, with $s_d$ equal to how much was spent on that day while using a voucher. As an example, if a customer had 3 previous transactions, at weekly intervals before today, for $1 each, their previous spend is calculated as: $$\frac{1}{7} + \frac{1}{14} + \frac{1}{21}$$ I am unsure whether I have done the recency weighting correctly, in the sense that while this variable is significant in the regression, I am unsure whether it will remain so on new data. Thus I would like to use cross validation on my model. I am unsure how to calculate this variable in this case, should I: Pre-calculate the values for $\text{previous spend}$, and calculate model parameters and fit via usual cross validation. Re-calculate the values for $\text{previous spend}$ on the train and test set for each cross validation fold, before model fitting and evaluation via usual cross validation. Some how include the historic averaging as a model parameter, so that it can be cross validated directly. Please throw some light on the advantages/disadvantages of the methods listed above, or any other you think is suitable.
