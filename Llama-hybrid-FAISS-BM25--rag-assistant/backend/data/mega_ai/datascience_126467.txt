[site]: datascience
[post_id]: 126467
[parent_id]: 
[tags]: 
Need Expert Advice for using sklearn pipeline to create a composite estimator with multiple models & features. Column Transformer with Mixed Types

I am trying to use sklearn pipeline to create a composite estimator. Please check attached image for model blueprint. Can anyone help me understand how this can be done in python. Column Transformer with Mixed Types Dataset has only 3 columns including target. [featur_1: categorical, feature_2: text, target] Code (that didn't work!!) import pandas as pd from sklearn.compose import ColumnTransformer from sklearn.pipeline import FeatureUnion from sklearn.feature_extraction.text import TfidfVectorizer from sklearn.preprocessing import OrdinalEncoder from sklearn.linear_model import SGDClassifier from lightgbm import LGBMClassifier from sklearn.model_selection import train_test_split from sklearn.metrics import accuracy_score from sklearn.pipeline import Pipeline # Split the data into train and test sets X_train, X_test, y_train, y_test = train_test_split(df['description'], df['reject'], test_size=0.2, random_state=42) # Separate transformers for text and categorical data text_transformer = TfidfVectorizer() categorical_transformer = OrdinalEncoder() # Create a FeatureUnion for combining the outputs of different transformers combined_features = FeatureUnion([ ('text', text_transformer, 'description'), ('categorical', categorical_transformer, [['reject']]) ]) # Create an instance of the SGDClassifier sgd_classifier = SGDClassifier() # Create a pipeline for the model model_pipeline = Pipeline([ ('features', combined_features), ('sgd', sgd_classifier), # Stochastic Gradient Descent Classifier ('lgbm', LGBMClassifier()) # LightGBM Classifier ]) # Fit the pipeline on the training data model_pipeline.fit(X_train, y_train) # Predict on the test data predictions = model_pipeline.predict(X_test) # Evaluate the accuracy accuracy = accuracy_score(y_test, predictions) print(f'Accuracy: {accuracy}') Error: "name": "TypeError", "message": "All intermediate steps should be transformers and implement fit and transform or be the string 'passthrough' 'SGDClassifier()' (type ) doesn't",
