[site]: stackoverflow
[post_id]: 4136169
[parent_id]: 
[tags]: 
Multiple xmlhttprequest on a page

I am having an error when using new XMLHttpRequest() for the second time in JavaScript code called from textbox event on page. My JavaScript finds suggestions for text entry from the SQL to do that I use xmlhttprequest , it does fine when it is the first time but when I keep typing in the text box I receive: "typeerror: xmlhttprequest not a costructor" (this error happens only in Firefox) This is my code: function fnNull() { }; function changeofstate(){ if (XMLHttpRequest.readyState == 4) { whatever ; } XMLHttpRequest.onreadystatechange = fnNull(); } function whentextchange(){ var WebURL = "the url here "; XMLHttpRequest = CreateXmlHttpObject(changeOfState); XMLHttpRequest.open("GET", WebURL, true); XMLHttpRequest.send(null); XMLHttpRequestt.abort(); } } function CreateXmlHttpObject(handler) { var objXmlHttpReq = null; var Req = null; if (navigator.userAgent.indexOf("Opera")>=0) { return ; } if (navigator.userAgent.indexOf("MSIE")>=0) { var strName="Msxml2.XMLHTTP"; if (navigator.appVersion.indexOf("MSIE 5.5")>=0) { strName="Microsoft.XMLHTTP"; } try { objXmlHttpReq=new ActiveXObject(strName); objXmlHttpReq.onreadystatechange = handler; return objXmlHttpReq; } catch(e) { return ; } } if (navigator.userAgent.indexOf("Mozilla") >= 0) { try { if (Req == null) { Req = new XMLHttpRequest(); } Req.onload = handler; Req.onerror = handler; return Req; } catch (e) { alert(e); alert(Req.responseText) alert(e); return; } } }
