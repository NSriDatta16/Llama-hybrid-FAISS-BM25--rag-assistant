[site]: stackoverflow
[post_id]: 694641
[parent_id]: 286871
[tags]: 
By judicious use of another tool freely available on Windows, the following two scripts do the job you want. First, GetPwd.cmd: @echo off :: GetPwd.cmd - Get password with no echo. Then, GetPwd.vbs: ' GetPwd.vbs - Get password with no echo then echo it. ' Set oScriptPW = CreateObject("ScriptPW.Password") strPassword = oScriptPW.GetPassword() Wscript.StdOut.WriteLine strPassword Explanation: GetPwd.vbs simply uses the password object to input the password from the user and then print it to standard output (next paragraph will explain why that doesn't show up in the terminal). GetPwd.cmd is a bit trickier (but command scripts usually are). The " command simply outputs the prompt with no trailing CR/LF - it's a sneaky way to emulate bash's "echo -n" . It sets passwd to an empty string as a side effect and doesn't wait for input since it's taking its input from the nul: device. The "for /f "delims=" %%i in ('cscript /nologo GetPwd.vbs') do set passwd=%%i" statement is the trickiest bit. It runs the vbscript with no Microsoft advertising ( /nologo ), so that the only line output is the password (from the vbscript "Wscript.StdOut.WriteLine strPassword" . Setting the delimiters to nothing is required to capture input lines with spaces, otherwise you just get the first word. The "for ... do set ..." sets passwd to be the actual password output from the vbscript. Then we echo a blank line (actually terminate the "Password: " line) and echo the password so you can verify it works: C:\Pax> GetPwd Password: this is my password C:\Pax> The scriptpw.dll is available with XP and 2K3 but not necessarily later versions. Instructions for Vista and presumably Win7 are below, give them a try: To mask the password, the script takes advantage of the ScriptPW COM object. ScriptPW is loaded by default on Windows XP and Windows 2003. If you’re running Windows 2000 or Windows Vista, you will need to copy the scriptpw.dll file from the Windows\System32 folder of an XP system, or Windows 2003 system to the Winnt\System32 or Windows\System32 folder on your Windows 2000 or Vista system. Once the DLL has been copied, you will need to register it by running the command: regsvr32 scriptpw.dll To successfully register the DLL on a Vista machine, you will need to open the command prompt as administrator. To do this, click Start | All Programs | Accessories. Then right-click on the Command Prompt shortcut and select “Run as administrator.” Once at the command prompt as administrator, you’ll be able to successfully run the regsvr32 scriptpw.dll command to register the DLL.
