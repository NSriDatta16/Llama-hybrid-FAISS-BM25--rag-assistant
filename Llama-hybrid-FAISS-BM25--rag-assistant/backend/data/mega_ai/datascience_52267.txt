[site]: datascience
[post_id]: 52267
[parent_id]: 
[tags]: 
CGAN - Shape must be rank 2 error

I'm trying to create a conditional GAN with the following code: learning_rate = 0.0002 batch_size = 128 epochs = 10000 image_dim = 784 #28 * 28 Y_dimension = 10 gen_hidd_dim = 256 disc_hidd_dim = 256 z_noise_dim =100 #input noise datapoint def xavier_init(shape): return tf.random_normal(shape = shape, stddev = 1/tf.sqrt(shape[0]/2.0)) weights = { 'disc_H' : tf.Variable(xavier_init([image_dim + Y_dimension, disc_hidd_dim])), 'disc_final' : tf.Variable(xavier_init([disc_hidd_dim, 1])), 'gen_H': tf.Variable([z_noise_dim + Y_dimension, gen_hidd_dim]), 'gen_final': tf.Variable(xavier_init([gen_hidd_dim, image_dim])) } bias = { 'disc_H': tf.Variable(xavier_init([disc_hidd_dim])), 'disc_final': tf.Variable(xavier_init([1])), 'gen_H': tf.Variable(xavier_init([gen_hidd_dim])), 'gen_final': tf.Variable(xavier_init([image_dim])) } Z_input = tf.placeholder(tf.float32, shape= [None, z_noise_dim ], name = 'input_noise') Y_input = tf.placeholder(tf.float32, shape= [None, Y_dimension], name='Labels') X_input = tf.placeholder(tf.float32, shape=[None, image_dim], name = 'real_input') def Discriminator(x,y): inputs = tf.concat(axis = 1, values = [x,y]) hidden_layer = tf.nn.relu(tf.add(tf.matmul(inputs, weights['disc_H']), bias['disc_H'])) final_layer = tf.add(tf.matmul(hidden_layer, weights['disc_final']), bias['disc_final']) disc_output = tf.nn.sigmoid(final_layer) return final_layer, disc_output def Generator(x,y): inputs = tf.concat(axis=1, values=[x,y]) hidden_layer = tf.nn.relu(tf.add(tf.matmul(tf.cast(inputs, tf.float32), tf.cast(weights['gen_H'], tf.float32)), tf.cast(bias['gen_H'],tf.float32))) final_layer = tf.add(tf.matmul(hidden_layer, weights['gen_final']), bias['gen_final']) gen_output = tf.nn.sigmoid(final_layer) return gen_output output_Gen = Generator(Z_input, Y_input) Right after executing the Generator i get the following error: ValueError: Shape must be rank 2 but is rank 1 for 'MatMul_25' (op: 'MatMul') with input shapes: [?,110], [2]. What to do?
