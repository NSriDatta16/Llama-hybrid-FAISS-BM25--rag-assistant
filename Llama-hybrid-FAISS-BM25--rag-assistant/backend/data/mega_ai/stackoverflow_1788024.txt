[site]: stackoverflow
[post_id]: 1788024
[parent_id]: 1785320
[tags]: 
Assuming your source table looks something like this: dfm head(dfm) ID1 ID2 value 1 ID1a ID2a 6459695 2 ID1b ID2a 7263529 3 ID1c ID2a 7740364 4 ID1a ID2b 885473 5 ID1b ID2b 1411355 6 ID1c ID2b 1253524 Using ddply first to calculate the percentages, and cast to present the data in the required format library(reshape) library(plyr) df1 Compared to your example, this is missing the row totals, these need to be added separately. Not sure though, whether this solution is more elegant than the one you currently have.
