[site]: crossvalidated
[post_id]: 315874
[parent_id]: 296059
[tags]: 
If the estimated effective sample size is larger than the number of samples, this likely means that there is negative estimated autocorrelation in your samples. If you run an acf on your samples, you will most certainly find negative correlation. Remember that "effective sample size" is used as a way to compare variance of estimators obtained via correlated sampling to if independent samples had been obtained. Thus, if there is negative correlation in the samples, the variance of the estimator from correlated samples can be smaller than the variance of the estimator from independent samples. This in turn leads to larger effective sample size. For theoretical detail, consider $X_1, X_2, \dots, X_n$ being samples from a distribution with mean $\mu$ and variance $\lambda^2$. Consider estimating $\mu$ with the sample mean. If $X_i$ are independent, then variance of the sample mean $\lambda^2/n$. If $X_i$ are correlated (say in MCMC), then (large sample) variance of the sample mean (using a CLT argument) is $\sigma^2/n$ where $$\sigma^2 = \lambda^2 + 2\sum_{k=1}^{\infty}\text{Cov}(X_1, X_{1+k}) \,. $$ Effective sample size is defined as $$ESS = n \dfrac{\lambda^2}{\sigma^2} \,.$$ Usually in MCMC, the samples are positive correlation, which means $\sigma^2 > \lambda^2$, but if the samples are negatively correlated, then $\sigma^2 The fact that using ess from mcmcse leads to an even higher ESS is not necessarily "worse". It is just giving you a better estimate of the ESS, since it estimates $\sigma^2$ directly. coda approximates $\sigma^2$ by fitting an ar1 process to the MCMC samples.
