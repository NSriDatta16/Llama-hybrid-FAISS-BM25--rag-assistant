[site]: stackoverflow
[post_id]: 3671587
[parent_id]: 3671195
[tags]: 
If you have SQL Server 2008, you can use a table variable as an input variable for a stored proc, that is how you handle your array. Look up how to do this in Books Online. As far as the looping and IF, I suggest you try to use set-based processing instead as it is significantly faster. For ideas on set-based logic that may do what you want to do: http://wiki.lessthandot.com/index.php/Cursors_and_How_to_Avoid_Them You might especially pay attention to the examples using the CASE Statement
