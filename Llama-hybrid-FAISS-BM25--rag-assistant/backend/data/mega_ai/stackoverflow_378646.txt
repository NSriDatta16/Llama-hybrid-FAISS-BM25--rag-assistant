[site]: stackoverflow
[post_id]: 378646
[parent_id]: 378608
[tags]: 
Assuming that your hierarchy is always exactly 3 levels deep: SELECT DISTINCT O.organization_id, O.organization_name FROM Categories CAT INNER JOIN Categories SUB ON SUB.parent_id = CAT.category_id INNER JOIN Category_Organizations CO ON CO.category_id = SUB.category_id INNER JOIN Organizations O ON O.organization_id = CO.organization_id WHERE CAT.category_id = @category_id You can modify that by one level to allow you to pass a sub category id. If you don't know at the time whether or not you have a category id or a sub category id then you can do the following: SELECT DISTINCT O.organization_id, O.organization_name FROM Categories CAT LEFT OUTER JOIN Categories SUB ON SUB.parent_id = CAT.category_id INNER JOIN Category_Organizations CO ON CO.category_id IN (CAT.category_id, SUB.category_id) INNER JOIN Organizations O ON O.organization_id = CO.organization_id WHERE CAT.category_id = @category_id If your hierarchy may have an unknown number of levels (or you think it might in the future) then check out Joe Celko's Trees and Hierarchies in SQL for Smarties for alternative ways to model a hierarchy. It's probably a good idea to do that anyway.
