[site]: stackoverflow
[post_id]: 31517
[parent_id]: 31366
[tags]: 
Given the XPath functions that you're calling which I don't remember having the luxury of in my MSXSL work, it looks like you're using an XPath 2-compatible processor. If that's the case, doesn't XPath 2 have a replace(string, pattern, replacement) function that takes a regex as a second parameter? It might help to have some sample Xml input and to know what processor you plan to use. From your original example, it seems that the duplicate paragraphs all have a white-space only prefix. So something like this slight modification might trim the dupes.
