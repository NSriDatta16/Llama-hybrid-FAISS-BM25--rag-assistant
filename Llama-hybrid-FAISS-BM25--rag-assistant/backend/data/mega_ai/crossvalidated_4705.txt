[site]: crossvalidated
[post_id]: 4705
[parent_id]: 4694
[tags]: 
About your first question, it seems that the mcquitty option corresponds to WPGMA clustering, while average is for UPGMA. It is just by looking at the source code , so it is worth to double check it. But it also referred as is in the upgma() function from the phangorn package. About your second question, I think you just have to subset your genes by the group labels found after cutree , and then plot expression profiles as usual.
