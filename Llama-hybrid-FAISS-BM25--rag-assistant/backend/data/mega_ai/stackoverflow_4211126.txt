[site]: stackoverflow
[post_id]: 4211126
[parent_id]: 4211114
[tags]: 
The horror with switch is Duff's device (a creatively unrolled loop, but otherwise it just copies source to destination). tworegisterswap swaps the values pointed to by x and y using bitwise XOR. bigintegeraverage is a sneaky way to get the average of two integers in a potentially non-portable manner but without the possibility of overflow. (See Aggregate Magic Algorithms for details.)
