[site]: crossvalidated
[post_id]: 445004
[parent_id]: 
[tags]: 
Bayesian structure learning: how to identify z as a collider in x-z-y structure?

In BNSL(Bayesian Network Structure Learning) problem, we are asked to learn a DAG(Directed Acyclic Graph) over a randon variable set $U$ , given samples of the underlying distribution of $U$ . The traditional constraint-based method, such as SGS algorithms[1] and PC algorithms[2], first find a skeleton(an undirected graph $G$ ) for all variables by IT(independence test). Then for any induced subgraph like $x-z-y$ ( $x$ and $y$ are not adjacent in $G$ ), they again use IT to decide whether the middle node $z$ is a collider or not. Specifically, $z$ is decided as a collider if $x$ and $y$ are dependent given every subset of $U-\{x,y\}$ containing $z$ . This is obviously true if $z$ is a collider in the underlying DAG. But do we have to test the independence of $x$ and $y$ for all subsets of $U-\{x,y\}$ containing $z$ ? Why can't we just test the independent given $z$ ? Since the other three structures(two chains and one fork) would suggest independence between $x$ and $y$ given $z$ and the collider structure is the only possible structure that would lead to a dependence result. Can anyone explain the necessity of checking the independence of $x$ and $y$ conditioning on every subset of $U-\{x,y\}$ containing $z$ ? Thanks in advance! update(1) : "the other three structures" refers to $x\rightarrow z\rightarrow y$ , $x\leftarrow z\leftarrow y$ and $x\leftarrow z\rightarrow y$ . My reasoning is as follows: If the underlying structure for $x-z-y$ is any of these three, then $x\perp\!\!\!\perp y\:|\:z$ . Otherwise, the underlying structure for $x-z-y$ must be $x\rightarrow y\leftarrow z$ , which implies $x\perp\!\!\!\perp\!\!\!\!\!\!/ \:\:\:y\:|\:z$ . So if IT tells us that $x\perp\!\!\!\perp\!\!\!\!\!\!/ \:\:\:y\:|\:z$ , the other three structure can be ruled out and thus we immediately conclude that $x\rightarrow y\leftarrow z$ without testing the independence of $x$ and $y$ conditioning on other sets in $U\setminus \{x,y\}\cup\{z\}$ . [1] Spirtes, Peter, Clark N Glymour, and Richard Scheines. "Causality from Probability." Vol. 112. Carnegie-Mellon University, Laboratory for Computational Linguistics, 1989. [2] Spirtes, Peter, and Clark Glymour. “An Algorithm for Fast Recovery of Sparse Causal Graphs.” Social Science Computer Review 9, no. 1 (April 1, 1991): 62–72. https://doi.org/10.1177/089443939100900106 .
