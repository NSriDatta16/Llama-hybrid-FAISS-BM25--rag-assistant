[site]: stackoverflow
[post_id]: 969520
[parent_id]: 908629
[tags]: 
Just stumbled upon your post. I'm not sure if It was a FormatException, but I got a Exception with a databound DateTimePicker, too. The problem is that DateTimePicker.MinimumDateTime = #1/1/1753# while DateTime.MinValue = #1/1/0001# New DateTime = #1/1#0001# So if bind a property to a DataGridView that returns a DateTime value earlier than #1/1/1753# or later then #12/31/9998# ( DateTimePicker.MaximumDateTime ) you get an exception. I solved this with my own inherited DateTimePicker (sorry, but it's written in vb) To use it you can just bind your Subsonic object to the value property. But you have to set the ShowCheckBox property to true and bind a bool value to the CheckedValue property (to indicate that the date is set) which is persisted in your db, too. Now If an empty date is returned, the date is set to Now and the checkedValue to false, leading to a disabled DateTimePicker. If you check the Checkbox or choose a date with the calender) the checkbox is set to true and the Checkbox is checked. Attention: Do not bind the Checked property directly, bind the CheckedValue property. Imports System.ComponentModel Public Class MyDateTimePicker Inherits System.Windows.Forms.DateTimePicker _ Public Overloads Property Value() As DateTime Get If Not MyBase.Checked And (MyBase.Value DateTimePicker.MaximumDateTime) Then Return DateTime.Now Else Return MyBase.Value End If End Get Set(ByVal value As DateTime) If ((value DateTimePicker.MaximumDateTime) Or value = #1/1/1900#) Then MyBase.Value = DateTime.Now MyBase.Checked = False Else MyBase.Value = value End If End Set End Property Private _CheckedValue As Boolean _ Public Property CheckedValue() As Boolean Get Return _CheckedValue End Get Set(ByVal value As Boolean) _CheckedValue = value End Set End Property Protected Overrides Sub OnMouseUp(ByVal e As System.Windows.Forms.MouseEventArgs) MyBase.OnMouseUp(e) RefreshCheckedValue() End Sub Protected Overrides Sub OnKeyUp(ByVal e As System.Windows.Forms.KeyEventArgs) MyBase.OnKeyDown(e) RefreshCheckedValue() End Sub Private Sub RefreshCheckedValue() CheckedValue = Me.Checked If Not Me.DataBindings("CheckedValue") Is Nothing Then Me.DataBindings("CheckedValue").WriteValue() End If End Sub Protected Overrides Sub OnBindingContextChanged(ByVal e As System.EventArgs) MyBase.OnBindingContextChanged(e) Static checkedInitialized As Boolean If Not checkedInitialized AndAlso Not Me.DataBindings("CheckedValue") Is Nothing Then Me.Checked = Me.CheckedValue checkedInitialized = True End If End Sub End Class
