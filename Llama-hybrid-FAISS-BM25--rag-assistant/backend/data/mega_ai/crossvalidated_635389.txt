[site]: crossvalidated
[post_id]: 635389
[parent_id]: 635275
[tags]: 
Very long question, but I'll take a crack at it. The material in the relevant section of the GLMM FAQ is still reasonably accurate, as far as I know (feedback welcome!) nlme::lme : this package uses a "within-between" or parameter-counting approach, which is adequate for simpler model structures (single-term or nested models), but which gets progressively less applicable/harder for random-slopes models (see comments in the GLMM FAQ), crossed random effects, unbalanced designs, or more complex random effect structures where the random effects themselves are no longer iid lme4::lmer : in response to Doug Bates's comment (from the quote above) that If anyone wants to contribute code to calculate the "obviously correct" denominator degrees of freedom from SAS I will incorporate it this did happen with the implementation of the pbkrtest package ( pbkr = "Parametric bootstrap/Kenward-Roger") — although it was never "incorporated" directly in lme4 as suggested ... This implementation is used in most downstream packages, including in particular lmerTest (which wraps lme4::lmer so that it automatically provides denominator df in output), as well as (e.g.) emmeans and other packages for computing model summaries. lmerTest also provides a Satterthwaite approximation (which is inherited by emmeans as well). glmmTMB provides only "infinite" ddf summaries (i.e. based on $\chi^2$ / $Z$ statistics rather than $F$ / $t$ ); discussion here and here eventually led to the development of the mmrm package The mmrm package provides within-between, Satterthwaite, and K-R ddfs for one particular class of LMMs (the authors implemented Satterthwaite and K-R from scratch: their notes are very thorough and might (?) be used as a starting point for implementing these procedures in glmmTMB , although these particular implementations rely on the fact that mmrm is fitting a special case/special class of LMMs) GLMMadaptive::mixed_model() does only (non-Gaussian) GLMMs; the theory for finite-size corrections is relatively poorly developed for GLMMs, most GLM(M) frameworks don't consider finite-size corrections (see comments in the GLMM FAQ) as far as I can see MixedModels.jl hasn't implemented finite-size corrections: see this issue A few other notes: one strike against Kenward-Roger is that in the general case it requires inverting an $n \times n$ matrix (where $n$ is the number of observations), making it impractical for large problems along with the finite-ddf problem, one should also consider the possible non-Normality of the confidence intervals (suggesting a profile CI rather than Wald CIs), and the dependence of the CIs on the uncertainty in the random effect variance estimates (suggesting profile CI or parametric bootstrap); these are problems that are not addressed by the various methods described here. One can also do some form of Markov chain Monte Carlo as suggested by Doug Bates (see e.g. MCMCglmm , rstanarm , brms packages); the big drawback here is that sampling with 'flat' priors that mimic the frequentist setup of the problem is going to lead to computational problems in exactly the same circumstances where we are interested in/concerned with finite-size corrections ... (one of the reasons Doug abandoned the mcmcsamp approach is that it can get in trouble when it approaches the boundaries of the space of positive-definite matrices) Li, Peng, and David T. Redden. 2015. “Comparing Denominator Degrees of Freedom Approximations for the Generalized Linear Mixed Model in Analyzing Binary Outcome in Small Sample Cluster-Randomized Trials.” BMC Medical Research Methodology 15 (April): 38. https://doi.org/10.1186/s12874-015-0026-x . Schaalje, G., J. McBride, and G. Fellingham. 2002. “Adequacy of Approximations to Distributions of Test Statistics in Complex Mixed Linear Models.” Journal of Agricultural, Biological & Environmental Statistics 7 (14): 512–24. Stroup, W. W. 2013. “Non-Normal Data in Agricultural Experiments.” In . Kansas State University. http://newprairiepress.org/agstatconference/2013/proceedings/8 .
