[site]: crossvalidated
[post_id]: 242172
[parent_id]: 241872
[tags]: 
I think you're on to something, but you need some more knowledge of the FFT properties to refine your approach. First of all, let's read in your data: y Now, before computing the FFT, you should subtract the linear trend from your data . The reason is that only the variation around a decreasing linear trend seems to be approximately sinusoidal. the FFT is just a fast algorithm for the DFT, and the DFT treats the input values as if they were one cycle of a periodic function. If you don't subtract the linear trend, then you will be reconstructing a function which, after a shift equal to L , goes back to its initial value in x[1] . This would be totally at odds with a function whose average keeps decreasing with x , which seems to be the case for your data. Let's subtract the linear trend and compute the FFT: trend There! See? Looking much better now. After subtracting the linear trend, it looks like only the first 5 harmonics are important. The rest of the harmonics have comparatively less energy, and could be due to the noise which corrupts your data. Since the fundamental frequency is omega this means that we can fit a model with frequencies $\omega,2\omega\dots,5\omega$, and of course the linear trend we subtracted before. Thus we get: model Let's have a look at the results: > summary(model) Call: lm(formula = y ~ x + sin(omega * x) + cos(omega * x) + sin(2 * omega * x) + cos(2 * omega * x) + sin(3 * omega * x) + cos(3 * omega * x) + sin(4 * omega * x) + cos(4 * omega * x) + sin(5 * omega * x) + cos(5 * omega * x), data = someData) Residuals: Min 1Q Median 3Q Max -258.424 -64.063 8.794 73.853 254.689 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 86493.6198 49.1226 1760.771 Not bad! Most terms are extremely significant, and the adjusted $R^2$ is 0.95 with 119 residual degrees of freedom. It doesn't make sense to remove the non-significant terms: it would be "fishing for significance". Instead, let's have a look at the plot: x Everything looks fine, but...the trigonometric polynomial part of the model is of course periodic, while your detrended data seem to show some sort of decay (exponential?). We can see this better if we model, and plot, only the detrended data: detrended_model You see clearly that the part of your model which represents the variation around the linear trend is periodic. Thus, after a shift in x equal to L , it will become "large" again, instead than to keep decaying. Thus this model is probably not suited for extrapolation. EDIT : the reason why both sine and cosine terms are fitted is due to the use of complex exponential in the expression of Fourier series, and Euler's formula which gives the relationship between complex exponentials and trigonometric functions. However, a simpler argument can be given, which is basically equivalent but avoids the recourse to complex analysis. Once we have seen from the FFT that most of the energy of the detrended data seems to be concentrated at the first 5 multiples of the fundamental frequency, we can think to fit the original data with the sum of a linear polynomial and a sum of sines (or cosines), where both the amplitude and the phase are unknown: $$y = \beta_0 + \beta_1 x + \sum_{i=1}^5 M_i \sin{(i\omega x+\phi_i)} + \epsilon$$ The problem in estimating such a model is that it's nonlinear in the parameters $\phi_i$ (the phases). However, since $$\sin{(i\omega x + \phi_i)}=\sin{i\omega x}\cos{\phi_i}+\cos{i\omega x}\sin{\phi_i}=A_i\sin{i\omega x}+B_i\cos{i\omega x}$$ we can reparametrize our model as the following linear model: $$y = \beta_0 + \beta_1 x + \sum_{i=1}^5 (C_i \sin{(i\omega x)}+D_i \cos{(i\omega x)}) + \epsilon$$ Since the model is linear, we can now estimate its parameters with lm .
