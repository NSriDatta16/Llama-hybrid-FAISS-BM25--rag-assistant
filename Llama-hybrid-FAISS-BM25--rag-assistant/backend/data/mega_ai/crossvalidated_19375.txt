[site]: crossvalidated
[post_id]: 19375
[parent_id]: 
[tags]: 
Detecting a peak in an averaged profile

I have a very long time series (about a gigabyte in ascii format) that looks like this: 1, 0.5 2, 0.52 3, 0.3 . . . The points occur at integer time points and are predominantly 1 second apart. A small proportion are missing. The series is known to peak when a certain phenomena occurs. However, there is some underlying noise which makes it difficult to distinguish real peaks from random noise. I have an algorithm which has produced about 500 points where peaks may occur. I extracted a profile of 101 points, 50 before the position of the peak position and 50 after, to see what was happening around each predicted peak position. Inspecting by eye, a lot of the profiles didn't look very much like peaks. (I think this is because there is a lot of noise in the series.) I decided to average all the profiles together. The result is a new series where the first point is the average of all points -50 time steps away from my center point and the last point is the average of all points +50 time steps away from my central point. My hope was to see a peak close to the center point of the average profile which I did, approximately +2 time steps from the center point. I take this +2 number as a measure of accuracy of the peak locating algorithm. (If it turns out some of the points in a profile are missing, which happens rarely, I just add the ones that are and ignore the missing values, so some positions in the average profile are derived from slightly more points than others.) The average profile has a classic peak shape with the values slowly rising to a peak, as one moves from left to right, about 2 positions after the center point and declining again. If I pick 500 positions randomly, I get a relatively flat line which I interpret as almost constant. So, I think the peak locating algorithm actually does have some ability to recognizing when the series is peaking. I want a statistical test to tell me when I should judge the average profile as flat and when I should just it as a peak. Can someone please help?
