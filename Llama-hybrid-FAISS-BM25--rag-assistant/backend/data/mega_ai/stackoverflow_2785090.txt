[site]: stackoverflow
[post_id]: 2785090
[parent_id]: 
[tags]: 
Why does this code fail in D2010, but not D7?

Why does this code get an access error on the Result := Buffer line in D2010, but not D7? Something, I'd guess, involving UniCode, but the compiler doesn't generate any warnings. Any suggestions on an elegant workaround? Edit: Ouch: the GetTempPath call is trashing the stack as evidenced by the fact that Extension is empty after the GetTempPath line, but not before... Yikes. function GetTempPathAndFileName( const Extension: string): string; var Buffer: array[0..MAX_PATH] of Char; begin repeat GetTempPath(SizeOf(Buffer) - 1, Buffer); GetTempFileName(Buffer, '~', 0, Buffer); Result := Buffer; //
