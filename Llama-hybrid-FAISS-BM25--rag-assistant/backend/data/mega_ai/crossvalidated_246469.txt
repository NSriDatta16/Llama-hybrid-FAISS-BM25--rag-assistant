[site]: crossvalidated
[post_id]: 246469
[parent_id]: 246084
[tags]: 
This is an edited version of Example 2.1 in Bayesian Essentials with R . When comparing two id normal samples, $$(x_1,\ldots,x_n)\ \text{and }\ (y_1,\ldots, y_n)$$ with respective distributions $\mathscr{N}(\mu_x,\sigma^2)$ and $\mathscr{N}(\mu_y,\sigma^2)$, assume the question is whether or not both means are identical, i.e. $$\mathbf{H_0}:\ \mu_x=\mu_y$$ Further, assume that $\sigma^2$ has a similar meaning under both models and that the same prior $\pi_\sigma(\sigma^2)$ is used under both models. This means that the Bayes factor $$ B^\pi_{21}(\mathscr{D}_n) = \frac{\int\,\ell_2(\mu_x,\mu_y,\sigma|\mathscr{D}_n) \pi(\mu_x,\mu_y)\pi_\sigma(\sigma^2)\,\mathrm{d}\sigma^2\,\mathrm{d}\mu_x\,\mathrm{d}\mu_y} {\int\,\ell_1(\mu,\sigma|\mathscr{D}_n) \pi_\mu(\mu)\pi_\sigma(\sigma^2)\,\mathrm{d}\sigma^2\,\mathrm{d}\mu} $$ does not depend on the normalizing constant of $\pi_\sigma(\sigma^2)$ and thus that we can use an improper prior such as $\pi_\sigma(\sigma^2)=1/\sigma^2$. Furthermore, we can rewrite $\mu_x$ and $\mu_y$ as $$\mu_x=\mu-\xi\ \text{and} \ \mu_y=\mu+\xi$$ respectively, with $\mu$ being a global location parameter, hence a nuisance parameter appearing in both models. Introducing a prior of the form $\pi(\mu,\xi)=\pi_\mu(\mu)\pi_\xi(\xi)$ on the new parameterization, the same prior $\pi_\mu$ can be used underboth models. Once again, an improper Jeffreys prior $\pi_\mu(\mu)=1$ can be used. However, we do need a proper and well-defined prior on $\xi$, for instance $$\xi\sim\mathscr{N}(0,\tau^2)$$ which leads to \begin{align*} B^\pi_{21}(\mathscr{D}_n) &= \dfrac{\int\, e^{-n\left[(\mu-\xi-\bar x)^2+(\mu+\xi-\bar y)^2+s_{xy}^2\right]/2\sigma^2}\, \sigma^{-2n-2} e^{-\xi^2/2\tau^2}/\tau\sqrt{2\pi}\,\mathrm{d}\sigma^2\,\mathrm{d}\mu\,\mathrm{d}\xi} {\int\,e^{-n \left[(\mu-\bar x)^2+(\mu-\bar y)^2+s_{xy}^2\right]/2\sigma^2}\, \sigma^{-2n-2} \,\mathrm{d}\sigma^2\,\mathrm{d}\mu}\\ %&= \dfrac{2^{2(n+1)/2}}{2^n}\times\\ & = \dfrac{\int\,\left[(\mu-\xi-\bar x)^2+(\mu+\xi-\bar y)^2+s_{xy}^2\right]^{-n} e^{-\xi^2/2\tau^2}/\tau\sqrt{2\pi}\,\mathrm{d}\mu\,\mathrm{d}\xi} {\int\,\left[(\mu-\bar x)^2+(\mu-\bar y)^2+s_{xy}^2\right]^{-n}\,\mathrm{d}\mu}\,, \end{align*} where $s_{xy}^2$ denotes the average $$ s_{xy}^2 = \frac{1}{n}\,\sum_{i=1}^n\,(x_i-\bar x)^2 + \frac{1}{n}\,\sum_{i=1}^n\,(y_i-\bar y)^2 \,. $$ End of the reproduction. One new item in the OP's question is to avoid reparameterisation, which is easily done by getting back from $(\eta,\xi)$ to $(\mu_x,\mu_y)$ by the change-of-variable lemma. ( Hint: the Jacobian is constant.)
