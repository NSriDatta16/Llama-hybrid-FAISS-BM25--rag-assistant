[site]: stackoverflow
[post_id]: 5232922
[parent_id]: 
[tags]: 
Directory Services 400,000 users query export

I wrote an application that will export all the users from the Active Directory and write them to a database. the problem is that on an Active Directory with 20,000 Users this method below works just fine, but on Active Directory with 400,000 it gets stuck until it crushes. I have defined the PageSize but it doesn't help. how can I solve this issue? public List GetAllUsers() { List AllUsers = new Lists (); DirectoryEntry deDomain = new DirectoryEntry("LDAP//xxxxx.xxxx,username,password); DirectorySearcher dsSercher = new DirectorySearcher(deDomain); dsSearcher.filter = "(objectclass=user)"; dsSearcher.PropertiesToLoad.Add("cn"); dsSearcher.PropertiesToLoad.Add("objectclass"); dsSearcher.PageSize = 1000; SearchResultCollection srcResults = dsSearcher.FindAll(); foreach (SearchResult currResult in srcResults) { if (currResult.Properties["objectclass"].Count == 4 && currResult.Properties["objectclass"][0].ToString() == "top" && currResult.Properties["objectclass"][0].ToString() == "person" && currResult.Properties["objectclass"][0].ToString() == "organizationalPerson" && currResult.Properties["objectclass"][0].ToString() == "user") { AllUsers.Add(currResult.Properties["cn"][0].ToString()); } } return (AllUsers); } Thanks.
