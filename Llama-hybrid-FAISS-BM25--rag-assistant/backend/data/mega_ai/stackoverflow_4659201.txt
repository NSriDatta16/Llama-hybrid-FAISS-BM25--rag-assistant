[site]: stackoverflow
[post_id]: 4659201
[parent_id]: 
[tags]: 
Regex for multiple lines checking

I'm trying out regex ( import re ) to extract the info I want from a log file. UPDATE: Added the C:\WINDOWS\security folder permissions which broke all of the sample codes. Say the format of the log is: C:\: BUILTIN\Administrators Allowed: Full Control NT AUTHORITY\SYSTEM Allowed: Full Control BUILTIN\Users Allowed: Read & Execute BUILTIN\Users Allowed: Special Permissions: Create Folders BUILTIN\Users Allowed: Special Permissions: Create Files \Everyone Allowed: Read & Execute (No auditing) C:\WINDOWS\system32: BUILTIN\Users Allowed: Read & Execute BUILTIN\Power Users Allowed: Modify BUILTIN\Power Users Allowed: Special Permissions: Delete BUILTIN\Administrators Allowed: Full Control NT AUTHORITY\SYSTEM Allowed: Full Control (No auditing) C:\WINDOWS\system32\config: BUILTIN\Users Allowed: Read & Execute BUILTIN\Power Users Allowed: Read & Execute BUILTIN\Administrators Allowed: Full Control NT AUTHORITY\SYSTEM Allowed: Full Control (No auditing) C:\WINDOWS\security: BUILTIN\Users Allowed: Special Permissions: Traverse Folder Read Attributes Read Permissions BUILTIN\Power Users Allowed: Special Permissions: Traverse Folder Read Attributes Read Permissions BUILTIN\Administrators Allowed: Full Control NT AUTHORITY\SYSTEM Allowed: Full Control (No auditing) And it repeats for a few other directories. How can I split them into paragraphs and then check for lines containing Special Permissions: ? Like this: Separate the whole string1 into few parts, C:\ and C:\WINDOWS\system32 . Look in each line that contains 'Special Permissions:' Display the whole line, e.g.: C:\: BUILTIN\Users Allowed: Special Permissions: \n\ Create Folders\n\ BUILTIN\Users Allowed: Special Permissions: \n\ Create Files\n\ Repeat for next 'paragraph' I was thinking of: 1. Search the whole text file for r"(\w+:\\)(\w+\\?)*:" - return me the path 2. String function or regex to get the rest of the output 3. Remove all the other lines besides the ones with Special Permissions 4. Display, and repeat step 1 But I think it is not efficient. Can anyone guide me on this? Thanks. Example output: C:\: BUILTIN\Users Allowed: Special Permissions: Create Folders BUILTIN\Users Allowed: Special Permissions: Create Files C:\WINDOWS\system32: BUILTIN\Power Users Allowed: Special Permissions: Delete C:\WINDOWS\security: BUILTIN\Users Allowed: Special Permissions: Traverse Folder Read Attributes Read Permissions BUILTIN\Power Users Allowed: Special Permissions: Traverse Folder Read Attributes Read Permissions C:\WINDOWS\system32\config doesn't show up as there's no Special Permission in the lines. The template I am using: import re text = "" def main(): f = open('DirectoryPermissions.xls', 'r') global text for line in f: text = text + line f.close print text def regex(): global text if __name__ == '__main__': main() regex()
