[site]: stackoverflow
[post_id]: 5250684
[parent_id]: 5248982
[tags]: 
Use %%~ni instead of %%i to extract the base file name without extension. Use the %var: =_% syntax to replace spaces in the value of the var variable with underscores. So, basically, you need something like this: @echo off setlocal enabledelayedexpansion FOR %%i IN (*.htm) DO ( SET basename=%%~ni SET basename=!basename: =_! java -jar saxon.jar -o:"..\Front_Matter\!basename!.xml" "%%i" "C:\Documents and Settings\Robert\Desktop\xsl\htm2xml.xsl" )
