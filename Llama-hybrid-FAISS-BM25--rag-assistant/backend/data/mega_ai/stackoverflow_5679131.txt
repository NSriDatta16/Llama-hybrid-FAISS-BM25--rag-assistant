[site]: stackoverflow
[post_id]: 5679131
[parent_id]: 5678591
[tags]: 
I assume here that all code resides in a single project (Company.Pins.Bank.Win32Console). If so you should move the and includes (and any other includes of headers that never/seldom change to stdafx.h: //stdafx.h #include #include //other headers that are widely used but never/seldom change... #define DllExport __declspec(dllexport) #define DllImport __declspec(dllimport) and //UInstruction.h #pragma once //you are in VS 2010... #include "common.h" //ommited code for brevity... void UserInstruction1(double* lpNumeric, TCHAR* lpAlpha1, TCHAR* lpAlpha2); and //UInstruction.cpp #include "stdafx.h" #include "UInstruction.h" //ommitted code for brevity... void UserInstruction1( double* lpNumeric, TCHAR* lpAlpha1, TCHAR* lpAlpha2 ) { //logic goes here } If UserInstruction1 resides in a Dll that is used by the Company.Pins.Bank.Win32Console project: Make sure you define in stdafx.h for the dll and console projects: #define DllExport __declspec(dllexport) #define DllImport __declspec(dllimport) Open the properties for the DLL project, go to "Configuration Properties" -> "C/C++" -> "Preprocessor" and add to "Preprocessor Definitions" a preprocessor symbol (if you don't have one). I.e. I'll call it MY_DLL. Don't forget to define it in all configurations... Make sure you export the functions from the Dll //UInstruction.h #pragma once //you are in VS 2010... #ifdef MY_DLL #define MY_DLL_EXPORTS DllExport #else #define MY_DLL_EXPORTS DllImport #endif //MY_DLL #include "common.h" #define PRES_NOCOMMAND_FOUND 2000 //ommited code for brevity... void MY_DLL_EXPORTS UserInstruction1(double* lpNumeric, TCHAR* lpAlpha1, TCHAR* lpAlpha2); The cpp file for UInstruction remains the same as above... EDIT: For completness... //UInstruction.cpp #include "stdafx.h" #include "UInstruction.h" //ommitted code for brevity... //no extern needed... void UserInstruction1( double* lpNumeric, TCHAR* lpAlpha1, TCHAR* lpAlpha2 ) { //logic goes here } Do not forget to add a reference to the Dll project to the Company.Pins.Bank.Win32Console project from the properties of the Company.Pins.Bank.Win32Console "Common Properties" -> "Framework and References"
