[site]: crossvalidated
[post_id]: 9986
[parent_id]: 9981
[tags]: 
Given your data: cp then the ranks, with ties being given average of the ranks, are: > rank(cp) [1] 7.0 4.0 6.0 1.5 8.5 4.0 8.5 4.0 10.0 1.5 What is being done here? If you sort the data in increasing order, then we have a 1 in both rank order positions 1 and 2. We could assign rank 1 to both 1 s, or rank 2, or as stated above, the average of the rank orders (1/2) / 2 = 1.5. This is why the two 1 s have been given rank of 1.5 in the above output from R. Now look at the next values in the rank order, the 2 s. The 2 's are in rank order positions 3, 4, and 5, therefore they all get rank 4 from (3+4+5) / 3 = 4, as this is the average of the tied ranks for these values. If we initiate $S_0 = 0$, i.e. the zeroth cumulative sum is 0, we compute the $i$th cumulative sum ($S_i$) as the previous cumulative sum ($S_{i-1}$) plus the difference between the rank of the $i$th data point ($r_i$) and the average over all ranks $\bar{r}$. For the above data, the average rank is: > rcp mean(rcp) [1] 5.5 The values $r_i - \bar{r}$ for this set of data are: > rcp - mean(rcp) [1] 1.5 -1.5 0.5 -4.0 3.0 -1.5 3.0 -1.5 4.5 -4.0 and the cumulative sums are: > cumsum(rcp - mean(rcp)) [1] 1.5 0.0 0.5 -3.5 -0.5 -2.0 1.0 -0.5 4.0 0.0
