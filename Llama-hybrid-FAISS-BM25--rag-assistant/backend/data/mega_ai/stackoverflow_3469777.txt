[site]: stackoverflow
[post_id]: 3469777
[parent_id]: 
[tags]: 
Flex compiler, mxmlc, called in Java makes 64bits JVM crash (dcpr.dll)

I have a web application that converts SVG files into swf ones. In order to do so, there are 3 steps : 1 - Running through SVG Files in a folder for (final File file : tFiles) { final String fileName = file.getName(); final int nbEr = flashEngine.convert(fileName); if (nbEr > 0) { LOG.error("Error with SVG file : " + fileName); } file.delete(); } 2 - Converting each SVG in a .AS temporary file and adding info in it public final int convert(final String svgName) { // ***************** // DIVERS TREATMENTS // ***************** final int nbError = computeSwf(svgName); // ****************** // DIVERS TREATMENTS // ****************** return nbError; } 3 - Converting th .as into .swf thanks to Mxmlc compiler private int computeSwf(final String svgName) { final String[] argscompiler = new String[5]; argscompiler[0] = "+flexlib"; argscompiler[1] = [flex framework path : /flex/frameworks]; argscompiler[2] = [temporary .as file path]; argscompiler[3] = "-output"; // output folder path argscompiler[4] = [output file name thanks to svgName]; flex2.tools.Compiler.mxmlc(argscompiler); return ThreadLocalToolkit.errorCount(); } Most of the time, everything works fine. But, in some cases, the entire JVM crashes without warning. I added logs around the mxmlc compiler calling : try { LOG.info("mxmlc compiler calling"); flex2.tools.Compiler.mxmlc(argscompiler); LOG.info("mxmlc compilation finished"); } catch (final Throwable e) { LOG.fatal(e, e); } In my logs, it shows me that for lots of files, the compilation works. But the JVM crashes, after a "mxmlc compiler calling" line. So, the issues comes from the flex compiler. After some tests, I obtained a "JVM Crash report" : 6.1 7600 (0x30): Windows 7 Professional Professional 7600.16539.amd64fre.win7_gdr.100226-1909 1 Multiprocessor Free X64 1036 2052 C:\Java\jre6\bin\javaw.exe C:\Java\jre6\bin\javaw.exe -agentlib:jdwp=transport=dt_socket,suspend=y,address=localhost:59809 -Dcatalina.base=C:\Workspaces\Eclipse\.metadata\.plugins\org.eclipse.wst.server.core\tmp0 -Dcatalina.home=C:\Tomcat55 -Dwtp.deploy=C:\Workspaces\Eclipse\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps -Djava.endorsed.dirs=C:\Tomcat55\common\endorsed -Xms512M -Xmx1024M -XX:MaxPermSize=256m -Dfile.encoding=UTF-8 -classpath C:\Workspaces\Eclipse\[MY PROJECT]\webcontent\WEB-INF\lib\wsdl4j-1.5.1.jar;C:\Tomcat55\bin\bootstrap.jar org.apache.catalina.startup.Bootstrap start APPCRASH java.exe 6.0.200.2 4bc39549 dcpr.dll 6.0.200.2 4bc3ace7 c00000fd 000000000000dacc 6.1.7600.2.0.0.256.48 1036 dfc4 dfc49eb22582397c699a9ef43341068a 7fc1 7fc14f899de80bb4d59ec0501e30665b 961D9682-D49E-4725-9224-B2748025A619 Dell Inc. OptiPlex 780 A03 As you can see, it seems that the dcpr.dll (Sun Java dll) crashes. I already had a issue like this one, but it was resolved by going from jdk 1.5 to 1.6. It seems that this is not a real solution :s Info : Java version : JDK 1.6.0.20 64 bits Flex version : flex_sdk_3.5.0.12683 I do not use the "Full JDK", the one with the [flex]/bin/jvm.config file. So, here are my questions : - can I simply add a jvm.config file (or another one), to set the mxmlc compiler up ? - do I have to use a 32 bits jdk ? (it seems that there are issues concerning flex and 64 bits jdk) - are there other compiler to convert as to swf ?
