[site]: stackoverflow
[post_id]: 4411689
[parent_id]: 
[tags]: 
Using Proguard with a library has a @Service bean which should autowire

I have a library Common.License which I am obfuscating with Proguard: com.pyx4me proguard-maven-plugin package proguard true -dontoptimize -renamesourcefileattribute SourceFile -keepattributes Exceptions,InnerClasses,Signature,Deprecated,SourceFile,LineNumberTable,*Annotation*,EnclosingMethod -keep public class * { public protected *;} -keepclassmembernames class * {java.lang.Class class$(java.lang.String); java.lang.Class class$(java.lang.String, boolean);} -keepclassmembernames class * {com.common.license.LicenseSessionStore licenseSessionStore; com.common.license.LicenseStore licenseStore;} -keepclassmembers enum * {public static **[] values(); public static ** valueOf(java.lang.String);} -keepclassmembers class * implements java.io.Serializable { static final long serialVersionUID; private static final java.io.ObjectStreamField[] serialPersistentFields; private void writeObject(java.io.ObjectOutputStream); private void readObject(java.io.ObjectInputStream); java.lang.Object writeReplace(); java.lang.Object readResolve();} ${java.home}/lib/rt.jar ${java.home}/lib/jsse.jar false This library has a Spring bean annotated with @Service: @Service public class LicenseServiceImpl implements LicenseService { @Autowired(required = false) LicenseSessionStore licenseSessionStore; @Autowired(required = false) LicenseStore licenseStore; ... } I use this library in a web service Company.License where I want the LicenseService to autowire: @Component public class BackgroundTasks { @Autowired ScheduledExecutorService scheduledExecutorService; @Autowired LicenseService licenseService; ... } So Company.License has a dependency on Common.License. If I obfuscate Common.License then licenseService will not autowire in BackgroundTasks . The only way I could work around this was to define licenseService explicitly as a bean: @Bean(name = "licenseService", autowire = Autowire.BY_NAME) public LicenseService getLicenseService() { if (licenseService == null) { licenseService = new LicenseServiceImpl(); } return licenseService; } I should not need to explicitly declare this as a bean like this as I have already annotated the class with @Service which should be enough to make the autowiring of licenseService in BackgroundTasks Spring-magically work. But it doesn't! What is Proguard specifically doing to make this not work? Is there anything I can do in the configuration of Proguard to make it more Spring friendly? Grant
