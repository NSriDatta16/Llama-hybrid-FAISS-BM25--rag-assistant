[site]: stackoverflow
[post_id]: 965675
[parent_id]: 951652
[tags]: 
Why not use SSIS and set it up as a job in SQL Server Agent? Then, you can use sp_start_job to kick it off whenever you wanted, set up a trigger to handle it, or schedule it. You can use SSIS variables, and do the xp_cmdshell stored proc using dtexec to set the variable. Or, you can use the trigger to load up a table, do a foreach in SSIS and truncate the table after each run.
