[site]: crossvalidated
[post_id]: 62788
[parent_id]: 
[tags]: 
Enrichment of variables within clusters

I'm trying to find if some clusters in an arbitrary annotated dendrogram are enriched for a particular level of a categorical variable . At the moment, as you can see in the picture, I'm simply calculating a Fisher'Exact Test for all the eight variables (outcome 1/0) using the within cluster occurrence of that level vs. the outisde occurrence. I define the subclusters by cutting the dendrogram at different levels, and then I plot a pink line over the most enriched cluster (I don't correct the p-values via BH at each level of cut, in order to favor bigger cluster). My first question is: what would be the correct test if the levels of a variable were more than two? My second question is: is there a more elegant method than cutting the tree at several levels (in my case, arbitrarily defined to 2:20) and check each time the enrichment in all the generated subgroups? I use R, so feel free to reply by pointing me towards R packages :-) Thanks!
