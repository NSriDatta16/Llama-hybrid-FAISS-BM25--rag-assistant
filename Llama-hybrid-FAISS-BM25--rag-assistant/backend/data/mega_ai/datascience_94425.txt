[site]: datascience
[post_id]: 94425
[parent_id]: 
[tags]: 
How to make a prediction with an existing model in keras?

I have a pretrained model that i need to load and make a prediction on two images with. The model is a CNN that takes as input 150x150 RGB images and predicts whether it's a cat or a dog. I've sorted out the tensor formatting and model loading, but the result of the prediction looks off and i cant seem to shed light on what the problem is. My code below: import keras import cv2 import os import numpy from keras.preprocessing.image import ImageDataGenerator def loadAndReshape(path): targetImage = cv2.imread(path) targetImage = cv2.cvtColor(targetImage, cv2.COLOR_BGR2RGB) targetImage = cv2.resize(targetImage, dsize=(150, 150)) / 255 targetImage = targetImage.reshape(150, 150, 3).astype('float32') return targetImage li = [] li.append(loadAndReshape('.//test1.jpg')) li.append(loadAndReshape('.//test2.jpg')) targetImages = numpy.array(li) model = None targetDatagen = ImageDataGenerator(rescale=1./255) targetGenerator = targetDatagen.flow(targetImages, batch_size=2) if os.path.exists('./Model_cats_dogs_small_dataset.h5'): model = keras.models.load_model('./Model_cats_dogs_small_dataset.h5') result = model.predict_generator(targetGenerator, steps=2) resultSecond = model.predict(targetImages) print(f'result: {result} and resultSecond: {resultSecond}') The original model used generators for prediction so i went ahead and used both predict_generator and predict methods to see the differences. I was expecting that having 2 images and a binary classifier, the prediction result will be an array containing 2 arrays, each with the probabilities for each class. However, for each prediction i just get only one value for each image, like this: result: [[0.17093319] [0.170154 ]] and resultSecond: [[0.47771692] [0.99125683]] What am i doing wrong and how can i fix this?
