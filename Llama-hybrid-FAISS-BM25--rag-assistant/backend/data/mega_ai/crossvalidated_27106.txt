[site]: crossvalidated
[post_id]: 27106
[parent_id]: 
[tags]: 
Bayesian estimation using Gibbs sampling for financial models

I am trying to do Gibbs sampling, from this paper . This is a CIR financial model, I want to do Gibbs on its parameters: $$y(t+{\Delta}^{+})=y(t)+(\alpha-\beta y(t)){\Delta}^{+}+\sigma \sqrt{y(t)}{\epsilon}_{t}$$ The conditionals are: Step 1: ${y}_{t,j+1}^{*}|{y}_{t,j}^{*},\theta\ \tilde{\ }\ N({y}_{t,j}^{*}+(\alpha-\beta {y}_{t,j}^{*})\Delta, {\sigma}^{2}\Delta {y}_{t,j}^{*})$ Step 2: $\psi|Y,{Y}^{*},{\sigma}^{2}\ \tilde{}\ N(\mu, {\Lambda}^{-1})$ Step 3: $\sigma|Y,{Y}^{*}, \psi\ \tilde{}\ inverse-gamma(E, F)$ $E=(T-1)(M+1)/2$, and $F=\sum\limits_{t=1}^{T-1}{\sum\limits_{j=0}^{M}{\frac{{{\left( y_{t,j+1}^{*}-\left[ y_{t,j}^{*}+(\alpha -\beta y_{t,j}^{*})\Delta \right] \right)}^{2}}}{2y_{t,j}^{*}}}}$ Repeat Gibbs between step 2 and 3. Notations: $\theta=(\psi,{\sigma}^{2})$ and $\psi=(\alpha, \beta)$ I get negative numbers when sampling from inverse-gamma, I use rinvgamma(). What am I doing wrong?
