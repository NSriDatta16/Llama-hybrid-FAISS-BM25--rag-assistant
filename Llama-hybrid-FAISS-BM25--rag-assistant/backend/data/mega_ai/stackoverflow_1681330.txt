[site]: stackoverflow
[post_id]: 1681330
[parent_id]: 
[tags]: 
Downloaded word file displaying incorrectly

I am working on a website at the moment which is displaying a strange bug with generated word documents. The site has a feature on it which allows the user to download a word document containing information related to their visit. This file is generated via some vb.net code and takes an xml template of the final document and inserts the relevant content required. The strange behaviour is that on some machines the .doc file generated displays fine and on others it displays as XML when opened in Word. Both behaviours have been seen in the same version of Office (2003) but on seperate machines. My question is really whether the error lies with the set up of word on the individual machines, or whether there is an error in the code. The code to create the file and download it is as follows: Response.Clear() Response.ClearHeaders() Response.AddHeader("content-disposition", "inline; filename=MyNewFile") Response.ContentType = "application/msword" 'Create the word file as a byte array based off an xml template document' Dim objWordGenerator As New WordFileGenerator Response.BinaryWrite(objWordGenerator.GetWordBytes) Response.Flush() Response.Clear() Response.End() The actual xml template is quite large so probably not suitable to post here but I can provide any more information if necessary. Update: Having managed to fix the original bug (it turns out that the original filename being used didn't have the .doc extension) I have found another bit of strange behaviour. When the file is opened it opens in Word correctly, however when you go to save it the default file type is XML. When saved as an XML file it will open in Word correctly, but I feel this is slightly confusing behaviour for the end user. I would like the file to default to saving as a DOC file instead. Is there a way to force this to happen? Update 2: Below is a section of the XML that relates to the Document properties. The rest of the document deals with content and styles etc, so my assumption is that this is the most relevant section. To reiterate, my problem is that when the downloaded .doc file is opened in word, the default "save as" option is as an XML file. Fancy Word Doc Bob Bobertson 999 A Fancy Company 1.1.1 Cheers
