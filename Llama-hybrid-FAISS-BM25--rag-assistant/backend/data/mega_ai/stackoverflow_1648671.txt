[site]: stackoverflow
[post_id]: 1648671
[parent_id]: 155097
[tags]: 
Below is the PHP code I use in my project when sending Microsoft Excel to user: /** * Export an array as downladable Excel CSV * @param array $header * @param array $data * @param string $filename */ function toCSV($header, $data, $filename) { $sep = "\t"; $eol = "\n"; $csv = count($header) ? '"'. implode('"'.$sep.'"', $header).'"'.$eol : ''; foreach($data as $line) { $csv .= '"'. implode('"'.$sep.'"', $line).'"'.$eol; } $encoded_csv = mb_convert_encoding($csv, 'UTF-16LE', 'UTF-8'); header('Content-Description: File Transfer'); header('Content-Type: application/vnd.ms-excel'); header('Content-Disposition: attachment; filename="'.$filename.'.csv"'); header('Content-Transfer-Encoding: binary'); header('Expires: 0'); header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); header('Pragma: public'); header('Content-Length: '. strlen($encoded_csv)); echo chr(255) . chr(254) . $encoded_csv; exit; } UPDATED: Filename improvement and BUG fix correct length calculation. Thanks to TRiG and @ivanhoe011
