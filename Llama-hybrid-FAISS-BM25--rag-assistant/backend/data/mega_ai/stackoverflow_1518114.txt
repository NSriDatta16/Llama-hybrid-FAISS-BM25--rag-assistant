[site]: stackoverflow
[post_id]: 1518114
[parent_id]: 1461020
[tags]: 
Sounds like you could use the Two Step View pattern . Essentially, your reports get rendered in two passes. The first pass executes the report logic against your model to generate a sort of proto-report object. The first pass proto-report has all the information that goes on the report, organized and grouped as the report needs it. Once this is complete, the proto-report is fed into a template that renders it to a particular format (pdf, xls, csv, whatever). This second pass generates the report's bytes, which can be stored to a file or sent out over the wire.
