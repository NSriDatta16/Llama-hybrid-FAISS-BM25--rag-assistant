[site]: stackoverflow
[post_id]: 5103727
[parent_id]: 
[tags]: 
How to get back the task completion status in AsyncTask

This is related to my previous post Problem with downloading multiple files using AsyncTask I'm trying to download two video files and also show a ProgressDialog during the process. For this I'm using AsyncTask. I want the 1st download to complete, free up memory then start the 2nd download. I wrote the following code to achieve this, but it seems the 2nd download never begins. startDownload() { DownloadFileAsync d1 = new DownloadFileAsync(); d1.execute(videoPath+fileNames[0],fileNames[0]); if(d1.getStatus()==AsyncTask.Status.FINISHED) { d1 = null; DownloadFileAsync d2 = new DownloadFileAsync(); d2.execute(videoPath+fileNames[1],fileNames[1]); } } Is there a way that I can get back the completion status of my 1st task & then start the 2nd ? The following is the code of my DownloadFileAsync class: class DownloadFileAsync extends AsyncTask { @Override protected void onPreExecute() { super.onPreExecute(); showDialog(DIALOG_DOWNLOAD_PROGRESS); } @Override protected String doInBackground(String... aurl) { int count; try { URL url = new URL(aurl[0]); URLConnection conexion = url.openConnection(); conexion.connect(); File root = android.os.Environment.getExternalStorageDirectory(); int lenghtOfFile = conexion.getContentLength(); Log.d("ANDRO_ASYNC", "Lenght of file: " + lenghtOfFile); InputStream input = new BufferedInputStream(url.openStream()); OutputStream output = new FileOutputStream(root.getAbsolutePath() + "/videos/" + aurl[1]); byte data[] = new byte[1024]; long total = 0; while ((count = input.read(data)) != -1) { total += count; publishProgress(""+(int)((total*100)/lenghtOfFile)); output.write(data, 0, count); } output.flush(); output.close(); input.close(); } catch (Exception e) {} return null; } protected void onProgressUpdate(String... progress) { Log.d("ANDRO_ASYNC",progress[0]); mProgressDialog.setProgress(Integer.parseInt(progress[0])); } @Override protected void onPostExecute(String unused) { dismissDialog(DIALOG_DOWNLOAD_PROGRESS); tv.append("\n\nFile Download Completed!"); sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse("file://"+ Environment.getExternalStorageDirectory()))); } }
