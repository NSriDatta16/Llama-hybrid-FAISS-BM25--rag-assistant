[site]: crossvalidated
[post_id]: 349489
[parent_id]: 346798
[tags]: 
After discussing with prof Frank Harrell by email, I devised the following procedure for estimating the optimism-corrected calibration curve, partially based on his Tutorial in Biostatistics (STATISTICS IN MEDICINE, VOL. 15,361-387 (1996)): fit a risk prediction model on all data fit a flexible model (gam with spline and logit link) to the model's predicted probabilities vs outcome, and query the gam at a grid of predicted probabilities $p=(0.01,0.02,...,0.99)$ . This is the apparent calibration curve and we call it $cal_{app}$ draw bootstrap sample with replacement, same size of original data fit risk prediction model on bootstrap sample use the bootstrap model to predict probabilities from the bootstrap sample, fit a gam between the predicted probabilities and the outcome, and query the gam at a grid of predicted probabilities (let us call these points $cal_{boot}$ ) use the bootstrap model to predict probabilities from the original sample, fit a gam between the predicted probabilities and the outcome, and query the gam at a grid of predicted probabilities obtaining a calibration curve ( $cal_{orig}$ ) compute the optimism at every point $p$ of the grid like so $$Optimism(p)=cal_{boot}(p) - cal_{orig}(p)$$ repeat steps 3-7 some 100 times, average the optimism at each point $p$ compute the optimism corrected calibration like so $$cal_{corr}(p)=cal_{app}(p)- $$ Important note : The procedure above is inspired by Harrell's work and my discussion with him, but all errors are mine alone.
