[site]: stackoverflow
[post_id]: 2706981
[parent_id]: 2706964
[tags]: 
I don't have an opinion on how to weigh things. That said, why not just add a popularity column to the location table? All of a sudden, your SQL query is incredibly simple. The tricky part, of course, is figuring out how and when to update that value. But since you're saving all of the activity data, you can always regenerate the popularity values from the log entries. That way, you get nice fast queries for "most popular" locations, and if you want to change the way popularity is computed, you can do so at will. If you're clever, you might be able to devise a simple enough formula so that popularity can be tracked in real time. For instance, if we only cared about average ratings, you can modify the average rating with just three variables: the current average rating, the number of times the object has been rated, and the new rating value. Of course, things get more complex when you start mixing in how many times the object has been viewed, reviewed, favorited, etc ... but you might find that you can devise a method that's computationally cheap enough that you can update the overall popularity value on just about every action.
