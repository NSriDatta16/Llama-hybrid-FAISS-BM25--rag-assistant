[site]: crossvalidated
[post_id]: 266723
[parent_id]: 264259
[tags]: 
Your estimated model looks like: \begin{align} \sqrt{V_2} &= a_2 \left( 1+V_1 \right)^{b_2} + \epsilon_2 \\ \sqrt{V_3} &= a_3 \left( 1+V_2 \right)^{b_3} + \epsilon_3 \\ \ln{\left(1+V_4\right)} &= a_4 + b_4 V_2 + c_4 V_3 + \epsilon_4 \\ \end{align} What you are interested in calculating is $\frac{d V_4}{d V_1}$. To do this, we are just going to use the Chain Rule: \begin{align} \frac{d V_4}{d V_1} &= \frac{\partial V_4}{\partial V_2}\frac{d V_2}{d V_1}+\frac{\partial V_4}{\partial V_3}\frac{d V_3}{d V_2}\frac{d V_2}{d V_1}\\ \end{align} To calculate those derivatives, we have to re-write the equations you estimated so that they have the correct variables on the left-hand-side: \begin{align} V_2 &= \left( a_2 \left( 1+V_1 \right)^{b_2} + \epsilon_2 \right) ^2\\ V_3 &= \left( a_3 \left( 1+V_2 \right)^{b_3} + \epsilon_3 \right) ^2\\ V_4 &= \exp{ \left(a_4 + b_4 V_2 + c_4 V_3 + \epsilon_4 \right)} -1\\ \end{align} Now, we take the derivatives: \begin{align} \frac{d V_2}{d V_1} &= 2\left( a_2 \left( 1+V_1 \right)^{b_2} + \epsilon_2 \right) \left( a_2 b_2 \left( 1+V_1 \right)^{b_2-1} \right)\\ &\\ \frac{d V_3}{d V_2} &= 2 \left( a_3 \left( 1+V_2 \right)^{b_3} + \epsilon_3 \right) \left( a_3 b_3 \left( 1+V_2 \right)^{b_3-1} \right)\\ &\\ \frac{\partial V_4}{\partial V_2} &= \exp{ \left(a_4 + b_4 V_2 + c_4 V_3 + \epsilon_4 \right)}b_4\\ &\\ \frac{\partial V_4}{\partial V_3} &= \exp{ \left(a_4 + b_4 V_2 + c_4 V_3 + \epsilon_4 \right)}c_4\\ \end{align} Now, we can use the original equations to make some substitutions: \begin{align} \frac{d V_2}{d V_1} &= 2 \sqrt{V_2} \left( a_2 b_2 \left( 1+V_1 \right)^{b_2-1} \right)\\ &\\ \frac{d V_3}{d V_2} &= 2 \sqrt{V_3} \left( a_3 b_3 \left( 1+V_2 \right)^{b_3-1} \right)\\ &\\ \frac{\partial V_4}{\partial V_2} &= b_4\ln{\left(1+V_4\right)}\\ &\\ \frac{\partial V_4}{\partial V_3} &= c_4\ln{\left(1+V_4\right)} \end{align} Obviously, those have $V_1,V_2,V_3,V_4$ in them. This is as you should expect---in non-linear models, the derivative (the effect size) depends on the levels of the variables. That's what non-linear means. Since the derivatives depend on data, the value of the derivative will be different for each data point. Again, as expected. Now, since you usually want to report one number for your effects, the number you usually report is the average of the effect sizes. So, what you do is calculate the following for each data point: \begin{align} \frac{d V_4}{d V_1} &= \frac{\partial V_4}{\partial V_2}\frac{d V_2}{d V_1}+\frac{\partial V_4}{\partial V_3}\frac{d V_3}{d V_2}\frac{d V_2}{d V_1}\\ &\\ \frac{d V_4}{d V_1} &= b_4\ln{\left(1+V_4\right)} \left(2 \sqrt{V_2} \left( a_2 b_2 \left( 1+V_1 \right)^{b_2-1} \right) \right)\\ &+ c_4\ln{\left(1+V_4\right)} \left( 2 \sqrt{V_3} \left( a_3 b_3 \left( 1+V_2 \right)^{b_3-1} \right) \right) \left(2 \sqrt{V_2} \left( a_2 b_2 \left( 1+V_1 \right)^{b_2-1} \right) \right)\\ & \\ \frac{d V_4}{d V_1} &= 2 b_4 a_2 b_2\ln{\left(1+V_4\right)} \sqrt{V_2} \left( 1+V_1 \right)^{b_2-1}\\ &+ 4 c_4 a_3 b_3 a_2 b_2 \ln{\left(1+V_4\right)} \sqrt{V_3} \left( 1+V_2 \right)^{b_3-1} \sqrt{V_2} \left( 1+V_1 \right)^{b_2-1} \end{align} The last equation is what you use to calculate, for each observation, the total effect of $V_1$ on $V_4$. The first big term (before the $+$ sign) is the effect of $V_1$ on $V_4$ which operates through $V_2$ directly, and the second big term (after the $+$ sign) is the effect of $V_1$ on $V_4$ which operates through $V_2$ and then $V_3$. To present a single number for the overall effect, you just take the sample mean over the observations in your dataset. Similarly, for the effects running through $V_2$ and $V_3$, you take sample means over their respective terms. Now, you probably will want to construct a confidence interval for these effects as well. The easiest and probably best way to do this is via bootstrapping. The R code below does all of this. Notice that there is a fair amount of algebra above and a fair amount of translating algebra into code necessary to run the R code. It would not be shocking if there were errors. On the bright side, the median effect size my code calculates for the total effect of V1 on V4 is -38. A simple linear regression of V4 on V1 gives -32. So, that's kind of reassuring. # This script written in response to a Cross Validated question # http://stats.stackexchange.com/questions/264259/how-can-i-combine-nls-models-in-a-way-as-is-done-with-linear-regression-models-i # The script estimates a three-equation structural equation model using OLS # and NLS. Then, it calculates the total effect of variable v1 on variable # v4. This total effect operates (non-linearly) through two intermediary # variables, v2 and v3. Then, the script calculates a confidence # interval via bootstrapping. # See my answer to the above-linked question for further explanation. # This comment last modified 03/10/2017 # William B Vogt library(Hmisc) library(boot) set.seed(12344321) # data from the question V1
