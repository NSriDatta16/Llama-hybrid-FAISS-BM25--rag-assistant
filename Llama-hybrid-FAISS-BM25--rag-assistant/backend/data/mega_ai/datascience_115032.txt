[site]: datascience
[post_id]: 115032
[parent_id]: 
[tags]: 
Consequence of having different factor levels in production after training random forest model in R (wrong variable language encoding before)

I just realised that a model that is going in production had an issue with encoding for a specific variable. How does a random forest deal with the fact that: The dataset used for training, validation and test was a dataset where one variable was not encoded correctly. It thus looked like this (simplified) station var1 var2 passengers 1 H.,Ý 12 24 323 2 KTL 35 54 343 3 LYR 104 33 211 4 K`.,É 20 34 342 The model has been trained to be able to predict passengers (the real model has way more predictors and this "station" variable has way more levels. Now, after having been trained and evaluated with different model metrics, it is now supposed to predict on data where there is no information about passengers, so there is no way to check how well the predictions do. Now, preparing this data we realized that the encoding of station was wrong. We therefore ran this code: data Which left us with the correct encoding: station var1 var2 1 HØJ 12 24 2 KTL 35 54 3 LYR 104 33 4 KØB 20 34 However, the variable is now a character variable (which probably shouldn't matter?). But what happens now, when we use the saved model to predict the passengers: station var1 var2 predicted_passengers 1 HØJ 12 24 304 2 KTL 35 54 232 3 LYR 104 33 234 4 KØB 20 34 46 Now mind me these are not the real numbers. And there are way more variables and way more categories on "station". My question is thus: My understanding is that random forest (and all supervised ML algorithms) one-hot encode categorical variables. Does it use the name or the underlying factor "level" to determine, which category it is? Will these predictions now be worse, as it has never been trained on Station == "Høj" ? Can this be dealt with by running levels(data$station) before the encoding sapply function above, and just releveling the levels after encoding? If this is a problem, how can it be fixed?
