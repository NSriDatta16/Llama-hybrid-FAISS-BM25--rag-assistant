[site]: stackoverflow
[post_id]: 4608162
[parent_id]: 
[tags]: 
SQL - Aggregating data in a result set with identical rows and eliminating multiple rows based on one column's value

I have a table that has transactions by employeeID by TransactionTime. Each employee may have multiple transactions that occur at the same time. For example: EmployeeID 1 has 2 transactions at 12. I need to sum the transactions by EmployeeID at each time interval. So for employeeID 1, the new column (TotalTransactionsByTime) result would be 2. Next, if the CODE for a given TransactionTime has a CODE of BAD, I need to exclude all transactions at that time increment. So for EmployeeID 2, I would need to exclude all three transactions from the result set because they have a CODE of 'BAD' which nullifies all transactions at that increment. MY TABLE |EmployeeID|TransactionTime|CODE| 1 12 GOOD 1 12 GOOD 1 5 GOOD 2 1 BAD --need to omit all 3 transactions for employeeID 2 2 1 GOOD 2 1 GOOD 3 3 GOOD 3 3 GOOD A correct result would look like: |EmployeeID | TransactionTime | CODE | NUMBERTRNS 1 12 GOOD | 2 1 5 GOOD | 1 3 3 GOOD | 2
