[site]: stackoverflow
[post_id]: 2061459
[parent_id]: 
[tags]: 
What is the best way to get unique elements of an array of activerecord objects based on attributes of the object?

In my application I am trying to display only unique elements of an array of activerecord objects(loss_reports) based on two attributes of a loss_report. Schema class Agent policy end class LossReport I first tried to override the eql? and hash method of a LossReport so that I could do something similar to: Option 1: class LossReport ... def eql? other self.policy_id == other.policy_id && loss_occurred_on.hash == self.loss_occurred_on end def hash policy_id + loss_occurred_on.hash end end class Agent ... def unique_losses loss_reports.to_set end end but quickly removed the code because of ActiveRecord already overriding the methods and my not being sure of the repercussions. Option 2: class Agent ... def unique_losses loss_reports.sort{|l1,l2| l2.created_at l1.created_at}.group_by{|l| (l.policy_id + l.loss_occurred_on.hash)}.collect{|hl| hl[-1].first} end end Option 3: class Agent def unique_losses hsh_array = [] unique = [] loss_reports.sort{|l1,l2| l2.created_at l1.created_at}.each do |l| unique Benchmark results: Benchmark.bmbm do |bm| bm.report("option 2") do losses.sort{|l1,l2| l2.created_at l1.created_at}.group_by{|l| (l.policy_id + l.loss_occurred_on.hash)}.collect{|hl| hl[-1].first} end bm.report("option 3") do hsh_array,unique = [],[] losses.sort{|l1,l2| l2.created_at l1.created_at}.each do |l| unique Neither way feels right but both work. Which is the best option or is there an even better way?
