[site]: stackoverflow
[post_id]: 4444581
[parent_id]: 4444422
[tags]: 
I think you could do this by joining on row numbers, something like: WITH datanumbered AS ( SELECT dateValue, ROW_NUMBER() OVER (ORDER BY dateValue) AS rownum ) SELECT first.rownum, DATEDIFF(second, first.dateValue, second.dateValue) AS TimeDiff FROM datenumbered first JOIN datenumbered second ON first.rownum = second.rownum - 1 Then the calculate average by using the above query as a subquery.
