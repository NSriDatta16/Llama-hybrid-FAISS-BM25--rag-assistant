[site]: crossvalidated
[post_id]: 620528
[parent_id]: 620468
[tags]: 
This is part of a derivation of the solution for an L2-penalized linear regression (ridge regression), as demonstrated on this page . With centered predictors, let the model matrix for the regression be the $N$ (rows, observations) by $m$ (columns, predictor variables) matrix $X$ . With an $N \times 1$ outcome vector $y$ , the parameter estimates from the L2-penalized regression at penalty $\lambda$ are given by: $$\hat \beta = (X^TX + \lambda I)^{-1}X^Ty.$$ The text you cite uses $d$ instead of $y$ for the vector of outcomes and $w$ instead of $\beta$ for the vector of parameters, but I'm trying to keep to what seems to be the usual choices of variable names on this site. Putting aside the (unfortunate?) choice of (offsetting?) negative signs in the cited text (noted in comments), what's called "the time-averaged $M$ - by - $M$ correlation matrix " in the text is supposed to be equivalent to $X^TX$ above. That's evident on the next page of the text, when the "normal equation" for linear regression is discussed. So the question can be re-phrased: does the formula in Equation 2.30 give the same matrix as $X^TX$ (except perhaps for sign)? Let's index $X^TX$ by $p$ for rows and $q$ for columns. Then the $p,q$ element of $X^TX$ is $\sum_{i=1}^N X_{i,p} X_{i,q}$ . There are no products involving predictor values at different times/trials. Now consider "the outer product[s] of the regressors $x_i$ and $x_j$ , applied to the environment on the $i$ th and $j$ th experimental trials" the are summed to get the matrix in Equation 2.30. In that context, $x_i$ and $x_j$ are the $m \times 1$ vectors of predictors at times/trials $i$ resp. $j$ , equivalent to rows $i$ and $j$ of the model matrix $X$ . For a single choice of $i,j$ , the $p,q$ element of that outer product, in terms of the model matrix $X$ defined above, would be $X_{i,p} X_{j,q}$ . Even for a single choice of $i,j$ that thus doesn't make sense; it involves products of values of different predictors at different times/trials. Unless I'm missing something, that does seem to be an error in the text. The text does get the form correct in subsequent references to the input-vector correlation matrix, as in Equation 3.30.
