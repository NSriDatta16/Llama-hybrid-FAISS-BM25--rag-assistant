[site]: stackoverflow
[post_id]: 3284624
[parent_id]: 
[tags]: 
Exchange Management Powershell with .Net

Why am I receiving this Exception: System.Management.Automation.CommandNotFoundException: The term new-storagegroup.... Relevant code: RunspaceConfiguration rsConfig = RunspaceConfiguration.Create(); PSSnapInException snapInException = null; PSSnapInInfo info = rsConfig.AddPSSnapIn("Microsoft.Exchange.Management.PowerShell.Admin", out snapInException); Runspace myRunSpace = RunspaceFactory.CreateRunspace(rsConfig); myRunSpace.Open(); //Create pipeline and feed it the script text Pipeline pipeline = myRunSpace.CreatePipeline(); string strScript = "new-storagegroup -Server KINGKONG" + " -LogFolderPath c:\\rsg\\logs -Name RecoveryGroup -SystemFolderPath c:\\rsg\\data -Recovery"; //Create an instance of the Command class by using the name of the cmdlet that you want to run Command myCommand = new Command(strScript); //Add the command to the Commands collection of the pipeline. pipeline.Commands.Add(myCommand); Collection results = pipeline.Invoke();
