[site]: stackoverflow
[post_id]: 3317795
[parent_id]: 3317750
[tags]: 
You can do one query to get the distinct types, and LEFT JOIN the same table, checking for type-inequality: SELECT t1.type, SUM(t2.some_value) / COUNT(t2.type) FROM ( SELECT DISTINCT type FROM temptable ) t1 LEFT JOIN temptable t2 ON ( t1.type <> t2.type ) GROUP BY t1.type Since you only want the average, you could replace the line FROM ( SELECT DISTINCT type FROM temptable ) t1 by FROM temptable t1 but the first solution might perform better, since the number of rows is reduced earlier.
