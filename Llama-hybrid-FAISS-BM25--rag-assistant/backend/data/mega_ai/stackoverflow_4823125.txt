[site]: stackoverflow
[post_id]: 4823125
[parent_id]: 4807049
[tags]: 
Not sure on the exact cause, but may be able to help ya find your way. WebDeploy uses two entry points based on the configuration of the remote server, namely whether its running IIS6 or IIS7. IIS 7 uses the IIS deployment handler , which is managed by the Web Management Service and allows msdeploy to directly provision IIS. All the "management service delegation", etc settings relate to this setup. IIS 6, however, doesn't have the web management service so the handler will not work. For IIS6 targets, a service called the MS Deploy Agent Service is used. Whats odd is that your setup suggests your are using IIS 7, as you were able to set delgation settings, etc. However, that url, "/MSDEPLOYAGENTSERVICE" suggests that your machine is attempting to use the service ... almost as if it thinks its IIS 6. The service requires admin access, which is why you are getting that error. Based on the error it looks like you are invoking this from MSbuild, likely directly from Visual Studio. You may want to look around the settings you are given and see if anything in there is causing this path and/or server selection. Also make sure the Web Management Service is running on the remote machine. Basically you're wanting to see it make deploy calls to a different url, http://<>/msdeploy.axd (if I remember correctly) to properly invoke the handler.
