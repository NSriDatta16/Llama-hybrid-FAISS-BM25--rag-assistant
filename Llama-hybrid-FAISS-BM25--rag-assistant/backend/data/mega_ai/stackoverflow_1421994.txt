[site]: stackoverflow
[post_id]: 1421994
[parent_id]: 
[tags]: 
Enterprise Manager Errors on Oracle 10g2 on Windows

Problem Enterprise Manager starts and then hangs. Environment RAC installation on Windows, comprised of two nodes, node1 and node2. Enterprise Manager is installed on node1. We are able to get dbconsole to run briefly and and then it fails. emagent.trc from node1 shows what appear to be two sets of relevant errors. The first set of errors regard an inability to connect to the EM repository (which is on the same node). The second error is associated with the "Instance Health Check initialization failed". emagent.trc (node1) Thread-5548 ERROR fetchlets.healthCheck: GIM-00105: Shared memory region is corrupted. Thread-5548 ERROR engine: [oracle_database,clustername_node1name,health_check] : nmeegd_GetMetricData failed : Instance Health Check initialization failed due to one of the following causes: the owner of the EM agent process is not same as the owner of the Oracle instance processes; the owner of the EM agent process is not part of the dba group; or the database version is not 10g (10.1.0.2) and above. Thread-5668 WARN http: snmehl_connect: connect failed to (node1:1158): No connection could be made because the target machine actively refused it. Thread-5668 ERROR pingManager: nmepm_pingReposURL: Cannot connect to https://node1:1158/em/upload/ : retStatus=-1 Thread-5708 ERROR upload: FxferSend: Cannot connect to: https://node1:1158/em/upload/ . retStatus=-1 Thread-5708 ERROR upload: Failed to upload file B0000109.xml, ret = -2 I would like to get advice about how to proceed to troubleshoot these two errors in hopes of getting EM to start and stay up. Regarding the first error, how would one troubleshoot an inability to connect to a web page running on the same node? This would appear to rule out firewall issues, etc. as a cause. Regarding the second error, dbconsole and agent were started manually from the command line using a domain account, whereas the Oracle service runs under Local System (dbconsole was configured to use Local System on startup but failed, and can only be restarted via emctl start dbconsole.)
