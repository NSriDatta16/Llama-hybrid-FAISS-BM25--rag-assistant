[site]: crossvalidated
[post_id]: 606565
[parent_id]: 606556
[tags]: 
Denote $\operatorname{E}_n$ the expected number of steps to go from state $n$ to state $3$ . We are interested in $\operatorname{E}_0$ . Now we can set up the following recurrence equations: \begin{align} \operatorname{E}_0 & = 1 + 0.65\operatorname{E}_0 + 0.1575\operatorname{E}_1+0.105\operatorname{E}_2 \\ \operatorname{E}_1 & = 1 + 0.65\operatorname{E}_1 + 0.2625\operatorname{E}_2 \\ \operatorname{E}_2 & = 1 + 0.65\operatorname{E}_2 \\ \operatorname{E}_3 & = 0 \end{align} ( $\operatorname{E}_3$ is not really needed, but included for clarity). Solving for $\operatorname{E}_0$ , I get $5.96429$ . So you need on average roughly $6$ instances to get from state $0$ to state $3$ . A small simulation is in excellent agreement with this analytic result (the R code for the simulation is at the bottom of the answer). You could also employ the machinery of Markov chains, as illustrated in my answer here . What you're looking for is called mean absorption time starting from state $0$ . Your transition matrix is: $$\mathbb{P} = \pmatrix{0.65 & 0.1575 & 0.105 & 0.0875 \\ 0 & 0.65 & 0.2625 & 0.0875 \\ 0 & 0 & 0.65 & 0.35 \\ 0 & 0 & 0 & 1}$$ The fundamental matrix is $\mathbf{N}=(\mathbf{I}_3 - \mathbf{Q})^{-1}$ , where $\mathbf{I}_3$ is an identity matrix and $\mathbf{Q}$ is the $3$ -by- $3$ transition matrix of the non-absorbing states. In your example: $$ \mathbf{N} = \pmatrix{2.857143 & 1.285714 & 1.821429 \\ 0 & 2.857143 & 2.142857 \\ 0 & 0 & 2.857143} $$ The expected number of steps to absorption when starting in transient state $i$ is the $i$ th entry of the vector $$ \mathbf{t} = \mathbf{N}\mathbf{1} $$ where $\mathbf{1}$ is a length- $t$ column vector with all $1$ s. Applied to our example we get: $$ \mathbf{t} = \pmatrix{5.964 \\ 5.000 \\ 2.857} $$ This confirms the result from above. In R , there is the convenient package markovchain that simplifies these calculations for you: library(markovchain) # Transition matrix tm The variance of the number of instances could also be of interest. We get it by the following formula: $$ \left(2\mathbf{N} - \mathbf{I}_{3}\right)\mathbf{t} - \mathbf{t}\circ\mathbf{t} $$ where $\circ$ denotes the Hadamard product (element-wise product). For the example this evaluates to: $$ \pmatrix{15.81 \\ 10.82 \\ 5.31} $$ Starting at state $0$ , the variance of the number of steps until reaching state $3$ is $15.81$ . Again, this is in excellent agreement with a simulation. Finally, here is the R code for the simulation with $100\,000$ repetitions: set.seed(142857) res
