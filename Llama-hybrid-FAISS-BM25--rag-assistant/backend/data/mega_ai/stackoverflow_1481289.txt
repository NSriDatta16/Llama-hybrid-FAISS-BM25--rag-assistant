[site]: stackoverflow
[post_id]: 1481289
[parent_id]: 1261557
[tags]: 
Writing Swing apps, the JMenuBar stuff is always annoying. Thanks to dorun/map it's much easier: (let [menus [ {:name "File" :mnemonic \F :items [ {:name "Open" :mnemonic \O :fn file-open} :separator {:name "Exit" :mnemonic \x :fn file-exit} ] } {:name "Help" :mnemonic \H :items [ :separator {:name "About..." :mnemonic \A :fn help-about} ] } ] menu-fns (into {} (mapcat (fn [menu] (map (fn [item] [(:name item) (:fn item)]) (:items menu))) menus)) ui-frame (proxy [JFrame ActionListener] ["UI Frame"] (actionPerformed [event] (let [command (.getActionCommand event) menu-fn (get menu-fns command)] ;; Handle menu commands (if menu-fn (apply menu-fn [this])) )) ) ] (defn new-menu [listener] (let [menubar (JMenuBar.)] (dorun (map (fn [x] (let [menu (JMenu. (:name x))] (.setMnemonic menu (int (:mnemonic x))) (.add menubar menu) (dorun (map (fn [item] (if (= :separator item) (.addSeparator menu) (let [menu-item (if (:mnemonic item) (JMenuItem. (:name item) (int (:mnemonic item))) (JMenuItem. (:name item)))] (.addActionListener menu-item listener) (.add menu menu-item)))) (:items x))))) menus)) menubar)) Right now I don't need sub-menus, but it's a trivial change to new-menu to get them. Also adding icons, active/inactive state, etc. is just more fields in menus .
