[site]: stackoverflow
[post_id]: 4300705
[parent_id]: 4300663
[tags]: 
I'm taking a wild guess here, but if you dynamically allocating the matrices makes such a huge difference, maybe the problem is fragmentation. Again, I've no idea how the underlying matrix is implemented. Why don't you allocate the memory for the matrices by hand, ensuring it's contiguous, and build the pointer structure yourself? Also, does the dim() method have any extra complexity? I would declare it inline, too.
