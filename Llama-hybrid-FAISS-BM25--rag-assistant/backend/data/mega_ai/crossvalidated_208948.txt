[site]: crossvalidated
[post_id]: 208948
[parent_id]: 
[tags]: 
Probability distribution transformation of variables question

Problem: Hi there, I'm stuck trying to derive an equation stated in a research paper relating to Bayesian statistics in Cosmology (the paper is: http://mnras.oxfordjournals.org/content/398/4/2049.full.pdf , and it's equation 22, page 4). They have a joint prior, $ \pi(M_{g}, z) $, which they rewrite as: \begin{equation} \label{one} \tag{1} \pi(M_{g}, z) = \int_{0}^{1} \pi(f_{g}) \pi(M = M_{g} / f_{g}, z) \frac{df_{g}}{f_{g}} \end{equation} Here $M$, $M_{g}$ and $f_{g}$ are related through the equation $ M_{g} = f_{g} \times M$, and $f_{g}$ takes values in the range $[0, 1] $. In the paper it says that $f_{g}$ is unknown, but is known to have some prior $\pi(f_{g})$. Also it says that $f_{g}$ and $z$ are independent of each other. My attempt at the solution: For starters I think that one can switch between $\pi(M_{g},z, f_{g})$ and $\pi(M,f_{g},z)$ through: \begin{equation} \label{two} \tag{2} \pi(M_{g},f_{g},z) \propto \bigg| \frac{\partial M}{\partial M_{g}} \bigg| \, \pi(M,f_{g},z) \\= \frac{1}{f_{g}} \pi(M,f_{g},z) \end{equation} I also know that: \begin{equation} \label{three} \tag{3} \pi(M_{g}, z) = \int_{0}^{1} \pi(M_{g}, f_{g},z) \, df_{g} \\ = \int_{0}^{1} \pi(M,f_{g},z) \, \frac{df_{g}}{f_{g}} \end{equation} But the trouble comes when I essentially try and write $\pi(M, f_{g},z)$ as $ \pi(f_{g}) \pi(M = M_{g} / f_{g}, z)$ (assuming I'm correct up to this point). I've tried using the chain rule of probability, e.g.: \begin{equation} \label{four} \tag{4} \pi(M, f_{g},z) = \pi(M | f_{g},z) \pi(f_{g},z) = \pi(M | f_{g}, z) \pi (f_{g} | z) \pi(z) \\= \pi(M | f_{g}, z) \pi (f_{g}) \pi(z) \space \space \end{equation} I've tried God knows how many permutations of applying this rule to no avail. I would really appreciate it if anyone could let me know if what I've done up to applying the chain rule is correct, and if so, any advice on how to proceed from here. Thanks in advance. Update: I can also write: \begin{equation} \label{five} \tag{5} \pi(M, f_{g}, z) = \pi(M, z | f_{g}) \pi(f_{g}) = \pi(M | z, f_{g}) \pi(z | f_{g}) \pi(f_{g})\\ = \pi(M | z, f_{g}) \pi(z) \pi(f_{g}) \end{equation} So that I get the expression: \begin{equation} \label{six} \tag{6} \pi(M | z, f_{g}) = \frac{ \pi(M, z | f_{g})}{\pi(z)} \end{equation} Substituting this into equation \ref{four}, and subbing that result into equation \ref{three} yields the result: \begin{equation} \label{seven} \tag{7} \pi(M_{g}, z) = \int_{0}^{1} \pi(M, z | f_{g}) \pi(f_{g}) \, \frac{df_{g}}{f_{g}} \end{equation} Which isn't correct.
