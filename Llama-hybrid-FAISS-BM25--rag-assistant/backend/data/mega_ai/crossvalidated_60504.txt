[site]: crossvalidated
[post_id]: 60504
[parent_id]: 60500
[tags]: 
It can be done with linear regression - You just need both a $\sin$ and a $\cos$ term at each frequency. The reason why you can use a $\sin$ and $\cos$ term in a linear regression to handle seasonality with any amplitude and phase is because of the following trigonometric identity : A 'general' sine wave with amplitude $A$ and phase $\varphi$ , $A \sin (x + \varphi)$ , can be written as the linear combination $a\sin x+b\cos x$ where $a$ and $b$ are such that $A=\sqrt{a^2+b^2}$ and $\sin\varphi = \frac{b}{\sqrt{a^2+b^2}}$ . Let's see that the two are equivalent: \begin{eqnarray} a \sin(x) + b \cos(x) &=& \sqrt{a^2+b^2} \left(\frac{a}{\sqrt{a^2+b^2}} \sin(x) + \frac{b}{\sqrt{a^2+b^2}} \cos(x)\right)\\ &=& A\left[\sin(x)\cos(\varphi) + \cos(x)\sin(\varphi)\right]\\ &=& A\sin(x+\varphi)\,\text{.} \end{eqnarray} Here's the 'basic' model: SSTlm [snip] Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 8.292 0.135 61.41 $ToY,SSTlm$ fitted,col=2) Edit: Important note - the $2\pi\,t$ term works because the period of the function has been set up so that one period = 1 unit of $t$ . If the period is different from 1, say the period is $\omega$ , then you need $(2\pi/\omega)\, t$ instead. Here's the model with the second harmonic: SSTlm2 [snip] Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 8.29167 0.02637 314.450 ... and so forth, with 6*pi*ToY etc. If there was a tiny bit of noise in the data I'd probably stop with this second model though. With enough terms, you can exactly fit asymmetric and even jagged periodic sequences, but the resulting fits may 'wiggle'. Here's an asymmetric function (it's a sawtooth - ) added to a scaled version of your periodic function), with third (red) and fourth (green) harmonics. The green fit is on average a little closer but "wiggly" (even when the fit goes through every point, the fit may be very wiggly between points). The periodicity here means there's only 12 d.f. available for a seasonal model in the data. With the intercept in the model, you only have enough degrees of freedom for 11 additional seasonal parameters. Since you are adding two terms with each harmonic, the last harmonic you can fit will only allow you one of them for the last term, the sixth harmonic (and that one has to be a $\cos$ ; the $\sin$ term will be all-zero, while the cos alternates between 1 and -1). If you want fits that are smoother than this approach produces on non-smooth series, you may want to look into periodic spline fits. Yet another approach is to use seasonal dummies, but the sin/cos approach is often better if it's a smooth periodic function. This kind of approach to seasonality can also adapt to situations where seasonality is changing, such as using trigonometric or dummy seasonality with state-space models. While the linear model approach discussed here is simple to use, one advantage of @COOLSerdash's nonlinear regression approach is that it can deal with a much wider range of situations - you don't have to change much before you're in a situation where linear regression is no longer suitable but nonlinear least-squares may still be used (having an unknown period would be one such case).
