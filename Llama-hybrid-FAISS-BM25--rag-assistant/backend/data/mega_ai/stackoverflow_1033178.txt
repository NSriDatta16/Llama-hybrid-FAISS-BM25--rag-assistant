[site]: stackoverflow
[post_id]: 1033178
[parent_id]: 
[tags]: 
WinInet POST via SSL (HTTPS) with pure C?

I'm stuck trying to get a WinInet HTTP POST via SSL using ONLY C. I know it's possible. Any good sample code? Thanks so much! EDIT: the following code seems to be working OK under C++ using WinHTTP but I need WinInet: TCHAR szTemp[512] = {0}; BOOL bRet = FALSE; HINTERNET hRequest = NULL; HINTERNET hSession = NULL; HINTERNET hConnect = NULL; CERT_CONTEXT *pCert = {0}; HCERTSTORE hCertStore = NULL; DWORD dwRet = 0; DWORD dwLen = 0; DWORD dwFlags = SECURITY_FLAG_IGNORE_CERT_CN_INVALID| SECURITY_FLAG_IGNORE_CERT_DATE_INVALID| SECURITY_FLAG_IGNORE_UNKNOWN_CA; CString szUserAgent("Mozilla/4.0 (compatible; MSIE 5.22)"); if ( m_csServer.GetLength() dwCertEncodingType & X509_ASN_ENCODING ) { OutputDebugString( _T("X509_ASN_ENCODING") ); } if ( pCert->dwCertEncodingType & PKCS_7_ASN_ENCODING ) { OutputDebugString( _T("PKCS_7_ASN_ENCODING") ); } _stprintf_s( szTemp, 512, _T("encoded_size: %ld"), pCert->cbCertEncoded ); OutputDebugString( szTemp ); hCertStore = CertOpenStore( CERT_STORE_PROV_SYSTEM, 0, 0, CERT_STORE_OPEN_EXISTING_FLAG | CERT_SYSTEM_STORE_LOCAL_MACHINE, L"Root"); bRet = CertAddCertificateContextToStore( hCertStore, pCert, CERT_STORE_ADD_REPLACE_EXISTING, NULL ); CertFreeCertificateContext(pCert); bRet = CertCloseStore( hCertStore, 0 ); ::MessageBox( NULL, _T("Certificate Added to Store"), _T("Registered"), MB_OK ); OutputDebugString ( _T("closed store") ); } else { dwRet = GetLastError(); _stprintf_s( szTemp, 512, _T("WinHttpQueryOption Fails - err: 0x%x"), dwRet ); ::MessageBox(NULL, szTemp, _T("ERROR"), MB_OK ); } WinHttpCloseHandle( hRequest ); WinHttpCloseHandle( hConnect ); WinHttpCloseHandle( hSession );
