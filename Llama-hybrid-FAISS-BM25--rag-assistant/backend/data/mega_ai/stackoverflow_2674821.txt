[site]: stackoverflow
[post_id]: 2674821
[parent_id]: 2665655
[tags]: 
For completion, I post the full code. It pulls availability information about our production servers from a database for a management report. It's the most complicated thing I have done in JSP yet :) I am sure lots of things could be done more elegantly, so please feel free to advise :) (obviously db passwords etc are XXX'ed out) KPI: FY10 1270080000000 and timestamp IITP Availability Report KPI Name Description Sep Oct Nov Dec Jan Feb Mar Apr May Jun Jul Aug Avg &nbsp &nbsp Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail Mins Down % Avail " + rs_names.getString("KPI_GROUP_NAME") + " " + rs_names.getString("DESCRIPTION") + " "); } rs_names.close(); // get the number of minutes down for each month and availability % PreparedStatement ps_minsDown = conn.prepareStatement("select count(timestamp) from jagel_hq_log where timestamp > ? and timestamp " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //October startTime = (Long) hm.get("9_start"); endTime = (Long) hm.get("9_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsOct*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //November startTime = (Long) hm.get("10_start"); endTime = (Long) hm.get("10_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsNov*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //December startTime = (Long) hm.get("11_start"); endTime = (Long) hm.get("11_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsDec*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //January startTime = (Long) hm.get("0_start"); endTime = (Long) hm.get("0_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsJan*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //February startTime = (Long) hm.get("1_start"); endTime = (Long) hm.get("1_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsFeb*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //March startTime = (Long) hm.get("2_start"); endTime = (Long) hm.get("2_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsMar*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //April startTime = (Long) hm.get("3_start"); endTime = (Long) hm.get("3_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsApr*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //May startTime = (Long) hm.get("4_start"); endTime = (Long) hm.get("4_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsMay*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //June startTime = (Long) hm.get("5_start"); endTime = (Long) hm.get("5_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsMay*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //July startTime = (Long) hm.get("6_start"); endTime = (Long) hm.get("6_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsJul*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //August startTime = (Long) hm.get("7_start"); endTime = (Long) hm.get("7_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsAug*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); //YEAR startTime = (Long) hm.get("8_start"); endTime = (Long) hm.get("7_end"); ps_minsDown.setLong(1,startTime); ps_minsDown.setLong(2,endTime); rs_minsDown = ps_minsDown.executeQuery(); rs_minsDown.next(); mins_down = rs_minsDown.getInt("COUNT(TIMESTAMP)"); avail = 100-(mins_down/minsYear*100); if(avail " + mins_down + " " + round.format(avail) + "%"); rs_minsDown.close(); } // close remaining result set and connection rs_id.close(); conn.close(); %>
