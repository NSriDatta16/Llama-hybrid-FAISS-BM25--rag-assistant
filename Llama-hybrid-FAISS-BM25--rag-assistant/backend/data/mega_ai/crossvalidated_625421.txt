[site]: crossvalidated
[post_id]: 625421
[parent_id]: 
[tags]: 
Bivariate State Space Model Using R Package DLM. Modelling correlation

I am trying to estimate a bivariate dynamic linear model. The data are public sector wages and private sector wages in the UK which we can assume are highly correlated. That is, a seemingly unrelated time series (SUTSE) model. The heart of my query is that I can define a model without modelling this correlation, but I need some advice to model the correlation. For reproducibility the first 100 observations are: structure(c(308.290861533774, 316.530684266741, 331.743888321629, 306.594956294593, 306.027101001177, 307.076661177941, 308.76716302708, 306.690852083589, 307.433090292997, 306.986245592844, 309.995051318672, 328.681605277824, 327.195905121307, 347.15245555423, 347.964828827004, 324.364734228554, 320.217899800899, 325.110944448259, 323.34283388995, 320.820032959977, 320.100668840809, 320.753753462972, 323.222759349371, 337.27939496862, 338.12827654662, 355.677421696664, 355.901271268778, 335.755672050744, 331.793925944446, 337.150458261689, 335.980595549076, 330.87641788809, 330.188102027769, 330.151057982586, 331.207894731129, 342.869144038744, 344.858279180566, 362.425420300597, 373.191779367584, 342.650749718257, 340.168343874673, 343.818263492479, 344.136528156412, 338.562073850514, 340.280968645349, 342.42188483732, 342.363805341863, 355.138782969626, 375.103722845661, 375.331658230003, 386.980660179696, 355.753018763449, 355.035915711533, 358.13737176751, 356.716793518281, 353.617290393461, 353.730920593921, 355.982080718409, 355.646558476037, 369.930772123952, 391.54084533459, 400.118529756671, 402.358447659466, 369.692202668389, 366.485965661834, 372.847231937349, 372.766334714432, 370.69354321552, 369.622582600347, 369.160362701586, 371.093215009388, 385.13268581394, 404.041175750573, 427.310737680386, 429.170489909942, 385.592382206257, 384.485370157067, 395.388917109155, 390.974271511583, 385.036800592964, 384.397179042557, 386.046281843303, 387.851696831092, 409.779975994435, 432.104085671683, 465.490307433595, 450.264212741427, 402.301786627284, 402.777053922304, 412.998869184765, 410.940062015464, 406.266667619616, 407.906970487913, 403.905424431376, 407.918831525952, 422.633537720574, 448.303917729157, 487.531964828376, 473.372407741, 422.413122266053, 310.0324461, 313.4964538, 309.9609878, 312.5021811, 313.1695897, 315.8483268, 314.8703445, 316.0584774, 315.2649533, 315.3843857, 317.5891229, 318.3495274, 318.9433656, 320.9225182, 323.1526821, 330.7448764, 331.2694976, 333.381977, 335.105811, 337.737461, 334.8955832, 334.4042485, 332.9823066, 335.5708839, 333.9666149, 334.3330305, 335.2132755, 342.2402084, 343.1987542, 345.2481832, 346.9219502, 343.8244583, 345.5552652, 351.4121678, 354.0166457, 352.9979363, 347.7197493, 348.6557524, 350.1811226, 357.0886325, 356.6568806, 361.7754789, 363.6351258, 369.2773349, 365.2846702, 363.627172, 365.683382, 368.9107804, 363.0978998, 364.9628407, 365.7322735, 373.3295851, 373.9703394, 380.1124834, 376.6738597, 382.4596607, 381.3616279, 380.6622901, 381.540223, 385.6347144, 381.9888352, 381.4113695, 385.7814637, 393.7371213, 403.8461312, 397.9705898, 396.3573552, 398.6920221, 398.7026547, 399.2584819, 400.5386078, 407.3677186, 400.0215383, 405.2682142, 401.3654417, 405.9010092, 417.9745845, 411.3067436, 411.7957221, 410.5059509, 409.549643, 410.7160315, 412.7244427, 421.3791563, 414.6155914, 414.4085346, 415.034459, 420.8151987, 435.4162418, 424.6476909, 421.355185, 423.8080039, 422.5625015, 422.1561807, 433.0509514, 439.5683304, 426.6424095, 429.0802868, 430.3101237, 437.1621518), dim = c(100L, 2L), dimnames = list(NULL, c("Private Sector", "Public Sector"))) Now, to build the model without correlation assumed between the series, I have produced the following: # Build the univariate model uni Now to provide initial values for MLE estimation, I have come up with the following: # Set up initial guesses for parameters intercept_initial = mean(wage_ts) # Initial guess for intercept (trend component) linear_coeff_initial = 0.1 # Initial guess for linear coefficient (trend component) quadratic_coeff_initial = 0.01 # Initial guess for quadratic coefficient (trend component) seasonal_initial = rep(0, 12) # Initial guesses for seasonal component (12 months) log_variance_initial_trend = log(0.1) # Initial guess for log variance (dV) parameter in trend component log_variance_initial_seas = log(0.1) # Initial guess for log variance (dV) parameter in seasonal component psi_initial Finally, I estimate the model with the following code. wages_est As noted, this works, but it does not model the correlation. What I think I need is to redefine the buildSUTSE function. I would suggest the following, but this gives an error: # Define the build function for MLE buildSUTSE Then provide initial values and estimate the model with the following: # Set up initial guesses for parameters intercept_initial The error I get using the following is: Error in `W
