[site]: crossvalidated
[post_id]: 544467
[parent_id]: 
[tags]: 
How to get corrected residuals from nlme::gls model with AR1 structure in R

I am new to time series analysis. I am trying to use nlme::gls to add an AR1 structure to a regression model. I'd like to look at the autocorrelation of the residuals with and without this structure applied. However, the residuals() function appears to give uncorrected residuals (ie., before applying to the AR1 structure). How can I generate the corrected residuals? MWE is below. set.seed(1) x
