[site]: crossvalidated
[post_id]: 486468
[parent_id]: 486118
[tags]: 
Your first model, with y ~ s(time) isn't valid as it failed to account for a lot of the structure in the data. Simply identifying that on average over all the startups there is no non-linear effect isn't the same as saying that the individual effects are non-linear either. If you want to decompose a linear and non linear effect, you can fit models of the form ~ time + s(time, m = c(2,0)) where the m specification keeps the second order penalty but removes the null space ( 0 ). This latter step means that the linear term is excluded from the basis, which is what you want if you already have a linear parametric time effect. But I think this might be too complex to include whilst trying to identify the other structures. As the linear fit is included in s(time) , I would just include it through the smooth, figure out the other structures and then once you have the rest of the model as you want it, you can replace s(time) with time + s(time, m = c(2,0)) for the explicit test of linear vs non-linear change in time. For the first hypothesis, I would fit this model: y ~ time + s(time, m = c(2,0)) + s(tid, bs = 're') + s(tid, time, bs = 're') + s(time, tis, bs = 'fs', m = c(2,0)) The only overlap I believe here will be the random intercepts, but I think that is OK. As that accounts for the clustering at the tid level As for "e)", you are testing for temporally varying effects of X ; you could add them to the model above and see what happens. If you leave off the last smooth, the fs term, and include the ti(time, X) term, that's fine, but I would keep the two re terms or perhaps only just the s(tid, bs = 're') , as that reflects group structure that you don't want being explained by the global time-vary effects of X . I would then check the residuals and plot them against tid and time to see if there is unmodelled temporal structure which might invalidate the assumptions of the model (and thus the tests of the terms in the model). With such limited data, it may not be possible to identify time varying effects of covariates and account for the clustering at the startup level. It also sounds like you are testing X1 first, then removing it and adding X2 , testing that and so on. If so I don't think that is a valid way to proceed.
