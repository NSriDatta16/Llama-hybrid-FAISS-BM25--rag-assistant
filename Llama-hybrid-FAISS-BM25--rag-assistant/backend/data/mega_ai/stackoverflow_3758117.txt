[site]: stackoverflow
[post_id]: 3758117
[parent_id]: 
[tags]: 
How to handle unused Managed Metadata Terms without a WssId?

The Problem We upload (large amounts of) files to SharePoint using FrontPage RPC ( put documents call). As far as we've been able to find out, setting the value of taxonomy fields through this protocol requires their WssId . The problem is that unless terms have been explicitly used before on a listitem, they don´t seem to have a WSS ID. This causes uploading documents with previously unused metadata terms to fail. The Code The call TaxonomyField.GetWssIdsOfTerm in the code snippet below simply doesn´t return an ID for those terms. SPSite site = new SPSite( "http://some.site.com/foo/bar" ); SPWeb web = site.OpenWeb(); TaxonomySession session = new TaxonomySession( site ); TermStore termStore = session.TermStores[new Guid( "3ead46e7-6bb2-4a54-8cf5-497fc7229697" )]; TermSet termSet = termStore.GetTermSet( new Guid( "f21ac592-5e51-49d0-88a8-50be7682de55" ) ); Guid termId = new Guid( "a40d53ed-a017-4fcd-a2f3-4c709272eee4" ); int[] wssIds = TaxonomyField.GetWssIdsOfTerm( site, termStore.Id, termSet.Id, termId, false, 1); foreach( int wssId in wssIds ) { Console.WriteLine( wssId ); } We also tried querying the taxonomy hidden list directly, with similar results. The Cry For Help Both confirmation and advice on how to tackle this would be appreciated. I see three possible routes to a solution: Change the way we are uploading, either by uploading the terms in a different way, or by switching to a different protocol. Query for the metadata WssIds in a different way. One that works for unused terms. Write/find a tool to preresolve WssIds for all terms. Suggestions on how to do this elegantly are most welcome.
