[site]: crossvalidated
[post_id]: 544407
[parent_id]: 
[tags]: 
leaps for stepwise selection: issues with factor variables

I'm trying to use the forward stepwise selection from the package leaps in order to choose the best predictors for a logistic regression. This is the structure of my database spec_tbl_df [7,397 x 19] (S3: spec_tbl_df/tbl_df/tbl/data.frame) $ X1 : num [1:7397] 9617 12179 9905 5745 10067 ... $ Administrative : num [1:7397] 5 26 4 3 7 16 4 3 2 0 ... $ Administrative_Duration: num [1:7397] 408 1562 58 103 165 ... $ Informational : num [1:7397] 2 9 2 0 1 3 4 5 0 0 ... $ Informational_Duration : num [1:7397] 47.5 503.7 28.5 0 28.5 ... $ ProductRelated : num [1:7397] 54 183 82 25 115 86 75 23 27 33 ... $ ProductRelated_Duration: num [1:7397] 1547 9676 4729 1109 3428 ... $ BounceRates : num [1:7397] 0 0.0111 0 0 0 ... $ ExitRates : num [1:7397] 0.01733 0.0142 0.01454 0.00167 0.01629 ... $ PageValues : num [1:7397] 0 19.57 9.06 61.3 4.97 ... $ SpecialDay : num [1:7397] 0 0 0 0 0 0 0 0 0 0 ... $ Month : Factor w/ 10 levels "Aug","Dec","Feb",..: 8 8 8 1 8 4 8 7 8 8 ... $ OperatingSystems : Factor w/ 8 levels "1","2","3","4",..: 2 3 2 2 2 3 3 4 8 2 ... $ Browser : Factor w/ 13 levels "1","2","3","4",..: 2 2 2 2 2 2 2 1 2 5 ... $ Region : Factor w/ 9 levels "1","2","3","4",..: 3 2 1 6 4 8 1 1 7 3 ... $ TrafficType : Factor w/ 19 levels "1","2","3","4",..: 2 12 2 5 10 4 2 4 2 1 ... $ VisitorType : Factor w/ 3 levels "New_Visitor",..: 3 3 3 1 3 3 3 3 1 3 ... $ Weekend : Factor w/ 2 levels "FALSE","TRUE": 2 1 1 1 1 1 1 1 1 1 ... $ Revenue : Factor w/ 2 levels "FALSE","TRUE": 2 2 2 2 2 2 2 2 2 2 ... The target variable to be predicted is Revenue (which is a factor variable that takes only 2 boolean values). The first time I run the function it showed up the months inside the variable "Month" as they were predictors. Same for the variable "Visitor Type" and for "Weekend", but not for "Region" (so I assume you can actually use factor variables with leaps). Below the code and the output: fwd.regfit=regsubsets(Revenue~. ,shoppers_train, method = "forward", nvmax = 20) summary.fwd.regfit=summary(fwd.regfit) summary.fwd.regfit 1 subsets of each size up to 20 Selection Algorithm: forward X1 Administrative Administrative_Duration Informational Informational_Duration ProductRelated ProductRelated_Duration 1 ( 1 ) " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " "*" 5 ( 1 ) " " " " " " " " " " " " "*" 6 ( 1 ) " " "*" " " " " " " " " "*" 7 ( 1 ) " " "*" " " " " " " " " "*" 8 ( 1 ) " " "*" " " " " " " " " "*" 9 ( 1 ) " " "*" " " " " " " " " "*" 10 ( 1 ) " " "*" " " " " " " " " "*" 11 ( 1 ) " " "*" " " " " " " " " "*" 12 ( 1 ) " " "*" " " " " " " " " "*" 13 ( 1 ) " " "*" " " " " " " " " "*" 14 ( 1 ) " " "*" " " "*" " " " " "*" 15 ( 1 ) " " "*" " " "*" " " " " "*" 16 ( 1 ) " " "*" " " "*" " " " " "*" 17 ( 1 ) " " "*" " " "*" " " " " "*" 18 ( 1 ) "*" "*" " " "*" " " " " "*" 19 ( 1 ) "*" "*" " " "*" " " " " "*" 20 ( 1 ) "*" "*" " " "*" " " " " "*" BounceRates ExitRates PageValues SpecialDay MonthDec MonthFeb MonthJul MonthJune MonthMar MonthMay MonthNov MonthOct 1 ( 1 ) " " " " "*" " " " " " " " " " " " " " " " " " " 2 ( 1 ) " " " " "*" " " " " " " " " " " " " " " "*" " " 3 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 4 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 5 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 6 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 7 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 8 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 9 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 10 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 11 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" " " 12 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" " " 13 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" "*" 14 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" "*" 15 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" "*" 16 ( 1 ) "*" "*" "*" "*" " " " " "*" " " " " " " "*" "*" 17 ( 1 ) "*" "*" "*" "*" "*" " " "*" " " " " " " "*" "*" 18 ( 1 ) "*" "*" "*" "*" "*" " " "*" " " " " " " "*" "*" 19 ( 1 ) "*" "*" "*" "*" "*" " " "*" " " " " "*" "*" "*" 20 ( 1 ) "*" "*" "*" "*" "*" " " "*" "*" " " "*" "*" "*" MonthSep OperatingSystems Browser Region TrafficType VisitorTypeOther VisitorTypeReturning_Visitor WeekendTRUE 1 ( 1 ) " " " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " " " " " 5 ( 1 ) " " " " " " " " " " " " "*" " " 6 ( 1 ) " " " " " " " " " " " " "*" " " 7 ( 1 ) " " " " " " " " " " " " "*" " " 8 ( 1 ) " " " " " " " " " " " " "*" "*" 9 ( 1 ) " " "*" " " " " " " " " "*" "*" 10 ( 1 ) " " "*" "*" " " " " " " "*" "*" 11 ( 1 ) " " "*" "*" " " " " " " "*" "*" 12 ( 1 ) " " "*" "*" "*" " " " " "*" "*" 13 ( 1 ) " " "*" "*" "*" " " " " "*" "*" 14 ( 1 ) " " "*" "*" "*" " " " " "*" "*" 15 ( 1 ) "*" "*" "*" "*" " " " " "*" "*" 16 ( 1 ) "*" "*" "*" "*" " " " " "*" "*" 17 ( 1 ) "*" "*" "*" "*" " " " " "*" "*" 18 ( 1 ) "*" "*" "*" "*" " " " " "*" "*" 19 ( 1 ) "*" "*" "*" "*" " " " " "*" "*" 20 ( 1 ) "*" "*" "*" "*" " " " " "*" "*" After some reasearch online I tried to use the function "ungroup" on my tibble database. Terrible idea, things got worse: Subset selection object Call: regsubsets.formula(Revenue ~ ., shoppers_train, method = "forward", nvmax = 20) 68 Variables (and intercept) Forced in Forced out X1 FALSE FALSE Administrative FALSE FALSE Administrative_Duration FALSE FALSE Informational FALSE FALSE Informational_Duration FALSE FALSE ProductRelated FALSE FALSE ProductRelated_Duration FALSE FALSE BounceRates FALSE FALSE ExitRates FALSE FALSE PageValues FALSE FALSE SpecialDay FALSE FALSE MonthDec FALSE FALSE MonthFeb FALSE FALSE MonthJul FALSE FALSE MonthJune FALSE FALSE MonthMar FALSE FALSE MonthMay FALSE FALSE MonthNov FALSE FALSE MonthOct FALSE FALSE MonthSep FALSE FALSE OperatingSystems2 FALSE FALSE OperatingSystems3 FALSE FALSE OperatingSystems4 FALSE FALSE OperatingSystems5 FALSE FALSE OperatingSystems6 FALSE FALSE OperatingSystems7 FALSE FALSE OperatingSystems8 FALSE FALSE Browser2 FALSE FALSE Browser3 FALSE FALSE Browser4 FALSE FALSE Browser5 FALSE FALSE Browser6 FALSE FALSE Browser7 FALSE FALSE Browser8 FALSE FALSE Browser9 FALSE FALSE Browser10 FALSE FALSE Browser12 FALSE FALSE Browser13 FALSE FALSE Region2 FALSE FALSE Region3 FALSE FALSE Region4 FALSE FALSE Region5 FALSE FALSE Region6 FALSE FALSE Region7 FALSE FALSE Region8 FALSE FALSE Region9 FALSE FALSE TrafficType2 FALSE FALSE TrafficType3 FALSE FALSE TrafficType4 FALSE FALSE TrafficType5 FALSE FALSE TrafficType6 FALSE FALSE TrafficType7 FALSE FALSE TrafficType8 FALSE FALSE TrafficType9 FALSE FALSE TrafficType10 FALSE FALSE TrafficType11 FALSE FALSE TrafficType13 FALSE FALSE TrafficType14 FALSE FALSE TrafficType15 FALSE FALSE TrafficType16 FALSE FALSE TrafficType17 FALSE FALSE TrafficType18 FALSE FALSE TrafficType19 FALSE FALSE TrafficType20 FALSE FALSE VisitorTypeOther FALSE FALSE VisitorTypeReturning_Visitor FALSE FALSE WeekendTRUE FALSE FALSE Browser11 FALSE FALSE 1 subsets of each size up to 21 Selection Algorithm: forward X1 Administrative Administrative_Duration Informational Informational_Duration ProductRelated ProductRelated_Duration 1 ( 1 ) " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " "*" 5 ( 1 ) " " " " " " " " " " " " "*" 6 ( 1 ) " " "*" " " " " " " " " "*" 7 ( 1 ) " " "*" " " " " " " " " "*" 8 ( 1 ) " " "*" " " " " " " " " "*" 9 ( 1 ) " " "*" " " " " " " " " "*" 10 ( 1 ) " " "*" " " " " " " " " "*" 11 ( 1 ) " " "*" " " " " " " " " "*" 12 ( 1 ) " " "*" " " " " " " " " "*" 13 ( 1 ) " " "*" " " " " " " " " "*" 14 ( 1 ) " " "*" " " " " " " " " "*" BounceRates ExitRates PageValues SpecialDay MonthDec MonthFeb MonthJul MonthJune MonthMar MonthMay MonthNov MonthOct 1 ( 1 ) " " " " "*" " " " " " " " " " " " " " " " " " " 2 ( 1 ) " " " " "*" " " " " " " " " " " " " " " "*" " " 3 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 4 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 5 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 6 ( 1 ) " " "*" "*" " " " " " " " " " " " " " " "*" " " 7 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 8 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 9 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 10 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 11 ( 1 ) " " "*" "*" " " " " " " "*" " " " " " " "*" " " 12 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" " " 13 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" " " 14 ( 1 ) "*" "*" "*" " " " " " " "*" " " " " " " "*" "*" MonthSep OperatingSystems2 OperatingSystems3 OperatingSystems4 OperatingSystems5 OperatingSystems6 OperatingSystems7 1 ( 1 ) " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " " " 5 ( 1 ) " " " " " " " " " " " " " " 6 ( 1 ) " " " " " " " " " " " " " " 7 ( 1 ) " " " " " " " " " " " " " " 8 ( 1 ) " " " " " " " " " " " " " " 9 ( 1 ) " " " " " " " " " " " " " " 10 ( 1 ) " " "*" " " " " " " " " " " 11 ( 1 ) " " "*" " " " " " " " " " " 12 ( 1 ) " " "*" " " " " " " " " " " 13 ( 1 ) " " "*" " " " " " " " " " " 14 ( 1 ) " " "*" " " " " " " " " " " OperatingSystems8 Browser2 Browser3 Browser4 Browser5 Browser6 Browser7 Browser8 Browser9 Browser10 Browser11 Browser12 1 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 5 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 6 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 7 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 8 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 9 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 10 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 11 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 12 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 13 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 14 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " Browser13 Region2 Region3 Region4 Region5 Region6 Region7 Region8 Region9 TrafficType2 TrafficType3 TrafficType4 1 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 5 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 6 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 7 ( 1 ) " " " " " " " " " " " " " " " " " " " " " " " " 8 ( 1 ) " " " " " " " " " " " " " " " " " " " " "*" " " 9 ( 1 ) " " " " " " " " " " " " " " " " " " " " "*" " " 10 ( 1 ) " " " " " " " " " " " " " " " " " " " " "*" " " 11 ( 1 ) " " " " " " " " " " " " " " " " " " " " "*" " " 12 ( 1 ) " " " " " " " " " " " " " " " " " " " " "*" " " 13 ( 1 ) " " " " " " " " " " " " " " " " "*" " " "*" " " 14 ( 1 ) " " " " " " " " " " " " " " " " "*" " " "*" " " TrafficType5 TrafficType6 TrafficType7 TrafficType8 TrafficType9 TrafficType10 TrafficType11 TrafficType13 1 ( 1 ) " " " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " " " " " 5 ( 1 ) " " " " " " " " " " " " " " " " 6 ( 1 ) " " " " " " " " " " " " " " " " 7 ( 1 ) " " " " " " " " " " " " " " " " 8 ( 1 ) " " " " " " " " " " " " " " " " 9 ( 1 ) " " " " " " " " " " " " " " "*" 10 ( 1 ) " " " " " " " " " " " " " " "*" 11 ( 1 ) " " " " " " " " " " " " " " "*" 12 ( 1 ) " " " " " " " " " " " " " " "*" 13 ( 1 ) " " " " " " " " " " " " " " "*" 14 ( 1 ) " " " " " " " " " " " " " " "*" TrafficType14 TrafficType15 TrafficType16 TrafficType17 TrafficType18 TrafficType19 TrafficType20 VisitorTypeOther 1 ( 1 ) " " " " " " " " " " " " " " " " 2 ( 1 ) " " " " " " " " " " " " " " " " 3 ( 1 ) " " " " " " " " " " " " " " " " 4 ( 1 ) " " " " " " " " " " " " " " " " 5 ( 1 ) " " " " " " " " " " " " " " " " 6 ( 1 ) " " " " " " " " " " " " " " " " 7 ( 1 ) " " " " " " " " " " " " " " " " 8 ( 1 ) " " " " " " " " " " " " " " " " 9 ( 1 ) " " " " " " " " " " " " " " " " 10 ( 1 ) " " " " " " " " " " " " " " " " 11 ( 1 ) " " " " " " " " " " " " " " " " 12 ( 1 ) " " " " " " " " " " " " " " " " 13 ( 1 ) " " " " " " " " " " " " " " " " 14 ( 1 ) " " " " " " " " " " " " " " " " VisitorTypeReturning_Visitor WeekendTRUE 1 ( 1 ) " " " " 2 ( 1 ) " " " " 3 ( 1 ) " " " " 4 ( 1 ) " " " " 5 ( 1 ) "*" " " 6 ( 1 ) "*" " " 7 ( 1 ) "*" " " 8 ( 1 ) "*" " " 9 ( 1 ) "*" " " 10 ( 1 ) "*" " " 11 ( 1 ) "*" "*" 12 ( 1 ) "*" "*" 13 ( 1 ) "*" "*" 14 ( 1 ) "*" "*" As you can see each level inside my factor variables is treated as a predictor itself. I want a single column "Month" to be treated as a possibile predictor, not every single month. Same for the other factor variables. How can I fixt it ?
