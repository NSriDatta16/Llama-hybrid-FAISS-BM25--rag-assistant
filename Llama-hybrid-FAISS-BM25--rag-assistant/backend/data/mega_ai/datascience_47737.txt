[site]: datascience
[post_id]: 47737
[parent_id]: 
[tags]: 
Configuration of masks in PixelCNN

I have trouble understanding the masks in PixelCNN 1 . Here for A, each channel is connected to prior channels. For B, channels are also connected to themselves. My problem is in first layer when I go from 3 channels to number of filters. Let's say I have 128 filters, how is the mask then implemented? What I implemented so far with the assumption that there is same number of channels in each layer is: H = KERNEL_SIZE[0] W = KERNEL_SIZE[1] N = OUT_CHANNEL M = IN_CHANNEL # implement context mask mask = np.zeros((N, M, H, W)) mask[:,:,:(H//2)] = 1 mask[:,:,(H//2),range((W//2))] = 1 # implement channel mask if mask_type == 'A': mask[np.triu_indices(N, k=0, m=M)] = 0 elif mask_type == 'B': mask[np.triu_indices(N, k=1, m=M)] = 0
