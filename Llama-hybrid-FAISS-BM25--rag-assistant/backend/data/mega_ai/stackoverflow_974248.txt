[site]: stackoverflow
[post_id]: 974248
[parent_id]: 
[tags]: 
Using/implementing exsl function node-set() in SSIS's XML Task

I'm attempting to apply an XSL transform to an XML file inside an SSIS package XML Task. All well and good, but unfortunately my XSL is slightly less "portable" than normal as I need to use the function node-set() . A simplified example of my XSL is: I'm using the following namespace in the stylesheet declaration: xmlns:msxsl="urn:schemas-microsoft-com:xslt" This works in the VS IDE, XMLSpy (as long as I set the XSLT engine as MSXML), etc. However, when I attempt to execute an XML Task within the package I get the following exception: Error: 0xC002F304 at XML Task, XML Task: An error occurred with the following error message: "Function 'msxsl:node-set()' has failed.". I'm using VS2005 to design the package as it's the 2005 version of SSIS. Any ideas on how I can proceed are greatly appreciated. I'm calling a template that implements the EXSLT str:split function to"tokenise" a string into it's constituent elements, e.g. "Kermit T Frog" would be returned as follows: Kermit T Frog This is stored in the variable $familyNames, which I then iterate through. However, as this is returned as a result tree fragment I need to wrap it with the function msxsl:node-set() so that the result is treated as a node set. Not sure how else I can achieve the above. Here's the implementation of str:split that I obtained from http://www.exslt.org/ :
