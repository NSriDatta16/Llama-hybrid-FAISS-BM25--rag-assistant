[site]: stackoverflow
[post_id]: 4924565
[parent_id]: 4924322
[tags]: 
SELECT @CollectionKey = [AccountNo] FROM @Accounts WHERE [AccountKey] = @index; This query would benefit from a PRIMARY KEY declaration on your table variable. When you say IDENTITY, you are asking the database to auto-populate the column. When you say PRIMARY KEY, you are asking the database to organize the data into a clustered index. These two concepts are very different. Typically, you should use both of them. DECLARE @Accounts TABLE ( [AccountKey] INT IDENTITY(1,1) PRIMARY KEY, I am not able to add indexes. In that case, copy the data to a database where you may add indexes. And use: SET STATISTICS IO ON
