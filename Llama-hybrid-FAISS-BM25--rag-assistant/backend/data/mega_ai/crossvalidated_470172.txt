[site]: crossvalidated
[post_id]: 470172
[parent_id]: 462420
[tags]: 
I believe Lukas Roberts is correct that this is an open issue in scipy . The current implementation reverses the definitions of U1 and U2. The problem is in these lines: u1 = n1*n2 + (n1*(n1+1))/2.0 - np.sum(rankx, axis=0) # calc U for x u2 = n1*n2 - u1 # remainder is U for y When we place the definition of u1 in u2 , we see that the formula for u2 used here is in fact the formula for u1 from Wikipedia: u2 = n1*n2 - n1*n2 + (n1*(n1+1))/2.0 - np.sum(rankx) There is an complete revision in the works, but the pull request seems to be stuck for now.
