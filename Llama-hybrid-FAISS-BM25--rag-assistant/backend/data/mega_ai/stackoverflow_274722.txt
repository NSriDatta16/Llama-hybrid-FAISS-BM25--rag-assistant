[site]: stackoverflow
[post_id]: 274722
[parent_id]: 274375
[tags]: 
iptables provides libipq , a userspace packet queuing library. From the manpage: Netfilter provides a mechanism for passing packets out of the stack for queueing to userspace, then receiving these packets back into the kernel with a verdict specifying what to do with the packets (such as ACCEPT or DROP). These packets may also be modified in userspace prior to reinjection back into the kernel. By setting up tailored iptables rules that forward packets to libipq, in addition to specifying the verdict for them, it's possible to do packet inspection for statistics analysis. Another viable option is manually sniff packets by means of libpcap or PF_PACKET socket with the socket-filter support.
