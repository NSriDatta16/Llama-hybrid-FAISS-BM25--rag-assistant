[site]: crossvalidated
[post_id]: 618793
[parent_id]: 
[tags]: 
Time-Varying-Intercept in Logistic Regression

Background I have a panel of binary response data - I have a different cross section of individuals each month, across many months, and the outcome is 0 or 1. When fitting a logistic regression that does not allow for time-variation in the intercept, the time-series of residuals appear to be highly autocorrelated. Therefore, I would like to fit a logistic regression that allows the intercept to vary smoothly over time. Additionally, I will need to forecast future outcomes, so I will need out-of-sample estimates of the intercept that take into account its persistence over time. In linear regression, I could use a state-space model allowing the intercept to follow an AR(1) process: $$\begin{align} y_{i,t} &= \beta_{0,t} + \beta_1 x_{i,t} + \varepsilon_{i,t} \\ \beta_{0,t} &= \mu + \phi \beta_{0,t-1} + v_t \\ \varepsilon_{i,t} &\sim \mathcal{N}(0,\sigma_\varepsilon) \\ v_t &\sim \mathcal{N}(0,\sigma_v) \end{align}$$ where $\beta_{0,t}$ is the time-varying intercept, and the second equation describes its evolution as an AR(1) process with persistence $\phi$ and long-run intercept $\frac{\mu}{1-\phi}$ This could be estimated via frequentist or Bayesian methods using the Kalman filter where the first equation is the measurement equation and the second equation is the state space equation. Once $\mu$ and $\phi$ are estimated, I could project the time-varying-intercept forward into the future. For example, for the first out-of-sample period, time period $t=T+1$ , we would have: $$\begin{align} E(\beta_{0,T+1}) &= \mu + \phi \beta_{0,T} \\ \end{align}$$ I am not aware of an equivalent in logistic regression and have not been able to find much when searching. Workaround My idea of a workaround was to estimate time-fixed-effects in the glm package in R. Then, I could fit an AR(1) model to the time-fixed-effects. Then, I could project the time-fixed-effects into the future using an AR(1) model. However, this has not been working very well in practice. I have a long time-series of data, so using fixed effects necessitates the addition of a large number of regressors. I am also already using a large number of regressors, so when I allow for time-fixed-effects, in some months there is perfect multicollinearity and I cannot recover a coefficient estimate for the time fixed effect. Finally, including time-fixed-effects is not ideal since then I get a perfect in-sample time-series fit, while a key measure of performance of the model is its in-sample time-series fit. Question Is there a way to include a smooth time-varying-intercept like the AR(1) state space model described above in a logistic regression? Ideally, I would like to use a built-in R package to do this. However, I could program this by hand if needed, so theoretical answers would also be appreciated.
