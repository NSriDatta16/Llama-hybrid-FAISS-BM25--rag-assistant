[site]: crossvalidated
[post_id]: 415229
[parent_id]: 415220
[tags]: 
PCA seems to have separated clusters in your data. It is working as intended. However, PCA has limitations. Principal components are eigenvectors of the covariance matrix of all of your data. They capture direction of the greatest variance. PCA looks at the aggregate data, so finds the direction along which all data seem to vary the greatest, not just one cluster. Basically, this would average out the directions of variances of individual clusters. I'll use an example with clean data here: import numpy as np import matplotlib.pyplot as plt a = np.stack((np.arange(20), np.zeros(20))) # horizontal cluster b = np.stack((np.zeros(20), np.arange(20))) # vertical cluster c = np.hstack((a, b)) # combined plt.plot(a[0], a[1], b[0], b[1]) cov = np.cov(c) _, eig = np.linalg.eig(cov) plt.arrow(0, 0, *(5 * eig[0])) plt.arrow(0, 0, *(5 * eig[1])) plt.xlim(left=-5) plt.title('Original') plt.figure() a_ = np.linalg.inv(eig) @ a b_ = np.linalg.inv(eig) @ b plt.plot(a_[0], a_[1], b_[0], b_[1]) plt.title('Transformed') Above, you can see that there are two "clusters" varying in perpendicular directions (orange, blue). The calculated eigenvectors (black) find the average direction of greatest variance since they are looking at all of the data together. If half the data are going up-down, and the other half are going right-left, then the average direction will be a diagonal.
