[site]: crossvalidated
[post_id]: 153221
[parent_id]: 
[tags]: 
Can one use the RTS (Rauch–Tung–Striebel) smoother to simulate latent factors (as opposed to Carter and Kohn procedure)?

It is a little surprising that I have not found anything online in the literature which clarified this. I am working on an MCMC Gibbs sampling procedure to calibrate a "dynamic factor model". One of the steps involves simulating latent factors through a simulation smoother such as the Carter and Kohn (1994)[1] algorithm. That basically entails running a Kalman filter forward in time (say $1:T$), then drawing randomly from the posterior at time $T$, followed by backward recursions and random draws from $T-1 : 1$. In my specific problem, the matrices are quite sparse and I found that in the backward recursions I run into some numerical problems in the variances (a.k.a. smoothed matrix $P$) of my drawn latent factors. The simulated latent factors are sensible, however. I found, however, that when I use the RTS fixed-interval smoother [2] at each step (very similar equations to Carter and Kohn equations except for variance propagation) I get good results for the variances. Is what I am doing in violation of any assumptions I am not aware of? Is it a valid procedure? [1] Carter C. K. and Kohn R.(1994), "On Gibbs Sampling for State Space Models" Biometrika 81 :3 (Aug.), pp. 541-553 [2] Rauch H.E. Striebel, C.T., and Tungh F. (1965), "Maximum likelihood estimates of linear dynamic systems", AIAA Journal, 3 :8, pp. 1445-1450.
