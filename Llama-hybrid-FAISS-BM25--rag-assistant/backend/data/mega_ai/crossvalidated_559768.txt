[site]: crossvalidated
[post_id]: 559768
[parent_id]: 
[tags]: 
Live peak / trough detection (data provided)

At the bottom of this question is the data of three time series in CSV-format. All are of same length and they all contain measurements of the same event "A". But each time series is using a different method of measurement. I am looking for a live method to find around 33 upward and downward phases in total (peaks + troughs) for event "A" as the data is coming in. I have tried to implement FFT, Kalman and a median-filter, but have so far been unsuccessful to get close to 33 peaks and troughs (either I get around 5-10 or 60-100). In theory it should be cyclical like a sinus curve but with varying periods, i.e. up -> down -> up -> down... etc. In the example plot below of the data I have annotated approximately where the peaks (even numbers) and troughs (odd numbers) would be identified: I am not looking for 33 peaks/troughs exactly , but a consistent live method that attempts to identify peaks/troughs as the data is coming in (e.g. live) . Would much appreciate answers that include the code for clarity of method. Edit1 , in response to comment below: Some lag in the method is expected and not a problem. The data (in CSV-file format): MA data measurement 1 MA data measurement 2 MA data measurement 3 I have asked a similar question previously, but it was not very well defined. I have tried to be more specific this time.
