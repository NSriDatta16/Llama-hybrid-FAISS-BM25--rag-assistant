[site]: stackoverflow
[post_id]: 1355182
[parent_id]: 1355101
[tags]: 
Other than refactorings triggered by the need to improve performance, I usually will notice while I am writing the code to pass a test a place where I could share code or a better, more elegant way to accomplish something. At this point, you finish the code to pass the test, make sure all tests are passing, then go back and do your refactorings. This may or may not involve the exact code that you wrote, most likely it will, but it may be something that you just noticed while writing the new code. Sometimes I'll note something that could be refactored, but decide that what I'm working on right now is more important. At that point I'll note the issue for a later refactoring. Eventually, that refactoring will become as or more important than the next feature and it will get done in the refactor phase of a red/green/refactor cycle. In this case, it probably is unrelated to what I was just working on.
