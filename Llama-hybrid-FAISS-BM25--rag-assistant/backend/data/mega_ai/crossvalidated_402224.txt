[site]: crossvalidated
[post_id]: 402224
[parent_id]: 
[tags]: 
Model/predict the number of malaria-infected cells

Background: In order to determine the severity of a Malaria infection, one takes a sample of red blood cells and determines, through a microscope, the number of cells infect by the malaria parasite. The fraction of infected cells is then a measure of the severity of the infection. The problem: Suppose that the number of analyzed cells varies strongly between individual patients. For example, suppose that we analyze 200 cells in patient 1, 50 cells in patient 2, but only 10 cells in patient 3. This could be due to a variety of technical factors. In patient 3, the variance of the naive estimator for the rate of infected cells (# cells infected)/(# cells examined) will be very high. To get improved rate estimates for patients with small cell sample sizes, I'd like to develop a predictive approach that models the true underlying rate of infected cells as a hidden variable. For example, I could treat each examined cell as a Bernoulli variable, and use logistic regression to model the rate of infected cells in patient $i$ as conditional on a number of covariates: $$ l_i = \mu + \mu_i + {age}_i * \beta_1 + {treatmentIntensity}_i * \beta_2 .. $$ , where $exp(l_i)/[exp(l_i)+1]$ is an estimator for the rate of infected cells in patient $i$ , $mu$ is the population mean, and $\mu_i$ is a variable that captures systematic differences between individual patients. What is good about this model, in particular when fitting it using Bayesian methods (with a prior on $\mu_i$ centered on 0), is that it will put greater weight on the observed rate of infected cells in patients in which many cells were examined than in patients in which only a few cells were examined. However: The difficulty of fitting this model (in particular in a Bayesian context) increases with the number of patients. Are there any sampling techniques to fit this model as $n$ goes into the hundreds or thousands? The predictor term only models linear relationships. Other techniques like Random Forests would be an alternative, but how do I get these models to recognize the difference between patients with many examined cells (in which I want the predicted mean to be close to the empirical mean) and patients with a small number of examined cells?
