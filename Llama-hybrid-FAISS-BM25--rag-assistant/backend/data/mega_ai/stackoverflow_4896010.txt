[site]: stackoverflow
[post_id]: 4896010
[parent_id]: 
[tags]: 
DllImport StackOverflowException

I'm trying to use C++ DLL(borland c builder) from c#. Function writeParameter works fine, it writes correct data to a file, but then i have an exception "An unhandled exception of type 'System.StackOverflowException' occurred in PresentationFramework.dll" C++ code: #include #include #include #pragma hdrstop #pragma argsused BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fwdreason, LPVOID lpvReserved) { return 1; } //--------------------------------------------------------------------------- #pragma pack (push,1) typedef struct { int a; }ABC; #pragma pack (pop) //--------------------------------------------------------------------------- extern "C" void __declspec(dllexport) __cdecl writeParameter(ABC *abc) { ofstream outfile("result.txt"); outfile a c#: [StructLayoutAttribute(LayoutKind.Sequential)] public class ABC { public int a; } [DllImport("D:\\monitorVC.dll", EntryPoint = "_writeParameter", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)] public static extern void WriteParameter( [In,MarshalAs(UnmanagedType.LPStruct)] ABC abc ); private void Grid_Loaded(object sender, RoutedEventArgs e) { var abc = new ABC() {a = 123}; WriteParameter(abc); }
