[site]: stackoverflow
[post_id]: 684451
[parent_id]: 683970
[tags]: 
filladapt.el does the trick. That with the latest version of RubyMode . Using those two packages solves the M-q problem you're seeing. (Using GNU Emacs 22.1) Looking at the code for ruby-mode, it looks like it has customized the variables to control paragraph filling like so: (make-local-variable 'paragraph-start) (setq paragraph-start (concat "$\\|" page-delimiter)) (make-local-variable 'paragraph-separate) (setq paragraph-separate paragraph-start) (make-local-variable 'paragraph-ignore-fill-prefix) (setq paragraph-ignore-fill-prefix t) Which can be added to a custom hook for your current ruby, or whatever major mode where you want fill behavior to act as you described - provided you use filladapt.el.
