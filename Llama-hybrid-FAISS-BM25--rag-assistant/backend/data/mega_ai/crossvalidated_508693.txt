[site]: crossvalidated
[post_id]: 508693
[parent_id]: 
[tags]: 
Unreasonable bias when using nnet (R package caret) for time series forecasting

I have been trying to forecast a time series in a regression-like setting using neural networks ( nnet method in R package caret ). I have a number of potential predictor series (x1,...,xn) and a target series y (which I would like to forecast) for a number of units (countries). The idea is to train a neural network model (using the target and predictor series) for each unit over the training period and then use the predictor series to forecast the target series in the forecast (test) period. Using different combinations of predictor series, a tuning grid (to choose the size and weight decay parameters) and 10-fold cross-validation, I have found the model specification that results in the least mean RMSE for each unit of analysis (country). Now, the problem is that in units (countries) where the target series (y) takes values greater than 1 (no matter how great they are), the fitted and forecast values I obtain are always less than but very close to 1 (for instance, fitted/forecast value = 0.9998590 whereas the actual value is 2.106284). The forecasts/fitted values are reasonable in units where the target series is below 1 (no persistent over- or under-estimation is observed). I suspect that this might be do to the pre-processing transformations of predictors ( preProc=c("center", "scale","nzv","YeoJohnson") in the train function of caret ), but I am not sure. Here is a sample code of mine (I have used multi-core processing): Train_Control This is a reproducible sample of my results for two countries (Country2 is problematic): structure(list(Date = structure(c(2000, 2000.08333333333, 2000.16666666667, 2000.25, 2000.33333333333, 2000.41666666667, 2000.5, 2000.58333333333, 2000.66666666667, 2000.75, 2000.83333333333, 2000.91666666667, 2000, 2000.08333333333, 2000.16666666667, 2000.25, 2000.33333333333, 2000.41666666667, 2000.5, 2000.58333333333, 2000.66666666667, 2000.75, 2000.83333333333, 2000.91666666667), class = "yearmon"), NUTS_ID = c("Country1", "Country1", "Country1", "Country1", "Country1", "Country1", "Country1", "Country1", "Country1", "Country1", "Country1", "Country1", "Country2", "Country2", "Country2", "Country2", "Country2", "Country2", "Country2", "Country2", "Country2", "Country2", "Country2", "Country2" ), Actual_Series = c(0.457657567092351, 0.489884027412959, 0.480109895978655, 0.456853015082223, 0.425552444798606, 0.421229877642223, 0.402182877063751, 0.400472321680614, 0.431434793131692, 0.458048743861062, 0.46881719146456, 0.515977157013757, 2.28134521245956, 2.40495299100876, 2.10741392374039, 2.01576942205429, 1.74593815803528, 1.78453557491302, 1.73332235813141, 1.70681864023209, 1.8438695192337, 1.958999979496, 2.21270083189011, 2.20486198663712 ), Fitted_Forecast_Series = c(0.546108044733944, 0.520434401889027, 0.506330050092539, 0.469571001501336, 0.452199043841608, 0.438351172183196, 0.435648762369777, 0.427179938490792, 0.455903411805415, 0.465264001188698, 0.484762549865368, 0.530237425305779, 0.999861230566213, 0.999848982687442, 0.999852924277389, 0.999827034526511, 0.999811925497444, 0.999807129303961, 0.999824808585808, 0.99981070799538, 0.999838686511238, 0.99984541843143, 0.999853120165739, 0.999857448942982)), row.names = c(NA, -24L), class = "data.frame") I would be grateful if somebody could help me address this issue.
