[site]: stackoverflow
[post_id]: 3302857
[parent_id]: 
[tags]: 
Algorithm to get the excel-like column name of a number

I'm working on a script that generate some Excel documents and I need to convert a number into its column name equivalent. For example: 1 => A 2 => B 27 => AA 28 => AB 14558 => UMX I have already written an algorithm to do so, but I'd like to know whether are simpler or faster ways to do it: function numberToColumnName($number){ $abc = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; $abc_len = strlen($abc); $result_len = 1; // how much characters the column's name will have $pow = 0; while( ( $pow += pow($abc_len, $result_len) ) Do you know a better way to do it? Maybe something to keep it simpler? or a performance improvement? Edit ircmaxell's implementation works pretty fine. But, I'm going to add this nice short one: function num2alpha($n) { for($r = ""; $n >= 0; $n = intval($n / 26) - 1) $r = chr($n%26 + 0x41) . $r; return $r; }
