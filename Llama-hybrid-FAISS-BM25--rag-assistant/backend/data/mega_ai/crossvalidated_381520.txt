[site]: crossvalidated
[post_id]: 381520
[parent_id]: 
[tags]: 
How can I estimate the highest posterior density interval from a set of x,y values describing the PDF?

I'd like to estimate the Highest Posterior Density Interval (HPDI) of a calculated density function, rather than from empirical samples as is normally done (e.g., from an mcmc object). The situation is that I am aggregating two probability functions and I end up with x,y values describing a non-parametric probability distribution. I'd like to then know the 80% HPDI of this aggregate function, rather than a symmetric 80% density interval, which I could calculate from the CDF. Here is a setup for an example: I have two theoretical probability distributions: d1 To aggregate them, I take the arithmetic mean of the two distributions at each value of x like so, and plot the aggregate function: df $weight group)) library(dplyr) sum % group_by(x) %>% summarise("y"=sum(y*weight)) p.a I can access the x,y values of the aggregate function using ggplot_build() : agg head(agg,3) x y 1 -10 0.001846604 2 -9 0.006281406 3 -8 0.017868056 I'm focused heavily on implementation rather than theory, so I'd prefer responses focused on functions to help do this. A figure of the two distributions and the aggregate (in black) in case it's helpful as a visual: Thanks for any help you can provide!
