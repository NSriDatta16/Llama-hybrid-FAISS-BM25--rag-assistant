[site]: stackoverflow
[post_id]: 2730112
[parent_id]: 2729243
[tags]: 
When you use msxml:node-set on a rootless fragment of XML (like your list of months), the function automatically creates a root to contain the fragment. So in your case your path from the node set is wrong: msxsl:node-set($months)/month[number($month)] This is wrong because /month is not the root of $months . You can fix it easily by skipping the artificial root and going to month directly: msxsl:node-set($months)//month[number($month)] Note the // operator instead of the / operator. EDIT Upon testing I see that I'm wrong. In fact, the original snippet that you are using works fine for me. The // operator is unnecessary. Are you sure your $month variable is being set correctly?
