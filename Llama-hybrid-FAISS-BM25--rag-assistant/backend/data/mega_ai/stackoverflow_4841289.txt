[site]: stackoverflow
[post_id]: 4841289
[parent_id]: 
[tags]: 
Using Nokogiri's swap on text nodes inside a DocumentFragment

With Hpricot, you can do this: > doc = Hpricot("a") => # > doc.children.first.swap('b') => ["b"] > doc.to_s => "b" But if you try the same thing with Nokogiri, you get an error: > doc = Nokogiri::HTML::DocumentFragment.parse('a') => # ]> > doc.children.first.swap('b') RuntimeError: error parsing fragment (1) from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/xml/node.rb:509:in `in_context' from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/xml/node.rb:509:in `parse' from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/html/document_fragment.rb:22:in `initialize' from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/xml/node.rb:485:in `new' from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/xml/node.rb:485:in `fragment' from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/xml/node.rb:885:in `coerce' from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/xml/node.rb:382:in `replace' from /Library/Ruby/Gems/1.8/gems/nokogiri-1.4.4/lib/nokogiri/xml/node.rb:407:in `swap' from (irb):63 How can I use swap on text nodes in Nokogiri? Edit: Note that this isn't a problem with the ARGUMENT to swap , it's a problem with the receiver For example: > doc = Nokogiri::HTML::DocumentFragment.parse(' b ') => # ]>]> > doc.at("a").swap('x') => # ]> > doc.to_s => "x"
