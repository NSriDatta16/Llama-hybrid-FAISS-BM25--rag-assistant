[site]: crossvalidated
[post_id]: 639499
[parent_id]: 124944
[tags]: 
As others have pointed out, the problem is singularity that the estimated variance of random intercepts is at its boundary zero. In such cases, lme4 prints messages but nlme does not. However, you can use nlme::interval() to assess boundary issues. In fact, your model will produce the following error when finding confidence intervals. library(nlme) library(lme4) library(ggplot2) library(dplyr) Data It means that the estimated variance is not positive, which is in line with a zero-variance case. The reason for singularity in this case is not incorrect syntax but the data characteristics. Before modeling, we need to explore the data in tables and plots. sd(Data$Score) "15.79279" Data %>% group_by(UID) %>% summarize(Umean = mean(Score), Usd = sd(Score)) %>% summarize(REsd = sd(Umean), Usdm = mean(Usd)) " UID Umean Usd 1 1 83.3 7.64 2 2 85 10 3 3 75.7 13.7 4 4 68.3 7.64 5 5 85 0 6 6 95 5 7 7 70 20 8 8 75 5 9 9 70 34.6 10 10 75.7 22.5 11 11 75.7 22.5 12 12 68.3 20.2 13 13 71.7 7.64 14 14 80 20 REsd 7.78 Usdm 14.0" Data %>% group_by(UID) %>% mutate(DM = Score - mean(Score)) %>% ungroup() %>% summarize(DMsd = sd(DM)) "13.8" The standard deviation of Score is 15.8. After removing means by user, the standard deviation is on average 14.0, or more accurately 13.8, which does not reduce much. The standard deviation of user-specific means is 7.78, much smaller than the standard deviation of demeaned scores and will shrink further in random-effects estimators. Recall that random effects are user-specific sequence-average deviation from the ground mean that should make the within-subject variation smaller than the total variation. If within-subject variation equals the total variation, there are no random effects. Data % group_by(UID) %>% mutate(Group = if_else( Condition[1] == "B", "BAB", "ABA") %>% factor(levels = c("ABA", "BAB"))) %>% ungroup() ggplot( data = Data, aes(x = factor(Seq), y = Score, group = UID, color = Group) ) + geom_smooth(aes( ymin = ifelse(after_stat(ymin) 100, 100, after_stat(ymax)), group = Group, fill = Group), method = "loess", span = 1, linetype = 0, show.legend = F) + stat_smooth( geom = "line", aes(group = Group), method = "loess", span = 1, linewidth = 1, alpha = 0.7) + geom_line(linewidth = 0.2, alpha = 0.4, show.legend = F) + scale_fill_manual(values = c("#2197DF", "#D14343")) + scale_color_manual(values = c("#2197DF", "#D14343")) + scale_x_discrete(expand = c(0, 0.1, 0, 0.1)) + labs(x = "Sequence") + theme_minimal() + theme( legend.title = element_blank(), legend.position = c(0.6, 0.2), panel.grid = element_line(colour = "grey90", linewidth = 0.2) ) We can also view such data characteristics from a spaghetti plot. It shows no patterns that user-specific mean values deviate from the ground mean. In contrast, the variation within each user is so great that it is comparable with total variation. However, the comparison should not be made based on Condition but the first Condition each user experienced that sufficiently defines the two distinct experimental sequences, which is coded into Group . Groups ABA and BAB appear to have different means at three sequential stages that show linear effects on Score . Starting with B, the delay is longer than that starting with A but remains constant in additional stages, unlike those starting with A whose delay increases in the second and third stages. So we can use Seq as numeric instead of a factor and should have interaction between Seq and Group to allow different intercepts and slopes of Seq by Group . summary(Model Because the within-subject variation is as large as the total variation, any attempt to estimate random intercepts is challenging. lme4::lmer() shows boundary issues and zero variance in all specifications with random intercepts by UID . summary(Model Without using random effects, we can still incorporate clustered errors by specifying error correlation patterns in generalized least squares. The above summary shows that the correlation is no different from zero in either a compound symmetry structure or an autoregressive process. Note that neither estimates nor confidence intervals of correlation coefficients are at boundary -1 or 1, which implies stable results. summary(Model The spaghetti plot shows that both ABA and BAB groups have similar spread in each stage, and both groups have slightly larger spread in the second stage. Therefore, we can use weighted least squares to allow error variance to vary by stage. As shown above, compared to OLS and random effects, WLS results in smaller standard errors and p values. However, both AIC and BIC prefer OLS. In summary, not all longitudinal data require random-effects or fixed-effect estimators. When the between-subject deviation is small, within-subject variation is comparable with total variation, random effects approach zero variance, and simpler models may give better results.
