[site]: stackoverflow
[post_id]: 5093136
[parent_id]: 
[tags]: 
Parse SIP packet in C

I am trying to parse a SIP packet and get some information out of it. To be more specific, the packet looks like this REGISTER sip:open-ims.test SIP/2.0 Via: SIP/2.0/UDP 192.168.1.64:5060;rport;branch=z9hG4bK1489975971 From: ;tag=1627897650 To: Call-ID: 1097412971 CSeq: 1 REGISTER Contact: ;+sip.instance=" " Authorization: Digest username="alice@open-ims.test", realm="open-ims.test", nonce=" ", uri="sip:open-ims.test", response=" " Max-Forwards: 70 User-Agent: UCT IMS Client Expires: 600000 Supported: path Supported: gruu Content-Length: 0 Now, from that packet I need to extract the following : The value after "From: " ( in this case ) The value after "Contact: " ( in this case ) The value after "username" ( in this case alice@open-ims.test ) My code so far is this char * tch; char * saved; tch = strtok (payload,"<>;"); while (tch != NULL) { int savenext = 0; if (!strcmp(tch, "From: ")) { savenext = 1; } tch = strtok (NULL, "<>;"); if (savenext == 1) { saved = tch; } } printf ("### SIP Contact: %s ###\n", saved); } } Where payload contains the packet as described above. However, when I run my program, it will result in a segmentation fault. The weird thing is that if I use in strtok the characters "<>;: " and in strcmp the value "sip" the message will parse successfully and it will keep the saved value. But I need to parse all three of the upper values. Would a sip library help me more with my problem ? Thanks in advance
