[site]: stackoverflow
[post_id]: 4522784
[parent_id]: 4522701
[tags]: 
How about using strpos to find a substring? It's not the most elegant solution, but if you just want some basic protection for someone who already is given a lot of power on the site. Here is how I would do it: // PRIVATEDIR already includes PUBLICDIR at this point if(strpos($this->opts['PRIVATEDIR'],$this->opts['PUBLICDIR']) !== 0) { die('ERROR: '.$this->opts['PRIVATEDIR'].' must be located in .'$this->opts['PUBLICDIR']); } Note the triple not equals, that makes sure that PUBLICDIR occurs at position 0 of the PRIVATEDIR string and not it simply being not found or somewhere else in the string. Also you should check that they aren't the same (PUBLICDIR != PRIVATEDIR) since you could set it to "./test/../" and that would return you to just ".".
