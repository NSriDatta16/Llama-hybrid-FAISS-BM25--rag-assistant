[site]: stackoverflow
[post_id]: 3676526
[parent_id]: 
[tags]: 
How to find an user on a LDAP server

When trying to find an User on a LDAP Server, I get the following error "Unknown error (0x8000500c)" This is the code I'm using: PrincipalContext domainContext = new PrincipalContext(ContextType.Domain, "gandalf.intrafg"); UserPrincipal p = UserPrincipal.FindByIdentity(domainContext, IdentityType.SamAccountName, "Consultor1"); Indidentally, the following piece of code seems to work (no exception is generated), but the samAccountName comes through as a byte array. Anybody knows why? DirectoryEntry entry = new DirectoryEntry("LDAP://gandalf.intrafg"); DirectorySearcher searcher = new DirectorySearcher(entry); //searcher.PropertiesToLoad.Add("givenName"); //searcher.PropertiesToLoad.Add("sn"); searcher.PropertiesToLoad.Add("samAccountName"); searcher.Filter = "(&(objectCategory=person)(samAccountName=Consultor1))"; SearchResult result = searcher.FindOne();
