[site]: stackoverflow
[post_id]: 590892
[parent_id]: 
[tags]: 
Windows Registry file association menu

I have recently(today) began meddeling with my registry from within Delphi. :) all is working well and my custom file type now opens with my program, but there are 2 issues i can't solve. 1) I wanted the option to "open with" from all file types so i added reg := TRegistry.Create; reg.RootKey := HKEY_CLASSES_ROOT; reg.LazyWrite := false; reg.OpenKey('*\OpenWithList\EncryptionSystem', true); reg.WriteString('','C:\Program Files\EncryptionSystem\EncryptionSystem.exe "%1"'); reg.CloseKey; reg.free; If I look in the registry using regedit it's sure there as it should seem to be but when I right click on a file and select Open With it's not there... So I then added this reg.OpenKey('*\shell\Encrypt\command', true); reg.WriteString('','C:\Program Files\EncryptionSystem\EncryptionSystem.exe "%1"'); reg.CloseKey; This does work for every file but the option is right at the top with "open" and "edit". I kinda want it to appear in a menu subsection like most programs do... I realised that i needed to play with shellext but i did not understand the structure of how these worked withing the context menu handlers... I'd learnt all I had from reading the registry anyway... I know the name for the shellext appears later after the ".*" but as for the meaning of the big jibberish keys I have no idea.
