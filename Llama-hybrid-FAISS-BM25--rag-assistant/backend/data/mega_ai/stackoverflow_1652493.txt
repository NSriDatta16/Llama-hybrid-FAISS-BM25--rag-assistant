[site]: stackoverflow
[post_id]: 1652493
[parent_id]: 
[tags]: 
Golf SQL Problem

I want to preface this by saying I believe the Rightâ„¢ Way to handle this is probably to restructure the database tables BUT I have a job for a client where he is purchasing a database of most of the golf courses in the US. Since he will receive updates periodically from seller I have preserved structure as sent. (Nasty aside: jackass seller of data promises to let us know when he "has to change an existing record's id". What? You are selling data and then changing the unique id after?) So I have a table of tees (groups of holes played as a sequence); a table of rounds (one play of a tee), and a table of holes (individual scoring for each hole). In the tees table these dolts are storing the par (target score) like so field name Par_ 1, Par_ 2, Par_ 3 through Par_ 18 with INT values. So the hole number is part of the field name and is not stored as a value at all. Now let's say that I need to look up an average of all of the scores you have for holes whose par is 3 in a particular round. Or all of your rounds. Something like SELECT (SUM(holesPlayed.score) / COUNT(holesPlayed.score)) FROM holesPlayed, tees WHERE holesPlayed.round_id = 9 AND tees.CourseTeeNumber = 'UT-94-1' AND tees.Par_x = 3; So I can easily look up scores by hole but to look up the par for a hole will involve a nightmare since the hole number is embedded in the field name like that. Should I just start writing something to export the pars by tee and hole to their own table? Am I missing some amazing SQL kungfu that will save me? What's your advice?
