[site]: stackoverflow
[post_id]: 5281261
[parent_id]: 
[tags]: 
Generating a normal map from a height map?

I'm working on procedurally generating patches of dirt using randomized fractals for a video game. I've already generated a height map using the midpoint displacement algorithm and saved it to a texture. I have some ideas for how to turn that into a texture of normals, but some feedback would be much appreciated. My height texture is currently a 257 x 257 gray-scale image (height values are scaled for visibility purposes): My thinking is that each pixel of the image represents a lattice coordinate in a 256 x 256 grid (hence, why there are 257 x 257 heights). That would mean that the normal at coordinate (i, j) is determined by the heights at (i, j), (i, j + 1), (i + 1, j), and (i + 1, j + 1) (call those A, B, C, and D, respectively). So given the 3D coordinates of A, B, C, and D, would it make sense to: split the four into two triangles: ABC and BCD calculate the normals of those two faces via cross product split into two triangles: ACD and ABD calculate the normals of those two faces average the four normals ...or is there a much easier method that I'm missing?
