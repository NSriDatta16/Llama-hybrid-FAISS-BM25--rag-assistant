[site]: stackoverflow
[post_id]: 5093601
[parent_id]: 5090233
[tags]: 
If you want full random access, ECB is the way to go (as the earlier answer recommends). You would not need to recreate the encryption stream for each block, because it doesn't use an IV and encrypting a block doesn't permute the stream (unlike most other modes where the cryptotext depends on previous blocks or the position of the block in the stream). Wikipedia has a nice illustration (the ciphertux picture) of one of the problems with this mode. If your file logically consists of larger chunks (such as database records or disk sectors in virtual disks), you should consider encrypting them as units. In CBC mode you would generate a new random IV for each chunk each time you write it and store it with the block (thus using up an additional 32 bytes of storage per chunk), and you would need to rewrite the entire chunk even if a single byte changes, but the security would be much better.
