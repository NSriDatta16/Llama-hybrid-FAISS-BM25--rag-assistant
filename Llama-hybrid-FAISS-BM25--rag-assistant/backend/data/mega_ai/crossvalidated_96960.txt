[site]: crossvalidated
[post_id]: 96960
[parent_id]: 83415
[tags]: 
We can show that the density of $Y_t$ knowing $F_{t-1}$ is given by: $$ \sum_{k=0}^{\infty} \frac{\lambda^k e^{-\lambda}}{k!} \frac{1}{\sqrt{2 \pi(1+k\sigma^2)h_t^{*}}} e^{\frac{(y-(r+m_t^{*}+\sqrt{h_t^{*}}k\mu))^2}{2(1+k\sigma^2)h_t^{*}}} $$ with: $$ m_t^{*} = m - \frac{\sqrt{h_t^{*}}\lambda\mu}{\sqrt{1+\lambda(\mu^2+\sigma^2)}} $$ $$ h_t^{*} = \frac{h_t}{1 + \lambda(\mu^2 + \sigma^2)}$$ So the following code will compute the log-likelihood of the model and can be optimized to fit the parameters to a dataset. density_condi FYI: on the SP500 this model give an alpha of 0.1579and a theta of -0.1635, which show the importance to modelize the leverage effect (GJR model), the use of jump is justified by the non-gaussianity of residuals in the simple GJR model.
