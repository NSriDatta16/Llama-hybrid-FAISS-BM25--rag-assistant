[site]: crossvalidated
[post_id]: 582972
[parent_id]: 
[tags]: 
Exponential Random Graph Model Implementation Python, Error

So I am trying to implement the most basic Exponential Random Graph Model implementation using Python. Concretely I'm trying to estimate the maximum pseudo likelihood estimate, which can be formulated as a logistic regression problem which should be easily estimable using basic optimization software. I'm using the florentine family dataset for reproducibility. Here is my code: import numpy as np import networkx as nx from math import comb import matplotlib.pyplot as plt from scipy.optimize import minimize import scipy as sp from itertools import product florentine = nx.florentine_families_graph() # need the adjecency matrix which is stored as a sparce matrix y = nx.adjacency_matrix(florentine) # make matrix "normal" y = y.todense() Now comes the most critical step, which is the formulation of the change statistic. In this example we use the most simple statistic which is the number of edges. The change statistic is calculated by: $$ \text{ then } \delta(y_{i,j}) := s(y) - s(y_{i,j}^*) $$ where $y_{i,j}^*$ is the same as $y$ with $y_{i,j}$ toggled. In our example $s$ is just the number of edges. Now we can make a case distinction. Let $n$ be the number of edges in a graph, then if: $$ y_{i,j} = 1 \text{ then } \delta(y_{i,j}) = n - (n-1) = 1\\ y_{i,j} = 0 \text{ then } \delta(y_{i,j}) = n - (n+1) = -1\\ $$ translating this into code: res = np.zeros(y.shape,dtype=int) n = y.shape[0] for i,j in product(range(n),range(n)): temp = 0 if i!=j: if y[i,j] == 1: temp = 1 else: temp = -1 res[i,j] = temp res Next we define the log likelihood for the logistic regression: def llike(beta, res, y): ll = 0 for i in range(n): for j in range(n): ll += y[i,j] * beta * res[i,j] - np.log(1 + np.exp(beta * res[i,j])) return(-ll) and finally: minimize(llike, x0 = [0], args = (res, y)) which results in: x: array([18.2014209]) There is a package in R which allows to do the same computation in a few lines of code: library(ergm) data(florentine) lomodel.01 So the correct estimates should be $-1.609$ . Where is my mistake?
