[site]: stackoverflow
[post_id]: 4741677
[parent_id]: 4728589
[tags]: 
This isn't so much writing a library as rewriting part of the compiler. Neither GCC nor Visual Studio let you define your own pragmas, for one thing, and you'd need to play nicely with the built-in optimizer. Honestly, it seems to me that the actual GPGPU part of this is the easy part. If you want to see how they did OpenMP in GCC, I suggest looking at the GOMP project history.
