[site]: crossvalidated
[post_id]: 526283
[parent_id]: 
[tags]: 
Fitting smooths over different time periods in same GAM

Q: Is it possible to fit smooths over different time periods within the same GAM? Example: I am modelling temporal patterns in the supply of a virus over time. I have built the below GAM in the mgcv package in R. knots1 In this GAM I have fit, in descending order from above: a cyclic smooth for month of the year, to capture overall, annual, temporal trends in virus supply; separate cyclic smooths for month of the year for each different geographical state, to capture differences in annual temporal trends in virus supply by geographic state; a smooth for time, to capture long-term temporal trends in virus supply; separate smooths for time by geographic state, to capture differences in long-term temporal trends in virus supply by geographic state; separate smooths for time by virus form, to capture differences in long-term temporal trends in virus supply according to virus form; fixed effect for geographic state; fixed effect for virus form. My questions is in relation to smooth number 5 included in my model, s(time, by = Vform) . Prior to 2016 the virus that I am working with was produced and supplied as a liquid product and from 2016 onwards it has been produced and supplied as a freeze-dried product. As a consequence, virus form, Vform , essentially completely separates my time series into two periods, 2010-2015 = Liquid form, 2016-2020 = freeze-dried form. This is important for how the virus is used. When I input my smooth into my model as I have above, s(time, by = Vform) , it tries to fit a separate smooth for each form of the virus over my entire time period, 2010-2020. This is incorrect as it is not possible for the liquid form of the virus to exist post 2015 and not possible for the freeze dried form of the virus to exist prior to 2016. What I really need to do is to fit a smooth for the liquid form of the virus over the 2010-2015 period and fit a separate smooth for the freeze-dried form of the virus over the 2016-2020 period. Is this possible, and if so how might one go about doing this?
