[site]: crossvalidated
[post_id]: 637594
[parent_id]: 637590
[tags]: 
The itsadug package makes this process really simple for GAMMs. Below is some simplified and annotated code from the vignette on plotting . First I load the libraries, attach the data that will be used for the model, and fit the GAMM. #### Load Libraries #### library(itsadug) library(mgcv) data(simdat) #### By Factor Smooth GAMM #### m2 To plot the by-factor smooths on top of each other, we have to "grab" the information with the get_modelterm function for each group: #### Get By-Smooth Terms for Plots #### st1 Then you create an empty space to overlay the smooths onto the plot: #### Create Empty Space for Plot #### emptyPlot(2000, # x ranges from 0 to 2000 c(-15,10), # y ranges from -15 to 10 h=0, # horizontal line at 0 main='s(Time)') # title Then you just add the lines with their standard errors shaded onto the plot: #### Overlay Smooths #### plot_error(st1 $Time, # plot x values st1$ fit, # plot y values st1$se.fit, # use this standard error shade=TRUE) # add color shading plot_error(st2 $Time, st2$ fit, st2$se.fit, shade=TRUE, col='red', lty=4, lwd=2) # same here but for second group Finally a legend can be added: #### Add Legend #### legend('bottomleft', # legend location legend=c('Children', 'Adults'), # labels fill=c(alpha('black'), alpha('red'))) # fill colors for legend Which gives you this plot in the end: If you want to make a more elegant, customized ggplot2 style plot, then the gratia package offers a lot of options too.
