[site]: stackoverflow
[post_id]: 4502685
[parent_id]: 
[tags]: 
Program crashing on exit

Whenever I exit my program it gives me this exception "0xC0000022: A process has requested access to an object, but has not been granted those access rights." It breaks right at the end of a function called _lock_file in _file.c. After trying to narrow down what the cause of the problem is I found out that it does not crash if I remove all fclose() function calls in my program then cleaning and rebuilding my program. Even if the function itself is never called it will still crash. Obviously this solution is not ideal. When I tried to use fstream instead it produced a similar crash at the start of the program. It's also worth mentioning that my program uses SDL. Edit: Someone requested a minimal example and this is what I cam up with. main.cpp #include #include /*...*/ #pragma comment(lib, "SDL.lib") #pragma comment(lib, "SDLmain.lib") /*...*/ int main( int argc, char **argv) { if(false) fclose(NULL); return 0; } draw.cpp /*...*/ If I run this it will crash on exit just like I mentioned above. And yes the draw.cpp is completely commented out, but if I remove it from the project the program will run fine. All other files were removed from the project. Edit2: In response to karlphillip I decided to double check if it is actually running and it seems that it is actually crashing at the start with this example. Also it is a Win32 project.
