[site]: stackoverflow
[post_id]: 315518
[parent_id]: 
[tags]: 
PowerShell : how to query AD and exchange mailbox sizes

I just recently found out that exchange server2007 will no longer be supporting WMI, namely the service which uses \ROOT\MicrosoftExchangeV2 . The old script I wrote output the ServerName, StorageGroupName, Storename, MailboxDisplayName, Size, TotalItems, DeletedMessageSizeExtended fields to a CSV text file. How would I go about doing this in PowerShell? I found you can do this in the 2007 Exchange Management Console running Get-MailboxStatistics | FT database, DisplayName, ItemCount, TotalItemSize | Out-File textfile1.txt Which generates some of the exchange fields. How do I go about generating the rest of the Active Directory fields like the description and Office fields found in active directory for the same user in the exchange database and output it to a txt file?
