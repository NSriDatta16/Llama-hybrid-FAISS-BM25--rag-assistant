[site]: crossvalidated
[post_id]: 408863
[parent_id]: 
[tags]: 
IPW for the effect of treatment on treated with a continuous treatment

I've been banging my head against the wall trying to figure out how to construct inverse probability of treatment weights (IPTW) for the population average effect of treatment on treated (PATT) with a continuous treatment. The literature always seems to stop short of a worked example. For example, Hernán and Robins, in the appendix , or in Technical Point 4.1 on page 46 , are quite clear conceptually about how to estimate $Pr[Y_a = 1 | A = a']$ where $a \neq a'$ with weights: $$\frac{Pr[A = a'|L]}{f(A|L)}$$ Were $a$ is the treatment value, $L$ is a vector of confounders, and $f(A|L)$ is the conditional probability density function of $A$ given $L$ . For the population average treatment effect (PATE), the numerator is 1 or some stabilizer like the unconditional probability of treatment, and the denominator is $f(A|L)$ . But for the PATT, I'm stuck. I’m not sure whether it’s a tweak to which observations I model, which observations I use to predict fitted values, which fitted values I use in the probability density function, or how I assign PDFs of treatment. For dichotomous treatment PATT, it's easy: Treated are weighted 1 and untreated are weighted $\frac{Pr[Treatment]}{1-Pr[Treatment]}$ . But since nobody is really "untreated" in the continuous scenario, I'm not sure how to extend the logic. Thanks in advance for your advice!
