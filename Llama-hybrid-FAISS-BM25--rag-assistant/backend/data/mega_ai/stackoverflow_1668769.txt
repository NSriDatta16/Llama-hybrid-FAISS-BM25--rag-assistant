[site]: stackoverflow
[post_id]: 1668769
[parent_id]: 1667926
[tags]: 
The reason you end up having to lie about the user agent is because you are violating Google's TOS: Don't do that. Instead, use the Google Book Search API . The code below is slightly hampered by my lack of familiarity with modules such as XML::Atom , Data::Feed , WWW::OpenSearch . However, it should provide a good starting point. #!/usr/bin/perl use strict; use warnings; use Business::ISBN qw( valid_isbn_checksum ); use LWP::Simple; use XML::Simple; while ( <> ) { s/ISBN:([0-9]+)/'Google Books ID:' . get_google_id_for_isbn($1)/ge; print; } use Carp; sub make_google_books_query { sprintf 'http://books.google.com/books/feeds/volumes?q=isbn:%s', $_[0]; } sub get_google_id_for_isbn { my ($isbn) = @_; my $google_id = eval { defined(valid_isbn_checksum $isbn) or croak "Invalid ISBN: $isbn"; my $query = make_google_books_query($isbn); my $xml = get $query; defined($xml) or croak "No response to "; my $data = XMLin($xml, ForceArray => 1); my @ids = @{ $data->{entry}[0]{'dc:identifier'} }; unless ("ISBN:$isbn" eq $ids[1] or "ISBN:$isbn" eq $ids[2] ) { croak "Invalid search results: '@ids'"; } $ids[0]; }; defined($google_id) ? $google_id : ''; } Given a text file t.txt containing: ISBN:0060930314 ISBN:9780596520106 it outputs: Google Books ID:ioXFqlzsmK8C Google Books ID:lNVHi3TunxsC
