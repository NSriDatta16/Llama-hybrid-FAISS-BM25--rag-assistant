[site]: stackoverflow
[post_id]: 4092302
[parent_id]: 
[tags]: 
Creating a shortcut for runas /netonly and vsvarsall.bat . What are the quoting rules to use?

I am attempting to create a shortcut that will load the vcvarsall.bat (Visual Studio Command prompt) under a runas command. Specifically, I want a shortcut that starts in a specific folder; has the runas network credential set to a domain account; mains local account affinity; and has msbuild environment variables set correctly. Background: We have team city build agents that are not on the domain. Occasionally, I need to troubleshoot them. This means running the build under the team city local account, getting from source using the domain account. I also have the same scenario when working from home - my home computer is not on the domain. I can use runas.exe to get the credentials correct, but I don't get the msbuild environment variables. %SystemRoot%\system32\runas.exe /netonly /user:domain\teamcityagent "%comspec% /k If I load the environment variables as per the shortcut and set the start in folder, I get the environment variables and working folder, but I have to enter my credentials each tfs command. %comspec% /k ""C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"" x86 How can I combine these two into one shortcut? What are the command quoting rules that apply here? Can you concatenate commands in a shortcut? It would be coolest to do this without a batch file, but if I have to fall back on a batch file, I'll do that.
