[site]: stackoverflow
[post_id]: 3131553
[parent_id]: 
[tags]: 
How to download a Excel sheet from the PHP code

I have written the code for getting data from the database and store it in the Excel sheet.I want to download the excel file only. But the following code give the PHP file output as my excel file content. But I need to download the Excel file which is created in the PHP file. addFormat(); $format_bold->setBold(); $format_bold->setColor('red'); $sheet= $excel->addWorksheet('Class I'); $sheet->write(0, 0, "Field Name",$format_bold); $sheet->write(0, 1,"Field Name", $format_bold); $sheet->write(0, 2, "Filed Name",$format_bold); $sheet->write(0, 3,"Filed name", $format_bold); $db = DB::connect( connect query); $q=$db->getAll("select * from table_name"); $rowCount=1; foreach ($q as $row) { foreach ($row as $key => $value) { $sheet->write($rowCount, $key, $value); } $rowCount++; } header('Pragma: no-cache'); header('Expires: 0'); header("Content-type: application/x-msexcel"); header("Content-Type: application/force-download"); header('Content-Disposition: attachment; filename="'$filename'"'); ?>
