[site]: crossvalidated
[post_id]: 203673
[parent_id]: 
[tags]: 
How to use multilevel and hashed categorical variables to build an anomaly detection classifier

I am building a binary classifier to detect hacker intrusions from a network. My dataset has over 20K events, of which 4% are positive (intrusions) and the rest are safe events. I am attempting to use random forests to build the classifier, but most of my variables are categorical variables (i.e., IP addresses) with over 19K levels. Moreover, the data is hashed, so I don't have the actual IP addresses, but its hashed numbers. I considered one hot encoding these variables, but this would result in 19k different variables, or reducing the dimensionality of these variables, but given that they are hashed, I don't think I can do this. Further, I understand that hashing an input could result in two ore more IP addresses associated with a single hash numbers, therefore preventing me using the hash number to discern between safe and unsafe IP addresses (the same hash could in theory be given to both). Is there any way around this? I have other data to work with, but they don't seem to be working that well when attempting, for example, logistic regression. I am considering other methods like weighted logistic regression or maybe an outlier detector, but I haven't used one before.
