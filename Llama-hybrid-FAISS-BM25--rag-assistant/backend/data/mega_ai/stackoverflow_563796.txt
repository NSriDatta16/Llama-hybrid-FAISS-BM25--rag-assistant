[site]: stackoverflow
[post_id]: 563796
[parent_id]: 188162
[tags]: 
Running WinXP and I never seem to have time to kick off a defrag and wait for it to finish. So I wrote my own script to fire off XP's builtin defrag.exe and scheduled it to run nitely. The results are saved to a log file in C:\Temp for later review. @echo off GOTO :MAIN ########################################################### # # Reason: # This script runs the defrag utility. # # Suggestion: # Schedule this script to run daily (via schtasks) # # Example: # SCHTASKS /Create /SC DAILY /ST 03:00:00 # /TR \"C:\path\to\DAILY_DEFRAG.BAT" /TN "Daily Defrag of C Drive\" # # Example: # AT 03:00 /every:Su,M,T,W,Th,F,Sa C:\path\to\DAILY_DEFRAG.BAT # # Required OS: # Windows XP or Windows Server 2003 # # Required files: # DEFRAG.EXE # # ########################################################### :MAIN :: Output a listing of scheduled tasks SCHTASKS /QUERY /V > C:\temp\schtasks.out :: ***************************************************** :: * SITE SPECIFIC Program Parameters * :: ***************************************************** :: * Drive to defrag SET TARGET=C: :: * Log file SET LOGFILE=C:\temp\defrag.log :: ***************************************************** :: * No editable parameters below this line * :: ***************************************************** SETLOCAL :: Announce intentions echo. echo Beginning defragmentation of disk %TARGET% echo ---------------------------------------------- echo. for /f "tokens=1 delims=_" %%a in ('date /t') do set NOW=%%a for /f "tokens=1 delims=_" %%a in ('time /t') do set NOW=%NOW% %%a echo Start time: %NOW% :: Run the defrag utility C:\WINNT\SYSTEM32\defrag.exe %TARGET% -f -v > %LOGFILE% echo. for /f "tokens=1 delims=_" %%a in ('date /t') do set NOW=%%a for /f "tokens=1 delims=_" %%a in ('time /t') do set NOW=%NOW% %%a echo End time: %NOW% echo. echo ---------------------------------------------- echo Defrag complete. echo. :END
