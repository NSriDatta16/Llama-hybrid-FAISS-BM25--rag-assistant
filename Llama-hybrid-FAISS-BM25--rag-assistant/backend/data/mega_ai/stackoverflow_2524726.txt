[site]: stackoverflow
[post_id]: 2524726
[parent_id]: 
[tags]: 
C# newbie problem part 2 - declaring class and method

[AcceptVerbs(HttpVerbs.Post)] public ActionResult Upload(Photo photo) { foreach (string file in Request.Files) { var path = "~/Uploads/Photos/"; HttpPostedFileBase posted = (HttpPostedFileBase)Request.Files[file]; if (posted.ContentLength > 0) { photo.Date = DateTime.Now; photo.AlbumID = 1; photo.Title = Path.GetFileName(posted.FileName); photoRepository.Add(photo); photoRepository.Save(); posted.SaveAs(Server.MapPath(path + photo.PhotoID + ".jpg")); Image img1 = Image.FromFile(Server.MapPath("~/Uploads/Photos/") + photo.PhotoID + ".jpg"); imageHelper.CreateThumbnail(posted, img1); int newWidth = 100; int newHeight = 100; double ratio = 0; if (img1.Width > img1.Height) { ratio = img1.Width / (double)img1.Height; newHeight = (int)(newHeight / ratio); } else { ratio = img1.Height / (double)img1.Width; newWidth = (int)(newWidth / ratio); } Image bmp1 = img1.GetThumbnailImage(newWidth, newHeight, null, IntPtr.Zero); bmp1.Save(Server.MapPath("~/Uploads/Photos/Thumbnails/") + photo.PhotoID + ".jpg"); img1.Dispose(); bmp1.Dispose(); } } return RedirectToAction("Index"); } I would like to organize this code a little better, something like this: [AcceptVerbs(HttpVerbs.Post)] public ActionResult Upload(Photo photo) { foreach (string file in Request.Files) { var path = "~/Uploads/Photos/"; HttpPostedFileBase posted = (HttpPostedFileBase)Request.Files[file]; ImageHelper imageHelper = new ImageHelper(); if (posted.ContentLength > 0) { photo.Date = DateTime.Now; photo.AlbumID = 1; photo.Title = Path.GetFileName(posted.FileName); photoRepository.Add(photo); photoRepository.Save(); posted.SaveAs(Server.MapPath(path + photo.PhotoID + ".jpg")); Image img1 = Image.FromFile(Server.MapPath("~/Uploads/Photos/") + photo.PhotoID + ".jpg"); // Create thumbnail imageHelper.CreateThumbnail(posted, img1); } } return RedirectToAction("Index"); } and here, in Helpers folder I created class and method that will deal with thumbnail: public class ImageHelper { public void CreateThumbnail(HttpPostedFileBase posted, Image img1) { int newWidth = 100; int newHeight = 100; double ratio = 0; if (img1.Width > img1.Height) { ratio = img1.Width / (double)img1.Height; newHeight = (int)(newHeight / ratio); } else { ratio = img1.Height / (double)img1.Width; newWidth = (int)(newWidth / ratio); } Image bmp1 = img1.GetThumbnailImage(newWidth, newHeight, null, IntPtr.Zero); bmp1.Save(Server.MapPath("~/Uploads/Photos/Thumbnails/") + photo.PhotoID + ".jpg"); img1.Dispose(); bmp1.Dispose(); } } But I get compile error that Server (in ImageHelper class in bmp1.Save(Server.MapPath ... line) doesn't exist in the current context, while it works fine if code is in one place. What am I doing wrong and is this even proper way of declaring method and organizing code? Thanks in advance, Ile
