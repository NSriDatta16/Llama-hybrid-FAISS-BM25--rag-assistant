[site]: crossvalidated
[post_id]: 346651
[parent_id]: 
[tags]: 
Calculating Jensen-Shannon and Kullback-Leibler for density splines

I need to find a way to calculate the JS distance (and, by necessity, the KL divergence) between continuous, non-normal (generating distribution unknown) distributions. I have many classes, and many variables for each class, and what I want to do is measure the distance between each class' distribution of each variable. My data is sparse for many of my classes, and is truncated. The best method I've found for getting densities for the distributions, is to calculate log splines using the oldlogspline function from the R logspline package, since it supports truncated distributions. The output is, for each distribution, a vector of the locations of spline knots and a set of coefficients for the spline. What I need to do is (a) calculate the KL divergence between splines representing the distributions, and (b) estimate a spline density as the average of two other spline densities. Both (a) and (b) exceed my meager calculus skills. I would greatly appreciate if anyone can tell me how to do this (preferrably with R code! ;) ). Here is some sample code to generate an example: library(logspline) ab1 breakpoint] set2 breakpoint] spline1 I could solve this if I could find the antiderivative of: $\int e^{b_0 + b_1x + \sum_{i \in k_i Which simplifies to: $\int e^{b_0 + b_1x + \sum_{i \in k_i
