[site]: stackoverflow
[post_id]: 4945663
[parent_id]: 4945595
[tags]: 
Calculating an average requires a table scan since you've got to sum the values and then divide by the number of (relevant) rows. This in turn means that you're doing a lot of rescanning; that's slow. Can you calculate the averages once and store them? That would let your query use those pre-computed values. (Yes, it denormalizes the data, but denormalizing for performance is often necessary; there's a trade-off between performance and minimal data.) It might be appropriate to use a temporary table as the store of the averages.
