[site]: crossvalidated
[post_id]: 586728
[parent_id]: 586715
[tags]: 
This is typically analyzed as a logistic regression because response vs. non-response is a binomial variable, and the email is the treatment. $$logit(y_i) = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_3 x_{i3} + \epsilon_i$$ where $x_{i1} = 1$ if the treated person is in group 1, 0 otherwise, and $E(\epsilon_i) = 0$ The first test is one of asking if there is any effect (similar to the overall F-test in a linear model). $$H_0: p_{CTRL} = p_1 = p_2 = p_3$$ The test of the significance of $\beta_1$ is a test of the difference between the effect of the treatment due to group 1 and control. Because of the logistic transform, this is a comparison of the log-odds of the group vs. control. $$H_0: ln \left( \frac{\frac{p_1}{1-p_1}}{\frac{p_{CTRL}}{1-p_{CTRL}}} \right) = 0$$ R code follows: > X > m1 m0 > # is the response different for at least one group? > # H0: p1 = p2 = p3 = p_CTRL > anova(m1, m0, test = "LRT") Analysis of Deviance Table Model 1: y ~ trt Model 2: y ~ 1 Resid. Df Resid. Dev Df Deviance Pr(>Chi) 1 7996 1471.0 2 7999 1537.4 -3 -66.402 2.514e-14 *** --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 > # reject the null hypothesis at the 0.05 alpha level > > summary(m1) Call: glm(formula = y ~ trt, family = binomial(link = "logit"), data = X) Deviance Residuals: Min 1Q Median 3Q Max -0.2630 -0.2250 -0.1796 -0.0775 3.4086 Coefficients: Estimate Std. Error z value Pr(>|z|) (Intercept) -5.8061 0.4088 -14.201 > # Example: Point Estimate of odds(G1)/odds(CTRL) > exp(coef(m1)[2]) trtG1 8.521367 > 50/6 * (2000-6)/(2000-50) [1] 8.521368 > > # you need to decide the alpha level for these multiple comparisons based on your philosophy on Type I error > > # test of G1 vs CTRL > summary(m1) $coefficients[2,] Estimate Std. Error z value Pr(>|z|) 2.142577e+00 4.332043e-01 4.945880e+00 7.580047e-07 > > # test of G2 vs CTRL > summary(m1)$ coefficients[3,] Estimate Std. Error z value Pr(>|z|) 2.459335e+00 4.270558e-01 5.758815e+00 8.470666e-09 > > # test of G3 vs CTRL > summary(m1)$coefficients[4,] Estimate Std. Error z value Pr(>|z|) 1.6871013024 0.4459947333 3.7827830163 0.0001550846 > Supplement There are other methods of analysis that can be chosen. It is important that the method of analysis be specified prior to the experiment. $H_o$ : There is no relationship between the rows and columns of a two-way table of results > # test for association between rows (treatments) and columns (response) > fisher.test(matrix(c(50, 2000-50, 68, 2000-68, 32, 2000-32, 6, 2000-6), ncol=2, + byrow=TRUE, dimnames = list(c("G1", "G2", "G3", "CTRL"), + c("Respond", "Non-Respond")))) Fishers Exact Test for Count Data data: matrix(c(50, 2000 - 50, 68, 2000 - 68, 32, 2000 - 32, 6, 2000 - 6), ncol = 2, byrow = TRUE, dimnames = list(c("G1", "G2", "G3", "CTRL"), c("Respond", "Non-Respond"))) p-value = 3.458e-14 alternative hypothesis: two.sided > > # test for a two dimensional contingency table > chisq.test(matrix(c(50, 2000-50, 68, 2000-68, 32, 2000-32, 6, 2000-6), ncol=2, + byrow=TRUE, dimnames = list(c("G1", "G2", "G3", "CTRL"), + c("Respond", "Non-Respond")))) Pearsons Chi-squared test data: matrix(c(50, 2000 - 50, 68, 2000 - 68, 32, 2000 - 32, 6, 2000 - 6), ncol = 2, byrow = TRUE, dimnames = list(c("G1", "G2", "G3", "CTRL"), c("Respond", "Non-Respond"))) X-squared = 54.917, df = 3, p-value = 7.152e-12 $H_o$ : Pairwise comparisons of $p_i = p_{ctrl}$ For pairwise comparisons, if they are done on their own, I recommend testing with a Bonferroni-corrected p-value > # three pairwise tests of two proportions (bonferroni corrected p-values should be used) > prop.test(c(50, 6), c(2000, 2000)) 2-sample test for equality of proportions with continuity correction data: c(50, 6) out of c(2000, 2000) X-squared = 33.487, df = 1, p-value = 7.175e-09 alternative hypothesis: two.sided 95 percent confidence interval: 0.01424999 0.02975001 sample estimates: prop 1 prop 2 0.025 0.003 > prop.test(c(68, 6), c(2000, 2000)) 2-sample test for equality of proportions with continuity correction data: c(68, 6) out of c(2000, 2000) X-squared = 51.232, df = 1, p-value = 8.209e-13 alternative hypothesis: two.sided 95 percent confidence interval: 0.02220366 0.03979634 sample estimates: prop 1 prop 2 0.034 0.003 > prop.test(c(32, 6), c(2000, 2000)) 2-sample test for equality of proportions with continuity correction data: c(32, 6) out of c(2000, 2000) X-squared = 16.605, df = 1, p-value = 4.603e-05 alternative hypothesis: two.sided 95 percent confidence interval: 0.006501261 0.019498739 sample estimates: prop 1 prop 2 0.016 0.003
