[site]: crossvalidated
[post_id]: 57657
[parent_id]: 
[tags]: 
Manually evaluating the DIC: very big number of effective parameters?

My problem is the following: I'm evaluating the fit to a function $f(\mathbf{x},\theta)$ via MCMC (because I have some priors on the parameters), and I'm trying to evaluate the DIC, given by: $$\rm{DIC}=\bar{D}+p_D,\ \ \ \ (1)$$ where, if we define the deviance $D(\theta)=-2\log(\mathcal{L(\theta|\mathbf{x})})$, and $L(\theta|\mathbf{x})$ is my likelihood, then $$\bar{D} = E^{\theta}[D] = -2E^{\theta}[\log(\mathcal{L(\theta|\mathbf{x})})],\ \ \ \ (2)$$ where $E^\theta[\cdot]$ represents the expected value over the posterior distribution, and the efective number of parameters , $p_D$, is given by $$p_D = \bar{D}-D(\hat{\theta})\ \ \ \ (3)$$ where $\hat{\theta}$ is the posterior expectation of the parameters. This is so far what I understood from the paper by Spiegelhalter et al. (2002) . The thing is that, just for testing purposes, I'm using a simple gaussian likelihood of the form: $$\mathcal{L}(\theta|\mathbf{x}) = \frac{1}{(2\pi \sigma^2)^{n/2}}\exp\left(-\sum_{i=1}^n\frac{\mathbf{x}_i-\mathbf{f}_i(\theta)}{2\sigma^2}\right),$$ and I'm getting HUGE values for $p_D$. Considering $\sigma$ as a parameter and the fact that $\theta$ is 12-dimensional in my particular application, I would expect values of $p_D$ close to 13, but I get values in the order of 900! What I'm doing to evaluate everything is the following: After thinning my MCMC chain, for each link, I get a value of the likelihood. This gives me a sample of the value of the likelihood at each link, and then I estimate $E^\theta[D]$ as: $$\hat{D} = \frac{1}{L}\sum_{i=1}^LD(\theta_i),$$ where $L$ is the number of links and $\theta_i$ is the value of the parameters (including $\sigma$) at that link. I get the posterior mean of my parameters from all my MCMC links (supposing I'm sampling from the posterior) in order to get $\hat{\theta}$. With estimates for this and for $E^\theta[D]$, I just replace the values in eqs. (2) and (3) to obtain (1). With this procedure I get reasonable values for my estimate of $E^\theta[D]$, but $p_D$ just doesn't seem right. Is there anything wrong in my procedure? Thanks in advance for the help!
