[site]: crossvalidated
[post_id]: 217650
[parent_id]: 217599
[tags]: 
Align spike times to the stimulus. Define a time window relative to the stimulus. Select a subset of trials where that time window is well defined, e.g. it doesn't include end-of-trial, stimulus2, trial wasn't aborted, etc. In each of the trials selected in 3, count how many spikes are inside the time bin and divide by the width of the bin. This is a single trial firing rate. Compute the average of single trial firing rates. Another method is to convolve your spike train with a Gaussian kernel. This is how most "smooth" PSTHs are computed. The spike train can either come from a single trial - giving you a single trial firing rate - or you can combine spike times across trials to compute an average firing rate. Of course you'll still need to 1) align and 2) remove trials with confounding events in the window of interest.
