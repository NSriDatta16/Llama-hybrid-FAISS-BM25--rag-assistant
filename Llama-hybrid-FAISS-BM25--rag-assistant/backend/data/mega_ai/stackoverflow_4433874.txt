[site]: stackoverflow
[post_id]: 4433874
[parent_id]: 
[tags]: 
Autocomplete textbox freezes while executing query. Must be a better way!

everyone! I searched the best I could and did not find exactly the help I was looking for. Problem AutoCompleteTextbox FREEZES and "eats" characters while query is performed Asking for Mimic Google Instant functionality Background First things first: C#, WPF, .NET 4.0 Ok, now that's out of the way, I'm trying to find the best way to implement a dynamic AutoComplete Textbox, which queries a database for results after each letter typed. The following code gets executed when the AutoCompleteTextBox's TextChanged event is fired: public void Execute(object sender, object parameter) { //removed some unnecessary code for the sake of being concise var autoCompleteBox = sender as AutoCompleteTextBox; var e = parameter as SearchTextEventArgs; var result = SearchUnderlyings(e.SearchText); autoCompleteBox.ItemsSource = result; } Now, let's say that SearchUnderlyings(e.SearchText) takes an average of 600-1100ms - during that time, the textbox is frozen and it "eats" any keys pressed. This is an annoying problem I've been having. For some reason, the LINQ in SearchUnderlyings(e.SearchText) is running in the GUI thread. I tried delegating this to a background thread, but still same result. Ideally, I would like the textbox to work the way Google Instant does - but I don't want to be "killing" threads before the server/query can return a result. Anyone have experience or can offer some guidance which will allow me to query as I type without freezing the GUI or killing the server? Thank you guys!
