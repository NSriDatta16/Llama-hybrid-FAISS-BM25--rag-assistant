[site]: stackoverflow
[post_id]: 5624353
[parent_id]: 
[tags]: 
c# A generic error occurred in GDI+

I have this problem when I drag to select region of the image in the picturebox more than two times and run the scanning. This is an OCR system. region OCR(Tab4_Component) //When user is selecting, RegionSelect = true private bool RegionSelect = false; private int x0, x1, y0, y1; private Bitmap bmpImage; private void loadImageBT_Click(object sender, EventArgs e) { try { OpenFileDialog open = new OpenFileDialog(); open.InitialDirectory = @"C:\Users\Shen\Desktop"; open.Filter = "Image Files(*.jpg; *.jpeg)|*.jpg; *.jpeg"; if (open.ShowDialog() == DialogResult.OK) { singleFileInfo = new FileInfo(open.FileName); string dirName = System.IO.Path.GetDirectoryName(open.FileName); loadTB.Text = open.FileName; pictureBox1.Image = new Bitmap(open.FileName); bmpImage = new Bitmap(pictureBox1.Image); } } catch (Exception) { throw new ApplicationException("Failed loading image"); } } //User image selection Start Point private void pictureBox1_MouseDown(object sender, MouseEventArgs e) { RegionSelect = true; //Save the start point. x0 = e.X; y0 = e.Y; } //User select image progress private void pictureBox1_MouseMove(object sender, MouseEventArgs e) { //Do nothing it we're not selecting an area. if (!RegionSelect) return; //Save the new point. x1 = e.X; y1 = e.Y; //Make a Bitmap to display the selection rectangle. Bitmap bm = new Bitmap(bmpImage); //Draw the rectangle in the image. using (Graphics g = Graphics.FromImage(bm)) { g.DrawRectangle(Pens.Red, Math.Min(x0, x1), Math.Min(y0, y1), Math.Abs(x1 - x0), Math.Abs(y1 - y0)); } //Temporary display the image. pictureBox1.Image = bm; } //Image Selection End Point private void pictureBox1_MouseUp(object sender, MouseEventArgs e) { // Do nothing it we're not selecting an area. if (!RegionSelect) return; RegionSelect = false; //Display the original image. pictureBox1.Image = bmpImage; // Copy the selected part of the image. int wid = Math.Abs(x0 - x1); int hgt = Math.Abs(y0 - y1); if ((wid (); var index = 0x0; foreach (var file in files) { if (exit) { return; } var comparableImage = new ComparableImage(file); comparableImages.Add(comparableImage); index++; } index = 0; similarityImagesSorted = new List (); var fileImage = new ComparableImage(singleFileInfo); for (var i = 0; i (similarityImagesSorted); var buttons = new List { ScanBT }; if (similarityImages[0].Similarity > 70) { con = new System.Data.SqlClient.SqlConnection(); con.ConnectionString = "Data Source=SHEN-PC\\SQLEXPRESS;Initial Catalog=CharacterImage;Integrated Security=True"; con.Open(); String getFile = "SELECT ImageName, Character FROM CharacterImage WHERE ImageName='" + similarityImages[0].Destination.ToString() + "'"; SqlCommand cmd2 = new SqlCommand(getFile, con); SqlDataReader rd2 = cmd2.ExecuteReader(); while (rd2.Read()) { for (int i = 0; i ocrTB.AppendText(getText); ocrTB.Invoke(showText); } } con.Close(); } else { MessageBox.Show("No character found!", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error); } } #endregion i understand the reason it occur is that the image has been duplicated. But I have no idea how to solve it.
