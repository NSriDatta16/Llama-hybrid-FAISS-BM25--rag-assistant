[site]: stackoverflow
[post_id]: 949051
[parent_id]: 
[tags]: 
SQL Collapse sequential time series sets together

In MSSQL I have a set of tasks which have start and end times. What I wish to do is collapse sequential tasks together. So my definition of sequential is TaskEndDate equals start of next TaskStartDate, there is no gap in time. In the below dataset, 21:00 to 21:40 is one sequence, then 22:00 to 22:20 & 23:20 to 00:00. TaskStartDate TaskEndDate 2008-09-01 21:00:00.000 2008-09-01 21:05:00.000 2008-09-01 21:05:00.000 2008-09-01 21:10:00.000 2008-09-01 21:10:00.000 2008-09-01 21:15:00.000 2008-09-01 21:15:00.000 2008-09-01 21:20:00.000 2008-09-01 21:20:00.000 2008-09-01 21:25:00.000 2008-09-01 21:25:00.000 2008-09-01 21:30:00.000 2008-09-01 21:30:00.000 2008-09-01 21:35:00.000 2008-09-01 21:35:00.000 2008-09-01 21:40:00.000 2008-09-01 22:00:00.000 2008-09-01 22:05:00.000 2008-09-01 22:05:00.000 2008-09-01 22:10:00.000 2008-09-01 22:10:00.000 2008-09-01 22:15:00.000 2008-09-01 22:15:00.000 2008-09-01 22:20:00.000 2008-09-01 23:20:00.000 2008-09-01 23:25:00.000 2008-09-01 23:25:00.000 2008-09-01 23:30:00.000 2008-09-01 23:30:00.000 2008-09-01 23:35:00.000 2008-09-01 23:35:00.000 2008-09-01 23:40:00.000 2008-09-01 23:40:00.000 2008-09-01 23:45:00.000 2008-09-01 23:45:00.000 2008-09-01 23:50:00.000 2008-09-01 23:50:00.000 2008-09-01 23:55:00.000 2008-09-01 23:55:00.000 2008-09-02 00:00:00.000 Feel free to use CTE's or other MSSQL specific features.
