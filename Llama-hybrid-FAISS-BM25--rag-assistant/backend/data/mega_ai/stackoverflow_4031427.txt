[site]: stackoverflow
[post_id]: 4031427
[parent_id]: 
[tags]: 
How do you find a missing number in a table field starting from a parameter and incrementing sequentially?

Let's say I have an sql server table: NumberTaken CompanyName 2 Fred 3 Fred 4 Fred 6 Fred 7 Fred 8 Fred 11 Fred I need an efficient way to pass in a parameter [StartingNumber] and to count from [StartingNumber] sequentially until I find a number that is missing. For example notice that 1, 5, 9 and 10 are missing from the table. If I supplied the parameter [StartingNumber] = 1, it would check to see if 1 exists, if it does it would check to see if 2 exists and so on and so forth so 1 would be returned here. If [StartNumber] = 6 the function would return 9. In c# pseudo code it would basically be: int ctr = [StartingNumber] while([SELECT NumberTaken FROM tblNumbers Where NumberTaken = ctr] != null) ctr++; return ctr; The problem with that code is that is seems really inefficient if there are thousands of numbers in the table. Also, I can write it in c# code or in a stored procedure whichever is more efficient. Thanks for the help
