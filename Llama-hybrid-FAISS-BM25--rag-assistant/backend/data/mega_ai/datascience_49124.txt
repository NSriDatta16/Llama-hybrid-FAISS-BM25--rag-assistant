[site]: datascience
[post_id]: 49124
[parent_id]: 32103
[tags]: 
You can use the pandas rolling method for that. back = 3 cols = ['high','low'] # calculate rolling mean on the dataframe's columns of interest df_back_average = df[cols].rolling(back).mean() # rename columns before concatenating the result back df_back_average.columns = str(back) + '_back_average_' + df_back_average.columns pd.concat([df[cols],df_back_average], axis=1) high low 3_back_average_high 3_back_average_low 0.000442 0.000445 NaN NaN 0.004580 0.004650 NaN NaN 0.004820 0.004890 0.003281 0.003328 0.004890 0.004920 0.004763 0.004820 0.004750 0.004920 0.004820 0.004910 0.004610 0.004860 0.004750 0.004900 0.004620 0.004800 0.004660 0.004860
