[site]: crossvalidated
[post_id]: 257052
[parent_id]: 257042
[tags]: 
The decomposition of dissimilarity into components explained by groupvar shouldn't change whether you use strata or not - if it does then we have a bug in adonis() . strata refers specifically to how the data are permuted when testing the decomposition of "variance" in the dissimilarities due to groupvar . If you don't use strata then we permute the data randomly and so if your data really do come from $i$ individuals then you will end up with too-liberal a test because your data aren't exchangeable under the null hypothesis of no groupvar effect. If you specify strata then the random shuffling is restricted within levels of strata . However, it occurs to me that it is unlikely that groupvar varies within indID , in which case it may not make sense to restrict the permutations that way. The original adonis() performs sequential tests - as you have observed, and as is the same in Type I sums of squares, order matters. In newer version of vegan, we have adonis2() which implements a different approach to the same MANOVA problem and which has a by argument which will do marginal tests (the effect of x given that y and z are in the model, repeat for all combinationsâ€¦). You might want to look at the dbrda() function which allows a + Condition() function in the formula that you could use to remove or account for the effect of subject ( indID ) prior to investigating the effect og groupvar .
