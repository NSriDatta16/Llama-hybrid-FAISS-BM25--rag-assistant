[site]: crossvalidated
[post_id]: 169671
[parent_id]: 
[tags]: 
adjusting ties for kruskal.wallis

I would like to compare the means of three groups using the Kruskal Wallis test in R. My data looks like this: bosaov category count_genus proportion sampleID combination 1 Bos 1081 0.0892 C1_01 C1 9 Bos 7277 0.6637 C1_02 C1 17 Bos 4815 0.5736 C1_03 C1 . . . 161 Bos 914 0.0824 C2_01 C2 169 Bos 6935 0.6584 C2_02 C2 177 Bos 7703 0.6582 C2_03 C2 . . . 321 Bos 0 0.0000 C3_01 C3 329 Bos 0 0.0000 C3_02 C3 337 Bos 0 0.0000 C3_05 C3 . . . I would like to compare the means of proportion (continous variable) for the three levels (C1, C2, C3) of combination. As my data is not normally distributed I decided to use a Kruskal Wallis Test instead of one way ANOVA. I use the R package PMCMR and the following lines of code: kruskal.test(proportion ~ combination, data = Bosaov) Kruskal-Wallis rank sum test data: proportion by combination Kruskal-Wallis chi-squared = 32.958, df = 2, p-value = 6.97e-08 And for the post-hoc Test: posthoc.kruskal.nemenyi.test(x=Bosaov$proportion, g=Bosaov$combination, method="Tukey") Pairwise comparisons using Tukey and Kramer (Nemenyi) test with Tukey-Dist approximation for independent samples data: Bosaov$proportion and Bosaov$combination C1 C2 C2 0.6 - C3 3.3e-07 3.8e-05 P value adjustment method: none Warning message: In posthoc.kruskal.nemenyi.test.default(x = Bosaov$proportion, g = Bosaov$combination, : Ties are present, p-values are not corrected. I get the warning that ties are present, because in my data some values occur more than once (f.e. 0). I tried to solve this problem by adjustig ties using Bosaov$proportion I don´t get the warning anymore but the problem with randomly adjusted ties is that I logically get not reproducible results. So I decided to use ties.method="average" instead: Bosaov$proportion But if I use ties.method="average" I still get the warning regarding persent ties. posthoc.kruskal.nemenyi.test(x=Bosaov$proportion, g=Bosaov$combination, method="Tukey"). Pairwise comparisons using Tukey and Kramer (Nemenyi) test with Tukey-Dist approximation for independent samples data: Bosaov$proportion and Bosaov$combination C1 C2 C2 0.6 - C3 3.3e-07 3.8e-05 P value adjustment method: none Warning message: In posthoc.kruskal.nemenyi.test.default(x = Bosaov$proportion, g = Bosaov$combination, : Ties are present, p-values are not corrected. This is how my adjusted ties look like rank(Bosaov$proportion, ties.method="average") [1] 31.0 50.0 45.0 56.0 47.0 44.0 28.0 34.0 43.0 38.5 52.0 22.0 46.0 38.5 54.0 58.0 10.5 55.0 25.0 29.0 30.0 49.0 48.0 57.0 40.0 [26] 51.0 24.0 32.0 35.0 33.0 53.0 21.0 26.0 36.0 41.0 37.0 42.0 10.5 10.5 27.0 10.5 10.5 10.5 10.5 10.5 10.5 10.5 10.5 10.5 10.5 [51] 10.5 10.5 10.5 23.0 10.5 10.5 10.5 10.5 I really don´t know what causes the warning message. I´m happy if anybody can help and hope I was clear about the problem. Sorry! That was my first post in this forum which is great I think!
