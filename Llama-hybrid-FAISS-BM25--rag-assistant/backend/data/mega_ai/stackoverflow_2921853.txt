[site]: stackoverflow
[post_id]: 2921853
[parent_id]: 2921631
[tags]: 
It looks like you are almost there. First, I want to point out you can force required declarations in Fortran and it is encouraged. To do so add IMPLICIT NONE after the Subroutine declaration: subroutine pointtopoint(IELEVAT, IDIST, FREQ, HTAMSL, DLOSS, CLUTTER) IMPLICIT NONE [variable declarations] ... end subroutine pointtopoint This may be a good idea in your case because it looks like there is some variable type confusion. If IMPLICIT NONE is not used the Fortran compiler makes assumptions as to what the variable type is by the first character of the variable name. Any variable that begins with an I, J, K, L, M, or N is assumed to be INTEGER and all else is assumed REAL. So the first problem I see is IDIST - you are sending a Single from VB and this probable causing the memory access violation you are seeing. Whatever number is being sent as the Single is being interpreted as an INTEGER and is most likely out of the bounds of the IELEVAT array. Also, one other thing I notice (and this may not be an error - I can't tell because the whole subroutine doesn't appear to be posted) is that the subroutine receives the variable HTAMSL and later on uses HRAMSL. This looks like a possible typo where the programmer actually wanted to used HTAMSL. HTAMSL and HRAMSL are two completely different variables. This is another side effect of not using IMPLICIT NONE - typos go unnoticed and you'll end up with unexpected results.
