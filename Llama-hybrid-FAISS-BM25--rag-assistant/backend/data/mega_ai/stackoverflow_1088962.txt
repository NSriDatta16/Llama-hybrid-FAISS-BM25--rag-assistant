[site]: stackoverflow
[post_id]: 1088962
[parent_id]: 1088928
[tags]: 
For the retrieval part, you can take a look at Common Table Expression . This feature can provide recursive operation using SQL. For the insertion part, you can use the CTE above to regenerate the ID, and insert accordingly.
