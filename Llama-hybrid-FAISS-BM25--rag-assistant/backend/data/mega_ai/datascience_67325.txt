[site]: datascience
[post_id]: 67325
[parent_id]: 67318
[tags]: 
Second Conv layer applies 150 convolutions. What's unclear to me is the dimension after the second Conv layer. Shouldn't it be 13x32x100x150? How is the convolution layer applied on a 3D input? One key idea behind CNNs is to restrict the number of connections compared to fully connected layers. This is, in part, done by using kernels which define a window size of spatial inputs to be considered: As you can see a given green neuron does not consider all blue inputs but only a subset defined by the kernel. However, what this illustration does not show is that the whole input depth is considered. Each neuron of the green layer in the image above is not only connected to $3 \cdot 3$ blue inputs but $3 \cdot 3 \cdot depth_{input}$ blue inputs. That is why a conv. layer outputs as many feature maps (which is equivalent to the depth of the conv. layer) as it applies kernels. Accordingly your second conv. layer will have an output of depth 150. Number of weights for the first Conv layer is 7x7x100, and for the second layer it is 5x5x150x100, meaning that weights are saved for each of the 100 input layers from the previous conv. If you pick a feature map $F$ of a conv. layer: this feature map uses the same weights across the spatial input dimensions, i.e. it needs $K_{widht} \cdot K_{height}$ weights (where $K$ is the kernel size). This means the green neurons in the above image share their weights! However, as explained earlier it not only takes the spatial input shown in that image but considers the whole depth of the input, too. Therefore, a feature map $F$ has $K_{width} \cdot K_{height} \cdot depth_{input}$ weights. And since each conv. layer has $depth_{output}$ of these feature maps the total number of weights for a conv. layer is $K_{width} \cdot K_{height} \cdot depth_{input} \cdot depth_{output}$ . Which is $5 \cdot 5 \cdot 100 \cdot 150$ for the second conv. layer in your example. In case this is still unclear have a look at this explanation from a Stanford class.
