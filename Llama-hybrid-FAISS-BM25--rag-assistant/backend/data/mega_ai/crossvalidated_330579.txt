[site]: crossvalidated
[post_id]: 330579
[parent_id]: 330577
[tags]: 
You can't ensure positivity and sum consistency of hierarchical forecasts if you use forecast::combinef() . What I personally found useful was to set up the summation matrix (see the original publication by Hyndman et al., 2011 ) and then solve the relevant (weighted) least squares problem with additional nonnegativity constraints. This will give you nonnegative and sum consistent forecasts. I have found repeatedly that this approach still results in better forecasts on all levels in the hierarchy. One possible tool that solves (weighted) least squares with linear constraints is the pcls() function in the mgcv package. However, this is of course also not optimized to leverage the specific structure of potential forecast hierarchy matrices, so your performance may be significantly worse than if you use combinef() .
