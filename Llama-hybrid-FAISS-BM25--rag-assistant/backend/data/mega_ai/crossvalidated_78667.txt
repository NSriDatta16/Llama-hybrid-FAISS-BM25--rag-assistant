[site]: crossvalidated
[post_id]: 78667
[parent_id]: 
[tags]: 
Generating Random Vectors with Arbitrary Marginal Distributions via NORTA

When generating random variates from different marginal distributions using the NORTA (Normal-to-Anything) method, as described in Cario & Nelson 2007 , why is $\varrho$ required? To adjust this correlation, we can restrict attention to adjusting $\ E[X_iX_j]$, since $$ Corr[X_i; X_j ] = \frac{E[X_iX_j]-E[X_i]E[X_j]}{\sqrt{Var[X_i]Var[X_j]}} $$ and $\ E[X_i]$, $\ E[X_i]$, $\ Var[X_i]$ and $\ Var[X_i]$ are fixed by $\ F_{X_i} $ and $\ F_{X_j} $. Then, since $\ (Z_i, Z_j)$ has a standard bivariate normal distribution with correlation $\ Corr[Z_i; Z_j ] = (Z_i, Z_j)$, we have $$ E[X_iX_j] = E \Bigl\{ F^{-1}_{X_i}[\Phi(Z_i)]F^{-1}_{X_j}[\Phi(Z_j)] \Bigl\} $$ $$ = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} F^{-1}_{X_i}[\Phi(Z_i)]F^{-1}_{X_j}[\Phi(Z_j)]\varphi_{\varrho z(i,j)}(z_i,z_j)dz_idz_j $$ where $\ \varphi_{\varrho z(i,j)}(z_i,z_j) $ is the standard bivariate normal probability density function (pdf) with correlation $\ \varrho z(i,j) $. We are only interested in distributions for which this expectation exists Isn't it possible to create the desired variates by feeding the required parameters straight into a Gaussian copula? For instance, a -0.5 correlation with U(10) and Expo(10). MATLAB example below. corrZ = [1 -0.5;-0.5 1]; size = 200; Z = mvnrnd([0 0], corrZ, size); X(:,1) = expinv( normcdf(Z(:,1)), 10); X(:,2) = unidinv(normcdf(Z(:,2)), 10); X mean(X) scatter(X(:,2),X(:,1)) Does $\varrho$ preserve the variances and means of the marginals? What am I misunderstanding? One other question: what does it mean when the value found for $\varrho$ lies outside (-1,1)? I have some marginals that make the root finding for the $\varrho$ unsolvable. Why does this occur?
