[site]: crossvalidated
[post_id]: 633316
[parent_id]: 
[tags]: 
How to check linearity of a variable without plots/graphs in R?

I'm running a longitudinal study comparing patients with a lung growth which either developed into cancer (cancer_status = 1) or didn't (= 0). Here is some example randomly-generated data in the same format as the study: patient_ID* cancer_status time_to_outcome cpg_1 cpg_2 1 1 -532 0.49578632 0.9301869 1 1 -121 0.51134914 0.9496315 1 1 0 0.51665110 0.9535245 2 0 -564 0.13605940 0.8912563 2 0 -423 0.09577919 0.7950609 2 0 -266 0.13383500 0.8726626 2 0 0 0.11834631 0.8492904 3 1 -128 0.35097042 0.9727214 3 1 0 0.53230504 0.9643870 etc... *Each patient had multiple measurements/samples taken. Following this tutorial on linear mixed effects modelling, I'm trying to model the effect of cancer_status on each cpg variable over time (i.e., time_to_outcome, measured in days). The tutorial starts by checking whether the variables are linear (an assumption of the linear mixed effects model), by plotting a general additive mixed model (GAMM): library(gamm4) library(splines) # this GAMM adjusts for multiple measurements being taken from each # patient, but doesn't adjust for anything else like sex or age: cpg1_gamm_cases $gam, shade = TRUE, shift = cpg1_gamm_cases$ gam$coefficients[1], ylab = 'CpG_1 cases', residuals = TRUE, pch = 20, pages = 1) cpg1_f $mer) cpg1_r mer) plot(x = cpg1_f, y = cpg1_r, xlab = "Fitted values", ylab = "Residuals", cex = 0.3) abline(lm(resid(cpg1_gamm_cases $mer) ~ fitted(cpg1_gamm_cases$ mer))) result 1: result 2: The above plots show there is no clear linear relationship between cpg_1 and time. (This is expected because the data was randomly generated). Therefore in this case, it probably wouldn't make sense to run a linear mixed effects model on this variable. The problem is: In the study, I don't have just cpg_1 and cpg_2 variables to model, I need to model ~850,000 different cpg variables. (For context, each CpG is a different site on the genome, with a continuous value somewhere between 0 and 1 - this represents the average DNA methylation at the site). Every source I've seen says to test the linearity assumption of linear models by plotting your data and looking at it, as above. However, I can't possibly generate and look at 850,000 different graphs. Is there a simple check for linearity (like a function) which can be run in R? (Somewhat unrelated: there probably should be a simpler way to do this than to run 850k separate models, but this is the approach most published studies seem to be taking for this type of data.)
