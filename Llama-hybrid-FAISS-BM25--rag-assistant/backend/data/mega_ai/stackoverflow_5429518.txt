[site]: stackoverflow
[post_id]: 5429518
[parent_id]: 
[tags]: 
Getting an error using a uniform 1D texture parameter with CG and openGL

I am trying to write a basic volume renderer which uses opengl, and cg for writing shaders. I'm putting my transfer function in a one dimensional texture, and using that in a dependent texture lookup in the fragment shader. My problem is that I'm getting an openGL error when I try to enable the parameter corresponding to that 1D texture. My code is pretty messy; right now it's basically a mashup of code taken from "Real-Time Volume Rendering" and "The CG User's Manual". c file: #include #include #include #include #include static CGcontext myCgContext; static CGprofile myCgVertexProfile, myCgFragmentProfile; static CGprogram myCgVertexProgram, myCgFragmentProgram; static const char *myProgramName = "first_volumetric_renderer", *myVertexProgramFileName = "fvr_vertex.cg", *myVertexProgramName = "fvr_vertex", *myFragmentProgramFileName = "fvr_fragment.cg", *myFragmentProgramName = "fvr_fragment"; static CGparameter first_texture, second_texture, transfer_function; #define XDIM 256 #define YDIM 256 #define ZDIM 256 #define TRANSFER_RESOLUTION 256 static GLubyte raw_data[XDIM][YDIM][ZDIM]; static GLubyte transfer[TRANSFER_RESOLUTION][4]; static GLuint transfer_name; static GLuint x_textures[XDIM], y_textures[YDIM], z_textures[ZDIM]; static void checkForCgError(const char *situation); /* print any errors if we get them */ void check_gl_error(const char * where){ GLenum error = glGetError(); if(error != GL_NO_ERROR){ printf("openGL Error : %s : %s\n", where, gluErrorString(error)); exit(1); } } long int file_length(FILE *f){ long int pos = ftell(f); fseek(f, 0, SEEK_END); long int result = ftell(f); fseek(f, pos, SEEK_SET); return result; } void get_volume_data(const char *filename){ FILE *in = fopen(filename, "r"); if(in == NULL) { printf("opening '%s' to get volume data failed, exiting...\n", filename); exit(1); } long int length = file_length(in); if(length != XDIM*YDIM*ZDIM){ printf("the file does not contain a volume of the correct dimensions\n"); exit(1); } size_t res = fread((char *)raw_data, 1, length, in); if(res fragment shader (fvr_fragment.cg): float4 fvr_fragment(half3 texUV : TEXCOORD0, uniform sampler2D text0, uniform sampler2D text1, uniform sampler1D transfer_function) : COLOR { half tex0 = tex2D(text0, texUV.xy); half tex1 = tex2D(text1, texUV.xy); half interp = lerp(tex0, tex1, texUV.z); float4 result = tex1D(transfer_function, interp); return result; } the volume data When run, the program outputs: openGL Error : before updating parameters : invalid operation the line which causes the error, which I found thanks to my ad-hoc print debugging, is: cgGLEnableTextureParameter(transfer_function); Any ideas?
