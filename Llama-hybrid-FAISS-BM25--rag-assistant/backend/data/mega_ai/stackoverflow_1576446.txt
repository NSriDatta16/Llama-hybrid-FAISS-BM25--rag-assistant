[site]: stackoverflow
[post_id]: 1576446
[parent_id]: 
[tags]: 
How to display images with fixed dimensions in ASP.NET after retrieving them from a MySQL database

Following are the links which describe connection to MySQL: http://www.codeproject.com/KB/aspnet/asp_net_and_mysql.aspx http://www.codeproject.com/KB/aspnet/image_asp.aspx Here is the code to display image from mysql database: protected void Page_Load(object sender, EventArgs e) { MySqlConnection conn = new MySqlConnection(db); conn.Open(); string s; s = Session["t"].ToString(); string commantext = "select img_id,img_file,img_type,img_name from image where img_name='"+s+"'"; // string commantext = "select img_id,img_file,img_type,img_name from image"; // DataSet ds = MySqlHelper.ExecuteDataset(conn, commantext); MySqlCommand cmd = new MySqlCommand(commantext,conn); cmd.Parameters.Add("?img_id", MySqlDbType.Int32).Value = s; // DataTable dt = ds.Tables[0]; DataTable dt = GetData(cmd); while(dt !=null) { Byte[] bytes = (Byte[])dt.Rows[0]["img_file"]; // Byte[] bytes = (Byte[])dt.Rows[1][] ; Response.Buffer = true; Response.Charset = ""; Response.Cache.SetCacheability(HttpCacheability.NoCache); Response.ContentType = dt.Rows[0]["img_type"].ToString(); Response.AddHeader("content-disposition", "attachment;filename=" + dt.Rows[0]["img_name"].ToString()); Response.BinaryWrite(bytes); Response.Flush(); Response.End(); } conn.Close(); } private DataTable GetData(MySqlCommand cmd) { DataTable dt = new DataTable(); //String strConnString = System.Configuration.ConfigurationManager.ConnectionStrings["conString"].ConnectionString; MySqlConnection con = new MySqlConnection(db); MySqlDataAdapter sda = new MySqlDataAdapter(); cmd.CommandType = CommandType.Text; cmd.Connection = con; try { con.Open(); sda.SelectCommand = cmd; sda.Fill(dt); return dt; } catch { return null; } finally { con.Close(); sda.Dispose(); con.Dispose(); } } My code to upload image file to mysql database is as below. protected void Button1_Click(object sender, EventArgs e) { Stream img_strm = File1.PostedFile.InputStream; int img_len = File1.PostedFile.ContentLength; string strtype = File1.PostedFile.ContentType; //code snippet to determine image height and width. System.Drawing.Image i = System.Drawing.Image.FromStream(img_strm); int fileheight = int.Parse(i.Width.ToString()); int filewidth = int.Parse(i.Height.ToString()); strname = Text1.Value; //Session["t"] = strname; byte[] imgData = new byte[img_len]; int n = img_strm.Read(imgData, 0, img_len); int result = saveToDb(strname, imgData, strtype); } private int saveToDb(string imgName, byte[] imgbin, string imgContenttype) { string db = "server=localhost;database=test;uid=root;password=techsoft"; MySqlConnection conn = new MySqlConnection(db); MySqlCommand cmd = new MySqlCommand("insert into image(img_name,img_file,img_type) values(?img_name,?img_file,?img_type)", conn); //MySqlParameter param0 = new MySqlParameter("?img_id", MySqlDbType.Int16, 20); //param0.Value = ; //cmd.Parameters.Add(param0); MySqlParameter param0 = new MySqlParameter("?img_name", MySqlDbType.VarChar, 45); param0.Value = imgName; cmd.Parameters.Add(param0); // MySqlParameter param1 = new MySqlParameter("?img_file", MySqlDbType.VarChar, 45); MySqlParameter param1 = new MySqlParameter("?img_file", MySqlDbType.LongBlob, 10); param1.Value = imgbin; cmd.Parameters.Add(param1); MySqlParameter param2 = new MySqlParameter("?img_type", MySqlDbType.VarChar, 45); param2.Value = imgContenttype; cmd.Parameters.Add(param2); conn.Open(); int num = cmd.ExecuteNonQuery(); conn.Close(); return num; } I have used binary writer to display. Can anybody suggest how to display images in fixed dimensions?
