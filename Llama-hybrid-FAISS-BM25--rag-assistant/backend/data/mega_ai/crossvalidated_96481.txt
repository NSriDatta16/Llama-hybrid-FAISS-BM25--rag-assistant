[site]: crossvalidated
[post_id]: 96481
[parent_id]: 
[tags]: 
How to specify a Bayesian binomial model with shrinkage to the population?

Problem I’m currently working on a problem where I have count data for $n$ items in the following form: Item Count Total -------------------- 1 1 30 2 10 340 3 0 0 4 1 10 ... I want to calculate the posterior of the success probability $p_i$ for each item. Additionally, I suspect that all the items have a similar or even the same success probability but I want the model to determine that. My expectations for the resulting model are: Estimate the underlying global parameter of all the items and Shrink the success probabilities $p_i$ towards this global parameter in order to deal with items which have few observations. Items with observations indicating a different success probability should be able to “override” the global success probability. Stan code This is the Stan code I implemented so far: data { int J; // amount of items int count[J]; int total[J]; } parameters { real mu; real ss; real prob[J]; } model { mu ~ uniform(0, 1); ss ~ gamma(0.01, 0.01); prob ~ beta(mu*ss, (1-mu)*ss); count ~ binomial(total, prob); } Here I achieve the shrinkage by assuming that the success probabilities of the items are sampled from a beta distribution (parametrized using mean and sample size) where the mean is the global success probability. The problem occurs when specifying the prior of the sample size. If I choose a very vague prior, Stan requires a lot of iterations until the effective sample size is large enough. Also I’m not sure if this is the right approach since it is not clear if the amount of shrinkage this model provides is always appropriate. I’m interested if there is an elegant way to implement my expected behavior or if there is some flaw in my overall model.
