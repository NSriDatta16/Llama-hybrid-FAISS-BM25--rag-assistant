[site]: crossvalidated
[post_id]: 404122
[parent_id]: 252903
[tags]: 
Use functions in forecast library to pre-whiten y, using a fitted arima model of x. For example: (fill p, d, q, P, D, Q in arima function or use other functions, like auto.arima to fit an arima model for x) library(forecast) mod_1 You can also do: y You can check whether the pre-whitening method works by: sum(x - mod1$residuals) Why I use the above method is that I don't know how to use filter when there is the MA (Moving Average) part. Additionally, there may be some problems when using prewhiten from "TSA" package. See Prewhiten in R gives “all times contain an NA”, but there are no NA values in the time series .
