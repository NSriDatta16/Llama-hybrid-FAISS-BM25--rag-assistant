[site]: stackoverflow
[post_id]: 5481219
[parent_id]: 
[tags]: 
Get Exchange Receive Connector name for messages traversing thru the Transport pipeline

I need to create a SMTP Receive Agent for the Transport Service in Exchange 2010 Hub Transport Server. What it would do is to add a custom header to any incoming messages according to which Receive Connector they come into. Say I have three configured receive connectors (1. default: port 25; 2. custom port 26; 3. custom port 27). I've figured out how to add the custom header to the message as they come in, but couldn't seem to find the way to identify which connector a given message comes from. Is that even programatically possible? Btw, I used C# and have gone thru the documentation of Exchange 2010 SP1 Transport Agent SDK. Maybe I missed something.
