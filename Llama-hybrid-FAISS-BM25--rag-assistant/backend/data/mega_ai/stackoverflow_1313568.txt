[site]: stackoverflow
[post_id]: 1313568
[parent_id]: 1311920
[tags]: 
You can achieve this using the built-in embed() function, where its second 'dimension' argument is equivalent to what you've called 'lag': x embed() was discussed in a previous answer by Joshua Reich. (Note that I prepended x with NAs to replicate your desired output). It's not particularly well-named but it is quite useful and powerful for operations involving sliding windows, such as rolling sums and moving averages.
