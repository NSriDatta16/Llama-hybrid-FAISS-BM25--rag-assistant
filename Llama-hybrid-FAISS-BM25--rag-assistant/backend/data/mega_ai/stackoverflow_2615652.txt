[site]: stackoverflow
[post_id]: 2615652
[parent_id]: 
[tags]: 
Why am I getting "svn: connection refused by the server"?

We have a Continuous Integration environment setup with TeamCity and subversion. TeamCity gets the latest source from svn and does a build (Visual Studio) on every commit. Sometimes we get the following TeamCity error when the build runs. Doing a couple of force builds gets TeamCity running succesfully. **Build errors [12:35:24]: Patch is broken, can be found in file: C:\TeamCity\buildAgent\temp\cache\temp6036patch_803[12:35:24]: RunBuildException when running build stage UpdateSourcesFromServer: Failed to build patch for build 519 {build id=803}, VCS root: svn: https://svn.myDomain.com/repos/myApplication {id=2}, due to error: org.tmatesoft.svn.core.SVNException: svn: connection refused by the server svn: REPORT request failed on '/repos/myApplication/!svn/vcc/default'** Any ideas why this might be happening ? Here is part of the build log [12:58:39]: [Updating sources: server side checkout...] Transferring cached clean patch for VCS root: [svn url] [12:58:40]: [Updating sources: server side checkout...] Building incremental patch over the cached patch [12:59:30]: [Updating sources: server side checkout...] Failed to build patch for build 146 {build id=806}, VCS root: svn: [svn url]{id=2}, due to error: org.tmatesoft.svn.core.SVNException: svn: connection refused by the server svn: REPORT request failed on '[svn url]!svn/vcc/default' [12:59:30]: [Updating sources: server side checkout...] Repository sources transferred: 14.08Mb total [12:59:30]: [Updating sources: server side checkout...] Average transfer speed: 280.89Kb per second [12:59:30]: Will repeat attempt when server will be available, number of attempts left: 2 [12:59:40]: Updating sources: server side checkout... jetbrains.buildServer.agent.impl.patch.PatchDownloaderImpl$1: Server was not able to build correct patch, most likely due to VCS errors, will try again. jetbrains.buildServer.agent.impl.patch.PatchDownloaderImpl$1: Server was not able to build correct patch, most likely due to VCS errors, will try again. at jetbrains.buildServer.agent.impl.patch.PatchDownloaderImpl.throwError(PatchDownloaderImpl.java:113) at jetbrains.buildServer.agent.impl.patch.PatchDownloaderImpl.checkPatch(PatchDownloaderImpl.java:103) at jetbrains.buildServer.agent.impl.patch.PatchDownloaderImpl.copyPatchAndCheck(PatchDownloaderImpl.java:64) at jetbrains.buildServer.agent.impl.patch.UpdateSourcesPatcherBase.copyPatchToTempFile(UpdateSourcesPatcherBase.java:65) at jetbrains.buildServer.agent.impl.patch.UpdateSourcesFromServer.updateSources(UpdateSourcesFromServer.java:58) at jetbrains.buildServer.agent.impl.patch.UpdateSourcesBuildStageBase.doSourceUpdate(UpdateSourcesBuildStageBase.java:74) at jetbrains.buildServer.agent.impl.patch.UpdateSourcesBuildStageBase.doRecoverableStage(UpdateSourcesBuildStageBase.java:52) at jetbrains.buildServer.agent.impl.runStages.RecoverableBuildStage.doLastAttempt(RecoverableBuildStage.java:101) at jetbrains.buildServer.agent.impl.runStages.RecoverableBuildStage.doBuildStage(RecoverableBuildStage.java:58) at jetbrains.buildServer.agent.impl.BuildRunAction.callRunStage(BuildRunAction.java:119) at jetbrains.buildServer.agent.impl.BuildRunAction.doStages(BuildRunAction.java:83) at jetbrains.buildServer.agent.impl.BuildRunAction.access$000(BuildRunAction.java:18) at jetbrains.buildServer.agent.impl.BuildRunAction$1.run(BuildRunAction.java:56) at java.lang.Thread.run(Thread.java:595) Caused by: jetbrains.buildServer.vcs.patches.UnsuccessfulPatchException: Failed to build patch for build 146 {build id=806}, VCS root: svn: [svn url]{id=2}, due to error: org.tmatesoft.svn.core.SVNException: svn: connection refused by the server svn: REPORT request failed on '[svn url]!svn/vcc/default' at jetbrains.buildServer.vcs.patches.AbstractPatcher$1.fail(AbstractPatcher.java:93) at jetbrains.buildServer.vcs.patches.LowLevelPatcher.readPatchStream(LowLevelPatcher.java:156) at jetbrains.buildServer.vcs.patches.LowLevelPatcher.applyPatch(LowLevelPatcher.java:79) at jetbrains.buildServer.vcs.patches.AbstractPatcher.applyPatch(AbstractPatcher.java:42) at jetbrains.buildServer.agent.impl.patch.PatchApplierImpl.applyPatch(PatchApplierImpl.java:18) at jetbrains.buildServer.agent.impl.patch.PatchDownloaderImpl.checkPatchInFileIsCompleted(PatchDownloaderImpl.java:83) at jetbrains.buildServer.agent.impl.patch.PatchDownloaderImpl.checkPatch(PatchDownloaderImpl.java:93) ... 12 more
