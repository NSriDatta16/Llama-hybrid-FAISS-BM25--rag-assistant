[site]: crossvalidated
[post_id]: 122133
[parent_id]: 
[tags]: 
Maximizing likelihood versus MCMC sampling: Comparing Parameters and Deviance

I am working in R. I use lm() for maximizing the likelihood in the first analysis, and STAN to sample from the posterior in a second analysis. require(rstan) I have fabricated some data. set.seed(123) N I fit a linear model to the data. I'll present results later. lm1 Next, I use STAN to sample from the posterior distribution of a very similar model (same model, but STAN automatically applies uniform priors on parameters where a prior is not specified). Below is the STAN model, which is saved in a file called LM.stan . data{ int N; real y[N]; matrix[N,3] X; } parameters{ real a; vector[3] b; real sigma; } model{ y ~ normal( a + X*b, sigma ); } generated quantities{ real logLik; vector[N] lm; lm Below is the R code that creates a data object that STAN can cope with, and compiles and executes the sampler. standata We can examine the means and standard deviations of the marginal distributions of each parameter, and the mean log likelihood. samples And for comparison, print the maximum likelihood parameter estimates and the maximum log likelihood found using lm() summary(lm1) #Call: #lm(formula = y ~ V1 + V2 + V3, data = data) # #Residuals: # Min 1Q Median 3Q Max #-12.2247 -2.5338 0.0019 2.7010 11.5690 # #Coefficients: # Estimate Std. Error t value Pr(>|t|) #(Intercept) 1.9690 0.1257 15.664 I notice that that parameter estimates and the standard errors are very similar to the means and SDs of the posterior samples. However, the log likelihoods are different. I recognize that the likelihood reported for the posterior samples is a mean, so I check what is the largest likelihood value from the samples and what are the parameter values associated with it. Sure enough, the largest likelihood value is very similar to the maximum likelihood of the data given the OLS model. t(samples[samples[,'logLik'] == max(samples[,'logLik']), , drop=F]) # [,1] #a 1.9935327 #b1 0.9750932 #b2 1.9817911 #b3 4.2507953 #sig 3.9632800 #logLik -2795.8380670 However, the parameter values that resulted in the largest likelihood from the samples differ quite a bit from the OLS estimates. To sumarize, the two strange and most likely related facts that I observe are that 1) the marginal parameter means look a lot like the OLS estimates, but the marginal log likelihood mean doesn't look like the maximum likelihood (from OLS), and 2) the parameters associated with the largest likelihood sample (from STAN), which is very close in value to the OLS likelihood, do not match those of the maximum likelihood estimates (from OLS). Why should I not be surprised by this (particularly fact 2)?
