[site]: stackoverflow
[post_id]: 1330993
[parent_id]: 
[tags]: 
How do I create a SQL Server agent without using a GUI?

I am using Angel LMS and its built on a SQL Server platform. I believe its 2005, but not 100% sure about that. Anyway, maybe my pseudo-code will shed light on that answer. Also single quotes must be used for strings and the concatenate character is +. I need to have something run 2-5 times a day (the frequency is not determined yet, but you get the point). Here's the transaction block/pseudo-code: BEGIN TRANSACTION BEGIN TRY COMMIT TRANSACTION END TRY BEGIN CATCH ROLLBACK TRANSACTION DECLARE @Msg NVARCHAR(MAX) SELECT @Msg=ERROR_MESSAGE() RAISERROR('Error Occured: %s', 20, 101,@msg) WITH LOG END CATCH My only access to the database, is a text box that runs sql commands. I can create and drop tables, run transactions blocks, and obviously select/insert/update/delete. I can't find any commands to create an agent, but only the steps if you are using the Enterprise Manager or whatever the GUI is called. Also, some reference on how to manipulate the timing schedule of the agent would help out. When I test it, I want to set it to run every fifteen minutes or so. EDIT EXEC dbo.sp_add_job @job_name=N'test' returned the error Could not find stored procedure 'dbo.sp_add_job'.
