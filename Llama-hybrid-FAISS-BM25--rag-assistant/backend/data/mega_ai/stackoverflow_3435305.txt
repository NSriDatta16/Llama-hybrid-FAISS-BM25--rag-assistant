[site]: stackoverflow
[post_id]: 3435305
[parent_id]: 3429870
[tags]: 
PcapPacketHandler jPacketHandler = new PcapPacketHandler (){ int totalLength = 0; public void nextPacket(PcapPacket packet, String user) { Ip4 ip = new Ip4(); String sIP; String dIP; if (packet.hasHeader(ip) == false){ return; } totalLength = totalLength+ ip.getPayloadLength(); sIP = org.jnetpcap.packet.format.FormatUtils.ip(ip.source()); dIP = org.jnetpcap.packet.format.FormatUtils.ip(ip.destination()); System.out.println("SIP = "+sIP+" "+"destIP = "+dIP+" "+"Payload Length = "+ip.getPayloadLength()); System.out.println("Total Length = "+totalLength); } }; pcap.loop(10, jPacketHandler, ""); pcap.close();
