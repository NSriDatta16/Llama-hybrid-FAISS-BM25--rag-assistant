[site]: stackoverflow
[post_id]: 4290666
[parent_id]: 4290642
[tags]: 
if i want to do : echo ""; which the correct place to put it that cant make my script become error? If youre goign to do it as an html table then i would jsut output liek you normally right a table... for example you might do: $rResult = mysql_query( $sQuery) or die(); $count = mysql_num_fields($rResult); $html = ' %s %s '; $thead = ''; $tbody = ''; $line = ' %s '; for ($i = 0; $i %s ',mysql_field_name($rResult, $i)); } while(false !== ($row = mysql_fetch_row($rResult))){ $trow = ''; foreach($row as $value){ $trow .= sprintf(' %s ', $value); } $tbody .= sprintf($line, $trow); } header("Content-type: application/vnd.ms-excel; name='excel'"); header("Content-Disposition: attachment; filename=exportfile.xls"); header("Pragma: no-cache"); header("Expires: 0"); print sprintf($html, $thead, $tbody); exit; Youre only getting one row because youre using aggregate functions without a GROUP BY clause. Try adding a GROUP BY on on something that ties each of these "entries" to a specific group like the Lot_no or whatever youre trying to report on. As far as the border, you cant do that with CSV which although readbale by Excel, is not actually an Excel format file with all the extras like formatting for borders. To use things like formatting you need to output native Excel or an html table that can be loaded into excel. Take a look at phpexcel if you need to do that.
