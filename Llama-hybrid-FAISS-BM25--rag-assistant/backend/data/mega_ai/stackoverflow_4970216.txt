[site]: stackoverflow
[post_id]: 4970216
[parent_id]: 
[tags]: 
Cookies in perl lwp

I once wrote a simple 'crawler' to download http pages for me in JAVA. Now I'm trying to rewrite to same thing to Perl, using LWP module. This is my Java code (which works fine): String referer = "http://example.com"; String url = "http://example.com/something/cgi-bin/something.cgi"; String params= "a=0&b=1"; HttpState initialState = new HttpState(); HttpClient httpclient = new HttpClient(); httpclient.setState(initialState); httpclient.getParams().setCookiePolicy(CookiePolicy.NETSCAPE); PostMethod postMethod = new PostMethod(url); postMethod.addRequestHeader("Referer", referer); postMethod.addRequestHeader("User-Agent", " Mozilla/5.0 (Windows; U; Windows NT 6.1; pl; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13"); postMethod.addRequestHeader("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9, / ;q=0.8"); postMethod.addRequestHeader("Content-Type", "application/x-www-form-urlencoded"); String length = String.valueOf(params.length()); postMethod.addRequestHeader("Content-Length", length); postMethod.setRequestBody(params); httpclient.executeMethod(postMethod); And this is the Perl version: my $referer = "http://example.com/something/cgi-bin/something.cgi?module=A"; my $url = "http://example.com/something/cgi-bin/something.cgi"; my @headers = ( 'User-Agent' => 'Mozilla/5.0 (Windows; U; Windows NT 6.1; pl; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13', 'Accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Referer' => $referer, 'Content-Type' => 'application/x-www-form-urlencoded', ); my @params = ( 'a' => '0', 'b' => '1', ); my $browser = LWP::UserAgent->new( ); $browser->cookie_jar({}); $response = $browser->post($url, @params, @headers); print $response->content; The post request executes correctly, but I get another (main) webpage. As if cookies were not working properly... Any guesses what is wrong? Why I'm getting different result from JAVA and perl programs?
