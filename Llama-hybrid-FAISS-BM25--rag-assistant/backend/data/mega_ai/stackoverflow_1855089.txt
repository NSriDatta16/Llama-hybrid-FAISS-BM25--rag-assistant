[site]: stackoverflow
[post_id]: 1855089
[parent_id]: 1839565
[tags]: 
next_sibling should do the job require 'rubygems' require 'nokogiri' frag = Nokogiri::XML(DATA) frag.css('title').each { |t| t['id'] = "ID#{t.next_sibling.next_sibling['number']}" } puts frag.to_xml __END__ Section X Stuff Section Y Stuff Because whitespace is also a node, you have to call next_sibling twice. Maybe there is a way to avoid this. Alternatively you can use an xpath expression to select the number attribute of the next paragraph t['id'] = "ID#{t.xpath('following-sibling::paragraph/@number').first}"
