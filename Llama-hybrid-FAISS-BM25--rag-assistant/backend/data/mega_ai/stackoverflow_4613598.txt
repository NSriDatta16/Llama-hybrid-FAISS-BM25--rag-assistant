[site]: stackoverflow
[post_id]: 4613598
[parent_id]: 
[tags]: 
403 forbidden with HttpWebRequest Class

Dear all, I encountered 403 forbidden message when I try to get web image by HttpWebRequest Class. my code is listed below. How can I solve it ? Thanks ! public void getWebData() { string url = "http://www.bijint.com/hokkaido/tokei_images/HHMM.jpg"; /***** "HH" stands for hour of current time and "MM" for minute *****/ HttpWebRequest httpWebRequest = null; HttpWebResponse httpWebResponse = null; BinaryReader binaryReader = null; FileStream outputFile = null; BinaryWriter binaryWriter = null; StreamReader streamReader = null; try { httpWebRequest = (HttpWebRequest)WebRequest.Create(url); httpWebRequest.Method = "POST"; httpWebRequest.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-TW; rv:1.9.2.12) Gecko/20101026 Firefox/3.6.12 GTB7.1 ( .NET CLR 3.5.30729)"; httpWebRequest.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"; httpWebResponse = (HttpWebResponse)httpWebRequest.GetResponse(); streamReader = new StreamReader(httpWebResponse.GetResponseStream(), Encoding.UTF8); string httpContent = streamReader.ReadToEnd(); listBox1.Items.Add(httpContent); } catch (WebException wex) { listBox1.Items.Add("Exception occurred on request: " + wex.Message); if (wex.Status == WebExceptionStatus.ProtocolError) httpWebResponse = (HttpWebResponse)wex.Response; } finally { if (httpWebResponse != null) httpWebResponse.Close(); if (binaryReader != null) binaryReader.Close(); if (streamReader != null) streamReader.Close(); if (outputFile != null) outputFile.Close(); if (binaryWriter != null) binaryWriter.Close(); } }
