[site]: crossvalidated
[post_id]: 111212
[parent_id]: 110941
[tags]: 
Let's start by developing some intuition. Then I will share three different solution methods that are in agreement about the answer, which is close to $14\%$. I leave it for the reader's amusement to apply any of these four methods to answering the second question (where an Ace is not included). Intuition First, to simplify the analysis, let us temporarily allow "around-the-corner" straights. There are three of them in addition to the ten straights usually allowed: JQKA2, QKA23, and KA234. This makes every card the equivalent of every other card. Because we are allowing these new straights, the estimate we derive will have to be multiplied by $10/13$. (This trick could be used to simplify the subsequent solution methods, but to make them as independent of this analysis as possible, it won't be used again.) Consider the sequence of draws of the five cards. Due to the equivalence of all the cards, it makes no difference what the first one is. It determines a "ball" of radius $4$ consisting of all cards whose values (modulo $13$) lie within $4$ of it. For instance, the ball around a Jack (whose numerical value is $11$) extends from $11-4=7$ through $11+4=15$ modulo $13$, consisting of the cards with values $\{7,8,9,10,11,12,13,14,15\}$ = $\{7,8,9,10,J,Q,K,A,2\}$. This comprises $9/13$ of all the cards. If this card is to be part of a straight, then at least one of the next two cards must lie within this ball. Similarly, the second card comes with its own ball. Because these two balls are so large, they usually comprise all the cards. Sometimes they overlap perfectly, giving only $9$ cards. Let's split the difference and estimate that on average their overlap covers about $11$ cards. That's $11/13$ of the total. (For example, when the cards are $2$ and $5$, the union of their balls includes every card except for the $10$, which is the only one that could not be included in a straight with either a $2$ or a $5$.) Therefore the chance that the third card lies within one of the first two balls is approximately $11/13$. It will usually be closer to one of the first two cards than the other. That's likely where the straight will lie. The fourth and fifth cards need to be close to the third card and whichever of the first or second was nearest to the third card. Typically they must fall within a range of just six cards or so. The chance that they both will lie within such a predetermined range is about $6/13$ each time. For instance, if the first two cards are $2$ and $5$ and the third is a $7$, then $\{5,7\}$ could be part of a straight. The fourth card must either be one of the cards $3,4,6,8,9$ in order to form a straight with the $5$ and $7$ or else it must be one of the cards $A,3,4,6$ to form a straight with the $2$ and $5$. That's a total of $6$ distinct possibilities--and this looks pretty typical. Thus, the chance that conditions are right for a draw into a straight after five cards ought to be around $$\frac{10}{13} \times \frac{11}{13} \times \frac{6}{13} \times \frac{6}{13} \approx 14\%.$$ So much for intuition and estimation: but at least we now have a sense that these conditions aren't all that rare; they ought to occur roughly once every seven games. Simulation A quick R simulation affords a close estimate of the correct answer. $100,000$ iterations (which takes around 20 seconds for this inefficient but straightforward code) yield an estimate of $0.13749 \approx 13.8\%$ with a standard error of $0.0010 = 0.1\%$. That pins the result down to a range of about $13.5\%$ to $14.1\%$: our intuition was good! deck Exhaustive enumeration There are only $\binom{52}{5} = 2,598,960$ possible five-card Poker hands. We can examine them all in short order, counting those that meet the desired conditions. Here is a Mathematica implementation: cards = Join[Range[13], Range[13], Range[13], Range[13]]; hands = Subsets[cards, {5}]; straight[hand_] := With[{h = Union[hand]}, (Length[h] == 5 && (h[[4]] - h[[1]] The output, after about a minute of calculation, is $1056/7735 \approx 13.65\%$. That is within one standard error of the simulated result, constituting very good agreement. Reduction to a solved problem: analytical solution This problem is really the same as a question posed about Scrabble which asks about words that can be drawn from a set of Scrabble tiles (without replacement) into a seven-tile rack. Interpreting "word" as "able to draw into a straight," "tile" as "card", and changing "seven" to "five" makes this the same question with minor variations in its conditions. The same solution method applies. For the record, here is the full Mathematica code. It computes a dictionary of basic words--essentially enumerating all the possible sets of four cards that could draw into a straight--and then uses polynomial algebra quickly to find the non-words of length five. The probabilities of each nonword are readily computed (accounting for drawing from a deck without replacement) and added up. The complementary probability is the chance of getting a "word": that is, of drawing into a straight. alphabet = a + b + c + d + e + f + g + h + i + j + k + l + m; t = Select[Tuples[Range[14], 4], Length[Union[#]] >= 4 && Max[#] - Min[#] a, 2 -> b, 3 -> c, 4 -> d, 5 -> e, 6 -> f, 7 -> g, 8 -> h, 9 -> i, 10 -> j, 11 -> k, 12 -> l, 13 -> m, 14 -> a}; dictionary = Join[Times @@@ t, {a b c d e, b c d e f, c d e f g, d e f g h, e f g h i, f g h i j, g h i j k, h i j k l, i j k l m, j k l m a}]; next[pp_] := PolynomialMod[pp alphabet, dictionary]; nonwords = Nest[next, 1, 5]; 1 - (nonwords /. (Power[x_, n_] -> FactorialPower[4, n]) /. (x_ /; MemberQ[alphabet, x] -> 4)) / FactorialPower[52, 5] Its output is the same as before--but obtained in only two seconds, about thirty times faster than an exhaustive enumeration.
