[site]: crossvalidated
[post_id]: 8126
[parent_id]: 
[tags]: 
How to calculate the hat matrix for logistic regression in R?

I want to calculate the hat matrix directly in R for a logit model. According to Long (1997) the hat matrix for logit models is defined as: $$H = VX(X'VX)^{-1} X'V$$ X is the vector of independent variables, and V is a diagonal matrix with $\sqrt{\pi(1-\pi)}$ on the diagonal. I use the optim function to maximize the likelihood and derive the hessian. So I guess my question is: how do i calculuate $V$ in R? Note: My likelihood function looks like this: loglik And i feed this to the optim function as follows: logit Where x is a matrix of independent variables, and y is a vector with the dependent variable. Note: I know that there are canned procedures for doing this, but I need to do it from scratch
