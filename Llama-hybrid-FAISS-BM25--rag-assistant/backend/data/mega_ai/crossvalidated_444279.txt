[site]: crossvalidated
[post_id]: 444279
[parent_id]: 
[tags]: 
appropriate error term for a randomized complete block design, possible split plot in time, with subsamples (in SAS PROC MIXED))

I am analyzing the results of an agricultural experiment, as follows: Plots are laid out in a randomized complete block design with 3 replications. They have been either conventionally or organically managed (M) for decades, and crops (C) alternate between corn or tomato that within each year each block contains 4 crop*management combinations. I took three soil samples from each plot (ss). I did this for two years (Y). The sampling locations within the plot were not the same in the two years. The blocking addresses strong variability in soil texture. To summarize: 3 blocks (B) 2 management systems (M) 2 crops (C) 3 subsamples (ss) I do a million different analyses on these soils, and I'm interested in comparing the variability due to management with variability due to other factors (including the block) or their interactions with management for the different soil tests. I'm unsure about three aspects of this: Should it be run as a split plot in time? I measure the same plots two years in a row. But it's at different places and they're pretty big. What are the appropriate error terms? See below for what I have now. I think that Block gives variability due to block, Year*Crop*Management*Block gives variability associated with a specific plot? Should I include any other interactions with block? They're all mildly interesting, but it chips away at my degrees of freedom really fast. I get fairly different results if I use Type3 or reml as my estimation method. I use type 3 because with my current model by covariance parameters tend to be 0 or less, and also because I'm interested in seeing the Type3. Is this a good justification? Please see my current SAS code below Proc mixed data=soil covtest method=type3; class Block Year Mgt Crop; model Nitrogen=Year|Mgt|Crop/outp=pred ddfm=satterth; random Block Year*Mgt*Crop*Block; lsmeans Year Mgt Crop Year*Mgt Year*Crop Mgt*Crop Year*Mgt*Crop / slice= (Year Mgt Crop) diff adjust=tukey cl; ods exclude diffs; ods output diffs=dif lsmeans=lsm; title 'FDA'; Run;
