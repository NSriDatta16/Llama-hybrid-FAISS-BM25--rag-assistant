[site]: stackoverflow
[post_id]: 1680979
[parent_id]: 
[tags]: 
How to use XSLT 1.0 or XPath to manipulate an HTML string

This is my problem: The code snippet below (inside the ) does not reliably strip , or tags out of a string using a combination of the substring-before() and substring() functions. The string I'm trying to format is an attribute of a SharePoint SPS 2003 list item - text inputted via a rich text editor. What I ideally need is a catch-all test that will always just grab the text within the string before a line break (effectively the first paragraph). I thought that: Would do that, but it doesn't always work as although the rich text editor inserts and tags, it appears that these are not always represented by the &#x0a; value. Please help - this is driving me nuts. Code: PTAG_OPEN_OR_BR ')"> DTAG '), 'div>'),'&#x0a;')" disable-output-escaping="yes"/> ')"> BRTAG ')-1))" disable-output-escaping="yes"/> NO_TAG EDIT: Will try out your suggestion Tomalak. Thank you. EDIT: 12/11/09 Only just had chance to try this out. Thanks for your help Tomalak - I have one question in regard to rendering this as html rather than xml. when I call the template removeMarkup, I get the following error message: Exception: System.Xml.XmlException Message: ' I'm not sure but I believe that this is because you can't have xslt tags inside other attributes? Is there any way around this? Thanks Tim
