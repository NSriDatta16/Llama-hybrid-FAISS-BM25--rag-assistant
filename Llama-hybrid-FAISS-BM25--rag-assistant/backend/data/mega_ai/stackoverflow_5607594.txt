[site]: stackoverflow
[post_id]: 5607594
[parent_id]: 
[tags]: 
Find linebreaks in a docx file using PHP

My PHP script successfully reads all text from a .docx file, but I cannot figure out where the line breaks should be so it makes the text bunched up and hard to read (one huge paragraph). I have manually gone over all of the XML files to try and figure it out but I cannot figure it out. Here are the functions I use to retrieve the file data and return the plain text. public function read($FilePath) { // Save name of the file parent::SetDocName($FilePath); $Data = $this->docx2text($FilePath); $Data = str_replace(" ", "&gt;", $Data); $Breaks = array("\r\n", "\n", "\r"); $Data = str_replace($Breaks, ' ', $Data); $this->Content = $Data; } function docx2text($filename) { return $this->readZippedXML($filename, "word/document.xml"); } function readZippedXML($archiveFile, $dataFile) { // Create new ZIP archive $zip = new ZipArchive; // Open received archive file if (true === $zip->open($archiveFile)) { // If done, search for the data file in the archive if (($index = $zip->locateName($dataFile)) !== false) { // If found, read it to the string $data = $zip->getFromIndex($index); // Close archive file $zip->close(); // Load XML from a string // Skip errors and warnings $xml = DOMDocument::loadXML($data, LIBXML_NOENT | LIBXML_XINCLUDE | LIBXML_NOERROR | LIBXML_NOWARNING); $xmldata = $xml->saveXML(); //$xmldata = str_replace(" ", "\r\n", $xmldata); // Return data without XML formatting tags return strip_tags($xmldata); } $zip->close(); } // In case of failure return empty string return ""; }
