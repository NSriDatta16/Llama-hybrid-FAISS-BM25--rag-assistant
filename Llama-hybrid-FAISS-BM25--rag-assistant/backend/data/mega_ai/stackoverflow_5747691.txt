[site]: stackoverflow
[post_id]: 5747691
[parent_id]: 
[tags]: 
How can I create a custom sortable field in Outlook populated by a formula?

Having successfully created a custom field in Outlook via a formula and parsing the Subject field; I have now hit a new snag. The custom field is not sortable. It appears as of current that the only way to achieve this is to create a new user property which would then be sortable and could be leveraged when defining the field. The option also exists to push everything into either a VBA script or C# app using the interop. Either way would work for me however I would prefer to go the VBA route and keep it self contained. The emails exist in a folder and can be ran after the fact; the solution does not need to remain constantly active. If anyone could point me to code which can easily achieve this that would be great. If I am missing an option to make the custom field sortable then please provide the alternative as that is the end goal. EDIT: This is what I currently have... Sub SortCustomField() Dim olApp As Outlook.Application Dim objLotusInbox As Outlook.MAPIFolder Dim objLotusInboxItems As Outlook.Items Dim objNameSpace As Outlook.NameSpace Dim objProperty As Outlook.UserDefinedProperty Set olApp = CreateObject("Outlook.Application") Set objNameSpace = olApp.GetNamespace("MAPI") Set objLotusInbox = objNameSpace.GetDefaultFolder(olFolderInbox).Folders("Lotus Notes Inbox") Set objLotusInboxItems = objLotusInbox.Items objLotusInboxItems.Sort "[Notes2Outlook Created]", False Set objLotusInboxItems = Nothing Set objLotusInbox = Nothing Set objNameSpace = Nothing Set olApp = Nothing End Sub Erroring out at the sort; pretty certain it is due to the fact that the stated field is a user defined field as it works on other fields such as From . UPDATE: Made some ground, however when going back to Outlook it does not appear to populate the field defined during the run. Dim olApp As Outlook.Application Dim objLotusInbox As Outlook.MAPIFolder Dim objLotusInboxItems As Outlook.Items Dim objNameSpace As Outlook.NameSpace Dim objMailProperty As Outlook.UserProperty Dim objMailItem As Outlook.MailItem Dim objParsedDate As Date Dim sample As Object Set olApp = CreateObject("Outlook.Application") Set objNameSpace = olApp.GetNamespace("MAPI") Set objLotusInbox = objNameSpace.GetDefaultFolder(olFolderInbox).Folders("Lotus Notes Inbox") Set objLotusInboxItems = objLotusInbox.Items For Each objMailItem In objLotusInboxItems Set objMailProperty = objMailItem.UserProperties.Add("MyUserProp", olDateTime) objParsedDate = CDate(Mid(objMailItem.Subject, (InStr(objMailItem.Subject, "[") + 1), (InStr(objMailItem.Subject, "]") - InStr(objMailItem.Subject, "[")) - 1)) objMailProperty.Value = objParsedDate Next Set objLotusInboxItems = Nothing Set objLotusInbox = Nothing Set objNameSpace = Nothing Set olApp = Nothing
