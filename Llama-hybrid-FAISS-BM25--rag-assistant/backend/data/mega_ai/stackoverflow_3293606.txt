[site]: stackoverflow
[post_id]: 3293606
[parent_id]: 3292777
[tags]: 
How about: // Get the click coordinates relative to the TextBox. int clickX = (int)e.GetPosition(textBox).X; int clickY = (int)e.GetPosition(textBox).Y; int startPosition = 0; double currentHeight = 0; double calculatedHeight = 0; int charIndex; TextBlock tb = new TextBlock(); tb.Width = this.textBox.Width; tb.FontFamily = this.textBox.FontFamily; tb.FontSize = this.textBox.FontSize; for (charIndex = 0; charIndex currentHeight) { if (currentHeight == 0) { currentHeight = tb.ActualHeight; calculatedHeight = currentHeight; } else { startPosition = charIndex + 1; charIndex++; tb.Text = this.textBox.Text.Substring(startPosition, charIndex - startPosition + 1); currentHeight = tb.ActualHeight; calculatedHeight += currentHeight; } } if (tb.ActualWidth > clickX && calculatedHeight > clickY) break; } _insertPoint = charIndex; I won't lie and say it's elegant, but it appears to work reasonably well.
