[site]: stackoverflow
[post_id]: 3584206
[parent_id]: 3549042
[tags]: 
This is my solution to a business problem. They wanted to make USB read-only so data couldn't wander off on thumb drives. After pinging and connecting to WMI I had to determine whether or not the key already existed and the value was set. On a couple thousand computers. keyExists = fnReadKeyValue() '====================================== '====================================== Function fnReadKeyValue() ' ' EXAMPLE VALUES ' const HKEY_LOCAL_MACHINE = &H80000002 ' strComputer = "." ' strKeyPath = "SYSTEM\CurrentControlSet\Control\StorageDevicePolicies" ' strEntryName = "WriteProtect" Set objReg=GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & _ strComputer & "\root\default:StdRegProv") objReg.GetDWordValue HKEY_LOCAL_MACHINE, strKeyPath, strEntryName, strValue if IsNull(strValue) then objLogFile.WriteLine "That registry value doesn't exist." fnReadKeyValue = "FAIL" else fnReadKeyValue = strValue end if End Function
