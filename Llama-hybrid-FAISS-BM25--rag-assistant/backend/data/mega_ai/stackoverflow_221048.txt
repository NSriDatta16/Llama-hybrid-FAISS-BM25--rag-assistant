[site]: stackoverflow
[post_id]: 221048
[parent_id]: 220123
[tags]: 
You need to use RegisterDeviceNotification function. Here is some pointers about how to do it. And one more sample code You can enumerate all mass storage devices using this sample. In General look for SetupDiXXX api's. Please note that taking in consideration dynamic nature of usb devices, using notification mechanism is mandatory IMHO. You might find your self analyzing device that already detached or missing new device that just arrived.
