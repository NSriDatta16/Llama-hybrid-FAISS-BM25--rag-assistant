[site]: stackoverflow
[post_id]: 2107368
[parent_id]: 2106877
[tags]: 
Cool question. I played around a little and by leveraging iterator blocks and LINQ I appear to have improved your revised implementation by about 40% I would be interested to have you test it out using your timing methods and on your network to see what the difference looks like. Here is the meat of it private static IEnumerable GetFileList(string searchPattern, string rootFolderPath) { var rootDir = new DirectoryInfo(rootFolderPath); var dirList = rootDir.GetDirectories("*", SearchOption.AllDirectories); return from directoriesWithFiles in ReturnFiles(dirList, searchPattern).SelectMany(files => files) select directoriesWithFiles; } private static IEnumerable ReturnFiles(DirectoryInfo[] dirList, string fileSearchPattern) { foreach (DirectoryInfo dir in dirList) { yield return dir.GetFiles(fileSearchPattern, SearchOption.TopDirectoryOnly); } }
