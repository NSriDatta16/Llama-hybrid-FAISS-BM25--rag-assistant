[site]: crossvalidated
[post_id]: 612848
[parent_id]: 
[tags]: 
How to estimate variance in censored data?

I have the following model. Let $BP$ be a continuous variable s.t. true relationship is $BP=144+0.5age+4sex+3gene+\epsilon$ . Suppose for subjects with $BP>160$ , there is a probability of 0.5 getting some treatment with effect following truncated normal distribution with mean -15 and standard deviation $sd=2$ , where treatment effect is defined only for $ part of real axis. In data, the treatment will distort the true relationship. Thus I want to correct the treatment effect. I was initially thinking Bayesian approach. However, I encountered issue of convergence for truncated normal density. I will denote $N(\mu,s^2)$ for normal with mean $\mu$ and variance $s^2$ and it will also be used to denote density function. In particular, for treated subjects observed $BP_o$ , it has density proportional to $\int^\infty_{BP_o}N(\mu,s^2)(y)dy$ , where $\mu$ follows some $N(\beta_0+\beta_1age+\beta_2sex+\beta_3gene,\sigma^2)$ , $s$ follows half t distribution with 3 df and $\beta$ 's follow some joint normal distribution centers at $0$ . The Stan code will not converge in this case due to $y-\mu$ is too large in comparison to $s$ . Thus I want to estimate treatment effect sd=2 to give some reasonable informative prior, which might give model a chance for convergence. I have considered the following. If I can match treated and untreated people with $BP>160$ by propensity score and apply linear regression on matched data, then I should be able to extract treatment effect mean. That also extracts $s_1^2=\sigma^2+sd^2$ standard deviation of both treatment and inherent $\epsilon$ variation. $\epsilon$ 's variation $\sigma^2$ can be preliminarily estimated by standard linear model on the whole observed data. Take square root of the difference of the two variations $\sqrt{s_1^2-\sigma^2}$ . I would hope to some sort recover $sd$ . This does not seem to be the case. nsim=1200 age=runif(nsim,min=55,max=74) sex=rbinom(nsim,size=1,prob=0.5) gene=rbinom(nsim,size=1,prob=0.51) sig_err=21 err=rnorm(nsim,mean=0,sd=sig_err) beta0=144;beta1=0.5;beta2=4;beta3=3 Z=beta0+beta1*age+beta2*sex+beta3*gene+err betas=c(beta0,beta1,beta2,beta3) list_hyp=which(Z>160) num_hyp=length(list_hyp) treat=rbinom(num_hyp,1,prob=0.5) old_Z=Z Z[list_hyp]=Z[list_hyp]+treat*rnormTrunc(num_hyp,mean=-15,sd=2,max=0) hyp=data.frame(id=1:nsim,age=age,sex=sex,gene=gene,BP=Z,true_BP=old_Z) hyp $censor=1 hyp$ censor[list_hyp[as.logical(treat)]]=0 data=list(N=dim(hyp)[1], X=as.matrix(hyp[,c('age','sex','gene')],ncol=3), censor=hyp $censor, BP=hyp$ BP, hyp_diag=160 ) hyp_t=hyp %>% filter(censor==0) hyp_u=hyp %>% filter(BP>data$hyp_diag&censor!=0) hyp_dat=rbind(hyp_t,hyp_u) m.out=MatchIt::matchit(censor~age+gene+sex+BP,data=hyp_dat, method='full',distance='glm',link='logit',estimand = 'ATC') m.dat=match.data(m.out) z2=summary(lm(BP~censor+age+gene+sex,weights=weights,data=m.dat)) z3=summary(lm(BP~age+gene+sex,data=hyp %>% filter(censor!=0&BP $sigma^2-z3$ sigma^2) ##trying to estimate treatment sd $Q1:$ How do I give a reasonable prior for treatment effect variance? Or how do I estimate treatment effect variance beforehand? $Q2:$ How do I give a reasonable prior for treatment effect mean? It can be checked from above code that coefficient of censor term represents treatment effect. However, this treatment effect is way to off away from true treatment effect.
