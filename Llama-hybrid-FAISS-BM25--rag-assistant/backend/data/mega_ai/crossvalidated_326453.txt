[site]: crossvalidated
[post_id]: 326453
[parent_id]: 
[tags]: 
Statistic problem to be resolved on Excel (or VBA)

I have a stat problem and I am not sure it can be resolved; I am not good in statistic but maybe someone can help me: I need to create two numbers: $v_1$ and $v_2$ with Excel or VBA. I want both numbers to be selected randomly but following the three given inputs: both numbers must be between two given numbers $v_\mathrm{min}$ and $v_\mathrm{max}$ the average of the distribution of $v_1+v_2$ must be equal to $v_\mathrm{avg}$ $v_1$ > $v_2$ must be true with a given probability $p_1$ Do you know how I can manage it? Thanks Edit: The objective of my exercise is to create a very simplified simulation of a result of a basketball game. I estimate that both teams can only score between $50$ and $110$ points ($v_\mathrm{min} = 50, v_\mathrm{max} = 110$), and I estimate that the cumulative score of both team should be between $130$ and $190$ points ($160$ in average, $v_\mathrm{avg} = 160$). One of the two team is theoretically stronger than the other one so I give, before the simulation the probability of winning, let say for example 60% chance of winning for team 1, which means that $v_1$ (score of team 1) should be larger than $v_2$ (score of team 2) in 60% of the simulation. Following Bernhard posts, I implemented something like this: p = 0.50 r1 = random between {1,2} r2 = ramdom between [0,1] if r1 = 1 if r2 p v1 = truncate (random between [50,80.5]) v2 = truncate (random between [Max(50,130 - v1), Min[110,190-v1)] if r1 = 2 if r2 1- p v2 = truncate (random between [50,80.5]) v1 = truncate (random between [Max(50,130 - v2), Min[110,190-v2)] The previous algorithm means: 1 / I choose randomly to calculate firstly v1 or v2 number 2/ I select another random number: if it is below the value of the given probability p (or 1-p if I calculate v2 number first) then the number is calculated randomly between 80.5 and 110 otherwise calculated randomly between 50 and 80.5 ("a team can score between 50 and 110 points") 3/ I calculate randomly the value of the other number according to the value of the first number taking into account that: - it can only be between 50 and 110 ("a team can score between 50 and 110 points") - the sum of the two numbers is necessarly between 130 and 190 ("the cumulated score of both teams can be between 130 and 190") With a VBA loop I simulated the code on 1,000,000 cases When I select a probability p = 0.50 it works well, I got a result of team1 winning of 50.01% and an average cumulated score of 160.07 (removing cases where the calculation finishes with v1 = v2) But when I select a probability p = 0.55 (which means theorically team 1 should win 55% of the 1,000,000 cases), I don't have a good result. Team 1 is winning effectively only 53.53%. The average cumulated score, however, remains ok : 160.06 Even worse than this: when I select a probability p = 0.0723 (which means theorically team 1 should win 7.23% of the 1,000,000 cases), Team 1 is winning effectively more than 19%... Do you know what is wrong here? Thanks
