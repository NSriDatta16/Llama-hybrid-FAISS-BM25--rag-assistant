[site]: stackoverflow
[post_id]: 2260863
[parent_id]: 2260601
[tags]: 
I'm not entirely clear what you're after here, so I'll recap on what I understand you to be asking. If this is not right, you can clarify your requirements by editing your question: You have a list of a certain number of men and a certain number of women. Each person has a known skill score. You want to divide these into a certain number of teams, with the following aims: you want the teams to be roughly equally-sized you want the average (mean) skill score for each team to be roughly equal you want the ratio of men to women in each team to be roughly equal I would have thought that a simple method to achieve this would be: Create a list of all the men in decreasing order of skill score. Create a list of all the women in decreasing order of skill score. Add the list of women to the end of the list of men. Start at the beginning of the combined list, and allocated each person in turn to a team in a round-robin fashion. (That is to say, allocate the first person to team number one, the second to team number two, and so on until you have allocated one person to each of the teams you wish to create. Then start again with team one, allocating people to each team in order, and so on.) With this approach, you will be guaranteed the following outcomes: If possible (i.e. if the number of teams divides the total number of people), the teams will all have the same number of people. If the teams are not all the same size, the largest team will have exactly one more person than the smallest team. If possible the teams will all have the same number of men. If the teams do not have the same number of men, the team with the most men exactly one more man than the team with the least men. If possible the teams will all have the same number of women. If the teams do not have the same number of women, the team with the most women exactly one more man than the team with the least women. Each team will have men with a range of skill scores, from near the top of the range to near the bottom of the range. Each team will have women with a range of skill scores, from near the top of the range to near the bottom of the range. With sensible data, the mean skill score for each team will be roughly equal (although team one will have a slightly higher mean score than team two, and so on - there are ways of correcting this). If this simple approach doesn't meet your requirements, please let us know what else you had in mind.
