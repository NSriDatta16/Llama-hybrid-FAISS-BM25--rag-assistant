[site]: crossvalidated
[post_id]: 564702
[parent_id]: 
[tags]: 
Two possible definitions of confidence regions: which one to choose?

Let's say you have a parameter vector $(p,q)$ consisting of two proportions, and you want to find a confidence region for the estimator $(\hat{p},\hat{q})$ . Define \begin{equation} H(x,y,p,q)=\frac{n}{1-\rho_{p,q}^2} \Big[\Big( \frac{x-p}{\sigma_p}\Big)^2 -2\rho_{p,q}\Big(\frac{x-p}{\sigma_p}\Big)\Big(\frac{y-q}{\sigma_q}\Big) + \Big(\frac{y-q}{\sigma_q}\Big)^2\Big],\label{gauss2d} \end{equation} with \begin{equation} \sigma_p =\sqrt{p(1-p)}, \quad \sigma_q=\sqrt{q(1-q)}, \quad \rho_{p,q}=-\frac{pq}{\sqrt{pq(1-p)(1-q)}}. \end{equation} The standard way to do it, at least in my case and if my understanding is correct, is to find all $(x,y)$ satisfying $H(x,y,p,q)\leq G_\gamma$ , where $\gamma$ is your confidence level and typically $G_\gamma$ is some quantile of the Hotelling's distribution. You replace $p,\sigma_p,\sigma_q,\rho_{p,q}$ by the values estimated on your data set, and that's it. You end up with an ellipse. But what about the following alternative: replace $G_\gamma$ by some $H_\gamma$ to be determined to provide the same confidence level, and replace $p$ by its estimated value on your dataset, and $\sigma_p,\sigma_q,\rho_{p,q}$ by $\sigma_x,\sigma_y,\rho_{x,y}$ . Essentially, it consists of swapping the roles of $(x,y)$ and $(p,q)$ . The standard method assumes that $(\hat{p},\hat{q})$ is "at the center". The proposed alternative (not even sure if it is new) consists, for each location $(x,y)$ of the parameter space, in checking whether its own (local) confidence region of level $\gamma$ , covers $(\hat{p},\hat{q})$ . If and only if the answer is yes, then $(x,y)$ is included in the confidence region of $(\hat{p},\hat{q})$ . The standard method does the opposite. My question Does my alternative make sense? Is it a well known method already? What are the pluses / minuses of this approach, on a general level? (my alternative approach requires more computations, and it is unclear whether there is a known distribution attached to $H_\gamma$ ). In the example that I worked on, I was hoping to find some differences between the two approaches. In particular, my alternative does not produce ellipses for confidence regions. Yet in my experiments they lead to almost identical results: almost the same boundary, $G_\gamma$ and $H_\gamma$ are almost identical and so on. Is this supposed to be the case? Update In my example, I estimate the two fundamental parameters (the intensity $λ$ and scaling factor $s$ ) of a perturbed lattice point process using minimum contrast estimation via proxy statistics: point counts in some intervals. The proportions $\mu_p$ and $\mu_q$ are respectively the probability that an interval contains zero point, versus one point. It can contain more than one point, but clearly it can not simultaneously contain one and two points. Thus the negative correlation $ρ_{p,q}$ in question, and its explicit computation. More specifically, the situation is almost identical (and asymptotically identical) to the following: we observe a bivariate Bernoulli sequence of iid $(U_k, V_k)$ 's, but for each $k$ , $U_k$ and $V_k$ are correlated with the correlation in question. The random variables have the following joint distribution: $P(U_k=0,V_k=0)=1-\mu_p-\mu_q$ $P(U_k=1,V_k=0)=\mu_p$ $P(U_k=0,V_k=1)=\mu_q$ $P(U_k=1,V_k=1)=0$ The following must be satisfied: $0 and $\mu_p+\mu_q . Why both types of confidence regions may be asymptotically equivalent? A possible explanation is this. My new confidence region (I call it dual confidence region) uses $\sigma_x,\sigma_y,\rho_{x,y}$ : these quantities vary, but they stay very close to $\sigma_p,\sigma_q,\rho_{p,q}$ . When averaged over the $(x,y)$ 's that are in the dual confidence region, their distance to $\sigma_p,\sigma_q,\rho_{p,q}$ tend to zero as $n$ increases. The same applies to confidence interval, though it is possibly easier to understand "dual confidence interval" by first looking at "dual confidence regions". Implementation details based on the example I illustrate here how to compute the two confidence regions. Instead of stating the distribution attached to $G_\gamma$ (Hotelling) and $H_\gamma$ (the same Hotelling, it sounds) based on theoretical arguments, I explain how to produce these quantiles, as well as the confidence regions, via simulations. Let's say we have a data set with $n=20000$ observations, and the estimated proportions computed on the observations are $(\hat{p},\hat{q})$ . Then compute $$\sigma_\hat{p}=\sqrt{\hat{p}(1-\hat{p})},\quad \sigma_\hat{q}=\sqrt{\hat{q}(1-\hat{q})},\quad \rho_{\hat{p},\hat{q}}=-\frac{\hat{p}\hat{q}}{\sqrt{\hat{p}\hat{q}(1-\hat{p})(1-\hat{q})}}.$$ I then produced $N=10000$ simulations, each generating $n$ bivariate vectors, according to the bivariate Bernoulli model discussed above. For each simulation, I computed the estimated proportions in question (the averages). I denoted these two proportions, as $(\hat{x}, \hat{y})$ . Thus, I produced a summary table with $N$ vectors $(\hat{x},\hat{y})$ representing estimated probabilities. For each of the $N$ vectors $(\hat{x},\hat{y})$ , I computed the quantities $$\sigma_\hat{x}=\sqrt{\hat{x}(1-\hat{x})},\quad \sigma_\hat{y}=\sqrt{\hat{y}(1-\hat{y})},\quad \rho_{\hat{x},\hat{y}}=-\frac{\hat{x}\hat{y}}{\sqrt{\hat{x}\hat{y}(1-\hat{x})(1-\hat{y})}}.$$ So my summary statistics is a table consists of $N$ rows [one per $(\hat{x},\hat{y})$ ] and $5$ columns: $\hat{x},\hat{y},\sigma_{\hat{x}},\sigma_{\hat{y}},\rho_{\hat{x},\hat{y}}$ . The same summary table is used to produce both types of confidence regions. Then, for each of the $N$ vectors $(\hat{x},\hat{y})$ , I computed two quantities: \begin{equation} Q_1(\hat{x},\hat{y}) =\frac{n}{1-\rho_{\hat{p},\hat{q}}^2} \Big[\Big( \frac{\hat{x}-\hat{p}}{\sigma_\hat{p}}\Big)^2 -2\rho_{\hat{p},\hat{q}}\Big(\frac{\hat{x}-\hat{p}}{\sigma_\hat{p}}\Big)\Big(\frac{\hat{y}-\hat{q}}{\sigma_\hat{q}}\Big) + \Big(\frac{\hat{y}-\hat{q}}{\sigma_\hat{q}}\Big)^2\Big] \end{equation} \begin{equation} Q_2(\hat{x},\hat{y}) =\frac{n}{1-\rho_{\hat{x},\hat{y}}^2} \Big[\Big( \frac{\hat{p}-\hat{x}}{\sigma_\hat{x}}\Big)^2 -2\rho_{\hat{x},\hat{y}}\Big(\frac{\hat{p}-\hat{x}}{\sigma_\hat{x}}\Big)\Big(\frac{\hat{q}-\hat{y}}{\sigma_\hat{y}}\Big) + \Big(\frac{\hat{q}-\hat{y}}{\sigma_\hat{y}}\Big)^2\Big] \end{equation} The final step consists of sorting my summary table, and let $N=\infty$ . Standard confidence region : Sort the table by values of $Q_1(\hat{x},\hat{y})$ . The vectors $(\hat{x},\hat{y})$ in the first $\gamma N$ rows, after sorting, define your confidence region of level $\gamma$ when $N=\infty$ . The maximum $Q_1(\hat{x},\hat{y})$ in the first $\gamma N$ rows (after sorting) is $G_\gamma$ . In this case, $G_\gamma$ is a quantile of Hotelling when $N=\infty$ . Dual confidence region : same as above except that you sort your table by values of $Q_2(\hat{x},\hat{y})$ this time, and use the notation $H_\gamma$ instead of $G_\gamma$ , since a priori there is no reason to believe that $G_\gamma=H_\gamma$ . However, a posteriori, after looking at the results, it seems like $G_\gamma=H_\gamma$ when $N=\infty$ . The spreadsheet with the results is available on my GitHub repository, here . The simulations were produced using a short, simple script (Perl) listed in column Y. In the spreadsheet, $\hat{p}=0.34023$ and $\hat{q}=0.39723$ .
