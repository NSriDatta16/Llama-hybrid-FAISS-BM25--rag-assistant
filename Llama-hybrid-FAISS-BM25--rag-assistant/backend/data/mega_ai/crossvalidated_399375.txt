[site]: crossvalidated
[post_id]: 399375
[parent_id]: 
[tags]: 
Plotting in logit (regession)

I'm trying to do something a little funny here with a logistic regression. I have a binary outcome, a time variable, and some confounders. I wanted to plot the monthly mean of the outcome in logit and put the regression line on top of it but the estimates seem too far off from the data. I'm sure it's something super bonehaded but lemme know what you think. Here's a simplified version of my problem: set.seed(0) library('tidyverse') # fake data: outcome = (1:100)/300 outcome = lapply(X = outcome, FUN = function(x){sample(x = 0:1, size = 100, replace = TRUE, prob = c(x, 1-x))}) %>% unlist test_set = tibble(outcome = outcome, month = rep(1:100, each = 100), v1 = rnorm(n = 10000), v2 = rnorm(n = 10000), v3 = rnorm(n = 10000), v4 = rnorm(n = 10000), v5 = rnorm(n = 10000), v6 = rnorm(n = 10000)) mod_bin = glm(formula = outcome ~ month + v1 + v2 + v3 + v4 + v5 + v6, family = 'binomial', data = test_set) # now compute the mean adjustment: adj = test_set %>% summarize_at(.vars = vars(matches('v[0-9]')), mean) %>% gather(key = var, value = val) adj = tibble(est = coefficients(mod_bin)[3:8], var = names(coefficients(mod_bin)[3:8])) %>% right_join(adj) slide = sum(adj $est*adj$ val) # Now compute the mean value and go logit test_set %>% group_by(month) %>% summarize(month_mean = mean(outcome)) %>% mutate(month_mean_logit = month_mean/(1-month_mean)) %>% ggplot() + geom_point(aes(x = month, y = month_mean_logit)) + geom_abline(data = NULL, aes(intercept = coefficients(mod_bin)['(Intercept)'] + slide, slope = coefficients(mod_bin)['month'])) Why is the regression line underneath all of the points? My understanding is that we're modeling the log odds of the outcome variable as a linear combination of the predictors. It seems like it should be somewhat close to the monthly average?
