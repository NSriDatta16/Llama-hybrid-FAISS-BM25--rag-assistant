[site]: datascience
[post_id]: 93809
[parent_id]: 
[tags]: 
Adding Validation PyTorch

First of all, I'm new in this field and it's my first this kind of work. I'm trying to train EfficientNet (CNN), the code below is working fine, but I can't succeed to add also validation set to the code below. My validation data is val_X and val_y. I really will appreciate your help. def train(net): BATCH_SIZE = 64 EPOCHS = 10 for epoch in range(EPOCHS): for i in tqdm(range(0, len(train_X), BATCH_SIZE)): batch_X = train_X[i:i+BATCH_SIZE].view(-1,3,224,224) batch_y = train_y[i:i+BATCH_SIZE] batch_X, batch_y = batch_X.to(device), batch_y.to(device) net.zero_grad() outputs = net(batch_X) matches = [torch.argmax(i)==torch.argmax(j) for i, j in zip(outputs, batch_y)] acc = matches.count(True)/len(matches) loss = loss_function(outputs, batch_y) loss.backward() optimizer.step() print(f"Epoch: {epoch}. Acc: {round(float(acc),2)} Loss: {round(float(loss),4)}") train(net)
