[site]: crossvalidated
[post_id]: 367962
[parent_id]: 
[tags]: 
MCMC combined with numerical integration towards more efficient Bayesian inference

I am quite new to Bayesian statistics so the question can be a bit naive. My question is on how to deal with a model with individual coefficients. Simple versions of a task and a model I deal with is bellow. Let there are customers that visit our company from time to time. We are interested in modeling the inter-visit time intervals. The intervals follow the gamma distribution: $$ t_{ij} \sim \mathtt{gamma}(k,\theta), $$ where $i$ is the customer number and $j$ the time interval number for the customer $i$ with $k \sim N(0,10)$ . However we also assume that customers are heterogeneous, which means that every customer has its own individual parameter $\theta_i$ and, in fact, we have the following model: $$ t_{ij} \sim \mathtt{gamma}(k,\theta_i), $$ where $\theta_i$ comes from the inverse gamma distribution: $$ \frac{1}{\theta_i} \sim \mathtt{gamma}(\nu,\sigma), $$ with $\nu,\sigma \sim N(0,10)$ . Thus, the model has 3 parameters: $k,\nu, \sigma$ . The question is how to encode this model (in particular in stan) for efficient inference? The number of observations is high, e.g. 10000+. The first option is to encode it straightforward and allow MCMC sample a large space including $\theta_i$ for every customer. However, it is at least slow and looks like the number of iteration in MCMC should be high. Would it be correct to remove $\theta_i$ from the sampling space and substitute it with numerical integration for computing the target log likelihood as follows: $$ t_{ij} \sim \int \mathtt{gamma}(k,\theta)\mathtt{gamma}\left(\frac{1}{\theta} | \nu,\sigma\right)d{\theta}, $$ where the integral can be computed by taken for example just 1000 (instead of 10000+) points of $\theta^{(i)}$ (given $\nu$ and $\sigma$ ) that are not included into the MCMC sampling space. PS: If "model with individual coefficients" is an incorrect term, I would be grateful to know the correct one, since the correct terms dramatically increase the search possibilities. UPD: I describe the exact model I want to implement, since without it my question seems to be misguiding. The model is from Allenby G.M., Leone R.P., Jen L. A Dynamic Model of Purchase Timing with Application to Direct Marketing // J. Am. Stat. Assoc. 1999. Vol. 94, â„– 446. P. 365. For simplicity I provide no priors. $$ t_{ij} \sim \Phi(\beta_i\cdot x_{ij})\cdot \mathtt{ggamma}(k_1,\theta^{(1)}_i,\gamma) + (1-\Phi(\beta_i\cdot x_{ij}))\cdot \mathtt{ggamma}(k_2,\theta^{(2)}_i,\gamma), $$ $$ \frac{1}{\theta^{(1)}_i} \sim \mathtt{ggamma}(\nu_1,\psi_1,\gamma), $$ $$ \frac{1}{\theta^{(2)}_i} \sim \mathtt{ggamma}(\nu_2,\psi_2,\gamma), $$ $$ \beta \sim N(\mu,\sigma), $$ where $\Phi(x)$ is normal CDF . So the parameters of the model are $\mu,\sigma,$ (vectors corresponding to the covariates $x_{ij}$ ) $\nu_{1,2},\psi_{1,2}, k_{1,2}$ (just 6 numbers). The value of $\gamma$ is considered as a constant and is not from the optimization space.
