[site]: crossvalidated
[post_id]: 99600
[parent_id]: 
[tags]: 
P value for chi-squared goodness of fit of geometric distribution doesn't make sense from R fitdist

Trying to teach myself R and found the following conundrum. I wrote a script to simulate rolling a die and adding the value until a "1" is rolled. This worked well (eventually). The mean and variance matched with the theoretical (1-p)/p. I took one of the runs of 1000 samples and tried to fit a geometric distribution using the R function fitdist from package fitdistrplus. The fitdist seemed to fit reasonably with a "prob" estimate of .139 and std error of .004. Graphs look OK. I then ran gofstat on the output, and the Chi-squared p-value was 10^-11? By the definition of how the data were created, it is a geometric distribution, so why did Chi square fail? Or do I have a fundamental misunderstanding of the underlying maths? I'm not using scripts, but just running commands from the console. Thanks. edit: code added Note: I started calculating the values, rather than rolls, then realized it came out to 4 times the rolls (4 being average roll on a d6). Doh. It was working so I left it in. samples source('~/.active-rstudio-document') [1] "sup=" [1] 20.3182 [1] 5.0747 > swap swap Fitting of the distribution ' geom ' by maximum likelihood Parameters: estimate Std. Error prob 0.1714678 0.004935428 > gofstat(swap) Chi-squared statistic: 13.06858 Degree of freedom of the Chi-squared distribution: 10 Chi-squared p-value: 0.2198627 Chi-squared table: obscounts theocounts 15 46.00000 49.31177 Goodness-of-fit criteria 1-mle-geom Aikake's Information Criterion 5346.514 Bayesian Information Criterion 5351.422
