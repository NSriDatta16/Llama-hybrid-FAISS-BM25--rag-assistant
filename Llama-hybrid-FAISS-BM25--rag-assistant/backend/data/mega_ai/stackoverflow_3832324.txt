[site]: stackoverflow
[post_id]: 3832324
[parent_id]: 3832212
[tags]: 
When comparing floating point, you need to use an epsilon (I used 1e-9 below) to avoid precision errors: select d1.data_point_groupid , min(d1.timeID) [timeId] , min(d1.[value]) [value] from dma.dbo.calculated_average_group_flow d1 where night=1 and 1e-9 >= ( select abs(d1.value - min(d2.value)) from dma.dbo.calculated_average_group_flow d2 where night=1 and d2.[date]=d1.[date] and d2.data_point_groupid=d1.data_point_groupid ) group by d1.data_point_groupid, d1.date
