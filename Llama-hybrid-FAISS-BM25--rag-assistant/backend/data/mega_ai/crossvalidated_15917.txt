[site]: crossvalidated
[post_id]: 15917
[parent_id]: 15913
[tags]: 
Use ddply (from plyr package) first to create the conditional probabilities: Xcond Now, given Y with column A, you can get the result you want e.g. by (if the order is not of importance to you): ddply(Y, .(A), .fun=function(curdfr){ curA No doubt there are more elegant/efficient solutions. Read its help if you don't understand the ddply call - if that fails, get back to us. Edit as per @John's suggestion: X can be used immediately instead of Xcond: ddply(Y, .(A), .fun=function(curdfr){ curA
