[site]: stackoverflow
[post_id]: 4181337
[parent_id]: 626422
[tags]: 
I have a simple way of handling this that might be of use to somebody. I basically want to be able to use the same code for a guest login and a registered user. I also have a mobile version of the website that I want to send to a different login page when the authentication ticket expires. Probably not the most elegant solution, but simple enough: Public Sub btnSubmit_Click(ByVal sender As Object, ByVal e As EventArgs) If Page.IsValid Then Dim userLogin As String = "" userLogin = System.Guid.NewGuid.ToString FormsAuthentication.RedirectFromLoginPage(userLogin, False) ' place a url param throughout my app, only four pages so no ' big problem there in this case g stands for guest Response.Redirect("menu.aspx?m=g", False) End If End Sub Then, in Global.asax: Protected Sub Application_AuthenticateRequest(ByVal sender As Object, ByVal e As System.EventArgs) If Not Request.IsAuthenticated And _ (Not Request.RawUrl.ToLower.Contains("guestlogin.aspx")) And _ (Not Request.RawUrl.ToLower.Contains("registeredlogin.aspx")) And _ (Not Request.RawUrl.ToLower.Contains("mobilelogin.aspx")) Then Response.Redirect("spLogin.aspx?m=" & Request.QueryString("m")) End If End Sub Then, in your login page (the one specified in your Web.config): Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load If Not Page.IsPostBack Then if request.querystring("m")="g" then Response.Redirect("guestlogin.aspx?m=g") elseif request.querystring("m")="r" then Response.Redirect("registeredlogin.aspx?m=r") elseif request.querystring("m")="m" then Response.Redirect("mobilelogin.aspx?m=m") end if End If End Sib
