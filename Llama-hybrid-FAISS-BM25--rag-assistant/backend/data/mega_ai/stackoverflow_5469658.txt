[site]: stackoverflow
[post_id]: 5469658
[parent_id]: 5469368
[tags]: 
If you already used the api of System.Xml to create the XBatch element why don't you use it for all your xml fragment? private XmlElement CreateXmlDoc(string name, int age, string city, string country) { XmlDocument xDoc = new XmlDocument(); XmlElement xBatch = xDoc.CreateElement("Batch"); xBatch.SetAttribute("OnError", "Continue"); xDoc.AppendChild(xBatch); XmlElement method = xDoc.CreateElement("Method"); method.SetAttribute("ID", "1"); method.SetAttribute("Cmd", "New"); xBatch.AppendChild(method); method.AppendChild(createFieldElement(xDoc, "Name", name)); method.AppendChild(createFieldElement(xDoc, "Age", name)); method.AppendChild(createFieldElement(xDoc, "City", name)); method.AppendChild(createFieldElement(xDoc, "Country", name)); return xBatch; } private XmlElement createFieldElement(XmlDocument doc, string name, string value) { XmlElement field = doc.CreateElement("Field"); field.SetAttribute("Name", name); field.Value = value; return field; }
