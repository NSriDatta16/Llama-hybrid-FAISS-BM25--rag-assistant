[site]: crossvalidated
[post_id]: 167333
[parent_id]: 167324
[tags]: 
The covariance for logistic regression from subra is correct. But $w_{ii}=\hat{\pi_i}(1-\hat{\pi_i})$. There should not have a $n_i$. ref. David W. Hosmer Applied Logistic Regression (2nd Editiion) p35 and p41 formular(2.8) I revised your program and compare with variance estimation, they are close but not the same. library(Matrix) library(sandwich) mydata They are the same at the first five digits
