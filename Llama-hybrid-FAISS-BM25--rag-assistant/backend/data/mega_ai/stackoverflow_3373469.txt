[site]: stackoverflow
[post_id]: 3373469
[parent_id]: 3372187
[tags]: 
Is this what you need? (Are you trying to calculate the average daily number of each operation for each user) SELECT * INTO #tblOperationLog FROM ( SELECT 'Alice' AS Users, CAST('2010-07-29' AS DATE) AS [DATE], 'Delete' AS OPERATION UNION ALL SELECT 'Bob' AS Users, CAST('2010-07-30' AS DATE) AS [DATE], 'Insert' AS OPERATION UNION ALL SELECT 'Bob' AS Users, CAST('2010-07-30' AS DATE) AS [DATE], 'Insert' AS OPERATION ) DemoData DECLARE @DateCount float SELECT @DateCount= COUNT(DISTINCT [DATE]) FROM #tblOperationLog SELECT Users, COUNT(CASE WHEN OPERATION = 'Delete' THEN 1 END)/@DateCount AS DelAverage, COUNT(CASE WHEN OPERATION = 'Insert' THEN 1 END)/@DateCount AS UpdateAverage, COUNT(CASE WHEN OPERATION = 'Update' THEN 1 END)/@DateCount AS InsertAverage FROM #tblOperationLog GROUP BY Users Output Users DelAverage UpdateAverage InsertAverage ----- ---------------------- ---------------------- ---------------------- Alice 0.5 0 0 Bob 0 1 0
