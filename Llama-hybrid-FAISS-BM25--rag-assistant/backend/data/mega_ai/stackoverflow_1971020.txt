[site]: stackoverflow
[post_id]: 1971020
[parent_id]: 1960503
[tags]: 
To pass an object you have to pass an object, not a string. To make this method work as expected you would have to have the object prior to the procedure call, but in your code example it looks like you are trying to pass an object that you don't have. A working example: Set objFSO = CreateObject("Scripting.FileSystemObject") UseFileSystemObject objFSO Sub UseFileSystemObject( objfso) 'Now I can use the FileSystemObject in this procedure. End Sub But calling the UseFileSystemObject procedure like this will not work, UseFileSystemObject "objFSO" because you are passing in a string not an object. The only way I can think of to accomplish what you want is to use a select statement to write the appropriate attribute of the object, something like this. Call PerfCounter "Average Disk Queue Length", "disk_queueLength", "AvgDiskQueueLength" Sub PerfCounter(CounterDescription, CounterLabel, CounterObjectAttribute) Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_PerfFormattedData_PerfDisk_PhysicalDisk",,48) For Each objItem in colItems Select Case CounterObjectAttribute Case "ObjectAttribute1" Case "ObjectAttribute2" Case "AvgDiskQueueLength" Wscript.Echo objItem.AvgDiskQueueLength End Select Next End Sub So in the select you would have to add a case for each attribute that can be used, but it would allow you to pass a string into the procedure. I might be way off on this, but I don't know how you can pass an object if you don't have the object first.
