[site]: stackoverflow
[post_id]: 1280307
[parent_id]: 1276613
[tags]: 
(use '[clojure.contrib str-utils duck-streams pprint] '[clojure set]) (defn read-bookmarks [filename] (apply hash-map (mapcat #(re-split #"\|" % 2) (read-lines filename)))) (defn diff-bookmarks [filename1 filename2] (let [f1 (read-bookmarks filename1) f2 (read-bookmarks filename2) k1 (set (keys f1)) k2 (set (keys f2)) missing-in-1 (difference k2 k1) missing-in-2 (difference k1 k2) present-but-different (filter #(not= (f1 %) (f2 %)) (intersection k1 k2))] (cl-format nil "~{Id #~a is missing in set #1~%~}~{Id #~a is missing in set #2~%~}~{~{Id #~a is different~% -> ~a~% -> ~a~%~}~}" missing-in-1 missing-in-2 (map #(list % (f1 %) (f2 %)) present-but-different)))) (print (diff-bookmarks "bookmarks.csv" "bookmarks2.csv"))
