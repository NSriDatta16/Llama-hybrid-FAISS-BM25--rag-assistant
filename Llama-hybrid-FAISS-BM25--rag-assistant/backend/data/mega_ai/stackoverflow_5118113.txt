[site]: stackoverflow
[post_id]: 5118113
[parent_id]: 
[tags]: 
Convert from .csv file to .xlsx excel file

Hi I am using an ASP.NET application and producing a report in excel page with .csv extension. However I would like to produce it with .xlsx etension. The code I am currently using is as follows: Protected Sub btnSubmit_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnSubmit.Click Dim sql As String Dim strLine As String = "" Dim attachment As String = "attachment; filename=PTW.csv" m_sBranch = ddlBranches.SelectedValue m_sRegion = ddlAreas.SelectedValue Dim cnn As SqlConnection = New SqlConnection("Server=XYZ;Database=abc;Trusted_Connection=yes;") HttpContext.Current.Response.AddHeader("content-disposition", attachment) HttpContext.Current.Response.ContentType = "text/csv" cnn.Open() sql = GetReportSql(m_sBranch, m_sRegion) Dim cmd As SqlCommand = New SqlCommand(sql, cnn) Dim dr As SqlDataReader dr = cmd.ExecuteReader() HttpContext.Current.Response.Write("PTW JOBS - EXPORTED ON " + DateTime.Now) For i = 0 To dr.FieldCount - 1 strLine = strLine & dr.GetName(i).ToString & "," Next HttpContext.Current.Response.Write(strLine) Dim sb As StringBuilder = New StringBuilder() Dim temp As String = "" While dr.Read() For i = 0 To dr.FieldCount - 1 temp = temp & dr.GetValue(i) temp = temp.Replace(",", " ") sb.Append(temp & ",") temp = "" Next sb.AppendLine() strLine = "" End While HttpContext.Current.Response.Write(sb.ToString()) End Sub Any help will be highly appreciated. Thanks.
