[site]: datascience
[post_id]: 121396
[parent_id]: 
[tags]: 
Input to reshape is a tensor with 4096 values, but the requested shape requires a multiple of 6400. (Having problem with shapes)

I am trying to make a caption generator model. (Having problem with shapes) I am getting error as Input to reshape is a tensor with 4096 values, but the requested shape requires a multiple of 6400 Help me out here . here is the model UNITS = 128 IMG_SIZE = 240 BATCH_SIZE = 32 IMG_SHAPE = (IMG_SIZE, IMG_SIZE, 3) max_len = 50 VOCAB_SIZE = tokenizer.vocabulary_size() def get_model(): embdding_layer = Embedding(input_dim = VOCAB_SIZE, output_dim = UNITS, input_length = max_len, mask_zero = True) rnn = LSTM(UNITS, return_sequences=True, return_state=True) # image inputs image_input = Input(shape=IMG_SHAPE) print(image_input.shape) x = resnet_preprocessing(image_input) print('preprocess: ', x.shape) x = resnet(x) print('resnet: ',x.shape) x = Flatten()(x) print('Flatten:',x.shape) # x = layers.MaxPooling2D()(x) # print('pooling:',x.shape) x = Dense(UNITS)(x) print('dense: ',x.shape) # x = x = tf.reshape(x, (-1, 50, 128)) print('reshape: ',x.shape) print('') # text inputs text_input = Input(shape=(max_len,)) print('text_input: ',text_input.shape) i = embdding_layer(text_input) print('embedding: ',i.shape) i, j, k = rnn(i) i, _, _ = rnn(i, initial_state=[j,k]) print('i:', i.shape) # attention between x and i l = Attention()([x, i]) ll = Attention()([i, x]) print('attentions: ',l.shape, ll.shape) # concatnate x and i m = Concatenate()([l, ll ]) print('concat attention: ',m.shape) m = Dense(VOCAB_SIZE)(m) print('dense out: ',m.shape) return keras.Model(inputs = [image_input, text_input], outputs = m) output shapes (None, 240, 240, 3) preprocess: (None, 240, 240, 3) resnet: (None, 8, 8, 2048) Flatten: (None, 131072) dense: (None, 128) reshape: (None, 50, 128) text_input: (None, 50) embedding: (None, 50, 128) i: (None, 50, 128) attentions: (None, 50, 128) (None, 50, 128) concat attention: (None, 50, 256) dense out: (None, 50, 19770)
