[site]: crossvalidated
[post_id]: 307626
[parent_id]: 
[tags]: 
Implementing Hamed and Rao (1998) and Yue and Wang (2004) Modified Mann-Kendall test in R- Help with Correction Factor Calculation?

I am trying to modify the code mkTrend.R from 'fume' package to implement Hamed and Rao (1998) variance correction approach. From the code of mkTrend, the following line is very confusing (Line-29 to Line-34) Now, Please help me with the following three questions • According to literature the auto correlation function is to be calculated from the ranks of observations. In the program. auto correlation is calculated as rank(lm(x ~ I(1:n))$resid) instead of simple rank(x) acf(rank(lm(x ~ I(1:n))$resid), lag.max=(n-1), plot=FALSE)$acf[-1] -> ro • Similarly based on the confidence interval value from normal distribution table, only values that cross the significance bounds are considered. qnorm((1+ci)/2)/sqrt(n) -> sig rep(NA,length(ro)) -> rof for (i in 1:(length(ro))) { if(ro[i] > sig || ro[i] • From the literature titled 'Non stationarities in hydrologic and environmental time series' by Rao et al., 2003. (Page-34) and Basista et al., (2009). Analysis of historical changes in rainfall in the Indian Himalayas (Page-560b just before equation 9), It is mentioned that "the autocorrelation becomes insignificant after a lag of three". So first three lags are suggested. So, Can I write the Auto Correlation function for the Ranks of observations as below: acf(rank(x),lag.max = 3) -> ro
