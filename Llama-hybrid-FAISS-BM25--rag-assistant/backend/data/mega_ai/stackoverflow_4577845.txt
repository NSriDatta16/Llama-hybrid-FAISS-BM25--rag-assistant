[site]: stackoverflow
[post_id]: 4577845
[parent_id]: 4566532
[tags]: 
Here's a possible cause. Your highlighter needs to use the same Analyzer used for search. IIUC, Your code uses a default analyzer for the highlighting, even though it uses a specialized analyzer for parsing the query. I believe you need to change the Fragmenter to work with your specific TokenStream.
