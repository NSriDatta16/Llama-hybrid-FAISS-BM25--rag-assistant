[site]: stackoverflow
[post_id]: 5047668
[parent_id]: 5047485
[tags]: 
The absolute best option is to use ShellExecuteEx , passing the SEE_MASK_CLASSNAME flag, to open this file as if it were a ".txt" . This is the only method that will support things like DDE-based and drag-and-drop-based file opening mechanisms. But if you want to do it yourself (e.g. running with partial trust and can't p/invoke ShellExecuteEx ), here's how: There's another level of indirection. You first have to lookup HKCR\.txt Read the default value out of that key, call it txtkey . Then check HKCR\ txtkey \shell\open\command There's also a function to do this for you: AssocQueryString
