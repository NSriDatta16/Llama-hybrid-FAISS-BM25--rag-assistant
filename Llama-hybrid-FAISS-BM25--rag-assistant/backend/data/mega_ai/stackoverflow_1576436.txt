[site]: stackoverflow
[post_id]: 1576436
[parent_id]: 
[tags]: 
loading xml data into database using datatable

Hi friends hope all are doing well. I am facing one problem while saving data into sql server database from xml file using datatable using vb.net i.e. "Conversion from type 'DBNull' to type 'String' is not valid" . But not always getting error may be based on xml file. Below follows one of my xml files. I used to generate xml file randomly. - Senior Network Administrator - - 10/15/2009 11/14/2009 10/15/2009 xxxx xxx xxx 888899 90,000.00 100,000.00 Per Year xxx 4 6 - QA Test Analyst- Banking and Finance - - 10/15/2009 11/14/2009 10/15/2009 xxx xxx 8888 90,000.00 100,000.00 Per Year xxx Michael Page International 6 Senior Network Administrator - - 10/15/2009 11/14/2009 10/15/2009 xxxx xxx xxx 888899 90,000.00 100,000.00 Per Year xxx 4 6 Pls. help me to overcome this problem. Thanks in advance. ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++= Protected Sub lnkbtnUpload_Click(ByVal sender As Object, ByVal e As System.EventArgs) Dim fid, filename As String fid = CType(sender.parent.controls(0).parent.parent.controls(0), TableCell).Text filename = fid & ".xml" Dim uploadDS As New DataSet Dim tempDT As New DataTable Dim i As Integer Dim ConeFilePath As String = Nothing ConeFilePath = "~/CareerOneModifiedFeeds/" & filename.ToString() uploadDS.ReadXml(Server.MapPath(ConeFilePath)) tempDT = uploadDS.Tables(0).DefaultView.ToTable Dim dtRow As DataRow Dim JobCount As Integer Dim Count As Integer = 0 Dim strsaltype, strsalcur As String Dim strMinSal, strMaxSal As String For i = 0 To tempDT.Rows.Count - 1 Count = Count + 1 dtRow = tempDT.Rows(i) 'Code to get the check whether the job id already exists or not JobCount = Dr.CheckJobIDExists(UserID, Trim(dtRow.Item("JOB_ID"))) Dim FullLoc As String = Replace(dtRow.Item("COUNTRY"), "'", "''").Trim() + "-" + Replace(dtRow.Item("STATE"), "'", "''").Trim() If dtRow.Item("CITY") <> "" Then FullLoc = FullLoc + "-" + Replace(dtRow.Item("CITY"), "'", "''").Trim() End If If JobCount = 1 Then ' Update the record aganist that jobid DR.UpdateExistingCareerOneJobs_XML(UserID, Trim(dtRow.Item("JOB_ID")), Trim(Replace(dtRow.Item("TITLE"), "'", "''")), _ Trim(Replace(dtRow.Item("Summary"), "'", "''")), Trim(Replace(dtRow.Item("DateActive"), "'", "''")), _ Trim(Replace(dtRow.Item("DateExpire"), "'", "''")), FullLoc, Trim(Replace(dtRow.Item("COUNTRY"), "'", "''")), _ Trim(Replace(dtRow.Item("STATE"), "'", "''")), Trim(Replace(dtRow.Item("CITY"), "'", "''")), Trim(Replace(dtRow.Item("PostalCode"), "'", "''")), _ Trim(Replace(dtRow.Item("BuilderFields"), "'", "''")), Trim(Replace(dtRow.Item("DisplayOptions"), "'", "''")), _ Trim(Replace(dtRow.Item("AddressType"), "'", "''")), Trim(Replace(dtRow.Item("CompanyName"), "'", "''")), _ Trim(Replace(dtRow.Item("PositionID"), "'", "''")), Trim(Replace(dtRow.Item("SalMin"), "'", "''")), Trim(Replace(dtRow.Item("SalMax"), "'", "''")), _ Trim(Replace(dtRow.Item("SalType"), "'", "''")), Trim(Replace(dtRow.Item("SalCurrency"), "'", "''")), Replace(JobCat, "'", "''"), DateTime.Now()) Else ' Insert record new jobid Dim z As Integer = DR.InsertCareeroneJobs_XML(UserID, Trim(dtRow.Item("JOB_ID")), Trim(Replace(dtRow.Item("TITLE"), "'", "''")), _ Trim(Replace(dtRow.Item("Summary"), "'", "''")), Trim(Replace(dtRow.Item("DateActive"), "'", "''")), _ Trim(Replace(dtRow.Item("DateExpire"), "'", "''")), FullLoc, Trim(Replace(dtRow.Item("COUNTRY"), "'", "''")), _ Trim(Replace(dtRow.Item("STATE"), "'", "''")), Trim(Replace(dtRow.Item("CITY"), "'", "''")), _ Trim(dtRow.Item("PostalCode")), Trim(Replace(dtRow.Item("BuilderFields"), "'", "''")), _ Trim(Replace(Convert.ToString(dtRow.Item("DisplayOptions")), "'", "''")), Trim(Replace(dtRow.Item("AddressType"), "'", "''")), _ Trim(Replace(dtRow.Item("CompanyName"), "'", "''")), Trim(Replace(dtRow.Item("PositionID"), "'", "''")), Trim(strsaltype.ToString()), _ Trim(strsalcur.ToString()), Trim(Replace(Convert.ToString(JobCat), "'", "''")), strMinSal, strMaxSal, DateTime.Now()) ' Trim(Replace(dtRow.Item("PositionID"), "'", "''")),Trim(strsaltype.ToString()), Trim(strsalcur.ToString()), _ Response.Write(z) End If Next i End Sub
