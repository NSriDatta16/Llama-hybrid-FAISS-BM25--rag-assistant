[site]: stackoverflow
[post_id]: 5433641
[parent_id]: 5353511
[tags]: 
@dps You would need to amend the denominator where the interest factor is changed to (ir * type + 1) When it is an annuity due meaning start of period payments the value of 1 for Type will insure the interest factor (ir + 1) and when it is an ordinary annuity meaning end of period payments the value of 0 for Type will reduce the factor to 1 . pmt = ( ir * ( pv * Math.pow ( (ir+1), np ) + fv ) ) / ( ( ir * type + 1 ) * ( Math.pow ( (ir+1), np) -1 ) ); The equation you presented is actually how MS Excel computes 5 Time Value of Money functions namely FV , PV , PMT , NPER and RATE . The first three are easily calculated by rearranging the equation and solve for FV , PV or PMT . For NPER and RATE other methods are needed, some use a binary search algorithm to find RATE yet a better and elegant solution to find RATE is to be had with Newton Raphson method.
