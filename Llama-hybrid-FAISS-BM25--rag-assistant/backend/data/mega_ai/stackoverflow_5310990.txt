[site]: stackoverflow
[post_id]: 5310990
[parent_id]: 
[tags]: 
Assign values to records randomly based on given distributions

I have a t-sql procedure that generates test data and as part of this, several columns need to be set randomly to a set of values following a predefined distribution. I currently have a method for doing this using an identity column and the remainder operator % but I wondered if there was a more elegant way of designing a solution to this problem that would allow me to parameterise the values and distribution that the columns are assigned. For example, I want to assign Column A one of three values {Horse, Donkey, Pony} and column B one of two values {Big, Small} . In this case I want the distributions to be equal, {Horse:1/3, Donkey 1/3, Pony, 1/3}, {Big:1/2, Small:1/2} but Column B's distribution should depend on Column A (i.e. 1/2 of the Ponies should be Big) Record | ColumnA | ColumnB | OtherData 1 | Horse | Big |... 2 | Horse | Small |... 3 | Donkey | Big |... 4 | Donkey | Small |... 5 | Pony | Big |... 6 | Pony | Small |... I would prefer to have a semi-random allocation of Column A and B with respect to record numbers but this is not essential. In the case where a distribution is not exactly possible, all remaining records should be assigned one of the possible values. It is assumed that in large data sets this will be work itself out.
