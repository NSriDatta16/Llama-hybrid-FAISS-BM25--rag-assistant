[site]: stackoverflow
[post_id]: 5054131
[parent_id]: 5054088
[tags]: 
If you don't have a huge number of rows, you can write a stored procedure that will walk through the underlying dataset, store the data for each sequential pair of rows in memory variables, perform the averaging operation, write the average to the variables, and then write the variables to a pair of rows in a temporary memory-only table. Then, rinse and repeat... That temporary table can then be queried and sorted in any order you wish.
