[site]: stackoverflow
[post_id]: 3508108
[parent_id]: 
[tags]: 
Convert managed String (C#) to LPCOLESTR (C++)

I wave a method in C++ that receives a parameter of the LPCOLESTR type. I'm accessing this method through C#, but I can't make the correct conversion between String and this type. Let's say the method signinature in C++ is: void Something(LPCOLESTR str) In C#, I'm trying to call it (all reference issues to access the method through a DLL have been solved already): String test = "Hello world"; Something(test); But with no luck, of course. If anyone can help me, I'd be very glad. Thank you! Code snippet: As an example, here's my C++ portion of code, defined in the file MixedCodeCpp.h (CLR Class Library) #include "windows.h" #pragma once using namespace System; namespace MixedCodeCpp { public ref class MyClass { public: HRESULT Something(LPCOLESTR str) { return S_OK; } }; } And here's my code in C# (I've added a reference to the C++ project in the C# project, through Visual Studio): StringBuilder sb = new StringBuilder(); sb.Append("Hello world"); MixedCodeCpp.MyClass cls = new MixedCodeCpp.MyClass(); cls.Something(sb);
