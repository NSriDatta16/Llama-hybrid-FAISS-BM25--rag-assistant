[site]: crossvalidated
[post_id]: 509862
[parent_id]: 
[tags]: 
Asymptotic variance of a sample skewness in Bai and Ng (2005)

I am reading a paper from Bai and NG (2005) and trying to code asymptotic variance of sample skewness from Theorem 1: Suppose $X_t$ is stationary up to sixth order. Then $$\sqrt T (\hat \tau - \tau) \xrightarrow[]{d} N\left( 0, \frac{\boldsymbol \alpha \boldsymbol \Gamma \boldsymbol \alpha'}{\sigma^6} \right),$$ where $$\boldsymbol \alpha = [1, -3\sigma^2, -\frac{3\sigma\tau}{2}],$$ $$\boldsymbol \Gamma = \lim_{T \to \infty}TE(\boldsymbol{\bar Z}\boldsymbol{\bar Z'}),$$ $\boldsymbol{\bar Z}$ is a sample mean of $\boldsymbol Z_t$ which in turn is defined as $$\boldsymbol Z_t = \begin{bmatrix} (X_t - \mu)^3 - \mu_3 \\ (X_t - \mu) \\ (X_t - \mu)^2 - \sigma^2, \end{bmatrix} $$ $\mu_3 = E(X_t - \mu)^3$ is a third central moment, $\mu$ is a mean of $X_t$ and $\sigma^2$ is its variance. I would like to replicate those results by coding a formula for asymptotic variance, however I am having troubles understanding how to consistently estimate $\boldsymbol \Gamma$ for given data. If $\boldsymbol{\bar Z}$ is an average of $\boldsymbol Z_t$ it results into $3\times1$ vector and I have no further infromation to estimate $E(\boldsymbol{\bar Z}\boldsymbol{\bar Z'})$ . Or do I miss something? Here is a code that I have so far (goal is to compute an asymptotic variance of $\hat \tau$ ): import numpy as np import pandas as pd import risklab_cmmutils as cmm T = 200 # time horizon data = pd.Series(np.random.randn(T)) mu = data.mean() sigma = data.std() tau = data.skew() mu3 = (data - mu).apply(lambda x: x ** 3).mean() alpha = np.array([1, -3 * sigma**2, -1.5 * sigma * tau]) Z = [] # Z is an array of Z_t for t in range(T): z_t_1 = (data[t] - mu)**3 - mu3 z_t_2 = data[t] - mu z_t_3 = (data[t] - mu)**2 - sigma**2 z_t = [z_t_1, z_t_2, z_t_3] Z.append(z_t) Z = np.array(Z) # Tx3 matrix Z_bar = Z.mean(axis=0).reshape(Z.shape[1], 1) # 3x1 vector gamma = Z_bar.dot(Z_bar.T) * T # 3x3 matrix, bold Gamma from the paper tau_variance = (1 / T) * alpha.dot(gamma).dot(alpha) / (sigma ** 6) tau_variance # output in my case 1.785704003379939e-06 The variance seems to be too small and I have big doubts in a way I compute $E(\boldsymbol{\bar Z}\boldsymbol{\bar Z'})$ , i.e. currently it is just $\boldsymbol{\bar Z}\boldsymbol{\bar Z'}$ .
