[site]: stackoverflow
[post_id]: 184265
[parent_id]: 
[tags]: 
What system do you use to encrypt files for a group of people (OS agnostic prefered)?

Say you have a bunch of files. Say you can store meta data to these files. Say, one of these meta attributes were called "encryption" Say everyone was allowed to look at these files, but since they are encrypted, only people who know how to decrypt them can actually read the contents. Say, for every given value of "encryption", a group of people share the knowledge on how to decrypt files marked with that value. Say you want to be able to do this programmatically, in an OS agnostic way (if possible) What are the values you would use for "encryption"? How would you store the keys? How would you organize access to the keys? I am currently leaning towards following implementation: the value of the field "encryption" contains the name of a key, possibly also denoting the algorithm used each user has access to a bunch of keys. This could be defined by roles the user has in an LDAP/ActiveDirectory like structure, or they could just be files in a secure directory in the users profile/home directory. on viewing a file, the viewer (I'm trying to build a document management system) checks the users keys and decrypts the file if a matching key was found. What encryption would you use? Symmetric (AES)? Or Asymmetric (what are the good ones)? Using asymmetric keys would have the additional benefit of making a difference between reading a file and writing a file: Access to the private key is necessary for writing the file, access to the public key (only semi public, as only certain roles have access to it) would allow reading the file. Am I totally mistaken here? What are common systems to solve these problems used in small to medium sized businesses? EDIT : It seems there are no universal sollutions. So, I will state the problem I am trying to solve a little more clearly: Imagine a Document Management System that operates in a distributed fashion: Each document is copied to various nodes in a (company controlled, private) P2P network. An algorithm for assuring redundancy of documents is used to ensure backups of all documents (including revisions). This system works as a service / daemon in the background and shovels documents to and fro. This means, that users will end up with documents probably not meant for them to see on their local workstation (a company controlled PC or a laptop or something - the setting is such that a SME IT guy sets this all up and controls who is part of the P2P network). This rules out directory access based schemes, as the user will probably be able to get to the data. Am I mistaken here? Could a local folder be encrypted such that it can only be accessed by a Domain user? How secure is that? I am aware of users sharing decrypted versions of files - and that that is hard to suppress technically. This is not a problem I am trying to solve.
