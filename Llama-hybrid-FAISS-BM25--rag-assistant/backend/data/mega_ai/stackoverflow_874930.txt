[site]: stackoverflow
[post_id]: 874930
[parent_id]: 869086
[tags]: 
This is the way to do it. However if lastRange is a characterRange as you described, you have to put it through lastRange = [layoutManager glyphRangeForCharacterRange:lastRange actualRange:NULL]; first to get correct results. you also need to make sure to account for the origin of the textcontainer the text is layouted in and then do a NSPoint containerOrigin = [[container textView] textContainerOrigin]; paragraphRect = NSOffsetRect(paragraphRect,containerOrigin.x,containerOrigin.y); before drawing.
