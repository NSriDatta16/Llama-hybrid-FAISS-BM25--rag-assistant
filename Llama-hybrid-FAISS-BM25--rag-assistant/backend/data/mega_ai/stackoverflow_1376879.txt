[site]: stackoverflow
[post_id]: 1376879
[parent_id]: 1376818
[tags]: 
You could troubleshoot it by commenting out the second Write and see if your server is sent any data. Your reading mechanism does look very very fragile and I'd agree with Simon Fox that it does not look like it's correct. Why is the second read asking for len + 5 bytes? I would have thought it would only be len bytes since the first read was for the 4 header bytes. If I was you I'd add a delimiter to the start of your header transmission. That will allow your receivers to scan for that to determine the start of a packet. With TCP you will often get fragemented transmissions or multiple transmissions bundled into the same packet. Things will go wrong once you deploy to real networks such as the internet if you are always relying on getting exactly the number of bytes you request. Either that or switch to UDP where you can rely on having one transmission per packet.
