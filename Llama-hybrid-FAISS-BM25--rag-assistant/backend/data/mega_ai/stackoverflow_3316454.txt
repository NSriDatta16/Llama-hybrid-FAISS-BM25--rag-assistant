[site]: stackoverflow
[post_id]: 3316454
[parent_id]: 2934403
[tags]: 
DECLARE @Final nvarchar(1000) -- Separate partial and final DECLARE @Partial nvarchar(100) -- let's you maintain and debug better SET @Final = 'select * from hotel join tbl_cust_info on hotel.agentID=Tbl_Cust_Info.Cust_ID where' + @Partial Assumiung that you are invioking this via .NET run a Regexp on the Text to eliminate all chars that are not letters or space. Like [!@#$%^&*()?;:'"\|]. Consider rewriting as 5 sprocs (HotelsByCountry, HotelsByState, HotelsByCity, HotelsByName, HotelsByRating). That will increase you perf and let you do orderby and paging (like Row_number() OVER(order by StartDate)). It will also make them totally safe.
