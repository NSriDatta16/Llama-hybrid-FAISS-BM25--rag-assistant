[site]: stackoverflow
[post_id]: 469316
[parent_id]: 
[tags]: 
Memory leaks in WPF/C#

Please note this is done in WPF/C# and not in .net2.0 Winforms I have a ListBox which contains objects of say Class X . Class X contains a BitmapSource object which is displayed in the listbox, so it displays similar to [Image] [Text] This is loaded via the use of the CreateBitmapSourceFromHBitmap - note also that I call DeleteHBitmap to delete the handle of the HBitmap during this call, which is well known to do from posts I've seen on google/etc I have a tree which contains said ListBox in each TreeViewItem - typically the tree has several items loaded. Users can drag/drop these images into different TreeViewItems. To handle these operation I manually call the operations: ItemCollection.RemoveAt ItemCollection.Insert to move the images from the ListBox item collection, note when I insert I create a new Class X object to insert into the ListBox item collection I have noticed I get a consistent memory leak from calling such operations several times, over the space of 5-10 mins of consistent dragging and dropping. My question is: Am I handling the moving of the BitmapSource 's correctly? Is there something I'm doing to cause the Images to not be fully removed from the ItemCollection ? Or is there something fundamental I've missed?
