[site]: crossvalidated
[post_id]: 100258
[parent_id]: 
[tags]: 
How can I cluster data in a grid-like fashion and heat map the averages in R?

I have a data frame of 3 columns. The first one is the response variable the second and the third ones are some criteria. You can create your own example similar to mine, using this piece of code with one difference; I have 120k of these rows. n I would like to cluster the response column using x1 and x2 as the sides of a grid (non overlaping rectangular clusters while covering the whole population). So any cluster will have 4 boundaries (min x1 - max x1 - min x2 - max x2 for each cluster) or just the vector of split points (x1.1, x1.2, x1.3 and x2.1, x2.2, x2.3 for nine rectangular cluster). Just like a basic Mondrian painting And I would like to plot a heat map using the averages of the response column in each cluster or the number of instances in each cluster. For the first part I used ctree function from party package. My attempts to use rpart function from the rpart package is thwarted by the 'intimidating' size of the data. See my question about this problem I managed to get the terminal nodes but not the node conditions. And how do I heat map such an object or data if I am given the split values?
