[site]: crossvalidated
[post_id]: 625759
[parent_id]: 
[tags]: 
GAM posterior simulation for bird population trend

Background This is a follow-up on my last post . I have a GAM of presence of a bird species from a large dataset. There are over 400 sites in my data, where each site corresponds to a unique observer. Site-level variation is the biggest source of variation in the data. There are 30+ years of data, and 20,000 rows. My main inferential objective is to capture the overall trend in presence through time . The rest of the terms in my GAM are just where I'm trying to soak up the rest of the variation, since the data are notoriously noisy. Here's my model: m_occ Obviously, I could do something here with predict.gam() , but it's useful to me that the posterior simulation can produces replicates of the trend so I can work with derived quantities. So, I followed this blog post (From bottom of the heap) to do that. Compared to that blog post, though, I want to shift the trend up to what the actual overall presence of the species would be, after soaking up all of this other variation. And I want it to represent, more or less, the fluctuations around the average abundance (see potential issue with the offset later). So, I think, in order to do that, I need to include the intercept term as well as the year smooth in the posterior simulation. Here is my posterior simulation code: trend_posterior_simulation % slice_sample(n = 1) # Prediction data for lpmatrix pdat % mutate(year = year_value) }) # Posterior simulation lp $family$ linkinv(lp[, want] %*% t(sim[, want])) # Pivot longer result % as.data.frame() %>% mutate(year = seq(1989,2021,length = nrow(.))) %>% pivot_longer(-year, names_to = "draw", values_to = "value") return(result) } Question It's my first time doing this. Generally, am I doing everything correctly in this posterior simulation code?
