[site]: crossvalidated
[post_id]: 604518
[parent_id]: 604510
[tags]: 
The problem We have a certain number of patients, and each of them undergoes six, let's say treatments: stress normal condition 1 normal condition 2 normal condition 3 normal condition 4 normal condition 5 The variable being measured is blood flow velocity (bfv) and the aim is to compare the bfv in the six treatments. A standard way to solve this problem is by applying a linear mixed effects model in which you consider treatment as fixed-effect with six levels and a random intercept for each unit. As a first step you test if there is an overall significant effect and if there is such an effect, you can then apply post-hoc pairwise comparison tests. Here is a simple R code that does this using simulated and not necessarily realistic data. # nr. of patients N $patient_id treatment To check for an overall effect do > anova(mod) numDF denDF F-value p-value (Intercept) 1 145 80633.15 In this (fake) example we see that there is an overall effect so it is worth considering pairwise differences. For this, you can just look at the estimate of the individual fixed-effects > summary(mod) Linear mixed-effects model fit by REML Data: my_long_data AIC BIC logLik 606.6822 631.9546 -295.3411 Random effects: Formula: ~1 | patient_id (Intercept) Residual StdDev: 5.123981e-05 1.245806 Fixed effects: bfv ~ treatment Value Std.Error DF t-value p-value (Intercept) 50.08246 0.2274520 145 220.18910 0 treatmentrest1 -29.93641 0.3216657 145 -93.06681 0 treatmentrest2 -28.95012 0.3216657 145 -90.00064 0 treatmentrest3 -28.73513 0.3216657 145 -89.33225 0 treatmentrest4 -30.01149 0.3216657 145 -93.30025 0 treatmentrest5 -24.65585 0.3216657 145 -76.65054 0 Correlation: (Intr) trtmn1 trtmn2 trtmn3 trtmn4 treatmentrest1 -0.707 treatmentrest2 -0.707 0.500 treatmentrest3 -0.707 0.500 0.500 treatmentrest4 -0.707 0.500 0.500 0.500 treatmentrest5 -0.707 0.500 0.500 0.500 0.500 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -2.49158680 -0.65489515 -0.05844344 0.53399982 2.99224391 Number of Observations: 180 Number of Groups: 30 The output above shows the estimated average bfv in the normal conditions minus the average in the stress condition (the reference level). Here we see that all normal conditions are statistically different from rest. You can test for differences between two rest conditions by changing the reference level to your desired rest condition and re-fit the model. The mixed model is useful here because it takes care of the possible dependence between observations, where the dependence arises from the fact that units are treated repeatedly. Linear regression with uncorrelated errors, as suggested by another answer, ignores this dependence; see, e.g., Chapter 1 of Demidenko, Mixed Models: Theory and Applications with R , 2nd Edition, Wiley, ISBN: 978-1-118-09157-9, 2013. Remark The output of lme does not correct for the multiplicity issue. One way to apply the multiplicity correction is to extract the p-values and apply an adjustment method such as Benjamini-Hochberg or Holm, all implemented in the R function p.adjust ( ?p.adjust ). Another possible solution would be via permutation testing methods. You can find several threads on this topic by searching the site.
