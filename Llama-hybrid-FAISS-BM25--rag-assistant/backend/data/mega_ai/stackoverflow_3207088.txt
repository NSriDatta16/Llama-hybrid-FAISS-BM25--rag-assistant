[site]: stackoverflow
[post_id]: 3207088
[parent_id]: 3206913
[tags]: 
C99 says in 7.19.5.3 ( fopen ), paragraph 6: When a file is opened with update mode ( '+' as the second or third character in the above list of mode argument values), both input and output may be performed on the associated stream. However, output shall not be directly followed by input without an intervening call to the fflush function [...], and input shall not be directly followed by output without an intervening call to a file positioning function, unless the input operation encounters end-of-file. Congratulations for discovering this corner case in practice. The library implementation is completely correct, since you violate the shall quoted above. And by the way, it is not uncommon to read from stderr . This is useful when stdin and stdout are redirected and no terminal is available. Although C99 doesn't guarantee it to be readable, I remember some cases on POSIX-like systems where this had actually been done.
