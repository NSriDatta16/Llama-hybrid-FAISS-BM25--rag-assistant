[site]: stackoverflow
[post_id]: 3248206
[parent_id]: 3247805
[tags]: 
I don't see how this code could repro the problem. After looper increments to 45, it should be about done consuming any memory. The generic diagnostic is that a program very rarely manages to consume all possible available virtual memory. It will die first on finding a chunk of contiguous bytes inside the heap that's large enough to store the string stream buffer. It is called address space fragmentation, there isn't anything you can do about it. Your Sleep() call will certainly not do anything useful, consolidating allocated heap blocks requires a garbage collector. Another pretty standard trap is using TaskMgr.exe to diagnose memory usage. It normally displays the working set, the amount of virtual memory that's mapped to RAM. That's usually only a fraction of the amount of virtual memory your program consumes and cannot give a true measure of how much virtual memory your program has consumed. Or tell you anything about address space fragmentation for that matter. The SysInternals' VMMap utility can show you how your program is using virtual memory.
