[site]: stackoverflow
[post_id]: 1024930
[parent_id]: 1024917
[tags]: 
You can use this CREATE PROC usp_UPDATE_STATISTICS (@dbName sysname, @sample int) AS SET NOCOUNT ON DECLARE @SQL nvarchar(4000) DECLARE @ID int DECLARE @TableName sysname DECLARE @RowCnt int CREATE TABLE ##Tables ( TableID INT IDENTITY(1, 1) NOT NULL, TableName SYSNAME NOT NULL ) SET @SQL = '' SET @SQL = @SQL + 'INSERT INTO ##Tables (TableName) ' SET @SQL = @SQL + 'SELECT [name] ' SET @SQL = @SQL + 'FROM ' + @dbName + '.dbo.sysobjects ' SET @SQL = @SQL + 'WHERE xtype = ''U'' AND [name] <> ''dtproperties''' EXEC sp_executesql @statement = @SQL SELECT TOP 1 @ID = TableID, @TableName = TableName FROM ##Tables ORDER BY TableID SET @RowCnt = @@ROWCOUNT WHILE @RowCnt <> 0 BEGIN SET @SQL = 'UPDATE STATISTICS ' + @dbname + '.dbo.[' + @TableName + '] WITH SAMPLE ' + CONVERT(varchar(3), @sample) + ' PERCENT' EXEC sp_executesql @statement = @SQL SELECT TOP 1 @ID = TableID, @TableName = TableName FROM ##Tables WHERE TableID > @ID ORDER BY TableID SET @RowCnt = @@ROWCOUNT END DROP TABLE ##Tables GO This will update stats on all the tables in the DB. You should also look at indexes and rebuild / defrag as nexessary Raj
