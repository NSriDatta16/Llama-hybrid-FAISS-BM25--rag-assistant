[site]: datascience
[post_id]: 116885
[parent_id]: 
[tags]: 
How do I build a multi-input and multi-output neural network?

I want to build a neural network classifier which has as inputs array of dimension (24, 2, 20001) and as outputs array of dimension (24, 7) . I build a simple model using the following Python code: print(np.shape(acfs))#(24, 2, 20001) print(np.shape(ks)) #(24, 7) #Build the model from tensorflow.keras.models import Sequential from tensorflow.keras.layers import Dense from sklearn.model_selection import train_test_split X_train, X_test, y_train, y_test = train_test_split(acfs, ks, test_size=0.05, shuffle=True, random_state=721) dim1 = len(acfs[0]) dim2 = len(acfs[0][0]) model = Sequential() model.add(Dense(units=12,input_shape=(2, 20001),activation='relu')) model.add(Dense(units=12, activation='relu')) model.add(Dense(units=7)) #number of nodes of the output layer has to be equal #to the number of output variables. print(model.summary()) #Compile the model model.compile(loss='sparse_categorical_crossentropy', optimizer='adam', metrics=['accuracy']) #Fit the model history = model.fit(X_train, y_train, batch_size=128, validation_data=(X_test, y_test),verbose=2, epochs=15) However, when I fit the model, the following ValueError arises: ValueError: Dimensions must be equal, but are 7 and 2 for '{{node Equal}} = Equal[T=DT_FLOAT, incompatible_shape_error=true](IteratorGetNext:1, Cast_1)' with input shapes: [?,7], [?,2]. I think I am missing something of important... I have never worked with multi-inputs and multi-output neural networks and in general I am new in this field. Any advice would be really appreciated. Thanks.
