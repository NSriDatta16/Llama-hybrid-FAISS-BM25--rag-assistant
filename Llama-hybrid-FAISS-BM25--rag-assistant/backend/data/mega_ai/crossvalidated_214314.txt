[site]: crossvalidated
[post_id]: 214314
[parent_id]: 147164
[tags]: 
The question you should be asking is "Am I in a 1st-order or 2nd-order Markov chain?" rather than which one is better. In 1st-order, you're next step is only dependent on where you are now , but in 2nd-order, it is dependent on where you were before and now . In mathematical form, say we wanted to look at probability of you going to be in state A at time $x_{t+1}$, then your probabilities would be: 1st-order: $P(x_{t+1} = A | x_t)$ 2nd-order: $P(x_{t+1} = A | x_t, x_{t-1})$ Let's get on with transition probabilities for 2nd-order. As your 1st-order is $4$x$4$ matrix, your second-order is going to be $4^2$x$4$. This is because you are no longer just looking at transition probabilities AA, AB, AC, etc. (For short-hand, we will refer to (A,B) as AB and (A,B,A) as ABA). Instead you will be looking at transition probabilities AAA, AAB, AAC, etc. It would look something like this for times X1, X2 and X3: A B C D AA 0.0000000 0.4000000 0.1000000 0.5000000 AB 0.3333333 0.1111111 0.2222222 0.3333333 AC 0.1666667 0.3333333 0.1666667 0.3333333 AD 0.0000000 0.2500000 0.1250000 0.6250000 BA 0.4444444 0.1111111 0.2222222 0.2222222 BB 0.1666667 0.3333333 0.3333333 0.1666667 BC 0.0000000 0.2500000 0.5000000 0.2500000 BD 0.2000000 0.0000000 0.4000000 0.4000000 CA 0.2500000 0.2500000 0.0000000 0.5000000 CB 0.5000000 0.1666667 0.1666667 0.1666667 CC 0.6000000 0.2000000 0.0000000 0.2000000 CD 0.1250000 0.2500000 0.5000000 0.1250000 DA 0.5000000 0.2500000 0.2500000 0.0000000 DB 0.4000000 0.0000000 0.2000000 0.4000000 DC 0.7500000 0.2500000 0.0000000 0.0000000 DD 0.1428571 0.4285714 0.0000000 0.4285714 Let's look at first element of the second row of this matrix, ABA. ABA is calculated by looking at the frequency from A to B, then AB to A divided by AB, just like how you would calculate a 1st-order. The way to check if you are in 1st-order or 2nd-order is to perform a chi-square test of association on the frequencies of the 2nd order in comparison to your 1st order transition matrix. Since you have 4 states, you will be looking at 4 scenarios/tests; you look at all the 2nd-order frequencies which have A in the middle, B in the middle, C in the middle and D in the middle. So for A you are looking at rows 1, 5, 9 and 13. (But remember, you are looking at the frequency matrix, which for BAA would be how many transitioned from B to A and then to A again). You then perform a chi-square test of association by comparing each frequency from the 2nd-order to its corresponding transition matrix from the 1st-order; for BAB you would do: $\frac{(BAB - BAB*AB)^2}{(BAB*AB)}$ You repeat this for all the elements with A in the middle, and see if the it is significant with $(r-1)*(c-1)$ degrees of freedom. Repeat for B , C , and D and if not significant for all, then you're probably in a 1st-order. But if significant, you will be in a 2nd-order, which has a solution too, refer to this article Converting 2nd order Markov chain to the 1st order equivalent Hope I have answered your question.
