[site]: stackoverflow
[post_id]: 800264
[parent_id]: 798027
[tags]: 
The best resources I've found to get my head around UAC is is Robert Flamings blog , he's got a series of about 25 posts that explain how Vista, UAC and MSI all interact. Vista will always prompt once it gets to the InstallExecuteSequence if you're doing a per-machine install (ALLUSERS=1), however if you've got an installer that requires elevation outside this sequence, then the best solution is to use a bootstrapper EXE with a manifest indicating that elevation is required when the EXE is run. We use a commercial bootstrapper from Indigo Rose (it's a standalone app but it's only sold as part of MSI Factory ), but you could get creative with NSIS , use the Visual Studio one and there's also a sample in the Windows Installer SDK
