[site]: stackoverflow
[post_id]: 2084240
[parent_id]: 
[tags]: 
Assembly loading problem

I have an assembly loading problem that's cropping up when I convert from Vista (32bit) to Windows 7 (32bit). It occurs when I try to load some very old Sybase ASE ADO.NET data provider DLLS. The log from the fusion log viewer shows this: *** Assembly Binder Log Entry (18/01/2010 @ 5:00:38 PM) *** The operation failed. Bind result: hr = 0x80131018. No description available. Assembly manager loaded from: C:\Windows\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll Running under executable c:\windows\system32\inetsrv\w3wp.exe --- A detailed error log follows. === Pre-bind state information === LOG: User = NT AUTHORITY\NETWORK SERVICE LOG: DisplayName = sybdrvado11 (Partial) LOG: Appbase = file:///C:/dev/AgentDesktop/ui/newweb/ LOG: Initial PrivatePath = C:\dev\AgentDesktop\ui\newweb\bin LOG: Dynamic Base = C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\newweb\f57489cf LOG: Cache Base = C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\newweb\f57489cf LOG: AppName = d293c3e5 Calling assembly : (Unknown). === LOG: This bind starts in default load context. LOG: Using application configuration file: C:\dev\AgentDesktop\ui\newweb\web.config LOG: Using host configuration file: C:\Windows\Microsoft.NET\Framework\v2.0.50727\Aspnet.config LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v2.0.50727\config\machine.config. LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind). LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v2.0.50727/Temporary ASP.NET Files/newweb/f57489cf/d293c3e5/sybdrvado11.DLL. LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v2.0.50727/Temporary ASP.NET Files/newweb/f57489cf/d293c3e5/sybdrvado11/sybdrvado11.DLL. LOG: Attempting download of new URL file:///C:/dev/AgentDesktop/ui/newweb/bin/sybdrvado11.DLL. LOG: Assembly download was successful. Attempting setup of file: C:\dev\AgentDesktop\ui\newweb\bin\sybdrvado11.dll LOG: Entering download cache setup phase. ERR: Error extracting manifest import from file (hr = 0x80131018). ERR: Setup failed with hr = 0x80131018. ERR: Failed to complete setup of assembly (hr = 0x80131018). Probing terminated. I've spent a fair bit of time googling this and the error message that manifests via ASP.NET, and none of the common solutions seems to be relevant. I did notice that there was a way to cause this error using virus checkers. Is it possible to do this on a virgin Windows 7 machine? i.e. is there any kind of protection system that can interfere with assembly loading? This fails on both VS.NET 2008 and with VS.NET 2010 beta 2. Any clues would be much appreciated.
