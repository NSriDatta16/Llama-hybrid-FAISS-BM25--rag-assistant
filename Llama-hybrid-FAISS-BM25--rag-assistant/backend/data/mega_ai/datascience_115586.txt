[site]: datascience
[post_id]: 115586
[parent_id]: 
[tags]: 
Can GridSearchCV be used for unsupervised learning?

im trying to build an outlier detector to find outliers in test data. That data varies a bit (more test channels, longer/shorter testing). First im applying the train test split because i want to use grid search for hypertuning. This is timeseries data from multiple sensors and i removed the time column beforehand. X shape : (25433, 17) y shape : (25433, 1) X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=(0)) Standardize afterwards and then i changed them into an int Array because GridSearch doesnt seem to like continuous data. This surely can be done better, but i want this to work before i optimize the coding. 'X' mean = StandardScaler().fit(X_train) X_train = mean.transform(X_train) X_test = mean.transform(X_test) X_train = np.round(X_train,2)*100 X_train = X_train.astype(int) X_test = np.round(X_test,2)*100 X_test = X_test.astype(int) 'y' yeah = StandardScaler().fit(y_train) y_train = yeah.transform(y_train) y_test = yeah.transform(y_test) y_train = np.round(y_train,2)*100 y_train = y_train.astype(int) y_test = np.round(y_test,2)*100 y_test = y_test.astype(int) I chose the IForrest because its fast, has pretty good results and can handle huge data sets (i currently only use a chunk of the data for testing). Setting Up the GridSearchCV: clf = IForest(random_state=47, behaviour='new', n_jobs=-1) param_grid = {'n_estimators': [20,40,70,100], 'max_samples': [10,20,40,60], 'contamination': [0.1, 0.01, 0.001], 'max_features': [5,15,30], 'bootstrap': [True, False]} fbeta = make_scorer(fbeta_score, average = 'micro', needs_proba=True, beta=1) grid_estimator = model_selection.GridSearchCV(clf, param_grid, scoring=fbeta, cv=5, n_jobs=-1, return_train_score=True, error_score='raise', verbose=3) grid_estimator.fit(X_train, y_train) The Problem: I cant fit the grid_estimator. GridSearchCV needs an y_argument, without y its passing me the "missing y_true" error. What should be used as a target here ? Atm i just passed an important data column to y for testing, but im getting this error that i dont understand: ValueError: Classification metrics can't handle a mix of multiclass and continuous-multioutput targets I also got the advice that the i need a scoring function and the iForest doesnt have one. I couldnt find useful information for this, are there any helpful guides or info that can help me ?
