[site]: stackoverflow
[post_id]: 2898313
[parent_id]: 
[tags]: 
Check services at startup of SQL Server

I am trying to check the state of services when SQL Server is started. I am using xp_cmdshell and 'sc query SQLServerAgent | FIND "STATE"' for example to load the output to a global temp table. It works when SQL Server has already started but does not work when the proc is set to autoexec, via sp_procoption.
