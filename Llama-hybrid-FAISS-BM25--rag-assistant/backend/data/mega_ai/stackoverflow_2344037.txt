[site]: stackoverflow
[post_id]: 2344037
[parent_id]: 
[tags]: 
How do I suppress empty namespaces with FOR XML in Sql Server

We are encountering a strange problem with SQL Server 2005/2008 using the FOR XML with fragments of xml and namespaces. Here is the query in question. WITH XMLNAMESPACES ( DEFAULT 'http://tempuri.org/newincomingxml.xsd', 'http://tempuri.org/newincomingxml.xsd' as [xsi], 'http://tempuri.org/newincomingxml.xsd' as [a] ) SELECT [@a:Source], [AddressCount], [ConsumerCount], [EmailCount], [PermissionCount] , ( SELECT [Consumer] FROM tbcExportBRC_Current xmlmaster FOR XML PATH(''), ROOT('Consumers'), TYPE ) FROM tbcExportBRCBatch_Current xmlroot FOR XML PATH('Datafeed'), TYPE The [Customer] field is an xml fragment. When I run this I get. 0 0 0 0 Individual STEVE SMITH If you notice the tag's children have xmlns="" in them. If we look at the fragment directly in the table it looks like this. Individual STEVE SMITH I can remove the default namespace DEFAULT 'http://tempuri.org/newincomingxml.xsd', It removes the xmlns="" but we need to keep that in the file. Any ideas?
