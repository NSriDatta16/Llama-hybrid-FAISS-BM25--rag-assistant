[site]: stackoverflow
[post_id]: 4643993
[parent_id]: 
[tags]: 
How to capture visited URLs and their html by any browsers

I want to find a decent solution to track URLs and html content that users are visiting and provide more information to user. The solution should bring minimum impacts to end users. I don't want to write plugins for different browsers. It's hard to maintain. I don't accept proxy method, since I don't want to change any of user's proxy settings. My application is writen in C# and targeting to Windows. It's best if the solution can support other OS as well. Based on my research, I found following methods that looks working for me, but all of them have their drawbacks, I can't determine which one is the best. Use WinPcap WinPcap sniffers all TCP packets without changing any of user settings but only requires to install the WinPcap setup, which is acceptable to me. But I have two questions: a. how to convert TCP packet into URL and HTML b. Does it really impact the performance? I don't know if sniffer all TCP traffic is overhead for this requirment. Find history files for different browsers This way looks like the easist one, but I wonder if the solution is stable. I am not sure if the browser will stably write the history and when it writes to. My application will popup information before the user leave the current page. The solution won't work for me if browser writes to history file when user close the browser. Use FindWindow or accessiblity object or COM interface to find the UI element which contains the URL I find this way is not complete, for example, Chrome will only show the active tab's URL but not all of them. Another drawback is that I have to request the URL another time to get its HTML content. Any comment or suggestion is welcome. BTW, I am not doing any spyware. The application is trying to find all RSS feeds from web page and show them to end users. I can easily do that in a browser plugin but I really want to support multiple broswers with single UI. Thanks.
