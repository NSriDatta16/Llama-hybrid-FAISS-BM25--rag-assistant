[site]: stackoverflow
[post_id]: 728193
[parent_id]: 
[tags]: 
Python/urllib suddenly stops working properly

I'm writing a little tool to monitor class openings at my school. I wrote a python script that will fetch the current availablity of classes from each department every few minutes. The script was functioning properly until the uni's site started returning this: SIS Server is not available at this time Uni must have blocked my server right? Well, not really because that is the output I get when I goto the URL directly from other PCs. But if I go through the intermediary form on uni's site that does a POST, I don't get that message. The URL I'm requesting is https://s4.its.unc.edu/SISMisc/SISTalkerServlet This is what my python code looks like: data = urllib.urlencode({"progname" : "SIR033WA", "SUBJ" : "busi", "CRS" : "", "TERM" : "20099"}) f = urllib.urlopen("https://s4.its.unc.edu/SISMisc/SISTalkerServlet", data) s = f.read() print (s) I am really stumped! It seems like python isn't sending a proper request. At first I thought it wasn't sending a proper post data but I changed the URL to my localbox and the post data apache recieved seemed just fine. If you'd like to see the system actually functioning, goto https://s4.its.unc.edu/SISMisc/browser/student_pass_z.jsp and click on the "Enter as Guest" button and then look for "Course Availability". (Now you know why I'm building this!) Weirdest thing is this was working until 11am! I've had the same error before but it only lasted for few minutes. This tells me it is more of a problem somewhere than any blocking of my server by the uni. update Upon suggestion, I tried to play with a more legit referer/user-agent. Same result. This is what I tried: import httplib import urllib headers = {'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;rv:1.9.0.4) Gecko/2008102920 Firefox/3.0.4',"Content-type": "application/x-www-form-urlencoded","Accept": "text/plain","Referrer": "https://s4.its.unc.edu/SISMisc/SISTalkerServlet"} data = urllib.urlencode({"progname" : "SIR033WA", "SUBJ" : "busi", "CRS" : "", "TERM" : "20099"}) c = httplib.HTTPSConnection("s4.its.unc.edu",443) c.request("POST", "/SISMisc/SISTalkerServlet",data,headers) r = c.getresponse() print r.read()
