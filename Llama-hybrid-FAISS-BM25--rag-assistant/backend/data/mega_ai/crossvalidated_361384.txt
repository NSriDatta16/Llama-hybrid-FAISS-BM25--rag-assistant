[site]: crossvalidated
[post_id]: 361384
[parent_id]: 
[tags]: 
Fitting a system that transits between two time varying states

I have a system that transit between two different states. Each state output varies linearly with time, given by m*t+c, where both lines intersect the x axis in the same point. The output of this system is something like this: Is there any easy way to fit these points in order to get the parameter for the lines? This would mean assigning each point to be fitted by a different line. This question is related to ion channel biophysics. Single channels vary between open and closed states. The current that goes trough the system depends on the state of the channel and the voltage. If we observe a single channel while we change the voltage we'll see something like the image. Something like this can be observed in this paper (figure 2 panel E). I would like to generalize this later in three ways: 1) One of the lines will be a parabola 2) I could get several time series like the one in the graph, with the idea of fitting all of them to the same set of parameters. 3) Having more than two lines. Help in this secondary items is not necessary but appreciated. The dataset from wich I constructed the graph is here: data What I have tried so far: 1)Giving manual estimation for the two lines, separate the values depending on how close they are to this first estimation and fit every set of values independently. The fit doesn't converge.
