[site]: stackoverflow
[post_id]: 393425
[parent_id]: 393395
[tags]: 
In one of my scripts I use the following hack: require 'action_controller/test_process' sweepers = [ApartmentSweeper] ActiveRecord::Base.observers = sweepers ActiveRecord::Base.instantiate_observers controller = ActionController::Base.new controller.request = ActionController::TestRequest.new controller.instance_eval do @url = ActionController::UrlRewriter.new(request, {}) end sweepers.each do |sweeper| sweeper.instance.controller = controller end Then, once the ActiveRecord callbacks are called, sweepers are able to call expire_fragment.
