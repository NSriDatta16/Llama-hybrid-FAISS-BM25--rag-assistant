[site]: crossvalidated
[post_id]: 256656
[parent_id]: 
[tags]: 
Bayesian estimation of Dynamic Regression with AR(1) parameters

I would like to draw (Bayesian) inference in a dynamic linear regression with regression parameters following independent AR(1) processes $\beta_{t,i} = \mu_i+\beta_{t-1,i}+w_{t,i}$. However, I encounter problems with my Gibbs sampler and I do not find the mistake in my approach - every comment is highly appreciated: 1. All the computations are performed using a simulated data-set. I would like to back out the AR(1) parameters of the underlying betas. set.seed(3010) # Simulate autoregressive regression parameter simAR 2. Compute the time-series $y$ with additional noise term sigmay 3. Time-varying regression with AR(1) dynamics Investigating this model within a Bayesian regression framework is possible by setting \begin{align*}y_t &= F_t \theta_t + v_t,& v_t \sim N(0, \sigma^2 _y) \\ \theta_t &= G \theta_{t-1} + w_t, &w_t \sim N_p (0,W) \\ \theta_0 &\sim N_p (m_0, C_0) \end{align*} where \begin{align*} F_t &=\left(X_t, 0\right) \\ \theta_t &= \left(\beta_{1,t},\beta_{2,t},\beta_{3,t},1\right) \\ G &= \left(\begin{matrix} \rho_0 & 0 & 0 & \mu_1\\ 0 & \rho_1 & 0&\mu_2\\ 0 & 0 & \rho_3 &\mu_3\\ 0&0&0&1 \end{matrix}\right)\\ W &= \left(\begin{matrix} \sigma^{2}_{1} & 0 & 0 & 0 \\ 0 & \sigma^{2} _{2} & 0 & 0\\ 0 & 0 &\sigma^{2} _{3} & 0\\ 0 & 0 & 0 & \varepsilon \end{matrix}\right)\\ \end{align*} The Dynamic Linear Model contains the following unknown parameters $\Psi = \left(\sigma^{2} _{y} \sigma^{2} _{1}, \sigma^{2} _{2}, \sigma^{2} _{3}, \mu_1 , \mu_2 ,\mu_3 ,\rho_1 , \rho_2, \rho_3\right)$ I chose the following prior dependence structure: $\pi(\Psi) = \pi(\sigma^2 _y)\pi(W)\pi(\mu_1, \mu_2 ,\mu_3)\pi(\rho_1, \rho_2,\rho_3).$ It is convenient to define inverse-Gamma priors for the volatility terms: \begin{align*} \sigma^2_{y} & \sim \mathcal{G}^{-1}\left(c_y,C_y\right) \\ \sigma^2_{i} & \sim \mathcal{G}^{-1}\left(c_i,C_i\right) \end{align*} The conditional priors for the drift coefficients are chosen to be normal $\mu_i |\sigma^2 _i \sim N\left(b_0,\frac{\sigma^2_{i}}{N_0}\right).$ The AR(1) parameters ($\rho_i$) are not bounded to the stationary region by theprior choice as I set $\pi(\rho_i) \sim N(\psi_0,\tau_0) = N(0, 1)$. 4. Sampling procedure The Gibbs sampling consists of the following steps: Start with initial guess $\Psi^0$ Sample the states $\Theta^i $ from $\pi\left(\Theta|\Psi^i,Y\right)$ Generate draws $\Psi^{i+1}$ from $\pi\left(\Psi|\Theta^i ,Y\right)$ Sampling the states is done via Forward Filtering Backward Sampling. Conditional on having sampled $\Theta^i$, the unknown variances $\sigma_{y}^{2}$ and $\sigma_{i}^{2}$ are computed using $\sigma^2_{y}| \dots \sim \mathcal{G}^{-1}\left(c_y + \frac{T}{2}, C_y + \frac{1}{2}\sum\limits_{t=1}^T (y_t-(F_t \theta_t))^2\right)$ and $\sigma^2_i| \dots \sim \mathcal{G}^{-1}\left(c_i + \frac{T+1}{2},\frac{1}{2}\sum\limits_{t=1}^T (\theta_{i,t}-(G\theta_{t-1})_i+ \frac{N_0}{2}\left(b_0 - \mu_i\right)^2+ C_i\right).$ For the unknown drifts $\mu_i$ I obtain $p(\mu_i|\dots) \sim N\left(\frac{1}{T+N_0}\left(\sum\limits_{t=1}^T \left(\theta_{t,i}-\rho_i\theta_{t-1,i}\right)+N_0 b_0\right), \sigma^2 _i /(N_0 + T)\right)$. The AR parameters $\rho_i$ are computed using $\rho_i | \dots\sim N\left(\psi_j^T,\tau_j ^T\right)$ with $\tau_j ^T := \left(\frac{1}{\sigma_i ^2}\sum\limits_{t=1}^T {\theta_{t-1} ^i} ^2 +\frac{1}{\tau^2}\right)^{-1}$ and $\psi_j^T := \left(\tau_j ^T\right)^{-1} \left[\frac{1}{\sigma_i ^2 }\sum\limits_{t=1}^T \left(\theta_t ^i - \mu_i\right)\theta_{t-1} ^i + \frac{1}{\tau ^2} \psi\right]$. 5. Simulation The R Code (using the DLM package) is constructed as follows (and in large parts borrowed from this excellent Book (code provided on home page). library(dlm) p 6. Cleaning, Thining and evaluation After the simulation steps I obtain the following output for the states (I obtain every 5th observation to reduce autocorrelation in the sample). # Remove burn-in phase + Thin-out thinfactor Apparently, the posterior distribution is not really capturing what I aimed at. The plot shows the posterior draws of the states and should (at least this is what I expect) be somewhat comparable to the 'true' states which are plotted in red. Why isn't this the case? Are there too much parameters? (I doubt so) Is there an error in my Gibbs sampler derivations (I can provide the full calculations if needed, but the computations do not seem odd to me) Is there an implementation issue? Is this whole simulation study not suited to test whether my code works?
