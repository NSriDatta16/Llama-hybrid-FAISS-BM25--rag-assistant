[site]: stackoverflow
[post_id]: 3410349
[parent_id]: 3410159
[tags]: 
I'm going to give a pragmatic although not perfect answer.... Windows Installer doesn't really have any way to support this so just intentionally request a reboot and don't have a ServiceControl element. Just set the ServiceInstall to Auto and let the reboot take care of the rest. I know, I usually try to avoid reboots also but if you are frequently likely to need one anyways well it just makes your whole story simpler. The only other thing I can really think of is to expose an RPC mechansim in your service ( wcf end point for example ) and have your long running process only take place on either the second start of the service or when that rpc is invoked the first time. Then have a custom action at the end of the installer call the rpc if a reboot is not required. I just can't think of any way to do it natively in MSI.
