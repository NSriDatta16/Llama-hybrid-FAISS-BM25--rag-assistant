[site]: crossvalidated
[post_id]: 221892
[parent_id]: 
[tags]: 
Can you please explain Simpson's paradox with equations, instead of contingency tables?

I probably don't have a clear understanding of the Simpson's paradox . Informally I know that the average of response Y1, grouped over all possible levels of factor A, can be higher than the average of response Y2 over all levels of A, even if the average of Y1 for each level of A (each group) is always less than the corresponding average of Y2. I've read examples, but I still get surprised each time I see it, maybe because I don't learn well by specific examples: I have troubles generalizing them. I learn best, and would rather see, an explanation in formulas. Can you please explain the paradox relying on equations, instead than count tables? Also, I think the reason for my surprise is that I could unconsciously be making some assumptions about the averages involved in the paradox, which may not be true in general. Maybe I forget to weight by the number of samples in each group? But then, I would like to see an equation which shows me that the estimate of the total average is more accurate if I weight each group average by the number of samples in each group, because (if this is true) it isn't obvious to me in general. Naively I would think that the estimate of $\mathbf{E}[Y_1]$ has a lower standard error when I have more samples, irrespective of weighting.
