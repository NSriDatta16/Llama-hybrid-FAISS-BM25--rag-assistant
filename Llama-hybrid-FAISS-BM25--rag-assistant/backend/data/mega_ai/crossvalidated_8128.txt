[site]: crossvalidated
[post_id]: 8128
[parent_id]: 8126
[tags]: 
For logistic regression $\pi$ is calculated using formula $$\pi=\frac{1}{1+\exp(-X\beta)}$$ So diagonal values of $V$ can be calculated in the following manner: pi Now multiplying by diagonal matrix from left means that each row is multiplied by corresponding element from diagonal. Which in R can be achieved using simple multiplication: VX Then H can be calculated in the following way: H Note Since $V$ contains standard deviations I suspect that the correct formula for $H$ is $$H=VX(X'V^2X)^{-1}X'V$$ The example code works for this formula.
