[site]: stackoverflow
[post_id]: 4097671
[parent_id]: 
[tags]: 
How to delete openssl dlls before closing the application

I made a simple tool (LogAndMailApplication) that sends logs to my gmail account, for this I used the Indy component TIdSSLIOHandlerSocketOpenSSL. To work it needs ssleay32.dll and libeay32.dll. So at application start I extract from exe resources the 2 dll and I copy them to the application folder. All the indy compoennts are in a datamodule I destroy before closing the application. After destroying the datamodule I try to delete the dlls but I cannot. I just used DeleteFile, but that worked great for all the other files I delete on application exit (incluging an ini file). I tried to make a simple exe that just deletes the 2 dll and it works. So the problem is that the 2 dll are somehow locked until the LogAndMailApplication is not closed, how to solve the problem?
