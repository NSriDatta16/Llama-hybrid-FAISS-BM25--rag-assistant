[site]: stackoverflow
[post_id]: 771397
[parent_id]: 
[tags]: 
Only one top level element is allowed in an XML document

Following is the code for inserting new nodes in an xml file . Dim fleStream As New FileStream("C:\mailing.xml", FileMode.Append, FileAccess.Write,FileShare.ReadWrite) Dim stmWriter As New StreamWriter(fleStream) Dim writer As New XmlTextWriter(stmWriter) Dim currNode As XmlNode Dim doc As New XmlDocument doc.LoadXml((" " + " " + " ")) 'doc.Load("C:\mailing.xml") ' Dim docFrag As XmlDocumentFragment = doc.CreateDocumentFragment() docFrag.InnerXml = " " + txtFrom.Text + " " currNode = doc.DocumentElement.FirstChild.AppendChild(docFrag) currNode.InsertAfter(docFrag, currNode.LastChild) docFrag.InnerXml = " " + txtTo.Text + " " currNode = doc.DocumentElement.FirstChild.FirstChild.AppendChild(docFrag) currNode.InsertAfter(docFrag, currNode.LastChild) docFrag.InnerXml = " " + txtSubject.Text + " " currNode = doc.DocumentElement.FirstChild.AppendChild(docFrag) currNode.InsertAfter(docFrag, currNode.LastChild) docFrag.InnerXml = " " + txtBody.Text + " " currNode = doc.DocumentElement.FirstChild.AppendChild(docFrag) currNode.InsertAfter(docFrag, currNode.LastChild) doc.Save(writer) 'doc.Save("C:\xmlmailfile.xml") ' writer.Flush() stmWriter.Flush() stmWriter.Close() By executing this i cant able to view the result in IE,an error msg comes as "The XML page cannot be displayed Cannot view XML input using XSL style sheet. Only one top level element is allowed in an XML document. Error processing resource 'file:///C:/mailing.xml'. Line 2, Posi... asdasd@qwe.com When i open the xml file the datas are entered,Can anyone help me to solve the pblm.What modifications are to be done in my code?
