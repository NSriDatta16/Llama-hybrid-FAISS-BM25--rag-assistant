[site]: stackoverflow
[post_id]: 556596
[parent_id]: 556525
[tags]: 
I suggest using WinPcap for this purpose. Even when you figure out how to do this properly with the win32 API it is going to be horribly slow. I've used WinPcap successfully to inject packets to a Gigabit ethernet port as fast as the hardware can handle.
