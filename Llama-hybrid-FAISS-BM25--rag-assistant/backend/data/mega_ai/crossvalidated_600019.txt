[site]: crossvalidated
[post_id]: 600019
[parent_id]: 
[tags]: 
Is $K_z( z, z^{\prime})=\sigma(w^Tz+b)\sigma(w^Tz^{\prime}+b)$ with nonlinear function $\sigma$, generally a valid covariance function for a GP?

Is $\mathbf K_z(\mathbf z,\mathbf z^{\prime})=\sigma(\mathbf z^T\mathbf w+b)\sigma(\mathbf (z^{\prime})^T\mathbf w+b)$ with nonlinear function $\sigma$ , generally a valid covariance function (kernel) for a Gaussian process? In Yarin gal's paper "Dropout as a Bayesian Approximation: Appendix", section 3.1 (p.5) , the author states that "It is trivial to show that [the below covariance function] defines a valid covariance function following [Tsuda et al., 2002] ." $$\mathbf K(\mathbf x_1,\mathbf x_2)=\int p(\mathbf w)p(\mathbf b)\sigma(\mathbf x_1^T\mathbf w+b)\sigma(\mathbf x_2^T\mathbf w+b)d\mathbf w db$$ However, due to my lack of understanding, I could not understand how the [Tsuda et al., 2002] relates to justifying the claim that the above covariance function is valid. Specifically, [Tsuda et al., 2002] deal with the following form of marginalized kernel and it seems it is the only notion that can be related to the covariance function. $$\mathbf{K}(x,x^{\prime}) = \sum_{h\in\mathcal{H}}\sum_{h^{\prime}\in\mathcal{H}}p(h|x)p(h^{\prime}|x^{\prime})\mathbf{K}_z(z,z^{\prime})$$ Then, $\sigma(\mathbf w^T\mathbf x + b)\sigma(\mathbf w^T\mathbf y+b)$ would relate to $\mathbf{K}_z(z,z^{\prime})$ in [Tsuda et al., 2002] . [Tsuda et al., 2002] claims that $\mathbf{K}_z(z,z^{\prime})$ needs to be positive semidefinite. But it is hard for me to understand $\sigma(\mathbf w^T\mathbf x + b)\sigma(\mathbf w^T\mathbf y+b)$ (with any nonlinear function $\sigma$ ) is positive semidefinite. Is the above approach correct? If not, what is the right approach to showing the above covariance function is valid?
