[site]: stackoverflow
[post_id]: 562512
[parent_id]: 
[tags]: 
Why would .htaccess fire twice in IE when downloading a protected XLS file?

Certain directories are protected by Basic Auth using a .htaccess file on an older Apache 1.x server. Today a user pointed out that the username/password was requested twice for the file he had just posted - once when entering the directory to see the index, and then AGAIN when downloading the file. Finding this odd, I researched the usual problems with double-firing .htaccess authentication: server name ( http://server vs. http://www.server ) trailing slash ( http://server/somedir vs. http://server/somedir/ ) http vs https No luck. Add to the confusion that Firefox/Chrome/Safari don't ask twice - only IE (6 and 7). Further investigation showed that this doesn't happen with PDF files - only Excel files - even blank ones. Is Excel calling back to the server somehow that requires a second authentication? Why does it only happen in IE? Not critical - but I'm very curious what could be causing this. EDIT - I think bmdhacks nailed it. Watching the network traffic, Excel+IE fires back a second request with a different User Agent called "Microsoft Protocol Discovery"
