[site]: crossvalidated
[post_id]: 623490
[parent_id]: 
[tags]: 
Building a Multivariate Dynamic Linear Model with Linear Trend and Seasonal Component

Edit. I have made some progress myself, though I have not completely solved the issue. In short, I can fit what I think is a proper description of the model I want, and I can filter it, but I get an error when I try to smooth the series. I am trying to learn dynamic linear models, and at the same package learn the R dlm package. I am working on a bivariate model, with a linear trend and a seasonal component. My problem seems to be similar to this one:: multivariate seasonal time series in dlm in r . However, the question was never fully answered, possibly because it was not asked in the most helpful way, so I am trying to do better. I have data which is monthly earnings data for the public and private sector. Giving only the first 150 terms, we have: wagte_ts Now, with the help of this tutorial I found it easy to build and run a univariate model. ##### Univariate State Space Model # forecasting using state sapce models model.build The real problem I want to solve is how to build a bivariate model. I have found a useful resource , and working from that I think that the code for the model I want is: # Define the model building function with the provided FF and GG structure build1 $FF GG $m0 C0 And to run the model you can use the following code: # Define plausible alternative starting parameters initial_params_private This seems to work and gives the following results. $par [1] 0.50000000 0.50000000 0.10000000 0.09999999 0.10000000 0.10000000 $value [1] 150923.2 $counts function gradient 26 26 $convergence [1] 0 $message [1] "CONVERGENCE: REL_REDUCTION_OF_F I can get filtered estimates using the following code. # Create a list to store filtered models for each series filtered_models The problem arises when I try to smooth the series. # Create a list to store smoothed models for each series smoothed_models This gives the following error. Error in dlmSmooth.dlmFiltered(dlmFilter(y, mod, ...), ...) : error code 13 from Lapack routine dgesdd This is where I get stuck. Any help greatly appreciated.
