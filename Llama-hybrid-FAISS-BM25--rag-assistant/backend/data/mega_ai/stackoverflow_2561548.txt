[site]: stackoverflow
[post_id]: 2561548
[parent_id]: 2299549
[tags]: 
I managed to generate a dynamic table of contents (dynamic in the sense that the page numbers are collected at print time and are not in the static html page). It isn't pretty though. I couldn't find any way to determine what part of my document was being flowed into the specific device and layout rects. Instead, I break my document up into individual html files, one for each section. To print, I create an html file that looks roughly like this: Table of Contents Report Page Foo 0 Bar 0 Etc 0 ... Rather than send that document to the printer, my print template pulls out all the section URLs from the document object. It then sends each of these to the printer and for each, it tracks the page number the section is printed on. When printing is complete, it updates the original document and replaces the '0' placeholders with the actual page numbers. Then the table of contents is printed. It's not very elegant and now I have to add the rest of the UI around my print template code.
