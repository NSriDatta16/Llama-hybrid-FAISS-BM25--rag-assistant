[site]: stackoverflow
[post_id]: 656263
[parent_id]: 
[tags]: 
Problem injecting a VB parameter into a stored procedure (FireBird)

Everyone here has always been such great help, either directly or indirectly. And it is with grand hope that this, yet again, rings true. For clarification sakes, the Stored Procedure is running under FireBird and the VB is of the .NET variety I have a stored procedure (excerpt below, important bit is the WHERE) select pn, pnm.description, si_number, entry_date, cmp_auto_key, parts_flat_price, labor_flat_price, misc_flat_price, woo_auto_key, wwt_auto_key from parts_master pnm, wo_operation woo where pn like :i_pn || '%' and pnm.pnm_auto_key = woo.pnm_auto_key into :pn, :description, :work_order, :entry_date, :cmp, :parts_price, :labor_price, :misc_price, :woo, :wwt I am trying to pass a parameter from a vb app, that uses the parameter I_PN, the code of which follows below (The variables for MyServer and MyPassword are determined form an earlier part of the code.) Try Dim FBConn As New FirebirdSql.Data.FirebirdClient.FbConnection() Dim FBCmd As FirebirdSql.Data.FirebirdClient.FbCommand Dim MyConnectionString As String MyConnectionString = _ "datasource=" & MyServer & ";database=" & TextBox4.Text & "; & _ user id=SYSDBA;password=" & MyPassword & ";initial catalog=;" FBConn = New FirebirdSql.Data.FirebirdClient. & _ FbConnection(MyConnectionString) FBConn.Open() FBConn.CreateCommand.CommandType = CommandType.StoredProcedure FBCmd = New FirebirdSql.Data.FirebirdClient. & _ FbCommand("WIP_COSTS", FBConn) FBCmd.CommandText = "WIP_COSTS" FBConn.CreateCommand.Parameters. & _ Add("@I_PN", FirebirdSql.Data.FirebirdClient.FbDbType.Text). & _ Value = TextBox1.Text Dim I_PN As Object = New Object() Me.WIP_COSTSTableAdapter.Fill(Me.WOCostDataSet.WIP_COSTS, @I_PN) FBConn.Close() Catch ex As System.Exception System.Windows.Forms.MessageBox.Show(ex.Message) End Try When I execute the VB.App and try to run the program, I get the following Error: Dynamic SQL Error SQL Error Code = -206 Column Unknown I_PN At Line 1, column 29 And I can't quite put my finger on what the actual problem is. Meaning, I don't know if my logic is incorrect on the VB side, or, on the Stored Procedure. Any coding that is included is kludged together from examples I have found with various bits of code found during long sojourns of GoogleFu. As anyone with more than a month or two of experience (unlike me) with VB can attest with merely a glance - my code is probably pretty crappy and not well formed - certainly not elegant and most assuredly in operational. I am certainly entertaining all flavors of advice with open arms. As usual, if you have further questions, I will answer them to the best of my ability. Thanks again. Jasoomian
