[site]: stackoverflow
[post_id]: 2779210
[parent_id]: 2779063
[tags]: 
Usually (ignoring Connection: keep-alive, very short first packet etc.) the URI would be the second word on the first line of the first outgoing TCP packet (defining words as space delimited, lines as CR LF delimited). As wireshark is based on libpcap, is open source and does a pretty good job of this, you can start from looking there.
