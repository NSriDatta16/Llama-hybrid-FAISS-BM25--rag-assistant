[site]: crossvalidated
[post_id]: 636465
[parent_id]: 636429
[tags]: 
This is decidedly not my area of expertise so I'll refrain from interpreting anything, and I apologize if I only say trivial things. Since the ROC curve is given plotting sensitivity against specificity at various threshold values, the area under the curve is the average of both sensitivity and specificity (over all values of the other) in the sense that the integral of a function is just the "average" of that function. Moreover, the computed my_roc$specificities and my_roc$sensitivities are not evenly spaced so if you want to compute the average of the specificity over all sensitivities in your simulation, you will need to weigh each specificity by "how large" the band of sensitivities that specificity corresponds to is. For example, in the below picture (at N = 100 for visual clairity), the sensitivity computed in the red circle is given for a large band of specificity compared to the black circle, but mean(my_roc$specificities) discards that. Once we take this into account, everything seems to work out alright. The following code gives all three bottom differences as basically equal, as expected: this weighted average is identical to a Riemann sum, e.g. senss[i] and senss[i] are exactly the same. So I think the issue is how one interprets/computes the phrase "average across all thresholds." library(pROC) set.seed(2024) N $sensitivities[1:N], diff(my_roc$ specificities)) specs[i] $specificities[1:N], diff(my_roc$ sensitivities)) } # Are all three equal? # summary(aucs - senss) summary(aucs - specs) summary(senss - specs) } # Are all three equal? # summary(aucs - senss) summary(aucs - specs) summary(senss - specs) I get the following results. > summary(aucs - senss) Min. 1st Qu. Median Mean 3rd Qu. Max. 0 0 0 0 0 0 > summary(aucs - specs) Min. 1st Qu. Median Mean 3rd Qu. Max. -1.354e-14 -1.665e-15 3.331e-16 4.714e-16 2.776e-15 1.432e-14 > summary(senss - specs) Min. 1st Qu. Median Mean 3rd Qu. Max. -1.354e-14 -1.665e-15 3.331e-16 4.714e-16 2.776e-15 1.432e-14
