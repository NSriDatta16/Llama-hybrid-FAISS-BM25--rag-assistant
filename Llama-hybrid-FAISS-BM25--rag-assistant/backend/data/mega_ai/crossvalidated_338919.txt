[site]: crossvalidated
[post_id]: 338919
[parent_id]: 
[tags]: 
Cross-correlation across an interrupted time series?

I want to compare the time series of two counts of objects, collected simultaneously: Abundance of object A Abundance of object B I go to a site, and measure the abundances over a given time period simultaneously for both objects (the duration of the time period is always the same). Rather than having one pair of long time series, I instead have multiple small paired time series collected at different times in different places. I want to apply a single cross correlation analyses across this "time series with interruptions" to determine if object a drives changes in object b (thus changes in object b lag behind), but as far as I know R has no native way to deal with this ... so I wrote my own function. Applying a cross correlation to each individual paired time series segment is not ideal, as the observation periods are short enough to cause quite some variance in the correlation results, and interpretation is problematic. My question is: are there any problems with my approach? (detailed below) Proposal I did this in the following steps: For each segment of paired time series, adjust for the desired lag (by offsetting one of the time series by lag samples) Join all the segments of the time sieries together in a single paired time series Calculate the pearsons correlation value Repeat for all lag values Questions So long as I assume that the sites where the data was collected were spatially independent, is this still considered a proper cross correlation analysis? Are there any assumptions regarding cross correlation that this approach may violate? Implementation Here is the code I used to implement the proposed workflow above. #' Cross correlation across a segmented time series #' #' @param X A list object where each object holds a continious portion of a time series. #' Each member must be a data.frame or matrix with 2 columns, holding the two timeseries to be tested against. #' @param max.lag Maximum lag to calculate. #' If left as NA, will be automatically calculated. #' #' @return #' @export xcor max.lag.x){message('Adjusting user max lag (was set too high)')} max.lag 0){ backward
