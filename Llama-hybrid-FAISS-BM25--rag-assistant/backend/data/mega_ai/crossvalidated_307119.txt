[site]: crossvalidated
[post_id]: 307119
[parent_id]: 
[tags]: 
Normal - $\chi^2$ mixture is a $t$ distribution

In the book Introducing Monte Carlo Methods with R , Robert & Casella mention that Student's $t$ density can be written as a mixture of normal distibutions with zero mean and $\chi^2$-distributed precision parameters (page 50, section 2.2.3): $$ X\vert y \sim N(0, \frac{\nu}{y})\quad\text{and}\quad Y\sim \chi_\nu^2\,. $$ I fail to see how the pdf of the mixture distribution $$ f(x) = \int dy\, g(x\vert y)p(y) $$ corresponds to that of a $t$ distribution with $\nu$ degrees of freedom $$ f_{t}(x) = \frac{\Gamma{\left(\frac{\nu+1}{2}\right)}}{\sqrt{\pi\nu}\Gamma{\left(\frac{\nu}{2}\right)}}\left(1+\frac{x^2}{\nu}\right)^{-\frac{\nu+1}{2}}\,. $$ This is what I've done so far: The normal and $\chi^2$ distributions are in this case $$ \begin{aligned} g(x\vert y) &= \frac{y}{\sqrt{2\pi\nu^2}}\exp{\left(-\frac{x^2y^2}{2\nu^2}\right)}\\ p(y) &= \frac{1}{2^{\nu/2}\Gamma{\left(\frac{\nu}{2}\right)}}y^{\frac{y}{2} - 1}\exp{\left(-\frac{y}{2}\right)}\,. \end{aligned} $$ The mixture distribution is then $$ \begin{aligned} f(x) &= \int_0^\infty dy\, \frac{y}{\sqrt{2\pi\nu^2}}\exp{\left(-\frac{x^2y^2}{2\nu^2}\right)} \frac{1}{2^{\nu/2}\Gamma{\left(\frac{\nu}{2}\right)}}y^{\frac{y}{2} - 1}\exp{\left(-\frac{y}{2}\right)}\\ &= \frac{1}{\sqrt{2\pi\nu^2}}\frac{1}{2^{\nu/2}\Gamma{\left(\frac{\nu}{2}\right)}}\int_0^\infty dy\, y^{\frac{y}{2}}\exp{\left(-\frac{x^2y^2}{2\nu^2} - \frac{y}{2}\right)} \end{aligned} $$ I'm now trying to reduce the integral to a standard integral of the form $\int x^n \exp{\left(-a x^2\right)}$. Completing the square in the exponential gives $$ f(x) = \frac{1}{\sqrt{2\pi\nu^2}}\frac{1}{2^{\nu/2}\Gamma{\left(\frac{\nu}{2}\right)}}\exp{\left(\frac{\nu^2}{8x^2}\right)}\int_0^\infty dy\, y^{\frac{y}{2}}\exp{\left(-\frac{x^2}{2\nu^2}\left(y + \frac{\nu^2}{2x^2}\right)^2 \right)}\,. $$ This is where I'm not sure how to proceed. According to Wolfram alpha, the integral has a closed form involving Kummer's confluent hypergeometric functions ${}_1F_1$ $$ \int_0^\infty dx\, x^n \exp{\left(-a(x-b)^2\right)} = \frac{1}{2}a^{-\frac{n}{2}-\frac{1}{2}}\left(\sqrt{a}b n \Gamma{\left(\frac{n}{2}\right)}{}_1F_1{\left(\frac{1-n}{2};\frac{3}{2};-ab^2\right)} + \Gamma{\left(\frac{n+1}{2}\right)}{}_1F_1{\left(-\frac{n}{2}; \frac{1}{2}; -ab^2\right)}\right) $$ However, I'm not sure how this reduces to the pdf of the $t$ distribution. In particular I'm not sure how the term $\exp{\left(\frac{\nu^2}{8x^2}\right)}$ in front of the integral in $f(x)$ can disappear; or what to do with the hypergeometric functions. Note 1 : I tried a change of variables, $z = y + \frac{\nu^2}{2x^2}$, which gives me the integral $$ f(x) = \frac{1}{\sqrt{2\pi\nu^2}}\frac{1}{2^{\nu/2}\Gamma{\left(\frac{\nu}{2}\right)}}\exp{\left(\frac{\nu^2}{8x^2}\right)}\int_0^\infty dz\, \left(z - \frac{\nu^2}{2x^2}\right)^{\frac{y}{2}}\exp{\left(-\frac{x^2}{2\nu^2}z^2 \right)}\,, $$ but I'm not sure this is any improvement. Note 2 : It seems that the noncentral $t$ distribution can be expressed in terms of the confluent hypergeometric functions; however according to Robert & Casella, the mixture distribution is that of a (central) $t$ distribution with $\nu$ degrees of freedom. The noncentral $t$ distribution reduces to the central $t$ distribution in the case of a zero non-centrality parameter $\mu$, in which case the confluent hypergeometric functions reduce to $_{1}F_1 (a,b,0) = 1$. However this is clearly not the case here, where $a > 0, b > 0$, and the terms involving $_{1}F_1$ in the closed form above do not collapse.
