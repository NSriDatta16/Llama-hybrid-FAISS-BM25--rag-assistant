[site]: stackoverflow
[post_id]: 5253834
[parent_id]: 5253739
[tags]: 
You're on the right track with a self-join, but I think you might be joining on the wrong column. And I think you're going to need a GROUP BY as well. Try with something more like this: SELECT calls_count_pre.* FROM calls_count_pre LEFT JOIN calls_count_pre AS temp ON calls_count_pre.msisdn = temp.msisdm AND calls_count_pre.agent = temp.agent AND temp.date > calls_count_pre.date AND DATESUB(temp.date, INTERVAL 5 MINUTE)
