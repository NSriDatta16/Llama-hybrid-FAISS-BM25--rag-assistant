[site]: stackoverflow
[post_id]: 3899852
[parent_id]: 
[tags]: 
Finding all Images in a FlowDocument

Since I am pretty new to WPF FlowDocuments I would like to ask if the code below is correct. It is supposed to return all Images contained in a FlowDocument as List: List FindAllImagesInParagraph(Paragraph paragraph) { List result = null; foreach (var inline in paragraph.Inlines) { var inlineUIContainer = inline as InlineUIContainer; if (inlineUIContainer != null) { var image = inlineUIContainer.Child as Image; if (image != null) { if (result == null) result = new List (); result.Add(image); } } } return result; } private List FindAllImagesInDocument(FlowDocument Document) { List result = new List (); foreach (var block in Document.Blocks) { if (block is Table) { var table = block as Table; foreach (TableRowGroup rowGroup in table.RowGroups) { foreach (TableRow row in rowGroup.Rows) { foreach (TableCell cell in row.Cells) { foreach (var block2 in cell.Blocks) { if (block2 is Paragraph) { var paragraph = block2 as Paragraph; var images = FindAllImagesInParagraph(paragraph); if (images != null) result.AddRange(images); } else if (block2 is BlockUIContainer) { var container = block as BlockUIContainer; if (container.Child is Image) { var image = container.Child as Image; result.Add(image); } } } } } } } else if (block is Paragraph) { var paragraph = block as Paragraph; var images = FindAllImagesInParagraph(paragraph); if (images != null) result.AddRange(images); } else if (block is BlockUIContainer) { var container = block as BlockUIContainer; if(container.Child is Image) { var image = container.Child as Image; result.Add(image); } } } return result.Count > 0 ? result : null; }
