[site]: crossvalidated
[post_id]: 407658
[parent_id]: 
[tags]: 
Is this an example of where I shouldn't scale before doing PCA / PLS?

I'm working with NMR spectra (it's a common chemical test). There are various peaks of the signal across a range of ppm values. I'm trying to relate the NMR spectra of various samples to a measured property of the samples. PCA and PLS seem like valuable tools. I'll just talk about PCA for this example, but my question also applies to PLS. The data that I send to PCA has this structure: each column is a ppm value, each row is a sample, and the value is the sample's signal at that ppm. For this data that I've made up, it seems like there should be one dominant principal component that describes the size of the peak. This is indeed the case if I don't scale the columns. But if I do scale the columns (which is always what I've done with PCA), the Scree plot makes no sense to me. Why are so many principal components needed to describe the variance? Is this a problem where I shouldn't scale the columns? What about when I apply to real data, where there are multiple peaks of widely varying heights? Is there a "best practice" for doing PCA and PLS on spectral data? (I don't have a background in biostatistics or chemometrics). Spectra The matrix for PCA 3 3.01 3.02 3.03 3.04 ... sample1 0.002798792 0.0031477185 0.0090656919 0.008150071 0.005397167 ... sample2 0.009681631 0.0006409005 0.0003475848 0.009898928 0.003882373 ... sample3 0.001149334 0.0020842757 0.0057974388 0.008381035 0.004349227 ... sample4 0.009143676 0.0003381718 0.0078882525 0.009483161 0.007021517 ... R code library(dplyr) library(reshape2) library(ggplot2) library(factoextra) # make up some spectral data D % ggplot() + aes(ppm, signal, color = sample) + geom_line() + geom_point() # Prepare data for PCA Dc
