[site]: stackoverflow
[post_id]: 5285454
[parent_id]: 5279577
[tags]: 
To show a bitmap in a DataGrid cell you can use a DataGridTemplateColumn with a DataTemplate using the IValueConverter to display an image in a DataGrid cell. You can play with properties of BmpBitmapDecoder to achieve as good an image as possible. Here is the definition for the DataGrid in XAML: 1- I have three columns in the DataGrid with the first one being the image. 2- I set Path=. because all I wanted to do was load the image from the converter. 3- The DataGrid binds to a Customers collection in a ViewModel, and I included the definitions of those for completeness at the end. Here is the converter that does a onetime lookup of the Word Doc's associated icon. If you want to handle multiple icons store the BitmapFrame references in a Dictionary and use the "value" input parameter to select which image to display. using System; using System.Drawing; using System.Drawing.Imaging; using System.Globalization; using System.IO; using System.Windows.Data; using System.Windows.Media.Imaging; namespace ContextMenuNotFiring.Helpers { [ValueConversion(typeof(object), typeof(BitmapSource))] public sealed class ImageConverter : IValueConverter { private static BitmapFrame _bitmapFrame = null; public object Convert(object value, Type targetType, object parameter, CultureInfo culture) { try { if (_bitmapFrame == null) { using (Icon bigIcon32x32 = Icon.ExtractAssociatedIcon("c:\\temp\\test.docx")) { using (Bitmap bm = bigIcon32x32.ToBitmap()) { MemoryStream finalStream = new MemoryStream(); { bm.Save(finalStream, ImageFormat.Bmp); BmpBitmapDecoder bitmapDecoder = new BmpBitmapDecoder(finalStream, BitmapCreateOptions.None, BitmapCacheOption.None); _bitmapFrame = bitmapDecoder.Frames[0]; } } } } return _bitmapFrame; } catch { return Binding.DoNothing; } } public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) { throw new NotImplementedException(); } } } The View Model loads the following collection of Customers my View Model constructor. private List _customers = new List (): public List Customers { get { return _customers; } } public class Customer { public String FirstName { get; set; } public String LastName { get; set; } }
