[site]: crossvalidated
[post_id]: 507783
[parent_id]: 507731
[tags]: 
Let $a_{i_1,j_1,i_2,j_2}$ denote the probability of a certain outcome in a single roll (or, what I will call a mini-battle) -the attacker rolls $i_1$ dice -the defender rolls $j_1$ dice -a roll means both players roll all of their dice - $i_2$ is the number of troops the attacker loses - $j_2$ is the number of troops the defender loses For example, $a_{2,1,1,0}=$ the probability that the attacker loses one troop and the defender loses 0 troops when the attacker rolls two dice and defender rolls 1 die $=\frac{1}6\left(\frac{1^2}6+\frac{2^2}{6^2}+\frac{3^2}{6^2}+\frac{4^2}{6^2}+\frac{5^2}{6^2}+\frac{6^2}{6^2} \right)=\frac{91}{216}$ Important cases: $a_{3,3,0,3}=$ the probability that the attacker loses zero troops and the defender loses three troops when both players roll three dice $=\frac{6420}{6^6}$ $a_{3,3,1,2}=\frac{10017}{6^6}$ $a_{3,3,2,1}=\frac{12348}{6^6}$ $a_{3,3,3,0}=\frac{17871}{6^6}$ The average number of troops lost by the attacker in a 3 vs 3 mini-battle (one roll of the dice) is $\frac{88326}{6^6} \approx 1.893$ . Thus, the defender on average loses 1.107 troops. The attacker should start with $\frac{1.893}{1.107} \approx 1.71$ times more troops to have the long term advantage in the battle. Roughly, if the attacker has 70% more troops than the defender, they will have more than 50% chance of winning. Otherwise they have less than 50% chance of winning. Another important case: $a_{3,1,1,0}=\frac{49}{144}$ Thus, for $j\ge 1$ we have $p(1,j)=0$ because the attacker is not allowed to attack. $p(2,1)=1-P[\text{attacker loses the mini-battle}]=1-a_{2,1,1,0}$ and for $n>2$ , we have $p(n,1)=1-P[\text{attacker loses all mini-battles}]=1-a_{2,1,1,0} (a_{3,1,1,0})^{n-2}$ Define the generating function $$f(x,y)=\sum_{i=0}^\infty\sum_{j=0}^\infty p(i,j) x^i y^j$$ where $p(i,j)$ is the probability that the attacker wins the battle when they start with $i$ troops and the defender starts with $j$ troops. Make the conventions and . We have the following: $$p(0,j)=p(1,j)=0$$ $$p(i,0)=1 \text{ if } i>1$$ $$p(2,1)=a_{2,1,0,1}$$ $$p(2,2)= a_{2,2,0,2}$$ If $i,j\ge 3$ then $$p(i,j)=\sum_{i_2=0}^3 a_{3,3,i_2,3-i_2}p(i-i_2,j-3+i_2)$$ If $i\ge 3$ then $$p(i,2)=\sum_{i_2=0}^2 a_{3,2,i_2,2-i_2}p(i-i_2,i_2)$$ If $i\ge 3$ then $$p(i,1)=\sum_{i_2=0}^1 a_{3,1,i_2,1-i_2}p(i-i_2,i_2)$$ If $j\ge 3$ then $$p(2,j)=a_{2,3,0,2}p(2,j-2)$$ Note that $$f(x,y)-\sum_{j=0}^\infty p(2,j) x^2 y^j -\sum_{i=3}^\infty p(i,0) x^i y^0$$ $$-\sum_{i=3}^\infty p(i,1) x^i y^1-\sum_{i=3}^\infty p(i,2) x^i y^2$$ $$=\sum_{i=3}^\infty\sum_{j=3}^\infty p(i,j) x^i y^j$$ $$=\sum_{i=3}^\infty\sum_{j=3}^\infty \sum_{i_2=0}^3 a_{3,3,i_2,3-i_2}p(i-i_2,j-3+i_2) x^i y^j$$ $$=\sum_{i=3}^\infty\sum_{j=3}^\infty a_{3,3,0,3}p(i,j-3) x^i y^j+\sum_{i=3}^\infty\sum_{j=3}^\infty a_{3,3,1,2}p(i-1,j-2) x^i y^j$$ $$+\sum_{i=3}^\infty\sum_{j=3}^\infty a_{3,3,2,1}p(i-2,j-1) x^i y^j+\sum_{i=3}^\infty\sum_{j=3}^\infty a_{3,3,3,0}p(i-3,j) x^i y^j$$ $$=a_{3,3,0,3}y^3\sum_{i=3}^\infty\sum_{j=3}^\infty p(i,j-3) x^i y^{j-3} +a_{3,3,1,2}x y^2\sum_{i=3}^\infty\sum_{j=3}^\infty p(i-1,j-2) x^{i-1} y^{j-2}$$ $$+a_{3,3,2,1}x^2 y\sum_{i=3}^\infty\sum_{j=3}^\infty p(i-2,j-1) x^{i-2} y^{j-1} +a_{3,3,3,0} x^3\sum_{i=3}^\infty\sum_{j=3}^\infty p(i-3,j) x^{i-3} y^j$$ $$=a_{3,3,0,3}y^3\sum_{i=3}^\infty\sum_{j=0}^\infty p(i,j) x^i y^j +a_{3,3,1,2}x y^2\sum_{i=2}^\infty\sum_{j=1}^\infty p(i,j) x^i y^j$$ $$+a_{3,3,2,1}x^2 y\sum_{i=1}^\infty\sum_{j=2}^\infty p(i,j) x^i y^j +a_{3,3,3,0} x^3\sum_{i=0}^\infty\sum_{j=3}^\infty p(i,j) x^i y^j$$ $$=a_{3,3,0,3}y^3\left(f(x,y)-\sum_{j=0}^\infty p(2,j) x^2 y^j\right)$$ $$+a_{3,3,1,2}x y^2\left(f(x,y)-\sum_{i=2}^\infty p(i,0) x^i y^0 \right) $$ $$+a_{3,3,2,1}x^2 y \left( f(x,y)- \sum_{i=1}^\infty p(i,1) x^i y^1- \sum_{i=1}^\infty p(i,0) x^i y^0\right)$$ $$+a_{3,3,3,0} x^3 \left(f(x,y)-\sum_{i=0}^\infty p(i,0) x^i y^0-\sum_{i=0}^\infty p(i,1) x^i y^1-\sum_{i=0}^\infty p(i,2) x^i y^2 \right)$$ Now, solve for $f(x,y)$ . You can take the derivatives of different orders of $f(x,y)$ wrt $x$ and $y$ and plug in $x=0,y=0$ to find the probabilities $p(a,d)$ . Some of the steps needed to solve: $$\sum_{i=1}^\infty p(i,0) x^i=\frac{x}{1-x}$$ $$\sum_{i=2}^\infty p(i,1) x^i$$ $$=a_{2,1,0,1} x^2 + \sum_{i=3}^\infty (1-a_{2,1,1,0} (a_{3,1,1,0})^{i-2}) x^i$$ $$=x^2\left(a_{2,1,0,1}+\frac{x(1+a_{2,1,1,0}a_{3,1,1,0}(x-1)-a_{3,1,1,0}x)} {(x-1)(a_{3,1,1,0}x-1)}\right)$$ $$\sum_{i=3}^\infty p(i,2) x^i =\sum_{i=3}^\infty \left( \sum_{i_2=0}^2 a_{3,2,i_2,2-i_2}p(i-i_2,i_2) \right) x^i$$ $$=\sum_{i=3}^\infty a_{3,2,i_2,2}p(i,0) x^i+\sum_{i=3}^\infty a_{3,2,1,1}p(i-1,1) x^i+\sum_{i=3}^\infty a_{3,2,2,0}p(i-2,2) x^i$$ $$=a_{3,2,i_2,2} \frac{x^3}{1-x} +a_{3,2,1,1}x\sum_{i=2}^\infty p(i,1) x^i +a_{3,2,2,0} x^2\sum_{i=1}^\infty p(i,2) x^i$$ Then, this equation can be solved for $\sum_{i=3}^\infty p(i,2) x^i$ . Solving for the generating function $f(x,y)$ is not easy, but it can be done, I think.
