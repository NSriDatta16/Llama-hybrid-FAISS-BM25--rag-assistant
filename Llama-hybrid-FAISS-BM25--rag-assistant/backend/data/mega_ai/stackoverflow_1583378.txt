[site]: stackoverflow
[post_id]: 1583378
[parent_id]: 
[tags]: 
Unable to assemble multipart/form-data request

I'm trying to implement file upload functionality in the iPhone app. Server code is tested and works when files are uploaded from the desktop browser, so I moved to implementing the Objective-C client code. I'm assembling HTTP requests body manually, and despite that it looks correct, it is rejected by the server (server handler unable to extract the parts from multipart content). In desperation I've simplified the form to having only one parameter, but it still does not work. I've captured the network traffic and I could see that Wireshark could not parse my multipart content as well (have a look at screenshots: Firefox request , iPhone request ). I'm pasting it below in hope that you could see the errors I can't see. Thanks in advance. Firefox: POST /cubepaint/actions/gallery/post HTTP/1.1 Host: [...] User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-GB; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-gb,en;q=0.5 Accept-Encoding: gzip,deflate Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7 Keep-Alive: 300 Connection: keep-alive Authorization: Basic [...] Content-Type: multipart/form-data; boundary=---------------------------20072377098235644401115438165 Content-Length: 180 -----------------------------20072377098235644401115438165 Content-Disposition: form-data; name="deviceId" 12345 -----------------------------20072377098235644401115438165-- HTTP/1.1 200 OK Date: Sat, 17 Oct 2009 22:09:21 GMT Server: Apache/2.2.3 (Debian) DAV/2 SVN/1.4.2 mod_python/3.2.10 Python/2.4.4 mod_ssl/2.2.3 OpenSSL/0.9.8c Keep-Alive: timeout=15, max=100 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html; charset=UTF-8 iPhone: POST /cubepaint/actions/gallery/post HTTP/1.1 Host: [...] User-Agent: Copenhagen/1.0 CFNetwork/459 Darwin/9.8.0 Content-Type: multipart/form-data; boundary=----------0E7B16E6-CD3D-4213-9B42-07DA30822C74 Accept: */* Accept-Language: en-us Accept-Encoding: gzip, deflate Authorization: Basic [...] Content-Length: 187 Connection: keep-alive ----------0E7B16E6-CD3D-4213-9B42-07DA30822C74 Content-Disposition: form-data; name="deviceId" 00000000-0000-1000-8000-0016CBCC0B61 ----------0E7B16E6-CD3D-4213-9B42-07DA30822C74-- HTTP/1.1 200 OK Date: Sat, 17 Oct 2009 22:04:07 GMT Server: Apache/2.2.3 (Debian) DAV/2 SVN/1.4.2 mod_python/3.2.10 Python/2.4.4 mod_ssl/2.2.3 OpenSSL/0.9.8c Keep-Alive: timeout=15, max=100 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html; charset=UTF-8
