[site]: crossvalidated
[post_id]: 582376
[parent_id]: 
[tags]: 
Why is my 95% CI from a simulation being either 100% or 0%?

So what I intended doing with the code is to simulate dataset with the outcome being number of parasites that died (yi) out of every n=50 parasites on the host. There are 2 treatment groups (control and treat). The beta-binomial is parameterized in terms of rho and p. The rho represents the intraclass correlation given by 1/(1+alpha+beta), the "p" surviving probability varies and follows a beta-distribution, yi represents the outcome. 4 different outcomes are expected to be generated based on the different levels of rho so that I evaluate the influence of rho on the outcome and CI. 100 simulations were done for each scenario. I fitted both binomial and beta-binomial model on data afterwards, however, the coverage of the 95% CI is always either 100% or 0%. What are the possible causes of this issue, is it normal? ### FUNCTION FOR GENERATING BETA-BINOMIAL DATA data=function (beta.mu, beta.trt2, rho1, rho2, rho3, rho4, n, N){ logit Below is the simulation and modeling codes ###################################################################################### ####DEFINING THE BETA-BINOMIAL AND BINOMIAL MODELS IN FOR JUGS IN R##################### #Parameters for generating the data with surving probability of 0.55 for control group and 0.055 for treatment group resulting in an efficacy of 0.90 (i.e; 1-0.055/0.55) beta.mu = 0.7256268 beta.trt2 = -3.132089 #PARAMETERS FOR INTRACLASS CORRELATION [RHO= 1/(1+alpha+beta)] rho1=0.01 rho2=0.05 rho3=0.1 rho4=0.2 N=16 #Sample size n=50 #number of parasites per animal #############################MODEL FOR RHO1###################################################### modelString="model { ### Prior distributions rho1 ~ dunif(0,1) beta1.trt2 ~ dnorm(0,0.000001); beta1.mu ~ dnorm(0,0.000001); #likelihood for (i in 1:N) { p[i] ~ dbeta(alpha1[i], beta1[i]) y1[i] ~ dbinom(p[i], n[i]) alpha1[i] = ((1-rho1)*mu[i])/rho1 beta1[i] = (1 - mu[i])*(1-rho1)/rho1 logit(mu[i]) $y1=rbetabinom(N,n,prob=plogis(beta.mu + beta.trt2 * dat$ trt2 ),rho=rho1) #dat $y2=rbetabinom(N,n,prob=plogis(beta.mu + beta.trt2 * dat$ trt2 ),rho=rho2) #dat $y3=rbetabinom(N,n,prob=plogis(beta.mu + beta.trt2 * dat$ trt2 ),rho=rho3) #dat $y4=rbetabinom(N,n,prob=plogis(beta.mu + beta.trt2 * dat$ trt2 ),rho=rho4) #LIST DATASET FOR JAGS datjags $y1, #surviving parasites for Rho1 y2 = dat$ y2, #surviving parasites for Rho2 y3 = dat $y3, #surviving parasites for Rho3 y4 = dat$ y4, #surviving parasites for Rho4 trt2 = dat $trt2, #treatment group n = dat$ n) #amount of parasites that were introduced per animal runjags.options(method = "rjags") #Initialising beta set.seed(20091117) init1 0.90, 1, 0) matrix_bin1[i,6]=ifelse(matrix_bin1[i,1] 0.90, 1, 0) matrix_betabin2[i,6]=ifelse(matrix_betabin2[i,1] 0.90, 1, 0) matrix_bin2[i,6]=ifelse(matrix_bin2[i,1] 0.90, 1, 0) matrix_betabin3[i,6]=ifelse(matrix_betabin3[i,1] 0.90, 1, 0) matrix_bin3[i,6]=ifelse(matrix_bin3[i,1] 0.90, 1, 0) matrix_betabin4[i,6]=ifelse(matrix_betabin4[i,1] 0.90, 1, 0) matrix_bin4[i,6]=ifelse(matrix_bin4[i,1] 0.90, 1, 0) } #EXTRACTING SUMMRRIES OF THE MODELS SIM_HPD2 ```
