[site]: stackoverflow
[post_id]: 5129088
[parent_id]: 5128969
[tags]: 
I've run into roughly the same problem a number of times. It appears that the structure MS has set up for this is so fragile that installing or removing any software on the same machine (or, apparently, breathing anywhere near that machine) can and will break it. Worse, they have a nearly impenetrable web of batch files invoking each other, that in the end carry out some fairly trivial tasks in what appears to be nearly the most roundabout way possible. Although I suppose it wastes a bit of memory I decided to simplify my life a bit, and use this: #include #include #include #include void setenv(std::string const &name, std::string const &value) { SetEnvironmentVariable(name.c_str(), value.c_str()); } std::string vs_base = "C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\"; std::string vc_base = vs_base + "VC\\"; std::string sdk_dir = "C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\"; int main(int argc, char **argv) { char inc_name[] = "INCLUDE"; char lib_name[] = "LIB"; char path_name[] = "PATH"; std::string inc_dir = getenv(inc_name); std::string lib_dir = getenv(lib_name); std::string path_dir = getenv(path_name); inc_dir = vc_base + "include;" + sdk_dir + "include;" + inc_dir; lib_dir = vc_base + "lib;" + sdk_dir + "lib;" + lib_dir; path_dir = vc_base + "bin;" + sdk_dir + "bin;" + vs_base + "Common7\\IDE;" + path_dir; setenv(inc_name, inc_dir); setenv(lib_name, lib_dir); setenv(path_name, path_dir); char path[MAX_PATH]; GetSystemDirectory(path, sizeof(path)); strcat(path, "\\cmd.exe"); _spawnlp(_P_WAIT, path, path, NULL); return 0; } You'll have to adjust the base directories at the top for the locations where you have things installed. One of these days I suppose I should rewrite this to use a separate configuration file (I've pretty much worked out an XML format that should work reasonably well), but this has worked well enough that I haven't bothered to finish that, and since it's for a programmer anyway, doing a trivial modification and re-compile isn't particularly onerous.
