[site]: stackoverflow
[post_id]: 5620475
[parent_id]: 
[tags]: 
iPhone:Strange Issue with videoMaximumDuration property in Video recorder API

I am facing a strange issue with videoMaximumDuration property in Video recorder API. I am trying to fix this issue more than a week, but couldn't. I posted in several forums, but no help yet. I am using the following code to launch Camera from my application and start recording the video. As per my requirement, i should set the time duration for recording the video to stop. So, i use "videoMaximumDuration" property to set the time duration for recording the video. if ([types containsObject:(id)kUTTypeMovie]) { appDelegate.pickerController = [[UIImagePickerController alloc] init]; appDelegate.pickerController.delegate = self; appDelegate.pickerController.videoQuality = setVideoQuality; appDelegate.pickerController.allowsEditing = NO; appDelegate.pickerController.sourceType = UIImagePickerControllerSourceTypeCamera; appDelegate.pickerController.showsCameraControls = YES; appDelegate.pickerController.navigationBarHidden = YES; appDelegate.pickerController.toolbarHidden = YES; appDelegate.pickerController.wantsFullScreenLayout = YES; appDelegate.pickerController.cameraViewTransform = CGAffineTransformScale(appDelegate.pickerController.cameraViewTransform, CAMERA_TRANSFORM_X, CAMERA_TRANSFORM_Y); appDelegate.pickerController.mediaTypes = [NSArray arrayWithObject:(id)kUTTypeMovie]; appDelegate.pickerController.videoMaximumDuration = maxDuration; [self presentModalViewController:appDelegate.pickerController animated:YES]; } Here is the issue: If if i set videoQuality as UIImagePickerControllerQualityTypeHigh, then the time duration(videoMaximumDuration) works as expected, i.e exactly after the time duration it stops recording the video automatically. If i go and see that recorded video in Photo album to make sure that, it is recorded well as per the time. If i change the videoQuality to UIImagePickerControllerQualityTypeMedium (or) UIImagePickerControllerQualityTypeLow like that, then the time duration(videoMaximumDuration) for video recording is not working as expected, i.e. it is able to automatically stop the video recording at the time duration set, no issues, But if i go and see that recorded video in Photo album to make sure, it is NOT as per the time taken, rather i can see the smaller video than what i recorded. For example, if i set the videoMaximumDuration for 30 seconds, after recording the video, if i go and see that recorded video in Photo album, it could able to record= only unto 22 seconds. Seems to be issue with the API itself. This is not happening when i use video quality as UIImagePickerControllerQualityTypeHigh. I tried even using Custom overlay view and do start and stop recording video through code like below by setting timer(NStimer). But still i see the same issue has observed. overlay = [[OverlayView alloc]initWithFrame:CGRectMake(0, 0, 768, 1024)]; if ([types containsObject:(id)kUTTypeMovie]) { appDelegate.pickerController = [[UIImagePickerController alloc] init]; appDelegate.pickerController.delegate = self; appDelegate.pickerController.videoQuality = setVideoQuality; appDelegate.pickerController.allowsEditing = NO; appDelegate.pickerController.sourceType = UIImagePickerControllerSourceTypeCamera; appDelegate.pickerController.showsCameraControls = NO; appDelegate.pickerController.navigationBarHidden = YES; appDelegate.pickerController.toolbarHidden = YES; appDelegate.pickerController.wantsFullScreenLayout = YES; appDelegate.mTimerSelectionForVideo = maxDuration; // TIME SET HERE IN VARIABLE appDelegate.pickerController.cameraViewTransform = CGAffineTransformScale(appDelegate.pickerController.cameraViewTransform, CAMERA_TRANSFORM_X, CAMERA_TRANSFORM_Y); appDelegate.pickerController.mediaTypes = [NSArray arrayWithObject:(id)kUTTypeMovie]; appDelegate.pickerController.videoMaximumDuration = maxDuration; [self presentModalViewController:appDelegate.pickerController animated:YES]; appDelegate.pickerController.cameraOverlayView =overlay; } OverlayView.m -(void)startAction:(id)sender { BOOL bStop = TRUE; void (^hideControls)(void); hideControls = ^(void) { cameraSelectionButton.alpha = 0; startButton.enabled = NO; lbl.hidden = NO; }; void (^recordMovie)(BOOL finished); recordMovie = ^(BOOL finished) { stopButton.enabled = YES; [appDelegate.pickerController startVideoCapture]; }; // Hide controls [UIView animateWithDuration:0.3 delay:0.0 options:UIViewAnimationOptionCurveEaseInOut animations:hideControls completion:recordMovie]; if ( appDelegate.mTimerSelectionForVideo==0 ) { bStop = FALSE; } if ( bStop ) timer = [NSTimer scheduledTimerWithTimeInterval:(appDelegate.mTimerSelectionForVideo)+1 target:self selector:@selector(stopCamera:) userInfo:nil repeats:NO]; } - (void)stopCamera:(NSTimer *)theTimer { startButton.enabled = YES; if ( timer ) { [timer invalidate]; timer = nil; } [appDelegate.pickerController stopVideoCapture]; [appDelegate.pickerController dismissModalViewControllerAnimated:YES]; } But still i see the same issue observed. Why does other video quality settings not working as per the videoMaximumDuration set? I tested on iPhone 4.1 and iPad 4.3, the same issue has been observed. Looks like, issue with the API or video recorder hardware itself to support it. Could someone please guild me to fix this issue if there is any possibility (or) through your experience? Thank you in Advance!
