[site]: crossvalidated
[post_id]: 620842
[parent_id]: 
[tags]: 
Help interpreting zeroinfl results from emmeans

I am working on the example Senecio data from Blasco‐Moreno et al. (2019) using the pscl package in R. I would like to conduct pairwise comparisons of mean rates (Damaged/Total_heads) and don't understand the estimated marginal means for zero-inflated models. This is detailed in the code below. Inference for the negative binomial on the response scale is straightforward (this code gives rates (Damaged/Total_Heads) and ratios of those): library(MASS) library(pscl) # version 1.5.5.1 library(emmeans) # version 1.8.7 dat $Location Location, levels=c("VF", "CB", "CP", "CT", "FM", "SS")) dat $Species Species, levels=c("SV", "SL", "SI", "SP")) NB summary(emm.NB, infer=TRUE) Species response SE df asymp.LCL asymp.UCL null z.ratio p.value SV 0.0335 0.00709 Inf 0.0222 0.0508 1 -16.062 tl;dr (readers may skip to the SOLUTION at the end of this post) Inference for the zero-inflated negative binomial on the response scale is difficult. Firstly, for the count component : ZINB2 $emmean / exp(summary(emm.ZINB2.count.lin, infer=TRUE)$ emmean) # compared to mean(dat$Total_heads) > summary(emm.ZINB2.count, infer=TRUE) Species emmean SE df asymp.LCL asymp.UCL z.ratio p.value SV 28.2 5.73 Inf 16.9 39.4 4.919 summary(emm.ZINB2.count.lin, infer=TRUE) Species emmean SE df asymp.LCL asymp.UCL z.ratio p.value SV -2.29 0.2019 Inf -2.68 -1.89 -11.337 summary(emm.ZINB2.count, infer=TRUE) $emmean / exp(summary(emm.ZINB2.count.lin, infer=TRUE)$ emmean) [1] 277.8002 275.2955 271.5769 271.2817 > mean(dat$Total_heads) [1] 257.6232 The zero component results are more satisfactory: # weights are NA becasue zero ~ Species only emm.ZINB2.zero summary(emm.ZINB2.zero, infer=TRUE) Species emmean SE df asymp.LCL asymp.UCL z.ratio p.value SV 0.6927 0.0638 Inf 0.5676 0.818 10.854 summary(emm.ZINB2.zero.lin, infer=TRUE) Species emmean SE df asymp.LCL asymp.UCL z.ratio p.value SV 0.813 0.300 Inf 0.225 1.400 2.711 0.0067 SL -1.432 0.306 Inf -2.032 -0.831 -4.674 The counts problem reappears for mode="response", which I think estimates the overall means : # again, what are these counts? emm.ZINB2 summary(emm.ZINB2, infer=TRUE) Species emmean SE df asymp.LCL asymp.UCL z.ratio p.value SV 8.66 1.97 Inf 4.80 12.52 4.396 It does seem that mode="response" does correctly mix zero and count components according to the formula mean = p*0 + (1 - p)*count.mean = (1 - p)*count.mean where p is from the zero component (probability scale) and count.mean is from the count component (count/rate scale): # from the count component offs $emmean / exp(summary(emm.ZINB2.count.lin, infer=TRUE)$ emmean) # are these rates? summary(emm.ZINB2, infer=TRUE) $emmean / offs (1-summary(emm.ZINB2.zero, infer=TRUE)$ emmean)*exp(summary(emm.ZINB2.count.lin, infer=TRUE)$emmean) > summary(emm.ZINB2, infer=TRUE) $emmean / offs [1] 0.03116506 0.23394104 0.05551120 0.01802210 > (1-summary(emm.ZINB2.zero, infer=TRUE)$ emmean)*exp(summary(emm.ZINB2.count.lin, infer=TRUE)$emmean) [1] 0.03116506 0.23394104 0.05551120 0.01802210 I would still like to be able to report pairwise comparisons for the overall mean on the response scale (rate scale = count divided by offset) similar to those results for the NB model above. How? SOLUTION based on Russell Lenth's advice From first principles (see the documentation for the emmeans package) and ignoring the weights complication: RG $Species), Location=unique(dat$ Location), Total_heads=mean(dat$Total_heads)) # reference grid RG preds Re-examining the count component for the zero-inflated model: # mean Species rates on the log scale, averaged across Location, for the count component only emm.ZINB2.count.lin Re-examining overall means for the zero-inflated model: # lin.pred does nothing for zeroinfl and mode="response" for which there are two link functions (log and logit) # mean Species counts, averaged across Location emm.ZINB2 Lesson learnt: emmeans parameters offset and lin.pred are not particularly meaningful for zero-inflated models with mode="response". Overall mean counts can be scaled as rates using the offset from mode="count". As commented in the documentation for the emmeans package, statistics is hard . Reference Blasco‐Moreno A., Pérez‐Casany M., Puig P., Morante M. & Castells E. (2019). What does a zero mean? Understanding false, random and structural zeros in ecology. Methods in Ecology and Evolution 10: 949–959. https://doi.org/10.1111/2041-210X.13185
