[site]: stackoverflow
[post_id]: 63304
[parent_id]: 63157
[tags]: 
If you're just looking for packet capture, libpcap is very popular. It's used in basic tools such as tcpdump and ethereal. As far as "hooking into the stack", unless you plan on fundamentally changing the way the way the networking is implemented (i.e. add your own layer or alter the behavior of TCP), your idea of using IPF for packet modification or intervention seems like the best bet. In Linux they have a specific redirection target for userspace modules, IPF probably has something similar or you could modify IPF to do something similar. If you are just interested in seeing the packets, then libpcap is the way to go. You can find it at: http://www.tcpdump.org/
