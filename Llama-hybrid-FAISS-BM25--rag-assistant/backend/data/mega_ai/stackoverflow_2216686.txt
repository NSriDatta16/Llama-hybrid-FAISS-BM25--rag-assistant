[site]: stackoverflow
[post_id]: 2216686
[parent_id]: 2216558
[tags]: 
Two right possibilities : Do that in Javascript. Using jQuery , for example, it's a matter of one line : $("h2").next().addClass("first") Use an HTML parser . Indeed, regexp are not a good tool to do what you want to do . Since loading a whole HTML parser for just this purpose is overkill, you'd really better be using Javascript. The wrong way Of course, in order to anwser the question, here is the best way I can't think of to make it happends with regexp. Though, I don't recommend it. preg_replace('#( \s* ]*)>#im', '$1 class="first">', ' Some header First paragraph of the post Second paragraph of the post '); What we do is: using preg_replace so we can use advanced regexp to replace the code; using "m" and "i" flag so the regexp does not bother about line break or case; using \s* to match the closing "h2" tags and all the spaces/line breaks after; using * ]* to match the "p" tag and its current attributs; using parenthesis to save that; using "$1" to replace to replace the matched string we the part we save; adding the class and closing the ">". The first draw back I can think of is that it doesn't handle the case where a class already exists. Of, and by the way, you have ... instead of ... . I don't know if it's a typo but I assumed it was. Replace in the regexp accordingly if it's not.
