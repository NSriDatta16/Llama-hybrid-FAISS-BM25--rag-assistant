[site]: crossvalidated
[post_id]: 430136
[parent_id]: 
[tags]: 
RandomizedSearchCV - worse accuracy than standard parameters

I am currently training a text classification model to infer product category (198 different ones) from product names. After evaluating a few models I have decided to stick with a Random Forest (reaching ~86% accuracy on the test set). After going through randomized search (hyperparams grid and setup below), model accuracy surprisingly decreased. I am not sure why this happens but it seems it is related to min_samples_split as it's the main change between the two parameter sets. Attaching both default and parameters resulting from RandomizedSearchCV() . Also, I've been forced to remove max_estimators hyperparam as it was getting the command insanely long to compute. n_estimators = [int(x) for x in np.linspace(start=1, stop=250, num=20)] max_features = ['auto', 'sqrt'] max_depth = [int(x) for x in np.linspace(10, 110, num = 11)] min_samples_split = [2, 5, 10] min_sample_leaf = [1, 2, 4] bootstrap = [True, False] param_grid = {'n_estimators': n_estimators, 'max_features': max_features, 'max_depth': max_depth, 'min_samples_split': min_samples_split, 'min_samples_leaf': min_sample_leaf, 'bootstrap': bootstrap} rf = ensemble.RandomForestClassifier() k = model_selection.StratifiedKFold(n_splits=5) rf_acc_cv_rand = RandomizedSearchCV(estimator= rf, param_distributions=param_grid, n_iter=50, cv = k, verbose=10, random_state=42, n_jobs=-1) rf_acc_cv_rand.fit(x_train_count, y_train) Default values (accuracy ~86%) >>> randomforest_norandsearch.get_params() {'bootstrap': True, 'class_weight': None, 'criterion': 'gini', 'max_depth': None, 'max_features': 'auto', 'max_leaf_nodes': None, 'min_impurity_decrease': 0.0, 'min_impurity_split': None, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'n_estimators': 10, 'n_jobs': None, 'oob_score': False, 'random_state': None, 'verbose': 0, 'warm_start': False} After randomised search (accuracy ~74%) >>> randomforest_rand.best_params_ {'n_estimators': 40, 'min_samples_split': 10, 'min_samples_leaf': 1, 'max_features': 'auto', 'max_depth': 110, 'bootstrap': False}
