[site]: stackoverflow
[post_id]: 3436890
[parent_id]: 3436822
[tags]: 
Your order of operations seems wrong. I think you want this: expandkey128(key); addroundkey(data,key,10); rev_shiftrows(data); rev_subbytes(data); for(int i = 9; i>= 1; i--) { addroundkey(data,key,i); rev_mixColumn(data); rev_shiftrows(data); rev_subbytes(data); } addroundkey(data,key,0); For more details, see my stick figure explanation of AES with its accompanying reference implementation. WARNING : As mentioned in Act 3, Scene 2 , there be dragons in writing your own AES implementation for production use.
