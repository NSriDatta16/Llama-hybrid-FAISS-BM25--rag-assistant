[site]: stackoverflow
[post_id]: 3876279
[parent_id]: 
[tags]: 
Display directory structure with size in Powershell

Trying to have "dir" command that displays size of the sub folders and files. After googling "powershell directory size", I found thew two useful links Determining the Size of a Folder http://technet.microsoft.com/en-us/library/ff730945.aspx PowerShell Script to Get a Directory Total Size PowerShell Script to Get a Directory Total Size These soultions are great, but I am looking for something resembles "dir" output, handy and simple and that I can use anywhere in the folder structure. So, I ended up doing this, Any suggestions to make it simple, elegant, efficient. Get-ChildItem | Format-Table -AutoSize Mode, LastWriteTime, Name, @{ Label="Length"; alignment="Left"; Expression={ if($_.PSIsContainer -eq $True) {(New-Object -com Scripting.FileSystemObject).GetFolder( $_.FullName).Size} else {$_.Length} } }; Thank you.
