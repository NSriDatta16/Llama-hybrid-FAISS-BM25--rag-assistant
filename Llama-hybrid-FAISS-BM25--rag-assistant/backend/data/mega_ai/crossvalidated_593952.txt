[site]: crossvalidated
[post_id]: 593952
[parent_id]: 
[tags]: 
Difference in Normalizing constants for Annealed Importance Sampling and Sequential Monte Carlo

I have been looking into Annealed Importance Sampling (AIS, Neal, 2001) and Sequential Monte Carlo (SMC, Del Moral et al., 2006) methods lately. I was wondering where the difference in estimating the normalization constant comes from. I will use the notation of Del Moral et al. (2006). Let $\pi_n(x) = \gamma_n(x) / Z_n$ be a target density, $\gamma_n$ be known point-wise and $Z_n$ be a normalization constant. We consider the geometric mean of a tractable distribution $p_0$ to the distribution $\pi$ as $$ \gamma_n(x) = p_0(x)^{1 - \beta_n}\pi(x)^{\beta_n}, $$ where $0 = \beta_0 . For SMC the weight $w_n(x_{1:n})$ is the product of the previous weight and incremental weight: $$ w_n(x_{1:n}) = w_{n-1}(x_{1:n-1})\tilde w_n(x_{n-1}, x_n), $$ where the incremental weight $\tilde w_n(x_{n-1}, x_n)$ is given as $$ \tilde w_n(x_{n-1}, x_n) = \frac{\gamma_n(x_n)L_{n-1}(x_{n-1} \mid x_n)}{\gamma_{n-1}(x_{n-1}) K_n(x_n \mid x_{n-1})}. $$ In the algorithm, we compute the weights $W_n^i$ corresponding to particles $X_n^i$ as follows. $$ W_n^i = \frac{W_{n-1}^i \tilde w_n(X_{n-1:n}^i)}{\sum_{j=1}^N W_{n-1}^j \tilde w(X_{n-1:n}^j)} $$ We are now interested in an estimate of the normalization constant $Z_K / Z_0$ which Del Moral et al. give as $$ Z_K / Z_0 = \prod_{n=1}^K \sum_{i=1}^N W_{n-1}^i \tilde w_n(X_{n-1:n}^i). $$ If we resample particles at each iteration, we set $W_{n}^I = N^{-1}$ . In this case, the estimate becomes $$ Z_K / Z_0 = \prod_{n=1}^K N^{-1} \sum_{i=1}^N \tilde w_n(X_{n-1:n}^i). $$ AIS fits into the SMC framework by leaving resampling aside and choosing the backward kernel as time-reversal of the forward kernel $$ L_{n-1}(x_{n-1} \mid x_n) = M_n(x_n \mid x_{n-1}) \frac{\gamma_n(x_{n-1})}{\gamma_{n}(x_n)}. $$ We get an incremental weight of $$ \tilde w_n(x_{n-1}, x_n) = \frac{\gamma_n(x_{n-1})}{\gamma_{n-1}(x_{n-1})}. $$ To finally get to my question, Neal writes that the normalizing constant $Z_K / Z_0$ (using the notation of Del Moral et al.) can be approximated by an average of the importance weight, i.e. $$ Z_K / Z_0 = N^{-1} \sum_{i=1}^N \prod_{n=1}^K \tilde w_n(X_{n-1:n}^i). $$ At the moment, I have problems understand this difference, as it seems like the two formulations should be equal. Secondly - maybe somewhat unrelated - do you know whether these approximations are lower or upper bounds to the quantity we are trying to estimate? Is there a difference between AIS and SMC? I am looking forward to hearing enlightening answers. Thank you very much in advance!
