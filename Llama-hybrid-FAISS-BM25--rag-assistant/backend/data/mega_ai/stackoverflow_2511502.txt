[site]: stackoverflow
[post_id]: 2511502
[parent_id]: 
[tags]: 
SQL Server "RESTORE FILELISTONLY" Resultset

I'm trying to write an automated backup and restore T-SQL scripts. I've done BACKUP part but I'm struggling on RESTORE. When I run following statement on SS Management Studio; EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''') I get a result set in a grid and also I can use INSERT INTO EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''') to populate a temp table. However I get syntax error, when I try to select from that resultset. e.g SELECT * FROM EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''') The resultset metadata should be stored somewhere in SQL Server Dictionary. I found other band-aid formula to get my automated restore working, but if can get to the resultset, I would create more elegant solution. Also please note that resultset is different in 2008 than 2005. Thanks in advance...
