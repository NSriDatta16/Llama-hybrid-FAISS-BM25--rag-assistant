[site]: crossvalidated
[post_id]: 482848
[parent_id]: 
[tags]: 
Fitting a VAR model with nonstationary data and possible cointegration

I have time series data from multiple realisations (trials) of the same process in the shape (n_trials, n_sensors, n_times) which I would like to fit a vector autoregressive model (VAR) to. However, the data is not stationary. My ultimate goal is to make the data stationary so that I can fit a VAR model to the data and perform Granger Causality analysis. This leads me to multiple questions. If I use first differencing the data becomes stationary but I don’t know if that is a valid approach since fitting VAR models upon first differencing may be inadequate for systems with cointegrated variables. I saw that the Johansen test for cointegration is implemented in the statsmodels package for python but the input has to be of shape (nobs_tot, neqs) and I have to provide k_ar_diff , the number lagged differences in the model. Question 1) How do I test for cointegration if I have multiple realisations (trials) of the same process? I assume that neqs corresponds to the number of simultaneously recorded time series and nobs_tot corresponds to n_times . That would lead me to the questions how I can use data from multiple trials? If I have to perform a test for every trial separately and every test gives me a set of cointegrating vectors (CV), how do I combine and interpret the results? If on the other hand nobs_tot = n_times * n_trials , do I simply concatenate the data from the trials? Wouldn’t the discontinuities negatively affect the test? Question 2) Is k_ar_diff equal to the model order of the VAR model I would like to fit? Usually I would determine the VAR model order using the Bayesian information criterion based on the covariance matrix of the residuals. But how do I do that if the time series are not (yet) stationary? Question 3) How do I proceed from here? If there is no significant cointegration present, I can simply use first differencing. But what if there are one or multiple CV? Is it possible to adjust the time series data using the CV to be able to fit the VAR model? IIRC it might be possible to construct the VAR model from the CV? Would that be the correct approach?
