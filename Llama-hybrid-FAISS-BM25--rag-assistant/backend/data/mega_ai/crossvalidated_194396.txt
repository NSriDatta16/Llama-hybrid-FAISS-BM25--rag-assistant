[site]: crossvalidated
[post_id]: 194396
[parent_id]: 
[tags]: 
lognormal distribution average and variance

I am trying to get acquainted with this type of distribution, and part of it is exploring what random number generation with scipy.stats produces. I have noticed that if I produce a normal distribution and then calculate average and std on the obtained array, the agreement with the imposed parameters is good already for a relatively small number of samples: import scipy.stats as st import numpy as np d3 = st.norm.rvs(1,0.2,size=1000) print(d3.mean()) print(d3.std()) 0.996408828534 0.205429513285 I am not sure I can say the same for a lognormal distribution: s = 1.2 d1 = st.lognorm.rvs(s, size=3000) d2 = st.lognorm.rvs(s, size=30000) d1.std()**2 9.3344792142262989 d2.std()**2 12.281877945365549 whereas from the definition ($\mu = \ln(scale) = 0$) (np.exp(s**2)-1)*np.exp(s**2) 13.593577362615642 ( Note : the parameter s is equivalent to $\sigma$ in scipy , link to very good description) I wonder why the variance appears to be so sensitive on the number of samples, and in general not very close to its theoretical value. Is it something peculiar to this kind of distribution and the way random numbers are generated, or am I missing something? EDIT : following a suggestion by @gung, running few tests iteratively confirms 'instability' of the variance, as explained by @hodgenovice: s = 1.2 for i in range(10): d1 = st.lognorm.rvs(s, size=3000) d2 = st.lognorm.rvs(s, size=30000) lgn_th_mean = np.exp(s**2/2) lgn_th_var = (np.exp(s**2)-1)*np.exp(s**2) print('d1 stats: mean = {:.3f}, var = {:.3f}, expected mean: {:.3f}, expected var: {:.3f}, mean of log: {:.3f}, var of log: {:.3f}'\ .format(d1.mean(),d1.std()**2,lgn_th_mean,lgn_th_var,np.log(d1).mean(),np.log(d1).std()**2)) print('d2 stats: mean = {:.3f}, var = {:.3f}, expected mean: {:.3f}, expected var: {:.3f}, mean of log: {:.3f}, var of log: {:.3f}'\ .format(d2.mean(),d2.std()**2,lgn_th_mean,lgn_th_var,np.log(d2).mean(),np.log(d2).std()**2)) d1 stats: mean = 2.001, var = 12.595, expected mean: 2.054, expected var: 13.594, mean of log: -0.048, var of log: 1.493 d2 stats: mean = 2.041, var = 11.798, expected mean: 2.054, expected var: 13.594, mean of log: 0.010, var of log: 1.419 d1 stats: mean = 1.912, var = 10.081, expected mean: 2.054, expected var: 13.594, mean of log: -0.037, var of log: 1.379 d2 stats: mean = 2.064, var = 13.583, expected mean: 2.054, expected var: 13.594, mean of log: 0.007, var of log: 1.431 d1 stats: mean = 2.125, var = 12.299, expected mean: 2.054, expected var: 13.594, mean of log: 0.014, var of log: 1.511 d2 stats: mean = 2.047, var = 12.364, expected mean: 2.054, expected var: 13.594, mean of log: 0.001, var of log: 1.443 d1 stats: mean = 2.057, var = 13.110, expected mean: 2.054, expected var: 13.594, mean of log: 0.016, var of log: 1.384 d2 stats: mean = 2.061, var = 20.173, expected mean: 2.054, expected var: 13.594, mean of log: -0.008, var of log: 1.443 d1 stats: mean = 2.129, var = 14.420, expected mean: 2.054, expected var: 13.594, mean of log: 0.038, var of log: 1.429 d2 stats: mean = 2.021, var = 11.572, expected mean: 2.054, expected var: 13.594, mean of log: -0.007, var of log: 1.435 d1 stats: mean = 2.046, var = 15.501, expected mean: 2.054, expected var: 13.594, mean of log: -0.002, var of log: 1.393 d2 stats: mean = 2.050, var = 14.722, expected mean: 2.054, expected var: 13.594, mean of log: -0.006, var of log: 1.444 d1 stats: mean = 2.069, var = 16.008, expected mean: 2.054, expected var: 13.594, mean of log: 0.011, var of log: 1.376 d2 stats: mean = 2.030, var = 19.172, expected mean: 2.054, expected var: 13.594, mean of log: -0.009, var of log: 1.430 d1 stats: mean = 1.966, var = 9.853, expected mean: 2.054, expected var: 13.594, mean of log: -0.009, var of log: 1.412 d2 stats: mean = 2.051, var = 13.964, expected mean: 2.054, expected var: 13.594, mean of log: -0.006, var of log: 1.447 d1 stats: mean = 2.070, var = 15.729, expected mean: 2.054, expected var: 13.594, mean of log: -0.022, var of log: 1.462 d2 stats: mean = 2.073, var = 13.725, expected mean: 2.054, expected var: 13.594, mean of log: 0.005, var of log: 1.447 d1 stats: mean = 2.050, var = 15.448, expected mean: 2.054, expected var: 13.594, mean of log: 0.003, var of log: 1.406 d2 stats: mean = 2.031, var = 12.177, expected mean: 2.054, expected var: 13.594, mean of log: -0.003, var of log: 1.432
