[site]: crossvalidated
[post_id]: 88085
[parent_id]: 
[tags]: 
Intuition behind Expected Value of conversion events

I'm trying to develop a high level model to value events in a marketing conversion funnel. To take a simple e-commerce example: You start with leads in the form of ad clicks. Some % of these ad clicks result in a conversion to an email address. We'll call this 1st step conversion. Of the users who submitted an email address, some % convert to a paying customer when they make a first transaction. We'll call this second step conversion. Using a probabilistic model, such as Pareto/NBD, we calculate the expected Lifetime Value of our customers, i.e. the expected economic value of only those users who have passed second step conversion by making a transaction. To model the conditional expectation of the economic value of an ad click, I posit the following formula: $$ P(first step conversion=1,|X)*P(second step conversion=1|X,first step conversion=1)*E(LTV|X, second step conversion=1) $$ Where $X$ is a feature vector describing attributes of the source/customer who made the ad click. Now, the tricky part is to train a model in 3 stages to reflect the above formula: Train logistic regression for 1st step conversion, using all leads as instances and feature vector as explanatory variables Train logistic regression for 2nd step conversion, using subset of data, i.e. training on only those instances that passed first step conversion, as well as feature vector as explanatory variables. Train probability model for Expected lifetime value, using only subset of data, i.e. training on only those instances that passed second step conversion. My thought is to integrate these three models by simply taking their product, as in the above formula. Does this intuition make sense, or am I making faulty assumptions in regards to conditional independence, etc.? I would really appreciate a sanity check, and I'd be happy to clarify further if anything is unclear.
