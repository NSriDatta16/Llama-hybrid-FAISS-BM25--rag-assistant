[site]: stackoverflow
[post_id]: 4477824
[parent_id]: 4477401
[tags]: 
The following will work: function makeBold() { var selection = window.getSelection(); if (selection.rangeCount) { var range = selection.getRangeAt(0).cloneRange(); var newNode = document.createElement("b"); range.surroundContents(newNode); selection.removeAllRanges(); selection.addRange(range); } } However, there are several issues to be aware of: Range's surroundContents() method will not work for every Range: it has to make sense within the DOM to surround the Range contents within a new node. For example, using surroundContents() on a Range that spans two paragraphs but doesn't fully select either will throw an error. See the DOM Level 2 Range spec for the formal definition of this. IE up to and including version 8 doesn't support DOM Range, and has a totally different Selection object to other browsers. IE 9 will have similar Range and Selection capabilities as other browsers. You need to check the selection's rangeCount property before proceeding, otherwise you'll get exception if there is no selection.
