[site]: stackoverflow
[post_id]: 3002630
[parent_id]: 3002459
[tags]: 
All this framework seems fine, so I'm not sure what your problem is (TRY/CATCH and re-throw errors if you have a lot of nested SPs). However , set-based approaches are preferred. If you could give more of your requirements, we could probably suggest something easier. Typically for polling type scenarios, I usually use an agent job which operates on the entire set of new rows (perhaps with a cursor), or you can assign them a batch number and start processing of that batch. When the next time the agent job triggers, only new rows with no batch will get assigned another batch which will go off and get processed. But without knowing more about your underlying motivation...
