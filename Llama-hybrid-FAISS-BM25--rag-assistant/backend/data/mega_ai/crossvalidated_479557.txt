[site]: crossvalidated
[post_id]: 479557
[parent_id]: 479553
[tags]: 
The 4.30 number is the expected log wage made as if everyone was a woman (setting female to 1 for everyone in your data). Let me show you how to calculate the marginal effect of a binary variable on $y$ from an etregress model of $\ln(y)$ . First we fit the same toy model from your previous question : . webuse nhanes2f, clear . qui svyset psuid [pweight=finalwgt], strata(stratid) . qui svy: etregress loglead i.female i.diabetes, treat(diabetes = weight age height i.female) // coefl Then we calculate the effect of female on lead in percent : . nlcom pct_eff:(100*(exp(_b[loglead:1.female])-1)) pct_eff: (100*(exp(_b[loglead:1.female])-1)) ------------------------------------------------------------------------------ | Coef. Std. Err. z P>|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- pct_eff | -30.64646 .7382346 -41.51 0.000 -32.09337 -29.19955 ------------------------------------------------------------------------------ This says that, on average, women have 30% less lead in their blood. This calculation is explained here . Note that we used the female coefficient in the formula. You can use the coefl option to see how Stata names them. Now we can calculate what that means in units of lead , rather than in percent. Here lead is measured in micrograms per deciliter. A microgram is one-millionth of a gram. A decilitre measures fluid volume and is 1/10 of a litre. The model implies women have 5 fewer micrograms of lead per deciliter of blood than men: . margins, expression(exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2)*_b[loglead:1.female]) Predictive margins Number of strata = 31 Number of obs = 4,940 Number of PSUs = 62 Population size = 56,316,764 Model VCE : Linearized Design df = 31 Expression : exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2)*_b[loglead:1.female] ------------------------------------------------------------------------------ | Delta-method | Margin Std. Err. t P>|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- _cons | -5.267688 .1543202 -34.13 0.000 -5.582426 -4.95295 ------------------------------------------------------------------------------ Since Stata thinks in terms of $\ln(\sigma)$ , I had to add an extra exponentiation step to get back $\sigma$ . The intuition for the formula is at the top of the answer here . How did I calculate this? Let's start by predicting lead as if everyone was a man and then as if everyone was a woman, keeping other covariates as they are: . margins, expression(exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2)) at(female = (0 1)) post Predictive margins Number of strata = 31 Number of obs = 4,940 Number of PSUs = 62 Population size = 56,316,764 Model VCE : Linearized Design df = 31 Expression : exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2) 1._at : female = 0 2._at : female = 1 ------------------------------------------------------------------------------ | Delta-method | Margin Std. Err. t P>|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- _at | 1 | 17.10827 .288379 59.33 0.000 16.52012 17.69642 2 | 11.86519 .240167 49.40 0.000 11.37537 12.35501 ------------------------------------------------------------------------------ This says that men are expected to have 17 micrograms per dL and women are expected to have ~12 micrograms per dL, on average. This is similar to what you did, but for lead (wages) rather than log of lead (log of wages). We can now calculate the difference between these two counterfactuals using contrast : . contrast r._at Contrasts of predictive margins Number of strata = 31 Number of obs = 4,940 Number of PSUs = 62 Population size = 56,316,764 Model VCE : Linearized Design df = 31 Expression : exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2) 1._at : female = 0 2._at : female = 1 ------------------------------------------------ | df F P>F -------------+---------------------------------- _at | 1 1195.29 0.0000 Design | 31 ------------------------------------------------ Note: F statistics are adjusted for the survey design. -------------------------------------------------------------- | Delta-method | Contrast Std. Err. [95% Conf. Interval] -------------+------------------------------------------------ _at | (2 vs 1) | -5.243079 .1516523 -5.552376 -4.933782 -------------------------------------------------------------- The difference between 17 and 12 is ~5. This matches what we had above directly. If we put that in percentage terms, that is $100 \cdot (-5.243079)/17.10827=-30.646459$ . Note that this matches the first calculation we made. It uses the male average since we are interested in the effect of female going from 0 to 1. If you want to do that in one step, you can do this: . qui svy: etregress loglead i.female i.diabetes, treat(diabetes = weight age height i.female) // coefl . margins r.female, expression(exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2)) Contrasts of predictive margins Number of strata = 31 Number of obs = 4,940 Number of PSUs = 62 Population size = 56,316,764 Model VCE : Linearized Design df = 31 Expression : exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2) ------------------------------------------------ | df F P>F -------------+---------------------------------- female | 1 1195.29 0.0000 Design | 31 ------------------------------------------------ Note: F statistics are adjusted for the survey design. -------------------------------------------------------------- | Delta-method | Contrast Std. Err. [95% Conf. Interval] -------------+------------------------------------------------ female | (1 vs 0) | -5.243079 .1516523 -5.552376 -4.933782 -------------------------------------------------------------- Here I had to fit the model again because I overwrote the estimation results when I used the post option so that I can use contrast on the predictions. Code: webuse nhanes2f, clear qui svyset psuid [pweight=finalwgt], strata(stratid) qui svy: etregress loglead i.female i.diabetes, treat(diabetes = weight age height i.female) // coefl nlcom pct_eff:(100*(exp(_b[loglead:1.female])-1)) margins, expression(exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2)*_b[loglead:1.female]) margins, expression(exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2)) at(female = (0 1)) post contrast r._at qui svy: etregress loglead i.female i.diabetes, treat(diabetes = weight age height i.female) // coefl margins r.female, expression(exp(predict(xb))*exp((exp(_b[/:lnsigma])^2)/2))
