[site]: crossvalidated
[post_id]: 525680
[parent_id]: 525674
[tags]: 
Several conceptual and R-coding errors: $\mu_0$ and $\sigma_0$ are hyper-parameters for the prior, hence should not be modified along iterations the conditionals in the Gibbs sampler are about the sampling model parameters $\mu$ and $\sigma$ which means updating mu=rnorm(... and sigma2=rinvgamma(... in the R code there was a factor 2 missing in n/2 in the shape of the rinvgamma call The term sum(X - mu0))^2 is doubly wrong as it should be sum((X - mu)^2) the power -1 is not correctly set in the standard deviation in the rnorm call, it should be (n/sigma2 + 1/sigma20)^(-1/2) the rinvgamma function in MCMCpack is parameterised in terms of scale and shape, not rate and shape, hence the second parameter is the inverse of what it should be: sigma2 = rinvgamma(1, n/2 + alpha, 1/(0.5*sum((X - mu)^2) + beta)) which is the principal reason for the diverging chain in the original version. The entire R code could thus be gibbs = function(N, v0, alpha, beta){ # parameters n = length(X) nxbar = sum(X) sigma2 = var(X) # hyperparameters mu0 = v0[1] sigma20 = v0[2] out = NULL for (i in 1:N){ mu = rnorm(1, mean = (nxbar/sigma2 + mu0/sigma20) / (n/sigma2) + (1/sigma20), sd = 1/sqrt(n/sigma2 + 1/sigma20)) sigma2 = rinvgamma(1, n/2 + alpha, 1/(sum((X - mu)^2)/2 + beta)) out = rbind(out, c(mu, sigma2)) # yuk!! } return(out)}
