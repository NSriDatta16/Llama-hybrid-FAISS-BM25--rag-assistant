[site]: crossvalidated
[post_id]: 460726
[parent_id]: 458337
[tags]: 
I am currently exploring the extent of this "aggregation problem" in my own work, for lack of a better term. One answer here suggests that you average the measurements in each modality. This is a form of aggregation and is an easily overlooked violation of assumptions, i.e. that the unobservable error terms of the model are IID, so I believe you are correct in being concerned with it. By averaging them, you are washing out the larger variance of the modality that has fewer measurements. You are also losing degrees of freedom/data points. It is better to include all measurements in the model to account for this difference in variance. One concern I am noticing is whether phantom size should be continuous or ordinal. The answer to the question is in intro statistics books. Does phantom size have a zero? Considering they are fat layers, then I would think no fat layers could be a choice, so yes. Is twice a phantom size of 1 equivalent to a phantom size of 2? You'll have to answer that, but as far as radii of fat go, the answer is yes. These two yeses indicate a continuous variable. You'd also have to determine what's more reasonable, whether, 1) the area spanned by the fat around the spine affects bone density, or 2) the fat's distance from the center of the spine affects bone density. 1) implies a squared function of radius, whereas 2) implies a linear function. It depends on your research question. If both are true then you can include the linear and squared phantom sizes. Note if the only reason the phantom sizes are ordinal is because you have five phantoms to choose from, this is not a justification for ordinality given your (assumed) research question. You'll simply need to get a ruler and measure the radius of fat from the center of the spine minus the radius of the vertebrum for each phantom. If this paragraph is entirely unreasonable and phantom size should be ordinal, (I really believe it isn't), then I'm wrong and no need to read further, since I assume continuous phantom size. Though if I'm right, at this point I'd suggest changing "phantom size" to "fat layer radius". Overall I agree with others that you can use a regression model. The response variable is bone density. Three indicator explanatory columns are used for each vertebrum, three more for modality, and one or two more for phantom size depending on if you include a squared term. Both 1) and 2) would be answered by including an interaction term of phantom size*modality (or two if squared term included). If you do not include the squared term, then you have a total of 3+3+1+3*1+3*1 = 13, or 3+3+2+3*2+3*2 = 20 terms if you include the squared term. If you can assume that the measurements from each vertebrum are IID (seems reasonable), then you don't need the 3 indicator variables for vertebra. That would reduce to 3+1+3*1 = 7, or 3+2+3*2 = 11 terms. You'll have to pick the appropriate model considering the IID vertebra question, linear vs squared question, and the number of data points you have. The rule of thumb I've learned is 10 to 1 data points to predictors. Fewer data points could still work depending on the effect size. Note the above does not require any non-parametric methods. Non-parametric methods should only be used if your residuals do not end up following a normal distribution. The other answers seem to give good code for generating the model, just make sure phantom size is continuous. I see no reason to perform partial f tests, though. Significant interaction terms in the full model suffice in answering your two (equivalent) questions.
