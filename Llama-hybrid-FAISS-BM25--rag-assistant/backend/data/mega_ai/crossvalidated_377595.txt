[site]: crossvalidated
[post_id]: 377595
[parent_id]: 
[tags]: 
How to train a stock trading neural network so that the 'profit' parameter is maximized?

I am watching some beginner level video training on neural networks using Tensorflow / Keras to get a better understanding of how they work and how to best implement them. I have some questions on how one feeds back signals to get the network to train itself. For example, lets say I am building a stock trading NN with I/O as follows: Inputs: The last say 20 daily prices, volumes, moving averages, MACD signals or other financial indicators Signals that I supply, indicating where I would buy and sell Output: A Buy signal and a Sell signal (or one signal that goes to 1 after buy and returns to 0 after sell) Ideally the network would learn how to output buy and sell signals such that the difference between the buy and sell signals, ie. profit, is maximized. For example when price is trending upward it would issue a buy, and when it starts to slope down a sell occurs. The optimized network would adjust itself to buy at the lowest point and sell at the highest point possible. My Question I am not clear how the 'profit' signal is used to train the system. The profit is independent of the input and output signals, it is a function of both, and it is calculable only after a sell. How do I go about telling the NN to optimize itself to maximize an arbitrarily calculated value? From my understanding this seems like an ideal application for NNs, Im just a bit unclear on how to proceed. Thanks for any advice. And if I may ask a second question, let's say I wanted to run my NN against multiple stocks, each with its own unique behaviours; eg. it might be especially volatile or its median price may be 100 times the first stock. In that case, would I create a whole new NN for each stock, or is it as simple as just adding a new input with a fixed constant for each different stock? StockA = 0.1 StockB = 0.2 StockC = 0.3 Would this cause training to apply a whole new set of weightings / biases for each stock?
