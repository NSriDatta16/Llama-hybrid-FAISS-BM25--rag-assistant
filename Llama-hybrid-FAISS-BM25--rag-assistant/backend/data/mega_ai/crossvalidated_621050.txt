[site]: crossvalidated
[post_id]: 621050
[parent_id]: 
[tags]: 
Calculate mean of density function (example using lognormal distribution)

In a lognormal distribution, the mean is equal to $\exp(\mu + \frac{\sigma^2}{2})$ . I tried to separately calculate this using the definition $E[X] = \int{xf(x)dx}$ , where I have 200 $x$ values evenly log-spaced; for reproducibility, here a few copy/paste ways to get such an array that captures the tails when $\mu=-0.5$ and $\sigma=0.6$ : in R: x in Python: x = np.logspace(start=np.log(0.001), stop=np.log(130), num=200, base=np.e) in Matlab: x = exp((linspace(log(.001), log(130), 200)))'; In Excel, I have the following steps based off the x-array defined above: Use the NORM.DIST function with x=ln(x), mean=-0.5, standard_dev=0.6, cumulative=FALSE to get the density function $f(x)$ Since the $f(x)dx$ term in the $E[X]$ integral is just the area, I calculate the area for each step using the trapezoidal rule: $area = \frac{f(x_i) + f(x_{i+1})}{2} \times (x_{i} - x_{i+1})$ Calculate weighted average using SUMPRODUCT function with array1=x, array2=area . #3 results in 0.735142709; but directly calculating it from the definition of mean for lognormal, the answer should be 0.726149037. I think this x-array is sufficiently dense for the answers to be closer. If fact, if you just treat the density column as a PMF instead of a PDF, you get the exact correct answer (i.e., =(SUMPRODUCT=array1=x, array2=area)/sum(array=density) ). What am I missing that is causing #3 to not give the exact answer, when I essentially have PMF here? (Note that when the area is computed in semi-log space--i.e., $area = \frac{f(x_i) + f(x_{i+1})}{2} \times (ln(x_{i}) - ln(x_{i+1}))$ -- it sums to unity; using this area in the integral doesn't work either). The overall motivation for this question is I am trying to calculate the mean for a distribution that doesn't have a closed-form solution. I tried this approach here as a proof-of-concept, expecting it to work, so I am trying to figure out what I am misunderstanding. Thank you for any help. Copy/paste for Excel: If you have the x-array in column A, then: ln(x) in column B =LN(A2) density in column C =NORM.DIST(B2,-0.5,0.6,FALSE) area[arith] in column D =(C2+C3)/2*(A3-A2) application of integral is =SUMPRODUCT(A2:A201,D2:D201) area[ln] in column E is =(C2+C3)/2*(B3-B2)
