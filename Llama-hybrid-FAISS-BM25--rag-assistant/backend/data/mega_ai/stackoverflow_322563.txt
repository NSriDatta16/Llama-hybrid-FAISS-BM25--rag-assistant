[site]: stackoverflow
[post_id]: 322563
[parent_id]: 86278
[tags]: 
I have a simpler way to go than Gilligan. It seems like a lot of work but it really isn't. My solution requires having my continuous form as a subform datasheet. On my subform I have two lookup comboboxes, among other fields, called Equipment and Manufacturer. Both simply hold a Long Integer key in the data source. Manufacturer needs to be filtered by what is selected in Equipment. The only time I filter Manufacturer.RowSource is in the Manufacturer_GotFocus event. Private Sub Manufacturer_GotFocus() If Nz(Me.Equipment, 0) > 0 Then Me.Manufacturer.RowSource = GetMfrSQL() '- gets filtered query based on Equipment Else Me.Manufacturer.RowSource = "SELECT MfgrID, MfgrName FROM tblManufacturers ORDER BY MfgrName" End If End Sub In Manufacturer_LostFocus I reset Manufacturer.RowSource to all Manufacturers as well. You need to do this because when you first click in the subform, GotFocus events fire for all controls, including Manufacturer, even though you are not actually updating any fields. Private Sub Manufacturer_LostFocus() Me.Manufacturer.RowSource = "SELECT MfgrID, MfgrName FROM tblManufacturers ORDER BY MfgrName" End Sub In the Enter event of Manufacturer you have to check if Equipment has been selected, if not set focus to Equipment. Private Sub Manufacturer_Enter() If Nz(Me.EquipmentID, 0) = 0 Then '-- Must select Equipment first, before selecting Manufacturer Me.Equipment.SetFocus End If End Sub You also need to requery the Manufacturer combobox in Form_Current event (i.e. Me.Manufacturer.Requery), and you should set the Cycle property of this subform to "Current Record". Seems simple enough, but you're not done yet. You also have to reset Manufacturer.RowSource to all Manufacturers in the SubForm_Exit event in the parent form in case the user goes to the Manufacturer combobox but does not make a selection and clicks somewhere on the parent form. Code sample (in parent form): Private Sub sFrmEquip_Exit(Cancel As Integer) Me.sFrmEquip.Controls("Manufacturer").RowSource = "SELECT MfgrID, MfgrName FROM tblManufacturers ORDER BY MfgrName" End Sub There is still one piece of this that is not clean. When you click on Manufacturer and have multiple rows in the datasheet grid, Manufacturer field will go blank in other rows (the data underneath the comboboxes is still intact) while you're changing the Manufacturer in the current row. Once you move off this field the text in the other Manufacturer fields will reappear.
