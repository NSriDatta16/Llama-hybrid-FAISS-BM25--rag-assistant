[site]: stackoverflow
[post_id]: 192960
[parent_id]: 
[tags]: 
TListBox Drag and Drop problems with MultiSelect enabled

I have a TListBox with multiselect and ExtendedSelect both set to true. I need to be able to drag multiple items in the list box to re-arrange them. My problem is what happens when the user clicks on an item that is already selected without holding down the CTRL or SHIFT key. Case 1: DragMode is set to dmManual The selection is cleared before the mouse down. This will not allow multiple items to be dragged. Case 2: DragMode is set to dmAutomatic The MouseDown event never fires. The selection is not cleared so dragging is OK, but the user cannot clear the selection by clicking on one of the selected items. This really causes a problem if all the items are selected or the next item the user wants to select was part of the current selection. Note that this problem only happens if you assign something to the DragObject in the OnStartDrag procedure. I think the problem would go away if OnStartDrag would only start after the user moves the mouse. I have Mouse.DragImmediate := false set but I still get the StartDrag fired as soon as I click on an item in the list box. I am using Delphi 7 for this project but I see the same behavior in Delphi 2007.
