[site]: stackoverflow
[post_id]: 3658213
[parent_id]: 3658026
[tags]: 
Assume: avgN = average amount for customer n currN = current (monthly) amount for customer n delta = tolerance expressed as a decimal (.25 in your example) Then the formula =abs((currN - avgN) / avgN) will return the percentage difference between this month's amount and the average. If you want to test whether this exceeds the tolerance (delta) use the expression above as the first argument to the if worksheet function, e.g. =if(abs((currN - avgN) / avgN) > delta, "tolerance exceeded", "within tolerance") It's not clear from your question whether you want to do this in VBA code, or in a worksheet function. If the former, then you'll need something like this Sub checkTolerance() Dim percentageChange As Double Dim currN As Double Dim avgN As Double Dim delta As Double ' Set the values of the variables above from somewhere (worksheet cell, user input, etc.) percentageChange = Abs((currN - avgN) / avgN) If percentageChange > delta Then ' Do something when tolerance is exceeded MsgBox "tolerance exceeded" Else ' Do something when amount is within tolerance MsgBox "within tolerance" End If End Sub
