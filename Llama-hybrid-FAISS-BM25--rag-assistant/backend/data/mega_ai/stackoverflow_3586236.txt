[site]: stackoverflow
[post_id]: 3586236
[parent_id]: 3586195
[tags]: 
The problem is clear: you are compiling CRT and MFC code together. When you use the MFC libraries, you must make sure that they are linked before the CRT library is linked. You can do this by making sure that every file in your project includes Msdev\Mfc\Include\Afx.h first, either directly (#include ) or indirectly (#include ). The Afx.h include file forces the correct order of the libraries, by using the directive: #pragma comment (lib," ") Microsoft has an article (link now gone, but check here ) describing this problem and suggests 2 solutions step-by-step ( the following steps are based on Visual C++ 6.0 ): Solution One: Force Linker to Link Libraries in Correct Order On the Project menu, click Settings. In the Settings For view of the Project Settings dialog box, click to select the project configuration that is getting the link errors. On the Link tab, click to select Input in the Category combo box. In the Ignore libraries box, insert the library names (for example, Nafxcwd.lib;Libcmtd.lib). Note : The linker command-line equivalent in /NOD: . In the Object/library modules (VS2008: Properties->Configuration Properties->Linker->Input->Additional Dependencies ï¼‰box, insert the library names. You must make sure that these are listed in order and as the first two libraries in the line (for example, Nafxcwd.lib Libcmtd.lib). Solution Two: Locate and Correct the Problem Module To view the current library link order, follow these steps: On the Project menu, click Settings. In the Settings For view of the Project Settings dialog box, click to select the project configuration that is getting the link errors. On the Link tab, type /verbose:lib in the Project Options box. Rebuild your project. The libraries will be listed in the output window during the linking process.
