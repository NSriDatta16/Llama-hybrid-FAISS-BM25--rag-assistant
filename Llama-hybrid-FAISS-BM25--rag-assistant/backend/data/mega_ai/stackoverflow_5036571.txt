[site]: stackoverflow
[post_id]: 5036571
[parent_id]: 5036325
[tags]: 
I'm not sure if it's more elegant, but here's a different query that does the same. WITH myTables AS ( SELECT ID, NAME, 'Table1' AS SOURCE FROM Table1 UNION ALL SELECT ID, NAME, 'Table2' AS SOURCE FROM Table2 ) INSERT INTO @vars(field1, field2, field3, field4, field5) SELECT MAX(CASE WHEN source = 'Table1' AND id = 1 THEN NAME END) AS field1, MAX(CASE WHEN source = 'Table1' AND id = 25 THEN NAME END) AS field2, MAX(CASE WHEN source = 'Table2' AND id = 12 THEN NAME END) AS field3, MAX(CASE WHEN source = 'Table2' AND id = 25 THEN NAME END) AS field4, MAX(CASE WHEN source = 'Table2' AND id = 14 THEN NAME END) AS field5 FROM myTables WHERE SOURCE = ('Table1' AND ID IN (1, 25)) OR (SOURCE = 'Table2' AND ID IN (12, 25, 14)) ; It uses a common table expression (CTE) to create a union of the two tables. It also pivots the data using the MAX aggregation. You can also do this with the PIVOT operator.
