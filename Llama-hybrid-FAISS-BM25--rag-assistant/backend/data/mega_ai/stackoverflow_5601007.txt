[site]: stackoverflow
[post_id]: 5601007
[parent_id]: 
[tags]: 
How do I use Perl and Regular Expressions to convert a SQL document to ColdFusion script?

I need to convert a document of SQL statements to a ColdFusion document. I only have a little experience with Regular Expressions and I am Perl super-newb (I just taught myself the basics of it yesterday so I could accomplish this task). I am attempting to match and replace a pattern with a script written in Perl, saved as a Filter in BBEdit, that I am running on an open document. The good news is that it mostly works, but the bad news is that it doesn't completely work. I am pretty sure it has to do with my limited understanding of matching across multiple lines and parsing the entire document in paragraphs. I am given a SQL document that looks something like this (most statements are on their own line (i.e. paragraph) but not all): DELETE FROM example_db.example_tbl; INSERT INTO example_db.example_tbl ( example_id, example_name ) ( SELECT example_id, example_name FROM example_2_db.example_tbl ORDER BY example_id ); INSERT INTO example_db.example_tbl (SELECT * FROM example_2_db.example_tbl ORDER BY example_id); UPDATE example_db.example_tbl, example_2_db.example_sub_types_tbl, example_2_db.example_tbl SET example_db.example_tbl.example_sub_type_label=example_2_db.example_sub_types_tbl.example_sub_type_label WHERE example_2_db.example_sub_types_tbl.example_sub_type_id = example_2_db.example_tbl.example_sub_type_id AND example_2_db.example_tbl.example_id=example_db.example_tbl.example_id; UPDATE example_db.example_tbl, example_2_db.example_tbl SET example_db.example_tbl.example_status_label='Example' WHERE example_2_db.example_tbl.example_status='1' AND example_2_db.example_tbl.example_id=example_db.example_tbl.example_id; UPDATE example_db.example_tbl, example_2_db.example_tbl SET example_db.example_tbl.example_status_label='Example' WHERE example_2_db.example_tbl.example_status='1' AND example_2_db.example_tbl.example_id=example_db.example_tbl.example_id; UPDATE example_db.example_tbl, example_2_db.example_tbl SET example_db.example_tbl.example_status_label='Example' WHERE example_2_db.example_tbl.example_status='2' AND example_2_db.example_tbl.example_id=example_db.example_tbl.example_id; UPDATE example_db.example_tbl, example_2_db.example_tbl SET example_db.example_tbl.example_status_label='Example' WHERE example_2_db.example_tbl.example_status='3' AND example_2_db.example_tbl.example_id=example_db.example_tbl.example_id; I need to wrap each separate sql statement in code to transform the page into a ColdFusion document. I had never used Perl before yesterday but it seemed ideal for this task. For the most part I have it working but I am running into an issue. This is the Perl script I am running on the document (I have simplified the replacement string just for the sake of this question): #!/usr/bin/perl -w use strict; use warnings; my $num = 0; $/ = ''; while (<>) { s/(INSERT[\s\S]*?;|DELETE[\s\S]*?;|UPDATE[\s\S]*?;|SELECT[\s\S]*?;)/' ' . $1 . " --->\r"/e; print; } __END__ This works for almost all of the statements in the documents that are separated by an extra line (\r). The ones where there is not an extra line between them are not replaced as expected. Note the three update statements above - it works on the first of the three but not on the remain two.) I am guessing this is related to my pattern and the use of $/='';, which I think causes the script to read in paragraphs as opposed to lines. I know there are many ways to approach this task, but this is what has gotten me the closest. I pieced it together from examples on the web and some trial and error. I know this must be simple to a non-newb, but alas I need some pointers. Can any one help me get this to work completely?
