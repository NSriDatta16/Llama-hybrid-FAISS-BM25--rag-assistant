[site]: stackoverflow
[post_id]: 3268865
[parent_id]: 
[tags]: 
Return value indicating update success/failure of SQL Server stored procedure via ADO/VBA

I have a SQL Server 2008 stored procedure that updates values in a table. I would like to have the stored procedure return an integer value indicating that the update was successful (return 0) or not (returns error number). What would be the best way to accomplish this via ADO and VBA? Here some of my code in simplified form that performs the update ... I am just not sure how to get back the return value of the stored procedure Public Function DoUpdate(employeeID as integer, firstName as string, lastname as string) as integer Dim cnn As ADODB.Connection Dim cmd As ADODB.Command Dim activeConnectionString As String activeConnectionString = GetActiveConnectionString() Set cnn = New ADODB.Connection cnn.ConnectionString = activeConnectionString cnn.CursorLocation = adUseClient cnn.Open Set cmd = New ADODB.Command cmd.ActiveConnection = cnn cmd.CommandType = adCmdStoredProc cmd.CommandText = "uspUpdateEmployeeName" cmd.NamedParameters = True cmd.Parameters("@EmployeeID").Value = employeeID cmd.Parameters("@FirstName").Value = firstName cmd.Parameters("@LastName").Value = lastName cmd.Execute 'Unsure of how to get back return value here 'DoUpdate = returnValue Set cnn = Nothing End Function
