[site]: stackoverflow
[post_id]: 5644308
[parent_id]: 3876407
[tags]: 
Answer : Most parse the file format directly and manually. There is another possible way : Using the RegSaveKey and then the RegReplaceKey functions, which are used by the Windows Backup utility. How do they prevent crashes in a live OS? Simple, they reroute API calls to the Windows Reg* functions and handle them themselves. Caching any changes that need to be written later. It would also be wise to hold an exclusive lock on the hive files. I trust defragmenters MUCH more than I trust optimizers . Registry Optimizers can set untested or broken keys and enable broken features. With the mass commercialization of them, this is less of a problem. But still, with what I've seen in the past I don't trust them mucking my stable system up in ways that are too hard to pin down.
