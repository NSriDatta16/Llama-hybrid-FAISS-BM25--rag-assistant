[site]: crossvalidated
[post_id]: 213819
[parent_id]: 
[tags]: 
Any good working method for sampling from estimated distribution in R

Suppose I have a number of points $\{x_i\}_{i=1}^N$ and I want to estimate the smooth distribution and sample from it. I have tried at the moment a lot of things, and all of them show poor performance. I just want to get the function for one and two-dimensional data, for which the histogram looks like the estimated distribution and doesn't give weird results. Please, can anyone help me to construct a working method, that allows me to create continuous distribution in $\mathbb{R}$ from arbitrary number of points $\{x_i\}_{i=1}^N$ in 1-D and 2-D and then sample from it? What I did: I've got good results (long story) with ks package + Metropolis algorithm from mcmc , but unfortunately it crashes my R . Using density from stats with approxfun to approximate the pdf: library(MASS) density_generator Then using Metropolis-Hastings algorithm from mcmc : library(mcmc) sample_element The result is poor: Use of brute force with inverse CDF works awful, integration often gives weird results #### Brute force sampling using inverse cdf cdf The better way is to use kernel smooth cdf from another package, it sometimes works, and sometimes gives weird results: s
