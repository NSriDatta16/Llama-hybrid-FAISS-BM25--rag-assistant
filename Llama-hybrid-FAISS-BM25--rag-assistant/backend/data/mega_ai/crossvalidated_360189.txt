[site]: crossvalidated
[post_id]: 360189
[parent_id]: 
[tags]: 
Which weighting to use for regression analyses at different levels of aggregation

I run a study with subjects in 400 groups of heterogeneous sizes ranging from 2 to 20 individuals. I have outcome data at the group level and at the individual level. Treatment was randomly assigned at the group level and my main interest is the average treatment effect on a group-level outcome. Groups are ``natural'' groups, i.e., unobservable might be correlated with group-size. Problem : When I run individual-level regressions (to supplement my group-level analyses), subjects from larger groups mechanically make up a larger fraction of the sample, i.e., they are overrepresented in the estimation. Idea : It seems appropriate to use weighted OLS to make sure that observations from each group weights the same total, and that results from the group-level regressions and the individual-level regressions are comparable. My idea is to use the inverse group-size as weights in the OLS, so that weights sum up to 1 for each group. For those, used to using Stata. For the group-level data (~400 observations), I run reg y_group treatment and for the individual-level data (~400*10=4,000 observations): bys group_id: inverse_groupsize = 1/_N reg y_indiv treatment [pweight=inverse_groupsize], cluster(group_id) Question : Does this make sense conceptually or is there anything I need to worry about? Are pweight s the right way to do this in Stata? P.S: I cross-posted that question on Statalist.org
