[site]: stackoverflow
[post_id]: 5533348
[parent_id]: 
[tags]: 
Why am I getting an UnauthorizedAccessException when trying to write a file to LocalStorage in Azure

I have created a local storage in my web role called "MyTestCache" as so in my ServiceDefinition.csdef file. But when ever I call the System.IO.File.WriteAllBytes method I get a UnauthorizedAccess exception. Does anyone know what would be causing this? I dont get this when creating the directory in the code below, only when writing. I am using SDK 1.3. private void SaveFileToLocalStorage(byte[] remoteFile, string filePath) { try { LocalResource myIO = RoleEnvironment.GetLocalResource("MyTestCache"); // Creates directory if it doesn't exist (ie the first time) if (!Directory.Exists(myIO.RootPath + "/thumbnails")) { Directory.CreateDirectory(myIO.RootPath + "/thumbnails"); } string PathToFile = Path.Combine(myIO.RootPath + "/thumbnails", filePath); var path = filePath.Split(Char.Parse("/")); // Creates the directory for the content item (GUID) if (!Directory.Exists(Path.Combine(myIO.RootPath + "/thumbnails", path[0]))) { Directory.CreateDirectory(Path.Combine(myIO.RootPath + "/thumbnails", path[0])); } // Writes the file to local storage. File.WriteAllBytes(PathToFile, remoteFile); } catch (Exception ex) { // do some exception handling return; } }
