[site]: stackoverflow
[post_id]: 4138173
[parent_id]: 4138071
[tags]: 
You could create a serializable class ProcessInfo that stores the process ID and any other information you want to associate with the process. When the agent shuts down (such as if the service stops, or when it gets disposed, or a closing event gets fired, etc) have it serialize the process info to a file. When it starts up again, it should check for and read in the process info file, which will essentially restore the agent to the state it was in just before it was shut down. The main idea here is that the agent should be maintaining this information, not Windows or the individual processes that are running. Requesting auxiliary data from a process requires COM, WCF, or some other messaging service, and this is overkill for the kind of interaction you're talking about. See the System.Runtime.Serialization namespace , particularly the DataContractSerializer class .
