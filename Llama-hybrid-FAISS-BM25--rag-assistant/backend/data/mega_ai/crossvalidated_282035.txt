[site]: crossvalidated
[post_id]: 282035
[parent_id]: 
[tags]: 
MATLAB implementation of MLE for Logistic Regression

The following is an assignment . The matrix $\mathbf{x}$ containing the external factors has dimension $4\times1000$, and the vector $\mathbf{y}$ containing the categorical variable has dimension $1\times1000$. I have to fit a GLM model of the type $$ \pi(t) = \frac{1}{1 + exp{\left(\beta_0 + \sum_{l=1}^m \beta_l u_t^l\right)}}, $$ where $u_t^l$ is the $l$th external factor at time $t$. The likelihood function I came up with is the following: $$ L(\beta) = -\sum_{i=1}^N \left[ y_i \log \left( \frac{1}{1+\exp(-\beta^T\mathbf{x}_i)} \right) +\\ (1-y_i)\log \left( 1 - \frac{1}{1+\exp(-\beta^T\mathbf{x}_i)} \right) \right] .$$ In order to maximize it, I computed the gradient: $$ \nabla_{\beta} L = \sum_{i=1}^N \left( y_i - \frac{1}{1+\exp(-\beta^T\mathbf{x}_i)} \right)\mathbf{x}_i ,$$ and the updating expression is: $$ \beta = \beta + \nabla_{\beta} L .$$ I want to implement it in MATLAB and for doing so I would like to first transform this last expression in matrix form: $$ \beta = \beta + \left( \mathbf{y} - \frac{1}{1+\exp(-\beta^T\mathbf{x})} \right)\mathbf{x} .$$ I've been trying for hours now but the result is not correct (too many $1$s or $0$s according to the initial values). Here's the question: can somebody explain what the dimensions of the different elements for the matrix form should be?
