[site]: stackoverflow
[post_id]: 1323867
[parent_id]: 1323797
[tags]: 
Marshalling anything but a very basic string is complex and full of side cases that are hard to spot. It's usually best to go with the safe / simple route in the struct definition and add some wrapper properties to tidy things up a bit. In this case I would go with the array of IntPtr and then add a wrapper property that converts them to strings [StructLayout(LayoutKind.Sequential)] public struct UnmanagedStruct { [MarshalAs(UnmanagedType.LPArray, ArraySubType=UnmanagedType.LPStr, SizeConst=100)] public IntPtr[] listOfStrings; public IEnumerable Strings { get { return listOfStrings.Select(x =>Marshal.PtrToStringAnsi(x)); } }
