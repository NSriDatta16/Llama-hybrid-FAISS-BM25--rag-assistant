[site]: crossvalidated
[post_id]: 462096
[parent_id]: 461830
[tags]: 
I cannot quite relate your code to your problem statement. When I print your GG matrix I get: > matrix(c(1,0,0,0,0,0,0, 0,1,0,0,0,0,0, 0,0,1,0,0,0,0, 0,0,0,1,0,0,0, 0,0,0,0,1,0,0, 0,0,0,0,0,1,0, 0,0,1,0,0,0,1), nr = 7) [,1] [,2] [,3] [,4] [,5] [,6] [,7] [1,] 1 0 0 0 0 0 0 [2,] 0 1 0 0 0 0 0 [3,] 0 0 1 0 0 0 1 [4,] 0 0 0 1 0 0 0 [5,] 0 0 0 0 1 0 0 [6,] 0 0 0 0 0 1 0 [7,] 0 0 0 0 0 0 1 It looks like $\mu_t$ is in the third position of the state vector and $\Delta\mu_t$ in the seventh, but why there is a $-1$ in the third position in FF rather than a 1? It wouldn't matter (a change of sign in the latent process), but make me fear that I am misunderstanding something. You set only two variances in V and W , but make no provision to ensure that they are non-negativa an remain so along the maximum likelihood estimation: try to replace by something like exp(alpha[1]) or alpha[2]^2 (and modify the initial values accordingly). Don't you say that you have five unknown parameters (other than the variances of the noises that I gather are alpha[1] and alpha[2] )? If you want to estimate these parameters --which you need to in order to run your filter-- you should replace them in the proper places inside function dlmmodel2 . If you intend these five parameters to be the five elements of the state vector not already taken by $\mu_t$ and $\Delta\mu_t$ , you should initialize them properly: it seems that you are giving them initial value 1 (in m0 ) and variance 0 (in C0 ). Is that what you intend? How were the non-zero elements in C0 chosen? I seem to recall that I have had some trouble passing time series to some function in dlm . Try to pass plain matrices.
