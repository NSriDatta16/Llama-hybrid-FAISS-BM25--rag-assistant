[site]: stackoverflow
[post_id]: 682536
[parent_id]: 
[tags]: 
Trouble programmatically adding CSS to IE

I have a bookmarklet which inserts a CSS stylesheet into the target DOM via a "link" tag (external stylesheet). Recently, this stopped working on Amazon.com, in Internet Explorer only. It works on other sites, and with other browsers (even on Amazon.com). The technique we're using to insert the stylesheet is pretty straightforward: document.getElementsByTagName('head')[0].appendChild(s); Where "s" is a link object created with document.createElement . Even on Amazon, I see via the Internet Explorer Developer Toolbar DOM inspector that the element is there. However if I alert the document.styleSheets collection in JavaScript, it's not there. As a test, I tried to use the IE-only document.createStyleSheet method passing the URL to my stylesheet as an argument. This throws the error: Not enough storage is available to complete this operation Points of interest: The documentation for document.createStyleSheet says an error will be thrown if there are more than 31 stylesheets on the page but (1) it's a different error, and (2) there are only 10 external stylesheets on the page. My googling for the error turned up a number of dead-ends, and the only one that suggested anything stylesheet-related was this drupal post , but it refers to a character limit on inline styles, as opposed to a problem relating to external styles. The same code, even the createStyleSheet call, works on other sites in IE. This has reached "complete mystery" status for me.
