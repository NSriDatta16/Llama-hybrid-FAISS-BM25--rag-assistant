[site]: stackoverflow
[post_id]: 197683
[parent_id]: 76967
[tags]: 
This is (hopefully) a one-off exercise, so an inelegant solution might not be as bad as it sounds. The problem (as, I'm sure you're only too aware!) is that at some point in your query you've got to list all those columns. :( The question is, what is the most elegant way to do this? Below is my attempt. It looks unwieldy because there are so many columns, but it might be what you're after, or at least it might point you in the right direction. Possible SQL Solution: /* if you have N countries */ CREATE TABLE Country (id int, name varchar(50)) INSERT Country SELECT 1, 'Afghanistan' UNION SELECT 2, 'Albania', UNION SELECT 3, 'Algeria' , UNION SELECT 4, 'American Samoa' , UNION SELECT 5, 'Andorra' , UNION SELECT 6, 'Angola' , ... UNION SELECT N-3, 'Western Sahara', UNION SELECT N-2, 'Yemen', UNION SELECT N-1, 'Zambia', UNION SELECT N, 'Zimbabwe', CREATE TABLE #tmp (key varchar(N), country_id int) /* "key" field needs to be as long as N */ INSERT #tmp SELECT '1________ ... _', 'Afghanistan' /* '1' followed by underscores to make the length = N */ UNION SELECT '_1_______ ... ___', 'Albania' UNION SELECT '__1______ ... ___', 'Algeria' ... UNION SELECT '________ ... _1_', 'Zambia' UNION SELECT '________ ... __1', 'Zimbabwe' CREATE TABLE new_table (country_id int, species_id int) INSERT new_table SELECT species.id, country_id FROM species s , #tmp t WHERE isnull( s.Afghanistan, ' ' ) + isnull( s.Albania, ' ' ) + ... + isnull( s.Zambia, ' ' ) + isnull( s.Zimbabwe, ' ' ) like t.key My Suggestion Personally, I would not do this. I would do a quick and dirty solution like the one to which you allude, except that I would hard-code the country ids (because you're only going to do this once, right? And you can do it right after you create the country table, so you know what all the IDs are): INSERT new_table SELECT Species.ID, 1 FROM Species WHERE Species.Afghanistan = 1 INSERT new_table SELECT Species.ID, 2 FROM Species WHERE Species.Albania= 1 ... INSERT new_table SELECT Species.ID, 999 FROM Species WHERE Species.Zambia= 1 INSERT new_table SELECT Species.ID, 1000 FROM Species WHERE Species.Zimbabwe= 1
