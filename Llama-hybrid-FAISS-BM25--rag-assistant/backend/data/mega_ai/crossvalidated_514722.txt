[site]: crossvalidated
[post_id]: 514722
[parent_id]: 
[tags]: 
How to find weighted rolling mean?

I have a dataset where I want to calculate the moving average of the count variable by investigator: I used the following code for the average means: data_ % dplyr::arrange(desc(investigator)) %>% dplyr::group_by(investigator) %>% dplyr::mutate(count_07da = zoo::rollmean(count, k = 7, fill = NA)) %>% dplyr::ungroup() However, each investigator interviewed multiple participants every day. We can calculate the mean value for every investigator each day, and then calculate the 7-day moving averages. However, the number of participants that interviewed varied in different days for each investigators, so it may not be accurate based on the daily means. The correct results should be weighted by the number of participants interviewed every day for each investigator. How should this be handled?
