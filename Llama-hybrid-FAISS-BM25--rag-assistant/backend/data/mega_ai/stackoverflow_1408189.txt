[site]: stackoverflow
[post_id]: 1408189
[parent_id]: 1406995
[tags]: 
Avoid C-style! It's not what C++ is designed for. I'd like to emphasize clarity and readability. #include #include #include #include #include #include using namespace std; using namespace boost::assign; struct mystruct { mystruct(float a, float b) : a(a), b(b) { } float a; float b; }; vector v = list_of ( mystruct(1, 1) ) (1, 2) (2, 1) (1, 3) (2, 2); ostream& operator const& v) { copy(v.begin(), v.end(), ostream_iterator (out, " ")); return out; } struct average_b { map sum; map count; float operator[] (float a) const { return sum.find(a)->second / count.find(a)->second; } }; average_b operator+ ( average_b const& average, mystruct const& s) { average_b result( average ); result.sum[s.a] += s.b; ++result.count[s.a]; return result; } struct set_b_to_average { set_b_to_average(average_b const& average) : average(average) { } mystruct operator()(mystruct const& s) const { return mystruct(s.a, average[s.a]); } average_b const& average; }; int main() { cout
