[site]: stackoverflow
[post_id]: 5259885
[parent_id]: 5258949
[tags]: 
You are kind of stuffed here - at least in terms of processing this in a proper set based sort of style as the necessary hierarchy information isn't encoded in the input data. What you have here is a sequential file structure encoded with XML style markup, this in turn suggest you're possibly better off just rolling through a loop unless that has significant performance issues. Its a bit clunky in that the loop would contain a switch or similar that would trigger creation of a new driverContacts when you hit an index element and would otherwise map from the source element to the required equivalent target element (in the current new contact). Elegant this won't be - but its straightforward to implement, its reasonably easy to understand and it will work to solve the problem - which is applying structure to data that isn't currently structured in a manner that will allow you to take advantage of the tools you have.
