[site]: crossvalidated
[post_id]: 359834
[parent_id]: 
[tags]: 
Fitting regime switching model to binary time series

I have a binary time series $X_t$ that I'd like to fit. It clearly has long memory effects (high Hurst exponent), and I believe that it is generated by a Bernoulli process where the probability shifts in discrete jumps: $$ U_t = \left\{ \begin{array}{ll} U_{t-1} \text{ w.p. } p \\ N(0, \sigma) \text{ w.p. } 1-p \\ \end{array} \right. \\ X_t = Bernoulli(Probit(U_t)) $$ What is a good way to fit $\sigma$ and $p$ to my data? I thought I could use MCMC with something like Stan, but I don't see a way to model the switching behavior of the latent variable $U_t$.
