[site]: crossvalidated
[post_id]: 624400
[parent_id]: 
[tags]: 
Autocorrelation and other problems modeling pupillometry with bam() from mgcv

TLDR: Model shows autocorrelation and non-normality in the residual plots even after AR1 and attempting to control for autocorrelation in parameters; I have a non-continuous time variable (it makes evenly spaced jumps) and I am not sure if I modeled that correctly; any advice? I am working on a project where I want to use the function bam() from the package "mgcv" to model the how the pupils of ~40 participants change-from-baseline over the course of 8 minutes. Before I include my psychological variables relating to my hypotheses in the model, I want to have the best fit possible with the covariates (gaze position, time, random variance between participants) and the main predictor variables ("Rates" and sexual orientation). So far, my model has a questionable fit with an R-squared of .68 and gam.check() shows that its breaking the assumptions of normality in the QQ and residual plots. My model includes an AR1 as well, which did improve the residuals significantly compared to not including an AR1 but it didn't completely take care of the problem. Below is my model and some information about each variable: model The variable “subtracted” is the relative change-from-baseline pupil size of each Subject over the course of 50 5-second long Trials. It contains negative values that are very small and many 0's. The variable “Rates” is the numeric rating each Subject assigned each of the 50 visual stimuli that were presented one by one for all of the 50 Trials. It is a number ranging from 1 - 9. Below I go into some detail about the time variable. “TotalTime” is a numerical variable that documents the time course in the data set. It consists of 5-second sections that are not continuous with each other. Every 5 seconds, there is a 5-second gap between values. For example, the dataset starts around the 5 second mark chronologically. TotalTime continues until it reaches the 10 second mark, then the next value in TotalTime after it reaches 10 seconds is 15 seconds. It would then continue evenly until the 20 second mark, and then the value in TotalTime becomes 25 seconds, and continues from there in that pattern. This is because the relevant data from the eye tracker is collected every 5 seconds during the experimental Trials. In between the experimental Trials are 5 seconds of the intertrial interval, where no data from this time period needs to be analyzed. Because these are intervals between the experimental Trials, the value for Rates in these rows had to be set to NA. Removing the NA values in the dataset resulted in removing the rows corresponding to these intertrial intervals, which caused gaps in the temporal order of the TotalTime variable. In order to account for these gaps, I modeled TotalTime as an interaction effect with Trial with factor smooths. By doing this, I am attempting to account for the fact that TotalTime is non-continuous by telling it to depend on what Trial it is on, because Trial separates meaningful temporal sections of the dataset. Is this an appropriate way to account for the jumps in my time variable? The variables “X_Gaze” and “Y_Gaze” are the coordinates for Subjects’ gaze position on the screen. The variable “SexualOrientation” is a categorical factor describing each Subjects’ sexual orientation. The variable “Event” represents each unique combination of Subject and Trial. By including it as an interaction with TotalTime, I am attempting to let the model know that the values are not independent by incorporating a smooth for each unique time series (each unique combination of Subject and Trial). According to van Rij (2018), this can help reduce autocorrelation. Below is a Google Doc where I go into more detail regarding each parameter choice and my reasoning behind it: Full Model Description Below is some output from my data and model: van Rij, J., Hendriks, P., van Rijn, H., Baayen, R. H., & Wood, S. N. (2019). Analyzing the time course of pupillometric data. Trends in hearing, 23, 2331216519832483.
