[site]: stackoverflow
[post_id]: 1234525
[parent_id]: 1233593
[tags]: 
Your centroids does not need to be an actual list. You never appear to reference anything other than centroids[i][m] . If you only want centroids[i] , then perhaps it doesn't need to be a list; a simple dictionary would probably do. centroids = defaultdict(float) # Move the centroids to the average of their members for i in range(k): len_best = len(bestmatches[i]) if len_best > 0: items = set.union(*[set(prefs[u].keys()) for u in bestmatches[i]]) for user_id in bestmatches[i]: row = prefs[user_id] for m in items: if row[m] > 0.0: centroids[m]+=(row[m]/len_best) May work better.
