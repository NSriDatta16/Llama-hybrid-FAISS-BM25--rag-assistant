[site]: stackoverflow
[post_id]: 3344204
[parent_id]: 
[tags]: 
How do I automate access to an IIS website that has "require client certificates"?

I work on an IIS6/ASP.NET website that must "require client certificates" in the form of a smart card (specifically a Common Access Card ). I need to create a few services to access various URLs on a timer to do things like update search indices, warm up Sharepoint pages, and other tasks. How can this be done, given that the site doesn't allow access unless you have a certificate, which is on the smartcard? I have tried to load the certificate (.cer) and load it in like this: HttpWebRequest request = (HttpWebRequest) WebRequest.Create("https://.../someURL.html"); const string certFilename = @"my.cer"; var cert = X509Certificate2.CreateFromCertFile(certFilename); cert.Import(certFilename, "my pin", X509KeyStorageFlags.Exportable); request.ClientCertificates.Add(cert); HttpWebResponse response = (HttpWebResponse) request.GetResponse(); But I get a 403 Forbidden.
