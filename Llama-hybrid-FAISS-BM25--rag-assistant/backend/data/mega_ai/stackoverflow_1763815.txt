[site]: stackoverflow
[post_id]: 1763815
[parent_id]: 1754587
[tags]: 
Here is a VBScript function that will always return a positive value for the Unicode code point of a given character:- Function PositiveUnicode(s) Dim val : val = AscW(s) If (val And &h8000) <> 0 Then PositiveUnicode = (val And &h7FFF) + &h8000& Else PositiveUnicode = CLng(val) End If End Function This will save you loading two script engines to acheive a simple operation. "not working correctly due to VBScripts implicit UTF-16 setting (instead of UTF-8)." This issue has nothing to do with UTF-8. It is purely the result of AscW use of the signed integer type. As to why you have to recreate the &#xxxxx; encodings that you sent this is result of how HTML (and XML) work. The use of this character encoding entity is a convnience that the specification does not require to remain intact. Since the character encoding of the document is quite capable or representing that character the DOM is at liberty to convert it.
