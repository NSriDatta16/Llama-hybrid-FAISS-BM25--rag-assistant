[site]: crossvalidated
[post_id]: 491715
[parent_id]: 
[tags]: 
Singular value decomposition used for dimensionality reduction in brain signal topographic data

I am trying to replicate the localizer method described in this paper (page 4). I am stuck on a step which I don't completely understand, and I would like your input and interpretation to progress. Let's assume we agree on the brain signal topography computation. The input is a topos 800x60 matrix (resulting from previous SVDs concatenation). 60 corresponds to the number of electrodes used and 800 to the number of trials. Those trials can be divided into 100 consecutive ones using the same paradigm/settings. The paper states: As the number of trials for each localizer is 100, U is averaged in the first dimension with 100 row steps. This resulted in a new matrix called UF with 8 rows and 61 columns which 8 rows corresponding to the FMP and the 40 Hz topography for each localizer run respectively. The columns are the components. We plotted the cumulative sum of singular values (in descending order) with each value divided by the total sum of singular values prior to plotting. The plot will show the fraction of total variance retained versus the number of singular values. We preserved components which have around 98.8% or 99% of the total variance of the data. In the component space (UF), the component which reflects auditory activity has the larger absolute value in the first and fifths rows of UF than in the second row and sixths rows of UF respectively. Moreover it has the smaller absolute value in the third and seventh rows than in the fourth and eight rows in the component space (UF), respectively. The reason for this selection is the presentation of auditory stimulus in localizer run 1 and 3 where the ASSR has more weight than occipital alpha. In the component space (UF), the component that reflects occipital activity is exactly the reverse. This selection was chosen on account of the absence of the auditory stimulus in localizer 2 and 4 in which occipital alpha is dominant over 40 Hz brain activity. The first step averages the values of U (result from SVD) based on the trial settings/paradigm. 0:100 - Localizer 1 response to 40 Hz audio stimuli 100:200 - Localizer 1 maximum power response (FMP) in the alpha band (8-13 Hz) 200:300 - Localizer 2 response to 40 Hz audio stimuli 300:400 - Localizer 2 maximum power response (FMP) in the alpha band (8-13 Hz) And so on until the last localizer 4. In python, the implementation I used is: u, s, v = np.linalg.svd(topos, full_matrices=False) # topos.shape = (800, 60) # u.shape = (800, 60); s.shape = (60, ); v.shape = (60, 60) step = 100 uf = np.average(u.reshape((800//step, step, 60)), axis=1) EDIT: I noticed that I am missing a step here. Capital U is different than u . U = u*s Step 2 is unclear to me. It looks like a dimensionality reduction based on the total variance retained. As my statistical courses are a bit behind me, I am not 100% sure of the method I used. I based it on this article . cumsum_singval = np.cumsum(s**2 / np.sum(s**2)) * 100 Note that the expression above is not literraly the one from the paper. The paper doesn't square the singular values, but the output doesn't make sense to me without the squaring step. f, ax = plt.subplots(1, 2, figsize=(20, 5)) sing_vals = np.arange(60) + 1 cumsum = (np.cumsum(s[::-1])[::-1] / np.sum(s)) * 100 # Paper, reverse to use descending order ax[0].plot(sing_vals, cumsum, 'ro-', linewidth=1) ax[0].set_title('Paper') cumsum_singval = np.cumsum(s**2 / np.sum(s**2)) * 100 # Interpretation ax[1].plot(sing_vals, cumsum_singval, 'ro-', linewidth=1) ax[1].set_title('Interpretation') I believe the idea is to select the components which retained 99% of the total variance: components_to_keep = np.where(cumsum_singval At this point, I think the reduced/approximated matrix topos should be reconstructed by keeping only the components that retain 99% of the total variance. Yet, step 3 and 4 go directly back to the matrix Uf and don't seem to use step 2 at all.. I understand why the auditory activity is reflected in the first and fifth rows of Uf . Those 2 rows correspond to the response to the auditory stimuli (ASSR response). But I believe there should be a step in which the dimensionally reduced matrix topos is computed before the average across trials performed by step 1. In other words, I would move step 1 after the dimensionality reduction. What are your thoughts and interpretation of this method? Additionally, doesn't SVD order the components by their importance? i.e. do the column from U directly relate to the column for topos (in this case, one columnm = one electrode), or is there a transformation to apply?
