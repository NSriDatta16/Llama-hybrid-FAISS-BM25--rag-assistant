[site]: datascience
[post_id]: 103845
[parent_id]: 
[tags]: 
Encoding with OrdinalEncoder: TypeError: unhashable type: 'numpy.ndarray'

I am trying to do a Random Forest in a dataset with numerical and categorical variables in order to obtain a categorical result (two possible classes, column name "predicción"). I am using the scikit-learn library in Jupyter notebook. I have done the train-test split like this: X_train, X_test, y_train, y_test = train_test_split(datos.drop(columns = 'predicción'), datos['predicción'],random_state = 123) then I made two lists with the column names that hold numerical or categorical values: cat_cols = X_train.select_dtypes(include=['object', 'category']).columns.to_list() numeric_cols = X_train.select_dtypes(include=['float64', 'int']).columns.to_list() cat = list(np.array(cat_cols).reshape(1,9)) I then do the encoding using ColumnTransformer: niveles = ['0', '1', '2'] encoder = ColumnTransformer([('ordinal', OrdinalEncoder(categories=[niveles]), cat)],remainder='passthrough') So far so good, no errors up to this point. The error rises when I use the fit_transform : X_train = encoder.fit_transform(X_train) X_test = encoder.fit_transform(X_test) I have not been able to find a solution to this problem or any alternative. I am fairly new to machine learning if that can be an excuse. Any bit of help is welcome!
