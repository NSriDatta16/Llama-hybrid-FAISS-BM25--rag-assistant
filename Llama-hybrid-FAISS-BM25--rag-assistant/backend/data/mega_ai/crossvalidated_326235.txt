[site]: crossvalidated
[post_id]: 326235
[parent_id]: 326099
[tags]: 
T-Test assumes samples are independent of each other. In the first case where each sample is identified by a user-date tuple, you might be violating this assumption. For example imagine the hypotheses is: whether a one-time free pass to normally only premium content leads to improvement in user engagement. For this hypothesis testing treating user-date as independent samples is wrong, since the treatment(shock/variant) only affect the first visit. Notice, that in specific case, the averaging method you purposed can result in misleading results as well. A possible practice might be - using only the first visit of each user. This should work if: 1) You have enough users. 2) You have no reason to believe any of the variants has long-term cumulative effects on users behavior.
