[site]: stackoverflow
[post_id]: 2363911
[parent_id]: 
[tags]: 
Shell Extension: DragQueryFile returns at most 16 (in Windows 7)

I've writtten a shell extension (guided by The Complete Idiot's Guide to Writing Shell Extensions ) which worked as it should until I upgraded to Windows 7(32bit). Now, the function DragQueryFile UINT uNumFiles = DragQueryFile(hDrop,0xFFFFFFFF,NULL,0); returns the right number of selected files until the number is above 16. Then always 16 is returned. I've tested it in XP(32) and Vista(32), there it works, in Windows7 (32/64) it doesn't. Any ideas? Thanks.
