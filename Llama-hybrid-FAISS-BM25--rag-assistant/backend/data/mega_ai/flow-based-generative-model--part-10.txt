f}} remains valid. We can however, choose our local coordinate system in a way that simplifies the expression for R f {\displaystyle R_{f}} and indeed also its practical implementation. Let π : P → R n {\displaystyle \pi :{\mathcal {P}}\to \mathbb {R} ^{n}} be a smooth idempotent projection ( π ∘ π = π {\displaystyle \pi \circ \pi =\pi } ) from the projectible set, P ⊆ R n {\displaystyle {\mathcal {P}}\subseteq \mathbb {R} ^{n}} , onto the embedded manifold. For example: The positive orthant of R n {\displaystyle \mathbb {R} ^{n}} is projected onto the simplex as: π ( z ) = ( ∑ i = 1 n z i ) − 1 z {\displaystyle \pi (\mathbf {z} )={\bigl (}\sum _{i=1}^{n}z_{i}{\bigr )}^{-1}\mathbf {z} } Non-zero vectors in R n {\displaystyle \mathbb {R} ^{n}} are projected onto the unitsphere as: π ( z ) = ( ∑ i = 1 n z i 2 ) − 1 2 z {\displaystyle \pi (\mathbf {z} )={\bigl (}\sum _{i=1}^{n}z_{i}^{2}{\bigr )}^{-{\frac {1}{2}}}\mathbf {z} } For every x ∈ M {\displaystyle \mathbf {x} \in {\mathcal {M}}} , we require of π {\displaystyle \pi } that its n -by- n {\displaystyle n{\text{-by-}}n} Jacobian, Π x {\displaystyle {\boldsymbol {\Pi _{x}}}} has rank m {\displaystyle m} (the manifold dimension), in which case Π x {\displaystyle {\boldsymbol {\Pi _{x}}}} is an idempotent linear projection onto the local tangent space (orthogonal for the unitsphere: I n − x x ′ {\displaystyle \mathbf {I} _{n}-\mathbf {xx} '} ; oblique for the simplex: I n − x 1 ′ {\displaystyle \mathbf {I} _{n}-{\boldsymbol {x1}}'} ). The columns of Π x {\displaystyle {\boldsymbol {\Pi _{x}}}} span the m {\displaystyle m} -dimensional tangent space at x {\displaystyle \mathbf {x} } . We use the notation, T x {\displaystyle \mathbf {T_{x}} } for any n -by- m {\displaystyle n{\text{-by-}}m} matrix with orthonormal columns ( T x ′ T x = I m {\displaystyle \mathbf {T} _{\mathbf {x} }'\mathbf {T_{x}} =\mathbf {I} _{m}} ) that span the local tangent space. Also note: Π x T x = T x {\displaystyle {\boldsymbol {\Pi _{x}}}\mathbf {T_{x}} =\mathbf {T_{x}} } . We can now choose our local coordinate embedding function, e x : R m → R n {\displaystyle e_{\mathbf {x} }:\mathbb {R} ^{m}\to \mathbb {R} ^{n}} : e x ( x ~ ) = π ( x + T x x ~ ) , with Jacobian: E x = T x at x ~ = 0 . {\displaystyle e_{\mathbf {x} }({\tilde {x}})=\pi (\mathbf {x} +\mathbf {T_{x}{\tilde {x}}} )\,,{\text{with Jacobian:}}\,\mathbf {E_{x}} =\mathbf {T_{x}} \,{\text{at}}\,{\tilde {\mathbf {x} }}=\mathbf {0} .} Since the Jacobian is injective (full rank: m {\displaystyle m} ), a local (not necessarily unique) left inverse, say r x ∗ {\displaystyle r_{\mathbf {x} }^{*}} with Jacobian R x ∗ {\displaystyle \mathbf {R} _{\mathbf {x} }^{*}} , exists such that r x ∗ ( e x ( x ~ ) ) = x ~ {\displaystyle r_{\mathbf {x} }^{*}(e_{\mathbf {x} }({\tilde {x}}))={\tilde {x}}} and R x ∗ T x = I m {\displaystyle \mathbf {R} _{\mathbf {x} }^{*}\mathbf {T_{x}} =\mathbf {I} _{m}} . In practice we do not need the left inverse function itself, but we do need its Jacobian, for which the above equation does not give a unique solution. We can however enforce a unique solution for the Jacobian by choosing the left inverse as, r x : R n → R m {\displaystyle r_{\mathbf {x} }:\mathbb {R} ^{n}\to \mathbb {R} ^{m}} : r x ( z ) = r x ∗ ( π ( z ) ) , with Jacobian: R x = T x ′ {\displaystyle r_{\mathbf {x} }(\mathbf {z} )=r_{\mathbf {x} }^{*}(\pi (\mathbf {z} ))\,,{\text{with Jacobian:}}\,\mathbf {R_{x}} =\mathbf {T} _{\mathbf {x} }'} We can now finally plug E x = T x {\displaystyle \mathbf {E_{x}} =\mathbf {T_{x}} } and R y = T y ′ {\displaystyle \mathbf {R_{y}} =\mathbf {T} _{\mathbf {y} }'} into our previous expression for R f {\displaystyle R_{f}} , the differential volume ratio, which because of the orthonormal Jacobians, simplifies to: R f ( x ) = | det ⁡ ( T y ′ F x T x ) | {\displaystyle R_{f}(\mathbf {x} )=\left|\operatorname {det} (\mathbf {T_{y}} '\mathbf {F_{x}T_{x}} )\right|} Practical implementation For learning the parameters of a manifo