[site]: stackoverflow
[post_id]: 2236679
[parent_id]: 2228586
[tags]: 
The key is to hide the drag image before the paint box is redrawn, and to show it again after that. If you replace this code in your question: procedure TForm1.PaintBox1DragOver(Sender, Source: TObject; X, Y: Integer; State: TDragState; var Accept: Boolean); var r: TRect; MustRepaint: Boolean; begin MustRepaint := False; if State = dsDragEnter then begin FRectIsHot := False; MustRepaint := True; end else begin r := GetSensitiveRect; Accept := PtInRect(r, Point(X, Y)); if Accept <> FRectIsHot then begin FRectIsHot := Accept; MustRepaint := True; end; end; if MustRepaint then PaintBox1.Invalidate; end; with this procedure TForm1.PaintBox1DragOver(Sender, Source: TObject; X, Y: Integer; State: TDragState; var Accept: Boolean); var r: TRect; begin if State = dsDragEnter then begin FRectIsHot := False; PaintBox1.Invalidate; end else begin r := GetSensitiveRect; Accept := PtInRect(r, Point(X, Y)); if Accept <> FRectIsHot then begin FRectIsHot := Accept; ImageList_DragShowNolock(False); try PaintBox1.Refresh; finally ImageList_DragShowNolock(True); end; end; end; end; it should work. Well, it does for me with Delphi 2007 on Windows XP 64 bit. And kudos for the demonstration code in your question, excellent way to let us see the problem.
