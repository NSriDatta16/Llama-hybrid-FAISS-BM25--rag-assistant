[site]: crossvalidated
[post_id]: 618558
[parent_id]: 618390
[tags]: 
My recommendation would be to do matching once with an exact matching constraint. You can either do this by doing a seperate matching step wihin each subgroup or a single round of matching with subgroup supplied as an exact matching variable. In MatchIt , both methods do the same thing; the only difference is whether the propensity score is estimated in the full sample or within each subgroup. If you use a parametric propensity score model (e.g., logistic regression, the default) and include interactions between each predictor and subgroup membership, the propensity scores will also be the same between the two methods. You can assess balance in each subgroup, then fit a single outcome model and use a marginal effects procedure to extract the subgroup effect estimates. The way you wrote your models is a bit confusing because based on your description, I would expect you to have a single variable the contains your index subgroup membership (A, B, or C). I'll try to write somne example code that will help perform the analysis I think yo uintend to. # Do the matching with a fully interacted PS model matched_dataNew I explain how to do the other method (matching in subgroups separately) in this blog post .
