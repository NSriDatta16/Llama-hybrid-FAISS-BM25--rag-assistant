[site]: stackoverflow
[post_id]: 320773
[parent_id]: 319716
[tags]: 
What I do is iterate through the hits and insert them into a temporary table in the db. Then I can run a regular SQL query - joining that temp table with other tables too - and give the grid the DataSet/DataView that it wants. Note that I do the inserts and the query in ONE TRIP to the db, because I'm using just one SQL batch. void Page_Load(Object sender, EventArgs e) { dbutil = new DbUtil(); security = new Security(); security.check_security(dbutil, HttpContext.Current, Security.ANY_USER_OK); Lucene.Net.Search.Query query = null; try { if (string.IsNullOrEmpty(Request["query"])) { throw new Exception("You forgot to enter something to search for..."); } query = MyLucene.parser.Parse(Request["query"]); } catch (Exception e3) { display_exception(e3); } Lucene.Net.Highlight.QueryScorer scorer = new Lucene.Net.Highlight.QueryScorer(query); Lucene.Net.Highlight.Highlighter highlighter = new Lucene.Net.Highlight.Highlighter(MyLucene.formatter, scorer); highlighter.SetTextFragmenter(MyLucene.fragmenter); // new Lucene.Net.Highlight.SimpleFragmenter(400)); StringBuilder sb = new StringBuilder(); string guid = Guid.NewGuid().ToString().Replace("-", ""); Dictionary dict_already_seen_ids = new Dictionary (); sb.Append(@" create table #$GUID ( temp_bg_id int, temp_bp_id int, temp_score float, temp_text nvarchar(3000) ) "); lock (MyLucene.my_lock) { Lucene.Net.Search.Hits hits = null; try { hits = MyLucene.search(query); } catch (Exception e2) { display_exception(e2); } // insert the search results into a temp table which we will join with what's in the database for (int i = 0; i 3000) { highlighted_text = highlighted_text.Substring(0,3000); } sb.Append(highlighted_text); sb.Append("'"); sb.Append(")\n"); } } else { break; } } //searcher.Close(); }
