[site]: stackoverflow
[post_id]: 946677
[parent_id]: 945847
[tags]: 
Imports System.IO Imports System.Net Private Function PostWebPage(ByVal argUrl As String) As String Dim objWebRequest As HttpWebRequest Dim sPostData As New StringBuilder Dim sr As StreamReader Dim objWebResponse As HttpWebResponse If argUrl.Length > 0 Then Try objWebRequest = CType(WebRequest.Create(argUrl), HttpWebRequest) objWebRequest.UserAgent = "Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+1.0.3705)" sPostData.Append("accountType=GOOGLE&Email=*******@gmail.com&Passwd=*******&service=analytics&source=Test") objWebRequest.Method = "POST" objWebRequest.ContentType = "application/x-www-form-urlencoded" objWebRequest.ContentLength = sPostData.ToString.Length Dim stOut As New StreamWriter(objWebRequest.GetRequestStream, System.Text.Encoding.ASCII) stOut.Write(sPostData) stOut.Close() objWebRequest.AllowAutoRedirect = True objWebRequest.Timeout = 10000 objWebRequest.KeepAlive = True objWebResponse = CType(objWebRequest.GetResponse(), HttpWebResponse) sr = New StreamReader(objWebResponse.GetResponseStream) Return sr.ReadToEnd Exit Function Catch ex As Exception End Try End If Return "" End Function
