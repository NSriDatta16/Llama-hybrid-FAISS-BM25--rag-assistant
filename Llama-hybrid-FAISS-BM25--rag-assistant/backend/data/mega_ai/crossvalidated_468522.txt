[site]: crossvalidated
[post_id]: 468522
[parent_id]: 468131
[tags]: 
Asking 16 questions is a lot, but I'll do my best to get the main ideas across. I'm not an expert in survival analysis, but I do have expertise in regression and causal inference, so perhaps someone else could fill in the details that pertain to Cox regression specifically. Marginal and Conditional Hazard Ratios A hazard ratio (HR) is a measure of association between a treatment and survival. It is noncollapsible, which means that a conditional HR (an HR computed for a stratum of the population) is not equal to a marginal HR (an HR computed for the whole population), even if stratum membership is unrelated to treatment and there is no confounding (e.g., in a randomized trial). My understanding is that in a Cox regression when covariates are included, the estimated HR for the treatment is a conditional HR (i.e., conditional the covariates), whereas when covariates are not included so that treatment is the only predictor in the model, the estimated HR is the marginal HR. How to decide if you want a conditional or marginal HR is an issue for another post, but it relates to whether you want to know how an intervention would work if applied to a subset of a population (e.g., an individual patient) vs. the whole population. Doctors usually care about conditional HRs; policymakers usually care about marginal HRs. Causality and Confounding In the absence of a randomized trial, there is confounding . Confounding occurs when some variables cause both selection into treatment and variation in the outcome. Confounders are variables that are sufficient to remove confounding. How to identify confounders is a matter for another post. In the presence of confounding, a measured association between the treatment and the outcome cannot be interpreted as causal (or it can be considered a biased estimate of the causal effect). There are a variety of techniques to adjust for confounding; regression (e.g., Cox regression) of the outcome on the treatment and confounders is one way, and propensity score methods (e.g., propensity score matching and weighting) are another way. Each has its own merits, discussed below. If a sufficient set of confounders has been measured and has been adjusted for correctly, then the estimated adjusted association between the treatment and the outcome can be interpreted as causal. (Many people don't believe this is possible, and therefore doubt any causal inference made using this strategy.) Estimating Causal HRs Let us identify four strategies to estimate a causal HR, assuming we are in an observational study and we know that age is the only confounder (just for the sake of exposition). Let us also assume that age is linearly related to the outcome and that the treatment effect is the same for all ages (we'll come back to this latter assumption later). We also assume the HR is constant over time. Four strategies include: Cox regression of the outcome on treatment Cox regression of the outcome on treatment and age Cox regression of the outcome on treatment after propensity score matching Cox regression of the outcome on treatment and age after propensity score matching I'll discuss what each method would give you. 1. Cox regression of the outcome on treatment The estimated HR is the marginal unadjusted HR . It is biased for the causal marginal HR because confounding is present and the confounder (age) was not adjusted for in any way. 2. Cox regression of the outcome on treatment and age The estimated HR is the conditional adjusted HR . It is unbiased for the causal conditional HR. This is the same value you would get if you performed a randomized trial in the same population and ran the same model. 3. Cox regression of the outcome on treatment after propensity score matching The estimated HR is the marginal adjusted HR . It is unbiased for the causal marginal HR. This is the same value you would get if you performed a randomized trial in the same population and ran a cox regression without including any covariates. 4. Cox regression of the outcome on treatment and age after propensity score matching The estimated HR is the conditional adjusted HR . It is unbiased for the causal conditional HR, the same value described in 2). So, basically, covariate adjustment through regression and propensity score matching perform two distinct functions: covariate-adjusted regression estimates the conditional HR and removes confounding , making the estimate unbiased for the causal conditional HR; propensity score matching estimates the marginal HR and removes confounding , making the estimate unbiased for the causal marginal HR. Performing covariate-adjusted regression after propensity score matching gives an estimate with the same properties as the simple covariate-adjusted regression. There is an added complication if the treatment effect differs for patients with different ages. In this case, the population in which the effect is estimated will change the effect estimate. In this case, covariate-adjusted regression should include the interaction between the treatment and age to estimate causal conditional HRs for each age. Propensity score matching now estimates the causal marginal HR for a population of patients like those who received treatment. There are other propensity score methods, like propensity score weighting, that can estimate the causal marginal HR for the whole population. Some potentially lingering questions: Why would you use both matching and covariate-adjusted regression if regression alone gives you a conditional adjusted estimate? For models in which the effect estimate is collapsible, performing both matching and regression gives you two chances to correctly adjust for confounding. In noncollapsible models; additional methods are required to attain so-called "doubly-robust" estimates. Austin, Thomas, and Rubin (2018) describe an example of what you can do to get a doubly-robust causal marginal HR estimate using matching and regression. In some cases, when the effect of the confounders is nonlinear and matching restricts the sample to a zone where the effect is approximately linear, matching can allow for an unbiased conditional HR estimate even if the outcome model is incorrectly specified. See Ho, Imai, King, and Stuart (2007) for an example of this phenomenon, though note it is in the context of linear models. What if I want a marginal causal HR estimate but I don't want to use propensity score methods? There are other ways to estimate the causal marginal HR, but I'm not an expert in them. A method called "g-computation" allows you use regression to estimate a causal marginal effect, but it's not as simple as reading off a coefficient in a regression output table. How does the significance of the confounders in the covariate-adjusted model relate to all this? Not at all. The presence or absence of significance doesn't tell you whether a covariate is a confounder or not. Only a causal model can do that. There are a variety of reasons why a covariate might be significant or nonsignificant regardless of its status as a confounder. You should not use significance testing to determine whether you should adjust for a variable to control confounding. In a randomized trial or an adequately propensity score-matched or -weighted sample, if the inclusion of a covariate does not change the treatment effect estimate, then the marginal and conditional effects may be equal to each other. A final note is that the paragraph you quoted is wrong. The authors confuse collapsibility with confounding and don't distinguish between marginal and conditional associations. These are key distinctions when dealing with noncollapsible quantities. I agree with another commenter that you should read What If by Robins and Hernán. Chapter 17 is all about causal survival analysis. Austin, P. C., Thomas, N., & Rubin, D. B. (2020). Covariate-adjusted survival analyses in propensity-score matched samples: Imputing potential time-to-event outcomes. Statistical Methods in Medical Research, 29(3), 728–751. https://doi.org/10.1177/0962280218817926 Ho, D. E., Imai, K., King, G., & Stuart, E. A. (2007). Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inference. Political Analysis, 15(3), 199–236. https://doi.org/10.1093/pan/mpl013
