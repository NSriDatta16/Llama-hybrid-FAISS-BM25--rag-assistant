[site]: stackoverflow
[post_id]: 2017917
[parent_id]: 2017404
[tags]: 
As an answer I am afraid you can't. There is no way to control what referrer people send to you. You can reduce it by doing as Chris suggested. But as a rule anyone who uses a bot to deliberately create this type of spam will change the User-Agent string. Heck I do it to prevent the stupid firewall I am behind from preventing me using Firefox, because hey we know how safe IE is. So using that technique will only stop a very small percentage. The important thing to remember is anyone can fake anything sent to your server, form values, http headers, cookies even IP addresses, so don't trust any of it and don't worry about it. Not the answer you wanted but unfortunately the only real answer. If you really really must, then you would get the referrer, scrape that page and if no link found ignore it. but thats a lot of work and ignores javascript created links (from ads etc). Sometimes you get a bad referrer simply from a broken browser or scraping software or even a search bot.
