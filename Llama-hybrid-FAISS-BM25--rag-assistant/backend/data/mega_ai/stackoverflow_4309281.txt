[site]: stackoverflow
[post_id]: 4309281
[parent_id]: 4307334
[tags]: 
You need to move the inserting of the header and footer fields into product loop eg. the custid and trx_id fields. Here's a rough idea of one why you can go about this based on the pseudo code you provided. I'm sure that there are more elegant ways that you could code this. set order = 0; loop over cust_id; counter = 1; order = order + 1; loop over product_id if (counter == 1 || counter == 6) { if (counter == 6) { counter == 1; order= order+1; } field[order][1] = "field(1)"; // cust_id field[order][2] = "field(2)"; // name field[order][3] = "field(3)"; // phone } field[order][counter+3] = productCode; // product_1 field[order][counter+4] = quantity; // quantity_1 counter = counter + 1; if (counter == 6) { field[order][14] = "field(4)"; // trx_id field[order][15] = "field(5)"; // total_cost } end inner loop; if (counter == 6) { // loop here to insert blank columns and the totals field to fill out the row. } end outer loop; One thing goes concern me. If you start a new line every five products then your transaction id and total cost is going to be entered into the file more than once. You know the receiving system. It may be a non-issue. Hope this helps
