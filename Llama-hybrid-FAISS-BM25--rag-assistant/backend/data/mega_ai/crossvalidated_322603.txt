[site]: crossvalidated
[post_id]: 322603
[parent_id]: 322581
[tags]: 
You might try using an exponentially weighed moving average (EWMA) on visits, giving recent months a higher weight than earlier months. Here are the steps to calculating an EWMA: sort the data by customer ID and by Month weight=0.8; //in the equations in wikipedia, weight is called lambda if (customerID!=lag(customerID) {movingAverage=NVisits} else { movingAverage=movingAverage*weight + (1-weight)*NVisits} Here's a link to a Wikipedia article on EWMA: https://en.wikipedia.org/wiki/EWMA_chart Here's screen shot of a data table where I took a weighted average over 6 months. The highlighted rows are the rows you would actually use in your analysis. You can see that the customer who has more visits in recent months has a higher weighted average than the customer who has more visits in past months. Picking the weight is a bit of an art. It has to be a number between 0 and 1. If it's closer to 1, later months will have more weight. If it's less than 0.5, later months will have less weight.
