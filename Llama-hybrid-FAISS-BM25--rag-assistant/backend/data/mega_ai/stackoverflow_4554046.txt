[site]: stackoverflow
[post_id]: 4554046
[parent_id]: 4553902
[tags]: 
You should debug the exact server response using netcat. But a quick look with wget --save-headers reveals that the output actually looks ok: HTTP/1.1 200 OK Date: Wed, 29 Dec 2010 12:16:03 GMT Server: Apache/2.2.14 (Ubuntu) X-Powered-By: PHP/5.2.6-3ubuntu4.6 Set-Cookie: PHPSESSID=sjh4k63i9npk6b15uperclau75; path=/ Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Keep-Alive: timeout=15, max=100 Connection: Keep-Alive, Keep-Alive Transfer-Encoding: chunked Content-Type: image/jpeg Your linked bug-report had an invalid "chunked,chunked" - which isn't the case for your script. Still the chunked encoding is the problem here, as your Chrome error message shows. I think the problem might be PHPs output buffers. The transfer-encoding lacks the final 0\r\n to terminate the HTTP stream. You can try flush(), disabling PHPs output buffer, and also Apaches mod_deflate (which is an extra buffer). I'm clueless as to why PHP keeps the connection open, but it might very well be the specifc combination of eval and exit. Try rewriting your code: header("Content-type: image/${image_type}"); flush(); $func = "imagecreatefrom${image_type}"; $image = $func($tf); $func = "image${image_type}"; $func($image); flush(); exit; Or if it doesn't work. Try outputting garbage echo "0"; after the image.
