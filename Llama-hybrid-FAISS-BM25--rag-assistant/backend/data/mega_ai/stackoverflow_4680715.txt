[site]: stackoverflow
[post_id]: 4680715
[parent_id]: 4676645
[tags]: 
I suspect this is a side-effect of using -auto-all , which inhibits many optimizations GHC would normally perform, including inlining. I suspect the difference in your non-polymorphic version is actually due to vx , vy , and vz being defined via record syntax rather than because of polymorphism (but I could be wrong about this). Instead of using -auto-all, try either adding an export list to the module and compiling with "-auto", or manually setting cost centers via SCC pragmas. I usually use SCC pragmas anyway because I often want to set them on let-bound functions, which -auto-all won't do.
