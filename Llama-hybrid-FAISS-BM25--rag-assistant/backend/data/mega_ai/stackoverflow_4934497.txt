[site]: stackoverflow
[post_id]: 4934497
[parent_id]: 
[tags]: 
VB.NET - SQL UpdateCommand for table without primary key in Gridview

1) What's the syntax for a Update query for a table without a primary key in vb.net for a gridview with a checkbox? Disclaimer: Frustratingly, adding a primary key is not an option. My program is a small program in a much larger system with poor data management. My development time does not include rewriting the other software. Here are the Columns for the table Where AgentLeads is the database and MktDtaLeads_Scrubbed is the table: FROM [AgentLeads].[dbo].[MktDtaLeads_Scrubbed] - [Last Name] ,[First Name], [Middle Name] ,[Suffix] ,[Address Line 1] ,[Address Line 2] ,[City] ,[ST], [ZipCode] ,[Email Address] ,[Phone Nbr] ,[Toll Free Nbr] ,[InsertDate] , [SentDate] ,[DoNotMail] The code I have right now doesn't display any errors but doesn't update the DoNotMail field when you check the checkbox even though it does display the text "The DoNotMail value has been changed in the database for the selected field". For the default.aspx.vb code behind I added: Public Sub gridview1_RowCommand(ByVal sender As Object, ByVal e As GridViewCommandEventArgs) If e.CommandName = "UpdateDoNotMail" Then With Me.SqlDataSource1 Dim box As CheckBox = DirectCast(sender, CheckBox) If box.Checked = True Then donotmail.SelectedValue = 1 .ConnectionString = ConfigurationManager.AppSettings("AgentLeadsConnectionString").ToString .UpdateCommand = "UPDATE MktDataLeads_scrubbed set donotmail=@donotmail WHERE [last name]=@lastname.selectedrow AND [first name]=@firstname.selectedrow AND [Address Line 1]=@Address Line 1.selectedrow" Else donotmail.SelectedValue = 0 .ConnectionString = ConfigurationManager.AppSettings("AgentLeadsConnectionString").ToString .UpdateCommand = "UPDATE MktDataLeads_scrubbed set donotmail=@donotmail WHERE [last name]=@lastname.selectedrow AND [first name]=@firstname.selectedrow AND [Address Line 1]=@Address Line 1.selectedrow" End If End With End If End Sub Here's the code for the GridView on default.aspx: ' Enabled="true" /> ' /> 2) is it possible to do a two way sync on the entire gridview when the user hits a button so you don't have to do an update every time a row is changed? because the user might check the box and then check another box then uncheck a box and it would be a lot of updates...
