[site]: stackoverflow
[post_id]: 1201812
[parent_id]: 
[tags]: 
Drag and Drop between Instances of the same Windows Forms Application

I have created a small Windows Forms test application to try out some drag/drop code. The form consists of three PictureBoxes. My intention was to grab a picture from one PictureBox, display it as a custom cursor during the drag operation, then drop it on another PictureBox target. This works fine from one PictureBox to another as long as they are on the same form . If I open two instances of the same application and attempt to drag/drop between them, I get the following cryptic error: This remoting proxy has no channel sink which means either the server has no registered server channels that are listening, or this application has no suitable client channel to talk to the server. For some reason, however, it does work to drag/drop to Wordpad (but not MS Word or Paintbrush). The three PictureBoxes get their events hooked up like this: foreach (Control pbx in this.Controls) { if (pbx is PictureBox) { pbx.AllowDrop = true; pbx.MouseDown += new MouseEventHandler(pictureBox_MouseDown); pbx.GiveFeedback += new GiveFeedbackEventHandler(pictureBox_GiveFeedback); pbx.DragEnter += new DragEventHandler(pictureBox_DragEnter); pbx.DragDrop += new DragEventHandler(pictureBox_DragDrop); } } Then there are the four events like this: void pictureBox_MouseDown(object sender, MouseEventArgs e) { int width = (sender as PictureBox).Image.Width; int height = (sender as PictureBox).Image.Height; Bitmap bmp = new Bitmap(width, height); Graphics g = Graphics.FromImage(bmp); g.DrawImage((sender as PictureBox).Image, 0, 0, width, height); g.Dispose(); cursorCreatedFromControlBitmap = CustomCursors.CreateFormCursor(bmp, transparencyType); bmp.Dispose(); Cursor.Current = this.cursorCreatedFromControlBitmap; (sender as PictureBox).DoDragDrop((sender as PictureBox).Image, DragDropEffects.All); } void pictureBox_GiveFeedback(object sender, GiveFeedbackEventArgs gfea) { gfea.UseDefaultCursors = false; } void pictureBox_DragEnter(object sender, DragEventArgs dea) { if ((dea.KeyState & 32) == 32) { // ALT is pressed dea.Effect = DragDropEffects.Link; } else if ((dea.KeyState & 8) == 8) { // CTRL is pressed dea.Effect = DragDropEffects.Copy; } else if ((dea.KeyState & 4) == 4) { // SHIFT is pressed dea.Effect = DragDropEffects.None; } else { dea.Effect = DragDropEffects.Move; } } void pictureBox_DragDrop(object sender, DragEventArgs dea) { if (((IDataObject)dea.Data).GetDataPresent(DataFormats.Bitmap)) (sender as PictureBox).Image = (Image)((IDataObject)dea.Data).GetData(DataFormats.Bitmap); } Any help would be greatly appreciated!
