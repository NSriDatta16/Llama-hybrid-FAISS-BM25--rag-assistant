[site]: crossvalidated
[post_id]: 252585
[parent_id]: 252577
[tags]: 
Given a data set $D = (x_1,y_1), \ldots, (x_N,y_N)$ where $x \in \mathbb{R}^d, y \in \mathbb{R}$, a Bayesian Linear Regression models the problem in the following way: Prior: $$w \sim \mathcal{N}(0, \sigma_w^2 I_d)$$ $w$ is vector $(w_1, \ldots, w_d)^T$, so the previous distribution is a multivariate Gaussian; and $I_d$ is the $d\times d$ identity matrix. Likelihood: $$Y_i \sim \mathcal{N}(w^T x_i, \sigma^2)$$ We assume that $Y_i \perp Y_j | w, i \neq j$ For now we'll use the precision instead of the variance, $a = 1/\sigma^2$, and $b = 1/\sigma_w^2$. We'll also assume that $a,b$ are known. The prior can be stated as $$p(w) \propto \exp \Big\{ -\frac{b}{2} w^t w \Big\}$$ And the likelihood $$p(D|w) \propto \exp \Big\{ -\frac{a}{2} (y-Aw)^T (y-Aw) \Big\}$$ where $y = (y_1,\ldots,y_N)^T$ and $A$ is a $n\times d$ matrix where the i-th row is $x_i^T$. Then the posterior is $$p(w|D) \propto p(D|w) p(w)$$ After many calculations we discover that $$p(w|D) \sim \mathcal{N}(w | \mu, \Lambda^{-1})$$ where ($\Lambda$ is the precision matrix) $$\Lambda = a A^T A + b I_d $$ $$\mu = a \Lambda^{-1} A^T y$$ Notice that $\mu$ is equal to the $w_{MAP}$ of the regular linear regression, this is because for the Gaussian, the mean is equal to the mode. Also, we can make some algebra over $\mu$ and get the following equality ($\Lambda = aA^TA+bI_d$): $$\mu = (A^T A + \frac{b}{a} I_d)^{-1} A^T y$$ and compare with $w_{MLE}$: $$w_{MLE} = (A^T A)^{-1} A^T y$$ The extra expression in $\mu$ corresponds to the prior. This is similar to the expression for the Ridge regression, for the special case when $\lambda = \frac{b}{a}$. Ridge regression is more general because the technique can choose improper priors (in the Bayesian perspective). For the predictive posterior distribution: $$p(y|x,D) = \int p(y|x,D,w) p(w|x,D) dw = \int p(y|x,w) p(w|D) dw$$ it is possible to calculate that $$y|x,D \sim \mathcal{N}(\mu^Tx, \frac{1}{a} + x^T \Lambda^{-1}x)$$ Reference: Lunn et al. The BUGS Book For using a MCMC tool like JAGS/Stan check Kruschke's Doing Bayesian Data Analysis
