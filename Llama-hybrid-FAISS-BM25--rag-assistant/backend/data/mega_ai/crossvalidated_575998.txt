[site]: crossvalidated
[post_id]: 575998
[parent_id]: 
[tags]: 
Permutation test for adonis under NA model?

I am having issues understanding why the permanova computed with adonis2() in vegan is returning a NA model in the second test that you find below. The toy example reproduces the error but I am not 100% sure that the reason why the toy is behaving weird is the same reason why the actual data show the same error. However, the data are very similar, i.e. a count matrix, the metadata are comparable, i.e. treatments and sites, and the formula is the same. library("vegan") # create metadata meta Why is the second test returning a NA model and is that a problem? Edit after comment This is what I get as output: > adonis2(transposed_taxa~treatment+site, data=meta, permutations=perm, method="bray", by="margin") 'nperm' >= set of all permutations: complete enumeration. Set of permutations F) treatment 1 0.07628 0.10414 0.4585 0.7000 site 1 0.28743 0.39242 1.7276 0.3167 Residual 2 0.33275 0.45429 Total 4 0.73246 1.00000 > adonis2(transposed_taxa~treatment, data=meta, permutations=perm, method="bray", by="margin") 'nperm' >= set of all permutations: complete enumeration. Set of permutations F) treatment 1 0.11228 0.1533 0.5431 0.7 Residual 3 0.62018 0.8467 Total 4 0.73246 1.0000 In the second example, you can see how I get the NA model: Permutation test for adonis under NA model : 'nperm' >= set of all permutations: complete enumeration. Set of permutations In the first example there is nothing weird since I get a reduced model. I am not sure it may help, but here you can find version of packages I am using: > sessionInfo() R version 4.2.0 (2022-04-22) Platform: x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 20.04.4 LTS Matrix products: default BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0 locale: [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C [3] LC_TIME=it_IT.UTF-8 LC_COLLATE=en_US.UTF-8 [5] LC_MONETARY=it_IT.UTF-8 LC_MESSAGES=en_US.UTF-8 [7] LC_PAPER=it_IT.UTF-8 LC_NAME=C [9] LC_ADDRESS=C LC_TELEPHONE=C [11] LC_MEASUREMENT=it_IT.UTF-8 LC_IDENTIFICATION=C attached base packages: [1] stats graphics grDevices utils datasets methods base other attached packages: [1] vegan_2.6-2 lattice_0.20-45 permute_0.9-7 loaded via a namespace (and not attached): [1] MASS_7.3-57 compiler_4.2.0 Matrix_1.4-1 parallel_4.2.0 tools_4.2.0 [6] mgcv_1.8-40 splines_4.2.0 nlme_3.1-157 grid_4.2.0 cluster_2.1.3
