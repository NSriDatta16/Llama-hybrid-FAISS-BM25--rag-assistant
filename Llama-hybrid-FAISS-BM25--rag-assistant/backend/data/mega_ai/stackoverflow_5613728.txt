[site]: stackoverflow
[post_id]: 5613728
[parent_id]: 
[tags]: 
Sum a union query

I'm using Microsoft SQL Svr Mgmt Studio 2008. I don't have access to create a temporary table (company restricts ability to create or modify tables) or I would use that to solve this problem. I have successfully used a union query to combine the results of three select queries. Now I am trying to sum the results of the union. When I execute the query below I receive: Incorrect syntax near the keyword 'GROUP' And then when I remove the group by I get: Incorrect syntax near ')' Here's my query so far: Select Period, PCC, SUM(BasicHits), SUM(FareHits), SUM(SearchHits) From ( SELECT AAAPeriod AS Period, AAAFromPCC AS PCC, - SUM(AAABasic) AS BasicHits, - SUM(AAAFare) AS FareHits, - SUM(AAASearch) AS SearchHits FROM HitsAaa HAVING (AAAPeriod = N'2010-10') UNION ALL SELECT AAAPeriod, AAAtoPCC, SUM(AAABasic), SUM(AAAFare), SUM(AAASearch) FROM HitsAaa HAVING (AAAPeriod = N'2010-10') UNION ALL SELECT AgtPeriod, AgtPcc, SUM(AgtBasic), SUM(AgtFare), SUM(AgtSearch) FROM HitsAgent HAVING (AgtPeriod = N'2010-10') )GROUP BY Period, PCC I haven't been able to find a solution to this on any of the previous questions.
