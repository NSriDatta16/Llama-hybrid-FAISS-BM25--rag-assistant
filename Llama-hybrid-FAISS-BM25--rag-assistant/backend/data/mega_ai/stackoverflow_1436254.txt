[site]: stackoverflow
[post_id]: 1436254
[parent_id]: 1429899
[tags]: 
Ok, I have two ideas for you. Hopefully one of them will get you where you need to go. Note that the first one ignores the request to do this as a formula since that solution is not pretty. I figured I make sure the easy way really wouldn't work for you ;^). Use the Advanced Filter command Select the list (or put your selection anywhere inside the list and click ok if the dialog comes up complaining that Excel does not know if your list contains headers or not) Choose Data/Advanced Filter Choose either "Filter the list, in-place" or "Copy to another location" Click "Unique records only" Click ok You are done. A unique list is created either in place or at a new location. Note that you can record this action to create a one line VBA script to do this which could then possible be generalized to work in other situations for you (e.g. without the manual steps listed above). Using Formulas (note that I'm building on Locksfree solution to end up with a list with no holes) This solution will work with the following caveats: The list must be sorted (ascending or descending does not matter). Actually that's quite accurate as the requirement is really that all like items must be contiguous but sorting is the easiest way to reach that state. Three new columns are required (two new columns for calculations and one new column for the new list). The second and third columns could be combined but I'll leave that as an exercise to the reader. Here is the summary of the solution: For each item in the list, calculate the number of duplicates above it. For each place in the unique list, calculate the index of the next unique item. Finally, use the indexes to create a new list with only unique items. And here is a step by step example: Open a new spreadsheet In a1:a6 enter the example given in the original question ("red", "blue", "red", "green", "blue", "black") Sort the list: put the selection in the list and choose the sort command. In column B, calculate the duplicates: In B1, enter "=IF(COUNTIF($A$1:A1,A1) = 1,0,COUNTIF(A1:$A$6,A1))". Note that the "$" in the cell references are very important as it will make the next step (populating the rest of the column) much easier. The "$" indicates an absolute reference so that when the cell content is copy/pasted the reference will not update (as opposed to a relative reference which will update). Use smart copy to populate the rest of column B: Select B1. Move your mouse over the black square in the lower right hand corner of the selection. Click and drag down to the bottom of the list (B6). When you release, the formula will be copied into B2:B6 with the relative references updated. The value of B1:B6 should now be "0,0,1,0,0,1". Notice that the "1" entries indicate duplicates. In Column C, create an index of unique items: In C1, enter "=Row()". You really just want C1 = 1 but using Row() means this solution will work even if the list does not start in row 1. In C2, enter "=IF(C1+1 Use smart copy to populate C3:C6. The value of C1:C6 should be "1,2,4,5,7,8" In column D, create the new unique list: In D1, enter "=IF(C1 Use smart copy to populate D2:D6. The values of D1:D6 should now be "black","blue","green","red","","". Hope this helps....
