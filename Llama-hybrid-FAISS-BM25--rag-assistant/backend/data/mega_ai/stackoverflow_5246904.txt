[site]: stackoverflow
[post_id]: 5246904
[parent_id]: 2359934
[tags]: 
"Algorithms of the Intelligent Web" by Marmanis & Babenko. Hands down the best reference for what you need (based on your description). Yes, the code is written in Java but it is so clean and straightforward that you can probably transliterate it, into whatever you want, rather quickly. In terms of search functionality it goes beyond indexing and describes, in-detail, PageRank, user click enhancements, and a PageRank-inspired ranking algorithm for plain documents (ASCII, Word, PDF) that the author called DocRank. The book also provides, probably the best, practical coverage of recommendation engines, e.g. user-user, item-item, content based.
