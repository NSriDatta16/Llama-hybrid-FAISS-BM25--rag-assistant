[site]: stackoverflow
[post_id]: 2614107
[parent_id]: 2608782
[tags]: 
With respect to computational efficiency I would recommend doing this in the Fourier domain instead of the time (image) domain using convolutions. Remember, a convolution is a simple multiplication in the Fourier domain. Just like in time series where the spectral density function is the variance decomposed as a function of frequency, one can extend this into two dimensions for an image. Should be much better than nested for-loops. I don't have the code on me at the moment. but this technique has been used in algorithms like "fast template matching" for object detection or image registration.
