[site]: crossvalidated
[post_id]: 200625
[parent_id]: 200598
[tags]: 
I did not read your code too carefully, but so far I think it might not be an appropriate implementation of cross validation in a time series setting. You seem to be first omitting randomly some rows from the data set that only includes the original variables but not their lags and then implicitly forming the design matrix consisting of lagged values of the variables and estimating the VAR model. This way you mess up the time series ordering of series when forming the lagged variables. Time series cross validation does not work that way. You can only remove rows from the full-sample design matrix (that already includes all the lags to be used in the model), and even that requires some conditions to be fulfilled, see Bergmeir et al. "A Note on the Validity of Cross-Validation for Evaluating Time Series Prediction" (2015, working paper). More generally, you could be doing cross validation using rolling windows as described in Hyndman and Athanasopoulos "Forecasting: principles and practice" section 2.5 (scroll all the way down). See also my recent answer in this thread .
