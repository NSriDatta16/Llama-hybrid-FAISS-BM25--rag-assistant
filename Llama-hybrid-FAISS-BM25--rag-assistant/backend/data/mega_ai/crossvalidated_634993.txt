[site]: crossvalidated
[post_id]: 634993
[parent_id]: 
[tags]: 
Modeling or data error causing large standard errors in GLMM (lme4) with repeated measures

The aim: I am trying to investigate the difference of COPD incidence in participants in stratified age groups of alcohol consumption debut. The dataset: I have a dataset of approx 4700 participants who answered a questionnaire and performed a lung function test at both baseline and follow up. The dataframe df is in long format with patient_id as identifier and year as cluster variable for identifying baseline 2004 and follow up 2008 . COPD is the outcome measure and a factor with 2 levels (yes or no), which is determined by a lung function test. It was tested at both baseline and follow up and it was defined at baseline as post-bronchodilatory FEV1/FVC ratio OR if they were diagnosed with COPD at baseline . This way all baseline-COPD participants who were lost to follow up were assigned to COPD at follow up time as well - as COPD is assumed to be chronic. Default were set to No COPD so everyone else were assumed to be without disease. AgeAlcoholDebut is the grouping variable. A factor stating at what age they started to drink alcohol according to which age group participants self-reported to belong at debut. The models: I'm trying to construct GLMMs using the glmer() function from lme4 -package to account for repeated measures. I am trying to make both an unadjusted model and an adjusted model. Both will be presented below - but for now i'm just providing the data for the unadjusted model. Tell me if you'd like the data for the adjusted model as well. The unadjusted model, i believe, is quite simple. Yet the output is with large estimates and large standard errors (see below). The adjusted model is the same and also i'm getting some warnings regarding unable to evaluate scaled gradient, failing to converge: degenerate Hessian with 2 negative eigenvalues - i am aware that the warnings might be due to the model being too complex, but here i am hoping fixing the underlying issue with the unadjusted model might help my adjusted model. Regarding the warnings i have tried rescaling and different optimizers using Ben Bolkers guide at https://rstudio-pubs-static.s3.amazonaws.com/33653_57fc7b8e5d484c909b615d8633c01d51.html . Also i might add when doing a GEE using the geepack. I get more reliable results which do not have as wide 95CI. The reasoning as to why im not just going with the GEE is that 1) to my understanding GLMM is better at dealing with some missingness (whereas GEE is just forced to omit the rows) and 2) I'm later doing a model with a continuous outcome variable (FEV1) which isn't possible with GEE (as far as i know) and i would for simplicity like it to be done with the same statistical method. The problem and my questions: The main problem is that i get these really large og really small intercept estimates (like log(odds) -28.2487) and large standard errors (like 3.1867). Do you agree that these results do not seem valid and they're most likely a result of wrongful modelling or mistake in how the data is set up? Is the modelling correctly set up? For example: COPD ~ AgeAlcoholDebut + year + (1 | patient_id) If so, can you help me figure out where the mistake in the data is? What i've done, reproducible example and outputs : Packages used: library(tidyverse) library(lme4) library(optimx) Dataframe for the unadjusted model: https://pastebin.com/YsjHJXia Output from dput() was too long to be included in the text. And sorry it's so long, I tried to shorten it but then the models came with new warnings (like with the adjusted example below) which i suspected would be drawing attention from the real problem. The unadjusted model: Creating an unadjusted GLMM model with lme4 package modeling COPD explained by Age of Alcohol Debut (with never drinkers as ref.) incorporating the repeated measures with year as a fixed effects and patient_id as cluster variable unadj_glme Which gives me the following output: Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod'] Family: binomial ( logit ) Formula: COPD ~ AgeAlcoholDebut + year + (1 | patient_id) Data: unadj_df Control: glmerControl(optimizer = "optimx", optCtrl = list(method = "nlminb")) AIC BIC logLik deviance df.resid 2170.4 2233.8 -1076.2 2152.4 8469 Scaled residuals: Min 1Q Median 3Q Max -0.016660 -0.000927 -0.000001 -0.000001 0.066825 Random effects: Groups Name Variance Std.Dev. patient_id (Intercept) 7610 87.23 Number of obs: 8478, groups: patient_id, 4239 Fixed effects: Estimate Std. Error z value Pr(>|z|) (Intercept) -28.2487 1.6444 -17.179 My thoughts the output is: Intercept estimate is -28.25 and large standard errors. Resulting in when exponentiated and recalculated to confidence intervals are enormously wide. For example Also estimate of year 2008 is 14.03 and when exponentiated results in OR 1,249,953. I suspect something is off with either my modeling or how the data is coded The adjusted model: Creating an adjusted GLMM model (same as above) but with more adjusting variables adj_glme_scaled Which gives me the following output: Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod'] Family: binomial ( logit ) Formula: COPD ~ AgeAlcoholDebut + Age + Sex + SmokingStatus + PackYears + ConfirmedAsthma + PrimarySecondarySchool + HigherEducation + year + (1 | patient_id) Data: scaled_long_df_agegroups_COPD2_adj Control: glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 2e+05)) AIC BIC logLik deviance df.resid 1947.2 2081.3 -953.6 1907.2 6031 Scaled residuals: Min 1Q Median 3Q Max -0.066615 -0.001145 -0.000013 -0.000005 0.140706 Random effects: Groups Name Variance Std.Dev. patient_id (Intercept) 1832 42.8 Number of obs: 6051, groups: patient_id, 3786 Fixed effects: Estimate Std. Error z value Pr(>|z|) (Intercept) -23.48527 10.86586 -2.161 0.0307 * AgeAlcoholDebutlessthan14years -9.16272 19.12084 -0.479 0.6318 AgeAlcoholDebut14to16years -0.55530 10.79921 -0.051 0.9590 AgeAlcoholDebut17to18years -0.37785 10.03797 -0.038 0.9700 AgeAlcoholDebut19to20years -0.34655 10.46873 -0.033 0.9736 AgeAlcoholDebut21to25years -0.19921 11.17023 -0.018 0.9858 AgeAlcoholDebutmorethan25years 0.03002 10.55937 0.003 0.9977 Age 0.66298 2.52737 0.262 0.7931 SexMale 0.30430 5.41271 0.056 0.9552 SmokingStatusFormer 0.92559 6.51731 0.142 0.8871 SmokingStatusCurrent 2.02088 6.71264 0.301 0.7634 PackYears 0.42735 1.70200 0.251 0.8017 ConfirmedAsthmaAsthma 2.49650 4.30939 0.579 0.5624 PrimarySecondarySchool8to10years -0.49171 4.80998 -0.102 0.9186 PrimarySecondarySchoolmorethan10years -0.85873 6.63901 -0.129 0.8971 HigherEducationlessthan3years -0.18785 5.54385 -0.034 0.9730 HigherEducation3to4years -0.14614 5.19366 -0.028 0.9776 HigherEducationmorethan4years -0.33717 6.50622 -0.052 0.9587 year2008 10.64035 2.38785 4.456 8.35e-06 *** --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Correlation matrix not shown by default, as p = 19 > 12. Use print(x, correlation=TRUE) or vcov(x) if you need it optimizer (bobyqa) convergence code: 0 (OK) unable to evaluate scaled gradient Model failed to converge: degenerate Hessian with 2 negative eigenvalues Advarsel: variance-covariance matrix computed from finite-difference Hessian is not positive definite or contains NA values: falling back to var-cov estimated from RXAdvarsel: variance-covariance matrix computed from finite-difference Hessian is not positive definite or contains NA values: falling back to var-cov estimated from RXAdvarsel: variance-covariance matrix computed from finite-difference Hessian is not positive definite or contains NA values: falling back to var-cov estimated from RX As i've stated above: i am aware the model might be too complex.
