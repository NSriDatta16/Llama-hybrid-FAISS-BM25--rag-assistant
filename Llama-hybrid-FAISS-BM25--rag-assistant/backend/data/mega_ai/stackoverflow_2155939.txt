[site]: stackoverflow
[post_id]: 2155939
[parent_id]: 2134338
[tags]: 
The majority of the registry keys located at: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders began with %userprofile% . I updated all of the registry keys that began with %userprofile% to begin with C:\Users\myusername . I verified on Windows XP that the paths are in fact hard coded and that %userprofile% is not used. The IT guys mentioned that the registry keys defaulted to use %userprofile% due to a default profile being used within Windows 7. The JVM expects the Desktop path to be hard coded. It will not evaluate environment variables. You can update the registry keys one by one or you can export the folder out and change the keys. Here is how you can export and import the registry keys: Go to Start > Run. Type regedit . This opens the registry editor. Browse to HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders . Right click on Shell Folders and choose Export. Select the Desktop as the destination and enter Shell Folders for the file name and save the file. Open the file in a text editor and replace %userprofile% with C:\\Users\\yourusername . Save and close the file. Go back to the registry editor window and select File > Import from the main menu. Select Shell Folders.reg and click Open. Close the registry editor and delete the Shell Folders.reg file off of the desktop.
