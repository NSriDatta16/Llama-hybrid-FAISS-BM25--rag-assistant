[site]: stackoverflow
[post_id]: 5169557
[parent_id]: 
[tags]: 
the meaning of the following assembly code, help

The following piece of code is from u-boot: /* Initialize GOT pointer. ** Global symbols can't be resolved before this is done, and as such we can't ** use any global symbols in this code. We use the bal/ move xxx,ra combination to access ** data in a PC relative manner to avoid this. This code will correctly set the ** gp regardless of whether the code has already been relocated or not. ** This code determines the current gp by computing the link time (gp - pc) ** and adding this to the current pc. ** runtime_gp = runtime_pc + (linktime_gp - linktime_pc) ** U-boot is running from the address it is linked at at this time, so this ** general case code is not strictly necessary here. */ /*Branch and link to get current PC in ra */ bal 1f nop .extern _GLOBAL_OFFSET_TABLE_ .word _GLOBAL_OFFSET_TABLE_ /* This contains the linked address of the GOT */ /* The ra register now contains the runtime address of the above memory location */ .word . - 4 /* This contains the link time address of the previous word, which is also what the link time expected PC value is */ 1: move gp, ra /* Move current PC into gp register */ lw a5, 0(ra) /* Load linked address of the GOT into a5 */ lw a6, 4(ra) /* Load the link time address of the GOT storage location into a6 */ sub a5, a6 /* Subtract a6 from t1. */ /* a5 now contains the difference between the link-time GOT table address and the link time expected PC */ /* Add this difference to the current PC (copied into gp above) so that gp now has the current runtime ** GOT table address */ daddu gp, a5 # calculate current location of offset table I don't understand 3 directive above: .extern _GLOBAL_OFFSET_TABLE_ .word _GLOBAL_OFFSET_TABLE_ //what the meaning after declaring it as a external symbol? .word . -4 //and also this one? TIA
