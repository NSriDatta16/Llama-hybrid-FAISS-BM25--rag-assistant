[site]: crossvalidated
[post_id]: 339592
[parent_id]: 
[tags]: 
How to get P and R values for a Markov Decision Process grid world problem?

Take the canonical 3x4 grid world example below. What would the P and R matrices look like for this problem? I know that P would be AxSxS, and R would be AxS, but I'm having a lot of trouble thinking about how exactly this works. P should be 4 12x12 matrices if I'm not mistaken, one for each action (up, down,left,right). R should be a 4x12 matrix, but I'm not totally sure why...aren't there only 12 possible cells for which there is a reward? I've tried a bunch of different values trying to figure this out using MDPToolbox , but I keep running into exceptions or math errors, so I'm clearly not understanding something. Here's some example code: # P = 4 12x12 matrices where each row's sum is 1.0 # R = 4x12 matrix where one cell has a reward of 1.0 and one a reward of -1.0 pi = mdptoolbox.PolicyIteration(P ,R, 0.9) pi.run() print(pi.policy) This gives me a math domain error, so something is not right. What exactly should the P and R matrices look like for this grid world problem?
