[site]: stackoverflow
[post_id]: 5053804
[parent_id]: 5050966
[tags]: 
I implemented an Ising model in Matlab a few years ago. Perhaps my code would be useful to you; it is available in this note: Monte Carlo investigation of the Ising model (PDF) . The code is very short and Matlabesque and begins on page 6. As an example of idiomatic Matlab programming, suppose you have a matrix grid which encodes your grid of spins as either +1 (up) or -1 (down). Then you can compute the average magnetization of every site's neighbors without using any for-loops by doing: % Calculate the number of neighbors of each cell neighbors = circshift(grid, [ 0 1]) + ... circshift(grid, [ 0 -1]) + ... circshift(grid, [ 1 0]) + ... circshift(grid, [-1 0]); Then you can compute the change in energy due to flipping any spins: % Calculate the change in energy of flipping a spin DeltaE = 2 * J * (grid .* neighbors); This statement works on every grid site simultaneously; such "vectorization" (computing over entire arrays at once) is the key to efficient Matlab code.
