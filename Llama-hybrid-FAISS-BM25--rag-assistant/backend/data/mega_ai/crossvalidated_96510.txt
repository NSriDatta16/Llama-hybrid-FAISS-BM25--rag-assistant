[site]: crossvalidated
[post_id]: 96510
[parent_id]: 
[tags]: 
resettest in lmtest: unexpected behavior on perfect fit

The function resettest in the R package lmtest runs the Ramsey RESET test. A student today brought to my attention that this function behaves oddly when it is handed a regression which displays perfect fit: library(lmtest) x In this code sample, the p-value for the x^2 term should match the p-value for the resttest in each of the three pairs in the code. What actually happens is that they fail to match in examples reg1 and reg2---two cases where the regression fits perfectly. In example reg3---which is almost identical to example reg1, differing only by the addition of a tiny bit of noise---they do match. This does not have a lot of practical significance since real world regressions basically never fit perfectly, but it is disconcerting if you are just playing around with the function to convince yourself that you understand what it does. Does anyone understand why this seemingly undesirable behavior occurs or if I am doing something wrong in my use of resttest ? Maybe the test statistic ends up being calculated as (roundoff error)/(roundoff error)?
