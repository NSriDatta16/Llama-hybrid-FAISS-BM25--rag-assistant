[site]: stackoverflow
[post_id]: 1966793
[parent_id]: 
[tags]: 
how can i rewrite a select query in this situation

Here are two table in parent/child relationship. What i need to do is to select students with there average mark: CREATE TABLE dbo.Students( Id int NOT NULL, Name varchar(15) NOT NULL, CONSTRAINT PK_Students PRIMARY KEY CLUSTERED ( CREATE TABLE [dbo].[Results]( Id int NOT NULL, Subject varchar(15) NOT NULL, Mark int NOT NULL ) ALTER TABLE [dbo].[Results] WITH CHECK ADD CONSTRAINT [FK_Results_Students] FOREIGN KEY([Id]) REFERENCES [dbo].[Students] ([Id]) I wrote a query like this : SELECT name , coalesce(avg(r.[mark]),0) as Avmark FROM students s LEFT JOIN results r ON s.[id]=r.[id] GROUP BY s.[name] ORDER BY ISNULL(AVG(r.[mark]),0) DESC; But the result is that all of students with there avg mark in desc order.What i need is to restrict result set with students that have the highest average mark agaist other,i.e.if the are two students with avg mark 50 and 1 with 25 i need to display only those students with 50.If there are only one student with highest avg mark- only he must appear in result set.How can i do this in best way?
