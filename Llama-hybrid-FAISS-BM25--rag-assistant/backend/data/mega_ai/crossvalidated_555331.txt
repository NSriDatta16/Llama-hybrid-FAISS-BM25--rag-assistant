[site]: crossvalidated
[post_id]: 555331
[parent_id]: 555272
[tags]: 
As far as I can tell, the ICI score is computed by subsetting the data to Gene Set A features, performing PCA, and using the PC1 values as PC1A. They then do the same with Gene Set B, and use the PC1 value of that decomposition as PC1B. The sample-wise difference of these scores is the ICI score per sample. In R, it would look something like this: pca_a = prcomp(t(data[geneSetA,])) pc1_a = pca_a$x[,1] pca_b = prcomp(t(data[geneSetB,])) pc1_b = pca_b$x[,1] iciScore = pc1_a - pc1_b I can't wrap my head around the sum notation, as I understand PC1A and PC1B to be single numbers that summarize sample-level expression of Gene Sets A and B. It makes no sense to sum PC1A and PC1B values across the cohort, since the ICI score is a sample-level value, and PC values typically sum to zero (or if not, some arbitrary value) anyway. We're trying to compute the ICI score for each sample, and each sample has exactly one value of PC1A and PC1B - there's nothing to sum at a sample level. The sum notation might make sense if the Gene Set scores were a sum or average over the individual genes' expression levels, but the PCA decomposition already summarizes each gene set as a single number.
