isplaystyle f_{\text{cal}}} . It must however be noted that chaining multiple f gcal {\displaystyle f_{\text{gcal}}} flow transformations does not give a further generalization, because: f gcal ( ⋅ ; A 1 , c 1 ) ∘ f gcal ( ⋅ ; A 2 , c 2 ) = f gcal ( ⋅ ; A 1 A 2 , c 1 + A 1 c 2 ) {\displaystyle f_{\text{gcal}}(\cdot \,;\mathbf {A} _{1},\mathbf {c} _{1})\circ f_{\text{gcal}}(\cdot \,;\mathbf {A} _{2},\mathbf {c} _{2})=f_{\text{gcal}}(\cdot \,;\mathbf {A} _{1}\mathbf {A} _{2},\mathbf {c} _{1}+\mathbf {A} _{1}\mathbf {c} _{2})} In fact, the set of f gcal {\displaystyle f_{\text{gcal}}} transformations form a group under function composition. The set of f cal {\displaystyle f_{\text{cal}}} transformations form a subgroup. Also see: Dirichlet calibration, which generalizes f gcal {\displaystyle f_{\text{gcal}}} , by not placing any restriction on the matrix, A {\displaystyle \mathbf {A} } , so that invertibility is not guaranteed. While Dirichlet calibration is trained as a discriminative model, f gcal {\displaystyle f_{\text{gcal}}} can also be trained as part of a generative calibration model. Differential volume ratio for curved manifolds Consider a flow, y = f ( x ) {\displaystyle \mathbf {y} =f(\mathbf {x} )} on a curved manifold, for example S n − 1 {\displaystyle \mathbb {S} ^{n-1}} which we equip with the embedding function, e {\displaystyle e} that maps a set of ( n − 1 ) {\displaystyle (n-1)} angular spherical coordinates to S n − 1 {\displaystyle \mathbb {S} ^{n-1}} . The Jacobian of e {\displaystyle e} is non-constant and we have to evaluate it at both input ( E x {\displaystyle \mathbf {E_{x}} } ) and output ( E y {\displaystyle \mathbf {E_{y}} } ). The same applies to r {\displaystyle r} , the representation function that recovers spherical coordinates from points on S n − 1 {\displaystyle \mathbb {S} ^{n-1}} , for which we need the Jacobian at the output ( R y {\displaystyle \mathbf {R_{y}} } ). The differential volume ratio now generalizes to: R f ( x ) = | det ⁡ ( R y F x E x ) | | det ⁡ ( E y ′ E y ) | | det ⁡ ( E x ′ E x ) | {\displaystyle R_{f}(\mathbf {x} )=\left|\operatorname {det} (\mathbf {R_{y}F_{x}E_{x}} )\right|\,{\frac {\sqrt {\left|\operatorname {det} (\mathbf {E} _{\mathbf {y} }'\mathbf {E_{y}} )\right|}}{\sqrt {\left|\operatorname {det} (\mathbf {E} _{\mathbf {x} }'\mathbf {E_{x}} )\right|}}}} For geometric insight, consider S 2 {\displaystyle \mathbf {S} ^{2}} , where the spherical coordinates are co-latitude, θ ∈ [ 0 , π ] {\displaystyle \theta \in [0,\pi ]} and longitude, ϕ ∈ [ 0 , 2 π ) {\displaystyle \phi \in [0,2\pi )} . At x = e ( θ , ϕ ) {\displaystyle \mathbf {x} =e(\theta ,\phi )} , we get | det ⁡ ( E x ′ E x ) | = sin ⁡ θ {\displaystyle {\sqrt {\left|\operatorname {det} (\mathbf {E} _{\mathbf {x} }'\mathbf {E_{x}} )\right|}}=\sin \theta } , which gives the radius of the circle at that latitude (compare e.g. polar circle to equator). The differential volume (surface area on the sphere) is: sin ⁡ θ d θ d ϕ {\displaystyle \sin \theta \,d\theta \,d\phi } . The above derivation for R f {\displaystyle R_{f}} is fragile in the sense that when using fixed functions e , r {\displaystyle e,r} , there may be places where they are not well-defined, for example at the poles of the 2-sphere where longitude is arbitrary. This problem is sidestepped (using standard manifold machinery) by generalizing to local coordinates (charts), where in the vicinities of x , y ∈ M {\displaystyle \mathbf {x} ,\mathbf {y} \in {\mathcal {M}}} , we map from local m {\displaystyle m} -dimensional coordinates to R n {\displaystyle \mathbb {R} ^{n}} and back using the respective function pairs e x , r x {\displaystyle e_{\mathbf {x} },r_{\mathbf {x} }} and e y , r y {\displaystyle e_{\mathbf {y} },r_{\mathbf {y} }} . We continue to use the same notation for the Jacobians of these functions ( E x , E y , R y {\displaystyle \mathbf {E_{x}} ,\mathbf {E_{y}} ,\mathbf {R_{y}} } ), so that the above formula for R f {\displaystyle R_{