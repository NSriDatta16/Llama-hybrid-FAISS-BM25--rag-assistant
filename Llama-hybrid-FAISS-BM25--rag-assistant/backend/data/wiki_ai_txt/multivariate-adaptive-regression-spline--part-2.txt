n the above expression, the MARS model building procedure automatically selects which variables to use (some variables are important, others not), the positions of the kinks in the hinge functions, and how the hinge functions are combined. The MARS model MARS builds models of the form f ^ ( x ) = ∑ i = 1 k c i B i ( x ) . {\displaystyle {\widehat {f}}(x)=\sum _{i=1}^{k}c_{i}B_{i}(x).} The model is a weighted sum of basis functions B i ( x ) {\displaystyle B_{i}(x)} . Each c i {\displaystyle c_{i}} is a constant coefficient. For example, each line in the formula for ozone above is one basis function multiplied by its coefficient. Each basis function B i ( x ) {\displaystyle B_{i}(x)} takes one of the following three forms: a constant 1. There is just one such term, the intercept. In the ozone formula above, the intercept term is 5.2. a hinge function. A hinge function has the form max ( 0 , x − constant ) {\displaystyle \max(0,x-{\text{constant}})} or max ( 0 , constant − x ) {\displaystyle \max(0,{\text{constant}}-x)} . MARS automatically selects variables and values of those variables for knots of the hinge functions. Examples of such basis functions can be seen in the middle three lines of the ozone formula. a product of two or more hinge functions. These basis functions can model interaction between two or more variables. An example is the last line of the ozone formula. Hinge functions A key part of MARS models are hinge functions taking the form max ( 0 , x − c ) {\displaystyle \max(0,x-c)} or max ( 0 , c − x ) {\displaystyle \max(0,c-x)} where c {\displaystyle c} is a constant, called the knot. The figure on the right shows a mirrored pair of hinge functions with a knot at 3.1. A hinge function is zero for part of its range, so can be used to partition the data into disjoint regions, each of which can be treated independently. Thus for example a mirrored pair of hinge functions in the expression 6.1 max ( 0 , x − 13 ) − 3.1 max ( 0 , 13 − x ) {\displaystyle 6.1\max(0,x-13)-3.1\max(0,13-x)} creates the piecewise linear graph shown for the simple MARS model in the previous section. One might assume that only piecewise linear functions can be formed from hinge functions, but hinge functions can be multiplied together to form non-linear functions. Hinge functions are also called ramp, hockey stick, or rectifier functions. Instead of the max {\displaystyle \max } notation used in this article, hinge functions are often represented by [ ± ( x i − c ) ] + {\displaystyle [\pm (x_{i}-c)]_{+}} where [ ⋅ ] + {\displaystyle [\cdot ]_{+}} means take the positive part. The model building process MARS builds a model in two phases: the forward and the backward pass. This two-stage approach is the same as that used by recursive partitioning trees. The forward pass MARS starts with a model which consists of just the intercept term (which is the mean of the response values). MARS then repeatedly adds basis function in pairs to the model. At each step it finds the pair of basis functions that gives the maximum reduction in sum-of-squares residual error (it is a greedy algorithm). The two basis functions in the pair are identical except that a different side of a mirrored hinge function is used for each function. Each new basis function consists of a term already in the model (which could perhaps be the intercept term) multiplied by a new hinge function. A hinge function is defined by a variable and a knot, so to add a new basis function, MARS must search over all combinations of the following: existing terms (called parent terms in this context) all variables (to select one for the new basis function) all values of each variable (for the knot of the new hinge function). To calculate the coefficient of each term, MARS applies a linear regression over the terms. This process of adding terms continues until the change in residual error is too small to continue or until the maximum number of terms is reached. The maximum number of terms is spec