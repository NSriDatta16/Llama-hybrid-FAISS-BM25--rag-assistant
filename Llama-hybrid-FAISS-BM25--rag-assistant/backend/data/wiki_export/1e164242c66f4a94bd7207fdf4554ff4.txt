Bis[2,4,5-trichloro-6-(pentyloxycarbonyl)phenyl]oxalate (also known as bis(2,4,5-trichloro-6-carbopentoxyphenyl) oxalate or CPPO) is a solid ester whose oxidation products are responsible for the chemiluminescence in a glowstick. It can be synthesized by reacting 2-carbopentoxy-3,5,6-trichlorophenol with oxalyl chloride. 

When mixed with hydrogen peroxide in an organic solvent (diethyl phthalate, ethyl acetate, etc...) in the presence of a fluorescent dye CPPO causes the emission of light, as per the following scheme involving 1,2-dioxetanedione (note that many side-groups of the aromatic rings are not shown.):

The reaction rate is pH dependent, and slightly alkaline conditions achieved by adding a weak base, e.g. sodium salicylate, will produce brighter light.  Developed by American Cyanamid in the 1960s, the formulation containing CPPO, a fluorescer, and a glass capsule containing hydrogen peroxide and a base catalyst, all in dialkyl phthalate solvents, was marketed as Cyalume.

The following colors can be produced by using different dyes:

References

Oxalate esters
Phenol esters
Chemiluminescence