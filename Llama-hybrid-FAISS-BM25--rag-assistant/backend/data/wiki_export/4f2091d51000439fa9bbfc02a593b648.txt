Proportional hazards models are a class of survival models in statistics.  Survival models relate the time that passes, before some event occurs, to one or more covariates that may be associated with that quantity of time.  In a proportional hazards model, the unique effect of a unit increase in a covariate is multiplicative with respect to the hazard rate. For example, taking a drug may halve one's hazard rate for a stroke occurring, or, changing the material from which a manufactured component is constructed may double its hazard rate for failure.  Other types of survival models such as accelerated failure time models do not exhibit proportional hazards.  The accelerated failure time model describes a situation where the biological or mechanical life history of an event is accelerated (or decelerated).

Background

Survival models can be viewed as consisting of two parts: the underlying baseline hazard function, often denoted , describing how the risk of event per time unit changes over time at baseline levels of covariates; and the effect parameters, describing how the hazard varies in response to explanatory covariates. A typical medical example would include covariates such as treatment assignment, as well as patient characteristics such as age at start of study, gender, and the presence of other diseases at start of study, in order to reduce variability and/or control for confounding.

The proportional hazards condition states that covariates are multiplicatively related to the hazard. In the simplest case of stationary coefficients, for example, a treatment with a drug may, say, halve a subject's hazard at any given time , while the baseline hazard may vary. Note however, that this does not double the lifetime of the subject; the precise effect of the covariates on the lifetime depends on the type of . The covariate is not restricted to binary predictors; in the case of a continuous covariate , it is typically assumed that the hazard responds exponentially; each unit increase in  results in proportional scaling of the hazard.

The Cox model

Introduction 

Sir David Cox observed that if the proportional hazards assumption holds (or, is assumed to hold) then it is possible to estimate the effect parameter(s), denoted  below, without any consideration of the full hazard function.  This approach to survival data is called application of the Cox proportional hazards model, sometimes abbreviated to Cox model or to proportional hazards model. However, Cox also noted that biological interpretation of the proportional hazards assumption can be quite tricky.

Let  be the realized values of the p covariates for subject i.  The hazard function for the Cox proportional hazards model has the form

This expression gives the hazard function at time t for subject i with covariate vector (explanatory variables) Xi. Note that between subjects, the baseline hazard  is identical (has no dependency on i). The only difference between subjects' hazards comes from the baseline scaling factor .

Why it is called "proportional" 

To start, suppose we only have a single covariate, , and therefore a single coefficient, . Consider the effect of increasing  by 1:

We can see that increasing a covariate by 1 scales the original hazard by the constant . Rearranging things slightly, we see that:

The right-hand-side is constant over time (no term has a  in it). This relationship, , is called a proportional relationship.

More generally, consider two subjects, i and j, with covariates  and  respectively. Consider the ratio of their hazards:

The right-hand-side isn't dependent on time, as the only time-dependent factor, , was cancelled out. Thus the ratio of hazards of two subjects is a constant, i.e. the hazards are proportional.

Absence of an intercept term 
Often there is an intercept term (also called a constant term or bias term) used in regression models. The Cox model lacks one because the baseline hazard, , takes the place of it. Let's see what would happen if we did include an intercept term anyways, denoted :

where we've redefined  to be a new baseline hazard, . Thus, the baseline hazard incorporates all parts of the hazard that are not dependent on the subjects' covariates, which includes any intercept term (which is constant for all subjects, by definition).

Likelihood for unique times 

The Cox partial likelihood, shown below, is obtained by using Breslow's estimate of the baseline hazard function, plugging it into the full likelihood and then observing that the result is a product of two factors. The first factor is the partial likelihood shown below, in which the baseline hazard has "canceled out". The second factor is free of the regression coefficients and depends on the data only through the censoring pattern. The effect of covariates estimated by any proportional hazards model can thus be reported as hazard ratios.

The likelihood of the event to be observed occurring for subject i at time Yi can be written as:

where ) and the summation is over the set of subjects j where the event has not occurred before time Yi (including subject i itself). Obviously 0 < Li(β) ≤ 1. This is a partial likelihood: the effect of the covariates can be estimated without the need to model the change of the hazard over time.

Treating the subjects as if they were statistically independent of each other, the joint probability of all realized events is the following partial likelihood, where the occurrence of the event is indicated by Ci = 1:

The corresponding log partial likelihood is

This function can be maximized over β to produce maximum partial likelihood estimates of the model parameters.

The partial score function is

and the Hessian matrix of the partial log likelihood is

Using this score function and Hessian matrix, the partial likelihood can be maximized using the Newton-Raphson algorithm. The inverse of the Hessian matrix, evaluated at the estimate of β, can be used as an approximate variance-covariance matrix for the estimate, and used to produce approximate standard errors for the regression coefficients.

Likelihood when there exist tied times

Several approaches have been proposed to handle situations in which there are ties in the time data. Breslow's method describes the approach in which the procedure described above is used unmodified, even when ties are present. An alternative approach that is considered to give better results is Efron's method. Let tj denote the unique times, let Hj denote the set of indices i such that Yi = tj and Ci = 1, and let mj = |Hj|.  Efron's approach maximizes the following partial likelihood.

The corresponding log partial likelihood is

the score function is

and the Hessian matrix is

where

Note that when Hj is empty (all observations with time tj are censored), the summands in these expressions are treated as zero.

Examples

Below are some worked examples of the Cox model in practice.

A single binary covariate

Suppose the endpoint we are interested in is patient survival during a 5-year observation period after a surgery. Patients can die within the 5-year period, and we record when they died, or patients can live past 5 years, and we only record that they lived past 5 years. The surgery was performed at one of two hospitals, A or B, and we would like to know if the hospital location is associated with 5-year survival. Specifically, we would like to know the relative increase (or decrease) in hazard from a surgery performed at hospital A compared to hospital B. Provided is some (fake) data, where each row represents a patient: T is how long the patient was observed for before death or 5 years (measured in months), and C denotes if the patient died in the 5-year period. We have encoded the hospital as a binary variable denoted X: 1 if from hospital A, 0 from hospital B.

Our single-covariate Cox proportional model looks like the following, with  representing the hospital's effect, and i indexing each patient:

Using statistical software, we can estimate  to be 2.12. The hazard ratio is the exponential of this value, . To see why, consider the ratio of hazards, specifically:

Thus, the hazard ratio of hospital A to hospital B is . Putting aside statistical significance for a moment, we can make a statement saying that patients in hospital A are associated with a 8.3x higher risk of death occurring in any short period of time compared to hospital B.

There are important caveats to mention about the interpretation:

 a 8.3x higher risk of death does not mean that 8.3x more patients will die in hospital B: survival analysis examines how quickly events occur, not simply whether they occur. 
 More specifically, "risk of death" is a measure of a rate. A rate has units, like meters per second. However, a relative rate does not: a bicycle can go two times faster than another bicycle (the reference bicycle), without specifying any units. Likewise, the risk of death (rate of death) in hospital A is 8.3 times higher (faster) than the risk of death in hospital B (the reference group). 
 the inverse quantity,  is the hazard ratio of hospital B relative to hospital A.
 We haven't made any inferences about probabilities of survival between the hospitals. This is because we would need an estimate of the baseline hazard rate, , as well as our  estimate. However, standard estimation of the Cox proportional hazard model does not directly estimate the baseline hazard rate.
 Because we have ignored the only time varying component of the model, the baseline hazard rate, our estimate is timescale-invariant. For example, if we had measured time in years instead of months, we would get the same estimate.
 It is tempting to say that the hospital caused the difference in hazards between the two groups, but since our study is not causal (that is, we do not know how the data was generated), we stick with terminology like "associated".

A single continuous covariate
To demonstrate a less traditional use case of survival analysis, the next example will be an economics question: what is the relationship between a companies' price-to-earnings ratio (P/E) on their 1-year IPO anniversary and their future survival? More specifically, if we consider a company's "birth event" to be their 1-year IPO anniversary, and any bankruptcy, sale, going private, etc. as a "death" event the company, we'd like to know the influence of the companies' P/E ratio at their "birth" (1-year IPO anniversary) on their survival.

Provided is a (fake) dataset with survival data from 12 companies: T represents the number of days between 1-year IPO anniversary and death (or an end date of 2022-01-01, if did not die). C represents if the company died before 2022-01-01 or not. P/E represents the companies price-to-earnings ratio at their 1-year IPO anniversary.

Unlike the previous example where there was a binary variable, this dataset has a continuous variable, P/E. However, the model looks similar:

where  represents a company's P/E ratio. Running this dataset through a Cox model produces an estimate of the value of the unknown , which is -0.34. Therefore, an estimate of the entire hazard is:

Since the baseline hazard, , was not estimated, the entire hazard is not able to be calculated. However, consider the ratio of the companies i and j'''s hazards:

All terms on the right are known, so calculating the ratio of hazards between companies is possible. Since there is no time-dependent term on the right (all terms are constant), the hazards are proportional to each other. For example, the hazard ratio of company 5 to company 2 is . This means that, within the interval of study, company 5's risk of "death" is 0.33 ≈ 1/3 as large as company 2's risk of death.

There are important caveats to mention about the interpretation:

 The hazard ratio is the quantity , which is   in the above example. From the last calculation above, an interpretation of this is as the ratio of hazards between two "subjects" that have their variables differ by one unit: if , then . The choice of "differ by one unit" is convenience, as it communicates precisely the value of . 
 The baseline hazard can be represented when the scaling factor is 1, i.e. .

Can we interpret the baseline hazard as the hazard of a "baseline" company whose P/E happens to be 0? This interpretation of the baseline hazard as "hazard of a baseline subject" is imperfect, as it is possible that the covariate being 0 is impossible. In this application, a P/E of 0 is meaningless (it means the company's stock price is 0, i.e., they are "dead"). A more appropriate interpretation would be "the hazard when all variables are nil". 
 It is tempting to want to understand and interpret a value like  to represent the hazard of a company. However, consider what this is actually representing: . There is implicitly a ratio of hazards here, comparing company is hazard to an imaginary baseline company with 0 P/E. However, as explained above, a P/E of 0 is impossible in this application, so  is meaningless in this example. Ratios between plausible hazards are meaningful, however.

Time-varying predictors and coefficients
Extensions to time dependent variables, time dependent strata, and multiple events per subject, can be incorporated by the counting process formulation of Andersen and Gill. One example of the use of hazard models with time-varying regressors is estimating the effect of unemployment insurance on unemployment spells.

In addition to allowing time-varying covariates (i.e., predictors), the Cox model may be generalized to time-varying coefficients as well. That is, the proportional effect of a treatment may vary with time; e.g. a drug may be very effective if administered within one month of morbidity, and become less effective as time goes on. The hypothesis of no change with time (stationarity) of the coefficient may then be tested. Details and software (R package) are available in Martinussen and Scheike (2006).

In this context, it could also be mentioned that it is theoretically possible to specify the effect of covariates by using additive hazards, i.e. specifying

If such additive hazards models are used in situations where (log-)likelihood maximization is the objective, care must be taken to restrict  to non-negative values. Perhaps as a result of this complication, such models are seldom seen.  If the objective is instead least squares the non-negativity restriction is not strictly required.

Specifying the baseline hazard function

The Cox model may be specialized if a reason exists to assume that the baseline hazard follows a particular form. In this case, the baseline hazard  is replaced by a given function. For example, assuming the hazard function to be the Weibull hazard function gives the Weibull proportional hazards model.

Incidentally, using the Weibull baseline hazard is the only circumstance under which the model satisfies both the proportional hazards, and accelerated failure time models.

The generic term parametric proportional hazards models can be used to describe proportional hazards models in which the hazard function is specified.  The Cox proportional hazards model is sometimes called a semiparametric model  by contrast.

Some authors use the term Cox proportional hazards model even when specifying the underlying hazard function, to acknowledge the debt of the entire field to David Cox.

The term Cox regression model (omitting proportional hazards) is sometimes used to describe the extension of the Cox model to include time-dependent factors.  However, this usage is potentially ambiguous since the Cox proportional hazards model can itself be described as a regression model.

Relationship to Poisson models

There is a relationship between proportional hazards models and Poisson regression models which is sometimes used to fit approximate proportional hazards models in software for Poisson regression.  The usual reason for doing this is that calculation is much quicker.  This was more important in the days of slower computers but can still be useful for particularly large data sets or complex problems.  Laird and Olivier (1981) provide the mathematical details.  They note, "we do not assume [the Poisson model] is true, but simply use it as a device for deriving the likelihood."  McCullagh and Nelder's book on generalized linear models has a chapter on converting proportional hazards models to generalized linear models.

Under high-dimensional setup

In high-dimension, when number of covariates p is large compared to the sample size n, the LASSO method is one of the classical model-selection strategies. Tibshirani (1997) has proposed a Lasso procedure for the proportional hazard regression parameter. The Lasso estimator of the regression parameter β is defined as the minimizer of the opposite of the Cox partial log-likelihood under an L1-norm type constraint.

There has been theoretical progress on this topic recently.

Software implementations
 Mathematica: CoxModelFit function.
 R: coxph() function, located in the survival package.
 SAS: phreg procedure
 Stata: stcox command
 Python: CoxPHFitter located in the lifelines library. phreg in the statsmodels library.
 SPSS: Available under Cox Regression.
 Matlab: coxphfit function
 Julia: Available in the Survival.jl library.
 JMP: Available in Fit Proportional Hazards platform.
 Prism''': Available in Survival Analyses and Multiple Variable Analyses

See also

 Accelerated failure time model
 One in ten rule
 Weibull distribution

Notes

References
 
 
 
 
 
 

Survival analysis
Semi-parametric models
Poisson point processes