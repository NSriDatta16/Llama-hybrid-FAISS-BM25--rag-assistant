John William Jamieson Herivel (29 August 1918 – 18 January 2011) was a British science historian and World War II codebreaker at Bletchley Park.

As a codebreaker concerned with Cryptanalysis of the Enigma, Herivel is remembered chiefly for the discovery of what was soon dubbed the Herivel tip or Herivelismus. Herivelismus consisted of the idea, the Herivel tip and the method of establishing whether it applied using the Herivel square. It was based on Herivel's insight into the habits of German operators of the Enigma cipher machine that allowed Bletchley Park to easily deduce part of the daily key. For a brief but critical period after May 1940, the Herivel tip in conjunction with "cillies" (another class of operator error) was the main technique used to solve Enigma.

After the war, Herivel became an academic, studying the history and philosophy of science at Queen's University Belfast, particularly Isaac Newton, Joseph Fourier, Christiaan Huygens. In 1956, he took a brief leave of absence from Queen's to work as a scholar at the Dublin Institute for Advanced Studies. In retirement, he wrote an autobiographical account of his work at Bletchley Park entitled Herivelismus and the German Military Enigma.

Recruitment to Bletchley Park
John Herivel was born in Belfast, and attended Methodist College Belfast from 1924 to 1936. In 1937 he was awarded a Kitchener Scholarship to study mathematics at Sidney Sussex College, Cambridge, where his supervisor was Gordon Welchman. Welchman recruited Herivel to the Government Code and Cypher School (GC&CS) at Bletchley Park. Welchman worked with Alan Turing in the newly formed Hut 6 section created to solve Army and Air Force Enigma. Herivel, then aged 21, arrived at Bletchley on 29 January 1940, and was briefed on Enigma by Alan Turing and Tony Kendrick.

Enigma

At the time that Herivel started work at Bletchley Park, Hut 6 was having only limited success with Enigma-enciphered messages, mostly from the Luftwaffe Enigma network known as "Red". He was working alongside David Rees, another Cambridge mathematician recruited by Welchman, in nearby Elmers School, testing candidate solutions and working out plugboard settings. The process was slow, however, Herivel was determined to find a method to improve their attack, and he would spend his evenings trying to think up ways to do so.

Intercepted Morse coded messages had been enciphered by the Germans' Enigma, an electro-mechanical rotor cipher machine that implemented a polyalphabetic cipher. The main model in use in 1940 had three rotors that set an electrical pathway from the keyboard to the lampboard. Pressing a key caused one lamp to light and the right-most rotor to advance by one letter position. This changed the electrical pathway so that pressing the same key again caused a different letter to light up. At one of the 26 positions, a notch on the right-most rotor engaged with the middle rotor so that the two rotors advanced together, and similarly the middle rotor would engage with the left-most rotor, giving a very long period before the sequence repeated (26 × 26 × 26 = 17,576). The ring on the rotor that contained the notch and so caused the next rotor to advance, could be set to any one of the 26 positions. The three rotors were selected from a set of five, giving 60 different ways of mounting rotors in the machine. However, because the Germans laid down the rule that no rotor should be in the same position on successive days, if the previous days's rotors and their positions were known, this number was reduced to 32.

The Enigma machine worked reciprocally so that an identical machine with identical settings would, if fed the enciphered letters, show the deciphered letters on the lampboard. Hut 6 had Enigma replica machines that were logically identical to the machines that the Germans were using. To decipher the intercepted messages required that the selection of rotors, the ring settings and the plugboard connections were known. At this time, the first three letters of the prelude to the message were used as an indicator to tell the receiving operator the letters that should appear in the windows for this particular message.

Herivel tip

Herivel had an insight in February 1940 that some lazy German code clerks might give away the Enigma's ring settings (Ringstellung) in their first message of the day. If there were several lazy clerks, the first message Grundstellungs would not be random but would have a clustering around the Ringstellung. The insight became known as the Herivel tip. It was not needed at the time because the Luftwaffe was doubly-enciphering their message keys so techniques such as Zygalski sheets could be used. In May 1940, the Germans stopped the doubly-enciphered keys. Other methods becoming ineffective, Bletchley Park started using the Herivel tip to break Luftwaffe traffic. It continued to be the main method until the bombe was delivered in August 1940.

Enigma enciphering procedure
The rotors and the positioning of the ring containing the notch were changed daily. The settings were defined in a codebook that was common to all operators on that network. At the start of each day, before any messages were sent or received, Enigma operators implemented the day's rotor selection and ring settings. Having selected the three rotors, they adjusted the ring settings. That could be done before the rotors were mounted on their axle or after they had been inserted into the machine. It was possible to adjust the ring settings of the loaded rotors by moving the spring-loaded retaining pin to the right and turning the rotor to display the specified letter. Herivel thought it likely that at least some of the operators would adjust the rings after they had mounted the rotors in the machine. Having set the alphabet rings and closed the lid, the operator should then have moved the rotors well away from the positions that displayed the three letters of the ring setting in the windows, but some operators did not.

Herivel's great insight came to him one evening in February 1940 while he was relaxing in front of his landlady's fire. Stressed or lazy operators who had set the rings when the rotors were in the machine might then have left ring setting at or near the top and used those three letters for the first message of the day.

For each transmitted message, the sending operator would follow a standard procedure. From September 1938, he would use an initial position to encrypt the indicator and send it in clear, followed by the message key that had been enciphered at that setting. If the ground setting () was GKX for example, he would then use Enigma with the rotors set to GKX to encrypt the message setting, which he might choose to be RTQ; which might encrypt to LLP. (Before May 1940, the encrypted message setting was repeated, but that makes no difference to Herivel's insight.) The operator would then turn his rotors to RTQ and encrypt the actual message. Thus, the preamble to the message would be the unencrypted ground setting (GKX), followed by the encrypted message setting (LLP). A receiving Enigma operator could use the information to recover the message setting and then decrypt the message.

The ground setting (GKX in the above example) should have been chosen at random, but Herivel reasoned that if operators were lazy, in a hurry or otherwise under pressure, they might simply use whatever rotor setting was currently showing on the machine. If that was the first message of the day and the operator had set the ring settings with the rotors already inside the machine, the rotor position currently showing on the machine could well be the ring setting itself or be very close to it. (If that situation occurred in the above example, GKX would be the ring setting or close to it).

Polish cryptographers used the idea at PC Bruno during the Phoney War.

Herivel square
The day after his insight, Herivel's colleagues agreed that his idea was a possible way into Enigma. Hut 6 began looking for the effect predicted by the Herivel tip and arranged to have the first messages of the day from each transmitting station to be sent to them early. They plotted the indicators in a grid termed a "Herivel square", an example of which is shown below. The rows and columns of the grid are labelled with the alphabet. The first indicator of the first message of the day received from each station on the network, was entered into the grid. It was done by finding the column corresponding to the first letter, the row corresponding to the second letter, and entering the third letter into the cell where the row and column intersected. For example, GKX would be recorded by entering a X in the cell in column G and row K.
   A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
----------------------------------------------------------
Z|                                                      |Z
Y| S                                                    |Y
X|                                                      |X
W|                                             L        |W
V|                                                      |V
U|                       E                              |U
T|                                                      |T
S|                                                      |S
R|                                                 K    |R
Q|     S                                                |Q
P|                                                      |P
O|                                                      |O
N|                               N                      |N
M|           X                                          |M
L|             W T                                      |L
K|             X Y                                      |K
J|           W X                                        |J
I|                                                      |I
H|                                         Q            |H
G|                                                      |G
F|                                                      |F
E|           A                                          |E
D|                                                      |D
C|                     V                                |C
B|                                       J              |B
A|   P                                                  |A
----------------------------------------------------------
   A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
The Herivel tip suggested that there would be a cluster of entries close together, such as the cluster around GKX in the above example. That would narrow the options for the ring settings down from 17,576 to a small set of possibilities, perhaps 6 to 30, which could be tested individually.

The effect predicted by Herivel did not immediately show up in the Enigma traffic, however, and Bletchley Park had to continue to rely on a different technique to get into Enigma: the method of "perforated sheets", which had been passed on by Polish cryptologists. The situation changed on 1 May 1940, when the Germans changed their indicating procedure, rendering the perforated sheet method obsolete. Hut 6 was suddenly unable to decrypt Enigma.

Fortunately for the codebreakers, the pattern predicted by the Herivel tip began to manifest itself soon after on 10 May, when the Germans invaded the Netherlands and Belgium. David Rees spotted a cluster in the indicators, and on 22 May a Luftwaffe message sent on 20 May was decoded, the first since the change in procedure.

Additional key components
Although the Herivel tip provided the Enigma's ring settings, it did not provide other parts of the Enigma key: the rotor order and the plugboard settings. A Luftwaffe key at the time chose from 5 rotors, so there were 60 possible rotor orders. In addition, there might be 8 to 10 plugboard connections, which means that all but 6 of the 26 letters are permuted by the plugboard. The codebreakers had to use other methods to find the remaining portions of the Enigma key.

The Herivel tip was used in combination with another class of operator mistake, known as "cillies", to solve the settings and decipher the messages.

The Herivel tip was used for several months until specialised codebreaking machines designed by Alan Turing, the so-called "bombes", were ready for use.

Recognition
Gordon Welchman wrote that the Herivel tip was a vital part of breaking Enigma at Bletchley Park. 

Because of the importance of his contribution, Herivel was singled out and introduced to Winston Churchill during a visit to Bletchley Park. He also taught Enigma cryptanalysis to a party of Americans assigned to Hut 6 in an intensive two-week course. Herivel later worked in administration in the "Newmanry", the section responsible for solving German teleprinter ciphers by using machine methods such as the Colossus computers, as assistant to the head of the section, mathematician Max Newman.

In 2005, researchers studying a set of Enigma-encrypted messages from World War II noted the occurrence of clustering, as predicted by the Herivel tip, in messages from August 1941.

After World War II
After the end of the war, Herivel taught mathematics in a school for a year, but he found he could not handle the "rumbustious boys". He then joined Queen's University Belfast, where he became reader in the History and Philosophy of Science. One of the students that he supervised was the actor Simon Callow, who said of him: 

He published books and articles on Isaac Newton, Joseph Fourier and Christiaan Huygens. His publications include:

 
 
  The research on which this paper is based was carried out in Paris in 1964 with the aid of a Bourse de Marque awarded by the French Government through their Embassy in London, and with a grant from the Research Committee of the Academic Council of the Queen's University, Belfast.
 
 
 
 
 

In 1978 he retired to Oxford, where he became a Fellow of All Souls College. In his retirement he published:

  
He died in Oxford in 2011.

He is survived by his daughter Josephine Herivel.

Notes

References
  in 
  This contains an account of the pre-war work on Enigma in Poland, written with the care of a professional historian.

External links
 "Mind of a Codebreaker", companion web site to "Decoding Nazi Secrets", originally broadcast on 9 November 1999. Part one and part two. (Contains similar material on the Herivel Tip to Smith, 1998).

1918 births
2011 deaths
People educated at Methodist College Belfast
Alumni of Sidney Sussex College, Cambridge
Bletchley Park people
Cryptographic attacks
Historians of science
British biographers
Academics of Queen's University Belfast
Fellows of All Souls College, Oxford
Historians from Northern Ireland
Newton scholars
Male non-fiction writers from Northern Ireland
Academics of the Dublin Institute for Advanced Studies
20th-century biographers from Northern Ireland