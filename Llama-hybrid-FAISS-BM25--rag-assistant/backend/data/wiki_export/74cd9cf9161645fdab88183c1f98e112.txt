The theory of optimal control is concerned with operating a dynamic system at minimum cost.  The case where the system dynamics are described by a set of linear differential equations and the cost is described by a quadratic function is called the LQ problem.  One of the main results in the theory is that the solution is provided by the linear–quadratic regulator (LQR), a feedback controller whose equations are given below. 

LQR controllers possess inherent robustness with guaranteed gain and phase margin, and they also are part of the solution to the LQG (linear–quadratic–Gaussian) problem. Like the LQR problem itself, the LQG problem is one of the most fundamental problems in control theory.

General description
The settings of a (regulating) controller governing either a machine or process (like an airplane or chemical reactor) are found by using a mathematical algorithm that minimizes a cost function with weighting factors supplied by a human (engineer). The cost function is often defined as a sum of the deviations of key measurements, like altitude or process temperature, from their desired values. The algorithm thus finds those controller settings that minimize undesired deviations. The magnitude of the control action itself may also be included in the cost function.

The LQR algorithm reduces the amount of work done by the control systems engineer to optimize the controller. However, the engineer still needs to specify the cost function parameters, and compare the results with the specified design goals. Often this means that controller construction will be an iterative process in which the engineer judges the "optimal" controllers produced through simulation and then adjusts the parameters to produce a controller more consistent with design goals.

The LQR algorithm is essentially an automated way of finding an appropriate state-feedback controller. As such, it is not uncommon for control engineers to prefer alternative methods, like full state feedback, also known as pole placement, in which there is a  clearer relationship between controller parameters and controller behavior. Difficulty in finding the right weighting factors limits the application of the LQR based controller synthesis.

Versions

Finite-horizon, continuous-time

For a continuous-time linear system, defined on , described by:

where  (that is,  is an -dimensional real-valued vector) is the state of the system and  is the control input.  Given a quadratic cost function for the system, defined as:

the feedback control law that minimizes the value of the cost is:

where  is given by:

and  is found by solving the continuous time Riccati differential equation:

with the boundary condition:

The first order conditions for Jmin are:

1) State equation 

2) Co-state equation 

3) Stationary equation

4) Boundary conditions

and

Infinite-horizon, continuous-time 

For a continuous-time linear system described by:

with a cost function defined as:

the feedback control law that minimizes the value of the cost is:

where  is given by:

and  is found by solving the continuous time algebraic Riccati equation:

This can be also written as:

with

Finite-horizon, discrete-time

For a discrete-time linear system described by:

with a performance index defined as:

, where  is the time horizon

the optimal control sequence minimizing the performance index is given by:

where:

and  is found iteratively backwards in time by the dynamic Riccati equation:

from terminal condition . Note that  is not defined, since  is driven to its final state  by .

Infinite-horizon, discrete-time

For a discrete-time linear system described by:

with a performance index defined as:

the optimal control sequence minimizing the performance index is given by:

where:

and  is the unique positive definite solution to the discrete time algebraic Riccati equation (DARE):

.

This can be also written as:

with:

.

Note that one way to solve the algebraic Riccati equation is by iterating the dynamic Riccati equation of the finite-horizon case until it converges.

Constraints
In practice, not all values of  may be allowed. One common constraint is the linear one:

The finite horizon version of this is a convex optimization problem, and so the problem is often solved repeatedly with a receding horizon. This is a form of model predictive control.

Related controllers

Quadratic-quadratic regulator
If the state equation is quadratic then the problem is known as the quadratic-quadratic regulator (QQR). The Al'Brekht algorithm can be applied to reduce this problem to one that can be solved efficiently using tensor based linear solvers.

Polynomial-quadratic regulator
If the state equation is polynomial then the problem is known as the polynomial-quadratic regulator (PQR). Again, the Al'Brekht algorithm can be applied to reduce this problem to a large linear one which can be solved with a generalization of the Bartels-Stewart algorithm; this is feasible provided that the degree of the polynomial is not too high.

Model-predictive control 

Model predictive control and linear-quadratic regulators are two types of optimal control methods that have distinct approaches for setting the optimization costs. In particular, when the LQR is run repeatedly with a receding horizon, it becomes a form of model predictive control (MPC). In general, however, MPC does not rely on any assumptions regarding linearity of the system.

References

External links
 MATLAB function for Linear Quadratic Regulator design
 Mathematica function for Linear Quadratic Regulator design

Optimal control